---
title: グラフィカル クエリ デザイナーのユーザー インターフェイス | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10012"
- sql12.rtp.rptdesigner.dataview.vdtquerydesigner.f1
helpviewer_keywords:
- graphical query designer [Reporting Services]
- data sources [Reporting Services], creating
- text-based query designer [Reporting Services]
- query designers [Reporting Services]
- Reporting Services, query designers
ms.assetid: 5022ae33-03a3-48de-8ac1-82742f48cebe
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 12cc3cdc2a5a36ebcadd01f61c6a04ea66b0e4f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634268"
---
# <a name="graphical-query-designer-user-interface"></a><span data-ttu-id="c9d9c-102">グラフィカル クエリ デザイナーのユーザー インターフェイス</span><span class="sxs-lookup"><span data-stu-id="c9d9c-102">Graphical Query Designer User Interface</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="c9d9c-103">にはグラフィカル クエリ デザイナーとテキスト ベースのクエリ デザイナーが用意されており、レポート デザイナーでレポート データセットのリレーショナル データベースからデータを取得するクエリの作成に使用できます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-103">provides both a graphical query designer and a text-based query designer for creating queries to retrieve data from a relational database for a report dataset in Report Designer.</span></span> <span data-ttu-id="c9d9c-104">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]、Oracle、OLE DB、ODBC の各データ ソースの種類に対して、対話形式でクエリを作成して結果を表示するには、グラフィカル クエリ デザイナーを使用します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-104">Use the graphical query designer to interactively build a query and view the results for data source types [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], Oracle, OLE DB, and ODBC.</span></span> <span data-ttu-id="c9d9c-105">テキスト ベースのクエリ デザイナーは、複数の [!INCLUDE[tsql](../../../includes/tsql-md.md)] ステートメント、複雑なクエリやコマンド構文、式ベースのクエリを指定する場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-105">Use the text-based query designer to specify multiple [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements, complex query or command syntax, and expression-based queries.</span></span> <span data-ttu-id="c9d9c-106">詳細については、「 [テキストベースのクエリ デザイナーのユーザー インターフェイス](../text-based-query-designer-user-interface.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-106">For more information, see [Text-based Query Designer User Interface](../text-based-query-designer-user-interface.md).</span></span> <span data-ttu-id="c9d9c-107">特定の種類のデータソースを操作する方法の詳細については、「[レポート &#40;レポートビルダーおよび SSRS&#41;にデータを追加する](report-datasets-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-107">For more information about working with specific data source types, see [Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md).</span></span>

 <span data-ttu-id="c9d9c-108">。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-108">.</span></span>

## <a name="graphical-query-designer"></a><span data-ttu-id="c9d9c-109">グラフィカル クエリ デザイナー</span><span class="sxs-lookup"><span data-stu-id="c9d9c-109">Graphical Query Designer</span></span>
 <span data-ttu-id="c9d9c-110">グラフィカル クエリ デザイナーでサポートされているクエリ コマンドの種類は、 **Text**、 **StoredProcedure**、および **TableDirect**の 3 つです。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-110">This graphical query designer supports three types of query commands: **Text**, **StoredProcedure**, or **TableDirect**.</span></span> <span data-ttu-id="c9d9c-111">データセットに対するクエリを作成する前に、 [[データセットのプロパティ]](../dataset-properties-dialog-box-query.md) ダイアログ ボックスの [クエリ] ページにあるコマンドの種類のオプションを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-111">Before you create a query for your dataset, you must select a command type option on the Query page of the [Dataset Properties](../dataset-properties-dialog-box-query.md) dialog box.</span></span>

 <span data-ttu-id="c9d9c-112">クエリの種類には、次のオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-112">The following options are available for query type:</span></span>

-   <span data-ttu-id="c9d9c-113">**Text** [!INCLUDE[tsql](../../../includes/tsql-md.md)] [!INCLUDE[msCoName](../../includes/msconame-md.md)] および Oracle のデータ処理拡張機能を含め、リレーショナル データベース データ ソースの標準の [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] クエリ テキストをサポートします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-113">**Text** Supports standard [!INCLUDE[tsql](../../../includes/tsql-md.md)] query text for relational database data sources, including data processing extensions for [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and Oracle.</span></span>

-   <span data-ttu-id="c9d9c-114">**[TableDirect]** 指定したテーブルのすべての列を選択します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-114">**TableDirect** Selects all the columns from the specified table.</span></span> <span data-ttu-id="c9d9c-115">たとえば、Customers という名前のテーブルの場合、これは [!INCLUDE[tsql](../../../includes/tsql-md.md)] という `SELECT * FROM Customers`ステートメントと同じです。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-115">For example, for a table named Customers, this is the equivalent of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement `SELECT * FROM Customers`.</span></span>

-   <span data-ttu-id="c9d9c-116">**[StoredProcedure]** データ ソースでのストアド プロシージャの呼び出しをサポートします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-116">**StoredProcedure** Supports calls to stored procedures on the data source.</span></span> <span data-ttu-id="c9d9c-117">このオプションを使用するには、データ ソースのデータベース管理者によってストアド プロシージャに対する実行権限が与えられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-117">To use this option, you must have been granted Execute permissions on the stored procedure by the database administrator on the data source.</span></span>

 <span data-ttu-id="c9d9c-118">既定のコマンドの種類は **[Text]** です。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-118">The default command type is **Text**.</span></span>

> [!NOTE]
>  <span data-ttu-id="c9d9c-119">サポートされるコマンドの種類は、データ処理拡張機能によって異なります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-119">Not all data processing extensions support all types.</span></span> <span data-ttu-id="c9d9c-120">このオプションを利用するには、基になるデータ プロバイダーでコマンドの種類がサポートされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-120">The underlying data provider must support a command type before the option is available.</span></span>

### <a name="command-type-text"></a><span data-ttu-id="c9d9c-121">コマンドの種類 (Text)</span><span class="sxs-lookup"><span data-stu-id="c9d9c-121">Command Type Text</span></span>
 <span data-ttu-id="c9d9c-122">コマンドの種類が **[Text]** の場合、グラフィカル クエリ デザイナーに 4 つの領域 (ペイン) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-122">In **Text** type, the graphical query designer presents four areas, or panes.</span></span> <span data-ttu-id="c9d9c-123">[!INCLUDE[tsql](../../../includes/tsql-md.md)] クエリに対して、列、別名、並べ替えの値、およびフィルター値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-123">You can specify columns, aliases, sort values, and filter values for a [!INCLUDE[tsql](../../../includes/tsql-md.md)] query.</span></span> <span data-ttu-id="c9d9c-124">選択に基づいて生成されたクエリ テキストを確認し、クエリを実行して、結果セットを表示できます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-124">You can view the query text generated from your selections, run the query, and view the result set.</span></span> <span data-ttu-id="c9d9c-125">次の図に 4 つのペインを示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-125">The following figure shows the four panes.</span></span>

 <span data-ttu-id="c9d9c-126">![SQL クエリのグラフィカル クエリ デザイナー](../media/rsqd-dsaw-sql.gif "SQL クエリのグラフィカル クエリ デザイナー")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-126">![Graphical query designer for sql query](../media/rsqd-dsaw-sql.gif "Graphical query designer for sql query")</span></span>

 <span data-ttu-id="c9d9c-127">次の表に各ペインの機能を示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-127">The following table describes the function of each pane.</span></span>

|<span data-ttu-id="c9d9c-128">ペイン</span><span class="sxs-lookup"><span data-stu-id="c9d9c-128">Pane</span></span>|<span data-ttu-id="c9d9c-129">Function</span><span class="sxs-lookup"><span data-stu-id="c9d9c-129">Function</span></span>|
|----------|--------------|
|<span data-ttu-id="c9d9c-130">ダイアグラム</span><span class="sxs-lookup"><span data-stu-id="c9d9c-130">Diagram</span></span>|<span data-ttu-id="c9d9c-131">クエリのテーブルをグラフィカルに表示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-131">Displays graphic representations of the tables in the query.</span></span> <span data-ttu-id="c9d9c-132">フィールドを選択し、テーブル間のリレーションシップを定義する際に、このペインを使用します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-132">Use this pane to select fields and define relationships between tables.</span></span>|
|<span data-ttu-id="c9d9c-133">グリッド</span><span class="sxs-lookup"><span data-stu-id="c9d9c-133">Grid</span></span>|<span data-ttu-id="c9d9c-134">クエリにより返されるフィールドの一覧を表示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-134">Displays a list of fields returned by the query.</span></span> <span data-ttu-id="c9d9c-135">別名、並べ替え順、フィルター、グループ、パラメーターを定義するには、このペインを使用します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-135">Use this pane to define aliases, sort order, filters, groups, and parameters.</span></span>|
|<span data-ttu-id="c9d9c-136">SQL</span><span class="sxs-lookup"><span data-stu-id="c9d9c-136">SQL</span></span>|<span data-ttu-id="c9d9c-137">ダイアグラム ペインおよびグリッド ペインで表現された [!INCLUDE[tsql](../../../includes/tsql-md.md)] クエリを表示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-137">Displays the [!INCLUDE[tsql](../../../includes/tsql-md.md)] query represented by the diagram and Grid panes.</span></span> <span data-ttu-id="c9d9c-138">[!INCLUDE[tsql](../../../includes/tsql-md.md)]を使用してクエリを記述または更新するには、このペインを使用します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-138">Use this pane to write or update a query using [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>|
|<span data-ttu-id="c9d9c-139">結果</span><span class="sxs-lookup"><span data-stu-id="c9d9c-139">Result</span></span>|<span data-ttu-id="c9d9c-140">クエリの結果を表示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-140">Displays the results of the query.</span></span> <span data-ttu-id="c9d9c-141">クエリを実行するには、任意のペインで右クリックして、 **[実行]** をクリックするか、ツール バーの **[実行]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-141">To run the query, right-click in any pane, and then click **Run**, or click the **Run** button on the toolbar.</span></span>|

 <span data-ttu-id="c9d9c-142">最初の 3 つのペインのいずれかで情報を変更すると、変更内容が他のペインに反映されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-142">When you change information in any one of the first three panes, those changes will appear in the other panes.</span></span> <span data-ttu-id="c9d9c-143">たとえば、ダイアグラム ペインでテーブルを追加すると、そのテーブルは SQL ペインの [!INCLUDE[tsql](../../../includes/tsql-md.md)] クエリに自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-143">For example, if you add a table in the Diagram pane, it will automatically be added to the [!INCLUDE[tsql](../../../includes/tsql-md.md)] query in the SQL pane.</span></span> <span data-ttu-id="c9d9c-144">また、SQL ペインでクエリにフィールドを追加すると、そのフィールドはグリッド ペインの一覧に自動的に追加され、ダイアグラム ペインのテーブルも更新されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-144">Adding a field to the query in the SQL pane will automatically add the field to the list in the Grid pane and update the table in the Diagram pane.</span></span>

 <span data-ttu-id="c9d9c-145">詳細については、「[クエリおよびビュー デザイナー ツール &#40;Visual Database Tools&#41;](../../ssms/visual-db-tools/visual-database-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-145">For more information, see [Query and View Designer Tools &#40;Visual Database Tools&#41;](../../ssms/visual-db-tools/visual-database-tools.md).</span></span>

#### <a name="toolbar-for-the-graphical-query-designer"></a><span data-ttu-id="c9d9c-146">グラフィカル クエリ デザイナーのツール バー</span><span class="sxs-lookup"><span data-stu-id="c9d9c-146">Toolbar for the Graphical Query Designer</span></span>
 <span data-ttu-id="c9d9c-147">グラフィカル クエリ デザイナーのツール バーにあるボタンを使用すると、グラフィカル インターフェイスを使用して [!INCLUDE[tsql](../../../includes/tsql-md.md)] クエリをデザインできます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-147">The graphical query designer toolbar provides buttons to help you design [!INCLUDE[tsql](../../../includes/tsql-md.md)] queries using the graphical interface.</span></span>

|<span data-ttu-id="c9d9c-148">ボタン</span><span class="sxs-lookup"><span data-stu-id="c9d9c-148">Button</span></span>|<span data-ttu-id="c9d9c-149">説明</span><span class="sxs-lookup"><span data-stu-id="c9d9c-149">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="c9d9c-150">**[テキストとして編集]**</span><span class="sxs-lookup"><span data-stu-id="c9d9c-150">**Edit As Text**</span></span>|<span data-ttu-id="c9d9c-151">テキスト ベースのクエリ デザイナーと、グラフィカル クエリ デザイナー間で切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-151">Toggle between the text-based query designer and the graphical query designer.</span></span>|
|<span data-ttu-id="c9d9c-152">**[インポート]**</span><span class="sxs-lookup"><span data-stu-id="c9d9c-152">**Import**</span></span>|<span data-ttu-id="c9d9c-153">ファイルまたはレポートから既存のクエリをインポートします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-153">Import an existing query from a file or report.</span></span> <span data-ttu-id="c9d9c-154">サポートされているファイルの種類は sql と rdl だけです。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-154">Only file types .sql and .rdl are supported.</span></span> <span data-ttu-id="c9d9c-155">詳細については、「 [レポート埋め込みデータセットと共有データセット &#40;レポート ビルダーおよび SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-155">For more information, see [Report Embedded Datasets and Shared Datasets &#40;Report Builder and SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md).</span></span>|
|<span data-ttu-id="c9d9c-156">![[ダイアグラム ペインの表示/非表示] 切り替えボタン](../media/rsqdicon-showhidediagram.gif "[ダイアグラム ペインの表示/非表示] 切り替えボタン")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-156">![Show/Hide diagram pane toggle button](../media/rsqdicon-showhidediagram.gif "Show/Hide diagram pane toggle button")</span></span>|<span data-ttu-id="c9d9c-157">ダイアグラム ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-157">Show or hide the Diagram pane.</span></span>|
|<span data-ttu-id="c9d9c-158">![グリッド ペインの表示/非表示の切り替え](../media/rsqdicon-showhidegrid.gif "グリッド ペインの表示/非表示の切り替え")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-158">![Show or Hide Grid pane toggle](../media/rsqdicon-showhidegrid.gif "Show or Hide Grid pane toggle")</span></span>|<span data-ttu-id="c9d9c-159">グリッド ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-159">Show or hide the Grid pane.</span></span>|
|<span data-ttu-id="c9d9c-160">![SQL ペインの表示/非表示の切り替え](../media/rsqdicon-showhidesql.gif "SQL ペインの表示/非表示の切り替え")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-160">![Show or hide sql pane toggle](../media/rsqdicon-showhidesql.gif "Show or hide sql pane toggle")</span></span>|<span data-ttu-id="c9d9c-161">SQL ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-161">Show or hide the SQL pane.</span></span>|
|<span data-ttu-id="c9d9c-162">![結果ペインの表示/非表示の切り替え](../media/rsqdicon-showhideresult.gif "結果ペインの表示/非表示の切り替え")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-162">![Show or Hide Result pane toggle](../media/rsqdicon-showhideresult.gif "Show or Hide Result pane toggle")</span></span>|<span data-ttu-id="c9d9c-163">結果ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-163">Show or hide the Result pane.</span></span>|
|<span data-ttu-id="c9d9c-164">![クエリの実行](../../analysis-services/media/rsqdicon-run.gif "クエリを実行する")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-164">![Run the query](../../analysis-services/media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="c9d9c-165">クエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-165">Run the query.</span></span>|
|<span data-ttu-id="c9d9c-166">![SQL ペインの [SQL の確認] ボタン](../media/rsqdicon-verifysql.gif "SQL ペインの [SQL の確認] ボタン")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-166">![Verify SQL in SQL pane button](../media/rsqdicon-verifysql.gif "Verify SQL in SQL pane button")</span></span>|<span data-ttu-id="c9d9c-167">クエリ テキストの構文が正しいかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-167">Check that the syntax of the query text is correct.</span></span>|
|<span data-ttu-id="c9d9c-168">![選択したフィールドでの昇順による並べ替え](../media/rsqdicon-sortascending.gif "選択したフィールドでの昇順による並べ替え")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-168">![Set Sort Ascending on selected field](../media/rsqdicon-sortascending.gif "Set Sort Ascending on selected field")</span></span>|<span data-ttu-id="c9d9c-169">ダイアグラム ペインで選択した列の並べ替え順序を **[昇順で並べ替え]** に設定します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-169">Set the sort order to **Sort Ascending** for the selected column in the Diagram pane,</span></span>|
|<span data-ttu-id="c9d9c-170">![選択したフィールドでの降順による並べ替え](../media/rsqdicon-sortdescending.gif "選択したフィールドでの降順による並べ替え")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-170">![Set Sort Descending on selected field](../media/rsqdicon-sortdescending.gif "Set Sort Descending on selected field")</span></span>|<span data-ttu-id="c9d9c-171">ダイアグラム ペインで選択した列の並べ替え順序を **[降順で並べ替え]** に設定します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-171">Set the sort order to **Sort Descending** for the selected column in the Diagram pane,</span></span>|
|<span data-ttu-id="c9d9c-172">![選択したフィールドのフィルターの削除](../media/rsqdicon-removefilter.gif "選択したフィールドのフィルターの削除")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-172">![Remove filter on selected field](../media/rsqdicon-removefilter.gif "Remove filter on selected field")</span></span>|<span data-ttu-id="c9d9c-173">ダイアグラム ペインでフィルターがあるとマークされている選択された列のフィルター (![選択したフィルター列の隣にある画像のフィルター処理](../media/rsqdicon-filter.gif "選択したフィルター列の隣にある画像のフィルター処理")) を解除します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-173">Remove the filter for the selected column in the Diagram pane that is marked as having a filter (![Filter graphic next to selected filter column](../media/rsqdicon-filter.gif "Filter graphic next to selected filter column")).</span></span>|
|<span data-ttu-id="c9d9c-174">![選択したフィールドでの Group By の使用](../media/rsqdicon-usegroupby.gif "選択したフィールドでの Group By の使用")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-174">![Use Group By for the selected field](../media/rsqdicon-usegroupby.gif "Use Group By for the selected field")</span></span>|<span data-ttu-id="c9d9c-175">グリッド ペインの **[グループ化]** 列の表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-175">Show or hide the **Group By** column in the Grid pane.</span></span> <span data-ttu-id="c9d9c-176">**[グループ化]** が有効になっている場合、グリッド ペインに **[グループ化]** という列が追加で表示されます。このとき、クエリで選択されている各列の既定値は **[グループ化]** になります。つまり、選択列が SQL テキストの Group By 句に追加されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-176">When the **Group By** toggle is on, an extra column named **Group By** appears in the Grid pane, and each value for the selected columns in the query defaults to **Group By**, which causes the selected column to be included in a Group By clause in the SQL text.</span></span> <span data-ttu-id="c9d9c-177">[グループ化] ボタンは、GROUP BY 句を自動的に追加し、そこに、SELECT 句のすべての列を含める場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-177">Use the Group By button to automatically add a GROUP BY clause that includes all columns in the SELECT clause.</span></span> <span data-ttu-id="c9d9c-178">SELECT 句に集計関数の呼び出し (SUM(ColumnName) など) が含まれるとき、それを結果セットに表示する場合は、それぞれの非集計列を GROUP BY 句に追加します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-178">When your SELECT clause includes aggregate function calls (for example, SUM(ColumnName)), include each non-aggregate column in the GROUP BY clause if you want it to appear in the result set.</span></span><br /><br /> <span data-ttu-id="c9d9c-179">結果ペインに表示するには、その値の計算に使用する集計関数をクエリの各列に対して定義するか、SQL クエリの GROUP BY 句でクエリの列を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-179">To appear in the Result pane, each column in the query must have an aggregate function defined for use in calculating the value to display in the Result pane, or the column in the query has to be specified in the GROUP BY clause of the SQL query.</span></span>|
|<span data-ttu-id="c9d9c-180">![ダイアグラム ペインへの新しいテーブルの追加](../media/rsqdicon-addtable.gif "ダイアグラム ペインへの新しいテーブルの追加")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-180">![Add a new table to the diagram pane](../media/rsqdicon-addtable.gif "Add a new table to the diagram pane")</span></span>|<span data-ttu-id="c9d9c-181">データ ソースからダイアグラム ペインに新しいテーブルを追加します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-181">Add a new table from the data source to the Diagram pane.</span></span><br /><br /> <span data-ttu-id="c9d9c-182">**注** 新しいテーブルを追加する場合、クエリ デザイナーは、データ ソースに対する外部キー リレーションシップの検出を試みます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-182">**Note** When you add a new table, the query designer tries to match up foreign key relationships from the data source.</span></span> <span data-ttu-id="c9d9c-183">テーブルを追加した後、テーブル間のリンクによって表される外部キー リレーションシップが正しいことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-183">After you add a table, confirm that the foreign key relationships represented by linkages between the tables are correct.</span></span>|

#### <a name="example"></a><span data-ttu-id="c9d9c-184">例</span><span class="sxs-lookup"><span data-stu-id="c9d9c-184">Example</span></span>
 <span data-ttu-id="c9d9c-185">次のクエリは、 [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] データベースの **Person** テーブルから姓の一覧を取得します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-185">The following query returns the list of last names from the [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] database **Person** table:</span></span>

```
SELECT LastName FROM Person.Person;
```

 <span data-ttu-id="c9d9c-186">SQL ペインからストアド プロシージャを実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-186">You can also run stored procedures from the SQL pane.</span></span> <span data-ttu-id="c9d9c-187">次のクエリでは、 **データベースのストアド プロシージャ** uspGetEmployeeManagers [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] を実行しています。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-187">The following query runs the stored procedure **uspGetEmployeeManagers** in the [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] database:</span></span>

```
EXEC uspGetEmployeeManagers '1';
```

### <a name="command-type-tabledirect"></a><span data-ttu-id="c9d9c-188">コマンドの種類 (TableDirect)</span><span class="sxs-lookup"><span data-stu-id="c9d9c-188">Command Type TableDirect</span></span>
 <span data-ttu-id="c9d9c-189">コマンドの種類が **[TableDirect]** の場合、グラフィカル クエリ デザイナーには、データ ソースで利用可能なテーブルを一覧にしたドロップダウン リストと結果ペインが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-189">In **TableDirect** type, the graphical query designer displays a drop-down list of the available tables from the data source and a Result pane.</span></span> <span data-ttu-id="c9d9c-190">特定のテーブルを選択して、 **[実行]** をクリックすると、そのテーブルのすべての列が返されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-190">If you select a table and click the **Run** button, all the columns for that table are returned.</span></span>

> [!NOTE]
>  <span data-ttu-id="c9d9c-191">TableDirect 機能をサポートしているデータ ソースの種類は、 **OLE DB** と **ODBC** だけです。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-191">the TableDirect feature is supported only by **OLE DB** and **ODBC** data source types.</span></span>

 <span data-ttu-id="c9d9c-192">次の表に各ペインの機能を示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-192">The following table describes the function of each pane.</span></span>

|<span data-ttu-id="c9d9c-193">ペイン</span><span class="sxs-lookup"><span data-stu-id="c9d9c-193">Pane</span></span>|<span data-ttu-id="c9d9c-194">Function</span><span class="sxs-lookup"><span data-stu-id="c9d9c-194">Function</span></span>|
|----------|--------------|
|<span data-ttu-id="c9d9c-195">[テーブル] ドロップダウン リスト</span><span class="sxs-lookup"><span data-stu-id="c9d9c-195">Table drop-down list</span></span>|<span data-ttu-id="c9d9c-196">データ ソースで利用可能なすべてのテーブルが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-196">Lists all the available tables from the data source.</span></span> <span data-ttu-id="c9d9c-197">いずれかを一覧から選択するとアクティブになります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-197">Select one from the list to make it active.</span></span>|
|<span data-ttu-id="c9d9c-198">結果</span><span class="sxs-lookup"><span data-stu-id="c9d9c-198">Result</span></span>|<span data-ttu-id="c9d9c-199">選択したテーブルのすべての列が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-199">Displays all columns from the selected table.</span></span> <span data-ttu-id="c9d9c-200">テーブル クエリを実行するには、ツール バーの **[実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-200">To run the table query, click the **Run** button on the toolbar.</span></span>|

#### <a name="toolbar-buttons-for-the-command-type-tabledirect"></a><span data-ttu-id="c9d9c-201">ツール バー ボタン (コマンドの種類が TableDirect の場合)</span><span class="sxs-lookup"><span data-stu-id="c9d9c-201">Toolbar Buttons for the Command Type TableDirect</span></span>
 <span data-ttu-id="c9d9c-202">グラフィカル クエリ デザイナーのツール バーに、データ ソースで利用可能なテーブルが、ドロップダウン リストで一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-202">The graphical query designer toolbar provides a drop-down list of tables on the data source.</span></span> <span data-ttu-id="c9d9c-203">次の表は、各ボタンとその機能を示しています。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-203">The following table lists each button and its function.</span></span>

|<span data-ttu-id="c9d9c-204">ボタン</span><span class="sxs-lookup"><span data-stu-id="c9d9c-204">Button</span></span>|<span data-ttu-id="c9d9c-205">説明</span><span class="sxs-lookup"><span data-stu-id="c9d9c-205">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="c9d9c-206">**[テキストとして編集]**</span><span class="sxs-lookup"><span data-stu-id="c9d9c-206">**Edit As Text**</span></span>|<span data-ttu-id="c9d9c-207">テキスト ベースのクエリ デザイナーと、グラフィカル クエリ デザイナー間で切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-207">Toggle between the text-based query designer and the graphical query designer.</span></span>|
|<span data-ttu-id="c9d9c-208">**[インポート]**</span><span class="sxs-lookup"><span data-stu-id="c9d9c-208">**Import**</span></span>|<span data-ttu-id="c9d9c-209">ファイルまたはレポートから既存のクエリをインポートします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-209">Import an existing query from a file or report.</span></span> <span data-ttu-id="c9d9c-210">サポートされているファイルの種類は sql と rdl だけです。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-210">Only file types .sql and .rdl are supported.</span></span> <span data-ttu-id="c9d9c-211">詳細については、「 [レポート埋め込みデータセットと共有データセット &#40;レポート ビルダーおよび SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-211">For more information, see [Report Embedded Datasets and Shared Datasets &#40;Report Builder and SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md).</span></span>|
|<span data-ttu-id="c9d9c-212">![汎用クエリ デザイナー ボタンのアイコン](../media/icongenericquerydesigner.gif "汎用クエリ デザイナー ボタンのアイコン")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-212">![Icon of the Generic Query Designer button](../media/icongenericquerydesigner.gif "Icon of the Generic Query Designer button")</span></span>|<span data-ttu-id="c9d9c-213">クエリ テキスト ビューまたはストアド プロシージャ ビューを維持したまま、汎用クエリ デザイナーとグラフィカル クエリ デザイナーを切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-213">Toggle between generic query designer and graphical query designer, preserving the query text or stored procedure view.</span></span>|
|<span data-ttu-id="c9d9c-214">![クエリの実行](../../analysis-services/media/rsqdicon-run.gif "クエリを実行する")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-214">![Run the query](../../analysis-services/media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="c9d9c-215">選択したテーブルのすべての列が選択されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-215">Select all columns from the selected table.</span></span>|

### <a name="command-type-storedprocedure"></a><span data-ttu-id="c9d9c-216">コマンドの種類 (StoredProcedure)</span><span class="sxs-lookup"><span data-stu-id="c9d9c-216">Command Type StoredProcedure</span></span>
 <span data-ttu-id="c9d9c-217">コマンドの種類が **[StoredProcedure]** の場合、グラフィカル クエリ デザイナーには、データ ソースで利用可能なストアド プロシージャを一覧にしたドロップダウン リストと結果ペインが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-217">In **StoredProcedure** type, the graphical query designer displays a drop-down list of the available stored procedures from the data source and a Result pane.</span></span> <span data-ttu-id="c9d9c-218">次の表に各ペインの機能を示します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-218">The following table describes the function of each pane.</span></span>

|<span data-ttu-id="c9d9c-219">ペイン</span><span class="sxs-lookup"><span data-stu-id="c9d9c-219">Pane</span></span>|<span data-ttu-id="c9d9c-220">Function</span><span class="sxs-lookup"><span data-stu-id="c9d9c-220">Function</span></span>|
|----------|--------------|
|<span data-ttu-id="c9d9c-221">[ストアド プロシージャ] ドロップダウン リスト</span><span class="sxs-lookup"><span data-stu-id="c9d9c-221">Stored procedure drop-down list</span></span>|<span data-ttu-id="c9d9c-222">データ ソースで利用可能なすべてのストアド プロシージャが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-222">Lists all the available stored procedures from the data source.</span></span> <span data-ttu-id="c9d9c-223">いずれかを一覧から選択するとアクティブになります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-223">Select one from the list to make it active.</span></span>|
|<span data-ttu-id="c9d9c-224">結果</span><span class="sxs-lookup"><span data-stu-id="c9d9c-224">Result</span></span>|<span data-ttu-id="c9d9c-225">ストアド プロシージャの実行結果が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-225">Displays the result of running the stored procedure.</span></span> <span data-ttu-id="c9d9c-226">選択したストアド プロシージャを実行するには、ツール バーの **[実行]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-226">To run the selected stored procedure, click the **Run** button on the toolbar.</span></span>|

#### <a name="toolbar-buttons-for-command-type-storedprocedure"></a><span data-ttu-id="c9d9c-227">ツール バー ボタン (コマンドの種類が StoredProcedure の場合)</span><span class="sxs-lookup"><span data-stu-id="c9d9c-227">Toolbar Buttons for Command Type StoredProcedure</span></span>
 <span data-ttu-id="c9d9c-228">グラフィカル クエリ デザイナーのツール バーに、データ ソースで利用可能なストアド プロシージャが、ドロップダウン リストで一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-228">The graphical query designer toolbar provides a drop-down list of stored procedures on the data source.</span></span> <span data-ttu-id="c9d9c-229">次の表は、各ボタンとその機能を示しています。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-229">The following table lists each button and its function.</span></span>

|<span data-ttu-id="c9d9c-230">ボタン</span><span class="sxs-lookup"><span data-stu-id="c9d9c-230">Button</span></span>|<span data-ttu-id="c9d9c-231">説明</span><span class="sxs-lookup"><span data-stu-id="c9d9c-231">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="c9d9c-232">**[テキストとして編集]**</span><span class="sxs-lookup"><span data-stu-id="c9d9c-232">**Edit As Text**</span></span>|<span data-ttu-id="c9d9c-233">テキスト ベースのクエリ デザイナーと、グラフィカル クエリ デザイナー間で切り替えます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-233">Toggle between the text-based query designer and the graphical query designer.</span></span>|
|<span data-ttu-id="c9d9c-234">**[インポート]**</span><span class="sxs-lookup"><span data-stu-id="c9d9c-234">**Import**</span></span>|<span data-ttu-id="c9d9c-235">ファイルまたはレポートから既存のクエリをインポートします。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-235">Import an existing query from a file or report.</span></span> <span data-ttu-id="c9d9c-236">サポートされているファイルの種類は sql と rdl だけです。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-236">Only file types .sql and .rdl are supported.</span></span> <span data-ttu-id="c9d9c-237">詳細については、「 [レポート埋め込みデータセットと共有データセット &#40;レポート ビルダーおよび SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-237">For more information, see [Report Embedded Datasets and Shared Datasets &#40;Report Builder and SSRS&#41;](report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md).</span></span>|
|<span data-ttu-id="c9d9c-238">![クエリの実行](../../analysis-services/media/rsqdicon-run.gif "クエリを実行する")</span><span class="sxs-lookup"><span data-stu-id="c9d9c-238">![Run the query](../../analysis-services/media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="c9d9c-239">選択されたストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-239">Run the selected stored procedure.</span></span>|
|<span data-ttu-id="c9d9c-240">[ストアド プロシージャ] ドロップダウン リスト</span><span class="sxs-lookup"><span data-stu-id="c9d9c-240">Stored procedure drop-down list</span></span>|<span data-ttu-id="c9d9c-241">下矢印をクリックすると、データ ソースで利用可能なストアド プロシージャが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-241">Click the down arrow to display a list of available stored procedures from the data source.</span></span> <span data-ttu-id="c9d9c-242">この一覧から目的のストアド プロシージャをクリックして選択します。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-242">Click any stored procedure from the list to select it.</span></span>|

#### <a name="example"></a><span data-ttu-id="c9d9c-243">例</span><span class="sxs-lookup"><span data-stu-id="c9d9c-243">Example</span></span>
 <span data-ttu-id="c9d9c-244">次のストアド プロシージャでは、 [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] データベースから、マネージャーの指揮系統リストを呼び出しています。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-244">The following stored procedure calls a chain-of-command list of managers from the [!INCLUDE[ssSampleDBobject](../../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="c9d9c-245">このストアド プロシージャは、パラメーターとして *BusinessEntityID* を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-245">This stored procedure accepts *BusinessEntityID* as parameter.</span></span> <span data-ttu-id="c9d9c-246">任意の短整数値を入力できます。</span><span class="sxs-lookup"><span data-stu-id="c9d9c-246">You can enter any small integer.</span></span>

 `uspGetEmployeeManagers '1';`

## <a name="see-also"></a><span data-ttu-id="c9d9c-247">参照</span><span class="sxs-lookup"><span data-stu-id="c9d9c-247">See Also</span></span>
 <span data-ttu-id="c9d9c-248">[レポートデザイナー &#40;SQL Server Data Tools のクエリデザインツール](query-design-tools-ssrs.md)[レポートにデータを追加&#41;レポート &#40;レポートビルダーと Ssrs&#41;](report-datasets-ssrs.md) SQL Server[接続の種類](sql-server-connection-type-ssrs.md)&#40;ssrs&#41;OLE DB[接続](ole-db-connection-type-ssrs.md)の種類 &#40;ssrs&#41;[データをレポートに追加](report-datasets-ssrs.md) [&#40;Ssrs](oracle-connection-type-ssrs.md)レポートビルダー [Rsreportdesigner 構成ファイル](../report-server/rsreportdesigner-configuration-file.md)の[デザインクエリおよびビュー&#41;Visual Database ツール &#40;方法に関するトピック](../../ssms/visual-db-tools/design-queries-and-views-how-to-topics-visual-database-tools.md)</span><span class="sxs-lookup"><span data-stu-id="c9d9c-248">[Query Design Tools in Report Designer SQL Server Data Tools &#40;SSRS&#41;](query-design-tools-ssrs.md) [Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md) [SQL Server Connection Type &#40;SSRS&#41;](sql-server-connection-type-ssrs.md) [OLE DB Connection Type &#40;SSRS&#41;](ole-db-connection-type-ssrs.md) [Add Data to a Report &#40;Report Builder and SSRS&#41;](report-datasets-ssrs.md) [Oracle Connection Type &#40;SSRS&#41;](oracle-connection-type-ssrs.md) [RSReportDesigner Configuration File](../report-server/rsreportdesigner-configuration-file.md) [Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;](../../ssms/visual-db-tools/design-queries-and-views-how-to-topics-visual-database-tools.md)</span></span>


