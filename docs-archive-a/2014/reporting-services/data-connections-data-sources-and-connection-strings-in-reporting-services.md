---
title: Reporting Services のデータ接続、データソース、および接続文字列 |Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- connections [Reporting Services], data sources
- reports [Reporting Services], data
- expressions [Reporting Services], data sources
- data sources [Reporting Services], connections
- connection strings [Reporting Services]
- shared data sources [Reporting Services]
- Reporting Services, data sources
- logins [Reporting Services]
ms.assetid: 4d8f0ae1-102b-4b3d-9155-fa584c962c9e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 320d538ea7d2b4fa971f3df8c8e1e4165052b79f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87641512"
---
# <a name="data-connections-data-sources-and-connection-strings-in-reporting-services"></a><span data-ttu-id="efcbd-102">Reporting Services でのデータ接続、データ ソース、および接続文字列</span><span class="sxs-lookup"><span data-stu-id="efcbd-102">Data Connections, Data Sources, and Connection Strings in Reporting Services</span></span>
  <span data-ttu-id="efcbd-103">[!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] レポートにデータを含めるには、最初に *データ ソース* および *データセット*を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-103">To include data in a [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] report, you must first create *data sources* and *datasets*.</span></span> <span data-ttu-id="efcbd-104">このトピックでは、データ ソースの種類、データ ソースの作成方法、およびデータ ソースの資格情報に関連する重要な情報について説明します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-104">This topic explains the type of data sources, how to create data sources, and important information related to data source credentials.</span></span> <span data-ttu-id="efcbd-105">データ ソースには、データ ソースの種類、接続情報、および使用する資格情報の種類が含まれています。</span><span class="sxs-lookup"><span data-stu-id="efcbd-105">A data source includes the data source type, connection information, and the type of credentials to use.</span></span> <span data-ttu-id="efcbd-106">データ ソースには、埋め込みと共有の 2 種類があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-106">There are two types of data sources: embedded and shared.</span></span> <span data-ttu-id="efcbd-107">埋め込みデータ ソースは、レポート内で定義され、そのレポートでのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-107">An embedded data source is defined in the report and used only by that report.</span></span> <span data-ttu-id="efcbd-108">共有データ ソースは、レポートとは別のアイテムとして定義され、複数のレポートで使用できます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-108">A shared data source is defined independently from a report and can be used by multiple reports.</span></span> <span data-ttu-id="efcbd-109">詳細については、「[埋め込みおよび共有のデータ接続またはデータ ソース (レポート ビルダーおよび SSRS)](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md)」および「[埋め込みデータセットと共有データセット (レポート ビルダーおよび SSRS)](report-data/embedded-and-shared-datasets-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-109">For more information, see [Embedded and Shared Data Connections or Data Sources &#40;Report Builder and SSRS&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) and [Embedded and Shared Datasets &#40;Report Builder and SSRS&#41;](report-data/embedded-and-shared-datasets-report-builder-and-ssrs.md).</span></span>

||
|-|
|<span data-ttu-id="efcbd-110">**[!INCLUDE[applies](../includes/applies-md.md)]** [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] ネイティブ モード &#124; [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] SharePoint モード</span><span class="sxs-lookup"><span data-stu-id="efcbd-110">**[!INCLUDE[applies](../includes/applies-md.md)]**  [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] Native mode &#124; [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] SharePoint mode</span></span>|

> [!NOTE]
>  [!INCLUDE[ssRBRDDup](../includes/ssrbrddup-md.md)]



##  <a name="embedded-and-shared-data-sources"></a><a name="bkmk_data_sources"></a><span data-ttu-id="efcbd-111">埋め込みデータソースと共有データソース</span><span class="sxs-lookup"><span data-stu-id="efcbd-111">Embedded and shared data sources</span></span>
 <span data-ttu-id="efcbd-112">埋め込みデータ ソースと共有データ ソースとでは、作成、格納、および管理の方法が異なります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-112">The difference between the embedded and shared data sources is in how they are created, stored, and managed.</span></span>

-   <span data-ttu-id="efcbd-113">レポート デザイナーで、 [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] プロジェクトの一部として、埋め込みデータ ソースまたは共有データ ソースを作成します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-113">In Report Designer, create embedded or shared data sources as part of a [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] project.</span></span> <span data-ttu-id="efcbd-114">プレビュー用にローカルで使用するか、プロジェクトの一部としてレポート サーバーまたは SharePoint サイトに配置するかを制御することができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-114">You can control whether to use them locally for preview or to deploy them as part of the project to a report server or SharePoint site.</span></span> <span data-ttu-id="efcbd-115">自分のコンピューターおよびレポート サーバー、さらにレポートの配置先の SharePoint サイトにインストールされているカスタム データ拡張機能を使用できます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-115">You can use custom data extensions that have been installed on your computer and on the report server or SharePoint site where you deploy your reports.</span></span>

     <span data-ttu-id="efcbd-116">システム管理者は、別のデータ処理拡張機能および .NET Framework データ プロバイダーをインストールおよび設定できます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-116">System administrators can install and configure additional data processing extensions and .NET Framework data providers.</span></span> <span data-ttu-id="efcbd-117">詳細については、「[データ処理拡張機能と .NET Framework データ プロバイダー (SSRS)](report-data/data-processing-extensions-and-net-framework-data-providers-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-117">For more information, see [Data Processing Extensions and .NET Framework Data Providers &#40;SSRS&#41;](report-data/data-processing-extensions-and-net-framework-data-providers-ssrs.md).</span></span>

     <span data-ttu-id="efcbd-118"><xref:Microsoft.ReportingServices.DataProcessing> API を使ってデータ処理拡張機能を作成すると、その他の種類のデータ ソースもサポートできます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-118">Developers can use the <xref:Microsoft.ReportingServices.DataProcessing> API to create data processing extensions to support additional types of data sources.</span></span>

-   <span data-ttu-id="efcbd-119">レポート ビルダーで、レポート サーバーまたは SharePoint サイト上の保存先を参照して共有データ ソースを選択するか、または、レポートに埋め込みデータ ソースを作成します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-119">In Report Builder, browse to a report server or SharePoint site and select shared data sources or create embedded data sources in the report.</span></span> <span data-ttu-id="efcbd-120">共有データ ソースは、レポート ビルダーで作成することはできません。</span><span class="sxs-lookup"><span data-stu-id="efcbd-120">You cannot create a shared data source in Report Builder.</span></span> <span data-ttu-id="efcbd-121">レポート ビルダーでカスタム データ拡張機能を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="efcbd-121">You cannot use custom data extensions in Report Builder</span></span>

##  <a name="built-in-data-extensions"></a><a name="bkmk_DataConnections"></a><span data-ttu-id="efcbd-122">組み込みデータ拡張機能</span><span class="sxs-lookup"><span data-stu-id="efcbd-122">Built-in data extensions</span></span>
 <span data-ttu-id="efcbd-123">[!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] の既定のデータ拡張機能には、次の種類のデータ接続が含まれます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-123">Default data extensions in [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] include the following types of data connections:</span></span>

-   <span data-ttu-id="efcbd-124">Microsoft SQL Server</span><span class="sxs-lookup"><span data-stu-id="efcbd-124">Microsoft SQL Server</span></span>

-   <span data-ttu-id="efcbd-125">Microsoft SQL Server Analysis Services</span><span class="sxs-lookup"><span data-stu-id="efcbd-125">Microsoft SQL Server Analysis Services</span></span>

-   <span data-ttu-id="efcbd-126">Microsoft SharePoint リスト</span><span class="sxs-lookup"><span data-stu-id="efcbd-126">Microsoft SharePoint List</span></span>

-   [!INCLUDE[ssSDSfull](../includes/sssdsfull-md.md)]

-   <span data-ttu-id="efcbd-127">Microsoft SQL Server 並列データ ウェアハウス</span><span class="sxs-lookup"><span data-stu-id="efcbd-127">Microsoft SQL Server Parallel Data Warehouse</span></span>

-   <span data-ttu-id="efcbd-128">OLE DB (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="efcbd-128">OLE DB</span></span>

-   <span data-ttu-id="efcbd-129">Oracle</span><span class="sxs-lookup"><span data-stu-id="efcbd-129">Oracle</span></span>

-   <span data-ttu-id="efcbd-130">SAP NetWeaver BI</span><span class="sxs-lookup"><span data-stu-id="efcbd-130">SAP NetWeaver BI</span></span>

-   <span data-ttu-id="efcbd-131">Hyperion Essbase</span><span class="sxs-lookup"><span data-stu-id="efcbd-131">Hyperion Essbase</span></span>

-   <span data-ttu-id="efcbd-132">Teradata</span><span class="sxs-lookup"><span data-stu-id="efcbd-132">Teradata</span></span>

-   <span data-ttu-id="efcbd-133">XML</span><span class="sxs-lookup"><span data-stu-id="efcbd-133">XML</span></span>

-   <span data-ttu-id="efcbd-134">ODBC</span><span class="sxs-lookup"><span data-stu-id="efcbd-134">ODBC</span></span>

-   <span data-ttu-id="efcbd-135">Power View 用 Microsoft BI セマンティック モデル: PowerPivot ギャラリーおよび [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)]用に構成されている SharePoint サイトでは、このデータ ソースの種類を使用できます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-135">Microsoft BI Semantic Model for Power View : On a SharePoint site that has been configured for a PowerPivot gallery and [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)], this data source type is available.</span></span> <span data-ttu-id="efcbd-136">このデータ ソースの種類は、 [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)] プレゼンテーションにのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-136">This data source type is used only for [!INCLUDE[ssCrescent](../includes/sscrescent-md.md)] presentations.</span></span> <span data-ttu-id="efcbd-137">詳細については、「 [Power View に適した BI セマンティック表形式モデルの作成 (ビデオ)](https://technet.microsoft.com/video/building-the-perfect-bi-semantic-tabular-models-for-power-view.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-137">For more information, see [Building the Perfect BI Semantic Tabular Models for Power View](https://technet.microsoft.com/video/building-the-perfect-bi-semantic-tabular-models-for-power-view.aspx).</span></span>

 <span data-ttu-id="efcbd-138">[!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] でサポートされるデータ ソースおよびバージョンの一覧については、「[Reporting Services でサポートされるデータ ソース (SSRS)](create-deploy-and-manage-mobile-and-paginated-reports.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-138">For a full list of data sources and versions [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)] supports, see [Data Sources Supported by Reporting Services &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md).</span></span>

##  <a name="create-a-data-source"></a><a name="bkmk_create_data_source"></a><span data-ttu-id="efcbd-139">データソースの作成</span><span class="sxs-lookup"><span data-stu-id="efcbd-139">Create a data source</span></span>
 <span data-ttu-id="efcbd-140">データ ソースを作成するには、次の情報が必要です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-140">To create a data source, you must have the following information:</span></span>

-   <span data-ttu-id="efcbd-141">**データソースの種類**接続の種類 (など) [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="efcbd-141">**Data source type** The connection type, for example, [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="efcbd-142">この値は、接続の種類のドロップダウン リストから選択します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-142">Choose this value from the drop-down list of connection types.</span></span>

-   <span data-ttu-id="efcbd-143">**接続情報** 接続情報には、データ ソースの名前と場所、および各データ プロバイダーに固有の接続プロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-143">**Connection information** Connection information includes the name and location of the data source, and connection properties that are specific to each data provider.</span></span> <span data-ttu-id="efcbd-144">*接続文字列* は、接続情報のテキスト表現です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-144">The *connection string* is the text representation of connection information.</span></span> <span data-ttu-id="efcbd-145">たとえば、データ ソースが SQL Server データベースの場合は、データベースの名前を指定することができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-145">For example, if the data source is a SQL Server database, you can specify the name of the database.</span></span> <span data-ttu-id="efcbd-146">埋め込みデータ ソースの場合は、実行時に評価される式に基づく接続文字列を記述することもできます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-146">For embedded data sources, you can also write expression-based connection strings that are evaluated at run time.</span></span> <span data-ttu-id="efcbd-147">詳細については、このトピックで後述する「 [式に基づく接続文字列](#bkmk_Expressions_in_connection_strings) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-147">For more information, see [Expression-based Connection Strings](#bkmk_Expressions_in_connection_strings) later in this topic.</span></span>

-   <span data-ttu-id="efcbd-148">**資格情報** データにアクセスするために必要な資格情報を指定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-148">**Credentials** You provide the credentials that are needed to access the data.</span></span> <span data-ttu-id="efcbd-149">データ ソースおよびデータ ソースの特定のデータにアクセスするには、データ ソースの所有者から適切な権限を許可されていることが必要です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-149">The data source owner must have granted you the appropriate permissions to access both the data source and the specific data on the data source.</span></span> <span data-ttu-id="efcbd-150">たとえば、ネットワーク サーバーにインストールされた [!INCLUDE[ssSampleDBnormal](../includes/sssampledbnormal-md.md)] サンプル データベースに接続するには、サーバーに接続する権限およびデータベースにアクセスする読み取り専用権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-150">For example, to connect to the [!INCLUDE[ssSampleDBnormal](../includes/sssampledbnormal-md.md)] sample database installed on a network server, you must have permission to connect to the server and also read-only permission to access the database.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="efcbd-151">資格情報は、あえてデータ ソースとは別に管理されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-151">By design, credentials are managed independently from data sources.</span></span> <span data-ttu-id="efcbd-152">ローカル システムでレポートのプレビューに使用する資格情報は、パブリッシュされたレポートの表示に必要な資格情報とは異なります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-152">Credentials that you use to preview your report on a local system may differ from credentials you need to view your published report.</span></span> <span data-ttu-id="efcbd-153">レポート サーバーまたは SharePoint サイトにデータ ソースを保存した後は、その場所にあるデータを操作する関係上、資格情報の変更が必要となる場合があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-153">After you save a data source to the report server or SharePoint site, you might need to change the credentials to work from that location.</span></span> <span data-ttu-id="efcbd-154">詳細については、「 [データ ソースの資格情報](#bkmk_credentials)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-154">For more information, see [Credentials for Data Sources](#bkmk_credentials).</span></span>

> [!NOTE]
>  <span data-ttu-id="efcbd-155">レポートの埋め込みデータ ソースを [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)]で作成する場合、データ ソースの作成は、レポート デザイナーのソリューション エクスプローラーまたはレポート データ ペインで行う必要があります。サーバー エクスプローラーでデータ ソースを作成することは避けてください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-155">When you create an embedded data source for a report in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], you must create the data source in Report Designer in either Solution Explorer or the Report Data pane, but not in Server Explorer.</span></span> <span data-ttu-id="efcbd-156">サーバー エクスプローラーで作成された [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データ ソースは、[!INCLUDE[vsprvs](../includes/vsprvs-md.md)] レポート デザイナーではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="efcbd-156">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Report Designer does not support [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] data sources created in Server Explorer.</span></span>

 <span data-ttu-id="efcbd-157">レポート データ ペインには、レポートに追加された共有データ ソースへの参照と埋め込みデータ ソースが表示されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-157">The Report Data pane displays embedded data sources and references to shared data sources that have been added to the report.</span></span> <span data-ttu-id="efcbd-158">レポート ビルダーにおける共有データ ソースの参照先は、レポート サーバー上または SharePoint サイト上の共有データ ソースです。</span><span class="sxs-lookup"><span data-stu-id="efcbd-158">In Report Builder, a shared data source reference points to a shared data source on a report server or SharePoint site.</span></span> <span data-ttu-id="efcbd-159">レポート デザイナーにおける共有データ ソースの参照先は、ソリューション エクスプローラーの [共有データ ソース] フォルダーに表示される共有データ ソースです。</span><span class="sxs-lookup"><span data-stu-id="efcbd-159">In Report Designer, a shared data source reference points to a shared data source in Solution Explorer under the Shared Data Source folder.</span></span>

##  <a name="credentials-for-data-sources"></a><a name="bkmk_credentials"></a><span data-ttu-id="efcbd-160">データソースの資格情報</span><span class="sxs-lookup"><span data-stu-id="efcbd-160">Credentials for data sources</span></span>
 <span data-ttu-id="efcbd-161">資格情報は、接続情報とは別に保存および管理できる設計になっています。</span><span class="sxs-lookup"><span data-stu-id="efcbd-161">By design, credentials can be saved and managed independently from connection information.</span></span> <span data-ttu-id="efcbd-162">資格情報は、データ ソースの作成、データセット クエリの実行、レポートのプレビューなどで使用されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-162">Credentials are used to create a data source, to run a dataset query, and to preview a report.</span></span>

> [!NOTE]
>  <span data-ttu-id="efcbd-163">ログイン名やパスワードなどのログイン情報は、データ ソースの接続プロパティに含めないようにすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="efcbd-163">We recommend that you do not include login information, such as login names and passwords, to the connection properties of the data source.</span></span> <span data-ttu-id="efcbd-164">可能な限り、資格情報が保存された共有データ ソースを使用してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-164">Use shared data sources with stored credentials whenever possible.</span></span> <span data-ttu-id="efcbd-165">データ接続を作成する場合やデータセット クエリを実行する場合は、作成環境で **[データ ソース]** ダイアログ ボックスの [資格情報] ページを使用して資格情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-165">In an authoring environment, use the Credentials page of the **Data Source** dialog box to enter credentials when you create a data connection or run a dataset query.</span></span>

 <span data-ttu-id="efcbd-166">自分のコンピューターからデータにアクセスする際に入力する資格情報は、ローカルのプロジェクト構成ファイルに安全に保管され、そのコンピューターに固有の情報となります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-166">Credentials that you enter for data access from your computer are stored securely in the local project configuration file and are specific to your computer.</span></span> <span data-ttu-id="efcbd-167">プロジェクト ファイルを別のコンピューターにコピーするときは、データ ソースの資格情報を再定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-167">If you copy the project files to another computer, you must redefine the credentials for the data source.</span></span>

 <span data-ttu-id="efcbd-168">レポート サーバーまたは SharePoint サイトにレポートを配置した場合、埋め込みデータ ソースと共有データ ソースは別々に管理されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-168">When you deploy a report to the report server or SharePoint site, its embedded and shared data sources are managed independently.</span></span> <span data-ttu-id="efcbd-169">ローカル コンピューターからデータにアクセスするために必要なデータ ソース資格情報は、レポート サーバーからデータにアクセスするために必要な資格情報とは異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-169">The data source credentials needed to access the data from your computer may differ from the credentials needed for the report server to access the data.</span></span>

 <span data-ttu-id="efcbd-170">![メモ](media/rs-fyinote.png "注意")レポートをパブリッシュした後も、データソース接続が正常に接続されていることを確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="efcbd-170">![note](media/rs-fyinote.png "note")A good practice is to verify that the data source connections continue to connect successfully after you publish a report.</span></span> <span data-ttu-id="efcbd-171">資格情報を変更する必要がある場合は、レポート サーバー上で直接変更できます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-171">If you need to change the credentials, you can modify them directly on the report server.</span></span>

 <span data-ttu-id="efcbd-172">レポートで使用されるデータソースを変更するには、ネイティブモードレポートマネージャーまたは SharePoint モードのドキュメントライブラリからレポートのプロパティを変更します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-172">To change the data sources that a report uses, you can modify the report properties in Native mode Report Manager or from document libraries in SharePoint mode.</span></span> <span data-ttu-id="efcbd-173">詳細については、「</span><span class="sxs-lookup"><span data-stu-id="efcbd-173">For more information, see the following:</span></span>

-   <span data-ttu-id="efcbd-174">[Reporting Services データソース](report-data/store-credentials-in-a-reporting-services-data-source.md)[ストアの資格情報を Reporting Services データソースに](report-data/store-credentials-in-a-reporting-services-data-source.md)格納する</span><span class="sxs-lookup"><span data-stu-id="efcbd-174">[Store Credentials in a Reporting Services Data Source](report-data/store-credentials-in-a-reporting-services-data-source.md) [Store Credentials in a Reporting Services Data Source](report-data/store-credentials-in-a-reporting-services-data-source.md)</span></span>

-   [<span data-ttu-id="efcbd-175">レポート データ ソースに関する資格情報と接続情報を指定する</span><span class="sxs-lookup"><span data-stu-id="efcbd-175">Specify Credential and Connection Information for Report Data Sources</span></span>](report-data/specify-credential-and-connection-information-for-report-data-sources.md)

-   [<span data-ttu-id="efcbd-176">カスタム データ処理拡張機能の接続を指定する</span><span class="sxs-lookup"><span data-stu-id="efcbd-176">Specify Connections for Custom Data Processing Extensions</span></span>](report-data/specify-connections-for-custom-data-processing-extensions.md)

-   [<span data-ttu-id="efcbd-177">レポート ビルダーでの資格情報の指定</span><span class="sxs-lookup"><span data-stu-id="efcbd-177">Specify Credentials in Report Builder</span></span>](../../2014/reporting-services/specify-credentials-in-report-builder.md)

-   [<span data-ttu-id="efcbd-178">データ接続またはデータソース &#40;レポートビルダーと SSRS&#41;に追加して検証する</span><span class="sxs-lookup"><span data-stu-id="efcbd-178">Add and Verify a Data Connection or Data Source &#40;Report Builder and SSRS&#41;</span></span>](report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)

##  <a name="common-connection-string-examples"></a><a name="bkmk_connection_examples"></a><span data-ttu-id="efcbd-179">一般的な接続文字列の例</span><span class="sxs-lookup"><span data-stu-id="efcbd-179">Common connection string examples</span></span>
 <span data-ttu-id="efcbd-180">接続文字列は、データ プロバイダーの接続プロパティのテキスト表現です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-180">Connection strings are the text representation of connection properties for a data provider.</span></span> <span data-ttu-id="efcbd-181">次の表に、さまざまなデータ接続に使用される接続文字列の例を示します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-181">The following table lists examples of connections strings for various data connection types.</span></span>

|<span data-ttu-id="efcbd-182">**データ ソース**</span><span class="sxs-lookup"><span data-stu-id="efcbd-182">**Data source**</span></span>|<span data-ttu-id="efcbd-183">**例**</span><span class="sxs-lookup"><span data-stu-id="efcbd-183">**Example**</span></span>|<span data-ttu-id="efcbd-184">**説明**</span><span class="sxs-lookup"><span data-stu-id="efcbd-184">**Description**</span></span>|
|---------------------|-----------------|---------------------|
|<span data-ttu-id="efcbd-185">ローカル サーバーの SQL Server データベース</span><span class="sxs-lookup"><span data-stu-id="efcbd-185">SQL Server database on the local server</span></span>|`data source="(local)";initial catalog=AdventureWorks`|<span data-ttu-id="efcbd-186">データソースの種類をに設定 `Microsoft SQL Server` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-186">Set data source type to `Microsoft SQL Server`.</span></span> <span data-ttu-id="efcbd-187">詳細については、「[SQL Server の接続の種類 (SSRS)](report-data/sql-server-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-187">For more information, see [SQL Server Connection Type &#40;SSRS&#41;](report-data/sql-server-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-188">ローカル サーバーの SQL Server データベース</span><span class="sxs-lookup"><span data-stu-id="efcbd-188">SQL Server database on the local server</span></span>|`data source="(local)";initial catalog=AdventureWorks`|<span data-ttu-id="efcbd-189">データソースの種類をに設定 `Microsoft SQL Server` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-189">Set data source type to `Microsoft SQL Server`.</span></span>|
|<span data-ttu-id="efcbd-190">SQL Server インスタンス</span><span class="sxs-lookup"><span data-stu-id="efcbd-190">SQL Server Instance</span></span><br /><br /> <span data-ttu-id="efcbd-191">database</span><span class="sxs-lookup"><span data-stu-id="efcbd-191">database</span></span>|`Data Source=localhost\MSSQL10_50.InstanceName; Initial Catalog=AdventureWorks`|<span data-ttu-id="efcbd-192">データソースの種類をに設定 `Microsoft SQL Server` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-192">Set data source type to `Microsoft SQL Server`.</span></span>|
|<span data-ttu-id="efcbd-193">SQL Server Express データベース</span><span class="sxs-lookup"><span data-stu-id="efcbd-193">SQL Server Express database</span></span>|`Data Source=localhost\MSSQL10_50.SQLEXPRESS; Initial Catalog=AdventureWorks`|<span data-ttu-id="efcbd-194">データソースの種類をに設定 `Microsoft SQL Server` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-194">Set data source type to `Microsoft SQL Server`.</span></span>|
|<span data-ttu-id="efcbd-195">クラウド内の [!INCLUDE[ssSDS](../includes/sssds-md.md)]</span><span class="sxs-lookup"><span data-stu-id="efcbd-195">[!INCLUDE[ssSDS](../includes/sssds-md.md)] in the cloud</span></span>|`Data Source=<host>;Initial Catalog=AdventureWorks; Encrypt=True`|<span data-ttu-id="efcbd-196">データソースの種類をに設定 `Azure SQL Database` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-196">Set data source type to `Azure SQL Database`.</span></span> <span data-ttu-id="efcbd-197">詳細については、「[SQL Azure の接続の種類 (SSRS)](report-data/sql-azure-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-197">For more information, see [SQL Azure Connection Type &#40;SSRS&#41;](report-data/sql-azure-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-198">SQL Server 並列データ ウェアハウス</span><span class="sxs-lookup"><span data-stu-id="efcbd-198">SQL Server Parallel Data Warehouse</span></span>|`HOST=<IP address>;database= AdventureWorks; port=<port>`|<span data-ttu-id="efcbd-199">データソースの種類をに設定 `Microsoft SQL Server Parallel Data Warehouse` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-199">Set data source type to `Microsoft SQL Server Parallel Data Warehouse`.</span></span> <span data-ttu-id="efcbd-200">詳細については、「[SQL Server 並列データ ウェアハウスの接続の種類 &#40;SSRS&#41;](report-data/sql-server-parallel-data-warehouse-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-200">For more information, see [SQL Server Parallel Data Warehouse Connection Type &#40;SSRS&#41;](report-data/sql-server-parallel-data-warehouse-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-201">ローカル サーバーの Analysis Services データベース</span><span class="sxs-lookup"><span data-stu-id="efcbd-201">Analysis Services database on the local server</span></span>|`data source=localhost;initial catalog=Adventure Works DW`|<span data-ttu-id="efcbd-202">データソースの種類をに設定 `Microsoft SQL Server Analysis Services` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-202">Set data source type to `Microsoft SQL Server Analysis Services`.</span></span> <span data-ttu-id="efcbd-203">詳細については、「[MDX のための Analysis Services の接続の種類 &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-mdx-ssrs.md)」または「[DMX のための Analysis Services の接続の種類 &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-dmx-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-203">For more information, see [Analysis Services Connection Type for MDX &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-mdx-ssrs.md) or [Analysis Services Connection Type for DMX &#40;SSRS&#41;](report-data/analysis-services-connection-type-for-dmx-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-204">Sales パースペクティブを持つ Analysis Services テーブル モデル データベース</span><span class="sxs-lookup"><span data-stu-id="efcbd-204">Analysis Services tabular model database with Sales perspective</span></span>|`Data source=<servername>;initial catalog= Adventure Works DW;cube='Sales'`|<span data-ttu-id="efcbd-205">データソースの種類をに設定 `Microsoft SQL Server Analysis Services` します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-205">Set data source type to `Microsoft SQL Server Analysis Services`.</span></span> <span data-ttu-id="efcbd-206">cube= 設定にパースペクティブの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-206">Specify perspective name in cube= setting.</span></span> <span data-ttu-id="efcbd-207">詳しくは、「 [パースペクティブ &#40;SSAS テーブル&#41;](https://docs.microsoft.com/analysis-services/tabular-models/perspectives-ssas-tabular)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-207">For more information, see [Perspectives &#40;SSAS Tabular&#41;](https://docs.microsoft.com/analysis-services/tabular-models/perspectives-ssas-tabular).</span></span>|
|<span data-ttu-id="efcbd-208">ネイティブ モードで構成されているレポート サーバーのレポート モデル データ ソース</span><span class="sxs-lookup"><span data-stu-id="efcbd-208">Report model data source on a report server configured in native mode</span></span>|`Server=http://myreportservername/reportserver; datasource=/models/Adventure Works`|<span data-ttu-id="efcbd-209">レポート サーバーまたはドキュメント ライブラリの URL と、レポート サーバー フォルダーまたはドキュメント ライブラリ フォルダーの名前空間内のパブリッシュされたモデルへのパスを指定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-209">Specify the report server or document library URL and the path to the published model in the report server folder or document library folder namespace.</span></span>
|<span data-ttu-id="efcbd-210">SharePoint 統合モードで構成されているレポート サーバーのレポート モデル データ ソース</span><span class="sxs-lookup"><span data-stu-id="efcbd-210">Report model data source on a report server configured in SharePoint integrated mode</span></span>|`Server=http://server; datasource=http://server/site/documents/models/Adventure Works.smdl`|<span data-ttu-id="efcbd-211">レポート サーバーまたはドキュメント ライブラリの URL と、レポート サーバー フォルダーまたはドキュメント ライブラリ フォルダーの名前空間内のパブリッシュされたモデルへのパスを指定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-211">Specify the report server or document library URL and the path to the published model in the report server folder or document library folder namespace.</span></span>|
|[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="efcbd-212">2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] サーバー</span><span class="sxs-lookup"><span data-stu-id="efcbd-212">2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] server</span></span>|`provider=MSOLAP.2;data source=<remote server name>;initial catalog=FoodMart 2000`|<span data-ttu-id="efcbd-213">データ ソースの種類を `OLE DB Provider for OLAP Services 8.0` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-213">Set the data source type to `OLE DB Provider for OLAP Services 8.0`.</span></span><br /><br /> <span data-ttu-id="efcbd-214">`ConnectTo` プロパティを `8.0` に設定すると、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] のデータ ソースにより高速に接続できるようになります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-214">You can achieve a faster connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2000 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] data sources if you set the `ConnectTo` property to `8.0`.</span></span> <span data-ttu-id="efcbd-215">このプロパティを設定するには、 **[接続プロパティ]** ダイアログ ボックスの **[詳細プロパティ]** タブを使用します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-215">To set this property, use the **Connection Properties** dialog box, **Advanced Properties** tab.</span></span>|
|<span data-ttu-id="efcbd-216">Oracle サーバー</span><span class="sxs-lookup"><span data-stu-id="efcbd-216">Oracle server</span></span>|`data source=myserver`|<span data-ttu-id="efcbd-217">データ ソースの種類を `Oracle` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-217">Set the data source type to `Oracle`.</span></span> <span data-ttu-id="efcbd-218">レポート デザイナーがインストールされているコンピューターとレポート サーバーに、Oracle クライアント ツールがインストールされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-218">The Oracle client tools must be installed on the Report Designer computer and on the report server.</span></span> <span data-ttu-id="efcbd-219">詳細については、「[Oracle の接続の種類 &#40;SSRS&#41;](report-data/oracle-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-219">For more information, see [Oracle Connection Type &#40;SSRS&#41;](report-data/oracle-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-220">SAP NetWeaver BI データ ソース</span><span class="sxs-lookup"><span data-stu-id="efcbd-220">SAP NetWeaver BI data source</span></span>|`DataSource=http://mySAPNetWeaverBIServer:8000/sap/bw/xml/soap/xmla`|<span data-ttu-id="efcbd-221">データ ソースの種類を `SAP NetWeaver BI` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-221">Set the data source type to `SAP NetWeaver BI`.</span></span> <span data-ttu-id="efcbd-222">詳細については、「[SAP NetWeaver BI の接続の種類 &#40;SSRS&#41;](report-data/sap-netweaver-bi-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-222">For more information, see [SAP NetWeaver BI Connection Type &#40;SSRS&#41;](report-data/sap-netweaver-bi-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-223">Hyperion Essbase データ ソース</span><span class="sxs-lookup"><span data-stu-id="efcbd-223">Hyperion Essbase data source</span></span>|`Data Source=http://localhost:13080/aps/XMLA; Initial Catalog=Sample`|<span data-ttu-id="efcbd-224">データ ソースの種類を `Hyperion Essbase` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-224">Set the data source type to `Hyperion Essbase`.</span></span> <span data-ttu-id="efcbd-225">詳細については、「[Hyperion Essbase の接続の種類 &#40;SSRS&#41;](report-data/hyperion-essbase-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-225">For more information, see [Hyperion Essbase Connection Type &#40;SSRS&#41;](report-data/hyperion-essbase-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-226">Teradata データ ソース</span><span class="sxs-lookup"><span data-stu-id="efcbd-226">Teradata data source</span></span>|<span data-ttu-id="efcbd-227">`data source=`\<NNN>.\<NNN>.\<NNN>.\<NNN>`;`</span><span class="sxs-lookup"><span data-stu-id="efcbd-227">`data source=`\<NNN>.\<NNN>.\<NNN>.\<NNN>`;`</span></span>|<span data-ttu-id="efcbd-228">データ ソースの種類を `Teradata` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-228">Set the data source type to `Teradata`.</span></span> <span data-ttu-id="efcbd-229">接続文字列は、各フィールドが 1 ～ 3 桁の 4 つのフィールドで構成されるインターネット プロトコル (IP) アドレスです。</span><span class="sxs-lookup"><span data-stu-id="efcbd-229">The connection string is an Internet Protocol (IP) address in the form of four fields, where each field can be from one to three digits.</span></span> <span data-ttu-id="efcbd-230">詳細については、「[Teradata の接続の種類 &#40;SSRS&#41;](report-data/teradata-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-230">For more information, see [Teradata Connection Type &#40;SSRS&#41;](report-data/teradata-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-231">XML データ ソース、Web サービス</span><span class="sxs-lookup"><span data-stu-id="efcbd-231">XML data source, Web service</span></span>|`data source=http://adventure-works.com/results.aspx`|<span data-ttu-id="efcbd-232">データ ソースの種類を `XML` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-232">Set the data source type to `XML`.</span></span> <span data-ttu-id="efcbd-233">接続文字列は、Web サービス記述言語 (WSDL) をサポートする Web サービスの URL です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-233">The connection string is a URL for a web service that supports Web Services Definition Language (WSDL).</span></span> <span data-ttu-id="efcbd-234">詳細については、「[XML の接続の種類 &#40;SSRS&#41;](report-data/xml-connection-type-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-234">For more information, see [XML Connection Type &#40;SSRS&#41;](report-data/xml-connection-type-ssrs.md).</span></span>|
|<span data-ttu-id="efcbd-235">XML データ ソース、XML ドキュメント</span><span class="sxs-lookup"><span data-stu-id="efcbd-235">XML data source, XML document</span></span>|`http://localhost/XML/Customers.xml`|<span data-ttu-id="efcbd-236">データ ソースの種類を `XML` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-236">Set the data source type to `XML`.</span></span> <span data-ttu-id="efcbd-237">接続文字列は XML ドキュメントへの URL です。</span><span class="sxs-lookup"><span data-stu-id="efcbd-237">The connection string is a URL to the XML document.</span></span>|
|<span data-ttu-id="efcbd-238">XML データ ソース、埋め込み XML ドキュメント</span><span class="sxs-lookup"><span data-stu-id="efcbd-238">XML data source, embedded XML document</span></span>|<span data-ttu-id="efcbd-239">*空*</span><span class="sxs-lookup"><span data-stu-id="efcbd-239">*Empty*</span></span>|<span data-ttu-id="efcbd-240">データ ソースの種類を `XML` に設定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-240">Set the data source type to `XML`.</span></span> <span data-ttu-id="efcbd-241">XML データはレポート定義に埋め込まれています。</span><span class="sxs-lookup"><span data-stu-id="efcbd-241">The XML data is embedded in the report definition.</span></span>|

<span data-ttu-id="efcbd-242">`localhost` を使用してレポート サーバーに接続できない場合は、TCP/IP プロトコルのネットワーク プロトコルが有効になっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-242">If you fail to connect to a report server using `localhost`, check that the network protocol for TCP/IP protocol is enabled.</span></span> <span data-ttu-id="efcbd-243">詳細については、「 [Configure Client プロトコル](../database-engine/configure-windows/configure-client-protocols.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-243">For more information, see [Configure Client Protocols](../database-engine/configure-windows/configure-client-protocols.md).</span></span>

##  <a name="special-characters-in-a-password"></a><a name="bkmk_special_password_characters"></a><span data-ttu-id="efcbd-244">パスワードに含まれる特殊文字</span><span class="sxs-lookup"><span data-stu-id="efcbd-244">Special characters in a password</span></span>
 <span data-ttu-id="efcbd-245">パスワードを要求したり、接続文字列にパスワードを含めるように ODBC データ ソースや SQL データ ソースを構成し、ユーザーが句読点のような特殊文字を使用してパスワードを入力した場合、基になるデータ ソースのドライバーによってはその特殊文字を検証することができません。</span><span class="sxs-lookup"><span data-stu-id="efcbd-245">If you configure your ODBC or SQL data source to prompt for a password or to include the password in the connection string, and a user enters the password with special characters like punctuation marks, some underlying data source drivers cannot validate the special characters.</span></span> <span data-ttu-id="efcbd-246">レポートを処理する際に、この問題によって、"パスワードが無効です" というメッセージが表示される場合があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-246">When you process the report, the message "Not a valid password" may indicate this problem.</span></span> <span data-ttu-id="efcbd-247">パスワードを変更できない場合は、データベース管理者と連携して、適切な資格情報をシステム ODBC データ ソース名 (DSN) の一部としてサーバーに格納することができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-247">If changing the password is impractical, you can work with your database administrator to store the appropriate credentials on the server as part of a system ODBC data source name (DSN).</span></span> <span data-ttu-id="efcbd-248">詳細については、 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK ドキュメントの「OdbcConnection.ConnectionString」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="efcbd-248">For more information, see "OdbcConnection.ConnectionString" in the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK documentation.</span></span>

##  <a name="expression-based-connection-strings"></a><a name="bkmk_Expressions_in_connection_strings"></a><span data-ttu-id="efcbd-249">式に基づく接続文字列</span><span class="sxs-lookup"><span data-stu-id="efcbd-249">Expression-based Connection Strings</span></span>
 <span data-ttu-id="efcbd-250">式に基づく接続文字列は実行時に評価されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-250">Expression-based connection strings are evaluated at run time.</span></span> <span data-ttu-id="efcbd-251">たとえば、データ ソースをパラメーターとして指定し、接続文字列にパラメーター参照を含めて、ユーザーがレポートのデータ ソースを選択できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-251">For example, you can specify the data source as a parameter, include the parameter reference in the connection string, and allow the user to choose a data source for the report.</span></span> <span data-ttu-id="efcbd-252">たとえば、多国籍企業がいくつもの国にデータ サーバーを持っていると仮定します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-252">For example, suppose a multinational firm has data servers in several countries.</span></span> <span data-ttu-id="efcbd-253">式ベースの接続文字列を使用すると、販売レポートを実行するユーザーは、レポートの実行前に特定の国のデータ ソースを選択することができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-253">With an expression-based connection string, a user who is running a sales report can select a data source for a particular country before running the report.</span></span>

 <span data-ttu-id="efcbd-254">次の例では、 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] の接続文字列でデータ ソースの式を使用する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-254">The following example illustrates the use of a data source expression in a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] connection string.</span></span> <span data-ttu-id="efcbd-255">この例では、 `ServerName`というレポート パラメーターが作成されているものとします。</span><span class="sxs-lookup"><span data-stu-id="efcbd-255">The example assumes you have created a report parameter named `ServerName`:</span></span>

```
="data source=" & Parameters!ServerName.Value & ";initial catalog=AdventureWorks"
```

 <span data-ttu-id="efcbd-256">データ ソースの式は、実行時またはレポートのプレビュー時に処理されます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-256">Data source expressions are processed at run time or when a report is previewed.</span></span> <span data-ttu-id="efcbd-257">式は、 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)]で記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-257">The expression must be written in [!INCLUDE[vbprvb](../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="efcbd-258">データ ソースの式を定義する際には、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="efcbd-258">Use the following guidelines when defining a data source expression:</span></span>

-   <span data-ttu-id="efcbd-259">静的な接続文字列を使用してレポートをデザインする。</span><span class="sxs-lookup"><span data-stu-id="efcbd-259">Design the report using a static connection string.</span></span> <span data-ttu-id="efcbd-260">静的な接続文字列とは、式を使わずに設定した接続文字列です (たとえば、レポート固有のデータ ソースまたは共有データ ソースの作成手順に従うと、静的な接続文字列を定義することになります)。</span><span class="sxs-lookup"><span data-stu-id="efcbd-260">A static connection string refers to a connection string that is not set through an expression (for example, when you follow the steps for creating a report-specific or shared data source, you are defining a static connection string).</span></span> <span data-ttu-id="efcbd-261">静的な接続文字列を使用することで、レポート デザイナーでデータ ソースに接続し、レポートの作成に必要なクエリ結果を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-261">Using a static connection string allows you to connect to the data source in Report Designer so that you can get the query results you need to create the report.</span></span>

-   <span data-ttu-id="efcbd-262">データ ソースの接続を定義する際には、共有データ ソースを使用しない。</span><span class="sxs-lookup"><span data-stu-id="efcbd-262">When defining the data source connection, do not use a shared data source.</span></span> <span data-ttu-id="efcbd-263">共有データ ソース内では、データ ソースの式を使用できません。</span><span class="sxs-lookup"><span data-stu-id="efcbd-263">You cannot use a data source expression in a shared data source.</span></span> <span data-ttu-id="efcbd-264">レポートの埋め込みデータ ソースを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-264">You must define an embedded data source for the report.</span></span>

-   <span data-ttu-id="efcbd-265">資格情報は接続文字列とは別に指定する。</span><span class="sxs-lookup"><span data-stu-id="efcbd-265">Specify credentials separately from the connection string.</span></span> <span data-ttu-id="efcbd-266">保存された資格情報、要求された資格情報、または統合セキュリティを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="efcbd-266">You can use stored credentials, prompted credentials, or integrated security.</span></span>

-   <span data-ttu-id="efcbd-267">レポート パラメーターを追加してデータ ソースを指定する。</span><span class="sxs-lookup"><span data-stu-id="efcbd-267">Add a report parameter to specify a data source.</span></span> <span data-ttu-id="efcbd-268">パラメーター値には、使用可能な値の静的な一覧を指定するか (この場合、使用可能な値には、レポートで使用できるデータ ソースを指定する必要があります)、実行時にデータ ソースの一覧を取得するクエリを定義します。</span><span class="sxs-lookup"><span data-stu-id="efcbd-268">For parameter values, you can either provide a static list of available values (in this case, the available values should be data sources you can use with the report) or define a query that retrieves a list of data sources at run time.</span></span>

-   <span data-ttu-id="efcbd-269">データ ソースの一覧が同じデータベース スキーマを共有するようにする。</span><span class="sxs-lookup"><span data-stu-id="efcbd-269">Be sure that the list of data sources shares the same database schema.</span></span> <span data-ttu-id="efcbd-270">すべてのレポートのデザインは、スキーマ情報から始まります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-270">All report design begins with schema information.</span></span> <span data-ttu-id="efcbd-271">レポートの定義で使用されているスキーマと、実行時にレポートが使用する実際のスキーマが一致しないと、レポートが実行されない場合があります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-271">If there is a mismatch between the schema used to define the report and the actual schema used by the report at run time, the report might not run.</span></span>

-   <span data-ttu-id="efcbd-272">レポートをパブリッシュする前に、静的な接続文字列を式で置き換える。</span><span class="sxs-lookup"><span data-stu-id="efcbd-272">Before publishing the report, replace the static connection string with an expression.</span></span> <span data-ttu-id="efcbd-273">レポートのデザインが完了するまでは、静的な接続文字列を式で置き換えません。</span><span class="sxs-lookup"><span data-stu-id="efcbd-273">Wait until you are finished designing the report before you replace the static connection string with an expression.</span></span> <span data-ttu-id="efcbd-274">式を使用すると、レポート デザイナー内でクエリを実行できなくなります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-274">Once you use an expression, you cannot execute the query in Report Designer.</span></span> <span data-ttu-id="efcbd-275">さらに、レポート データ ペイン内のフィールド一覧と、[パラメーター] の一覧が、自動的に更新されなくなります。</span><span class="sxs-lookup"><span data-stu-id="efcbd-275">Furthermore, the field list in the Report Data pane and the Parameters list will not update automatically.</span></span>

## <a name="see-also"></a><span data-ttu-id="efcbd-276">参照</span><span class="sxs-lookup"><span data-stu-id="efcbd-276">See Also</span></span>
 <span data-ttu-id="efcbd-277">[埋め込みおよび共有のデータ接続またはデータソース &#40;レポートビルダーと ssrs&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) [[レポートデータソースの管理](report-data/manage-report-data-sources.md)] の [データソースのプロパティ] ダイアログボックス、[[資格情報](../../2014/reporting-services/data-source-properties-dialog-box-credentials.md) [] [共有データソースのプロパティ] ダイアログボックス、資格情報](../../2014/reporting-services/shared-data-source-properties-dialog-box-credentials.md)の[作成、変更、および &#40;削除](report-data/create-modify-and-delete-shared-data-sources-ssrs.md)[レポートデータソースの資格情報と接続情報の指定](report-data/specify-credential-and-connection-information-for-report-data-sources.md)&#41;&#40;[と SSRS Reporting Services](report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md) [Set Deployment Properties &#40;Reporting Services&#41;](tools/set-deployment-properties-reporting-services.md)</span><span class="sxs-lookup"><span data-stu-id="efcbd-277">[Embedded and Shared Data Connections or Data Sources &#40;Report Builder and SSRS&#41;](../../2014/reporting-services/embedded-and-shared-data-connections-or-data-sources-report-builder-and-ssrs.md) [Manage Report Data Sources](report-data/manage-report-data-sources.md) [Data Source Properties Dialog Box, Credentials](../../2014/reporting-services/data-source-properties-dialog-box-credentials.md) [Shared Data Source Properties Dialog Box, Credentials](../../2014/reporting-services/shared-data-source-properties-dialog-box-credentials.md) [Create, Modify, and Delete Shared Data Sources &#40;SSRS&#41;](report-data/create-modify-and-delete-shared-data-sources-ssrs.md) [Set Deployment Properties &#40;Reporting Services&#41;](tools/set-deployment-properties-reporting-services.md) [Specify Credential and Connection Information for Report Data Sources](report-data/specify-credential-and-connection-information-for-report-data-sources.md) [Add and Verify a Data Connection or Data Source &#40;Report Builder and SSRS&#41;](report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)</span></span>
