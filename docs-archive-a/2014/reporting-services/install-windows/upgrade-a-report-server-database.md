---
title: レポート サーバー データベースのアップグレード | Microsoft Docs
ms.custom: ''
ms.date: 08/10/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- upgrading databases
- report server database
- upgrading Reporting Services
ms.assetid: 4091cf87-9d97-4048-a393-67f1f9207401
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 28e382de505781f4155204fcc652d1308dacce76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645397"
---
# <a name="upgrade-a-report-server-database"></a><span data-ttu-id="2fc28-102">レポート サーバー データベースのアップグレード</span><span class="sxs-lookup"><span data-stu-id="2fc28-102">Upgrade a Report Server Database</span></span>
  <span data-ttu-id="2fc28-103">レポート サーバー データベースは、1 台以上のレポート サーバー インスタンスの記憶域になります。</span><span class="sxs-lookup"><span data-stu-id="2fc28-103">The report server database provides storage for one or more report server instances.</span></span> <span data-ttu-id="2fc28-104">レポート サーバー データベースのスキーマは、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]が新たにリリースされるたびに変更される可能性があります。そのため、使用中のレポート サーバー インスタンスのバージョンとデータベースのバージョンを一致させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="2fc28-104">Because the report server database schema can change with each new release of [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], it is required that the database version match the version of the report server instance you are using.</span></span> <span data-ttu-id="2fc28-105">ほとんどの場合、レポート サーバー データベースは自動的にアップグレードされます。ユーザーは何も処理する必要がありません。</span><span class="sxs-lookup"><span data-stu-id="2fc28-105">In most cases, a report server database can be upgraded automatically with no specific action on your part.</span></span>  
  
 <span data-ttu-id="2fc28-106">**ネイティブモード:**[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]ネイティブモードでは、レポートサーバーデータベースは、実際には "ReportServer と ReportServerTempDB" という既定の名前を持つ2つのデータベースで構成されています。</span><span class="sxs-lookup"><span data-stu-id="2fc28-106">**Native Mode:** In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Native mode, the report server database is actually comprised of two database that have default names of "ReportServer and ReportServerTempDB".</span></span>  
  
 <span data-ttu-id="2fc28-107">**SharePoint モード:**[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] SharePoint モードでは、実際には、レポートサーバーデータベースは、サービスアプリケーションの各インスタンスに対して作成されるデータベースのコレクションです [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="2fc28-107">**SharePoint mode:** In [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] SharePoint mode the report server database is actually a collection of databases that is created for each instance of the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] service application.</span></span>  
  
## <a name="ways-to-upgrade-a-native-mode-report-server-database"></a><span data-ttu-id="2fc28-108">ネイティブ モードのレポート サーバー データベースをアップグレードする方法</span><span class="sxs-lookup"><span data-stu-id="2fc28-108">Ways to Upgrade a Native Mode Report Server Database</span></span>  
 <span data-ttu-id="2fc28-109">次に、レポート サーバー データベースのアップグレード条件を示します。</span><span class="sxs-lookup"><span data-stu-id="2fc28-109">The following list identifies the conditions under which a report server database is upgraded:</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="2fc28-110">セットアップは、レポート サーバーの単一のインスタンスをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="2fc28-110">Setup upgrades a single instance of a report server.</span></span> <span data-ttu-id="2fc28-111">サービスが開始され、レポート サーバーによってデータベース スキーマのバージョンがサーバーのバージョンと一致しないことが検出されると、レポート サーバー データベース スキーマが自動的にアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-111">The report server database schema is automatically upgraded after service startup and the report server determines that the database schema version does not match the server version.</span></span>  
  
     <span data-ttu-id="2fc28-112">レポート サーバーは、サービスの開始時に、データベース スキーマのバージョンとサーバーのバージョンが一致しているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="2fc28-112">At service startup, the report server checks the database schema version to verify that it matches the server version.</span></span> <span data-ttu-id="2fc28-113">データベース スキーマのバージョンが古い場合、レポート サーバーで必要なバージョンのスキーマに自動的にアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-113">If the database schema version is an older version, it is automatically upgraded to the schema version that is required by the report server.</span></span> <span data-ttu-id="2fc28-114">自動アップグレードは、古いレポート サーバー データベースを復元またはアタッチした場合に特に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-114">Automatic upgrade is especially useful if you restored or attached an older report server database.</span></span> <span data-ttu-id="2fc28-115">データベース スキーマのバージョンがアップグレードされたことを示すメッセージが、レポート サーバーのトレース ログ ファイルに入力されます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-115">A message is entered in the report server trace log file indicating that the database schema version was upgraded.</span></span>  
  
-   <span data-ttu-id="2fc28-116">新しいバージョンのレポート サーバー インスタンスで古いバージョンのレポート サーバー データベースを使用するように選択した場合、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 構成マネージャーは、ローカルまたはリモートのレポート サーバー データベースをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="2fc28-116">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager upgrades a local or remote report server database when you select an older version to use with a newer report server instance.</span></span> <span data-ttu-id="2fc28-117">この場合、アップグレード操作を事前に確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2fc28-117">In this case, you must confirm the upgrade action before it happens.</span></span>  
  
     <span data-ttu-id="2fc28-118">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 構成マネージャーには、個別の [アップグレード] ボタンまたはアップグレード スクリプトが用意されていません。</span><span class="sxs-lookup"><span data-stu-id="2fc28-118">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager no longer provides a separate Upgrade button or upgrade script.</span></span> <span data-ttu-id="2fc28-119">[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 以降では、レポート サーバー サービスの自動アップグレード機能の導入に伴って、これらの機能が廃止されました。</span><span class="sxs-lookup"><span data-stu-id="2fc28-119">Those features are obsolete starting with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] due to the automatic upgrade feature of the Report Server service.</span></span>  
  
 <span data-ttu-id="2fc28-120">スキーマを更新した後で、アップグレードを以前のバージョンにロールバックすることはできません。</span><span class="sxs-lookup"><span data-stu-id="2fc28-120">After the schema is updated, you cannot rollback the upgrade to an earlier version.</span></span> <span data-ttu-id="2fc28-121">以前のインストールを再作成する必要が生じる場合に備えて、必ずレポート サーバー データベースをバックアップしてください。</span><span class="sxs-lookup"><span data-stu-id="2fc28-121">Always backup the report server database in case you need to recreate a previous installation.</span></span>  
  
## <a name="how-the-schema-metadata-and-report-server-content-is-updated"></a><span data-ttu-id="2fc28-122">スキーマ、メタデータ、およびレポート サーバー コンテンツの更新方法</span><span class="sxs-lookup"><span data-stu-id="2fc28-122">How the Schema, Metadata, and Report Server Content is Updated</span></span>  
 <span data-ttu-id="2fc28-123">レポート サーバー データベースは、次の 3 段階でアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-123">The report server database is upgraded in three stages:</span></span>  
  
1.  <span data-ttu-id="2fc28-124">スキーマは、セットアップとサービス開始の後、または以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 構成マネージャーで [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] ネイティブ モードのレポート サーバー データベースを選択したときに、自動的にアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-124">The schema is upgraded automatically after setup and service startup, or when you select a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native mode report server database in the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager that is an older version.</span></span> <span data-ttu-id="2fc28-125">さらに、レポート サーバー サービスは、起動時にデータベース バージョンを確認します。</span><span class="sxs-lookup"><span data-stu-id="2fc28-125">In addition, the Report Server service checks the database version at startup.</span></span> <span data-ttu-id="2fc28-126">レポート サーバーは、接続先のデータベースが以前のバージョンである場合、起動時にデータベースを更新します。</span><span class="sxs-lookup"><span data-stu-id="2fc28-126">If the report server is connected to a database that is an earlier version, the report server will update the database during startup.</span></span>  
  
2.  <span data-ttu-id="2fc28-127">セキュリティ記述子は、スキーマの更新後にレポート サーバー データベースを最初に使用するときにアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-127">Security descriptors are upgraded on first use of the report server database after the schema is updated.</span></span>  
  
3.  <span data-ttu-id="2fc28-128">パブリッシュ済みのレポートとコンパイル済みのレポート スナップショットは最初に使用するときに更新されます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-128">Published reports and compiled report snapshots are updated on first use.</span></span> <span data-ttu-id="2fc28-129">詳細については、「 [Upgrade Reports](upgrade-reports.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2fc28-129">For more information, see [Upgrade Reports](upgrade-reports.md).</span></span>  
  
 <span data-ttu-id="2fc28-130">レポート サーバーは、レポート サーバー データベース以外に一時データベースも使用します。</span><span class="sxs-lookup"><span data-stu-id="2fc28-130">In addition to the report server database, a report server also uses a temporary database.</span></span> <span data-ttu-id="2fc28-131">一時データベースは、レポート サーバー データベースをアップグレードするときに自動的にアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-131">The temporary database is upgraded automatically when you upgrade the report server database.</span></span>  
  
## <a name="permissions-required-to-upgrade-a-report-server-database"></a><span data-ttu-id="2fc28-132">レポート サーバー データベースのアップグレードに必要な権限</span><span class="sxs-lookup"><span data-stu-id="2fc28-132">Permissions required to upgrade a Report Server Database</span></span>  
 <span data-ttu-id="2fc28-133">レポート サーバー データベースを含む [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] をアップグレードする場合に、不十分な権限でデータベースのアップグレードが行われると、エラー メッセージが表示されることがあります。</span><span class="sxs-lookup"><span data-stu-id="2fc28-133">If you are upgrading a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation that includes a report server database, you may see an error message if the database upgrade is performed with insufficient permissions.</span></span> <span data-ttu-id="2fc28-134">既定では、リモートの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスへの接続とスキーマの更新には、セットアップ プログラムを実行しているユーザーのセキュリティ トークンが使用されます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-134">By default, Setup uses the security token of the user who is running the Setup program to connect to the remote [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance and update the schema.</span></span> <span data-ttu-id="2fc28-135">レポート サーバー データベースをホストするデータベース サーバーの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **sysadmin** アクセス許可がある場合は、データベースのアップグレードは成功します。</span><span class="sxs-lookup"><span data-stu-id="2fc28-135">If you have [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **sysadmin** permissions on the database server that hosts the report server databases, the database upgrade will succeed.</span></span> <span data-ttu-id="2fc28-136">同様に、リモート コンピューターのスキーマを変更する **sysadmin** アクセス許可のあるアカウントの RSUPGRADEDATABASEACCOUNT 引数と RSUPGRADEPASSWORD 引数を指定してコマンド プロンプトからセットアップを実行すると、データベースのアップグレードは正しく行われます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-136">Similarly, if you run Setup from the command prompt and specify the RSUPGRADEDATABASEACCOUNT and RSUPGRADEPASSWORD arguments for an account that has **sysadmin** permission to modify the schema on the remote computer, the database upgrade will succeed.</span></span>  
  
 <span data-ttu-id="2fc28-137">しかし、リモート コンピューターのデータベースに対する **sysadmin** アクセス許可がないと、接続が拒否され、次のエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-137">However, if you do not have **sysadmin** permission to the database on the remote computer, the connection will be refused with the following error:</span></span>  
  
 `"Setup was not able to upgrade the report server database schema. You must update the database schema manually after setup is finished. To update the schema, run the Reporting Services Configuration Manager, open the Database Setup page, re-select the database, and click Apply. The database will be upgraded automatically."`  
  
 <span data-ttu-id="2fc28-138">この時点で、レポート サーバーのプログラム ファイルはアップグレードされますが、レポート サーバー データベースは以前のバージョンの形式のままになります。</span><span class="sxs-lookup"><span data-stu-id="2fc28-138">At this point, the report server program files will be upgraded, but the report server database will be in the format of the previous version.</span></span> <span data-ttu-id="2fc28-139">データベースを手動でアップグレードしてアップグレード プロセスを完了するまで、レポート サーバーは使用できません。</span><span class="sxs-lookup"><span data-stu-id="2fc28-139">The report server will be unavailable until you finish the upgrade process by upgrading the database manually.</span></span>  
  
#### <a name="to-upgrade-a-native-mode-database-with-scripts"></a><span data-ttu-id="2fc28-140">スクリプトを使用してネイティブ モードのデータベースをアップグレードするには</span><span class="sxs-lookup"><span data-stu-id="2fc28-140">To upgrade a Native Mode database With Scripts</span></span>  
 <span data-ttu-id="2fc28-141">WMI スクリプトを使用して、レポート サーバー データベースをアップグレードできます。</span><span class="sxs-lookup"><span data-stu-id="2fc28-141">You can use WMI scripts to upgrade a report server database.</span></span> <span data-ttu-id="2fc28-142">詳細については、「[GenerateDatabaseUpgradeScript メソッド &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2fc28-142">For more information, see [GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2fc28-143">参照</span><span class="sxs-lookup"><span data-stu-id="2fc28-143">See Also</span></span>  
 <span data-ttu-id="2fc28-144">[Reporting Services 構成マネージャー &#40;ネイティブ モード&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="2fc28-144">[Reporting Services Configuration Manager &#40;Native Mode&#41;](../../sql-server/install/reporting-services-configuration-manager-native-mode.md) </span></span>  
 <span data-ttu-id="2fc28-145">[SSRS Configuration Manager &#40;レポートサーバーデータベースを作成&#41;](../../sql-server/install/create-a-report-server-database-ssrs-configuration-manager.md) </span><span class="sxs-lookup"><span data-stu-id="2fc28-145">[Create a Report Server Database  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/create-a-report-server-database-ssrs-configuration-manager.md) </span></span>  
 <span data-ttu-id="2fc28-146">[データベースの変更ウィザード &#40;SSRS ネイティブモード&#41;](../../sql-server/install/change-database-wizard-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="2fc28-146">[Change Database Wizard &#40;SSRS Native Mode&#41;](../../sql-server/install/change-database-wizard-ssrs-native-mode.md) </span></span>  
 <span data-ttu-id="2fc28-147">[Reporting Services のアップグレードと移行](upgrade-and-migrate-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="2fc28-147">[Upgrade and Migrate Reporting Services](upgrade-and-migrate-reporting-services.md) </span></span>  
 [<span data-ttu-id="2fc28-148">Reporting Services のインストールの移行 &#40;ネイティブ モード&#41;</span><span class="sxs-lookup"><span data-stu-id="2fc28-148">Migrate a Reporting Services Installation &#40;Native Mode&#41;</span></span>](migrate-a-reporting-services-installation-native-mode.md)  
  
  
