---
title: 共有データソースを作成および管理する (SharePoint 統合モードの Reporting Services) |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- SharePoint integration [Reporting Services], shared data sources
- shared data sources [Reporting Services]
ms.assetid: 2d3428e4-a810-4e66-a287-ff18e57fad76
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 5eedb74dd5a24f40469b3ee6a4a24e97e6e59174
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633788"
---
# <a name="create-and-manage-shared-data-sources-reporting-services-in-sharepoint-integrated-mode"></a><span data-ttu-id="2955a-102">共有データ ソースを作成および管理する (Reporting Services の SharePoint 統合モード)</span><span class="sxs-lookup"><span data-stu-id="2955a-102">Create and Manage Shared Data Sources (Reporting Services in SharePoint Integrated Mode)</span></span>
  <span data-ttu-id="2955a-103">SharePoint ライブラリからレポートを実行する場合は、レポート内で、またはそのレポートにリンクされている外部ファイルで、接続情報を定義できます。</span><span class="sxs-lookup"><span data-stu-id="2955a-103">When you run a report from a SharePoint library, connection information can be defined inside the report or in an external file that is linked to the report.</span></span> <span data-ttu-id="2955a-104">レポートに埋め込む接続情報をカスタム データ ソースと呼びます。</span><span class="sxs-lookup"><span data-stu-id="2955a-104">If the connection information is embedded within the report, it is called a custom data source.</span></span> <span data-ttu-id="2955a-105">外部ファイル内で定義する接続情報を共有データ ソースと呼びます。</span><span class="sxs-lookup"><span data-stu-id="2955a-105">If the connection information is defined in an external file, it is called a shared data source.</span></span> <span data-ttu-id="2955a-106">外部ファイルとしては、レポート サーバー データ ソース (.rsds) ファイルまたは Office データ接続 (.odc) ファイルを使用できます。</span><span class="sxs-lookup"><span data-stu-id="2955a-106">The external file can be a report server data source (.rsds) file or an Office Data Connection (.odc) file.</span></span>  
  
 <span data-ttu-id="2955a-107">.rsds ファイルは、.rds ファイルと似ていますが、スキーマが異なります。</span><span class="sxs-lookup"><span data-stu-id="2955a-107">An .rsds file is similar to an .rds file, but it has a different schema.</span></span> <span data-ttu-id="2955a-108">.rsds ファイルを作成するには、レポート デザイナーまたはモデル デザイナーから SharePoint ライブラリに .rds をパブリッシュできます (新しい .rsds ファイルが元の .rds ファイルから作成されます)。</span><span class="sxs-lookup"><span data-stu-id="2955a-108">To create an .rsds file, you can publish an .rds from Report Designer or Model Designer to a SharePoint library (a new .rsds file is created from the original .rds file).</span></span> <span data-ttu-id="2955a-109">または、SharePoint サイトのライブラリに新しいファイルを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="2955a-109">Or, you can create a new file in a library on a SharePoint Site.</span></span>  
  
 <span data-ttu-id="2955a-110">共有データ ソースを作成またはパブリッシュした場合は、後で接続プロパティを編集したり、使用されなくなったファイルを削除することができます。</span><span class="sxs-lookup"><span data-stu-id="2955a-110">After you create or publish a shared data source, you can edit connection properties or delete the file if it is no longer used.</span></span> <span data-ttu-id="2955a-111">共有データ ソースを削除する前に、共有データ ソースがレポートおよびレポート モデルによって使用されているかどうかを判断する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2955a-111">Before you delete a shared data source, you should determine whether it is used by reports and report models.</span></span> <span data-ttu-id="2955a-112">共有データ ソースを参照している依存アイテムを表示することによって、この操作を行えます。</span><span class="sxs-lookup"><span data-stu-id="2955a-112">You can do this by viewing dependent items that reference the shared data source.</span></span>  
  
 <span data-ttu-id="2955a-113">依存アイテムの一覧では、共有データ ソースが参照されているかどうかを確認することはできますが、アイテムがアクティブに使用されているかどうかは確認できません。</span><span class="sxs-lookup"><span data-stu-id="2955a-113">Although the list of dependent items tells you whether the shared data source is referenced, it does not tell you whether the item is actively used.</span></span> <span data-ttu-id="2955a-114">共有データ ソースまたはモデルが実際に使用されているかどうかを判断するには、レポート サーバー コンピューターのログ ファイルを調べます。</span><span class="sxs-lookup"><span data-stu-id="2955a-114">To determine whether the shared data source or model is actively used, you can review the log files on the report server computer.</span></span> <span data-ttu-id="2955a-115">ログ ファイルへのアクセス許可がない場合や、ログ ファイルに必要な情報が記載されていない場合は、レポートの現状を確認する間、アクセスを受ける心配のないフォルダーにそのレポートを移動することを検討します。</span><span class="sxs-lookup"><span data-stu-id="2955a-115">If you do not have access to the log files or if the files do not contain the information you want, consider moving the report to an inaccessible folder while you determine its actual status.</span></span>  
  
### <a name="to-create-a-shared-data-source-rsds-file-sharepoint-2010"></a><span data-ttu-id="2955a-116">共有データ ソース (.rsds) ファイルを作成するには (SharePoint 2010)</span><span class="sxs-lookup"><span data-stu-id="2955a-116">To create a shared data source (.rsds) file (SharePoint 2010)</span></span>  
  
1.  <span data-ttu-id="2955a-117">ライブラリ リボンで、 **[ドキュメント]** タブをクリックします。</span><span class="sxs-lookup"><span data-stu-id="2955a-117">Click the **Documents** tab on the library ribbon.</span></span>  
  
2.  <span data-ttu-id="2955a-118">**[新しいドキュメント]** メニューの **[レポート データ ソース]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2955a-118">On the **New Document** menu, click **Report Data Source**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2955a-119">メニューに **[レポート データ ソース]** アイテムが表示されない場合は、レポート データ ソースのコンテンツ タイプが有効化されていません。</span><span class="sxs-lookup"><span data-stu-id="2955a-119">If you do not see the **Report Data Source** item on the menu, the report data source content type has not been enabled.</span></span> <span data-ttu-id="2955a-120">詳細については、「 [SharePoint 統合モードでのレポートサーバーコンテンツタイプのライブラリへの追加 &#40;Reporting Services」&#41;](../../2014/reporting-services/add-reporting-services-content-types-to-a-sharepoint-library.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2955a-120">For more information, see [Add Report Server Content Types to a Library &#40;Reporting Services in SharePoint Integrated Mode&#41;](../../2014/reporting-services/add-reporting-services-content-types-to-a-sharepoint-library.md).</span></span>  
  
3.  <span data-ttu-id="2955a-121">**[名前]** に、.rsds ファイルに付けるわかりやすい名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="2955a-121">In **Name**, enter a descriptive name for the .rsds file.</span></span>  
  
4.  <span data-ttu-id="2955a-122">**[データ ソースの種類]** で、一覧からデータ ソースの種類を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-122">In **Data Source Type**, select the type of data source from the list.</span></span> <span data-ttu-id="2955a-123">詳細については、「[Reporting Services でサポートされるデータ ソース &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="2955a-123">For more information, see [Data Sources Supported by Reporting Services &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md).</span></span>  
  
5.  <span data-ttu-id="2955a-124">**[接続文字列]** で、外部データ ソースへの接続を確立するために必要な設定として、データ ソースへのポインターなどを指定します。</span><span class="sxs-lookup"><span data-stu-id="2955a-124">In **Connection String**, specify a pointer to the data source and any other settings that are necessary for establishing a connection to the external data source.</span></span> <span data-ttu-id="2955a-125">使用するデータ ソースの種類によって、接続文字列の構文が異なります。</span><span class="sxs-lookup"><span data-stu-id="2955a-125">The type of data source you are using determines the syntax of the connection string.</span></span> <span data-ttu-id="2955a-126">詳細と例については、「 [Reporting Services のデータ接続、データソース、および接続文字列](../../2014/reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2955a-126">For more information and examples, see [Data Connections, Data Sources, and Connection Strings in Reporting Services](../../2014/reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md).</span></span>  
  
6.  <span data-ttu-id="2955a-127">**[資格情報]** で、外部データ ソースにアクセスする際にレポート サーバーが資格情報を取得する方法を指定します。</span><span class="sxs-lookup"><span data-stu-id="2955a-127">In **Credentials**, specify how the report server obtains credentials to access the external data source.</span></span> <span data-ttu-id="2955a-128">資格情報は、自動レポート処理用に保存、要求、統合、または構成できます。</span><span class="sxs-lookup"><span data-stu-id="2955a-128">Credentials can be stored, prompted, integrated, or configured for unattended report processing.</span></span>  
  
    -   <span data-ttu-id="2955a-129">レポートを開いたユーザーの資格情報を使用してデータにアクセスする場合は、 **[Windows 認証 (統合)]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-129">Select **Windows authentication (integrated)** if you want to access the data using the credentials of the user who opened the report.</span></span> <span data-ttu-id="2955a-130">SharePoint サイトまたはファームでフォーム認証を使用する場合や、信頼済みアカウントを使用してレポート サーバーに接続する場合は、このオプションを選択しないでください。</span><span class="sxs-lookup"><span data-stu-id="2955a-130">Do not select this option if the SharePoint site or farm uses forms authentication or connects to the report server through a trusted account.</span></span> <span data-ttu-id="2955a-131">このレポートのサブスクリプションまたはデータ処理をスケジュールする場合は、このオプションを選択しないでください。</span><span class="sxs-lookup"><span data-stu-id="2955a-131">Do not select this option if you want to schedule subscription or data processing for this report.</span></span> <span data-ttu-id="2955a-132">Kerberos 認証が有効なドメインに参加している場合、またはレポート サーバーと同一のコンピューターにデータ ソースがある場合に、このオプションは最適です。</span><span class="sxs-lookup"><span data-stu-id="2955a-132">This option works best when Kerberos authentication is enabled for your domain, or when the data source is on the same computer as the report server.</span></span> <span data-ttu-id="2955a-133">Kerberos 認証が無効になっている場合、Windows 資格情報は別のコンピューター 1 台にしか渡すことができません。</span><span class="sxs-lookup"><span data-stu-id="2955a-133">If Kerberos authentication is not enabled, Windows credentials can only be passed to one other computer.</span></span> <span data-ttu-id="2955a-134">つまり、外部データ ソースが別のコンピューターにあり、別の接続が必要な場合、意図したデータを取得できずにエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="2955a-134">This means that if the external data source is on another computer, requiring an additional connection, you will get an error instead of the data you expect.</span></span>  
  
    -   <span data-ttu-id="2955a-135">ユーザーがレポートを実行するたびに資格情報の入力を要求する場合は、 **[資格情報を要求する]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2955a-135">Select **Prompt for credentials** if you want the user to enter his or her credentials each time he or she runs the report.</span></span> <span data-ttu-id="2955a-136">このレポートのサブスクリプションまたはデータ処理をスケジュールする場合は、このオプションを選択しないでください。</span><span class="sxs-lookup"><span data-stu-id="2955a-136">Do not select this option if you want to schedule subscription or data processing for this report.</span></span>  
  
    -   <span data-ttu-id="2955a-137">1 組の資格情報を使用してデータにアクセスする場合は、 **[保存された資格情報]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-137">Select **Stored credentials** if you want to access the data using a single set of credentials.</span></span> <span data-ttu-id="2955a-138">資格情報は暗号化されてから保存されます。</span><span class="sxs-lookup"><span data-stu-id="2955a-138">The credentials are encrypted before they are stored.</span></span> <span data-ttu-id="2955a-139">保存されている資格情報の認証方法を指定するオプションを選択できます。</span><span class="sxs-lookup"><span data-stu-id="2955a-139">You can select options that determine how the stored credentials are authenticated.</span></span> <span data-ttu-id="2955a-140">保存された資格情報が Windows ユーザー アカウントに属する場合は、[データ ソースへの接続時に Windows 資格情報として使用する] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2955a-140">Select Use as Windows credentials if the stored credentials belong to a Windows user account.</span></span> <span data-ttu-id="2955a-141">データベース サーバーの実行コンテキストを設定する場合は、 **[実行コンテキストをこのアカウントに設定する]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2955a-141">Select **Set execution context to this account** if you want to set the execution context on the database server.</span></span> <span data-ttu-id="2955a-142">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データベースの場合、このオプションによって SETUSER 関数が設定されます。</span><span class="sxs-lookup"><span data-stu-id="2955a-142">For [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] databases, this option sets the SETUSER function.</span></span> <span data-ttu-id="2955a-143">詳細については、「[SETUSER &#40;Transact-SQL&#41;](/sql/t-sql/statements/setuser-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2955a-143">For more information, see [SETUSER &#40;Transact-SQL&#41;](/sql/t-sql/statements/setuser-transact-sql).</span></span>  
  
    -   <span data-ttu-id="2955a-144">接続文字列で資格情報を指定する場合や、レポート サーバーで構成されている最小特権アカウントを使用してレポートを実行する場合は、 **[資格情報は必要ありません]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-144">Select **Credentials are not required** if you want to specify credentials in the connection string, or if you want to run the report using a least-privilege account that is configured on the report server.</span></span> <span data-ttu-id="2955a-145">レポート サーバーでこのアカウントが構成されていない場合、ユーザーは資格情報の入力を要求され、そのレポート用に定義したスケジュール済みの操作は実行されません。</span><span class="sxs-lookup"><span data-stu-id="2955a-145">If this account is not configured on the report server, users will be prompted for credentials and any scheduled operations that you define for the report will not run.</span></span>  
  
7.  <span data-ttu-id="2955a-146">データ ソースをアクティブにする場合は、 **[このデータ ソースを有効にする]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-146">Select **Enable this data source** if you want the data source to be active.</span></span> <span data-ttu-id="2955a-147">データ ソースが構成されていてもアクティブでない場合は、ユーザーがそのデータ ソースに基づくレポートを使用しようとするとエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2955a-147">If the data source is configured but not active, users will see an error message when they attempt to use a report based on the data source.</span></span>  
  
8.  <span data-ttu-id="2955a-148">データ ソース構成を検証するには、 **[接続テスト]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2955a-148">Click the **Test Connection** button to validate the data source configuration.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2955a-149">[接続テスト] ボタンは、XML データ ソースの種類ではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="2955a-149">The Test Connection button is not supported for the XML data source type.</span></span>  
  
9. <span data-ttu-id="2955a-150">**[OK]** をクリックして、共有データ ソースを作成します。</span><span class="sxs-lookup"><span data-stu-id="2955a-150">Click **OK** to save create the shared data source.</span></span>  
  
### <a name="to-view-dependent-items"></a><span data-ttu-id="2955a-151">依存アイテムを表示するには</span><span class="sxs-lookup"><span data-stu-id="2955a-151">To view dependent items</span></span>  
  
1.  <span data-ttu-id="2955a-152">.rsds ファイルを含むライブラリを開きます。</span><span class="sxs-lookup"><span data-stu-id="2955a-152">Open the library that contains the .rsds file.</span></span>  
  
2.  <span data-ttu-id="2955a-153">共有データ ソースをポイントします。</span><span class="sxs-lookup"><span data-stu-id="2955a-153">Point to the shared data source.</span></span>  
  
3.  <span data-ttu-id="2955a-154">クリックして下矢印を表示し、 **[依存アイテムの表示]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-154">Click to display a down arrow, and select **View Dependent Items**.</span></span>  
  
     <span data-ttu-id="2955a-155">レポート モデルの依存アイテムの一覧には、レポート ビルダーで作成したレポートが表示されます。</span><span class="sxs-lookup"><span data-stu-id="2955a-155">For report models, the list of dependent items shows the reports that were created in Report Builder.</span></span> <span data-ttu-id="2955a-156">共有データ ソースの依存アイテムの一覧には、レポートとレポート モデルの両方が表示される場合があります。</span><span class="sxs-lookup"><span data-stu-id="2955a-156">For shared data sources, the dependent items list can include both reports and report models.</span></span>  
  
### <a name="to-delete-a-shared-data-source-rsds-file"></a><span data-ttu-id="2955a-157">共有データ ソース (.rsds) ファイルを削除するには</span><span class="sxs-lookup"><span data-stu-id="2955a-157">To delete a shared data source (.rsds) file</span></span>  
  
1.  <span data-ttu-id="2955a-158">.rsds ファイルを含むライブラリを開きます。</span><span class="sxs-lookup"><span data-stu-id="2955a-158">Open the library that contains the .rsds file.</span></span>  
  
2.  <span data-ttu-id="2955a-159">共有データ ソースをポイントします。</span><span class="sxs-lookup"><span data-stu-id="2955a-159">Point to the shared data source.</span></span>  
  
3.  <span data-ttu-id="2955a-160">クリックして下矢印を表示し、 **[削除]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2955a-160">Click to display a down arrow, and click **Delete**.</span></span>  
  
 <span data-ttu-id="2955a-161">保存しておく必要のある共有データ ソースを誤って削除した場合は、同じ接続情報が含まれた新しい共有データ ソースを作成できます。</span><span class="sxs-lookup"><span data-stu-id="2955a-161">If you mistakenly delete a shared data source that you meant to keep, you can create a new one that contains the same connection information.</span></span> <span data-ttu-id="2955a-162">共有データ ソースを作成し直した後、そのデータ ソースを使用していたレポートおよびモデルをすべて開き、新しい共有データ ソースを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2955a-162">After you recreate the shared data source, you must open each report and model that used that data source and select the shared data source.</span></span> <span data-ttu-id="2955a-163">新しい共有データ ソース アイテムには、削除した共有データ ソースとは異なる名前、資格情報、または接続文字列構文を指定できます。</span><span class="sxs-lookup"><span data-stu-id="2955a-163">The new shared data source item can have a different name, credentials, or connection string syntax from the one you delete.</span></span> <span data-ttu-id="2955a-164">接続が同一のデータ ソースに解決される限り、データ ソースのプロパティが元の値と異なっても問題ありません。</span><span class="sxs-lookup"><span data-stu-id="2955a-164">As long as the connection resolves to the same data source, data source properties can vary from the original values.</span></span>  
  
 <span data-ttu-id="2955a-165">レポート モデルを削除するときは注意してください。</span><span class="sxs-lookup"><span data-stu-id="2955a-165">Use caution when deleting a report model.</span></span> <span data-ttu-id="2955a-166">モデルを削除すると、そのモデルを基にしているレポートをレポート ビルダーで開いて変更することができなくなります。</span><span class="sxs-lookup"><span data-stu-id="2955a-166">If you delete a model, you can no longer open and modify any reports that are based on that model in Report Builder.</span></span> <span data-ttu-id="2955a-167">既存のレポートによって使用されているモデルを誤って削除した場合は、そのモデルを再生成し、そのモデルを使用するレポートの再作成と保存を行って、使用するモデル アイテム セキュリティを再指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2955a-167">If you inadvertently delete a model that is used by existing reports, you must regenerate the model, re-create and save any reports that use the model, and re-specify any model item security that you want to use.</span></span> <span data-ttu-id="2955a-168">モデルを生成し直して既存のレポートに関連付けるだけでは元の状態に戻りません。</span><span class="sxs-lookup"><span data-stu-id="2955a-168">You cannot simply regenerate the model and then attach it to an existing report.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2955a-169">参照</span><span class="sxs-lookup"><span data-stu-id="2955a-169">See Also</span></span>  
 [<span data-ttu-id="2955a-170">レポート データ ソースに関する資格情報と接続情報を指定する</span><span class="sxs-lookup"><span data-stu-id="2955a-170">Specify Credential and Connection Information for Report Data Sources</span></span>](report-data/specify-credential-and-connection-information-for-report-data-sources.md)  
  
  
