---
title: 配置タスクおよび管理タスクのスクリプト作成 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- scripts [Reporting Services]
- moving reports
- report servers [Reporting Services], duplicating settings
- deploying [Reporting Services], scripts
- copying report server settings
- administrative tasks [Reporting Services]
- duplicating report server environment
- migrating reports [Reporting Services]
- scripts [Reporting Services], deployments
- transferrng reports
- reports [Reporting Services], migrating
ms.assetid: d0416c9e-e3f9-456d-9870-2cfd2c49039b
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 7562bec3211824d5e84441434b4696a44d51fa9b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87641987"
---
# <a name="script-deployment-and-administrative-tasks"></a><span data-ttu-id="d6c22-102">配置タスクおよび管理タスクのスクリプト作成</span><span class="sxs-lookup"><span data-stu-id="d6c22-102">Script Deployment and Administrative Tasks</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="d6c22-103">は、スクリプトを使用した日常的なインストール、配置、および管理タスクの自動化をサポートします。</span><span class="sxs-lookup"><span data-stu-id="d6c22-103">supports the use of scripts to automate routine installation, deployment, and administrative tasks.</span></span> <span data-ttu-id="d6c22-104">レポート サーバーの配置は複数の段階を伴うプロセスです。</span><span class="sxs-lookup"><span data-stu-id="d6c22-104">Deploying a report server is a multi-step process.</span></span> <span data-ttu-id="d6c22-105">配置を構成するためには複数のツールとプロセスを使用する必要があります。すべての作業を自動化する単一のプログラムやアプローチは存在しません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-105">You must use several tools and processes to configure a deployment; there is no single program or approach that can be used to automate all the tasks.</span></span>  
  
 <span data-ttu-id="d6c22-106">すべての手順を自動化することが必ずしも有効な手段ではありません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-106">Not every step should be automated.</span></span> <span data-ttu-id="d6c22-107">場合によっては、手作業またはグラフィカルなツールで作業することが、最も効率的かつシンプルな手段になる場合もあります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-107">In some cases, performing a step manually or through a graphical tool is the simplest and most effective approach.</span></span> <span data-ttu-id="d6c22-108">たとえば、大量のレポートやモデルを配置する必要がある場合、レポート サーバー環境を再構築するようなコードを作成するよりも、レポート サーバー データベースをコピーした方が効率的です。</span><span class="sxs-lookup"><span data-stu-id="d6c22-108">For example, if you want to deploy a large number of reports and models, it is better to copy the report server databases rather than write code that recreates report server environment.</span></span>  
  
 <span data-ttu-id="d6c22-109">中には、カスタム コードを必要とする手順もあります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-109">Some steps require custom code.</span></span> <span data-ttu-id="d6c22-110">たとえば、Web サービスとレポート マネージャーの URL の構成は自動化できますが、そのためには、レポート サーバーの Windows Management Instrumentation (WMI) プロバイダーを呼び出すカスタム コードを作成しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-110">For example, configuring the URLs for the Web service and Report Manager can be automated, but only if you write custom code that makes calls into the Report Server Windows Management Instrumentation (WMI) provider.</span></span> <span data-ttu-id="d6c22-111">なんらかの理由でコードを作成したくない場合は、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 構成ツールを使用して、この手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-111">If you do not want to write code, you must use the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool to perform the step.</span></span>  
  
 <span data-ttu-id="d6c22-112">レポート サーバーを構成するスクリプトを実行するには、構成するコンピューターのローカル管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-112">To run script that configures a report server, you must be a local administrator on the computer that you are configuring.</span></span> <span data-ttu-id="d6c22-113">詳細については、「 [リモート管理用のレポート サーバーの構成](../report-server/configure-a-report-server-for-remote-administration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-113">For more information, see [Configure a Report Server for Remote Administration](../report-server/configure-a-report-server-for-remote-administration.md).</span></span>  
  
 <span data-ttu-id="d6c22-114">このトピックでは、特定の手順を自動化する際に推奨されるアプローチについて説明します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-114">This topic describes recommended approaches for automating specific steps.</span></span> <span data-ttu-id="d6c22-115">いくつかのプログラムやプログラム インターフェイスに触れ、このトピックでそれぞれについて後述します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-115">Several programs and programmatic interfaces are mentioned; descriptions of each one are provided later in this topic.</span></span>  
  
## <a name="deployment-tasks-and-how-to-automate-them"></a><span data-ttu-id="d6c22-116">配置タスクと自動化の方法</span><span class="sxs-lookup"><span data-stu-id="d6c22-116">Deployment Tasks and How to Automate Them</span></span>  
 <span data-ttu-id="d6c22-117">次の表は、レポート サーバーを配置するために必要なインストール タスクおよび構成タスクをまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="d6c22-117">The following table summarizes the installation and configuration tasks that are necessary for deploying a report server.</span></span> <span data-ttu-id="d6c22-118">特定のタスクと、それを自動化するためのアプローチがひとめでわかるように記載されています。</span><span class="sxs-lookup"><span data-stu-id="d6c22-118">You can use the table to match a specific task to an approach that allows you to automate or perform the task unattended.</span></span>  
  
|<span data-ttu-id="d6c22-119">タスク</span><span class="sxs-lookup"><span data-stu-id="d6c22-119">Task</span></span>|<span data-ttu-id="d6c22-120">アプローチ</span><span class="sxs-lookup"><span data-stu-id="d6c22-120">Approach</span></span>|  
|----------|--------------|  
|<span data-ttu-id="d6c22-121">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]をインストールする。</span><span class="sxs-lookup"><span data-stu-id="d6c22-121">Install [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span>|<span data-ttu-id="d6c22-122">コマンド ラインからセットアップを実行することによって自動インストールが可能です。</span><span class="sxs-lookup"><span data-stu-id="d6c22-122">You can run setup from the command line to perform an unattended installation.</span></span><br /><br /> <span data-ttu-id="d6c22-123">セットアップ プログラムを使用すると、レポート サーバーのインストールと構成の両方を行うことができます。ただし、この場合は、既定の構成オプションを指定すること、システムが自動インストール要件をすべて満たしていることが条件となります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-123">You can use Setup to both install and configure a report server, but only if you specify the default configuration option and your system meets all the requirements for this installation type.</span></span> <span data-ttu-id="d6c22-124">既定の構成でインストールすることができない場合は、ファイルのみのインストールを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-124">If you cannot install the default configuration, you must perform a files-only installation.</span></span>|  
|<span data-ttu-id="d6c22-125">サービス アカウントを構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-125">Configure the service account.</span></span>|<span data-ttu-id="d6c22-126">サービス アカウントは、最初にセットアップを使用して構成されます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-126">The service account is initially configured through Setup.</span></span> <span data-ttu-id="d6c22-127">サービス アカウントに対する変更をセットアップ後のタスクとして自動化するには、レポート サーバー WMI プロバイダーを呼び出すカスタム コードを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-127">To automate changes to the service account as a post-Setup task, you must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="d6c22-128">サービス アカウントをプログラムによって構成するためのコマンド プロンプト ユーティリティやスクリプト テンプレートはありません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-128">There are no command-prompt utilities or script templates for configuring the service account programmatically.</span></span><br /><br /> <span data-ttu-id="d6c22-129">コードを作成するのが困難であるなど、なんらかの理由でこの手順を自動化できない場合は、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 構成ツールを実行することにより、アカウントを手動で簡単に構成できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-129">If coding requirements prevent you from automating this step, you can easily configure the account manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="d6c22-130">詳細については、「[サービス アカウントの構成 (SSRS 構成マネージャー)](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-130">For more information, see [Configure a Service Account &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="d6c22-131">レポート サーバー Web サービスとレポート マネージャーの URL を構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-131">Configure the Report Server Web service and Report Manager URLs.</span></span>|<span data-ttu-id="d6c22-132">レポート サーバー WMI プロバイダーを呼び出すカスタム コードを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-132">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="d6c22-133">URL を構成するためのコマンド ライン ユーティリティやスクリプト テンプレートはありません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-133">There are no command line utilities or script templates for configuring the URLs.</span></span><br /><br /> <span data-ttu-id="d6c22-134">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 構成ツールを実行して URL を手動で構成した場合、コードを作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-134">If you want to avoid writing code, you can configure the URLs manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="d6c22-135">詳細については、「[URL の構成 &#40;SSRS 構成マネージャー&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-135">For more information, see [Configure a URL  &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="d6c22-136">レポート サーバー データベースを作成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-136">Create the report server database.</span></span>|<span data-ttu-id="d6c22-137">レポート サーバー WMI プロバイダーを呼び出すカスタム コードを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-137">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="d6c22-138">レポート サーバー データベースと RSExecRole を作成するためのコマンド プロンプト ユーティリティやスクリプト テンプレートはありません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-138">There are no command-prompt utilities or script templates for creating the report server databases and RSExecRole.</span></span><br /><br /> <span data-ttu-id="d6c22-139">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 構成ツールを実行してデータベースを手動で作成した場合、コードを作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-139">If you want to avoid writing code, you can create the database manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="d6c22-140">詳細については、「[ネイティブ モードのレポート サーバー データベースの作成 (SSRS 構成マネージャー)](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-140">For more information, see [Create a Native Mode Report Server Database  &#40;SSRS Configuration Manager&#41;](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md).</span></span>|  
|<span data-ttu-id="d6c22-141">レポート サーバー データベース接続を構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-141">Configure the report server database connection.</span></span>|<span data-ttu-id="d6c22-142">接続文字列、アカウントまたはパスワード、認証の種類を変更する場合は、 **rsconfig** ユーティリティを実行して接続を構成します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-142">If you are changing the connection string, account or password, or the authentication type, run the **rsconfig** utility to configure the connection.</span></span> <span data-ttu-id="d6c22-143">詳細については、「[レポート サーバー データベース接続の構成 &#40;SSRS 構成マネージャー&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md)」および「[rsconfig ユーティリティ &#40;SSRS&#41;](rsconfig-utility-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-143">For more information, see [Configure a Report Server Database Connection  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md) and [rsconfig Utility &#40;SSRS&#41;](rsconfig-utility-ssrs.md).</span></span><br /><br /> <span data-ttu-id="d6c22-144">データベースの作成またはアップグレードに rsconfig.exe を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="d6c22-144">You cannot use rsconfig.exe to create or upgrade the database.</span></span> <span data-ttu-id="d6c22-145">データベースと RSExecRole が既に存在している必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-145">The database and RSExecRole must already exist.</span></span>|  
|<span data-ttu-id="d6c22-146">スケールアウト配置を構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-146">Configure a scale-out deployment.</span></span>|<span data-ttu-id="d6c22-147">スケールアウト配置を自動化するには、次のいずれかのアプローチを使用します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-147">Choose from the following approaches to automate scale-out deployment:</span></span><br /><br /> <span data-ttu-id="d6c22-148">rskeymgmt.exe ユーティリティを実行して、レポート サーバー インスタンスを既存の環境に追加する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-148">Run the rskeymgmt.exe utility to join report server instances to an existing installation.</span></span> <span data-ttu-id="d6c22-149">詳細については、「[スケールアウト配置に関する暗号化キーの追加と削除 &#40;SSRS構成マネージャー&#41;](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-149">For more information, see [Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md).</span></span><br /><br /> <span data-ttu-id="d6c22-150">レポート サーバー WMI プロバイダーに対して実行するカスタム コードを作成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-150">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="d6c22-151">暗号化キーをバックアップする。</span><span class="sxs-lookup"><span data-stu-id="d6c22-151">Backup encryption keys.</span></span>|<span data-ttu-id="d6c22-152">暗号化キーのバックアップを自動化するには、次のいずれかのアプローチを使用します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-152">Choose from the following approaches to automate encryption key backup:</span></span><br /><br /> <span data-ttu-id="d6c22-153">rskeymgmt.exe ユーティリティを実行してキーをバックアップする。</span><span class="sxs-lookup"><span data-stu-id="d6c22-153">Run the rskeymgmt.exe utility to back up the keys.</span></span> <span data-ttu-id="d6c22-154">詳細については、「 [Back Up and Restore Reporting Services Encryption Keys](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-154">For more information, see [Back Up and Restore Reporting Services Encryption Keys](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md).</span></span><br /><br /> <span data-ttu-id="d6c22-155">レポート サーバー WMI プロバイダーに対して実行するカスタム コードを作成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-155">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="d6c22-156">レポート サーバーの電子メールを構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-156">Configure Report Server E-mail.</span></span>|<span data-ttu-id="d6c22-157">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI プロバイダーに対して実行するカスタム コードを作成します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-157">Write custom code that runs against the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider.</span></span> <span data-ttu-id="d6c22-158">プロバイダーでは、電子メールの構成設定のサブセットがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="d6c22-158">The provider supports a subset of the e-mail configuration settings.</span></span><br /><br /> <span data-ttu-id="d6c22-159">RSReportServer.config ファイルにはすべての設定が含まれていますが、このファイルの使用を自動化しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-159">Although the RSReportServer.config file includes all the settings, do not use the file in an automated manner.</span></span> <span data-ttu-id="d6c22-160">特に、ファイルを別のレポート サーバーにコピーする場合は、バッチ ファイルを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-160">Specifically, do not use a batch file to copy the file to another report server.</span></span> <span data-ttu-id="d6c22-161">各構成ファイルには、現在のインスタンスに固有の値が含まれています。</span><span class="sxs-lookup"><span data-stu-id="d6c22-161">Each configuration file includes values that are specific to the current instance.</span></span> <span data-ttu-id="d6c22-162">これらの値は、別のレポート サーバー インスタンスでは無効になります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-162">Those values will not be valid on other report server instances.</span></span><br /><br /> <span data-ttu-id="d6c22-163">設定の詳細については、「[電子メール配信用にレポートサーバーを構成する &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-163">For more information about the settings, see [Configure a Report Server for E-Mail Delivery &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="d6c22-164">自動実行アカウントを構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-164">Configure the unattended execution account.</span></span>|<span data-ttu-id="d6c22-165">自動実行アカウントの構成を自動化するには、次のいずれかのアプローチを使用します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-165">Choose from the following approaches to automate unattended processing account configuration:</span></span><br /><br /> <span data-ttu-id="d6c22-166">rsconfig.exe ユーティリティを実行してアカウントを構成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-166">Run the rsconfig.exe utility to configure the account.</span></span> <span data-ttu-id="d6c22-167">詳細については、「[自動実行アカウントを構成する &#40;SSRS 構成マネージャー&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-167">For more information, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span><br /><br /> <span data-ttu-id="d6c22-168">レポート サーバー WMI プロバイダーを呼び出すカスタム コードを作成する。</span><span class="sxs-lookup"><span data-stu-id="d6c22-168">Write custom code that makes calls into the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="d6c22-169">既存のコンテンツを別のレポート サーバー上に配置する (フォルダー階層、ロールの割り当て、レポート、サブスクリプション、スケジュール、データ ソース、リソースなど)。</span><span class="sxs-lookup"><span data-stu-id="d6c22-169">Deploy existing content on another report server, including the folder hierarchy, role assignments, reports, subscriptions, schedules, data sources, and resources.</span></span>|<span data-ttu-id="d6c22-170">既存のレポート サーバー環境を再構築する最善の方法は、レポート サーバー データベースを新しいレポート サーバー インスタンスにコピーすることです。</span><span class="sxs-lookup"><span data-stu-id="d6c22-170">The best way to re-create an existing report server environment is to copy the report server database to a new report server instance.</span></span><br /><br /> <span data-ttu-id="d6c22-171">カスタム コードを作成して、既存のレポート サーバーのコンテンツをプログラムによって再構築する方法もあります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-171">An alternative approach is to write custom code that recreates existing report server content programmatically.</span></span> <span data-ttu-id="d6c22-172">ただし、サブスクリプション、レポート スナップショット、レポート履歴は、プログラムによって再作成できないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-172">However, be aware that subscriptions, report snapshots, and report history cannot be recreated programmatically.</span></span><br /><br /> <span data-ttu-id="d6c22-173">場合によっては両者を組み合わせた方法も効果的です (つまり、レポート サーバー データベースを復元してから、カスタム コードによって、特定の環境に合わせてレポート サーバー データベースを更新します)。</span><span class="sxs-lookup"><span data-stu-id="d6c22-173">Some deployments can benefit from using both techniques together (that is, restore a report server database, and then run custom code that modifies the report server database for a specific installation).</span></span><br /><br /> <span data-ttu-id="d6c22-174"> 詳細な例については、「 [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-174">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span><br /><br /> <span data-ttu-id="d6c22-175">レポート サーバー データベースの再配置の詳細については、「[別のコンピューターへのレポート サーバー データベースの移動 &#40;SSRS ネイティブ モード&#41;](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-175">For more information about relocating a report server database, see [Moving the Report Server Databases to Another Computer &#40;SSRS Native Mode&#41;](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md).</span></span> <span data-ttu-id="d6c22-176">レポート サーバー環境をプログラムによって構築する方法の詳細については、このトピックの「スクリプトを使用したレポート サーバー コンテンツとフォルダーの移行」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-176">For more information about creating report serer environment programmatically, see the section "Using Script to Migrate Report Server Content and Folders" in this topic.</span></span>|  
  
## <a name="tools-and-technologies-for-automating-server-deployment"></a><span data-ttu-id="d6c22-177">サーバー配置を自動化するためのツールと技法</span><span class="sxs-lookup"><span data-stu-id="d6c22-177">Tools and Technologies for Automating Server deployment</span></span>  
 <span data-ttu-id="d6c22-178">配置タスクとメンテナンス タスクを自動化するためのプログラムおよびインターフェイスを次に示します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-178">The following list summarizes the programs and interfaces that can be used to automate deployment and maintenance tasks:</span></span>  
  
-   <span data-ttu-id="d6c22-179">セットアップ プログラムを自動モードで実行して、レポート サーバー コンポーネントのインストールから、場合によっては構成までを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-179">The Setup program can be run in unattended mode to install and sometimes configure report server components.</span></span> <span data-ttu-id="d6c22-180">ファイルのみのインストール オプションを使用して、セットアップ時にレポート サーバー インスタンスが構成されるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-180">You must use the Files-Only installation option to have Setup configure a report server instance.</span></span>  
  
-   <span data-ttu-id="d6c22-181">ローカル サーバーとリモート サーバーの構成には、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI プロバイダーおよび [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] のコマンド ライン ユーティリティを使用できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-181">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider and [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] command line utilities can be used for local and remote server configuration.</span></span>  
  
     <span data-ttu-id="d6c22-182">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI プロバイダーは、サービス アカウントの指定、URL の構成、レポート サーバー データベースの作成と構成、電子メール配信用のレポート サーバーの構成など、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] のインストールのあらゆる機能を構成するための、クラス、プロパティ、およびメソッドを公開します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-182">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider exposes classes, properties, and methods that allow you to configure all aspects of a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation including specifying the service account, configuring URLs, creating and configuring the report server database, or configuring a report server for e-mail delivery.</span></span> <span data-ttu-id="d6c22-183">WMI プロバイダーを使用するには、カスタム コードまたはスクリプトを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-183">You must write custom code or script to use the WMI provider.</span></span> <span data-ttu-id="d6c22-184">詳細については、「 [Reporting Service WMI プロバイダーへのアクセス](access-the-reporting-services-wmi-provider.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-184">For more information, see [Access the Reporting Services WMI Provider](access-the-reporting-services-wmi-provider.md).</span></span>  
  
     <span data-ttu-id="d6c22-185">コードを作成する代わりに、コマンド ライン ユーティリティ (rsconfig.exe および rskeymgmt.exe) を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-185">An alternative to writing code is to use the command line utilities (rsconfig.exe and rskeymgmt.exe).</span></span> <span data-ttu-id="d6c22-186">これらのユーティリティを実行するバッチ ファイルを作成できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-186">You can write batch files that run the utilities.</span></span> <span data-ttu-id="d6c22-187">構成タスクの一部は、これらのユーティリティを使って自動化できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-187">You can use the utilities to automate some but not all configuration tasks.</span></span>  
  
-   <span data-ttu-id="d6c22-188">既存のコンテンツを再構築したり、レポート サーバーからレポート サーバーに移動したりするためのカスタム コードを [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] で作成し、レポート サーバーのスクリプト ホスト ツール (rs.exe) で実行できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-188">The report server script host tool (rs.exe) can run custom [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] code that you might write to re-create or move existing content from one report server to another.</span></span> <span data-ttu-id="d6c22-189">このアプローチでは、 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]でスクリプトを作成して .rss ファイルとして保存し、そのスクリプトを rs.exe を使用して、対象レポート サーバー上で実行します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-189">With this approach, you write script in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], save it as an .rss file, and use rs.exe to run the script on the target report server.</span></span> <span data-ttu-id="d6c22-190">作成するスクリプトでは、レポート サーバー Web サービスに対する SOAP インターフェイスを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-190">The script you write can call the SOAP interface to the Report Server Web service.</span></span> <span data-ttu-id="d6c22-191">配置スクリプトは、レポート サーバー フォルダーの名前空間および内容の再作成や、ロールベースのセキュリティの再作成を可能にするため、このアプローチで作成します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-191">Deployment scripts are written using this approach because it allows you to re-create a report server folder namespace and content, and re-create role-based security.</span></span>  
  
-   <span data-ttu-id="d6c22-192">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] リリースでは、SharePoint 統合モード用の PowerShell コマンドレットが導入されました。</span><span class="sxs-lookup"><span data-stu-id="d6c22-192">The [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] release introduced PowerShell cmdlets for SharePoint integrated mode.</span></span> <span data-ttu-id="d6c22-193">PowerShell を使用して、SharePoint 統合を構成および管理することができます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-193">You can use PowerShell to configure and administer the SharePoint integration.</span></span>  <span data-ttu-id="d6c22-194">詳細については、「 [Reporting Services SharePoint モード用の PowerShell コマンドレット](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-194">For more information, see [PowerShell cmdlets for Reporting Services SharePoint Mode](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md).</span></span>  
  
## <a name="use-scripts-to-migrate-report-server-content-and-folders"></a><span data-ttu-id="d6c22-195">スクリプトを使用したレポート サーバー コンテンツとフォルダーの移行</span><span class="sxs-lookup"><span data-stu-id="d6c22-195">Use Scripts to Migrate Report Server Content and Folders</span></span>  
 <span data-ttu-id="d6c22-196">レポート サーバー環境を別のレポート サーバー インスタンスに複製するためのスクリプトを作成できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-196">You can write scripts that duplicate a report server environment on another report server instance.</span></span> <span data-ttu-id="d6c22-197">配置スクリプトは、一般的には [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] で作成し、レポート サーバーのスクリプト ホスト ユーティリティで処理します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-197">Deployment scripts are generally written in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and then processed using the report server script host utility.</span></span>  
  
 <span data-ttu-id="d6c22-198"> 詳細な例については、「 [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-198">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
 <span data-ttu-id="d6c22-199">スクリプトを使用して、フォルダー、共有データ ソース、リソース、レポート、ロールの割り当て、および設定を、あるサーバーから別のサーバーにコピーします。</span><span class="sxs-lookup"><span data-stu-id="d6c22-199">Use scripts to copy folders, shared data sources, resources, reports, role assignments, and settings from one server to another.</span></span> <span data-ttu-id="d6c22-200">1 つのレポート サーバー インスタンス用のスクリプトを作成してから、そのスクリプトを別のサーバーで実行して、レポート サーバー名前空間を再作成します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-200">You write a script for one report server instance, and then run it on another server to re-create the report server namespace.</span></span> <span data-ttu-id="d6c22-201">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] で、複数のレポート サーバーを配置している場合は、各サーバーで個別にスクリプトを実行して、すべてのサーバーを同様に構成できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-201">If you have multiple report servers in your [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] deployment, you can run the script on each server individually to configure all servers in the same way.</span></span>  
  
 <span data-ttu-id="d6c22-202">次の一覧で、あるサーバーから別のサーバーにレポートを移行する手順を示します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-202">The following list describes the steps for migrating reports from one server to another.</span></span>  
  
1.  <span data-ttu-id="d6c22-203">スクリプト変数を移行元レポート サーバーの URL に設定します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-203">Set your script variable to the URL of the source report server.</span></span>  
  
2.  <span data-ttu-id="d6c22-204"><xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> メソッドおよび <xref:ReportService2010.ReportingService2010.GetProperties%2A> メソッドを使用して、レポートのレポート定義およびプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-204">Use the <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> and <xref:ReportService2010.ReportingService2010.GetProperties%2A> methods to retrieve the report definition and the properties of the report.</span></span>  
  
3.  <span data-ttu-id="d6c22-205">移行先サーバーを指すように URL を設定します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-205">Set the URL to point to the destination server.</span></span>  
  
4.  <span data-ttu-id="d6c22-206"><xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> メソッドを使用し、<xref:ReportService2010.ReportingService2010.GetProperties%2A> から返されたプロパティと <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> から返されたレポート定義を渡します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-206">Use <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> method, passing the properties returned from <xref:ReportService2010.ReportingService2010.GetProperties%2A> and the report definition returned by <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>.</span></span>  
  
 <span data-ttu-id="d6c22-207">get メソッドと create メソッドを組み合わせて使用することで、設定、フォルダー、共有データ ソース、およびリソースの移行と同様の手順を実行できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-207">By using a combination of get and create methods, you can perform similar steps to migrate settings, folders, shared data sources, and resources.</span></span> <span data-ttu-id="d6c22-208">使用可能なメソッドの詳細については、「[テクニカル リファレンス (SSRS)](../technical-reference-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-208">For more information about the methods available to you, see [Technical Reference &#40;SSRS&#41;](../technical-reference-ssrs.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d6c22-209">スクリプトは、資格情報を明示的に設定しない限り、スクリプトを実行しているユーザーの [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 資格情報を使用して実行されます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-209">Scripts run under the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials of the user running the script unless credentials are explicitly set.</span></span>  
  
 <span data-ttu-id="d6c22-210">スクリプト ファイルのフォーマットおよび実行方法の詳細については、「 [rs.exe ユーティリティと Web サービスを使用したスクリプト](script-with-the-rs-exe-utility-and-the-web-service.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-210">For more information about how to format and run a script file, see [Script with the rs.exe Utility and the Web Service](script-with-the-rs-exe-utility-and-the-web-service.md).</span></span>  
  
## <a name="using-scripts-to-set-server-properties"></a><span data-ttu-id="d6c22-211">スクリプトを使用したサーバー プロパティの設定</span><span class="sxs-lookup"><span data-stu-id="d6c22-211">Using Scripts to Set Server Properties</span></span>  
 <span data-ttu-id="d6c22-212">レポート サーバーのシステム プロパティを設定するスクリプトを作成できます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-212">You can write scripts that set system properties on the report server.</span></span> <span data-ttu-id="d6c22-213">次の [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET スクリプトは、プロパティを設定する 1 つの方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="d6c22-213">The following [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET script shows one way to set properties.</span></span> <span data-ttu-id="d6c22-214">この例では RSClientPrint ActiveX コントロールを無効にしていますが、`EnableClientPrinting` および `False` を有効なプロパティ名と値に置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="d6c22-214">This example disables the RSClientPrint ActiveX control, but you can replace `EnableClientPrinting` and `False` with any valid property name and value.</span></span> <span data-ttu-id="d6c22-215">サーバーのプロパティの完全な一覧については、「 [レポート サーバーのシステム プロパティ](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-215">To view a complete list of server properties, see [Report Server System Properties](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md).</span></span>  
  
 <span data-ttu-id="d6c22-216">スクリプトを使用するには、.rss 拡張子を持つファイルにスクリプトを保存し、rs.exe コマンド プロンプト ユーティリティを使用してレポート サーバー上でファイルを実行します。</span><span class="sxs-lookup"><span data-stu-id="d6c22-216">To use the script, save it to a file that has an .rss extension, and then use the rs.exe command prompt utility to run the file on the report server.</span></span> <span data-ttu-id="d6c22-217">スクリプトはコンパイルされないので [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]のインストールは不要です。</span><span class="sxs-lookup"><span data-stu-id="d6c22-217">The script is not compiled, so it is not necessary to have an installation of [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="d6c22-218">この例では、レポート サーバーをホストするローカル コンピューターに対する権限を持っていることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="d6c22-218">This example assumes that you have permissions on the local computer that hosts the report server.</span></span> <span data-ttu-id="d6c22-219">権限があるアカウントでログオンしていない場合は、追加のコマンド ライン引数を使用してアカウント情報を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6c22-219">If you are not logged on under an account that has permissions, you must specify account information through additional command line arguments.</span></span> <span data-ttu-id="d6c22-220">詳細については、「[RS.exe ユーティリティ (SSRS)](rs-exe-utility-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-220">For more information, see [RS.exe Utility &#40;SSRS&#41;](rs-exe-utility-ssrs.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="d6c22-221"> 詳細な例については、「 [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6c22-221">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
```vb
Public Sub Main()  
        Dim props(0) As [Property]  
        Dim setProp As New [Property]  
        setProp.Name = "EnableClientPrinting"  
        setProp.Value = "False"   
        props(0) = setProp  
        Try  
            rs.SetSystemProperties(props)  
        Catch ex As System.Web.Services.Protocols.SoapException  
            Console.Write(ex.Detail.InnerXml)  
        Catch e as Exception  
            Console.Write(e.Message)  
        End Try  
End Sub  
```  
  
## <a name="see-also"></a><span data-ttu-id="d6c22-222">参照</span><span class="sxs-lookup"><span data-stu-id="d6c22-222">See Also</span></span>  
 <span data-ttu-id="d6c22-223">[GenerateDatabaseCreationScript メソッド &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-223">[GenerateDatabaseCreationScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span></span>  
 <span data-ttu-id="d6c22-224">[GenerateDatabaseRightsScript メソッド &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-224">[GenerateDatabaseRightsScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span></span>  
 <span data-ttu-id="d6c22-225">[GenerateDatabaseUpgradeScript メソッド &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-225">[GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span></span>  
 <span data-ttu-id="d6c22-226">[コマンドプロンプトから SQL Server 2014 をインストールする](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-226">[Install SQL Server 2014 from the Command Prompt](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span></span>  
 <span data-ttu-id="d6c22-227">[Reporting Services ネイティブ モードのレポート サーバーのインストール](../install-windows/install-reporting-services-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-227">[Install Reporting Services Native Mode Report Server](../install-windows/install-reporting-services-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="d6c22-228">[Reporting Services レポート サーバー (ネイティブ モード)](../report-server/reporting-services-report-server-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-228">[Reporting Services Report Server &#40;Native Mode&#41;](../report-server/reporting-services-report-server-native-mode.md) </span></span>  
 <span data-ttu-id="d6c22-229">[レポート サーバーのコマンド プロンプト ユーティリティ &#40;SSRS&#41;](report-server-command-prompt-utilities-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-229">[Report Server Command Prompt Utilities &#40;SSRS&#41;](report-server-command-prompt-utilities-ssrs.md) </span></span>  
 <span data-ttu-id="d6c22-230">[Reporting Services と Power View のブラウザーサポートの計画 &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span><span class="sxs-lookup"><span data-stu-id="d6c22-230">[Planning for Reporting Services and Power View Browser Support &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span></span>  
 [<span data-ttu-id="d6c22-231">Reporting Services ツール</span><span class="sxs-lookup"><span data-stu-id="d6c22-231">Reporting Services Tools</span></span>](reporting-services-tools.md)  
