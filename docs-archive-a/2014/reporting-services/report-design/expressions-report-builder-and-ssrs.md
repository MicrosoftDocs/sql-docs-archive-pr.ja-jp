---
title: 式 (レポート ビルダーおよび SSRS) | Microsoft Docs
ms.prod: sql-server-2014
ms.technology: reporting-services
ms.topic: conceptual
ms.assetid: 76d3ac86-650c-46fe-8086-8b3edcea3882
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.reviewer: ''
ms.custom: ''
ms.date: 06/13/2017
ms.openlocfilehash: afd1b21986d0400ec8861520f3e86d1a80269036
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634856"
---
# <a name="expressions-report-builder-and-ssrs"></a><span data-ttu-id="d1c73-102">式 (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-102">Expressions (Report Builder and SSRS)</span></span>

<span data-ttu-id="d1c73-103">式はレポート全体にわたって、データの取得、計算、表示、グループ化、並べ替え、フィルター処理、パラメーター化、書式設定などのために広く使用されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-103">Expressions are widely used throughout a report to retrieve, calculate, display, group, sort, filter, parameterize, and format data.</span></span> <span data-ttu-id="d1c73-104">レポート アイテムのプロパティの多くには、式を設定できます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-104">Many report item properties can be set to an expression.</span></span> <span data-ttu-id="d1c73-105">式を使用すると、レポートの内容、デザイン、対話性を制御できます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-105">Expressions help you control the content, design, and interactivity of your report.</span></span> <span data-ttu-id="d1c73-106">式は [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] で作成され、レポート定義に保存され、レポートの実行時にレポート プロセッサによって評価されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-106">Expressions are written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)], saved in the report definition, and evaluated by the report processor when you run the report.</span></span>  

<span data-ttu-id="d1c73-107">ワークシート内で直接データを操作する [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Office Excel などのアプリケーションとは異なり、レポートではデータのプレースホルダーとなる式を操作します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-107">Unlike applications such as [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Office Excel where you work with data directly in a worksheet, in a report, you work with expressions that are placeholders for data.</span></span> <span data-ttu-id="d1c73-108">評価された式の値から実際のデータを確認するには、レポートをプレビューする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-108">To see the actual data from the evaluated expressions, you must preview the report.</span></span> <span data-ttu-id="d1c73-109">レポートの実行時に、レポート プロセッサーはテーブルやグラフなどのレポート データ要素とレポート レイアウト要素を組み合わせて、それぞれの式を評価します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-109">When you run the report, the report processor evaluates each expression as it combines report data and report layout elements such as tables and charts.</span></span>  

<span data-ttu-id="d1c73-110">レポートをデザインする場合、レポート アイテムの式の多くは、自動的に設定されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-110">As you design a report, many expressions for report items are set for you.</span></span> <span data-ttu-id="d1c73-111">たとえば、データ ペインからレポート デザイン画面のテーブル セルにフィールドをドラッグすると、そのフィールドのテキスト ボックスの値には単純式が設定されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-111">For example, when you drag a field from the data pane to a table cell on the report design surface, the text box value is set to a simple expression for the field.</span></span> <span data-ttu-id="d1c73-112">次の図では、レポート データ ペインに、データセット フィールドの ID、Name、SalesTerritory、Code、および Sales が表示されています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-112">In the following figure, the Report Data pane displays the dataset fields ID, Name, SalesTerritory, Code, and Sales.</span></span> <span data-ttu-id="d1c73-113">テーブルに [Name]、[Code]、[Sales] の 3 つのフィールドが追加されています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-113">Three fields have been added to the table: [Name], [Code], and [Sales].</span></span> <span data-ttu-id="d1c73-114">デザイン画面上の [Name] の表記は基になる式 `=Fields!Name.Value`を表しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-114">The notation [Name] on the design surface represents the underlying expression `=Fields!Name.Value`.</span></span>  

<span data-ttu-id="d1c73-115">![rs_DataDesignandPreview](../media/rs-datadesignandpreview.gif "rs_DataDesignandPreview")</span><span class="sxs-lookup"><span data-stu-id="d1c73-115">![rs_DataDesignandPreview](../media/rs-datadesignandpreview.gif "rs_DataDesignandPreview")</span></span>  

<span data-ttu-id="d1c73-116">レポートをプレビューすると、レポート プロセッサーによってテーブル データ領域がデータ接続からの実際のデータと結合され、結果セット内の各行に対してテーブル内に行が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-116">When you preview the report, the report processor combines the table data region with the actual data from the data connection and displays a row in the table for every row in the result set.</span></span>  

<span data-ttu-id="d1c73-117">式を手動で入力するには、デザイン画面でアイテムを選択し、ショートカット メニューおよびダイアログ ボックスを使用して、アイテムのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-117">To enter expressions manually, select an item on the design surface, and use shortcut menus and dialog boxes to set the properties of the item.</span></span> <span data-ttu-id="d1c73-118">***[fx]*** ボタンが表示されている場合、またはドロップダウン リストに値 `<Expression>` が表示されている場合、式のプロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-118">When you see the ***(fx)*** button or the value `<Expression>` in a drop-down list, you know that you can set the property to an expression.</span></span> <span data-ttu-id="d1c73-119">詳細については、「 [式の追加 (レポート ビルダーおよび SSRS)](add-an-expression-report-builder-and-ssrs.md)を表しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-119">For more information, see [Add an Expression &#40;Report Builder and SSRS&#41;](add-an-expression-report-builder-and-ssrs.md).</span></span>  

<span data-ttu-id="d1c73-120">詳細およびサンプルについては、次のトピックを参照してください:</span><span class="sxs-lookup"><span data-stu-id="d1c73-120">For more information and examples, see the following topics:</span></span>  

-   [<span data-ttu-id="d1c73-121">レポートでの式の使用 (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-121">Expression Uses in Reports &#40;Report Builder and SSRS&#41;</span></span>](expression-uses-in-reports-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="d1c73-122">式の例 (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-122">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="d1c73-123">フィルター式の例 &#40;レポート ビルダーおよび SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="d1c73-123">Filter Equation Examples &#40;Report Builder and SSRS&#41;</span></span>](filter-equation-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="d1c73-124">グループ式の例 &#40;レポート ビルダーおよび SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="d1c73-124">Group Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](group-expression-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="d1c73-125">チュートリアル &#40;レポートビルダー&#41;</span><span class="sxs-lookup"><span data-stu-id="d1c73-125">Tutorials &#40;Report Builder&#41;</span></span>](../report-builder-tutorials.md)  

-   [<span data-ttu-id="d1c73-126">Reporting Services チュートリアル &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="d1c73-126">Reporting Services Tutorials &#40;SSRS&#41;</span></span>](../reporting-services-tutorials-ssrs.md)  

-   [<span data-ttu-id="d1c73-127">レポート サンプル (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-127">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  

<span data-ttu-id="d1c73-128">複合式、またはカスタム コードやカスタム アセンブリを使った式を作成するには、 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]でレポート デザイナーを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="d1c73-128">To develop complex expressions or expressions that use custom code or custom assemblies, we recommend that you use Report Designer in [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="d1c73-129">詳細については、「 [レポート デザイナーでカスタム コードやアセンブリを式から参照する (SSRS)](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)を表しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-129">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  

> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  

##  <a name="understanding-simple-and-complex-expressions"></a><a name="Types"></a> <span data-ttu-id="d1c73-130">単純式と複合式について</span><span class="sxs-lookup"><span data-stu-id="d1c73-130">Understanding Simple and Complex Expressions</span></span>  
<span data-ttu-id="d1c73-131">式は等号 (=) で始まり、で記述されてい [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-131">Expressions begin with an equal sign (=) and are written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="d1c73-132">式には、定数、演算子、および組み込みの値 (フィールド、コレクション、および関数) への参照、拡張またはカスタム コードへの参照の組み合わせを含むことができます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-132">Expressions can include a combination of constants, operators, and references to built-in values (fields, collections, and functions), and to external or custom code.</span></span>  

<span data-ttu-id="d1c73-133">式を使用すると、多くのレポート アイテム プロパティの値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-133">You can use expressions to specify the value of many report item properties.</span></span> <span data-ttu-id="d1c73-134">最も一般的なプロパティは、テキスト ボックスとプレースホルダーのテキストの値です。</span><span class="sxs-lookup"><span data-stu-id="d1c73-134">The most common properties are values for text boxes and placeholder text.</span></span> <span data-ttu-id="d1c73-135">通常、テキスト ボックスに 1 つの式しか含まれていない場合、その式がテキスト ボックス プロパティの値となります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-135">Typically, if a text box contains only one expression, the expression is the value of the text box property.</span></span> <span data-ttu-id="d1c73-136">テキスト ボックスに複数の式が含まれている場合は、各式がテキスト ボックス内のプレースホルダー テキストの値となります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-136">If a text box contains multiple expressions, each expression is the value of placeholder text in the text box.</span></span>  

<span data-ttu-id="d1c73-137">既定では、式はレポートのデザイン画面に *単純式* または *複合式*として表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-137">By default, expressions appear on the report design surface as *simple* or *complex expressions*.</span></span>  

-   <span data-ttu-id="d1c73-138">**単純** 組み込みコレクション (データセット フィールド、パラメーター、または組み込みフィールドなど) 内の 1 つのアイテムへの参照を含む単純式です。</span><span class="sxs-lookup"><span data-stu-id="d1c73-138">**Simple** A simple expression contains a reference to a single item in a built-in collection, for example, a dataset field, a parameter, or a built-in field.</span></span> <span data-ttu-id="d1c73-139">デザイン画面では、単純式は角かっこ内に表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-139">On the design surface, a simple expression appears in brackets.</span></span> <span data-ttu-id="d1c73-140">たとえば、 `[FieldName]` は基となる式 `=Fields!FieldName.Value`に対応します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-140">For example, `[FieldName]` corresponds to the underlying expression `=Fields!FieldName.Value`.</span></span> <span data-ttu-id="d1c73-141">単純式は、レポート レイアウトを作成し、[レポート データ] ペインからデザイン画面にアイテムをドラッグする際に自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-141">Simple expressions are created for you automatically as you create the report layout and drag items from the Report Data pane to the design surface.</span></span> <span data-ttu-id="d1c73-142">さまざまな組み込みコレクションを表す記号の詳細については、「 [単純式でのプレフィックス記号について](#DisplayText)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d1c73-142">For more information about the symbols that represent different built-in collections, see [Understanding Prefix Symbols for Simple Expressions](#DisplayText).</span></span>  

-   <span data-ttu-id="d1c73-143">**複合** 複合式には、複数の組み込み参照、演算子、および関数呼び出しへの参照が含まれます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-143">**Complex** A complex expression contains references to multiple built-in references, operators, and function calls.</span></span> <span data-ttu-id="d1c73-144">\<Expr>式の値に単純な参照が含まれている場合、複合式は <> として表示されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-144">A complex expression appears as <\<Expr>> when the expression value includes more than a simple reference.</span></span> <span data-ttu-id="d1c73-145">式を表示するには、その上にカーソルを合わせ、ツールヒントを使用します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-145">To view the expression, hover over it and use the tooltip.</span></span> <span data-ttu-id="d1c73-146">式を編集するには、 **[式]** ダイアログ ボックスでそれを開きます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-146">To edit the expression, open it in the **Expression** dialog box.</span></span>  

<span data-ttu-id="d1c73-147">次の図は、テキスト ボックスおよびプレースホルダー テキストの両方の典型的な単純式と複合式を示しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-147">The following figure shows typical simple and complex expressions for both text boxes and placeholder text.</span></span>  

<span data-ttu-id="d1c73-148">![rs_ExpressionDefaultFormat](../media/rs-expressiondefaultformat.gif "rs_ExpressionDefaultFormat")</span><span class="sxs-lookup"><span data-stu-id="d1c73-148">![rs_ExpressionDefaultFormat](../media/rs-expressiondefaultformat.gif "rs_ExpressionDefaultFormat")</span></span>  

<span data-ttu-id="d1c73-149">式のテキストではなくサンプル値を表示するには、テキスト ボックスまたはプレースホルダー テキストに書式を適用します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-149">To display sample values instead of text for expressions, apply formatting to the text box or placeholder text.</span></span> <span data-ttu-id="d1c73-150">次の図は、サンプル値に切り替えられたレポートのデザイン画面を示しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-150">The following figure shows the report design surface toggled to show sample values:</span></span>  

<span data-ttu-id="d1c73-151">![rs_ExpressionSampleValuesFormat](../media/rs-expressionsamplevaluesformat.gif "rs_ExpressionSampleValuesFormat")</span><span class="sxs-lookup"><span data-stu-id="d1c73-151">![rs_ExpressionSampleValuesFormat](../media/rs-expressionsamplevaluesformat.gif "rs_ExpressionSampleValuesFormat")</span></span>  

<span data-ttu-id="d1c73-152">詳細については、「 [テキストとプレースホルダーの書式設定 &#40;レポート ビルダーおよび SSRS&#41;](formatting-text-and-placeholders-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d1c73-152">For more information, see [Formatting Text and Placeholders &#40;Report Builder and SSRS&#41;](formatting-text-and-placeholders-report-builder-and-ssrs.md).</span></span>  

## <a name="understanding-prefix-symbols-in-simple-expressions"></a><a name="DisplayText"></a><span data-ttu-id="d1c73-153">単純式でのプレフィックス記号について</span><span class="sxs-lookup"><span data-stu-id="d1c73-153">Understanding Prefix Symbols in Simple Expressions</span></span>  

<span data-ttu-id="d1c73-154">単純式では、記号を使用して、参照先 (フィールド、パラメーター、組み込みコレクション、または ReportItems コレクション) を示します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-154">Simple expressions use symbols to indicate whether the reference is to a field, a parameter, a built-in collection, or the ReportItems collection.</span></span> <span data-ttu-id="d1c73-155">表示テキストおよび式のテキストの例を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-155">The following table shows examples of display and expression text:</span></span>  

|<span data-ttu-id="d1c73-156">Item</span><span class="sxs-lookup"><span data-stu-id="d1c73-156">Item</span></span>|<span data-ttu-id="d1c73-157">表示テキストの例</span><span class="sxs-lookup"><span data-stu-id="d1c73-157">Display text example</span></span>|<span data-ttu-id="d1c73-158">式のテキストの例</span><span class="sxs-lookup"><span data-stu-id="d1c73-158">Expression text example</span></span>|  
|----------|--------------------------|-----------------------------|  
|<span data-ttu-id="d1c73-159">データセット フィールド</span><span class="sxs-lookup"><span data-stu-id="d1c73-159">Dataset fields</span></span>|`[Sales]`<br /><br /> `[SUM(Sales)]`<br /><br /> `[FIRST(Store)]`|`=Fields!Sales.Value`<br /><br /> `=Sum(Fields!Sales.Value)`<br /><br /> `=First(Fields!Store.Value)`|  
|<span data-ttu-id="d1c73-160">レポート パラメーター</span><span class="sxs-lookup"><span data-stu-id="d1c73-160">Report parameters</span></span>|`[@Param]`<br /><br /> `[@Param.Label]`|`=Parameters!Param.Value`<br /><br /> `=Parameters!Param.Label`|  
|<span data-ttu-id="d1c73-161">組み込みフィールド</span><span class="sxs-lookup"><span data-stu-id="d1c73-161">Built-in fields</span></span>|`[&ReportName]`|`=Globals!ReportName.Value`|  
|<span data-ttu-id="d1c73-162">表示テキストに使用されるリテラル文字</span><span class="sxs-lookup"><span data-stu-id="d1c73-162">Literal characters used for display text</span></span>|`\[Sales\]`|`[Sales]`|  



##  <a name="writing-complex-expressions"></a><a name="References"></a> <span data-ttu-id="d1c73-163">複合式の作成</span><span class="sxs-lookup"><span data-stu-id="d1c73-163">Writing Complex Expressions</span></span>  
<span data-ttu-id="d1c73-164">式には、関数、演算子、定数、フィールド、パラメーター、組み込みコレクションのアイテム、および埋め込みのカスタム コードまたはカスタム アセンブリへの参照を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-164">Expressions can include references to functions, operators, constants, fields, parameters, items from built-in collections, and to embedded custom code or custom assemblies.</span></span>  

> [!NOTE]
>  <span data-ttu-id="d1c73-165">複合式、またはカスタム コードやカスタム アセンブリを使った式を作成するには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]でレポート デザイナーを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="d1c73-165">To develop complex expressions or expressions that use custom code or custom assemblies, we recommend that you use Report Designer in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="d1c73-166">詳細については、「 [レポート デザイナーでカスタム コードやアセンブリを式から参照する (SSRS)](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)を表しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-166">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  

<span data-ttu-id="d1c73-167">次の表に、式に含めることのできる参照の種類の一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-167">The following table lists the kinds of references you can include in an expression:</span></span>  

|<span data-ttu-id="d1c73-168">References</span><span class="sxs-lookup"><span data-stu-id="d1c73-168">References</span></span>|<span data-ttu-id="d1c73-169">説明</span><span class="sxs-lookup"><span data-stu-id="d1c73-169">Description</span></span>|<span data-ttu-id="d1c73-170">例</span><span class="sxs-lookup"><span data-stu-id="d1c73-170">Example</span></span>|  
|----------------|-----------------|-------------|  
|[<span data-ttu-id="d1c73-171">定数</span><span class="sxs-lookup"><span data-stu-id="d1c73-171">Constants</span></span>](expressions-report-builder-and-ssrs.md)|<span data-ttu-id="d1c73-172">定数値を必要とするプロパティ (フォントの色など) に対話的にアクセスできる定数について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-172">Describes the constants you can access interactively for properties that require constant values, such as font colors.</span></span>|`="Blue"`|  
|[<span data-ttu-id="d1c73-173">オペレーター</span><span class="sxs-lookup"><span data-stu-id="d1c73-173">Operators</span></span>](operators-in-expressions-report-builder-and-ssrs.md)|<span data-ttu-id="d1c73-174">式の中で参照を組み合わせる際に使用できる演算子について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-174">Describes the operators you can use to combine references in an expression.</span></span> <span data-ttu-id="d1c73-175">たとえば、`&` 演算子は、文字列を連結する場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-175">For example, the `&` operator is used for concatenating strings.</span></span>|`="The report ran at: " & Globals!ExecutionTime & "."`|  
|[<span data-ttu-id="d1c73-176">組み込みコレクション</span><span class="sxs-lookup"><span data-stu-id="d1c73-176">Built-in Collections</span></span>](built-in-collections-in-expressions-report-builder.md)|<span data-ttu-id="d1c73-177">式に含めることができる組み込みコレクション ( `Fields`、 `Parameters`、 `Variables`など) について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-177">Describes the built-in collections that you can include in an expression, such as `Fields`, `Parameters`, and `Variables`.</span></span>|`=Fields!Sales.Value`<br /><br /> `=Parameters!Store.Value`<br /><br /> `=Variables!MyCalculation.Value`|  
|[<span data-ttu-id="d1c73-178">組み込みのレポート関数と集計関数</span><span class="sxs-lookup"><span data-stu-id="d1c73-178">Built-in Report and Aggregate Functions</span></span>](report-builder-functions-aggregate-functions-reference.md)|<span data-ttu-id="d1c73-179">式からアクセスできる、 `Sum` や `Previous`などの組み込み関数について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-179">Describes the built-in functions, such as `Sum` or `Previous`, that you can access from an expression.</span></span>|`=Previous(Sum(Fields!Sales.Value))`|  
|[<span data-ttu-id="d1c73-180">レポート デザイナーでカスタム コードやアセンブリを式から参照する (SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-180">Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;</span></span>](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)|<span data-ttu-id="d1c73-181">組み込みの CLR クラス <xref:System.Math> と <xref:System.Convert>、その他の CLR クラス、 [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] ランタイム ライブラリ関数、または外部アセンブリのメソッドにアクセスする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-181">Describes how you can access the built-in CLR classes <xref:System.Math> and <xref:System.Convert>, other CLR classes, [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] run-time library functions, or methods from an external assembly.</span></span><br /><br /> <span data-ttu-id="d1c73-182">レポート内に埋め込まれているカスタム コード、またはレポート クライアントとレポート サーバーの両方でカスタム アセンブリとしてコンパイルしてインストールするカスタム コードへのアクセス方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-182">Describes how you can access custom code that is embedded in your report, or that you compile and install as a custom assembly on both the report client and the report server.</span></span>|`=Sum(Fields!Sales.Value)`<br /><br /> `=CDate(Fields!SalesDate.Value)`<br /><br /> `=DateAdd("d",3,Fields!BirthDate.Value)`<br /><br /> `=Code.ToUSD(Fields!StandardCost.Value)`|  



##  <a name="validating-expressions"></a><a name="Valid"></a> <span data-ttu-id="d1c73-183">式の検証</span><span class="sxs-lookup"><span data-stu-id="d1c73-183">Validating Expressions</span></span>  
<span data-ttu-id="d1c73-184">特定のレポート アイテム プロパティの式を作成する場合、式に含めることのできる参照は、レポート アイテム プロパティで受け入れられる値と、プロパティの評価のスコープによって異なります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-184">When you create an expression for a specific report item property, the references that you can include in an expression depend on the values that the report item property can accept and the scope in which the property is evaluated.</span></span> <span data-ttu-id="d1c73-185">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-185">For example:</span></span>  

-   <span data-ttu-id="d1c73-186">既定では、式 [Sum] は式の評価時のスコープ内のデータの合計を計算します。</span><span class="sxs-lookup"><span data-stu-id="d1c73-186">By default, the expression [Sum] calculates the sum of data that is in scope at the time the expression is evaluated.</span></span> <span data-ttu-id="d1c73-187">テーブル セルの場合、スコープは行と列のグループ メンバーシップによって異なります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-187">For a table cell, the scope depends on row and column group memberships.</span></span> <span data-ttu-id="d1c73-188">詳細については、「 [合計、集計、および組み込みコレクションの式のスコープ (レポート ビルダーおよび SSRS)](expression-scope-for-totals-aggregates-and-built-in-collections.md)を表しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-188">For more information, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  

-   <span data-ttu-id="d1c73-189">Font プロパティの値については、値はフォント名に評価される必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-189">For the value for a Font property, the value must evaluate to the name of a font.</span></span>  

-   <span data-ttu-id="d1c73-190">式の構文はデザイン時に検証されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-190">Expression syntax is validated at design time.</span></span> <span data-ttu-id="d1c73-191">式のスコープの検証は、レポートのパブリッシュ時に行われます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-191">Expression scope validation occurs when you publish the report.</span></span> <span data-ttu-id="d1c73-192">実際のデータに依存する検証の場合、エラーは実行時にしか検出されません。</span><span class="sxs-lookup"><span data-stu-id="d1c73-192">For validation that depends on the actual data, errors can only be detected at run-time.</span></span> <span data-ttu-id="d1c73-193">これらの式の一部では、レンダリングされたレポートでエラー メッセージとして #Error が生成されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-193">Some of these expressions produce #Error as an error message in the rendered report.</span></span> <span data-ttu-id="d1c73-194">この種類のエラーの問題を特定するためには、 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]でレポート デザイナーを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d1c73-194">To help determine the issues for this kind of error, you must use Report Designer in [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="d1c73-195">レポート デザイナーの出力ウィンドウには、これらのエラーの詳細が示されます。</span><span class="sxs-lookup"><span data-stu-id="d1c73-195">Report Designer provides an Output window that provides more information about these errors.</span></span>  

<span data-ttu-id="d1c73-196">詳細については、「 [式のリファレンス (レポート ビルダーおよび SSRS)](expression-reference-report-builder-and-ssrs.md)を表しています。</span><span class="sxs-lookup"><span data-stu-id="d1c73-196">For more information, see [Expression Reference &#40;Report Builder and SSRS&#41;](expression-reference-report-builder-and-ssrs.md).</span></span>  

## <a name="in-this-section"></a><a name="Section"></a> <span data-ttu-id="d1c73-197">トピックの内容</span><span class="sxs-lookup"><span data-stu-id="d1c73-197">In This Section</span></span>

[<span data-ttu-id="d1c73-198">式の追加 (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-198">Add an Expression &#40;Report Builder and SSRS&#41;</span></span>](add-an-expression-report-builder-and-ssrs.md)  

[<span data-ttu-id="d1c73-199">レポートでの式の使用 (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-199">Expression Uses in Reports &#40;Report Builder and SSRS&#41;</span></span>](expression-uses-in-reports-report-builder-and-ssrs.md)  

[<span data-ttu-id="d1c73-200">合計、集計、および組み込みコレクションの式のスコープ (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-200">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  

[<span data-ttu-id="d1c73-201">式のリファレンス (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="d1c73-201">Expression Reference &#40;Report Builder and SSRS&#41;</span></span>](expression-reference-report-builder-and-ssrs.md)  

## <a name="see-also"></a><span data-ttu-id="d1c73-202">参照</span><span class="sxs-lookup"><span data-stu-id="d1c73-202">See Also</span></span>

- <span data-ttu-id="d1c73-203">[[式] ダイアログ ボックス](../expression-dialog-box.md)</span><span class="sxs-lookup"><span data-stu-id="d1c73-203">[Expression Dialog Box](../expression-dialog-box.md)</span></span>   
- <span data-ttu-id="d1c73-204">[[式] ダイアログ ボックス &#40;レポート ビルダー&#41;](../expression-dialog-box-report-builder.md)</span><span class="sxs-lookup"><span data-stu-id="d1c73-204">[Expression Dialog Box &#40;Report Builder&#41;](../expression-dialog-box-report-builder.md)</span></span>