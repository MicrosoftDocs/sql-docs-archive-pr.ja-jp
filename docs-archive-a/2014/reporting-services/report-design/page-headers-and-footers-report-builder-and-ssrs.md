---
title: ページ ヘッダーとページ フッター (レポート ビルダーおよび SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- sql12.rtp.rptdesigner.pagefooter.fill.f1
- "10125"
- "10121"
- "10120"
- "10122"
- "10123"
- sql12.rtp.rptdesigner.pageheader.border.f1
- sql12.rtp.rptdesigner.pageheader.general.f1
- sql12.rtp.rptdesigner.pagefooter.border.f1
- sql12.rtp.rptdesigner.pageheader.fill.f1
- sql12.rtp.rptdesigner.pagefooter.general.f1
- "10124"
ms.assetid: 4fb9faac-511e-404a-b8d7-1f2e3cb47b11
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: d534833a6820c9924e69ae0575341d578b746732
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87640692"
---
# <a name="page-headers-and-footers-report-builder-and-ssrs"></a><span data-ttu-id="c8353-102">ページ ヘッダーとページ フッター (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="c8353-102">Page Headers and Footers (Report Builder and SSRS)</span></span>
  <span data-ttu-id="c8353-103">レポートには、各ページの上部と下部にヘッダーとフッターを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c8353-103">A report can contain a header and footer that run along the top and bottom of each page, respectively.</span></span> <span data-ttu-id="c8353-104">ヘッダーとフッターには、静的テキスト、画像、線、四角形、罫線、背景色、背景画像、式などを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c8353-104">Headers and footers can contain static text, images, lines, rectangles, borders, background color, background images, and expressions.</span></span> <span data-ttu-id="c8353-105">式には、データセットが 1 つしかないレポートでのデータセット フィールド参照と、スコープとしてデータセットを指定する集計関数呼び出しが含まれます。</span><span class="sxs-lookup"><span data-stu-id="c8353-105">Expressions include dataset field references for reports with exactly one dataset and aggregate function calls that include the dataset as a scope.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c8353-106">表示拡張機能の種類によって、ページの処理方法が異なります。</span><span class="sxs-lookup"><span data-stu-id="c8353-106">Each rendering extension processes pages differently.</span></span> <span data-ttu-id="c8353-107">レポートの改ページおよび表示拡張機能の詳細については、「[Reporting Services の改ページ (レポート ビルダーおよび SSRS)](pagination-in-reporting-services-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-107">For more information about report pagination and rendering extensions, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="c8353-108">既定では、レポートにはページ フッターは含まれますが、ページ ヘッダーは含まれません。</span><span class="sxs-lookup"><span data-stu-id="c8353-108">By default, reports have page footers, but not page headers.</span></span> <span data-ttu-id="c8353-109">追加または削除する方法の詳細については、「[ページ ヘッダーまたはページ フッターの追加および削除 (レポート ビルダーおよび SSRS)](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-109">For more information about how to add or remove them, see [Add or Remove a Page Header or Footer &#40;Report Builder and SSRS&#41;](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="c8353-110">ヘッダーおよびフッターには、通常、ページ番号、レポート タイトル、およびその他のレポート プロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="c8353-110">Headers and footers commonly contain page numbers, report titles, and other report properties.</span></span> <span data-ttu-id="c8353-111">レポート ヘッダーまたはフッターにこれらの項目を追加する方法の詳細については、「[ページ番号またはその他のレポート プロパティの表示 (レポート ビルダーおよび SSRS)](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-111">For more information about how to add these items to your report header or footer, see [Display Page Numbers or Other Report Properties &#40;Report Builder and SSRS&#41;](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="c8353-112">ページ ヘッダーまたはページ フッターを作成すると、各レポート ページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-112">After you create a page header or footer, it is displayed on each report page.</span></span> <span data-ttu-id="c8353-113">最初のページと最後のページでページ ヘッダーとページ フッターを非表示にする方法の詳細については、「[最初のページまたは最後のページでページ ヘッダーまたはページ フッターを非表示にする (レポート ビルダーおよび SSRS)](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-113">For more information about how to suppress page headers and footers on the first and last pages, see [Hide a Page Header or Footer on the First or Last Page &#40;Report Builder and SSRS&#41;](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-headers-and-footers"></a><span data-ttu-id="c8353-114">レポートのヘッダーとフッター</span><span class="sxs-lookup"><span data-stu-id="c8353-114">Report Headers and Footers</span></span>  
 <span data-ttu-id="c8353-115">ページ ヘッダーとページ フッターは、レポート ヘッダーとレポート フッターとは異なります。</span><span class="sxs-lookup"><span data-stu-id="c8353-115">Page headers and footers are not the same as report headers and footers.</span></span> <span data-ttu-id="c8353-116">レポートには、レポート ヘッダーやレポート フッターの特別な領域がありません。</span><span class="sxs-lookup"><span data-stu-id="c8353-116">Reports do not have a special report header or report footer area.</span></span> <span data-ttu-id="c8353-117">レポート ヘッダーは、レポート デザイン画面でレポート本文の一番上に配置されるレポート アイテムで構成されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-117">A report header consists of the report items that are placed at the top of the report body on the report design surface.</span></span> <span data-ttu-id="c8353-118">これらはレポートの最初のコンテンツとして 1 回だけ表示されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-118">They appear only once as the first content in the report.</span></span> <span data-ttu-id="c8353-119">レポート フッターは、レポート本文の一番下に配置されるレポート アイテムで構成されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-119">A report footer consists of report items that are placed at the bottom of the report body.</span></span> <span data-ttu-id="c8353-120">これらはレポートの最後のコンテンツとして 1 回だけ表示されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-120">They appear only once as the last content in the report.</span></span>  
  
## <a name="displaying-variable-data-in-a-page-header-or-footer"></a><span data-ttu-id="c8353-121">ページ ヘッダーまたはページ フッターへの変数データの表示</span><span class="sxs-lookup"><span data-stu-id="c8353-121">Displaying Variable Data in a Page Header or Footer</span></span>  
 <span data-ttu-id="c8353-122">ページ ヘッダーおよびページ フッターには静的なコンテンツを含めることもできますが、一般的にはページ番号やページのコンテンツに関する情報などの動的なコンテンツを表示します。</span><span class="sxs-lookup"><span data-stu-id="c8353-122">Page headers and footers can contain static content, but they are more commonly used to display varying content like page numbers or information about the contents of a page.</span></span> <span data-ttu-id="c8353-123">ページごとに異なる変数データを表示するには、式を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-123">To display variable data that is different on each page, you must use an expression.</span></span>  
  
 <span data-ttu-id="c8353-124">レポートで定義されているデータセットが 1 つだけの場合は、 `[FieldName]` のような単純な式をページ ヘッダーまたはページ フッターに追加できます。</span><span class="sxs-lookup"><span data-stu-id="c8353-124">If there is only one dataset defined in the report, you can add simple expressions such as `[FieldName]` to a page header or footer.</span></span> <span data-ttu-id="c8353-125">レポート データ ペインのデータセット フィールド コレクションまたは組み込みフィールド コレクションからページ ヘッダーまたはページ フッターにフィールドをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c8353-125">Drag the field from the Report Data pane dataset field collection or the Built-in Fields collection to the page header or page footer.</span></span> <span data-ttu-id="c8353-126">適切な式が含まれたテキスト ボックスが自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-126">A text box with the appropriate expression is automatically added for you.</span></span>  
  
 <span data-ttu-id="c8353-127">ページの値の合計やその他の集計を計算するには、ReportItems またはデータセット名を指定する集計式を使用できます。</span><span class="sxs-lookup"><span data-stu-id="c8353-127">To calculate sums or other aggregates for values on the page, you can use aggregate expressions that specify ReportItems or the name of a dataset.</span></span> <span data-ttu-id="c8353-128">ReportItems コレクションは、レポートが表示された後の各ページにあるテキスト ボックスのコレクションです。</span><span class="sxs-lookup"><span data-stu-id="c8353-128">The ReportItems collection is the collection of text boxes on each page after report rendering occurs.</span></span> <span data-ttu-id="c8353-129">データセット名がレポート定義に存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-129">The dataset name must exist in the report definition.</span></span> <span data-ttu-id="c8353-130">次の表に、各集計式タイプでサポートされているアイテムを示します。</span><span class="sxs-lookup"><span data-stu-id="c8353-130">The following table displays which items are supported in each type of aggregate expression:</span></span>  
  
|<span data-ttu-id="c8353-131">式でサポート</span><span class="sxs-lookup"><span data-stu-id="c8353-131">Supported in expression</span></span>|<span data-ttu-id="c8353-132">ReportItems の集計</span><span class="sxs-lookup"><span data-stu-id="c8353-132">ReportItems aggregates</span></span>|<span data-ttu-id="c8353-133">データセットの集計 (スコープがデータセット名であること)</span><span class="sxs-lookup"><span data-stu-id="c8353-133">Dataset aggregates (scope must be name of dataset)</span></span>|  
|-----------------------------|----------------------------|----------------------------------------------------------|  
|<span data-ttu-id="c8353-134">レポート本文のテキスト ボックス</span><span class="sxs-lookup"><span data-stu-id="c8353-134">Text boxes in body of report</span></span>|<span data-ttu-id="c8353-135">はい</span><span class="sxs-lookup"><span data-stu-id="c8353-135">Yes</span></span>|<span data-ttu-id="c8353-136">いいえ</span><span class="sxs-lookup"><span data-stu-id="c8353-136">No</span></span>|  
|<span data-ttu-id="c8353-137">&PageNumber</span><span class="sxs-lookup"><span data-stu-id="c8353-137">&PageNumber</span></span>|<span data-ttu-id="c8353-138">はい</span><span class="sxs-lookup"><span data-stu-id="c8353-138">Yes</span></span>|<span data-ttu-id="c8353-139">いいえ</span><span class="sxs-lookup"><span data-stu-id="c8353-139">No</span></span>|  
|<span data-ttu-id="c8353-140">&TotalPages</span><span class="sxs-lookup"><span data-stu-id="c8353-140">&TotalPages</span></span>|<span data-ttu-id="c8353-141">はい</span><span class="sxs-lookup"><span data-stu-id="c8353-141">Yes</span></span>|<span data-ttu-id="c8353-142">いいえ</span><span class="sxs-lookup"><span data-stu-id="c8353-142">No</span></span>|  
|<span data-ttu-id="c8353-143">集計関数</span><span class="sxs-lookup"><span data-stu-id="c8353-143">Aggregate function</span></span>|<span data-ttu-id="c8353-144">はい。</span><span class="sxs-lookup"><span data-stu-id="c8353-144">Yes.</span></span> <span data-ttu-id="c8353-145">たとえば、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="c8353-145">For example,</span></span><br /><br /> `=First(ReportItems!TXT_LastName.Value)`|<span data-ttu-id="c8353-146">はい。</span><span class="sxs-lookup"><span data-stu-id="c8353-146">Yes.</span></span> <span data-ttu-id="c8353-147">たとえば、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="c8353-147">For example,</span></span><br /><br /> `=Max(Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="c8353-148">ページ上のアイテムのフィールド コレクション</span><span class="sxs-lookup"><span data-stu-id="c8353-148">Fields collection for items on the page</span></span>|<span data-ttu-id="c8353-149">間接的。</span><span class="sxs-lookup"><span data-stu-id="c8353-149">Indirectly.</span></span> <span data-ttu-id="c8353-150">たとえば、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="c8353-150">For example,</span></span><br /><br /> `=Sum(ReportItems!Textbox1.Value)`|<span data-ttu-id="c8353-151">はい。</span><span class="sxs-lookup"><span data-stu-id="c8353-151">Yes.</span></span> <span data-ttu-id="c8353-152">たとえば、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="c8353-152">For example,</span></span><br /><br /> `=Sum(Fields!Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="c8353-153">データバインド画像</span><span class="sxs-lookup"><span data-stu-id="c8353-153">Data-bound image</span></span>|<span data-ttu-id="c8353-154">間接的。</span><span class="sxs-lookup"><span data-stu-id="c8353-154">Indirectly.</span></span> <span data-ttu-id="c8353-155">たとえば、`=ReportItems!TXT_Photo.Value` のように指定します。</span><span class="sxs-lookup"><span data-stu-id="c8353-155">For example, `=ReportItems!TXT_Photo.Value`</span></span>|<span data-ttu-id="c8353-156">はい。</span><span class="sxs-lookup"><span data-stu-id="c8353-156">Yes.</span></span> <span data-ttu-id="c8353-157">たとえば、次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="c8353-157">For example,</span></span><br /><br /> `=First(Fields!Photo.Value,"DataSet1")`|  
  
 <span data-ttu-id="c8353-158">このトピックの以下のセクションでは、ヘッダーおよびフッターで一般的に使用される変数データを取得するための、すぐに使用できる式を示します。</span><span class="sxs-lookup"><span data-stu-id="c8353-158">The following sections in this topic show ready-to-use expressions that get variable data commonly used in headers and footers.</span></span> <span data-ttu-id="c8353-159">また、Excel 表示拡張機能でヘッダーおよびフッターが処理される方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="c8353-159">There is also a section on how the Excel rendering extension processes headers and footers.</span></span> <span data-ttu-id="c8353-160">式の詳細については、「[式 &#40;レポート ビルダーおよび SSRS&#41;](expressions-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-160">For more information about expressions, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md).</span></span>  
  
### <a name="adding-calculated-page-totals-to-a-header-or-footer"></a><span data-ttu-id="c8353-161">ヘッダーまたはフッターへの計算された合計ページ数の追加</span><span class="sxs-lookup"><span data-stu-id="c8353-161">Adding Calculated Page Totals to a Header or Footer</span></span>  
 <span data-ttu-id="c8353-162">レポートの種類によっては、各レポートのヘッダーまたはフッターに計算値 (たとえば、ページに数値が含まれている場合はページごとの合計) を含めると便利です。</span><span class="sxs-lookup"><span data-stu-id="c8353-162">For some reports, it is useful to include a calculated value in the header or footer of each report; for example, a per-page sum total if the page includes numeric values.</span></span> <span data-ttu-id="c8353-163">フィールドを直接参照することはできないので、ヘッダーまたはフッターに配置する式は、次の例のように、データ フィールドではなく、レポート アイテム (たとえばテキスト ボックス) の名前を参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-163">Because you cannot reference the fields directly, the expression that you put in the header or footer must reference the name of the report item (for example, a text box) rather than the data field:</span></span>  
  
 `=Sum(ReportItems!Textbox1.Value)`  
  
 <span data-ttu-id="c8353-164">データ行の繰り返しを含むテーブルまたは一覧内にテキスト ボックスがある場合、実行時にヘッダーまたはフッターに表示される値は、現在のページのテーブルまたは一覧のすべての `TextBox1` インスタンス データのすべての値の合計になります。</span><span class="sxs-lookup"><span data-stu-id="c8353-164">If the text box is in a table or list that contains repeated rows of data, the value that appears in the header or footer at run time is a sum of all values of all `TextBox1` instance data in the table or list for the current page.</span></span>  
  
 <span data-ttu-id="c8353-165">ページ合計を計算する場合、異なる表示拡張機能を使用してレポートを表示すると、合計に相違が生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-165">When calculating page totals, you can expect to see differences in the totals when you use different rendering extensions to view the report.</span></span> <span data-ttu-id="c8353-166">ページ割り当てされた出力は、表示拡張機能の種類によって、異なった方法で計算されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-166">Paginated output is calculated differently for each rendering extension.</span></span> <span data-ttu-id="c8353-167">HTML で表示したページと同じページを PDF で表示した場合、PDF ページ上のデータ量が異なると、表示される合計も異なる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-167">The same page that you view in HTML might show different totals when viewed in PDF if the amount of data on the PDF page is different.</span></span> <span data-ttu-id="c8353-168">詳しくは、「[レンダリングの動作 &#40;レポート ビルダーおよび SSRS&#41;](rendering-behaviors-report-builder-and-ssrs.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c8353-168">For more information, see [Rendering Behaviors &#40;Report Builder  and SSRS&#41;](rendering-behaviors-report-builder-and-ssrs.md).</span></span>  
  
### <a name="for-reports-with-multiple-datasets"></a><span data-ttu-id="c8353-169">複数のデータ ソースがあるレポートの場合</span><span class="sxs-lookup"><span data-stu-id="c8353-169">For Reports with Multiple Datasets</span></span>  
 <span data-ttu-id="c8353-170">複数のデータセットがあるレポートの場合は、ヘッダーまたはフッターにフィールドやデータバインド画像を追加することはできません。</span><span class="sxs-lookup"><span data-stu-id="c8353-170">For reports with more than one dataset, you cannot add fields or data-bound images directly to a header or footer.</span></span> <span data-ttu-id="c8353-171">ただし、ヘッダーまたはフッターで使用するフィールドやデータバインド画像を間接的に参照する式を記述することはできます。</span><span class="sxs-lookup"><span data-stu-id="c8353-171">However, you can write an expression that indirectly references a field or data-bound image that you want to use in a header or footer.</span></span>  
  
 <span data-ttu-id="c8353-172">ヘッダーまたはフッターに変数データを配置するには</span><span class="sxs-lookup"><span data-stu-id="c8353-172">To put variable data in a header or footer:</span></span>  
  
-   <span data-ttu-id="c8353-173">ヘッダーまたはフッターにテキスト ボックスを追加します。</span><span class="sxs-lookup"><span data-stu-id="c8353-173">Add a text box to the header or footer.</span></span>  
  
-   <span data-ttu-id="c8353-174">テキスト ボックスに、表示する変数データを生成する式を記述します。</span><span class="sxs-lookup"><span data-stu-id="c8353-174">In the text box, write an expression that produces the variable data that you want to appear.</span></span>  
  
-   <span data-ttu-id="c8353-175">その式に、ページ上のレポート アイテムへの参照を含めます (たとえば、特定のフィールドのデータが格納されているテキスト ボックスを参照できます)。</span><span class="sxs-lookup"><span data-stu-id="c8353-175">In the expression, include references to report items on the page; for example, you can reference a text box that contains data from a particular field.</span></span> <span data-ttu-id="c8353-176">データセット内のフィールドへの直接参照を含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="c8353-176">Do not include a direct reference to fields in a dataset.</span></span> <span data-ttu-id="c8353-177">たとえば、式 `[LastName]`は使用できません。</span><span class="sxs-lookup"><span data-stu-id="c8353-177">For example, you cannot use the expression `[LastName]`.</span></span> <span data-ttu-id="c8353-178">`TXT_LastName`テキスト ボックスの最初のインスタンスの内容を表示するには、次の式を使用します。</span><span class="sxs-lookup"><span data-stu-id="c8353-178">You can use the following expression to display the contents of the first instance of a text box named `TXT_LastName`:</span></span>  
  
     `=First(ReportItems!TXT_LastName.Value)`  
  
 <span data-ttu-id="c8353-179">ページ ヘッダーまたはページ フッターのフィールドには集計関数を使用できません。</span><span class="sxs-lookup"><span data-stu-id="c8353-179">You cannot use aggregate functions on fields in the page header or footer.</span></span> <span data-ttu-id="c8353-180">集計関数はレポート本文のレポート アイテムにのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="c8353-180">You can only use an aggregate function on report items in the report body.</span></span> <span data-ttu-id="c8353-181">ページ ヘッダーとページ フッターの一般的な式については、「[式の例 (レポート ビルダーおよび SSRS)](expression-examples-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-181">For common expressions in page headers and footers, see [Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md).</span></span>  
  
#### <a name="adding-a-data-bound-image-to-a-header-or-footer"></a><span data-ttu-id="c8353-182">ヘッダーまたはフッターへのデータバインド画像の追加</span><span class="sxs-lookup"><span data-stu-id="c8353-182">Adding a Data-Bound Image to a Header or Footer</span></span>  
 <span data-ttu-id="c8353-183">ヘッダーまたはフッターで、データベースに格納された画像データを使用できます。</span><span class="sxs-lookup"><span data-stu-id="c8353-183">You can use image data stored in a database in a header or footer.</span></span> <span data-ttu-id="c8353-184">ただし、画像レポート アイテムからデータベース フィールドを直接参照することはできません。</span><span class="sxs-lookup"><span data-stu-id="c8353-184">However, you cannot reference database fields from the Image report item directly.</span></span> <span data-ttu-id="c8353-185">代わりに、レポートの本文にテキスト ボックスを追加し、そのテキスト ボックスを画像が格納されているデータ フィールドに設定します (値は base64 でエンコードされている必要があります)。</span><span class="sxs-lookup"><span data-stu-id="c8353-185">Instead, you must add a text box in the body of the report and then set the text box to the data field that contains the image (note that the value must be base64 encoded).</span></span> <span data-ttu-id="c8353-186">base64 でエンコードされた画像が表示されないように、レポートの本文でテキスト ボックスを非表示にできます。</span><span class="sxs-lookup"><span data-stu-id="c8353-186">You can hide the text box in the body of the report to avoid showing the base64-encoded image.</span></span> <span data-ttu-id="c8353-187">次に、ページ ヘッダーまたはページ フッターの画像レポート アイテムから、非表示のテキスト ボックスの値を参照します。</span><span class="sxs-lookup"><span data-stu-id="c8353-187">Then, you can reference the value of the hidden text box from the Image report item in the page header or footer.</span></span>  
  
 <span data-ttu-id="c8353-188">たとえば、製品情報のページから成るレポートがあるとします。</span><span class="sxs-lookup"><span data-stu-id="c8353-188">For example, suppose you have a report that consists of product information pages.</span></span> <span data-ttu-id="c8353-189">各ページのヘッダーには、製品の写真を表示します。</span><span class="sxs-lookup"><span data-stu-id="c8353-189">In the header of each page, you want to display a photograph of the product.</span></span> <span data-ttu-id="c8353-190">保存されている画像をレポート ヘッダーに出力するには、データベースから画像を取得する `TXT_Photo` という非表示のテキスト ボックスをレポートの本文に定義し、次の式を使用してそのボックスに値を渡します。</span><span class="sxs-lookup"><span data-stu-id="c8353-190">To print a stored image in the report header, define a hidden text box named `TXT_Photo` in the body of the report that retrieves the image from the database and use an expression to give it a value:</span></span>  
  
 `=Convert.ToBase64String(Fields!Photo.Value)`  
  
 <span data-ttu-id="c8353-191">ヘッダーで、 `TXT_Photo` テキスト ボックスを使用する画像レポート アイテムを追加し、デコードして画像を表示します。</span><span class="sxs-lookup"><span data-stu-id="c8353-191">In the header, add an Image report item which uses the `TXT_Photo` text box, decoded to show the image:</span></span>  
  
 `=Convert.FromBase64String(ReportItems!TXT_Photo.Value)`  
  
## <a name="using-headers-and-footers-to-position-text"></a><span data-ttu-id="c8353-192">ヘッダーおよびフッターを使用したテキストの配置</span><span class="sxs-lookup"><span data-stu-id="c8353-192">Using Headers and Footers to Position Text</span></span>  
 <span data-ttu-id="c8353-193">ヘッダーおよびフッターを使用して、ページ上にテキストを配置できます。</span><span class="sxs-lookup"><span data-stu-id="c8353-193">You can use headers and footers to position text on a page.</span></span> <span data-ttu-id="c8353-194">たとえば、顧客に郵送するレポートを作成しているとします。</span><span class="sxs-lookup"><span data-stu-id="c8353-194">For example, suppose you are creating a report that you want to mail out to customers.</span></span> <span data-ttu-id="c8353-195">顧客の住所をヘッダーまたはフッターを使用して配置することで、レポートを折りたたんだ時に、その住所が封筒の窓から見えるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="c8353-195">You can use a header or footer to position the customer address so that it appears in an envelope window when folded.</span></span>  
  
 <span data-ttu-id="c8353-196">テキスト ボックスを使用してヘッダーまたはフッターのみに値を設定する場合は、レポートの本文でそのテキスト ボックスを非表示にすることができます。</span><span class="sxs-lookup"><span data-stu-id="c8353-196">If you are only using the text box to populate a header or footer, you can hide the text box in the report body.</span></span> <span data-ttu-id="c8353-197">レポートの本文にテキスト ボックスを配置すると、ヘッダーやフッターに表示する値が、レポートの最初と最後のどちらのページに表示されるかに影響する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-197">Placement of the text box in the report body can have an effect on whether the value appears on the header or footer of the first or last page of a report.</span></span> <span data-ttu-id="c8353-198">たとえば、レポートが 1 ページに収まらないテーブル、マトリックス、一覧がある場合、非表示のテキスト ボックスの値は最後のページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-198">For example, if you have tables, matrices, or lists that cause the report to span multiple pages, the hidden text box value appears on the last page.</span></span> <span data-ttu-id="c8353-199">これを最初のページに表示する必要がある場合は、非表示のテキスト ボックスをレポート本文の先頭に配置します。</span><span class="sxs-lookup"><span data-stu-id="c8353-199">If you want it to appear on the first page, place the hidden text box at the top of the report body.</span></span>  
  
## <a name="designing-reports-with-page-headers-and-footers-for-specific-renderers"></a><span data-ttu-id="c8353-200">特定のレンダラー用のページ ヘッダーおよびページ フッターを使用したレポートのデザイン</span><span class="sxs-lookup"><span data-stu-id="c8353-200">Designing Reports with Page Headers and Footers for Specific Renderers</span></span>  
 <span data-ttu-id="c8353-201">レポートが処理されると、データとレイアウトの情報は結合されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-201">When a report is processed, data and layout information are combined.</span></span> <span data-ttu-id="c8353-202">レポートを表示すると、結合された情報がレンダラーに渡され、各レポート ページに収まるレポート データの量が決まります。</span><span class="sxs-lookup"><span data-stu-id="c8353-202">When you view a report, the combined information is passed to a renderer that determines how much report data fits on each report page.</span></span>  
  
 <span data-ttu-id="c8353-203">ブラウザーを使用してレポート サーバーでレポートを表示する場合は、表示されるレポート ページの内容を HTML レンダラーがコントロールします。</span><span class="sxs-lookup"><span data-stu-id="c8353-203">If you view a report on the report server using a browser, the HTML renderer controls the content on the report pages that you see.</span></span> <span data-ttu-id="c8353-204">表示に使用する形式とは異なる形式でレポートを配信する場合や、特定の形式でレポートを印刷する場合は、最終的なレポート形式に使用するレンダラーに合わせてレポート レイアウトを最適化することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="c8353-204">If you plan to deliver reports in a different format than you use for viewing, or if you plan to print reports in a specific format, you may want to optimize the report layout for the renderer you plan to use for the final report format.</span></span> <span data-ttu-id="c8353-205">レポートの改ページの詳細については、「[Reporting Services の改ページ (レポート ビルダーおよび SSRS)](pagination-in-reporting-services-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-205">For more information about report pagination, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
### <a name="working-with-page-headers-and-footers-in-excel"></a><span data-ttu-id="c8353-206">Excel でのページ ヘッダーおよびページ フッターの使用</span><span class="sxs-lookup"><span data-stu-id="c8353-206">Working with Page Headers and Footers in Excel</span></span>  
 <span data-ttu-id="c8353-207">Excel の表示拡張機能を対象とするレポートにページ ヘッダーおよびページ フッターを定義する場合は、次のガイドラインに従うことで、最も良い結果を得ることができます。</span><span class="sxs-lookup"><span data-stu-id="c8353-207">When defining page headers and footers for reports that target the Excel rendering extension, follow these guidelines to achieve best results:</span></span>  
  
-   <span data-ttu-id="c8353-208">ページ フッターは、ページ番号を表示するために使用します。</span><span class="sxs-lookup"><span data-stu-id="c8353-208">Use page footers to display page numbers.</span></span>  
  
-   <span data-ttu-id="c8353-209">ページ ヘッダーは、画像、タイトル、またはその他のテキストを表示するために使用します。</span><span class="sxs-lookup"><span data-stu-id="c8353-209">Use page headers to display images, titles, or other text.</span></span> <span data-ttu-id="c8353-210">ヘッダーには、ページ番号を配置しないようにします。</span><span class="sxs-lookup"><span data-stu-id="c8353-210">Do not put page numbers in the header.</span></span>  
  
 <span data-ttu-id="c8353-211">Excel では、ページ フッターのレイアウトに制限があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-211">In Excel, page footers have a limited layout.</span></span> <span data-ttu-id="c8353-212">ページ フッターに複雑なレポート アイテムを含むレポートを定義した場合、そのレポートを Excel で表示すると、ページ フッターの処理は期待どおりには行われません。</span><span class="sxs-lookup"><span data-stu-id="c8353-212">If you define a report that includes complex report items in the page footer, the page footer won't process as you expect when the report is viewed in Excel.</span></span>  
  
 <span data-ttu-id="c8353-213">Excel の表示拡張機能は、ページ ヘッダー内の画像、および単純または複雑なレポート アイテムの絶対位置に対応しています。</span><span class="sxs-lookup"><span data-stu-id="c8353-213">The Excel rendering extension can accommodate images and absolute positioning of simple or complex report items in the page header.</span></span> <span data-ttu-id="c8353-214">よりリッチなページ ヘッダー レイアウトをサポートする副作用として、ヘッダーでのページ番号の計算に制限が生じます。</span><span class="sxs-lookup"><span data-stu-id="c8353-214">A side effect of supporting a richer page header layout is reduced support for calculating page numbers in the header.</span></span> <span data-ttu-id="c8353-215">Excel の表示拡張機能では、既定の設定で、ページ番号がワークシートの数に基づいて計算されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-215">In the Excel rendering extension, default settings cause page numbers to be calculated based on the number of worksheets.</span></span> <span data-ttu-id="c8353-216">レポートの定義の仕方によっては、ページ番号に誤りが生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-216">Depending on how you define the report, this might produce erroneous page numbers.</span></span> <span data-ttu-id="c8353-217">たとえば、印刷すると 4 ページになる単一の大きなワークシートとして表示されるレポートがあるとします。</span><span class="sxs-lookup"><span data-stu-id="c8353-217">For example, suppose you have a report that renders as a single large worksheet that prints on four pages.</span></span> <span data-ttu-id="c8353-218">ヘッダーにページ番号情報を含めると、印刷された各ページのヘッダーには、"Page 1 of 1" と表示されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-218">If you include page number information in the header, each printed page will show "Page 1 of 1" in the header.</span></span>  
  
 <span data-ttu-id="c8353-219">より正確なページ数は、印刷されたページの寸法に相関する論理ページに基づいて計算されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-219">A more accurate page count is based on logical pages that correlate to the dimensions of a printed page.</span></span> <span data-ttu-id="c8353-220">Excel のページ フッターでは、論理ページ番号が自動的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8353-220">In Excel, the page footer uses logical page numbers automatically.</span></span> <span data-ttu-id="c8353-221">ページ ヘッダーに論理ページ数を配置するには、単純なヘッダーを使用するようにデバイス情報設定を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8353-221">To put the logical page count in the page header, you must configure the device information settings to use simple headers.</span></span> <span data-ttu-id="c8353-222">単純なヘッダーを使用する場合は、ヘッダー領域で複雑なレポート レイアウトを処理する機能を削除してください。</span><span class="sxs-lookup"><span data-stu-id="c8353-222">Be aware that when you use simple headers, you remove the capability of handling complex report layout in the header region.</span></span>  
  
 <span data-ttu-id="c8353-223">詳細については、「 [Microsoft Excel へのエクスポート &#40;レポート ビルダーおよび SSRS&#41;](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md)で操作できます。</span><span class="sxs-lookup"><span data-stu-id="c8353-223">For more information, see [Exporting to Microsoft Excel &#40;Report Builder and SSRS&#41;](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8353-224">参照</span><span class="sxs-lookup"><span data-stu-id="c8353-224">See Also</span></span>  
 <span data-ttu-id="c8353-225">[レポートへの画像の埋め込み &#40;レポート ビルダーおよび SSRS&#41;](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="c8353-225">[Embed an Image in a Report &#40;Report Builder and SSRS&#41;](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="c8353-226">四角形と線 &#40;レポート ビルダーおよび SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="c8353-226">Rectangles and Lines &#40;Report Builder and SSRS&#41;</span></span>](rectangles-and-lines-report-builder-and-ssrs.md)  
  
  
