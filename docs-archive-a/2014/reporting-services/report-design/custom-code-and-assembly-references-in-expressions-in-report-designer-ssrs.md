---
title: レポート デザイナーでカスタム コードやアセンブリを式から参照する (SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721218"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="9edaa-102">レポート デザイナーでカスタム コードやアセンブリを式から参照する (SSRS)</span><span class="sxs-lookup"><span data-stu-id="9edaa-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="9edaa-103">レポート内に埋め込まれたカスタム コードや、ビルドして自分のコンピューターに保存 (またはレポート サーバーに配置) したカスタム アセンブリは、レポート内から参照することができます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="9edaa-104">カスタム定数、複雑な関数、または 1 レポート内で何度も使用される関数には、埋め込みコードを使用します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="9edaa-105">コードを 1 か所で管理し、そのコードを複数のレポートで共有する場合は、カスタム コード アセンブリを使用します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="9edaa-106">カスタム コードには、新しいカスタム定数、変数、関数、またはサブルーチンを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="9edaa-107">Parameters コレクションなど、組み込みコレクションへの読み取り専用の参照を含めることが可能です。</span><span class="sxs-lookup"><span data-stu-id="9edaa-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="9edaa-108">ただし、レポート データ値セットをカスタム関数に渡すことはできません。特に、カスタム集計はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9edaa-109">実行時にいったん評価し、レポート処理全体で同じ値を保持しておく必要のある、タイミングに依存するような計算の場合は、レポート変数とグループ変数のどちらを使用するかを検討してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="9edaa-110">詳細については、「[レポート変数コレクションとグループ変数コレクションの参照 (レポート ビルダーおよび SSRS)](built-in-collections-report-and-group-variables-references-report-builder.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="9edaa-111">カスタム コードをレポートに追加するための作成環境としては、レポート デザイナーの使用をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="9edaa-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="9edaa-112">レポート ビルダーでサポートされるのは、有効な式を含んだレポートの処理、またはレポート サーバー上のカスタム アセンブリへの参照を含んだレポートの処理です。</span><span class="sxs-lookup"><span data-stu-id="9edaa-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="9edaa-113">カスタム アセンブリへの参照を追加する手段は、レポート ビルダーには用意されていません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9edaa-114">カスタム アセンブリに依存しているレポートについては、レポート サーバーのアップグレード時に注意が必要です。アップグレードを完了するまでに、追加の手順が必要となる場合があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="9edaa-115">詳細については、「 [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a> <span data-ttu-id="9edaa-116">レポート ビルダーでのカスタム コードの使用</span><span class="sxs-lookup"><span data-stu-id="9edaa-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="9edaa-117">レポート ビルダーでは、カスタム アセンブリを参照するレポートをレポート サーバーから取得して開くことができます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="9edaa-118">たとえば、 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]のレポート デザイナーを使用して作成、配置されたレポートを編集することができます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="9edaa-119">カスタム アセンブリは、レポート サーバーに配置されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="9edaa-120">次の操作は実行できません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="9edaa-121">参照またはクラス メンバーのインスタンスをレポートに追加する。</span><span class="sxs-lookup"><span data-stu-id="9edaa-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="9edaa-122">カスタム アセンブリへの参照を含んだレポートをローカル モードでプレビューする。</span><span class="sxs-lookup"><span data-stu-id="9edaa-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="9edaa-123">一般的に使用される関数への参照を含める</span><span class="sxs-lookup"><span data-stu-id="9edaa-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="9edaa-124">**[式]** ダイアログ ボックスを使用すると、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]に組み込まれている共通の関数の一覧がカテゴリ別に表示されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="9edaa-125">**[共通の関数]** を展開してカテゴリをクリックすると、式に含める関数の一覧が **[アイテム]** ペインに表示されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="9edaa-126">共通の関数には、名前空間および名前空間のクラス、および [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> <xref:System.Convert> [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] ランタイムライブラリ関数が含まれます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="9edaa-127">便宜上、最もよく使用される関数が **[式]** ダイアログ ボックスで表示されます。このダイアログ ボックスでは、これらの関数は、テキスト、日付と時刻、数学、検査、プログラム フロー、集計、財務、変換、その他というカテゴリごとに表示されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="9edaa-128">使用頻度の低い関数は、一覧に表示されませんが、式で使用することはできます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="9edaa-129">組み込み関数を使用するには、[アイテム] ペインで関数名をダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="9edaa-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="9edaa-130">関数の説明が説明ペインに表示され、関数呼び出しの例がサンプル ペインに表示されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="9edaa-131">コードペインで、関数名の後に左かっこ **(** を入力すると、IntelliSense のヘルプに関数呼び出しの有効な各構文が表示されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="9edaa-132">たとえば、テーブルの `Quantity` という名前のフィールドの最大値を計算するには、 `=Max(` という単純な式をコード ペインに追加した後、スマート タグを使用して、関数呼び出しに使用できる有効な構文をすべて表示します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="9edaa-133">この例を完成させるには、「 `=Max(Fields!Quantity.Value)`」と入力します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="9edaa-134">各関数の詳細については、MSDN の「 <xref:System.Math>」、「 <xref:System.Convert>」、および「 [Visual Basic ランタイム ライブラリのメンバー](https://go.microsoft.com/fwlink/?LinkId=198941) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a><span data-ttu-id="9edaa-135">使用頻度の低い関数への参照の追加</span><span class="sxs-lookup"><span data-stu-id="9edaa-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="9edaa-136">使用頻度の低い、その他の CLR 名前空間への参照を含めるには、 <xref:System.Text.StringBuilder>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="9edaa-137">このような使用頻度の低い関数については、 **[式]** ダイアログ ボックスのコード ペインで IntelliSense がサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="9edaa-138">各関数の詳細については、MSDN の「 [Visual Basic ランタイム ライブラリのメンバー](https://go.microsoft.com/fwlink/?LinkId=198941) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a><span data-ttu-id="9edaa-139">外部アセンブリへの参照を含める</span><span class="sxs-lookup"><span data-stu-id="9edaa-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="9edaa-140">外部アセンブリ内のクラスへの参照を含めるには、レポート プロセッサのアセンブリを特定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="9edaa-141">レポートに追加するアセンブリの完全修飾名を指定するには、 **[レポートのプロパティ]** ダイアログ ボックスの **[参照]** ページを使用します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="9edaa-142">式では、アセンブリ内のクラスの完全修飾名を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="9edaa-143">外部アセンブリ内のクラスは、 **[式]** ダイアログ ボックスに表示されません。そのため、クラスの正しい名前を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="9edaa-144">完全修飾名には、名前空間、クラス名、およびメンバー名が含まれます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a><span data-ttu-id="9edaa-145">埋め込みコードを含める</span><span class="sxs-lookup"><span data-stu-id="9edaa-145">Including Embedded Code</span></span>  
 <span data-ttu-id="9edaa-146">埋め込みコードをレポートに追加するには、 **[レポートのプロパティ]** ダイアログ ボックスの [コード] タブを使用します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="9edaa-147">作成したコード ブロックでは、複数のメソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="9edaa-148">埋め込みコード内のメソッドは、で記述する必要があり [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 、インスタンスベースである必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="9edaa-149">レポート プロセッサは、System.Convert 名前空間および System.Math 名前空間の参照を自動的に追加します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="9edaa-150">他のアセンブリ参照を追加するには、 **[レポートのプロパティ]** ダイアログ ボックスの **[参照]** ページを使用します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="9edaa-151">詳細については、「 [レポートにアセンブリへの参照を追加する &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="9edaa-152">埋め込みコード内のメソッドは、グローバルに定義されている `Code` メンバーを介して利用できます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="9edaa-153">`Code` メンバーとメソッド名を参照することで、これらのメソッドにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="9edaa-154">次の例では、`ToUSD` メソッドを呼び出します。これにより、`StandardCost` フィールドの値が米ドル単位に変換されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="9edaa-155">カスタム コード内で組み込みコレクションを参照するには、組み込みの `Report` オブジェクトへの参照を含めます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="9edaa-156">次の例は、いくつかのカスタム定数と変数を定義する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="9edaa-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="9edaa-157">**[式]** ダイアログ ボックスの **[定数]** カテゴリにはカスタム定数が表示されませんが (組み込み定数のみが表示されます)、次の例に示すように、任意の式からカスタム定数への参照を追加できます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="9edaa-158">式の中では、カスタム定数が `Variant` として扱われます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="9edaa-159">次の例には、関数 `FixSpelling` のコード参照およびコード実装の両方が含まれています。これにより、`"Bicycle"` フィールド内の "Bike" というテキストがすべて `SubCategory` に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="9edaa-160">レポート定義コード ブロックに埋め込んで使用する次のコードは、`FixSpelling` メソッドの実装を示しています。</span><span class="sxs-lookup"><span data-stu-id="9edaa-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="9edaa-161">この例では、クラスへの完全修飾参照を使用する方法を示し [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` ます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="9edaa-162">組み込みのオブジェクト コレクションと初期化の詳細については、「[組み込み Globals および Users 参照 &#40;レポート ビルダーおよび SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md)」および「[カスタム アセンブリ オブジェクトの初期化](../custom-assemblies/initializing-custom-assembly-objects.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a><span data-ttu-id="9edaa-163">コードからパラメーターへの参照を含める</span><span class="sxs-lookup"><span data-stu-id="9edaa-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="9edaa-164">レポート定義のコード ブロックまたはユーザーが指定したカスタム アセンブリのカスタム コードを経由してグローバル パラメーター コレクションを参照できます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="9edaa-165">パラメーター コレクションは読み取り専用で、パブリック反復子がありません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="9edaa-166">コンストラクトを使用し [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] てコレクションをステップ実行することはできません `For Each` 。</span><span class="sxs-lookup"><span data-stu-id="9edaa-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="9edaa-167">レポート定義内で定義されたパラメーターの名前をコード内で参照する前に、その名前を確認しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="9edaa-168">ただし、複数の値を持つパラメーターのすべての値は、繰り返し処理することができます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="9edaa-169">次の表には、カスタム コードから組み込みコレクション `Parameters` を参照する例を示しています。</span><span class="sxs-lookup"><span data-stu-id="9edaa-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="9edaa-170">説明</span><span class="sxs-lookup"><span data-stu-id="9edaa-170">Description</span></span>|<span data-ttu-id="9edaa-171">式での参照</span><span class="sxs-lookup"><span data-stu-id="9edaa-171">Reference in Expression</span></span>|<span data-ttu-id="9edaa-172">カスタム コード定義</span><span class="sxs-lookup"><span data-stu-id="9edaa-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="9edaa-173">グローバル パラメーター コレクション全体をカスタム コードに渡します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="9edaa-174">この関数は、特定のレポート パラメーター *MyParameter*の値を返します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="9edaa-175">個別のパラメーターをカスタム コードに渡します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="9edaa-176">この例では、渡されたパラメーターの値が返されます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="9edaa-177">パラメーターが複数の値を持つパラメーターである場合、返される文字列はすべての値の連結になります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a><span data-ttu-id="9edaa-178">カスタムアセンブリからコードへの参照を含める</span><span class="sxs-lookup"><span data-stu-id="9edaa-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="9edaa-179">レポートでカスタム アセンブリを使用するには、まずアセンブリを作成して、これをレポート デザイナーが利用できるようにし、アセンブリへの参照をレポートに追加してから、レポート内の式を使用してこのアセンブリ内のメソッドを参照します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="9edaa-180">レポートがレポート サーバーに配置される場合は、カスタム アセンブリもレポート サーバーに配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="9edaa-181">カスタム アセンブリを作成して [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]で利用できるようにする方法については、「 [レポートでのカスタム アセンブリの使用](../custom-assemblies/using-custom-assemblies-with-reports.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="9edaa-182">式の中でカスタム コードを参照するには、アセンブリ内のクラスのメンバーを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="9edaa-183">呼び出す方法は、メソッドが静的であるかインスタンス ベースであるかにより異なります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="9edaa-184">カスタム アセンブリ内の静的メソッドは、レポート内でグローバルに利用できます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="9edaa-185">静的メソッドには、名前空間、クラス、メソッド名を指定することによって、式からアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="9edaa-186">次の例では、メソッドを呼び出します。このメソッドは、 `ToGBP` **standardcost**の値をドルからポンドに変換します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="9edaa-187">インスタンスベースのメソッドは、グローバルに定義されている `Code` メンバーを介して利用できます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="9edaa-188">まず `Code` メンバーを参照し、続いてインスタンスとメソッド名を参照することで、これらのメソッドにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="9edaa-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="9edaa-189">次の例では、インスタンスメソッドを呼び出します。このメソッドは、 `ToEUR` **standardcost**の値をドルからユーロに変換します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="9edaa-190">レポート デザイナーでは、カスタム アセンブリが一度読み込まれると、 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]を終了するまでアンロードされません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="9edaa-191">レポートをプレビューして、レポートで使用するカスタム アセンブリに変更を加え、その後再びレポートをプレビューした場合、2 回目のプレビューでは行った変更が表示されません。</span><span class="sxs-lookup"><span data-stu-id="9edaa-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="9edaa-192">アセンブリを再度読み込むには、 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] を終了してから再起動し、レポートをプレビューします。</span><span class="sxs-lookup"><span data-stu-id="9edaa-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="9edaa-193">コードへのアクセスの詳細については、「 [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a><span data-ttu-id="9edaa-194">組み込みコレクションをカスタムアセンブリに渡す</span><span class="sxs-lookup"><span data-stu-id="9edaa-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="9edaa-195">組み込みコレクション ( *Globals* コレクションや *Parameters* コレクションなど) をカスタム アセンブリ内に渡して処理する場合は、コード プロジェクト内のアセンブリ参照を組み込みコレクションを定義するアセンブリに追加し、正しい名前空間にアクセスする必要があります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="9edaa-196">開発しているカスタム アセンブリが、レポート サーバー上で実行されるレポート (サーバー レポート) 用のものなのか、それとも .NET アプリケーション内でローカルに実行されるレポート (ローカル レポート) 用のものなのかによって、参照する必要があるアセンブリは異なります。</span><span class="sxs-lookup"><span data-stu-id="9edaa-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="9edaa-197">詳細については、以下をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="9edaa-197">See below for details.</span></span>  
  
-   <span data-ttu-id="9edaa-198">**名前空間:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="9edaa-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="9edaa-199">**アセンブリ (ローカル レポート):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="9edaa-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="9edaa-200">**アセンブリ (サーバー レポート):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="9edaa-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="9edaa-201">*Fields* コレクションおよび *ReportItems* コレクションの内容は実行時に動的に変更されるので、カスタム アセンブリ内への呼び出し間でそれらを保持することは避けてください (たとえば、メンバー変数内など)。</span><span class="sxs-lookup"><span data-stu-id="9edaa-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="9edaa-202">この推奨事項は、すべての組み込みコレクションについて共通に該当します。</span><span class="sxs-lookup"><span data-stu-id="9edaa-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9edaa-203">参照</span><span class="sxs-lookup"><span data-stu-id="9edaa-203">See Also</span></span>  
 <span data-ttu-id="9edaa-204">[SSRS&#41;&#40;レポートにコードを追加する](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9edaa-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="9edaa-205">[レポートでのカスタムアセンブリの使用](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="9edaa-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="9edaa-206">[SSRS&#41;レポートにアセンブリ参照を追加する &#40;](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9edaa-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="9edaa-207">[SSRS&#41;&#40;チュートリアル Reporting Services](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9edaa-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="9edaa-208">[式の例 (レポート ビルダーおよび SSRS)](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9edaa-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="9edaa-209">レポート サンプル (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="9edaa-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  
