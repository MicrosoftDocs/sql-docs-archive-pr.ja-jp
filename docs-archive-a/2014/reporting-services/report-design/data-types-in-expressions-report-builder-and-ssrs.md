---
title: 式で使用されるデータ型 (レポート ビルダーおよび SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721188"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="881b1-102">式で使用されるデータ型 (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="881b1-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="881b1-103">データを効率よく格納し、処理できるように、さまざまなデータの種類を表すデータ型が用意されています。</span><span class="sxs-lookup"><span data-stu-id="881b1-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="881b1-104">代表的なデータ型としては、テキスト (文字列) 型、数値型 (小数点以下桁数を含む)、数値型 (小数点以下桁数を含まない)、日付/時刻型、イメージ型などがあります。</span><span class="sxs-lookup"><span data-stu-id="881b1-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="881b1-105">レポート内の値は、レポート定義言語 (RDL) データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="881b1-106">値は、レポートに表示する場合に目的に応じて書式設定できます。</span><span class="sxs-lookup"><span data-stu-id="881b1-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="881b1-107">たとえば、通貨を表すフィールドの場合、データを浮動小数点数としてレポート定義に格納しておき、実際には、指定した書式設定プロパティに従ってさまざまな形式で表示することができます。</span><span class="sxs-lookup"><span data-stu-id="881b1-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="881b1-108">表示形式の詳細については、「 [レポート アイテムの書式設定 &#40;レポート ビルダーおよび SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="881b1-109">レポート定義言語 (RDL) データ型と共通言語ランタイム (CLR) データ型</span><span class="sxs-lookup"><span data-stu-id="881b1-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="881b1-110">RDL ファイルで指定した値は、RDL データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="881b1-111">レポートをコンパイルして処理すると、RDL データ型は CLR データ型に変換されます。</span><span class="sxs-lookup"><span data-stu-id="881b1-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="881b1-112">次の表は、既定として指定された変換を示しています。</span><span class="sxs-lookup"><span data-stu-id="881b1-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="881b1-113">RDL 型</span><span class="sxs-lookup"><span data-stu-id="881b1-113">RDL Type</span></span>|<span data-ttu-id="881b1-114">CLR 型</span><span class="sxs-lookup"><span data-stu-id="881b1-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="881b1-115">String</span><span class="sxs-lookup"><span data-stu-id="881b1-115">String</span></span>|<span data-ttu-id="881b1-116">既定値: String</span><span class="sxs-lookup"><span data-stu-id="881b1-116">Default: String</span></span><br /><br /> <span data-ttu-id="881b1-117">Chart、GUID、Timespan</span><span class="sxs-lookup"><span data-stu-id="881b1-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="881b1-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="881b1-118">Boolean</span></span>|<span data-ttu-id="881b1-119">既定値: Boolean</span><span class="sxs-lookup"><span data-stu-id="881b1-119">Default: Boolean</span></span>|  
|<span data-ttu-id="881b1-120">整数</span><span class="sxs-lookup"><span data-stu-id="881b1-120">Integer</span></span>|<span data-ttu-id="881b1-121">既定値: Int64</span><span class="sxs-lookup"><span data-stu-id="881b1-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="881b1-122">Int16、Int32、Uint16、Uint64、Byte、Sbyte</span><span class="sxs-lookup"><span data-stu-id="881b1-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="881b1-123">DateTime</span><span class="sxs-lookup"><span data-stu-id="881b1-123">DateTime</span></span>|<span data-ttu-id="881b1-124">既定値: DateTime</span><span class="sxs-lookup"><span data-stu-id="881b1-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="881b1-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="881b1-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="881b1-126">Float</span><span class="sxs-lookup"><span data-stu-id="881b1-126">Float</span></span>|<span data-ttu-id="881b1-127">既定値: Double</span><span class="sxs-lookup"><span data-stu-id="881b1-127">Default: Double</span></span><br /><br /> <span data-ttu-id="881b1-128">Single、Decimal</span><span class="sxs-lookup"><span data-stu-id="881b1-128">Single, Decimal</span></span>|  
|<span data-ttu-id="881b1-129">Binary</span><span class="sxs-lookup"><span data-stu-id="881b1-129">Binary</span></span>|<span data-ttu-id="881b1-130">既定値: Byte[]</span><span class="sxs-lookup"><span data-stu-id="881b1-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="881b1-131">Variant</span><span class="sxs-lookup"><span data-stu-id="881b1-131">Variant</span></span>|<span data-ttu-id="881b1-132">Byte[] 以外の上記すべて</span><span class="sxs-lookup"><span data-stu-id="881b1-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="881b1-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="881b1-133">VariantArray</span></span>|<span data-ttu-id="881b1-134">Variant の配列</span><span class="sxs-lookup"><span data-stu-id="881b1-134">Array of Variant</span></span>|  
|<span data-ttu-id="881b1-135">シリアル化可能</span><span class="sxs-lookup"><span data-stu-id="881b1-135">Serializable</span></span>|<span data-ttu-id="881b1-136">Serializable に指定されている、または ISerializable を実装する Variant または型</span><span class="sxs-lookup"><span data-stu-id="881b1-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="881b1-137">データ型と式の作成について</span><span class="sxs-lookup"><span data-stu-id="881b1-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="881b1-138">グループ式、フィルター式、集計計算など、値を比較したり結合したりする式を作成する際は、データ型について十分に理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="881b1-139">比較と計算は、同じデータ型のアイテム間でしか行えません。</span><span class="sxs-lookup"><span data-stu-id="881b1-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="881b1-140">データ型が異なる場合は、式を使用して、レポート アイテムのデータ型を明示的に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="881b1-141">データ型の変換が必要になるケースとしては、次のような場合が考えられます。</span><span class="sxs-lookup"><span data-stu-id="881b1-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="881b1-142">レポート パラメーターの値を別のデータ型のデータセット フィールドと比較する。</span><span class="sxs-lookup"><span data-stu-id="881b1-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="881b1-143">データ型が異なる複数の値を比較するフィルター式を作成する。</span><span class="sxs-lookup"><span data-stu-id="881b1-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="881b1-144">データ型が異なる複数のフィールドを結合する並べ替え式を作成する。</span><span class="sxs-lookup"><span data-stu-id="881b1-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="881b1-145">データ型が異なる複数のフィールドを結合するグループ式を作成する。</span><span class="sxs-lookup"><span data-stu-id="881b1-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="881b1-146">データ ソースから取得した値を別のデータ型に変換する。</span><span class="sxs-lookup"><span data-stu-id="881b1-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="881b1-147">レポート データのデータ型を調べる</span><span class="sxs-lookup"><span data-stu-id="881b1-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="881b1-148">レポート アイテムのデータ型を調べるには、そのアイテムのデータ型を返す式を作成します。</span><span class="sxs-lookup"><span data-stu-id="881b1-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="881b1-149">たとえば、 `MyField`というフィールドのデータ型を確認するには、テーブルのセルに `=Fields!MyField.Value.GetType().ToString()`という式を追加します。</span><span class="sxs-lookup"><span data-stu-id="881b1-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="881b1-150">式の結果には、`MyField` に使用されている CLR データ型 (`System.String` や `System.DateTime` など) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="881b1-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="881b1-151">データセット フィールドを異なるデータ型に変換する</span><span class="sxs-lookup"><span data-stu-id="881b1-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="881b1-152">レポートで使用するデータセット フィールドを事前に変換することもできます。</span><span class="sxs-lookup"><span data-stu-id="881b1-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="881b1-153">既存のデータセット フィールドを変換するには、次のような方法があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="881b1-154">データセット クエリを修正して、変換済みのデータを使った新しいクエリ フィールドを追加する。</span><span class="sxs-lookup"><span data-stu-id="881b1-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="881b1-155">リレーショナル データ ソースや多次元データ ソースの場合は、データ ソース リソースを使用して変換を行います。</span><span class="sxs-lookup"><span data-stu-id="881b1-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="881b1-156">既存のレポート データセット フィールドに基づく計算フィールドを作成する。それには、結果セット列のすべてのデータを異なるデータ型の新しい列に変換する式を作成します。</span><span class="sxs-lookup"><span data-stu-id="881b1-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="881b1-157">たとえば、Year フィールドを整数値から文字列値に変換するには、 `=CStr(Fields!Year.Value)`という式を作成します。</span><span class="sxs-lookup"><span data-stu-id="881b1-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="881b1-158">詳細については、「[レポート データ ペインでのフィールドの追加、編集、更新 &#40;レポート ビルダーおよび SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="881b1-159">使用しているデータ処理拡張機能に、書式設定済みのデータを取得するためのメタデータが含まれているかどうかを確認する。</span><span class="sxs-lookup"><span data-stu-id="881b1-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="881b1-160">たとえば、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX クエリには、キューブの処理時に書式設定されたキューブ値を保持する FORMATTED_VALUE という拡張プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="881b1-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="881b1-161">詳細については、「[Analysis Services データベースに対する拡張フィールド プロパティ &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="881b1-162">パラメーターのデータ型について</span><span class="sxs-lookup"><span data-stu-id="881b1-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="881b1-163">レポート パラメーターに使用できるデータ型は、Boolean、DateTime、Integer、Float、Text (String) の 5 つだけです。</span><span class="sxs-lookup"><span data-stu-id="881b1-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="881b1-164">データセット クエリにクエリ パラメーターが含まれている場合は、レポート パラメーターが自動的に作成されて、対応するクエリ パラメーターに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="881b1-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="881b1-165">レポート パラメーターの既定のデータ型は String です。</span><span class="sxs-lookup"><span data-stu-id="881b1-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="881b1-166">レポート パラメーターの既定のデータ型を変更するには、 **[レポート パラメーターのプロパティ]** ダイアログ ボックスの **[全般]** ページで、 **[データ型]** ボックスの一覧から該当する値を選択します。</span><span class="sxs-lookup"><span data-stu-id="881b1-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="881b1-167">DateTime データ型のレポート パラメーターは、ミリ秒をサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="881b1-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="881b1-168">ミリ秒を含む値に基づいてパラメーターを作成することはできますが、ミリ秒が指定された Date 値または Time 値を値ドロップダウン リストから選択することはできません。</span><span class="sxs-lookup"><span data-stu-id="881b1-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="881b1-169">データ型を変換する式やデータの一部を抽出する式を作成する</span><span class="sxs-lookup"><span data-stu-id="881b1-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="881b1-170">テキストとデータセット フィールドを連結演算子 (&) で結合する場合、通常は共通言語ランタイム (CLR) の既定の書式を使用できます。</span><span class="sxs-lookup"><span data-stu-id="881b1-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="881b1-171">データセット フィールドまたはパラメーターを特定のデータ型へと明示的に変換する場合は、CLR のメソッドを使用するか、Visual Basic のランタイム ライブラリ関数を使ってデータを変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="881b1-172">データ型の変換例を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="881b1-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="881b1-173">変換の種類</span><span class="sxs-lookup"><span data-stu-id="881b1-173">Type of conversion</span></span>|<span data-ttu-id="881b1-174">例</span><span class="sxs-lookup"><span data-stu-id="881b1-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="881b1-175">DateTime から String</span><span class="sxs-lookup"><span data-stu-id="881b1-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="881b1-176">String から DateTime</span><span class="sxs-lookup"><span data-stu-id="881b1-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="881b1-177">String から DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="881b1-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="881b1-178">年を抽出</span><span class="sxs-lookup"><span data-stu-id="881b1-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="881b1-179">Boolean から Integer</span><span class="sxs-lookup"><span data-stu-id="881b1-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="881b1-180">True は -1、False は 0 になります。</span><span class="sxs-lookup"><span data-stu-id="881b1-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="881b1-181">Boolean から Integer</span><span class="sxs-lookup"><span data-stu-id="881b1-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="881b1-182">True は 1、False は 0 になります。</span><span class="sxs-lookup"><span data-stu-id="881b1-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="881b1-183">DateTimeOffset 値から DateTime 部分のみを抽出</span><span class="sxs-lookup"><span data-stu-id="881b1-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="881b1-184">DateTimeOffset 値から Offset 部分のみを抽出</span><span class="sxs-lookup"><span data-stu-id="881b1-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="881b1-185">Format 関数を使用して、値の表示形式を制御することもできます。</span><span class="sxs-lookup"><span data-stu-id="881b1-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="881b1-186">詳細については、「 [関数 (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="881b1-187">高度な例</span><span class="sxs-lookup"><span data-stu-id="881b1-187">Advanced Examples</span></span>  
 <span data-ttu-id="881b1-188">データ ソースへの接続に使用するデータ プロバイダーが、すべてのデータ型の変換をサポートしているとは限りません。このような場合、サポートされていないデータ ソースの種類に対する既定のデータ型は String になります。</span><span class="sxs-lookup"><span data-stu-id="881b1-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="881b1-189">次の例では、データ型が文字列として返される場合の対処方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="881b1-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="881b1-190">String 型と CLR DateTimeOffset 型の連結</span><span class="sxs-lookup"><span data-stu-id="881b1-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="881b1-191">CLR には、ほとんどのデータ型について既定の変換方法が用意されているため、& 演算子を使用することで、データ型が異なる値を 1 つの文字列に連結できます。</span><span class="sxs-lookup"><span data-stu-id="881b1-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="881b1-192">たとえば、"The date and time are: " というテキストと、StartDate という <xref:System.DateTime> 型のデータセット フィールドを連結するには、 `="The date and time are: " & Fields!StartDate.Value`」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="881b1-193">データ型によっては、ToString 関数が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="881b1-194">たとえば、先ほどと同じ例を、CLR データ型の <xref:System.DateTimeOffset>(日付、時刻、および、UTC タイム ゾーンを基準とするタイム ゾーン オフセットで構成される) を使って記述する場合は、 `="The time is: " & Fields!StartDate.Value.ToString()`」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="881b1-195">String 型から CLR の DateTime 型への変換</span><span class="sxs-lookup"><span data-stu-id="881b1-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="881b1-196">データ ソースで定義されているすべてのデータ型をデータ処理拡張機能がサポートしていない場合、サポート対象外のデータはテキストとして処理される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="881b1-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="881b1-197">たとえば、`datetimeoffset(7)` データ型の値は String データ型として処理されます。</span><span class="sxs-lookup"><span data-stu-id="881b1-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="881b1-198">"July 1, 2008, at 6:05:07.9999999 A.M." に対応する文字列値は、オーストラリアのパースでは</span><span class="sxs-lookup"><span data-stu-id="881b1-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="881b1-199">次のようになります。</span><span class="sxs-lookup"><span data-stu-id="881b1-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="881b1-200">この例では、日付 (July 1, 2008) に続けて、小数点以下 7 桁の時刻値 (6:05:07.9999999 A.M.) と UTC タイム ゾーン オフセット (+8 時間、0 分) が続きます。</span><span class="sxs-lookup"><span data-stu-id="881b1-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="881b1-201">以下の例では、この値が `MyDateTime.Value` という `String` 型のフィールドに格納されています。</span><span class="sxs-lookup"><span data-stu-id="881b1-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="881b1-202">次のいずれかの方法を使用することで、このデータを 1 つまたは複数の CLR 値に変換できます。</span><span class="sxs-lookup"><span data-stu-id="881b1-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="881b1-203">テキスト ボックスに、文字列の一部分を抽出する式を入力します。</span><span class="sxs-lookup"><span data-stu-id="881b1-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="881b1-204">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="881b1-204">For example:</span></span>  
  
    -   <span data-ttu-id="881b1-205">UTC タイム ゾーン オフセットの時間部分だけを抽出し、分に変換するには、次の式を使用します。 `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="881b1-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="881b1-206">結果は `480`です。</span><span class="sxs-lookup"><span data-stu-id="881b1-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="881b1-207">文字列を日時の値に変換するには、次の式を使用します。 `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="881b1-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="881b1-208">`MyDateTime.Value` の文字列に UTC オフセットが含まれている場合、まず、 `DateTime.Parse` 関数によって UTC オフセットの調整が行われます (ここでは、午前 7 時から</span><span class="sxs-lookup"><span data-stu-id="881b1-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="881b1-209">[`+08:00`] を差し引いて、前日の午後 11 時という UTC 時刻が</span><span class="sxs-lookup"><span data-stu-id="881b1-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="881b1-210">求められます)。</span><span class="sxs-lookup"><span data-stu-id="881b1-210">the night before).</span></span> <span data-ttu-id="881b1-211">次に、 `DateTime.Parse` 関数は、レポート サーバーのローカル UTC オフセットを適用し、必要に応じて夏時間のために再度時刻調整を行います。</span><span class="sxs-lookup"><span data-stu-id="881b1-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="881b1-212">たとえば、ワシントン州レドモンドの場合、夏時間調整後のローカル時刻オフセットは `[-07:00]`(午後 11 時の 7 時間前) になります。</span><span class="sxs-lookup"><span data-stu-id="881b1-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="881b1-213">したがって、`2007-07-06 04:07:07 PM` (2007 年 7 月 6 日午後 4 時 07 分) という `DateTime` 値が得られます。</span><span class="sxs-lookup"><span data-stu-id="881b1-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="881b1-214">文字列をデータ型に変換する方法の詳細につい `DateTime` ては、MSDN の「[日付と時刻文字列の解析](https://go.microsoft.com/fwlink/?LinkId=89703)」、「[特定のカルチャの日付と時刻の書式設定](https://go.microsoft.com/fwlink/?LinkId=89704)」、および「 [DateTime、DateTimeOffset、および TimeZoneInfo の選択](https://go.microsoft.com/fwlink/?linkid=110652)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="881b1-215">レポート データセットに、文字列の一部分を抽出する式を使った新しい計算フィールドを追加します。</span><span class="sxs-lookup"><span data-stu-id="881b1-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="881b1-216">詳細については、「[レポート データ ペインでのフィールドの追加、編集、更新 &#40;レポート ビルダーおよび SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="881b1-217">[!INCLUDE[tsql](../../includes/tsql-md.md)] 関数を使って日付と時刻の値を別々に抽出し、別個の列を作成するように、レポートのデータセット クエリを修正します。</span><span class="sxs-lookup"><span data-stu-id="881b1-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="881b1-218">次の例では、`DatePart` 関数を使用して、年の列と UTC タイム ゾーン (分単位) の列を追加しています。</span><span class="sxs-lookup"><span data-stu-id="881b1-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="881b1-219">結果セットには、3 つの列が格納されます。</span><span class="sxs-lookup"><span data-stu-id="881b1-219">The result set has three columns.</span></span> <span data-ttu-id="881b1-220">1 列目には日付と時刻が、2 列目には年が、3 列目には分単位の UTC オフセットが格納されます。</span><span class="sxs-lookup"><span data-stu-id="881b1-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="881b1-221">次の行はサンプル データを示しています。</span><span class="sxs-lookup"><span data-stu-id="881b1-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="881b1-222">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] データベースの型の詳細については、[SQL Server オンライン ブック](https://go.microsoft.com/fwlink/?linkid=120955) の「[データ型 &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql)」および「[日付と時刻のデータ型および関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="881b1-223">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] のデータ型の詳細については、 [SQL Server オンライン ブック](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) の「 [SQL Server Books Onlの「e](https://go.microsoft.com/fwlink/?linkid=120955)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="881b1-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="881b1-224">参照</span><span class="sxs-lookup"><span data-stu-id="881b1-224">See Also</span></span>  
 [<span data-ttu-id="881b1-225">レポート アイテムの書式設定 &#40;レポート ビルダーおよび SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="881b1-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
