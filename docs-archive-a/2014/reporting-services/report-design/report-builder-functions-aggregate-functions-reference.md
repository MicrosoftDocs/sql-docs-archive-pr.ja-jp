---
title: 集計関数リファレンス (レポート ビルダーおよび SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: db6542ee-02d0-4073-90e6-cba8f9510fbb
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: b7c88935b303d36e73741bee17e966ec6616a030
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721128"
---
# <a name="aggregate-functions-reference-report-builder-and-ssrs"></a><span data-ttu-id="4da0c-102">集計関数リファレンス (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="4da0c-102">Aggregate Functions Reference (Report Builder and SSRS)</span></span>
  <span data-ttu-id="4da0c-103">レポートに集計値を含めるには、式に組み込み集計関数を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-103">To include aggregated values in your report, you can use built-in aggregate functions in expressions.</span></span> <span data-ttu-id="4da0c-104">数値フィールドの既定の集計関数は SUM です。</span><span class="sxs-lookup"><span data-stu-id="4da0c-104">The default aggregate function for numeric fields is SUM.</span></span> <span data-ttu-id="4da0c-105">式を編集して異なる組み込み集計関数を使用したり、異なるスコープを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-105">You can edit the expression and use a different built-in aggregate function or specify a different scope.</span></span> <span data-ttu-id="4da0c-106">スコープにより、計算に使用するデータセットが識別されます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-106">Scope identifies which set of data to use for the calculation.</span></span>  
  
 <span data-ttu-id="4da0c-107">レポート プロセッサではレポート データとレポート レイアウトが結合されるため、各レポート アイテムの式が評価されます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-107">As the report processor combines report data and the report layout, the expressions for each report item are evaluated.</span></span> <span data-ttu-id="4da0c-108">レポートの各ページを表示すると、表示されたレポート アイテムに各式の結果が示されます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-108">As you view each page of the report, you see the results for each expression in the rendered report items.</span></span>  
  
 <span data-ttu-id="4da0c-109">次の表に、式に含めることのできる組み込み関数のカテゴリの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-109">The following table lists categories of built-in functions that you can include in an expression:</span></span>  
  
-   [<span data-ttu-id="4da0c-110">組み込み集計関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-110">Built-in Aggregate Functions</span></span>](#CalculatingAggregates)  
  
-   [<span data-ttu-id="4da0c-111">組み込みフィールド、コレクション、および集計関数に関する制限</span><span class="sxs-lookup"><span data-stu-id="4da0c-111">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>](#Restrictions)  
  
-   [<span data-ttu-id="4da0c-112">入れ子集計に関する制限</span><span class="sxs-lookup"><span data-stu-id="4da0c-112">Restrictions on Nested Aggregates</span></span>](#NestedRestrictions)  
  
-   [<span data-ttu-id="4da0c-113">実行中の値の計算</span><span class="sxs-lookup"><span data-stu-id="4da0c-113">Calculating Running Values</span></span>](#CalculatingRunningValues)  
  
-   [<span data-ttu-id="4da0c-114">行数の取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-114">Retrieving Row Counts</span></span>](#RetrievingRowCounts)  
  
-   [<span data-ttu-id="4da0c-115">別のデータセットの値の参照</span><span class="sxs-lookup"><span data-stu-id="4da0c-115">Looking Up Values from Another Dataset</span></span>](#LookupFunctions)  
  
-   [<span data-ttu-id="4da0c-116">並べ替え依存の値の取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-116">Retrieving Sort-Dependent Values</span></span>](#RetrievingPostsortValues)  
  
-   [<span data-ttu-id="4da0c-117">サーバー集計値の取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-117">Retrieving Server Aggregates</span></span>](#RetrievingServerAggregates)  
  
-   [<span data-ttu-id="4da0c-118">再帰レベルの取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-118">Retrieving Recursive Level</span></span>](#RetrievingRecursiveLevel)  
  
-   [<span data-ttu-id="4da0c-119">スコープのテスト</span><span class="sxs-lookup"><span data-stu-id="4da0c-119">Testing for Scope</span></span>](#TestingforScope)  
  
 <span data-ttu-id="4da0c-120">関数の有効なスコープを判断するには、各関数参照に関するトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="4da0c-120">To determine the valid scopes for a function, see the individual function reference topic.</span></span> <span data-ttu-id="4da0c-121">詳細と例については、「 [合計、集計、および組み込みコレクションの式のスコープ &#40;レポート ビルダーおよび SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4da0c-121">For more information and for examples, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="built-in-aggregate-functions"></a><a name="CalculatingAggregates"></a> <span data-ttu-id="4da0c-122">組み込み集計関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-122">Built-in Aggregate Functions</span></span>  
 <span data-ttu-id="4da0c-123">次の組み込み関数は、既定のスコープまたは名前付きスコープ内の NULL 以外の一連の数値データの集約値を計算します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-123">The following built-in functions calculate summary values for a set of non-null numeric data in the default scope or the named scope.</span></span>  
  
|<span data-ttu-id="4da0c-124">**Function**</span><span class="sxs-lookup"><span data-stu-id="4da0c-124">**Function**</span></span>|<span data-ttu-id="4da0c-125">**説明**</span><span class="sxs-lookup"><span data-stu-id="4da0c-125">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="4da0c-126">Avg</span><span class="sxs-lookup"><span data-stu-id="4da0c-126">Avg</span></span>](report-builder-functions-avg-function.md)|<span data-ttu-id="4da0c-127">式で指定された NULL 以外のすべての数値の平均を、指定されたスコープで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-127">Returns the average of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-128">Count</span><span class="sxs-lookup"><span data-stu-id="4da0c-128">Count</span></span>](report-builder-functions-count-function.md)|<span data-ttu-id="4da0c-129">式で指定された NULL 以外の値の数を、指定されたスコープのコンテキストで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-129">Returns a count of non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-130">CountDistinct</span><span class="sxs-lookup"><span data-stu-id="4da0c-130">CountDistinct</span></span>](report-builder-functions-countdistinct-function.md)|<span data-ttu-id="4da0c-131">式で指定された NULL 以外の値が全部で何種類あるかを、指定されたスコープのコンテキストで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-131">Returns a count of all distinct non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-132">Max (最大値)</span><span class="sxs-lookup"><span data-stu-id="4da0c-132">Max</span></span>](report-builder-functions-max-function.md)|<span data-ttu-id="4da0c-133">指定されたスコープのコンテキストで、式で指定された NULL 以外のすべての数値の中から最大値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-133">Returns the maximum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="4da0c-134">グラフの軸の最大値を指定してスケールを制御する場合は、この関数を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-134">You can use this for specifying a chart axis maximum value to control the scale.</span></span>|  
|[<span data-ttu-id="4da0c-135">Min (最小値)</span><span class="sxs-lookup"><span data-stu-id="4da0c-135">Min</span></span>](report-builder-functions-min-function.md)|<span data-ttu-id="4da0c-136">指定されたスコープのコンテキストで、式で指定された NULL 以外のすべての数値の中から最小値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-136">Returns the minimum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="4da0c-137">グラフの軸の最小値を指定してスケールを制御する場合は、この関数を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-137">You can use this for specifying a chart axis minimum value to control the scale.</span></span>|  
|[<span data-ttu-id="4da0c-138">StDev</span><span class="sxs-lookup"><span data-stu-id="4da0c-138">StDev</span></span>](report-builder-functions-stdev-function.md)|<span data-ttu-id="4da0c-139">式で指定された NULL 以外のすべての数値の標準偏差を、指定されたスコープで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-139">Returns the standard deviation of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-140">StDevP</span><span class="sxs-lookup"><span data-stu-id="4da0c-140">StDevP</span></span>](report-builder-functions-stdevp-function.md)|<span data-ttu-id="4da0c-141">式で指定された NULL 以外のすべての数値の母集団標準偏差を、指定されたスコープのコンテキストで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-141">Returns the population standard deviation of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-142">Sum</span><span class="sxs-lookup"><span data-stu-id="4da0c-142">Sum</span></span>](report-builder-functions-sum-function.md)|<span data-ttu-id="4da0c-143">式で指定された NULL 以外のすべての数値の合計を、指定されたスコープで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-143">Returns the sum of all the non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-144">Union (結合)</span><span class="sxs-lookup"><span data-stu-id="4da0c-144">Union</span></span>](report-builder-functions-union-function.md)|<span data-ttu-id="4da0c-145">式で指定された NULL 以外のすべての空間データの値 (`SqlGeometry` 型または `SqlGeography` 型) の和集合を、指定されたスコープ内で評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-145">Returns the union of all the non-null spatial data values of type `SqlGeometry` or `SqlGeography` that are specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-146">Var</span><span class="sxs-lookup"><span data-stu-id="4da0c-146">Var</span></span>](report-builder-functions-var-function.md)|<span data-ttu-id="4da0c-147">式で指定された NULL 以外のすべての数値の分散を、指定されたスコープで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-147">Returns the variance of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="4da0c-148">VarP</span><span class="sxs-lookup"><span data-stu-id="4da0c-148">VarP</span></span>](report-builder-functions-varp-function.md)|<span data-ttu-id="4da0c-149">式で指定された NULL 以外のすべての数値の母集団に対する分散を、指定されたスコープのコンテキストで評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-149">Returns the population variance of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
  
##  <a name="restrictions-on-built-in-fields-collections-and-aggregate-functions"></a><a name="Restrictions"></a><span data-ttu-id="4da0c-150">組み込みフィールド、コレクション、および集計関数に関する制限事項</span><span class="sxs-lookup"><span data-stu-id="4da0c-150">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>  
 <span data-ttu-id="4da0c-151">以下の表には、グローバル組み込みコレクションの参照を含む式を追加できるレポートの場所に関する制限をまとめています。</span><span class="sxs-lookup"><span data-stu-id="4da0c-151">The following table summarizes restrictions in report locations on where you can add expressions that contain references to global built-in collections.</span></span>  
  
|<span data-ttu-id="4da0c-152">レポート内の場所</span><span class="sxs-lookup"><span data-stu-id="4da0c-152">Location in Report</span></span>|<span data-ttu-id="4da0c-153">フィールド</span><span class="sxs-lookup"><span data-stu-id="4da0c-153">Fields</span></span>|<span data-ttu-id="4da0c-154">パラメーター</span><span class="sxs-lookup"><span data-stu-id="4da0c-154">Parameters</span></span>|<span data-ttu-id="4da0c-155">ReportItems</span><span class="sxs-lookup"><span data-stu-id="4da0c-155">ReportItems</span></span>|<span data-ttu-id="4da0c-156">PageNumber</span><span class="sxs-lookup"><span data-stu-id="4da0c-156">PageNumber</span></span><br /><br /> <span data-ttu-id="4da0c-157">TotalPages</span><span class="sxs-lookup"><span data-stu-id="4da0c-157">TotalPages</span></span>|<span data-ttu-id="4da0c-158">DataSource</span><span class="sxs-lookup"><span data-stu-id="4da0c-158">DataSource</span></span><br /><br /> <span data-ttu-id="4da0c-159">DataSet</span><span class="sxs-lookup"><span data-stu-id="4da0c-159">DataSet</span></span>|<span data-ttu-id="4da0c-160">変数</span><span class="sxs-lookup"><span data-stu-id="4da0c-160">Variables</span></span>|<span data-ttu-id="4da0c-161">RenderFormat</span><span class="sxs-lookup"><span data-stu-id="4da0c-161">RenderFormat</span></span>|  
|------------------------|------------|----------------|-----------------|-------------------------------|----------------------------|---------------|------------------|  
|<span data-ttu-id="4da0c-162">ページ ヘッダー</span><span class="sxs-lookup"><span data-stu-id="4da0c-162">Page Header</span></span><br /><br /> <span data-ttu-id="4da0c-163">ページ フッター</span><span class="sxs-lookup"><span data-stu-id="4da0c-163">Page Footer</span></span>|<span data-ttu-id="4da0c-164">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-164">Yes</span></span>|<span data-ttu-id="4da0c-165">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-165">Yes</span></span>|<span data-ttu-id="4da0c-166">最大 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-166">At most one</span></span><br /><br /> <span data-ttu-id="4da0c-167">注 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-167">Note 1</span></span>|<span data-ttu-id="4da0c-168">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-168">Yes</span></span>|<span data-ttu-id="4da0c-169">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-169">Yes</span></span>|<span data-ttu-id="4da0c-170">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-170">Yes</span></span>|<span data-ttu-id="4da0c-171">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-171">Yes</span></span>|  
|<span data-ttu-id="4da0c-172">Body</span><span class="sxs-lookup"><span data-stu-id="4da0c-172">Body</span></span>|<span data-ttu-id="4da0c-173">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-173">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-174">注 2</span><span class="sxs-lookup"><span data-stu-id="4da0c-174">Note 2</span></span>|<span data-ttu-id="4da0c-175">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-175">Yes</span></span>|<span data-ttu-id="4da0c-176">現在のスコープまたはコンテナー スコープのアイテムのみ</span><span class="sxs-lookup"><span data-stu-id="4da0c-176">Only items in the currnet scope or a containing scope</span></span><br /><br /> <span data-ttu-id="4da0c-177">注 3</span><span class="sxs-lookup"><span data-stu-id="4da0c-177">Note 3</span></span>|<span data-ttu-id="4da0c-178">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-178">No</span></span>|<span data-ttu-id="4da0c-179">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-179">Yes</span></span>|<span data-ttu-id="4da0c-180">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-180">Yes</span></span>|<span data-ttu-id="4da0c-181">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-181">Yes</span></span>|  
|<span data-ttu-id="4da0c-182">レポート パラメーター</span><span class="sxs-lookup"><span data-stu-id="4da0c-182">Report Parameter</span></span>|<span data-ttu-id="4da0c-183">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-183">No</span></span>|<span data-ttu-id="4da0c-184">リスト内で先に出現するパラメーターのみ</span><span class="sxs-lookup"><span data-stu-id="4da0c-184">Only parameters earlier in the list</span></span><br /><br /> <span data-ttu-id="4da0c-185">注 4</span><span class="sxs-lookup"><span data-stu-id="4da0c-185">Note 4</span></span>|<span data-ttu-id="4da0c-186">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-186">No</span></span>|<span data-ttu-id="4da0c-187">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-187">No</span></span>|<span data-ttu-id="4da0c-188">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-188">No</span></span>|<span data-ttu-id="4da0c-189">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-189">No</span></span>|<span data-ttu-id="4da0c-190">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-190">No</span></span>|  
|<span data-ttu-id="4da0c-191">フィールド</span><span class="sxs-lookup"><span data-stu-id="4da0c-191">Field</span></span>|<span data-ttu-id="4da0c-192">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-192">Yes</span></span>|<span data-ttu-id="4da0c-193">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-193">Yes</span></span>|<span data-ttu-id="4da0c-194">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-194">No</span></span>|<span data-ttu-id="4da0c-195">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-195">No</span></span>|<span data-ttu-id="4da0c-196">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-196">No</span></span>|<span data-ttu-id="4da0c-197">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-197">No</span></span>|<span data-ttu-id="4da0c-198">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-198">No</span></span>|  
|<span data-ttu-id="4da0c-199">クエリ パラメーター</span><span class="sxs-lookup"><span data-stu-id="4da0c-199">Query Parameter</span></span>|<span data-ttu-id="4da0c-200">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-200">No</span></span>|<span data-ttu-id="4da0c-201">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-201">Yes</span></span>|<span data-ttu-id="4da0c-202">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-202">No</span></span>|<span data-ttu-id="4da0c-203">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-203">No</span></span>|<span data-ttu-id="4da0c-204">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-204">No</span></span>|<span data-ttu-id="4da0c-205">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-205">No</span></span>|<span data-ttu-id="4da0c-206">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-206">No</span></span>|  
|<span data-ttu-id="4da0c-207">グループ式</span><span class="sxs-lookup"><span data-stu-id="4da0c-207">Group Expression</span></span>|<span data-ttu-id="4da0c-208">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-208">Yes</span></span>|<span data-ttu-id="4da0c-209">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-209">Yes</span></span>|<span data-ttu-id="4da0c-210">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-210">No</span></span>|<span data-ttu-id="4da0c-211">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-211">No</span></span>|<span data-ttu-id="4da0c-212">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-212">Yes</span></span>|<span data-ttu-id="4da0c-213">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-213">No</span></span>|<span data-ttu-id="4da0c-214">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-214">No</span></span>|  
|<span data-ttu-id="4da0c-215">並べ替え式</span><span class="sxs-lookup"><span data-stu-id="4da0c-215">Sort Expression</span></span>|<span data-ttu-id="4da0c-216">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-216">Yes</span></span>|<span data-ttu-id="4da0c-217">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-217">Yes</span></span>|<span data-ttu-id="4da0c-218">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-218">No</span></span>|<span data-ttu-id="4da0c-219">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-219">No</span></span>|<span data-ttu-id="4da0c-220">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-220">Yes</span></span>|<span data-ttu-id="4da0c-221">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-221">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-222">注 5</span><span class="sxs-lookup"><span data-stu-id="4da0c-222">Note 5</span></span>|<span data-ttu-id="4da0c-223">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-223">No</span></span>|  
|<span data-ttu-id="4da0c-224">[フィルター式]</span><span class="sxs-lookup"><span data-stu-id="4da0c-224">Filter Expression</span></span>|<span data-ttu-id="4da0c-225">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-225">Yes</span></span>|<span data-ttu-id="4da0c-226">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-226">Yes</span></span>|<span data-ttu-id="4da0c-227">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-227">No</span></span>|<span data-ttu-id="4da0c-228">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-228">No</span></span>|<span data-ttu-id="4da0c-229">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-229">Yes</span></span>|<span data-ttu-id="4da0c-230">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-230">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-231">注 6</span><span class="sxs-lookup"><span data-stu-id="4da0c-231">Note 6</span></span>|<span data-ttu-id="4da0c-232">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-232">No</span></span>|  
|<span data-ttu-id="4da0c-233">コード</span><span class="sxs-lookup"><span data-stu-id="4da0c-233">Code</span></span>|<span data-ttu-id="4da0c-234">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-234">No</span></span>|<span data-ttu-id="4da0c-235">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-235">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-236">注 7</span><span class="sxs-lookup"><span data-stu-id="4da0c-236">Note 7</span></span>|<span data-ttu-id="4da0c-237">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-237">No</span></span>|<span data-ttu-id="4da0c-238">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-238">No</span></span>|<span data-ttu-id="4da0c-239">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-239">No</span></span>|<span data-ttu-id="4da0c-240">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-240">No</span></span>|<span data-ttu-id="4da0c-241">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-241">No</span></span>|  
|<span data-ttu-id="4da0c-242">レポートの言語</span><span class="sxs-lookup"><span data-stu-id="4da0c-242">Report.Language</span></span>|<span data-ttu-id="4da0c-243">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-243">No</span></span>|<span data-ttu-id="4da0c-244">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-244">Yes</span></span>|<span data-ttu-id="4da0c-245">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-245">No</span></span>|<span data-ttu-id="4da0c-246">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-246">No</span></span>|<span data-ttu-id="4da0c-247">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-247">No</span></span>|<span data-ttu-id="4da0c-248">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-248">No</span></span>|<span data-ttu-id="4da0c-249">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-249">No</span></span>|  
|<span data-ttu-id="4da0c-250">変数</span><span class="sxs-lookup"><span data-stu-id="4da0c-250">Variables</span></span>|<span data-ttu-id="4da0c-251">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-251">Yes</span></span>|<span data-ttu-id="4da0c-252">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-252">Yes</span></span>|<span data-ttu-id="4da0c-253">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-253">No</span></span>|<span data-ttu-id="4da0c-254">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-254">No</span></span>|<span data-ttu-id="4da0c-255">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-255">Yes</span></span>|<span data-ttu-id="4da0c-256">現在のスコープかコンテナー スコープ</span><span class="sxs-lookup"><span data-stu-id="4da0c-256">Current or containing scope</span></span>|<span data-ttu-id="4da0c-257">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-257">No</span></span>|  
|<span data-ttu-id="4da0c-258">集計</span><span class="sxs-lookup"><span data-stu-id="4da0c-258">Aggregates</span></span>|<span data-ttu-id="4da0c-259">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-259">Yes</span></span>|<span data-ttu-id="4da0c-260">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-260">Yes</span></span>|<span data-ttu-id="4da0c-261">ページ ヘッダー/ページ フッター内のみ</span><span class="sxs-lookup"><span data-stu-id="4da0c-261">Only in page header/page footer</span></span>|<span data-ttu-id="4da0c-262">レポート アイテムの集計内のみ</span><span class="sxs-lookup"><span data-stu-id="4da0c-262">Only in report item aggregates</span></span>|<span data-ttu-id="4da0c-263">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-263">Yes</span></span>|<span data-ttu-id="4da0c-264">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-264">No</span></span>|<span data-ttu-id="4da0c-265">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-265">No</span></span>|  
|<span data-ttu-id="4da0c-266">参照関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-266">Lookup functions</span></span>|<span data-ttu-id="4da0c-267">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-267">Yes</span></span>|<span data-ttu-id="4da0c-268">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-268">Yes</span></span>|<span data-ttu-id="4da0c-269">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-269">Yes</span></span>|<span data-ttu-id="4da0c-270">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-270">No</span></span>|<span data-ttu-id="4da0c-271">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-271">Yes</span></span>|<span data-ttu-id="4da0c-272">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-272">No</span></span>|<span data-ttu-id="4da0c-273">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-273">No</span></span>|  
  
-   <span data-ttu-id="4da0c-274">**メモ1。**</span><span class="sxs-lookup"><span data-stu-id="4da0c-274">**Note 1.**</span></span> <span data-ttu-id="4da0c-275">ReportItems は、表示されるレポート ページに存在する必要があります。そうでない場合は値が Null になります。</span><span class="sxs-lookup"><span data-stu-id="4da0c-275">ReportItems must exist in the rendered report page, or their value is Null.</span></span> <span data-ttu-id="4da0c-276">レポート アイテムの表示が式に依存し、その式が False に評価される場合、ページにはレポート アイテムが存在しません。</span><span class="sxs-lookup"><span data-stu-id="4da0c-276">If the visibility of a report item depends on an expression that evaluates to False, the report item does not exist on the page.</span></span>  
  
-   <span data-ttu-id="4da0c-277">**メモ 2.**</span><span class="sxs-lookup"><span data-stu-id="4da0c-277">**Note 2.**</span></span> <span data-ttu-id="4da0c-278">フィールド参照がグループ スコープ内で使用されており、このフィールド参照がグループ式に含まれていない場合、スコープに 1 つしか値がない場合を除いて、フィールドの値は未定義になります。</span><span class="sxs-lookup"><span data-stu-id="4da0c-278">If a field reference is used in a group scope, and the field reference is not included in the group expression, then the value for the field is undefined, unless there is only one value in the scope.</span></span> <span data-ttu-id="4da0c-279">値を指定するには、First または Last とグループ スコープを使用します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-279">To specify a value, use First or Last and the group scope.</span></span>  
  
-   <span data-ttu-id="4da0c-280">**メモ 3.**</span><span class="sxs-lookup"><span data-stu-id="4da0c-280">**Note 3.**</span></span> <span data-ttu-id="4da0c-281">ReportItems の参照を含む式は、同じグループ スコープまたはコンテナー グループ スコープ内の他の ReportItems の値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-281">Expressions that include a reference to ReportItems can specify values for other ReportItems in the same group scope or in a containing group scope.</span></span>  
  
-   <span data-ttu-id="4da0c-282">**注 4:**</span><span class="sxs-lookup"><span data-stu-id="4da0c-282">**Note 4.**</span></span> <span data-ttu-id="4da0c-283">先に出現するパラメーターのプロパティ値が Null の場合があります。</span><span class="sxs-lookup"><span data-stu-id="4da0c-283">Property values for earlier parameters might be null.</span></span>  
  
-   <span data-ttu-id="4da0c-284">**メモ5。**</span><span class="sxs-lookup"><span data-stu-id="4da0c-284">**Note 5.**</span></span> <span data-ttu-id="4da0c-285">メンバーの並べ替えのみ。</span><span class="sxs-lookup"><span data-stu-id="4da0c-285">In Member sorts only.</span></span> <span data-ttu-id="4da0c-286">データ領域の並べ替え式には使用できません。</span><span class="sxs-lookup"><span data-stu-id="4da0c-286">Cannot use in data region sort expressions.</span></span>  
  
-   <span data-ttu-id="4da0c-287">**注 6:**</span><span class="sxs-lookup"><span data-stu-id="4da0c-287">**Note 6.**</span></span> <span data-ttu-id="4da0c-288">メンバーのフィルターのみ。</span><span class="sxs-lookup"><span data-stu-id="4da0c-288">In Member filters only.</span></span> <span data-ttu-id="4da0c-289">データ領域またはデータセットのフィルター式には使用できません。</span><span class="sxs-lookup"><span data-stu-id="4da0c-289">Cannot use in data region or dataset filter expressions.</span></span>  
  
-   <span data-ttu-id="4da0c-290">**注 7:**</span><span class="sxs-lookup"><span data-stu-id="4da0c-290">**Note 7.**</span></span> <span data-ttu-id="4da0c-291">コード ブロックが処理されるまでパラメーターのコレクションは初期化されません。そのため初期化時のパラメーターの制御にはメソッドを使用できません。</span><span class="sxs-lookup"><span data-stu-id="4da0c-291">The Parameters collection is not initialized until after the Code block is processed, so methods cannot be used to control parameters on initialization.</span></span>  
  
-   <span data-ttu-id="4da0c-292">**注 8:**</span><span class="sxs-lookup"><span data-stu-id="4da0c-292">**Note 8.**</span></span> <span data-ttu-id="4da0c-293">Count および CountDistinct を除くすべての集計のデータ型は、すべての値で同じデータ型、または null である必要があります。</span><span class="sxs-lookup"><span data-stu-id="4da0c-293">Data type for all aggregates except Count and CountDistinct must be the same data type, or null, for all values.</span></span>  
  
##  <a name="restrictions-on-nested-aggregates"></a><a name="NestedRestrictions"></a> <span data-ttu-id="4da0c-294">入れ子集計に関する制限</span><span class="sxs-lookup"><span data-stu-id="4da0c-294">Restrictions on Nested Aggregates</span></span>  
 <span data-ttu-id="4da0c-295">以下の表には、集計関数に入れ子集計として別の集計関数を指定する際の制限をまとめています。</span><span class="sxs-lookup"><span data-stu-id="4da0c-295">The following table summarizes restrictions on which aggregates functions can specify other aggregate functions as nested aggregates.</span></span>  
  
|<span data-ttu-id="4da0c-296">コンテキスト</span><span class="sxs-lookup"><span data-stu-id="4da0c-296">Context</span></span>|<span data-ttu-id="4da0c-297">RunningValue</span><span class="sxs-lookup"><span data-stu-id="4da0c-297">RunningValue</span></span>|<span data-ttu-id="4da0c-298">RowNumber</span><span class="sxs-lookup"><span data-stu-id="4da0c-298">RowNumber</span></span>|<span data-ttu-id="4da0c-299">First</span><span class="sxs-lookup"><span data-stu-id="4da0c-299">First</span></span><br /><br /> <span data-ttu-id="4da0c-300">末尾</span><span class="sxs-lookup"><span data-stu-id="4da0c-300">Last</span></span>|<span data-ttu-id="4da0c-301">前へ</span><span class="sxs-lookup"><span data-stu-id="4da0c-301">Previous</span></span>|<span data-ttu-id="4da0c-302">Sum およびその他の事前並べ替え関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-302">Sum and Other Presort functions</span></span>|<span data-ttu-id="4da0c-303">ReportItem の集計</span><span class="sxs-lookup"><span data-stu-id="4da0c-303">ReportItem aggregates</span></span>|<span data-ttu-id="4da0c-304">参照関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-304">Lookup functions</span></span>|<span data-ttu-id="4da0c-305">集計関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-305">Aggregate Function</span></span>|  
|-------------|------------------|---------------|--------------------|--------------|-------------------------------------|---------------------------|----------------------|------------------------|  
|<span data-ttu-id="4da0c-306">Running Value</span><span class="sxs-lookup"><span data-stu-id="4da0c-306">Running Value</span></span>|<span data-ttu-id="4da0c-307">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-307">No</span></span>|<span data-ttu-id="4da0c-308">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-308">No</span></span>|<span data-ttu-id="4da0c-309">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-309">No</span></span>|<span data-ttu-id="4da0c-310">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-310">No</span></span>|<span data-ttu-id="4da0c-311">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-311">Yes</span></span>|<span data-ttu-id="4da0c-312">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-312">No</span></span>|<span data-ttu-id="4da0c-313">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-313">Yes</span></span>|<span data-ttu-id="4da0c-314">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-314">No</span></span>|  
|<span data-ttu-id="4da0c-315">First</span><span class="sxs-lookup"><span data-stu-id="4da0c-315">First</span></span><br /><br /> <span data-ttu-id="4da0c-316">末尾</span><span class="sxs-lookup"><span data-stu-id="4da0c-316">Last</span></span>|<span data-ttu-id="4da0c-317">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-317">No</span></span>|<span data-ttu-id="4da0c-318">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-318">No</span></span>|<span data-ttu-id="4da0c-319">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-319">No</span></span>|<span data-ttu-id="4da0c-320">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-320">No</span></span>|<span data-ttu-id="4da0c-321">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-321">Yes</span></span>|<span data-ttu-id="4da0c-322">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-322">No</span></span>|<span data-ttu-id="4da0c-323">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-323">No</span></span>|<span data-ttu-id="4da0c-324">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-324">No</span></span>|  
|<span data-ttu-id="4da0c-325">前へ</span><span class="sxs-lookup"><span data-stu-id="4da0c-325">Previous</span></span>|<span data-ttu-id="4da0c-326">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-326">Yes</span></span>|<span data-ttu-id="4da0c-327">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-327">Yes</span></span>|<span data-ttu-id="4da0c-328">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-328">Yes</span></span>|<span data-ttu-id="4da0c-329">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-329">No</span></span>|<span data-ttu-id="4da0c-330">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-330">Yes</span></span>|<span data-ttu-id="4da0c-331">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-331">No</span></span>|<span data-ttu-id="4da0c-332">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-332">Yes</span></span>|<span data-ttu-id="4da0c-333">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-333">No</span></span>|  
|<span data-ttu-id="4da0c-334">Sum およびその他の事前並べ替え関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-334">Sum and other Presort functions</span></span>|<span data-ttu-id="4da0c-335">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-335">No</span></span>|<span data-ttu-id="4da0c-336">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-336">No</span></span>|<span data-ttu-id="4da0c-337">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-337">No</span></span>|<span data-ttu-id="4da0c-338">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-338">No</span></span>|<span data-ttu-id="4da0c-339">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-339">Yes</span></span>|<span data-ttu-id="4da0c-340">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-340">No</span></span>|<span data-ttu-id="4da0c-341">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-341">Yes</span></span>|<span data-ttu-id="4da0c-342">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-342">No</span></span>|  
|<span data-ttu-id="4da0c-343">ReportItem の集計</span><span class="sxs-lookup"><span data-stu-id="4da0c-343">ReportItem aggregates</span></span>|<span data-ttu-id="4da0c-344">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-344">No</span></span>|<span data-ttu-id="4da0c-345">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-345">No</span></span>|<span data-ttu-id="4da0c-346">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-346">No</span></span>|<span data-ttu-id="4da0c-347">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-347">No</span></span>|<span data-ttu-id="4da0c-348">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-348">No</span></span>|<span data-ttu-id="4da0c-349">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-349">No</span></span>|<span data-ttu-id="4da0c-350">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-350">No</span></span>|<span data-ttu-id="4da0c-351">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-351">No</span></span>|  
|<span data-ttu-id="4da0c-352">参照関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-352">Lookup functions</span></span>|<span data-ttu-id="4da0c-353">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-353">Yes</span></span>|<span data-ttu-id="4da0c-354">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-354">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-355">注 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-355">Note 1</span></span>|<span data-ttu-id="4da0c-356">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-356">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-357">注 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-357">Note 1</span></span>|<span data-ttu-id="4da0c-358">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-358">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-359">注 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-359">Note 1</span></span>|<span data-ttu-id="4da0c-360">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-360">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-361">注 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-361">Note 1</span></span>|<span data-ttu-id="4da0c-362">はい</span><span class="sxs-lookup"><span data-stu-id="4da0c-362">Yes</span></span><br /><br /> <span data-ttu-id="4da0c-363">注 1</span><span class="sxs-lookup"><span data-stu-id="4da0c-363">Note 1</span></span>|<span data-ttu-id="4da0c-364">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-364">No</span></span>|<span data-ttu-id="4da0c-365">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-365">No</span></span>|  
|<span data-ttu-id="4da0c-366">集計関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-366">Aggregate Function</span></span>|<span data-ttu-id="4da0c-367">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-367">No</span></span>|<span data-ttu-id="4da0c-368">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-368">No</span></span>|<span data-ttu-id="4da0c-369">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-369">No</span></span>|<span data-ttu-id="4da0c-370">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-370">No</span></span>|<span data-ttu-id="4da0c-371">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-371">No</span></span>|<span data-ttu-id="4da0c-372">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-372">No</span></span>|<span data-ttu-id="4da0c-373">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-373">No</span></span>|<span data-ttu-id="4da0c-374">いいえ</span><span class="sxs-lookup"><span data-stu-id="4da0c-374">No</span></span>|  
  
-   <span data-ttu-id="4da0c-375">**メモ1。**</span><span class="sxs-lookup"><span data-stu-id="4da0c-375">**Note 1.**</span></span> <span data-ttu-id="4da0c-376">集計関数は、集計に参照関数が含まれていない場合に、参照関数の *Source* 式内のみに使用できます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-376">Aggregate functions are only allowed inside the *Source* expression of a Lookup function if the Lookup function is not contained in an aggregate.</span></span> <span data-ttu-id="4da0c-377">集計関数は、参照関数の *Destination* 式または *Result* 式内には使用できません。</span><span class="sxs-lookup"><span data-stu-id="4da0c-377">Aggregate functions are not allowed inside the *Destination* or *Result* expressions of a Lookup function.</span></span>  
  
##  <a name="calculating-running-values"></a><a name="CalculatingRunningValues"></a><span data-ttu-id="4da0c-378">実行中の値の計算</span><span class="sxs-lookup"><span data-stu-id="4da0c-378">Calculating Running Values</span></span>  
 <span data-ttu-id="4da0c-379">次の組み込み関数は、データのセットの実行中の値を計算します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-379">The following built-in functions calculate running values for a set of data.</span></span> <span data-ttu-id="4da0c-380">`RowNumber` は、コンテナー スコープ内の行ごとに増加するカウントの実行中の値を返す点で、`RunningValue` に似ています。</span><span class="sxs-lookup"><span data-stu-id="4da0c-380">`RowNumber` is like `RunningValue` in that it returns the running value of a count that increments for each row within the containing scope.</span></span> <span data-ttu-id="4da0c-381">これらの関数のスコープのパラメーターでは、カウントが再開されるタイミングを制御するコンテナー スコープを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4da0c-381">The scope parameter for these functions must specify a containing scope, which controls when the count restarts.</span></span>  
  
|<span data-ttu-id="4da0c-382">**Function**</span><span class="sxs-lookup"><span data-stu-id="4da0c-382">**Function**</span></span>|<span data-ttu-id="4da0c-383">**説明**</span><span class="sxs-lookup"><span data-stu-id="4da0c-383">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="4da0c-384">RowNumber</span><span class="sxs-lookup"><span data-stu-id="4da0c-384">RowNumber</span></span>](report-builder-functions-rownumber-function.md)|<span data-ttu-id="4da0c-385">指定されたスコープの実行中の行数を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-385">Returns a running count of the number of rows for the specified scope.</span></span> <span data-ttu-id="4da0c-386">`RowNumber` 関数では、カウントが 0 ではなく 1 から再開されます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-386">The `RowNumber` function restarts counting at 1, not 0.</span></span>|  
|[<span data-ttu-id="4da0c-387">RunningValue</span><span class="sxs-lookup"><span data-stu-id="4da0c-387">RunningValue</span></span>](report-builder-functions-runningvalue-function.md)|<span data-ttu-id="4da0c-388">式で指定された NULL 以外のすべての数値の実行中の集計を、指定されたスコープに対して評価して返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-388">Returns a running aggregate of all non-null numeric values specified by the expression, evaluated for the given scope.</span></span>|  
  
##  <a name="retrieving-row-counts"></a><a name="RetrievingRowCounts"></a><span data-ttu-id="4da0c-389">行数の取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-389">Retrieving Row Counts</span></span>  
 <span data-ttu-id="4da0c-390">次の組み込み関数は、指定されたスコープの行数を計算します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-390">The following built-in function calculates the number of rows in the given scope.</span></span> <span data-ttu-id="4da0c-391">この関数を使用すると、NULL 値の行を含め、すべての行がカウントされます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-391">Use this function to count all rows, including rows with null values.</span></span>  
  
|<span data-ttu-id="4da0c-392">**Function**</span><span class="sxs-lookup"><span data-stu-id="4da0c-392">**Function**</span></span>|<span data-ttu-id="4da0c-393">**説明**</span><span class="sxs-lookup"><span data-stu-id="4da0c-393">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="4da0c-394">CountRows</span><span class="sxs-lookup"><span data-stu-id="4da0c-394">CountRows</span></span>](report-builder-functions-countrows-function.md)|<span data-ttu-id="4da0c-395">NULL 値の行を含めて、指定されたスコープ内の行数を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-395">Returns the number of rows in the specified scope, including rows with null values.</span></span>|  
  
##  <a name="looking-up-values-from-another-dataset"></a><a name="LookupFunctions"></a><span data-ttu-id="4da0c-396">別のデータセットの値の参照</span><span class="sxs-lookup"><span data-stu-id="4da0c-396">Looking Up Values from Another Dataset</span></span>  
 <span data-ttu-id="4da0c-397">次の参照関数では、指定されたデータセットから値を取得します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-397">The following lookup functions retrieve values from a specified dataset.</span></span>  
  
|<span data-ttu-id="4da0c-398">**Function**</span><span class="sxs-lookup"><span data-stu-id="4da0c-398">**Function**</span></span>|<span data-ttu-id="4da0c-399">**説明**</span><span class="sxs-lookup"><span data-stu-id="4da0c-399">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="4da0c-400">Lookup 関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-400">Lookup Function</span></span>](report-builder-functions-lookup-function.md)|<span data-ttu-id="4da0c-401">データセットから、指定された式に対応する値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-401">Returns a value from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="4da0c-402">LookupSet 関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-402">LookupSet Function</span></span>](report-builder-functions-lookupset-function.md)|<span data-ttu-id="4da0c-403">データセットから、指定された式に対応する値のセットを返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-403">Returns a set of values from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="4da0c-404">Multilookup 関数</span><span class="sxs-lookup"><span data-stu-id="4da0c-404">Multilookup Function</span></span>](report-builder-functions-multilookup-function.md)|<span data-ttu-id="4da0c-405">名前と値のペアを含むデータセットから、名前のセットに最初に一致した値のセットを返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-405">Returns the set of first-match values for a set of names from a dataset that contains name/value pairs.</span></span>|  
  
##  <a name="retrieving-sort-dependent-values"></a><a name="RetrievingPostsortValues"></a><span data-ttu-id="4da0c-406">並べ替え依存の値の取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-406">Retrieving Sort-Dependent Values</span></span>  
 <span data-ttu-id="4da0c-407">次の組み込み関数は、指定されたスコープ内の最初、最後、または前の値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-407">The following built-in functions return the first, last, or previous value within a given scope.</span></span> <span data-ttu-id="4da0c-408">これらの関数は、データ値の並べ替え順序に依存します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-408">These functions depend on the sort order of the data values.</span></span> <span data-ttu-id="4da0c-409">たとえば、これらの関数を使用すると、ページの最初の値と最後の値を検出して、辞書形式のページ ヘッダーを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-409">Use these functions, for example, to find the first and last values on a page to create a dictionary-style page header.</span></span> <span data-ttu-id="4da0c-410">また、`Previous` を使用すると、特定のスコープ内のある行の値と前の行の値を比較し、テーブルの前年比の比率を検出する処理などを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-410">Use `Previous` to compare a value in one row to the previous row's value within a specific scope, for example, to find percentage year over year values in a table.</span></span>  
  
|<span data-ttu-id="4da0c-411">**Function**</span><span class="sxs-lookup"><span data-stu-id="4da0c-411">**Function**</span></span>|<span data-ttu-id="4da0c-412">**説明**</span><span class="sxs-lookup"><span data-stu-id="4da0c-412">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="4da0c-413">First</span><span class="sxs-lookup"><span data-stu-id="4da0c-413">First</span></span>](report-builder-functions-first-function.md)|<span data-ttu-id="4da0c-414">指定された式の指定されたスコープの最初の値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-414">Returns the first value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="4da0c-415">前の</span><span class="sxs-lookup"><span data-stu-id="4da0c-415">Last</span></span>](report-builder-functions-last-function.md)|<span data-ttu-id="4da0c-416">指定された式の指定されたスコープの最後の値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-416">Returns the last value in the given scope of the specified expression.</span></span>|  
|<span data-ttu-id="4da0c-417">[[戻る]](report-builder-functions-previous-function.md)</span><span class="sxs-lookup"><span data-stu-id="4da0c-417">[Previous](report-builder-functions-previous-function.md)</span></span>|<span data-ttu-id="4da0c-418">アイテムの、指定されたスコープ内の直前のインスタンスに対応する値または指定された集計値を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-418">Returns the value or the specified aggregate value for the previous instance of an item within the specified scope.</span></span>|  
  
##  <a name="retrieving-server-aggregates"></a><a name="RetrievingServerAggregates"></a><span data-ttu-id="4da0c-419">サーバー集計の取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-419">Retrieving Server Aggregates</span></span>  
 <span data-ttu-id="4da0c-420">次の組み込み関数は、データ プロバイダーからカスタム集計を取得します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-420">The following built-in function retrieves custom aggregates from the data provider.</span></span> <span data-ttu-id="4da0c-421">たとえば、データ ソースの種類に [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] を使用すると、グループ ヘッダーで使用するために、データ ソース サーバーで計算された集計を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-421">For example, using an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data source type, you can retrieve aggregates calculated on the data source server for use in a group header.</span></span>  
  
|<span data-ttu-id="4da0c-422">**Function**</span><span class="sxs-lookup"><span data-stu-id="4da0c-422">**Function**</span></span>|<span data-ttu-id="4da0c-423">**説明**</span><span class="sxs-lookup"><span data-stu-id="4da0c-423">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="4da0c-424">集計</span><span class="sxs-lookup"><span data-stu-id="4da0c-424">Aggregate</span></span>](report-builder-functions-aggregate-function.md)|<span data-ttu-id="4da0c-425">データ プロバイダーの定義に従い、指定された式のカスタムの集計を返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-425">Returns a custom aggregate of the specified expression, as defined by the data provider.</span></span>|  
  
##  <a name="testing-for-scope"></a><a name="TestingforScope"></a><span data-ttu-id="4da0c-426">スコープのテスト</span><span class="sxs-lookup"><span data-stu-id="4da0c-426">Testing for Scope</span></span>  
 <span data-ttu-id="4da0c-427">次の組み込み関数は、レポート アイテムの現在のコンテキストをテストし、それが特定のスコープのメンバーかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-427">The following built-in function tests the current context of a report item to see if it is a member of a specific scope.</span></span>  
  
|<span data-ttu-id="4da0c-428">機能</span><span class="sxs-lookup"><span data-stu-id="4da0c-428">Function</span></span>|<span data-ttu-id="4da0c-429">説明</span><span class="sxs-lookup"><span data-stu-id="4da0c-429">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="4da0c-430">InScope</span><span class="sxs-lookup"><span data-stu-id="4da0c-430">InScope</span></span>](report-builder-functions-inscope-function.md)|<span data-ttu-id="4da0c-431">アイテムの現在のインスタンスが、指定したスコープ内にあるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-431">Indicates whether the current instance of an item is within the specified scope.</span></span>|  
  
##  <a name="retrieving-recursive-level"></a><a name="RetrievingRecursiveLevel"></a><span data-ttu-id="4da0c-432">再帰レベルの取得</span><span class="sxs-lookup"><span data-stu-id="4da0c-432">Retrieving Recursive Level</span></span>  
 <span data-ttu-id="4da0c-433">次の組み込み関数は、再帰型階層が処理されたときの現在のレベルを取得します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-433">The following built-in function retrieves the current level when a recursive hierarchy is processed.</span></span> <span data-ttu-id="4da0c-434">テキスト ボックスの `Padding` プロパティに対してこの関数の結果を使用して、再帰グループの階層構造のインデント レベルを制御できます。</span><span class="sxs-lookup"><span data-stu-id="4da0c-434">Use the result of this function with the `Padding` property in a text box to control the indent level of a visual hierarchy for a recursive group.</span></span> <span data-ttu-id="4da0c-435">詳細については、「[複数の再帰型階層グループの作成 &#40;レポート ビルダーおよび SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4da0c-435">For more information, see [Creating Recursive Hierarchy Groups &#40;Report Builder and SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span></span>  
  
|<span data-ttu-id="4da0c-436">Function</span><span class="sxs-lookup"><span data-stu-id="4da0c-436">Function</span></span>|<span data-ttu-id="4da0c-437">説明</span><span class="sxs-lookup"><span data-stu-id="4da0c-437">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="4da0c-438">Level</span><span class="sxs-lookup"><span data-stu-id="4da0c-438">Level</span></span>](report-builder-functions-level-function.md)|<span data-ttu-id="4da0c-439">再帰型階層の現在の深さのレベルを返します。</span><span class="sxs-lookup"><span data-stu-id="4da0c-439">Returns the current level of depth in a recursive hierarchy.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4da0c-440">参照</span><span class="sxs-lookup"><span data-stu-id="4da0c-440">See Also</span></span>  
 <span data-ttu-id="4da0c-441">[レポートでの式の使用 &#40;レポートビルダーと SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4da0c-441">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="4da0c-442">[式の例 (レポート ビルダーおよび SSRS)](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4da0c-442">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="4da0c-443">合計、集計、および組み込みコレクションの式のスコープ (レポート ビルダーおよび SSRS)</span><span class="sxs-lookup"><span data-stu-id="4da0c-443">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  
  
  
