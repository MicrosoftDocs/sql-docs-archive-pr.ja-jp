---
title: レポートとリソースの保護 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- security [Reporting Services], reports
- security [Reporting Services], resources
- reports [Reporting Services], security
- confidential reports [Reporting Services]
- resources [Reporting Services], security
ms.assetid: 63cd55c7-fd2a-49e3-a3f8-59eb1a1c6e83
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 6c8eef86da2fe9c7dcc92488a08516a73aa37e92
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87641436"
---
# <a name="secure-reports-and-resources"></a><span data-ttu-id="32288-102">レポートとリソースの保護</span><span class="sxs-lookup"><span data-stu-id="32288-102">Secure Reports and Resources</span></span>
  <span data-ttu-id="32288-103">各レポートおよびリソースのセキュリティを設定して、これらのアイテムへのユーザーのアクセスのレベルを制御できます。</span><span class="sxs-lookup"><span data-stu-id="32288-103">You can set security for individual reports and resources to control the degree of access that users have to these items.</span></span> <span data-ttu-id="32288-104">既定では、組み込みの **Administrators** グループのメンバーであるユーザーのみ、レポートの実行、リソースの表示、プロパティの変更、およびアイテムの削除を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="32288-104">By default, only users who are members of the **Administrators** built-in group can run reports, view resources, modify properties, and delete the items.</span></span> <span data-ttu-id="32288-105">他のすべてのユーザーについては、レポートまたはリソースへのアクセスを許可するロール割り当てを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="32288-105">All other users must have role assignments created for them that allow access to a report or resource.</span></span>  
  
## <a name="role-based-access-to-reports-and-resources"></a><span data-ttu-id="32288-106">レポートおよびリソースへのロールベースのアクセス</span><span class="sxs-lookup"><span data-stu-id="32288-106">Role-based Access to Reports and Resources</span></span>  
 <span data-ttu-id="32288-107">レポートおよびリソースへのアクセスを許可するために、既存のロール割り当てを親フォルダーからユーザーに継承させることも、アイテム自体に新しいロール割り当てを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="32288-107">To grant access to reports and resources, you can allow users to inherit existing role assignments from a parent folder or create a new role assignment on the item itself.</span></span>  
  
 <span data-ttu-id="32288-108">多くの場合は、親フォルダーから継承した権限を使用します。</span><span class="sxs-lookup"><span data-stu-id="32288-108">In most cases, you will probably want to use the permissions that are inherited from a parent folder.</span></span> <span data-ttu-id="32288-109">個々のレポートやリソースにセキュリティを設定する必要が生じるのは、レポートまたはリソースの存在を知る必要がないユーザーからそのレポートまたはリソースを隠す場合や、レポートまたはアイテムへのアクセス レベルを上げる場合のみです。</span><span class="sxs-lookup"><span data-stu-id="32288-109">Setting security on individual reports and resources should only be necessary if you want to hide the report or resource from users who do not need to know that the report or resource exists, or to increase the level of access for a report or item.</span></span> <span data-ttu-id="32288-110">これらの目的は、共存することができます。</span><span class="sxs-lookup"><span data-stu-id="32288-110">These objectives are not mutually exclusive.</span></span> <span data-ttu-id="32288-111">レポートへのアクセスを少数のユーザーに制限し、そのユーザーのすべてまたは一部に、レポートを管理する追加の権限を与えることができます。</span><span class="sxs-lookup"><span data-stu-id="32288-111">You can restrict access to a report to a smaller set of users, and provide all or some of them with additional privileges to manage the report.</span></span>  
  
 <span data-ttu-id="32288-112">目的を達成するには、複数のロールの割り当てを作成する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="32288-112">You may need to create multiple role assignments to achieve your objectives.</span></span> <span data-ttu-id="32288-113">たとえば、2 人のユーザー Ann と Fernando、および Human Resource Managers グループがアクセス権を持つレポートを作成するとします。</span><span class="sxs-lookup"><span data-stu-id="32288-113">For example, suppose you have a report that you want to make accessible to two users, Ann and Fernando, and to the Human Resource Managers group.</span></span> <span data-ttu-id="32288-114">Ann と Fernando はレポートを管理できる必要がありますが、Human Resource Managers のメンバーはレポートの実行だけが必要です。</span><span class="sxs-lookup"><span data-stu-id="32288-114">Ann and Fernando must be able to manage the report, but the Human Resource Managers members need only to run it.</span></span> <span data-ttu-id="32288-115">これらすべてのユーザーの要件を満たすには、Ann と Fernando をそれぞれレポートのコンテンツ マネージャーに設定し、Human Resource Managers グループに対して表示専用のタスクをサポートする、個別のロールの割り当てを 3 つ作成します。</span><span class="sxs-lookup"><span data-stu-id="32288-115">To accommodate all of these users, you would create three separate role assignments: one to make Ann a content manager of the report, one to make Fernando a content manager of the report, and one to support view-only tasks for the Human Resource Managers group.</span></span>  
  
 <span data-ttu-id="32288-116">レポートまたはリソースにセキュリティを設定すると、そのアイテムを新しい場所に移動しても、その設定は持続します。</span><span class="sxs-lookup"><span data-stu-id="32288-116">Once you set security on a report or resource, those settings stay with the item even if you move the item to a new location.</span></span> <span data-ttu-id="32288-117">たとえば、少数のユーザーのみがアクセス権を与えられているレポートを移動する場合、比較的制限の少ないセキュリティ ポリシーを持つフォルダーに移動しても、引き続きその少数のユーザーのみがレポートにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="32288-117">For example, if you move a report that only a few people are authorized to access, the report continues to be available to just those users even if you move it to a folder that has a relatively open security policy.</span></span>  
  
## <a name="mitigating-html-injection-attacks-in-a-published-report-or-document"></a><span data-ttu-id="32288-118">パブリッシュしたレポートまたはドキュメント内の HTML インジェクション攻撃の緩和</span><span class="sxs-lookup"><span data-stu-id="32288-118">Mitigating HTML Injection Attacks in a Published Report or Document</span></span>  
 <span data-ttu-id="32288-119">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]では、レポートとリソースは、レポートを実行しているユーザーのセキュリティ ID で処理されます。</span><span class="sxs-lookup"><span data-stu-id="32288-119">In [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], reports and resources are processed under the security identity of the user who is running the report.</span></span> <span data-ttu-id="32288-120">式、スクリプト、カスタム レポート アイテム、またはカスタム アセンブリがレポートに含まれる場合、ユーザーの資格情報でコードが実行されます。</span><span class="sxs-lookup"><span data-stu-id="32288-120">If the report contains expressions, script, custom report items, or custom assemblies, the code runs under the user's credentials.</span></span> <span data-ttu-id="32288-121">リソースがスクリプトを含む HTML ドキュメントである場合、ユーザーがレポート サーバーでドキュメントを開く際にスクリプトが実行されます。</span><span class="sxs-lookup"><span data-stu-id="32288-121">If a resource is an HTML document that contains script, the script will run when the user opens the document on the report server.</span></span> <span data-ttu-id="32288-122">レポート内のスクリプトまたはコードの実行は、ある程度のリスクを伴う強力な機能です。</span><span class="sxs-lookup"><span data-stu-id="32288-122">The ability to run script or code within a report is a powerful feature that comes with a certain level of risk.</span></span> <span data-ttu-id="32288-123">悪意のあるコードの場合、レポート サーバーおよびレポートを実行しているユーザーは、攻撃に対して脆弱な状態になります。</span><span class="sxs-lookup"><span data-stu-id="32288-123">If the code is malicious, the report server and the user who is running the report are vulnerable to attack.</span></span>  
  
 <span data-ttu-id="32288-124">HTML として処理されるレポートおよびリソースにアクセスする場合、レポートが完全信頼で処理され、悪意のあるスクリプトがクライアントに送信される可能性があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="32288-124">When granting access to reports and to resources that are processed as HTML, it is important to remember that reports are processed in full trust and that potentially malicious script might be sent to the client.</span></span> <span data-ttu-id="32288-125">ブラウザー設定に応じて、ブラウザーで指定されている信頼のレベルで、クライアントは HTML を実行します。</span><span class="sxs-lookup"><span data-stu-id="32288-125">Depending on browser settings, the client will execute the HTML at the level of trust that is specified in the browser.</span></span>  
  
 <span data-ttu-id="32288-126">次の予防策で、悪意のあるスクリプトを実行するリスクを緩和できます。</span><span class="sxs-lookup"><span data-stu-id="32288-126">You can mitigate the risk of running malicious script by taking the following precautions:</span></span>  
  
-   <span data-ttu-id="32288-127">コンテンツをレポート サーバーにパブリッシュできるユーザーは、慎重に選択して決定します。</span><span class="sxs-lookup"><span data-stu-id="32288-127">Be selective when deciding who can publish content to a report server.</span></span> <span data-ttu-id="32288-128">悪意のあるコンテンツがパブリッシュされる可能性があるので、コンテンツをパブリッシュできるユーザーは、少数の信頼されたユーザーに限定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="32288-128">Because the potential for publishing malicious content exists, you should limit users who can publish content to a small number of trusted users.</span></span>  
  
-   <span data-ttu-id="32288-129">すべてのパブリッシャーは、不明なソースや信頼されていないソースのレポートおよびリソースのパブリッシュを避ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="32288-129">All publishers should avoid publishing reports and resources that come from unknown or untrusted sources.</span></span> <span data-ttu-id="32288-130">必要に応じて、テキスト エディターでファイルを開き、疑わしいスクリプトや URL を探してください。</span><span class="sxs-lookup"><span data-stu-id="32288-130">If necessary, open the file in a text editor and look for suspicious script and URLs.</span></span>  
  
## <a name="report-parameters-and-script-injection"></a><span data-ttu-id="32288-131">レポート パラメーターおよびスクリプト インジェクション</span><span class="sxs-lookup"><span data-stu-id="32288-131">Report Parameters and Script Injection</span></span>  
 <span data-ttu-id="32288-132">レポート パラメーターを使用すると、レポートの全体的なデザインと実行の柔軟性が高まります。</span><span class="sxs-lookup"><span data-stu-id="32288-132">Report Parameters provide flexibility for the overall report design and execution.</span></span> <span data-ttu-id="32288-133">その一方で、こうした柔軟性がおびき寄せによる攻撃に悪用されることもあります。</span><span class="sxs-lookup"><span data-stu-id="32288-133">However, this same flexibility can, in some cases be used by an attacker in luring attacks.</span></span> <span data-ttu-id="32288-134">悪意のあるスクリプトを誤って実行するリスクを軽減するためには、信頼されたソースのレポートだけを開くようにしてください。</span><span class="sxs-lookup"><span data-stu-id="32288-134">To mitigate the risk of inadvertently running malicious scripts, only open rendered reports from trusted sources.</span></span> <span data-ttu-id="32288-135">次に、HTML レンダラーのスクリプト インジェクション攻撃が行われる可能性のあるシナリオを紹介します。検討してみることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="32288-135">It is recommended you consider the following scenario that is a potential HTML Renderer script injection attack:</span></span>  
  
1.  <span data-ttu-id="32288-136">レポートにテキスト ボックスが含まれており、そのハイパーリンク アクションが、悪意のあるテキストが含まれている可能性のあるパラメーターの値に設定されている。</span><span class="sxs-lookup"><span data-stu-id="32288-136">A report contains a text box with the hyperlink action set to the value of a parameter which could contain malicious text.</span></span>  
  
2.  <span data-ttu-id="32288-137">レポート サーバーにパブリッシュされたレポートやその他の方法で公開されたレポートのレポート パラメーターの値が、Web ページの URL から制御できる状態になっている。</span><span class="sxs-lookup"><span data-stu-id="32288-137">The report is published to a report server or otherwise made available in such a way that the report parameter value can be controlled from the URL of a web page.</span></span>  
  
3.  <span data-ttu-id="32288-138">攻撃者は、"javascript:" の形式でパラメーターの値を指定して、web ページまたはレポートサーバーへのリンクを作成 \<malicious script here> し、そのリンクをおとり攻撃の他のユーザーに送信します。</span><span class="sxs-lookup"><span data-stu-id="32288-138">An attacker creates a link to the web page or report server specifying the value of the parameter in the form "javascript:\<malicious script here>" and sends that link to someone else in a luring attack.</span></span>  
  
## <a name="mitigating-script-injection-attacks-in-a-hyperlink-in-a-published-report-or-document"></a><span data-ttu-id="32288-139">パブリッシュされたレポートまたはドキュメント内のハイパーリンクによるスクリプト インジェクション攻撃の緩和</span><span class="sxs-lookup"><span data-stu-id="32288-139">Mitigating Script Injection Attacks in a Hyperlink in a Published Report or Document</span></span>  
 <span data-ttu-id="32288-140">レポートには、レポート アイテムまたはレポート アイテムの一部の Action プロパティの値を使用して、ハイパーリンクが埋め込まれることがあります。</span><span class="sxs-lookup"><span data-stu-id="32288-140">Reports can contain embedded hyperlinks in the value of the Action property on a report item or part of a report item.</span></span> <span data-ttu-id="32288-141">ハイパーリンクは、レポートの処理時に外部データ ソースから取得されるデータにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="32288-141">Hyperlinks can be bound to data that is retrieved from an external data source when the report is processed.</span></span> <span data-ttu-id="32288-142">悪意のあるユーザーによって基になるデータが変更された場合、このハイパーリンクには、スクリプティング攻撃のリスクが生じます。</span><span class="sxs-lookup"><span data-stu-id="32288-142">If a malicious user modifies the underlying data, the hyperlink might be at risk for scripting exploits.</span></span> <span data-ttu-id="32288-143">パブリッシュまたはエクスポートされたレポート内のリンクをユーザーがクリックすると、悪意のあるスクリプトが実行される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="32288-143">If a user clicks the link in the published or exported report, malicious script could run.</span></span>  
  
 <span data-ttu-id="32288-144">レポート内のリンクによって悪意のあるスクリプトが誤って実行されるリスクを軽減するためには、信頼されたソースのデータにのみハイパーリンクをバインドします。</span><span class="sxs-lookup"><span data-stu-id="32288-144">To mitigate the risk of including links in a report that inadvertently run malicious scripts, only bind hyperlinks to data from trusted sources.</span></span> <span data-ttu-id="32288-145">悪用されるおそれのあるリンクがクエリ結果のデータやデータをハイパーリンクにバインドする式によって生成されないことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="32288-145">Verify that data from the query results and the expressions that bind data to hyperlinks do not create links that can be exploited.</span></span> <span data-ttu-id="32288-146">たとえば、複数のデータセット フィールドのデータを連結する式に基づくハイパーリンクは使用しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="32288-146">For example, do not base a hyperlink on an expression that concatenates data from multiple dataset fields.</span></span> <span data-ttu-id="32288-147">必要に応じてレポートを参照し、[ソースの表示] を使用して疑わしいスクリプトや URL がないかどうかを確認してください。</span><span class="sxs-lookup"><span data-stu-id="32288-147">If necessary, browse to the report and use "View Source" to check for suspicious scripts and URLs.</span></span>  
  
## <a name="mitigating-sql-injection-attacks-in-a-parameterized-report"></a><span data-ttu-id="32288-148">パラメーター化されたレポート内の SQL インジェクション攻撃の緩和</span><span class="sxs-lookup"><span data-stu-id="32288-148">Mitigating SQL Injection Attacks in a Parameterized Report</span></span>  
 <span data-ttu-id="32288-149">`String` 型のパラメーターが含まれるレポートでは、使用可能な値の一覧 (有効な値の一覧とも呼ばれています) を必ず使用してください。また、レポートを実行するすべてのユーザーに対して、レポート表示に必要な権限のみを与えてください。</span><span class="sxs-lookup"><span data-stu-id="32288-149">In any report that includes a parameter of type `String`, be sure to use an available values list (also known as a valid values list) and ensure that any user running the report has only the permissions required to view the data in the report.</span></span> <span data-ttu-id="32288-150">`String` 型のパラメーターを定義する際には、任意の値が許容されるテキスト ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="32288-150">When you define a parameter of type `String`, the user is presented with a text box that can take any value.</span></span> <span data-ttu-id="32288-151">使用可能な値の一覧を使用すると、入力できる値が制限されます。</span><span class="sxs-lookup"><span data-stu-id="32288-151">An available values list limits the values that can be entered.</span></span> <span data-ttu-id="32288-152">クエリ パラメーターにレポート パラメーターが関連付けられている場合に、使用可能な値の一覧を使用しなければ、レポート ユーザーはテキスト ボックスに SQL 構文を入力できるので、レポートとサーバーが SQL インジェクション攻撃を受ける危険性が生じます。</span><span class="sxs-lookup"><span data-stu-id="32288-152">If the report parameter is tied to a query parameter and you do not use an available values list, it is possible for a report user to type SQL syntax into the text box, potentially opening the report and your server to a SQL injection attack.</span></span> <span data-ttu-id="32288-153">さらに、ユーザーが新しい SQL ステートメントを実行するための十分な権限を持っている場合は、サーバーで予想外の結果が生じる可能性もあります。</span><span class="sxs-lookup"><span data-stu-id="32288-153">If the user has sufficient permissions to execute the new SQL statement, it may produce unwanted results on the server.</span></span>  
  
 <span data-ttu-id="32288-154">クエリ パラメーターと関連付けられていないレポート パラメーターがあり、このパラメーター値がレポートに含まれていると、レポート ユーザーが、式の構文または URL をパラメーター値に入力して、このレポートを Excel または HTML に変換することも可能になります。</span><span class="sxs-lookup"><span data-stu-id="32288-154">If a report parameter is not tied to a query parameter and the parameter values are included in the report, it is possible for a report user to type expression syntax or a URL into the parameter value and render the report to Excel or HTML.</span></span> <span data-ttu-id="32288-155">別のユーザーがこのレポートを表示して、表示されたパラメーター コンテンツをクリックすると、悪意のあるスクリプトまたはリンクが意図せず実行されてしまう可能性があります。</span><span class="sxs-lookup"><span data-stu-id="32288-155">If another user then views the report and clicks the rendered parameter contents, the user may inadvertently execute the malicious script or link.</span></span>  
  
 <span data-ttu-id="32288-156">悪意のあるスクリプトを誤って実行するリスクを軽減するためには、信頼されたソースのレポートしか開かないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="32288-156">To mitigate the risk of inadvertently running malicious scripts, open rendered reports only from trusted sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="32288-157">前のリリースのドキュメントでは、式として動的クエリを作成する例が記載されていました。</span><span class="sxs-lookup"><span data-stu-id="32288-157">In previous releases of the documentation, an example of creating a dynamic query as an expression was included.</span></span> <span data-ttu-id="32288-158">この種類のクエリは、SQL インジェクション攻撃への脆弱性が生じるので、推奨されていません。</span><span class="sxs-lookup"><span data-stu-id="32288-158">This type of query creates a vulnerability to SQL injection attacks and therefore is not recommended.</span></span>  
  
## <a name="securing-confidential-reports"></a><span data-ttu-id="32288-159">機密レポートの保護</span><span class="sxs-lookup"><span data-stu-id="32288-159">Securing Confidential Reports</span></span>  
 <span data-ttu-id="32288-160">機密情報を含むレポートは、重要なデータにアクセスするための資格情報の入力をユーザーに要求することによって、データアクセス レベルのセキュリティで保護する必要があります。</span><span class="sxs-lookup"><span data-stu-id="32288-160">Reports that contain confidential information should be secured at the data-access level, by requiring users to provide credentials to access sensitive data.</span></span> <span data-ttu-id="32288-161">詳細については、「 [レポート データ ソースに関する資格情報と接続情報を指定する](../report-data/specify-credential-and-connection-information-for-report-data-sources.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="32288-161">For more information, see [Specify Credential and Connection Information for Report Data Sources](../report-data/specify-credential-and-connection-information-for-report-data-sources.md).</span></span> <span data-ttu-id="32288-162">また、未承認のユーザーがアクセスできないように、フォルダーをセキュリティで保護することもできます。</span><span class="sxs-lookup"><span data-stu-id="32288-162">You can also secure a folder to make it inaccessible to unauthorized users.</span></span> <span data-ttu-id="32288-163">詳細については、「 [フォルダーをセキュリティで保護する](secure-folders.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="32288-163">For more information, see [Secure Folders](secure-folders.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="32288-164">参照</span><span class="sxs-lookup"><span data-stu-id="32288-164">See Also</span></span>  
 <span data-ttu-id="32288-165">(create-and-manage-role-assignments.md)</span><span class="sxs-lookup"><span data-stu-id="32288-165">(create-and-manage-role-assignments.md)</span></span>   
 <span data-ttu-id="32288-166">[レポートビルダーアクセスの構成](../report-server/configure-report-builder-access.md) </span><span class="sxs-lookup"><span data-stu-id="32288-166">[Configure Report Builder Access](../report-server/configure-report-builder-access.md) </span></span>  
 <span data-ttu-id="32288-167">[ネイティブ モードのレポート サーバーに対する権限の許可](granting-permissions-on-a-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="32288-167">[Granting Permissions on a Native Mode Report Server](granting-permissions-on-a-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="32288-168">[共有データソースアイテムをセキュリティで保護する](secure-shared-data-source-items.md) </span><span class="sxs-lookup"><span data-stu-id="32288-168">[Secure Shared Data Source Items](secure-shared-data-source-items.md) </span></span>  
 [<span data-ttu-id="32288-169">Store Credentials in a Reporting Services Data Source</span><span class="sxs-lookup"><span data-stu-id="32288-169">Store Credentials in a Reporting Services Data Source</span></span>](../report-data/store-credentials-in-a-reporting-services-data-source.md)  
  
  
