---
title: セキュリティ ポリシーの概要 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- code groups [Reporting Services]
- code access security [Reporting Services], security policies
- Execution permission set
- custom assemblies [Reporting Services], security
- permission sets [Reporting Services]
- expressions [Reporting Services], security
- evidence [Reporting Services]
- FullTrust permission set
- security policies [Reporting Services]
- named permission sets [Reporting Services]
ms.assetid: a9bf043a-139a-4929-9a58-244815323df0
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: e03f2ca7aae75f692ba2c888d1fb6bd3f60fb4a4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645400"
---
# <a name="understanding-security-policies"></a><span data-ttu-id="84169-102">セキュリティ ポリシーの概要</span><span class="sxs-lookup"><span data-stu-id="84169-102">Understanding Security Policies</span></span>
  <span data-ttu-id="84169-103">レポート サーバーが実行するすべてのコードは、特定のコード アクセス セキュリティ ポリシーの一部である必要があります。</span><span class="sxs-lookup"><span data-stu-id="84169-103">Any code that is executed by a report server must be part of a specific code access security policy.</span></span> <span data-ttu-id="84169-104">これらのセキュリティ ポリシーは、証拠と名前付き権限セットとを対応付けるコード グループで構成されます。</span><span class="sxs-lookup"><span data-stu-id="84169-104">These security policies consist of code groups that map evidence to a set of named permission sets.</span></span> <span data-ttu-id="84169-105">多くの場合、コード グループは、そのグループ内のコードに対して与えることのできる権限が指定された名前付き権限セットに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="84169-105">Often, code groups are associated with a named permission set that specifies the allowable permissions for code in that group.</span></span> <span data-ttu-id="84169-106">ランタイムは、信頼されるホストまたはローダーが提供した証拠を使用して、コードが属するコード グループ、およびコードに付与された権限を確認します。</span><span class="sxs-lookup"><span data-stu-id="84169-106">The runtime uses evidence provided by a trusted host or by the loader to determine which code groups the code belongs to and, therefore, which permissions to grant the code.</span></span> [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] <span data-ttu-id="84169-107">は、[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] の共通言語ランタイム (CLR) に定義されている、このセキュリティ ポリシー アーキテクチャに準拠しています。</span><span class="sxs-lookup"><span data-stu-id="84169-107">adheres to this security policy architecture as defined by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] common language runtime (CLR).</span></span> <span data-ttu-id="84169-108">ここでは、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] の各種コードおよび関連付けられたポリシー ルールについて説明します。</span><span class="sxs-lookup"><span data-stu-id="84169-108">The following sections describe the various types of code in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] and the policy rules associated with them.</span></span>  
  
## <a name="report-server-assemblies"></a><span data-ttu-id="84169-109">レポート サーバーのアセンブリ</span><span class="sxs-lookup"><span data-stu-id="84169-109">Report Server Assemblies</span></span>  
 <span data-ttu-id="84169-110">レポート サーバーのアセンブリには、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 製品の一部であるコードが含まれています。</span><span class="sxs-lookup"><span data-stu-id="84169-110">Report server assemblies are those that contain code that is part of the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] product.</span></span> [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] <span data-ttu-id="84169-111">はマネージド コード アセンブリを使用して記述されています。これらのアセンブリにはすべて厳密な名前が付けられています。つまり、デジタル署名されています。</span><span class="sxs-lookup"><span data-stu-id="84169-111">is written using managed code assemblies; all of these assemblies are strong-named (that is, digitally signed).</span></span> <span data-ttu-id="84169-112">これらのアセンブリのコード グループは、アセンブリの厳密な名前の公開キー情報に基づいて証拠を提供する **StrongNameMembershipCondition** を使用して定義されます。</span><span class="sxs-lookup"><span data-stu-id="84169-112">The code groups for these assemblies are defined using the **StrongNameMembershipCondition**, which provides evidence based on public key information for the assembly's strong name.</span></span> <span data-ttu-id="84169-113">コード グループには、**FullTrust** アクセス許可セットが付与されます。</span><span class="sxs-lookup"><span data-stu-id="84169-113">The code group is granted the **FullTrust** permission set.</span></span>  
  
## <a name="report-server-extensions-rendering-data-delivery-and-security"></a><span data-ttu-id="84169-114">レポート サーバーの拡張機能 (表示、データ、配信、およびセキュリティ)</span><span class="sxs-lookup"><span data-stu-id="84169-114">Report Server Extensions (Rendering, Data, Delivery, and Security)</span></span>  
 <span data-ttu-id="84169-115">レポート サーバーの拡張機能はカスタムのデータ、配信、表示、およびセキュリティ拡張機能であり、ユーザーまたは他のサード パーティが [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] の機能を強化するために作成します。</span><span class="sxs-lookup"><span data-stu-id="84169-115">Report server extensions are custom data, delivery, rendering, and security extensions that you or other third-parties create in order to extend the functionality of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="84169-116">このような拡張機能や機能強化する [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] コンポーネントに関連付けられたポリシー構成ファイルのアセンブリ コードには、**FullTrust** を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="84169-116">You must grant **FullTrust** to these extensions or assembly code in the policy configuration files associated with the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] component you are extending.</span></span> <span data-ttu-id="84169-117">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] の一部として出荷される拡張機能は、レポート サーバーの公開キーで署名され、**FullTrust** アクセス許可セットが付与されます。</span><span class="sxs-lookup"><span data-stu-id="84169-117">Extensions shipped as a part of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] are signed with the report server public key and receive the **FullTrust** permission set.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="84169-118">サード パーティの拡張機能では、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] のポリシー構成ファイルを修正して **FullTrust** を許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="84169-118">You must modify the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] policy configuration files to allow **FullTrust** for any third-party extensions.</span></span> <span data-ttu-id="84169-119">カスタム拡張機能用に **FullTrust** を持ったコード グループを追加しない限り、それらをレポート サーバーで使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="84169-119">If you do not add a code group with **FullTrust** for your custom extensions, they cannot be used by the report server.</span></span>  
  
 <span data-ttu-id="84169-120">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] のポリシー構成ファイルの詳細については、「[Reporting Services セキュリティ ポリシー ファイルの使用](using-reporting-services-security-policy-files.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="84169-120">For more information about the policy configuration files in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)], see [Using Reporting Services Security Policy Files](using-reporting-services-security-policy-files.md).</span></span>  
  
## <a name="expressions-used-in-reports"></a><span data-ttu-id="84169-121">レポートで使用される式</span><span class="sxs-lookup"><span data-stu-id="84169-121">Expressions Used in Reports</span></span>  
 <span data-ttu-id="84169-122">レポートの式は、インライン コード式またはレポート定義言語ファイルの **Code** 要素に含まれるユーザー定義メソッドです。</span><span class="sxs-lookup"><span data-stu-id="84169-122">Report expressions are inline code expressions or user-defined methods contained within the **Code** element of a report definition language file.</span></span> <span data-ttu-id="84169-123">ポリシー ファイルには、既定でこれらの式に **Execution** アクセス許可セットを付与する構成済みのコード グループがあります。</span><span class="sxs-lookup"><span data-stu-id="84169-123">There is a code group that is already configured in the policy files that grants these expressions the **Execution** permission set by default.</span></span> <span data-ttu-id="84169-124">このコード グループは次のようになっています。</span><span class="sxs-lookup"><span data-stu-id="84169-124">The code group looks like the following:</span></span>  
  
```  
<CodeGroup  
   class="UnionCodeGroup"  
   version="1"  
   PermissionSetName="Execution"  
   Name="Report_Expressions_Default_Permissions"  
   Description="This code group grants default permissions for code in report expressions and Code element. ">  
    <IMembershipCondition  
       class="StrongNameMembershipCondition"  
       version="1"  
       PublicKeyBlob="002400..."  
    />  
</CodeGroup>  
```  
  
 <span data-ttu-id="84169-125">**Execution** アクセス許可によってコードを実行できますが、保護されたリソースを使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="84169-125">**Execution** permission allows code to run (execute), but not to use protected resources.</span></span> <span data-ttu-id="84169-126">レポート内のすべての式はアセンブリ ("式のホスト" アセンブリ) にコンパイルされます。アセンブリはコンパイルされたレポートの一部として格納されます。</span><span class="sxs-lookup"><span data-stu-id="84169-126">All expressions found within a report are compiled into an assembly (called an "expression host" assembly) that is stored as a part of the compiled report.</span></span> <span data-ttu-id="84169-127">レポートを実行すると、レポート サーバーが式のホスト アセンブリを読み込み、そのアセンブリに対して、式を実行するための呼び出しを行います。</span><span class="sxs-lookup"><span data-stu-id="84169-127">When the report is executed, the report server loads the expression host assembly and makes calls into that assembly to execute expressions.</span></span> <span data-ttu-id="84169-128">式のホスト アセンブリは、式のホストすべてのコード グループの定義に使用される特定のキーで署名されます。</span><span class="sxs-lookup"><span data-stu-id="84169-128">Expression host assemblies are signed with a specific key that is used to define the code group for all expression hosts.</span></span>  
  
 <span data-ttu-id="84169-129">レポートの式はレポート オブジェクト モデル コレクション (フィールド、パラメーターなど) を参照し、算術演算や文字列操作などの単純なタスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="84169-129">Report expressions reference report object model collections (fields, parameters, etc.) and perform simple tasks like arithmetic and string operations.</span></span> <span data-ttu-id="84169-130">これらの単純な操作を実行するコードに必要なのは、**Execution** アクセス許可のみです。</span><span class="sxs-lookup"><span data-stu-id="84169-130">Code that performs these simple operations only requires **Execution** permission.</span></span> <span data-ttu-id="84169-131">既定では、**Code** 要素のユーザー定義メソッドとカスタム アセンブリには、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] の **Execution** アクセス許可が付与されます。</span><span class="sxs-lookup"><span data-stu-id="84169-131">By default, user-defined methods in the **Code** element and any custom assemblies are granted **Execution** permission in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="84169-132">したがって、現在の構成では、ほとんどの式に対してセキュリティ ポリシー ファイルを修正する必要がありません。</span><span class="sxs-lookup"><span data-stu-id="84169-132">Thus, for most expressions, the current configuration does not require that you modify any security policy files.</span></span> <span data-ttu-id="84169-133">式のホスト アセンブリに追加権限を付与するには、管理者がレポート サーバーとレポート デザイナーのポリシー構成ファイルを修正し、レポート式のコード グループを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="84169-133">To grant additional permissions to expression host assemblies, an administrator needs to modify the policy configuration files of the report server and Report Designer, and change the report expressions code group.</span></span> <span data-ttu-id="84169-134">グローバル設定であるため、式のホストの既定の権限を変更すると、すべてのレポートに影響します。</span><span class="sxs-lookup"><span data-stu-id="84169-134">Because it is a global setting, changing default permissions for the expression hosts affects all reports.</span></span> <span data-ttu-id="84169-135">この理由から、追加セキュリティを必要とするすべてのコードをカスタム アセンブリ内に配置することを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="84169-135">For this reason, it is highly recommended that you place all code that requires additional security into a custom assembly.</span></span> <span data-ttu-id="84169-136">必要な権限は、このアセンブリにのみ付与します。</span><span class="sxs-lookup"><span data-stu-id="84169-136">Only this assembly will be granted the permissions you need.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="84169-137">外部のアセンブリや保護されたリソースを呼び出すコードは、レポートで使用するカスタム アセンブリに組み込んでください。</span><span class="sxs-lookup"><span data-stu-id="84169-137">Code that calls external assemblies or protected resources should be incorporated into a custom assembly for use in reports.</span></span> <span data-ttu-id="84169-138">そうすることで、コードが要求および表明する権限をより細かく制御できるようになります。</span><span class="sxs-lookup"><span data-stu-id="84169-138">Doing so gives you more control over the permissions requested and asserted by your code.</span></span> <span data-ttu-id="84169-139">**Code** 要素内から、セキュリティで保護されたメソッドを呼び出すことは避けてください。</span><span class="sxs-lookup"><span data-stu-id="84169-139">You should not make calls to secure methods within the **Code** element.</span></span> <span data-ttu-id="84169-140">そのようにした場合、レポート式のホストに **FullTrust** を付与する必要があり、すべてのカスタム コードに CLR への完全なアクセス権が付与されます。</span><span class="sxs-lookup"><span data-stu-id="84169-140">Doing so requires you to grant **FullTrust** to the report expression host and grants all custom code full access to the CLR.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="84169-141">レポート式のホストのコード グループに **FullTrust** を付与しないでください。</span><span class="sxs-lookup"><span data-stu-id="84169-141">Do not grant **FullTrust** to the code group for a report expression host.</span></span> <span data-ttu-id="84169-142">付与した場合は、すべてのレポート式に、保護されたシステム呼び出しを許すことになります。</span><span class="sxs-lookup"><span data-stu-id="84169-142">If you do, you enable all report expressions to make protected system calls.</span></span>  
  
## <a name="custom-assemblies-referenced-in-reports"></a><span data-ttu-id="84169-143">レポートで参照されるカスタム アセンブリ</span><span class="sxs-lookup"><span data-stu-id="84169-143">Custom Assemblies Referenced in Reports</span></span>  
 <span data-ttu-id="84169-144">一部のレポート式ではサード パーティのコード アセンブリを呼び出すことができます。[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] では、これをカスタム アセンブリとも呼びます。</span><span class="sxs-lookup"><span data-stu-id="84169-144">Some report expressions can call third-party code assemblies, also known in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] as custom assemblies.</span></span> <span data-ttu-id="84169-145">レポート サーバーは、これらのアセンブリがポリシー構成ファイルに少なくとも **Execution** アクセス許可を持っていることを想定しています。</span><span class="sxs-lookup"><span data-stu-id="84169-145">The report server expects these assemblies to have at least **Execution** permission in the policy configuration files.</span></span> <span data-ttu-id="84169-146">既定では、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] に付属のポリシー ファイルでは、"My Computer" ゾーンから起動されたすべてのアセンブリに **Execution** アクセス許可が付与されます。</span><span class="sxs-lookup"><span data-stu-id="84169-146">By default, policy files that ship with [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] grant **Execution** permission to all assemblies starting from the 'My Computer' zone.</span></span> <span data-ttu-id="84169-147">カスタム アセンブリには、必要に応じて追加権限を付与できます。</span><span class="sxs-lookup"><span data-stu-id="84169-147">You can grant additional permissions to custom assemblies as needed.</span></span>  
  
 <span data-ttu-id="84169-148">レポート式の中で、特定のコード権限を必要とする操作を実行しなければならない場合もあります。</span><span class="sxs-lookup"><span data-stu-id="84169-148">In some cases, you may need to perform an operation that requires specific code permissions in a report expression.</span></span> <span data-ttu-id="84169-149">典型的な例としては、セキュリティで保護された CLR ライブラリ メソッド (ファイルやシステム レジストリにアクセスするもの) をレポート式から呼び出す場合が挙げられます。</span><span class="sxs-lookup"><span data-stu-id="84169-149">Typically, this means that a report expression needs to make a call to a secured CLR library method (such as one that accesses files or the system registry).</span></span> <span data-ttu-id="84169-150">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] のドキュメントには、このようなセキュリティで保護された呼び出しに必要なコード権限が記載されています。呼び出しを実行するには、セキュリティで保護された特定の権限を呼び出し元コードに付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="84169-150">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] documentation describes the code permissions that are required to make this secure call; to execute the call, the calling code must be granted these specific, secure permissions.</span></span> <span data-ttu-id="84169-151">レポートの式または **Code** 要素から呼び出す場合は、式のホスト アセンブリに適切なアクセス許可を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="84169-151">If you make the call from a report expression or the **Code** element, the expression host assembly must be granted the appropriate permissions.</span></span> <span data-ttu-id="84169-152">ただし、式のホストに権限を付与すると、あらゆる式とレポートで実行するすべてのコードに特定の権限が付与されます。</span><span class="sxs-lookup"><span data-stu-id="84169-152">However, once you grant the expression host the permissions, all code that runs in any expression in any report is now granted that specific permission.</span></span> <span data-ttu-id="84169-153">このような呼び出しはカスタム アセンブリから行うようにし、そのカスタム アセンブリに特定の権限を付与する方が、安全性は高くなります。</span><span class="sxs-lookup"><span data-stu-id="84169-153">It is much more secure to make the call from a custom assembly and grant that custom assembly the specific permissions.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="84169-154">参照</span><span class="sxs-lookup"><span data-stu-id="84169-154">See Also</span></span>  
 <span data-ttu-id="84169-155">[Reporting Services のコード アクセス セキュリティ](code-access-security-in-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="84169-155">[Code Access Security in Reporting Services](code-access-security-in-reporting-services.md) </span></span>  
 [<span data-ttu-id="84169-156">セキュリティで保護された開発 &#40;Reporting Services&#41;</span><span class="sxs-lookup"><span data-stu-id="84169-156">Secure Development &#40;Reporting Services&#41;</span></span>](secure-development-reporting-services.md)  
  
  
