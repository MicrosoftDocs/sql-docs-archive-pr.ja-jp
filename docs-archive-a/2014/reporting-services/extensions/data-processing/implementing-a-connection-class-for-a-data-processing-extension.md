---
title: データ処理拡張機能の Connection クラスの実装 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- connections [Reporting Services], data processing extensions
- Connection class
- data processing extensions [Reporting Services], connections
ms.assetid: 7047d29e-a2c9-4e6f-ad02-635851a38ed7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 84caac40ec8df198d5c26ed89bf35fad71ad914f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87741589"
---
# <a name="implementing-a-connection-class-for-a-data-processing-extension"></a><span data-ttu-id="3f508-102">データ処理拡張機能の Connection クラスの実装</span><span class="sxs-lookup"><span data-stu-id="3f508-102">Implementing a Connection Class for a Data Processing Extension</span></span>
  <span data-ttu-id="3f508-103">**Connection** オブジェクトはデータベース接続や類似するリソースを表す、ユーザーにとっての [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] データ処理拡張機能の出発点です。</span><span class="sxs-lookup"><span data-stu-id="3f508-103">The **Connection** object represents a database connection or similar resource and is the starting point for users of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="3f508-104">このオブジェクトはデータベース サーバーへの接続を表しますが、類似する動作を持つエンティティが **Connection** として表示される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3f508-104">It represents connections to database servers, though any entity with similar behavior can be exposed as a **Connection**.</span></span>  
  
 <span data-ttu-id="3f508-105">**Connection** オブジェクトを実装するには、<xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> を実装し、オプションで <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> を実装するクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="3f508-105">To implement a **Connection** object, create a class that implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and optionally implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span>  
  
 <span data-ttu-id="3f508-106">実装では、接続が作成され、開かれていることを確認した後でコマンドを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3f508-106">In your implementation, you must ensure that a connection is created and opened before commands can be executed.</span></span> <span data-ttu-id="3f508-107">実装にはクライアントが接続を明示的に開閉する必要があります。実装がクライアントの接続を暗黙的に開閉するのではありません。</span><span class="sxs-lookup"><span data-stu-id="3f508-107">Ensure that your implementation requires clients to open and close connections explicitly, rather than having your implementation open and close connections implicitly for the client.</span></span> <span data-ttu-id="3f508-108">接続を取得したら、セキュリティ チェックを実行します。</span><span class="sxs-lookup"><span data-stu-id="3f508-108">Perform your security checks when the connection is obtained.</span></span> <span data-ttu-id="3f508-109">[!INCLUDE[ssRS](../../../includes/ssrs.md)] データ処理拡張機能で他のクラスの既存接続が必要な場合は、データ ソースの操作時にセキュリティ チェックが常に確実に実行されるようにします。</span><span class="sxs-lookup"><span data-stu-id="3f508-109">Requiring an existing connection for the other classes in your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension will then ensure that security checks are always performed when working with your data source.</span></span>  
  
 <span data-ttu-id="3f508-110">該当する接続のプロパティは、接続文字列として表されます。</span><span class="sxs-lookup"><span data-stu-id="3f508-110">The properties of the desired connection are represented as a connection string.</span></span> <span data-ttu-id="3f508-111">OLE DB によって定義されている使い慣れた名前と値のペアを使用して、[!INCLUDE[ssRS](../../../includes/ssrs.md)] データ処理拡張機能で <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> プロパティをサポートすることを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3f508-111">It is strongly recommended that [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions support the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> property using the familiar name/value pair system defined by OLE DB.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3f508-112">**Connection** オブジェクトの取得にリソースが大きく消費されることがあるため、接続のプールなどの技法を検討してこの問題を緩和してください。</span><span class="sxs-lookup"><span data-stu-id="3f508-112">**Connection** objects are often resource-intensive to obtain, so you may want to consider pooling connections or other techniques to mitigate this.</span></span>  
  
 <span data-ttu-id="3f508-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> は、<xref:Microsoft.ReportingServices.Interfaces.IExtension> から継承されます。</span><span class="sxs-lookup"><span data-stu-id="3f508-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> inherits from <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="3f508-114"><xref:Microsoft.ReportingServices.Interfaces.IExtension> インターフェイスは、Connection クラス実装の一部として実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3f508-114">You must implement the <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface as part of your connection class implementation.</span></span> <span data-ttu-id="3f508-115"><xref:Microsoft.ReportingServices.Interfaces.IExtension> インターフェイスによって、クラスがローカライズされた拡張機能名を実装し、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 構成ファイルに格納された拡張機能固有の構成情報を処理できるようになります。</span><span class="sxs-lookup"><span data-stu-id="3f508-115">The <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface enables a class to implement a localized extension name and to process extension-specific configuration information stored in the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] configuration file.</span></span>  
  
 <span data-ttu-id="3f508-116"><xref:Microsoft.ReportingServices.Interfaces.IExtension> の実装によって、**Connection** オブジェクトに <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> プロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3f508-116">Your **Connection** object contains the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property through its implementation of <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="3f508-117">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] データ処理拡張機能で <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> プロパティをサポートすることを強くお勧めします。これにより、レポート マネージャーなどのユーザー インターフェイスの拡張機能に、ローカライズされた使い慣れた名前がユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="3f508-117">It is strongly recommended that [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extensions support the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property, so that users encounter a familiar, localized name for the extension in a user interface, such as Report Manager.</span></span>  
  
 <span data-ttu-id="3f508-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> によって、**Connection** オブジェクトが RSReportServer.config ファイルに格納されたカスタム構成データを取得し、処理することもできます。</span><span class="sxs-lookup"><span data-stu-id="3f508-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> also enables your **Connection** object to retrieve and process custom configuration data stored in the RSReportServer.config file.</span></span> <span data-ttu-id="3f508-119">カスタム構成データの処理の詳細については、<xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> メソッドを参照してください。</span><span class="sxs-lookup"><span data-stu-id="3f508-119">For more information about processing custom configuration data, see the <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> method.</span></span>  
  
 <span data-ttu-id="3f508-120"><xref:Microsoft.ReportingServices.Interfaces.IExtension> を実装するクラスは、残りのデータ処理拡張機能のクラスが読み込まれていない場合は、メモリから読み込まれません。</span><span class="sxs-lookup"><span data-stu-id="3f508-120">The class that implements <xref:Microsoft.ReportingServices.Interfaces.IExtension> is not unloaded from memory when the rest of your data processing extension classes are unloaded.</span></span> <span data-ttu-id="3f508-121">このため、**Extension** クラスを使用して、相互接続状態の情報を格納することや、キャッシュできるデータをメモリに格納することができます。</span><span class="sxs-lookup"><span data-stu-id="3f508-121">Because of this, you can use your **Extension** class to store cross-connection state information or to store data that can be cached in memory.</span></span> <span data-ttu-id="3f508-122">**Extension** クラスは、レポート サーバーを実行中はメモリに残ります。</span><span class="sxs-lookup"><span data-stu-id="3f508-122">Your **Extension** class remains in memory as long as the report server is running.</span></span>  
  
 <span data-ttu-id="3f508-123"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> を実装することによって、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] の資格情報のサポートを含むように **Connection** クラスを拡張できます。</span><span class="sxs-lookup"><span data-stu-id="3f508-123">You can extend your **Connection** class to include support for credentials in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] by implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span> <span data-ttu-id="3f508-124"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> インターフェイスの <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>、<xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A>、および <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> の各プロパティを実装する場合は、レポート デザイナーの **[データ ソース]** ダイアログ ボックスで **[統合セキュリティ]** チェック ボックスをオンにし、**[ユーザー名]** ボックスと **[パスワード]** ボックスに必要な情報を入力します。</span><span class="sxs-lookup"><span data-stu-id="3f508-124">When you implement the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A>, and <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> properties of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> interface, you enable the **Integrated Security** check box and **Username** and **Password** text boxes of the **Data Source** dialog in Report Designer.</span></span> <span data-ttu-id="3f508-125">これによって、レポート デザイナーは承認をサポートするデータ ソースの資格情報を格納および取得できます。</span><span class="sxs-lookup"><span data-stu-id="3f508-125">This enables Report Designer to store and retrieve credentials for data sources that support authentication.</span></span> <span data-ttu-id="3f508-126">資格情報は、セキュリティによって保護されて格納され、プレビュー モードでレポートを表示する場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="3f508-126">The credentials are stored securely and used when rendering reports in preview mode.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3f508-127"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> を暗黙的に実装するには、<xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> インターフェイスと <xref:Microsoft.ReportingServices.Interfaces.IExtension> インターフェイスのメンバーを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3f508-127">Implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implicitly requires you to implement the members of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and <xref:Microsoft.ReportingServices.Interfaces.IExtension> interfaces.</span></span>  
>   
>  <span data-ttu-id="3f508-128">**Connection** クラス実装の例については、「[SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889)」 (SQL Server Reporting Services の製品サンプル) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3f508-128">For a sample **Connection** class implementation, see [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f508-129">参照</span><span class="sxs-lookup"><span data-stu-id="3f508-129">See Also</span></span>  
 <span data-ttu-id="3f508-130">[Reporting Services の拡張機能](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="3f508-130">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="3f508-131">[データ処理拡張機能の実装](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="3f508-131">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="3f508-132">Reporting Services 拡張機能ライブラリ</span><span class="sxs-lookup"><span data-stu-id="3f508-132">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
