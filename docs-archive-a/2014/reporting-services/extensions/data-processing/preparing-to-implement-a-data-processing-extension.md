---
title: データ処理拡張機能を実装する準備 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- interfaces [Reporting Services]
- data processing extensions [Reporting Services], implementing
ms.assetid: 698817e4-33da-4eb5-9407-4103e1c35247
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: a3588aea825233631cb4ad7752919ad88bb4dbf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87741582"
---
# <a name="preparing-to-implement-a-data-processing-extension"></a><span data-ttu-id="a998a-102">データ処理拡張機能を実装する準備</span><span class="sxs-lookup"><span data-stu-id="a998a-102">Preparing to Implement a Data Processing Extension</span></span>
  <span data-ttu-id="a998a-103">ご自分の [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] データ処理拡張機能を実装する前に、実装するインターフェイスを定義しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="a998a-103">Before you implement your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension, you should define the interfaces to implement.</span></span> <span data-ttu-id="a998a-104">インターフェイスのセット全体にわたって拡張機能固有の実装を行うことができます。<xref:Microsoft.ReportingServices.DataProcessing.IDataReader> インターフェイスや <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand> インターフェイスなど、サブセットだけを実装することもできます。このようなインターフェイスでは、クライアントが **DataReader** オブジェクトとして主に結果セットと対話し、[!INCLUDE[ssRS](../../../includes/ssrs.md)] データ処理拡張機能を結果セットとデータ ソース間のブリッジとして使用します。</span><span class="sxs-lookup"><span data-stu-id="a998a-104">You may want to provide extension-specific implementations of the entire set of interfaces, or you may simply want to focus your implementation on a subset, such as the <xref:Microsoft.ReportingServices.DataProcessing.IDataReader> and <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand> interfaces in which clients would interact primarily with a result set as a **DataReader** object and would use your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension as a bridge between the result set and your data source.</span></span>  
  
 <span data-ttu-id="a998a-105">データ処理拡張機能は、次の 2 種類の方法のいずれかで実装できます。</span><span class="sxs-lookup"><span data-stu-id="a998a-105">You can implement data processing extensions in one of two ways:</span></span>  
  
-   <span data-ttu-id="a998a-106">お使いのデータ処理拡張機能のクラスに [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] データ プロバイダー インターフェイスを実装します。オプションで [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] が提供する拡張されたデータ処理拡張機能インターフェイス実装します。</span><span class="sxs-lookup"><span data-stu-id="a998a-106">Your data processing extension classes can implement the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] data provider interfaces and optionally the extended data processing extension interfaces provided by [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="a998a-107">データ処理拡張機能のクラスは、[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] によって提供されるデータ処理拡張機能インターフェイスを実装でき、拡張されたデータ処理拡張機能インターフェイスをオプションで実装できます。</span><span class="sxs-lookup"><span data-stu-id="a998a-107">Your data processing extension classes can implement the data processing extension interfaces provided by [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] and optionally the extended data processing extension interfaces.</span></span>  
  
 <span data-ttu-id="a998a-108">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] データ処理拡張機能が特定のプロパティやメソッドをサポートしない場合は、プロパティやメソッドを非操作として実装します。</span><span class="sxs-lookup"><span data-stu-id="a998a-108">If your [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension will not support a particular property or method, implement the property or method as no-operation.</span></span> <span data-ttu-id="a998a-109">クライアントが特定の動作を必要とする場合は、**NotSupportedException** 例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="a998a-109">If a client expects a particular behavior, throw a **NotSupportedException** exception.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a998a-110">プロパティやメソッドの非操作実装は、実装することを選択したインターフェイスのプロパティとメソッドにのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="a998a-110">A no-operation implementation of a property or method only applies to the properties and methods of those interfaces that you choose to implement.</span></span> <span data-ttu-id="a998a-111">オプションのインターフェイスを実装しないことを選択した場合は、そのインターフェイスをデータ処理拡張機能アセンブリから除外してください。</span><span class="sxs-lookup"><span data-stu-id="a998a-111">Optional interfaces that you choose not to implement should be left out of your data processing extension assembly.</span></span> <span data-ttu-id="a998a-112">インターフェイスが必須またはオプションのいずれであるかの詳細については、後述する表を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a998a-112">For more information about whether an interface is required or optional, see the table later in this section.</span></span>  
  
## <a name="required-extension-functionality"></a><span data-ttu-id="a998a-113">必須の拡張機能</span><span class="sxs-lookup"><span data-stu-id="a998a-113">Required Extension Functionality</span></span>  
 <span data-ttu-id="a998a-114">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] のすべてのデータ処理拡張機能は、次の機能を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a998a-114">Each [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension must provide the following functionality:</span></span>  
  
-   <span data-ttu-id="a998a-115">データ ソースへの接続を開きます。</span><span class="sxs-lookup"><span data-stu-id="a998a-115">Open a connection to a data source.</span></span>  
  
-   <span data-ttu-id="a998a-116">クエリを分析し、結果セットにフィールド名の一覧を返します。</span><span class="sxs-lookup"><span data-stu-id="a998a-116">Analyze a query and return a list of field names for the result set.</span></span>  
  
-   <span data-ttu-id="a998a-117">データ ソースに対してクエリを実行し、行セットを返します。</span><span class="sxs-lookup"><span data-stu-id="a998a-117">Execute a query against the data source and return a row set.</span></span>  
  
-   <span data-ttu-id="a998a-118">1 つの値を持つパラメーターをクエリに渡します。</span><span class="sxs-lookup"><span data-stu-id="a998a-118">Pass single-valued parameters to the query.</span></span>  
  
-   <span data-ttu-id="a998a-119">行セットの行を反復処理し、データを取得します。</span><span class="sxs-lookup"><span data-stu-id="a998a-119">Iterate through rows in the row set and retrieve data.</span></span>  
  
 <span data-ttu-id="a998a-120">各データ処理拡張は、次の機能を含めるように拡張できます。</span><span class="sxs-lookup"><span data-stu-id="a998a-120">Each data processing extension can be extended to include the following functionality:</span></span>  
  
-   <span data-ttu-id="a998a-121">クエリを分析し、クエリで使用したパラメーター名の一覧を返します。</span><span class="sxs-lookup"><span data-stu-id="a998a-121">Analyze a query and return a list of parameter names used in the query.</span></span>  
  
-   <span data-ttu-id="a998a-122">クエリを分析し、クエリをグループ化するフィールドの一覧を返します。</span><span class="sxs-lookup"><span data-stu-id="a998a-122">Analyze a query and return the list of fields by which the query is grouped.</span></span>  
  
-   <span data-ttu-id="a998a-123">クエリを分析し、クエリを並べ替えるフィールドの一覧を返します。</span><span class="sxs-lookup"><span data-stu-id="a998a-123">Analyze a query and return the list of fields by which the query is sorted.</span></span>  
  
-   <span data-ttu-id="a998a-124">接続文字列と無関係なデータ ソースと接続するために、ユーザー名とパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="a998a-124">Provide a user name and password to connect to the data source that is independent of the connection string.</span></span>  
  
-   <span data-ttu-id="a998a-125">行セットの行を反復処理し、データ値に関する補助メタデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="a998a-125">Iterate through rows in the row set and retrieve auxiliary metadata about the data values.</span></span>  
  
-   <span data-ttu-id="a998a-126">サーバーでデータを集計します。</span><span class="sxs-lookup"><span data-stu-id="a998a-126">Aggregate data at the server.</span></span>  
  
## <a name="available-extension-interfaces"></a><span data-ttu-id="a998a-127">使用可能な拡張機能インターフェイス</span><span class="sxs-lookup"><span data-stu-id="a998a-127">Available Extension Interfaces</span></span>  
 <span data-ttu-id="a998a-128">以下は使用可能なインターフェイスの一覧です。実装が必須かどうかも記載されています。</span><span class="sxs-lookup"><span data-stu-id="a998a-128">The following table describes the available interfaces and whether implementation is required or optional.</span></span>  
  
|<span data-ttu-id="a998a-129">インターフェイス</span><span class="sxs-lookup"><span data-stu-id="a998a-129">Interface</span></span>|<span data-ttu-id="a998a-130">説明</span><span class="sxs-lookup"><span data-stu-id="a998a-130">Description</span></span>|<span data-ttu-id="a998a-131">実装</span><span class="sxs-lookup"><span data-stu-id="a998a-131">Implementation</span></span>|  
|---------------|-----------------|--------------------|  
|<span data-ttu-id="a998a-132">IDbConnection</span><span class="sxs-lookup"><span data-stu-id="a998a-132">IDbConnection</span></span>|<span data-ttu-id="a998a-133">データソースとの一意のセッションを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-133">Represents a unique session with a data source.</span></span> <span data-ttu-id="a998a-134">クライアント/サーバー データベース システムの場合は、セッションがサーバーとのネットワーク接続と同じことがあります。</span><span class="sxs-lookup"><span data-stu-id="a998a-134">In the case of a client/server database system, the session may be equivalent to a network connection to the server.</span></span>|<span data-ttu-id="a998a-135">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-135">Required</span></span>|  
|<span data-ttu-id="a998a-136">IDbConnectionExtension</span><span class="sxs-lookup"><span data-stu-id="a998a-136">IDbConnectionExtension</span></span>|<span data-ttu-id="a998a-137">[!INCLUDE[ssRS](../../../includes/ssrs.md)] データ処理拡張機能によって実装できる、セキュリティと承認に関する追加の接続プロパティを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-137">Represents additional connection properties that can be implemented by [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions regarding security and authentication.</span></span>|<span data-ttu-id="a998a-138">省略可能</span><span class="sxs-lookup"><span data-stu-id="a998a-138">Optional</span></span>|  
|<span data-ttu-id="a998a-139">IDbTransaction</span><span class="sxs-lookup"><span data-stu-id="a998a-139">IDbTransaction</span></span>|<span data-ttu-id="a998a-140">ローカル トランザクションを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-140">Represents a local transaction.</span></span>|<span data-ttu-id="a998a-141">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-141">Required</span></span>|  
|<span data-ttu-id="a998a-142">IDbTransactionExtension</span><span class="sxs-lookup"><span data-stu-id="a998a-142">IDbTransactionExtension</span></span>|<span data-ttu-id="a998a-143">[!INCLUDE[ssRS](../../../includes/ssrs.md)] データ処理拡張機能によって実装できる追加のトランザクション プロパティを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-143">Represents additional transaction properties that can be implemented by [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions.</span></span>|<span data-ttu-id="a998a-144">省略可能</span><span class="sxs-lookup"><span data-stu-id="a998a-144">Optional</span></span>|  
|<span data-ttu-id="a998a-145">IDbCommand</span><span class="sxs-lookup"><span data-stu-id="a998a-145">IDbCommand</span></span>|<span data-ttu-id="a998a-146">データ ソースと接続するときに使用するクエリまたはコマンドを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-146">Represents a query or command that is used when connected to a data source.</span></span>|<span data-ttu-id="a998a-147">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-147">Required</span></span>|  
|<span data-ttu-id="a998a-148">IDbCommandAnalysis</span><span class="sxs-lookup"><span data-stu-id="a998a-148">IDbCommandAnalysis</span></span>|<span data-ttu-id="a998a-149">クエリを分析し、クエリで使用されるパラメーター名の一覧を返す追加コマンド情報を表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-149">Represents additional command information for analyzing a query and returning a list of parameter names used in the query.</span></span>|<span data-ttu-id="a998a-150">省略可能</span><span class="sxs-lookup"><span data-stu-id="a998a-150">Optional</span></span>|  
|<span data-ttu-id="a998a-151">IDataParameter</span><span class="sxs-lookup"><span data-stu-id="a998a-151">IDataParameter</span></span>|<span data-ttu-id="a998a-152">コマンドまたはクエリに渡すパラメーターまたは名前と値のペアを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-152">Represents a parameter or name/value pair that is passed to a command or query.</span></span>|<span data-ttu-id="a998a-153">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-153">Required</span></span>|  
|<span data-ttu-id="a998a-154">IDataParameterCollection</span><span class="sxs-lookup"><span data-stu-id="a998a-154">IDataParameterCollection</span></span>|<span data-ttu-id="a998a-155">コマンドまたはクエリに関連するすべてのパラメーターのコレクションを表します。</span><span class="sxs-lookup"><span data-stu-id="a998a-155">Represents a collection of all parameters relevant to a command or query.</span></span>|<span data-ttu-id="a998a-156">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-156">Required</span></span>|  
|<span data-ttu-id="a998a-157">IDataReader</span><span class="sxs-lookup"><span data-stu-id="a998a-157">IDataReader</span></span>|<span data-ttu-id="a998a-158">データ ソースから順方向専用、読み取り専用のデータのストリームを読み取るメソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="a998a-158">Provides a method of reading a forward-only, read-only stream of data from your data source.</span></span>|<span data-ttu-id="a998a-159">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-159">Required</span></span>|  
|<span data-ttu-id="a998a-160">IDataReaderExtension</span><span class="sxs-lookup"><span data-stu-id="a998a-160">IDataReaderExtension</span></span>|<span data-ttu-id="a998a-161">データ ソースでコマンドを実行することによって取得された、順方向専用の結果セットのストリームを 1 つ以上読み取るメソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="a998a-161">Provides a method of reading one or more forward-only streams of result sets, obtained by executing a command at a data source.</span></span> <span data-ttu-id="a998a-162">このインターフェイスは、フィールド集計の追加サポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="a998a-162">This interface provides additional support for field aggregates.</span></span>|<span data-ttu-id="a998a-163">省略可能</span><span class="sxs-lookup"><span data-stu-id="a998a-163">Optional</span></span>|  
|<span data-ttu-id="a998a-164">IExtension</span><span class="sxs-lookup"><span data-stu-id="a998a-164">IExtension</span></span>|<span data-ttu-id="a998a-165">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] データ処理拡張機能の基本クラスです。</span><span class="sxs-lookup"><span data-stu-id="a998a-165">Provides the base class for a [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="a998a-166">ローカライズされた拡張機能名を追加し、構成ファイルから拡張機能へ構成設定を渡すインプリメンタも有効にします。</span><span class="sxs-lookup"><span data-stu-id="a998a-166">Also enables an implementer to include a localized name for the extension and to pass configuration settings from the configuration file to the extension.</span></span>|<span data-ttu-id="a998a-167">必須</span><span class="sxs-lookup"><span data-stu-id="a998a-167">Required</span></span>|  
  
 <span data-ttu-id="a998a-168">データ処理拡張機能インターフェイスは、可能な場合は [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] データ プロバイダーのインターフェイス、メソッド、およびプロパティのサブセットと同じです。</span><span class="sxs-lookup"><span data-stu-id="a998a-168">The data processing extension interfaces are identical to a subset of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] data provider interfaces, methods, and properties whenever possible.</span></span> <span data-ttu-id="a998a-169">完全な [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] データ プロバイダーの実装の詳細については、[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Software Development Kit (SDK) ドキュメントの「.NET Framework データ プロバイダーの実装」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a998a-169">For more information about implementing a full [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] data provider, see "Implementing a .NET Framework Data Provider" in your [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Software Development Kit (SDK) documentation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a998a-170">参照</span><span class="sxs-lookup"><span data-stu-id="a998a-170">See Also</span></span>  
 <span data-ttu-id="a998a-171">[Reporting Services の拡張機能](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="a998a-171">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="a998a-172">[データ処理拡張機能の実装](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="a998a-172">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="a998a-173">Reporting Services 拡張機能ライブラリ</span><span class="sxs-lookup"><span data-stu-id="a998a-173">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
