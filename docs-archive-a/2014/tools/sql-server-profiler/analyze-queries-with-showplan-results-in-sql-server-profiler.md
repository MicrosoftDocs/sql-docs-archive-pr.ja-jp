---
title: SQL Server Profiler での Showplan 結果を使用したクエリの分析 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: profiler
ms.topic: conceptual
helpviewer_keywords:
- events [SQL Server], Showplan
- Profiler [SQL Server Profiler], Showplan results
- SQL Server Profiler, Showplan results
ms.assetid: 6a2f7727-141c-4f59-8613-2e452bc78467
author: stevestein
ms.author: sstein
ms.openlocfilehash: 2ada8b565a307bf636e06c7b5acb5fd4da5f30df
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87711289"
---
# <a name="analyze-queries-with-showplan-results-in-sql-server-profiler"></a><span data-ttu-id="ba3a5-102">SQL Server Profiler での Showplan 結果を使用したクエリの分析</span><span class="sxs-lookup"><span data-stu-id="ba3a5-102">Analyze Queries with SHOWPLAN Results in SQL Server Profiler</span></span>
  <span data-ttu-id="ba3a5-103">Showplan イベント クラスをトレース定義に追加することで、クエリ プランに関する情報を [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] のトレースで収集して表示できます。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-103">You can add Showplan event classes to a trace definition that cause [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] to gather and display query plan information in the trace.</span></span> <span data-ttu-id="ba3a5-104">また、トレースで収集した他のイベントから Showplan イベントを抽出し、これらの Showplan イベントを個別の XML ファイルに保存することもできます。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-104">It is also possible to extract Showplan events from the other events collected in the trace and to save these Showplan events in a separate XML file.</span></span>  
  
 <span data-ttu-id="ba3a5-105">トレースから Showplan イベントを抽出するために使用できる方法は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-105">Extracting Showplan events from the trace can be done in any of the following ways:</span></span>  
  
-   <span data-ttu-id="ba3a5-106">トレースの構成時に、 **[イベント抽出の設定]** タブを使用する。このタブは、 **[イベントの選択]** タブでいずれかの Showplan イベントを選択するまで表示されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-106">At trace configuration time, using the **Events Extraction Settings** tab. Note that this tab does not appear until you select a one of the Showplan events on the **Events Selection** tab.</span></span>  
  
-   <span data-ttu-id="ba3a5-107">**[ファイル]** メニューの **[SQL Server イベントの抽出]** オプションを使用する。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-107">Using the **Extract SQL Server Events** option on the **File** menu.</span></span>  
  
-   <span data-ttu-id="ba3a5-108">特定のイベントを右クリックして **[イベント データの抽出]** をクリックすることにより、個々のイベントを抽出して保存します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-108">By extracting and saving individual events by right-clicking a specific event and choosing **Extract Event Data**.</span></span>  
  
## <a name="showplan-events"></a><span data-ttu-id="ba3a5-109">Showplan イベント</span><span class="sxs-lookup"><span data-stu-id="ba3a5-109">Showplan Events</span></span>  
 <span data-ttu-id="ba3a5-110">次の表に、各種の Showplan トレース イベントとその説明を示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-110">The Showplan trace events are listed and described in the following table.</span></span>  
  
|<span data-ttu-id="ba3a5-111">イベント名</span><span class="sxs-lookup"><span data-stu-id="ba3a5-111">Event name</span></span>|<span data-ttu-id="ba3a5-112">説明</span><span class="sxs-lookup"><span data-stu-id="ba3a5-112">Description</span></span>|  
|----------------|-----------------|  
|<span data-ttu-id="ba3a5-113">**Performance statistics**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-113">**Performance statistics**</span></span>|<span data-ttu-id="ba3a5-114">コンパイル済みの Showplan が初めてキャッシュされたとき、再コンパイルされたとき、およびプラン キャッシュから削除されたときを示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-114">Indicates the first time a compiled Showplan is cached, when it is recompiled, and when it is dropped from the plan cache.</span></span> <span data-ttu-id="ba3a5-115">**TextData** 列には、XML 形式の Showplan が含まれます。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-115">The **TextData** column contains the Showplan in XML format.</span></span> <span data-ttu-id="ba3a5-116">詳細については、「 [Performance Statistics イベント クラス](../../relational-databases/event-classes/performance-statistics-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-116">For more information, see [Performance Statistics Event Class](../../relational-databases/event-classes/performance-statistics-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-117">**Showplan All**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-117">**Showplan All**</span></span>|<span data-ttu-id="ba3a5-118">実行された [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントのコンパイルに関する完全な詳細情報が含まれたクエリ プランを表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-118">Displays the query plan with full compilation details of the executed [!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="ba3a5-119">たとえば、コストの見積りと列リストを表示できます。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-119">For example, it might display costing estimates and column lists.</span></span> <span data-ttu-id="ba3a5-120">詳細については、「 [Showplan All イベント クラス](../../relational-databases/event-classes/showplan-all-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-120">For more information, see [Showplan All Event Class](../../relational-databases/event-classes/showplan-all-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-121">**Showplan All For Query Compile**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-121">**Showplan All For Query Compile**</span></span>|<span data-ttu-id="ba3a5-122">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]でクエリがコンパイルまたは再コンパイルされたときに発生します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-122">Occurs when a query is compiled or recompiled on [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ba3a5-123">このイベントは、 **Showplan All** イベントに相当するコンパイル時のイベントです。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-123">This is the compile time counterpart of the **Showplan All** event.</span></span> <span data-ttu-id="ba3a5-124">**Showplan All** イベントは、クエリが実行されたときに発生します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-124">**Showplan All** occurs when a query is executed.</span></span> <span data-ttu-id="ba3a5-125">**Showplan All For Query Compile** イベントは、クエリがコンパイルされたときに発生します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-125">**Showplan All For Query Compile** occurs when a query is compiled.</span></span> <span data-ttu-id="ba3a5-126">詳細については、「 [Showplan All for Query Compile イベント クラス](../../relational-databases/event-classes/showplan-all-for-query-compile-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-126">For more information, see [Showplan All for Query Compile Event Class](../../relational-databases/event-classes/showplan-all-for-query-compile-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-127">**Showplan Statistics Profile**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-127">**Showplan Statistics Profile**</span></span>|<span data-ttu-id="ba3a5-128">各操作で渡される実際の行数など、実行されている [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントの実行時の完全な詳細情報が含まれたクエリ プランを表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-128">Displays the query plan with full run-time details of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement being executed, including the actual number of rows passing through each operation.</span></span> <span data-ttu-id="ba3a5-129">詳細については、「 [Showplan Statistics Profile イベント クラス](../../relational-databases/event-classes/showplan-statistics-profile-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-129">For more information, see [Showplan Statistics Profile Event Class](../../relational-databases/event-classes/showplan-statistics-profile-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-130">**Showplan Text**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-130">**Showplan Text**</span></span>|<span data-ttu-id="ba3a5-131">実行されている [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントのクエリ プラン ツリーをバイナリ データとして表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-131">Displays as binary data the query plan tree of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement being executed.</span></span> <span data-ttu-id="ba3a5-132">詳細については、「 [Showplan Text イベント クラス](../../relational-databases/event-classes/showplan-text-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-132">For more information, see [Showplan Text Event Class](../../relational-databases/event-classes/showplan-text-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-133">**Showplan Text (Unencoded)**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-133">**Showplan Text (Unencoded)**</span></span>|<span data-ttu-id="ba3a5-134">実行されている [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントのクエリ プラン ツリーをテキストとして表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-134">Displays as text the query plan tree of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement being executed.</span></span> <span data-ttu-id="ba3a5-135">このイベント クラスでは、バイナリ データではなくテキストが表示されるという点を除いては、Showplan Text と同じ情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-135">This event class displays the same information as Showplan Text, except that this event class displays text instead of binary data.</span></span> <span data-ttu-id="ba3a5-136">詳細については、「[Showplan Text &#40;Unencoded&#41; イベント クラス](../../relational-databases/event-classes/showplan-text-unencoded-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-136">For more information, see [Showplan Text &#40;Unencoded&#41; Event Class](../../relational-databases/event-classes/showplan-text-unencoded-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-137">**Showplan XML**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-137">**Showplan XML**</span></span>|<span data-ttu-id="ba3a5-138">クエリの最適化中に収集された完全なデータが含まれたクエリ プランを表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-138">Displays the query plan with full data collected during query optimization.</span></span> <span data-ttu-id="ba3a5-139">このイベントは、クエリ プランが最適化されたときに生成されます。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-139">This event is generated only when a query plan is optimized.</span></span> <span data-ttu-id="ba3a5-140">詳細については、「 [Showplan XML イベント クラス](../../relational-databases/event-classes/showplan-xml-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-140">For more information, see [Showplan XML Event Class](../../relational-databases/event-classes/showplan-xml-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-141">**Showplan XML For Query Compile**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-141">**Showplan XML For Query Compile**</span></span>|<span data-ttu-id="ba3a5-142">クエリがコンパイルされたときにクエリ プランを表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-142">Displays the query plan when the query is compiled.</span></span> <span data-ttu-id="ba3a5-143">詳細については、「 [Showplan XML for Query Compile イベント クラス](../../relational-databases/event-classes/showplan-xml-for-query-compile-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-143">For more information, see [Showplan XML for Query Compile Event Class](../../relational-databases/event-classes/showplan-xml-for-query-compile-event-class.md).</span></span>|  
|<span data-ttu-id="ba3a5-144">**Showplan XML Statistics Profile**</span><span class="sxs-lookup"><span data-stu-id="ba3a5-144">**Showplan XML Statistics Profile**</span></span>|<span data-ttu-id="ba3a5-145">実行時の完全な詳細情報が含まれたクエリ プランを XML 形式で表示します。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-145">Displays the query plan with full run-time details in XML format.</span></span> <span data-ttu-id="ba3a5-146">たとえば、このイベント クラスでは、実行される [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントの各操作に渡される行数をキャプチャします。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-146">For example, this event class captures the number of rows passing through each operator of the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that is executed.</span></span> <span data-ttu-id="ba3a5-147">詳細については、「 [Showplan XML Statistics Profile イベント クラス](../../relational-databases/event-classes/showplan-xml-statistics-profile-event-class.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ba3a5-147">For more information, see [Showplan XML Statistics Profile Event Class](../../relational-databases/event-classes/showplan-xml-statistics-profile-event-class.md).</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ba3a5-148">参照</span><span class="sxs-lookup"><span data-stu-id="ba3a5-148">See Also</span></span>  
 [<span data-ttu-id="ba3a5-149">Performance イベント カテゴリ</span><span class="sxs-lookup"><span data-stu-id="ba3a5-149">Performance Event Category</span></span>](../../relational-databases/event-classes/performance-event-category.md)  
  
  
