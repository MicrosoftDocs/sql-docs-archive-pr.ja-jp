---
title: キャッシュなしモードまたは部分キャッシュ モードの参照を実装する | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Lookup transformation
- match exactly [Integration Services]
- lookups [Integration Services]
- exact matches [Integration Services]
ms.assetid: 01b7fbca-5181-4d47-9f75-7f25af6b40d2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5c3958450d6371299972a69f5312a3c631c853aa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87644066"
---
# <a name="implement-a-lookup-in-no-cache-or-partial-cache-mode"></a><span data-ttu-id="9bcf0-102">キャッシュなしモードまたは部分キャッシュ モードの参照を実装する</span><span class="sxs-lookup"><span data-stu-id="9bcf0-102">Implement a Lookup in No Cache or Partial Cache Mode</span></span>
  <span data-ttu-id="9bcf0-103">参照変換は、次の部分キャッシュ モードまたはキャッシュなしのモードを使用するように構成できます。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-103">You can configure the Lookup transformation to use the partial cache or no cache mode:</span></span>  
  
-   <span data-ttu-id="9bcf0-104">[部分キャッシュ]</span><span class="sxs-lookup"><span data-stu-id="9bcf0-104">Partial cache</span></span>  
  
     <span data-ttu-id="9bcf0-105">参照データセットに一致するエントリがある行、および必要に応じてデータセットに一致するエントリがない行がキャッシュに格納されます。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-105">The rows with matching entries in the reference dataset and, optionally, the rows without matching entries in the dataset are stored in cache.</span></span> <span data-ttu-id="9bcf0-106">キャッシュのメモリ サイズを超えると、使用頻度の最も低い行が、参照変換によって自動的にキャッシュから削除されます。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-106">When the memory size of the cache is exceeded, the Lookup transformation automatically removes the least frequently used rows from the cache.</span></span>  
  
-   <span data-ttu-id="9bcf0-107">[キャッシュなし]</span><span class="sxs-lookup"><span data-stu-id="9bcf0-107">No cache</span></span>  
  
     <span data-ttu-id="9bcf0-108">キャッシュにデータは読み込まれません。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-108">No data is loaded into cache.</span></span>  
  
 <span data-ttu-id="9bcf0-109">部分キャッシュとキャッシュなしのどちらを選択するかにかかわらず、参照データセットへの接続には OLE DB 接続マネージャーを使用します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-109">Whether you select partial cache or no cache, you use an OLE DB connection manager to connect to the reference dataset.</span></span> <span data-ttu-id="9bcf0-110">参照データセットは、参照変換の実行時に、テーブル、ビュー、または SQL クエリを使用して生成されます。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-110">The reference dataset is generated by using a table, view, or SQL query during the execution of the Lookup transformation</span></span>  
  
### <a name="to-implement-a-lookup-transformation-in-no-cache-or-partial-cache-mode"></a><span data-ttu-id="9bcf0-111">キャッシュなしのモードまたは部分キャッシュ モードの参照変換を実装するには</span><span class="sxs-lookup"><span data-stu-id="9bcf0-111">To implement a Lookup transformation in no cache or partial cache mode</span></span>  
  
1.  <span data-ttu-id="9bcf0-112">[!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]で、目的のパッケージが含まれている [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] プロジェクトを開き、そのパッケージを開きます。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-112">In [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)], open the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] project that contains the package you want, and then open the package.</span></span>  
  
2.  <span data-ttu-id="9bcf0-113">**[データ フロー]** タブで、参照変換を追加します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-113">On the **Data Flow** tab, add a Lookup transformation.</span></span>  
  
3.  <span data-ttu-id="9bcf0-114">参照変換をデータ フローに連結します。連結するには、変換元または前の変換から参照変換にコネクタをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-114">Connect the Lookup transformation to the data flow by dragging a connector from a source or a previous transformation to the Lookup transformation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9bcf0-115">その変換が空のデータ フィールドを含んだフラット ファイルに接続される場合、キャッシュなしのモードを使用して構成される参照変換は検証されない場合があります。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-115">A Lookup transformation that is configured to use the no cache mode might not validate if that transformation connects to a flat file that contains an empty date field.</span></span> <span data-ttu-id="9bcf0-116">変換が検証されるかどうかは、フラット ファイルの接続マネージャーが NULL 値を保持するように構成されているかどうかによって決まります。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-116">Whether the transformation validates depends on whether the connection manager for the flat file has been configured to retain null values.</span></span> <span data-ttu-id="9bcf0-117">参照変換が検証されるようにするには、 **フラット ファイル ソース エディター**の **[接続マネージャー]** ページで、 **[データ ソースの NULL 値をデータ フローで NULL 値として保持する]** オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-117">To ensure that the Lookup transformation validates, in the **Flat File Source Editor**, on the **Connection Manager Page**, select the **Retain null values from the source as null values in the data flow** option.</span></span>  
  
4.  <span data-ttu-id="9bcf0-118">変換元または前の変換をダブルクリックして、コンポーネントを構成します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-118">Double-click the source or previous transformation to configure the component.</span></span>  
  
5.  <span data-ttu-id="9bcf0-119">参照変換をダブルクリックし、 **[参照変換エディター]** の **[全般]** ページで **[部分キャッシュ]** または **[キャッシュなし]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-119">Double-click the Lookup transformation, and then in the **Lookup Transformation Editor**, on the **General** page, select **Partialcache** or **No cache**.</span></span>  
  
6.  <span data-ttu-id="9bcf0-120">**[一致するエントリがない行の処理方法の指定]** ボックスの一覧で、エラー処理オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-120">For **Specify how to handle rows with no matching entries** list, select an error handling option from the list.</span></span>  
  
7.  <span data-ttu-id="9bcf0-121">**[接続]** ページで、 **[OLE DB 接続マネージャー]** ボックスの一覧から接続マネージャーを選択するか、 **[新規作成]** をクリックして新しい接続マネージャーを作成します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-121">On the **Connection** page, select a connection manager from the **OLE DB connection manager** list or click **New** to create a new connection manager.</span></span> <span data-ttu-id="9bcf0-122">詳細については、「 [OLE DB 接続マネージャー](../../connection-manager/ole-db-connection-manager.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-122">For more information, see [OLE DB Connection Manager](../../connection-manager/ole-db-connection-manager.md).</span></span>  
  
8.  <span data-ttu-id="9bcf0-123">次のいずれかの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-123">Do one of the following steps:</span></span>  
  
    -   <span data-ttu-id="9bcf0-124">**[テーブルまたはビューを使用する]** をクリックし、テーブルまたはビューを選択するか、 **[新規作成]** をクリックしてテーブルまたはビューを作成します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-124">Click **Use a table or a view**, and then either select a table or view, or click **New** to create a table or view.</span></span>  
  
    -   <span data-ttu-id="9bcf0-125">**[SQL クエリの結果を使用する]** をクリックし、 **[SQL コマンド]** ウィンドウでクエリを作成します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-125">Click **Use results of an SQL query**, and then build a query in the **SQL Command** window.</span></span>  
  
         <span data-ttu-id="9bcf0-126">または</span><span class="sxs-lookup"><span data-stu-id="9bcf0-126">-or-</span></span>  
  
         <span data-ttu-id="9bcf0-127">**[クエリの作成]** をクリックし、 **[クエリ ビルダー]** で用意されているグラフィック ツールを使用してクエリを作成します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-127">Click **Build Query** to build a query by using the graphical tools that the **Query Builder** provides.</span></span>  
  
         <span data-ttu-id="9bcf0-128">または</span><span class="sxs-lookup"><span data-stu-id="9bcf0-128">-or-</span></span>  
  
         <span data-ttu-id="9bcf0-129">**[参照]** をクリックして、ファイルから SQL ステートメントをインポートします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-129">Click **Browse** to import an SQL statement from a file.</span></span>  
  
     <span data-ttu-id="9bcf0-130">SQL クエリを検証するには、 **[クエリの解析]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-130">To validate the SQL query, click **Parse Query**.</span></span>  
  
     <span data-ttu-id="9bcf0-131">データのサンプルを表示するには、 **[プレビュー**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-131">To view a sample of the data, click **Preview**.</span></span>  
  
9. <span data-ttu-id="9bcf0-132">**[列]** ページをクリックし、 **[使用できる入力列]** 一覧の 1 列以上を **[使用できる参照列]** 一覧の列にドラッグします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-132">Click the **Columns** page, and then drag at least one column from the **Available Input Columns** list to a column in the **Available Lookup Column** list.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9bcf0-133">参照変換は、同じ名前で同じデータ型を持つ列を自動的にマップします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-133">The Lookup transformation automatically maps columns that have the same name and the same data type.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9bcf0-134">列をマップするには、データ型が一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-134">Columns must have matching data types to be mapped.</span></span> <span data-ttu-id="9bcf0-135">詳細については、「 [Integration Services Data Types](../integration-services-data-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-135">For more information, see [Integration Services Data Types](../integration-services-data-types.md).</span></span>  
  
10. <span data-ttu-id="9bcf0-136">次の手順を実行して、参照列を出力に追加します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-136">Include lookup columns in the output by doing the following steps:</span></span>  
  
    1.  <span data-ttu-id="9bcf0-137">**[使用できる参照列]** ボックスの一覧から列を選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-137">From the **Available Lookup Columns** list, select columns.</span></span>  
  
    2.  <span data-ttu-id="9bcf0-138">**[参照操作]** ボックスの一覧で、参照列の値を入力列の値と置き換えるか、新しい列に書き出すかを指定します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-138">In **Lookup Operation** list, specify whether the values from the lookup columns replace values in the input column or are written to a new column.</span></span>  
  
11. <span data-ttu-id="9bcf0-139">手順 5. で **[部分キャッシュ]** を選択した場合は、 **[詳細設定]** ページで次のキャッシュ オプションを設定します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-139">If you selected **Partial cache** in step 5, on the **Advanced** page, set the following cache options:</span></span>  
  
    -   <span data-ttu-id="9bcf0-140">**[キャッシュ サイズ (32 ビット)]** ボックスの一覧から、32 ビット環境のキャッシュ サイズを選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-140">From the **Cache size (32-bit)** list, select the cache size for 32-bit environments.</span></span>  
  
    -   <span data-ttu-id="9bcf0-141">**[キャッシュ サイズ (64 ビット)]** ボックスの一覧から、64 ビット環境のキャッシュ サイズを選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-141">From the **Cache size (64-bit)** list, select the cache size for 64-bit environments.</span></span>  
  
    -   <span data-ttu-id="9bcf0-142">参照に一致するエントリがない行をキャッシュするには、 **[一致するエントリがない行のキャッシュを有効にする]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-142">To cache the rows without matching entries in the reference, select **Enable cache for rows with no matching entries**.</span></span>  
  
    -   <span data-ttu-id="9bcf0-143">**[キャッシュの割り当て]** ボックスの一覧から、一致するエントリがない行の格納に使用するキャッシュの割合を選択します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-143">From the **Allocation from cache** list, select the percentage of the cache to use to store the rows without matching entries.</span></span>  
  
12. <span data-ttu-id="9bcf0-144">参照データセットを生成する SQL ステートメントを変更するには、 **[SQL ステートメントを変更する]** を選択し、テキスト ボックスに表示される SQL ステートメントを変更します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-144">To modify the SQL statement that generates the reference dataset, select **Modify the SQL statement**, and change the SQL statement displayed in the text box.</span></span>  
  
     <span data-ttu-id="9bcf0-145">ステートメントにパラメーターが含まれている場合は、 **[パラメーター]** をクリックしてパラメーターを入力列にマップします。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-145">If the statement includes parameters, click **Parameters** to map the parameters to input columns.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9bcf0-146">このページで指定するオプションの SQL ステートメントは、 **[参照変換エディター]** の **[接続]** ページで指定したテーブル名をオーバーライドおよび置換します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-146">The optional SQL statement that you specify on this page overrides and replaces the table name that you specified on the **Connection** page of the **Lookup Transformation Editor**.</span></span>  
  
13. <span data-ttu-id="9bcf0-147">エラー出力を構成するには、 **[エラー出力]** ページをクリックし、エラー処理オプションを設定します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-147">To configure the error output, click the **Error Output** page and set the error handling options.</span></span> <span data-ttu-id="9bcf0-148">詳細については、「[[参照変換エディター] ([エラー出力] ページ)](../../lookup-transformation-editor-error-output-page.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-148">For more information, see [Lookup Transformation Editor &#40;Error Output Page&#41;](../../lookup-transformation-editor-error-output-page.md).</span></span>  
  
14. <span data-ttu-id="9bcf0-149">**[OK]** をクリックして参照変換への変更を保存し、パッケージを実行します。</span><span class="sxs-lookup"><span data-stu-id="9bcf0-149">Click **OK** to save your changes to the Lookup transformation, and then run the package.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9bcf0-150">参照</span><span class="sxs-lookup"><span data-stu-id="9bcf0-150">See Also</span></span>  
 [<span data-ttu-id="9bcf0-151">Integration Services の変換</span><span class="sxs-lookup"><span data-stu-id="9bcf0-151">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
