---
title: データのエラー処理 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- truncating data
- data conversion errors [Integration Services]
- errors [Integration Services], data flow components
- lookups [Integration Services]
- errors [Integration Services]
- errors [Integration Services], data flow outputs
- error outputs [Integration Services]
- data flow [Integration Services], errors
- expressions [Integration Services], errors
ms.assetid: c61667b4-25cb-4d45-a52f-a733e32863f4
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 442ecc68fc352d50955af9302fbcedf77ba36338
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87742457"
---
# <a name="error-handling-in-data"></a><span data-ttu-id="05412-102">データのエラー処理</span><span class="sxs-lookup"><span data-stu-id="05412-102">Error Handling in Data</span></span>
  <span data-ttu-id="05412-103">データ フロー コンポーネントが変換を列データに適用したり、変換元のデータを抽出したり、変換先にデータを読み込んだりするときに、エラーが発生する場合があります。</span><span class="sxs-lookup"><span data-stu-id="05412-103">When a data flow component applies a transformation to column data, extracts data from sources, or loads data into destinations, errors can occur.</span></span> <span data-ttu-id="05412-104">エラーが発生する原因の主なものは、予期しないデータ値です。</span><span class="sxs-lookup"><span data-stu-id="05412-104">Errors frequently occur because of unexpected data values.</span></span> <span data-ttu-id="05412-105">たとえば、数字ではなく文字列が列に含まれる場合、データ変換は失敗します。また、データは日付データであるが列のデータ型は数値の場合、データベース列への挿入は失敗します。あるいは、列の値が 0 の場合に数学的演算の結果が無効となり、それが原因で式の評価が失敗します。</span><span class="sxs-lookup"><span data-stu-id="05412-105">For example, a data conversion fails because a column contains a string instead of a number, an insertion into a database column fails because the data is a date and the column has a numeric data type, or an expression fails to evaluate because a column value is zero, resulting in a mathematical operation that is not valid.</span></span>  
  
 <span data-ttu-id="05412-106">エラーは一般的に、次のカテゴリのいずれかに分類されます。</span><span class="sxs-lookup"><span data-stu-id="05412-106">Errors typically fall into one the following categories:</span></span>  
  
-   <span data-ttu-id="05412-107">データ変換エラー。変換により、有効桁の損失、有効桁以外の桁の損失、および文字列の切り捨てなどの結果が返された場合に発生します。</span><span class="sxs-lookup"><span data-stu-id="05412-107">Data conversion errors, which occur if a conversion results in loss of significant digits, the loss of insignificant digits, and the truncation of strings.</span></span> <span data-ttu-id="05412-108">要求された変換がサポートされていない場合にも、データ変換エラーは発生します。</span><span class="sxs-lookup"><span data-stu-id="05412-108">Data conversion errors also occur if the requested conversion is not supported.</span></span>  
  
-   <span data-ttu-id="05412-109">式の評価エラー。実行時に評価される式が無効な演算を実行したり、データ値の不足または無効のため構文的に間違った状態になる場合に発生します。</span><span class="sxs-lookup"><span data-stu-id="05412-109">Expression evaluation errors, which occur if expressions that are evaluated at run time perform invalid operations or become syntactically incorrect because of missing or incorrect data values.</span></span>  
  
-   <span data-ttu-id="05412-110">参照エラー。参照操作が、参照テーブル内で一致を見つけられなかった場合に発生します。</span><span class="sxs-lookup"><span data-stu-id="05412-110">Lookup errors, which occur if a lookup operation fails to locate a match in the lookup table.</span></span>  
  
 <span data-ttu-id="05412-111">多くのデータ フロー コンポーネントではエラー出力がサポートされています。これを利用すると、コンポーネントが行う、入力データと出力データの両方での行レベルのエラー処理の方法を制御できます。</span><span class="sxs-lookup"><span data-stu-id="05412-111">Many data flow components support error outputs, which let you control how the component handles row-level errors in both incoming and outgoing data.</span></span> <span data-ttu-id="05412-112">入力または出力の個々の列にオプションを設定することにより、切り捨てまたはエラーが発生したときのコンポーネントの動作方法を指定します。</span><span class="sxs-lookup"><span data-stu-id="05412-112">You specify how the component behaves when truncation or an error occurs by setting options on individual columns in the input or output.</span></span> <span data-ttu-id="05412-113">たとえば、顧客名のデータが切り捨てられたときは失敗するが、それよりも重要でないデータが含まれる別の列で切り捨てが発生した場合はエラーを無視するように、コンポーネントを指定できます。</span><span class="sxs-lookup"><span data-stu-id="05412-113">For example, you can specify that the component should fail if customer name data is truncated, but ignore errors on another column that contains less important data.</span></span>  
  
 <span data-ttu-id="05412-114">エラー出力は、別の変換の入力に連結したり、エラー出力以外の別の変換先に読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="05412-114">The error output can be connected to the input of another transformation or loaded into a different destination than the non-error output.</span></span> <span data-ttu-id="05412-115">たとえば、エラー出力は、空白列に文字列を提供する派生列変換に連結できます。</span><span class="sxs-lookup"><span data-stu-id="05412-115">For example, the error output can be a connected to a Derived Column transformation that provides a string for a column that is blank.</span></span>  
  
 <span data-ttu-id="05412-116">次の図は、エラー出力が含まれる簡単なデータ フローを示しています。</span><span class="sxs-lookup"><span data-stu-id="05412-116">The following diagram shows a simple data flow including an error output.</span></span>  
  
 <span data-ttu-id="05412-117">![エラー出力のあるデータ フロー](../media/mw-dts-11.gif "エラー出力のあるデータ フロー")</span><span class="sxs-lookup"><span data-stu-id="05412-117">![Data flow with error output](../media/mw-dts-11.gif "Data flow with error output")</span></span>  
  
 <span data-ttu-id="05412-118">データ列の他に、エラー出力には **ErrorCode** 列と **ErrorColumn** 列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="05412-118">In addition to the data columns, the error output includes the **ErrorCode** and **ErrorColumn** columns.</span></span> <span data-ttu-id="05412-119">**ErrorCode** 列はエラーを識別し、 **ErrorColumn** 列にはエラー列の系列 ID が含まれます。</span><span class="sxs-lookup"><span data-stu-id="05412-119">The **ErrorCode** column identifies the error and the **ErrorColumn** contains the lineage identifier of the error column.</span></span> <span data-ttu-id="05412-120">これらの列のメタデータを表示するには、エラー出力をデータ フロー内の次のコンポーネントに連結するパスをクリックします。</span><span class="sxs-lookup"><span data-stu-id="05412-120">To view the metadata of these columns, click the path that connects the error output to the next component in the data flow.</span></span> <span data-ttu-id="05412-121">状況によっては、 **ErrorColumn** 列の値が 0 に設定されていることがあります。</span><span class="sxs-lookup"><span data-stu-id="05412-121">Under some circumstances, the value of the **ErrorColumn** column is set to zero.</span></span> <span data-ttu-id="05412-122">これは、エラー状態が 1 列ではなく行全体に影響していることを示します。</span><span class="sxs-lookup"><span data-stu-id="05412-122">This occurs when the error condition affects the entire row instead of a single column.</span></span> <span data-ttu-id="05412-123">たとえば、参照変換で参照に失敗した場合などです。</span><span class="sxs-lookup"><span data-stu-id="05412-123">An example is when a lookup fails in the Lookup transformation.</span></span>  
  
 <span data-ttu-id="05412-124">詳細については、「 [データ フロー](data-flow.md) 」と「 [Integration Services のパス](integration-services-paths.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="05412-124">For more information, see [Data Flow](data-flow.md) and [Integration Services Paths](integration-services-paths.md).</span></span>  
  
 <span data-ttu-id="05412-125">Integration Services のエラー、警告、および他のメッセージの一覧については、「 [Integration Services Error and Message Reference](../integration-services-error-and-message-reference.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="05412-125">For a list of Integration Services errors, warnings, and other messages, see [Integration Services Error and Message Reference](../integration-services-error-and-message-reference.md).</span></span>  
  
## <a name="error-and-truncation-options"></a><span data-ttu-id="05412-126">エラーと切り捨てオプション</span><span class="sxs-lookup"><span data-stu-id="05412-126">Error and Truncation Options</span></span>  
 <span data-ttu-id="05412-127">エラーは、エラーまたは切り捨ての、2 つのカテゴリのいずれかに分類されます。</span><span class="sxs-lookup"><span data-stu-id="05412-127">Errors fall into one of two categories: errors or truncations.</span></span> <span data-ttu-id="05412-128">エラーは決定的な失敗を示し、NULL 値の結果を生成します。</span><span class="sxs-lookup"><span data-stu-id="05412-128">An error indicates an unequivocal failure, and generates a NULL result.</span></span> <span data-ttu-id="05412-129">このようなエラーには、データ変換エラーまたは式の評価エラーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="05412-129">Such errors can include data conversion errors or expression evaluation errors.</span></span> <span data-ttu-id="05412-130">たとえば、英文字が含まれる文字列を数字に変換しようとすると、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="05412-130">For example, an attempt to convert a string that contains alphabetical characters to a number causes an error.</span></span> <span data-ttu-id="05412-131">データ変換、式の評価、および変数、プロパティ、データ列への式の結果の割り当ては、無効なキャストおよび互換性のないデータ型のために失敗する場合があります。</span><span class="sxs-lookup"><span data-stu-id="05412-131">Data conversions, expression evaluations, and assignments of expression results to variables, properties, and data columns may fail because of illegal casts and incompatible data types.</span></span> <span data-ttu-id="05412-132">詳細については、「[Cast &#40;SSIS 式&#41;](../expressions/cast-ssis-expression.md)[式における Integration Services データ型](../expressions/integration-services-data-types-in-expressions.md), 」、および「[Integration Services のデータ型](integration-services-data-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="05412-132">For more information see, [Cast &#40;SSIS Expression&#41;](../expressions/cast-ssis-expression.md), [Integration Services Data Types in Expressions](../expressions/integration-services-data-types-in-expressions.md), and [Integration Services Data Types](integration-services-data-types.md).</span></span>  
  
 <span data-ttu-id="05412-133">切り捨ては、エラーほど重大ではありません。</span><span class="sxs-lookup"><span data-stu-id="05412-133">A truncation is less serious than an error.</span></span> <span data-ttu-id="05412-134">切り捨てによって生成される結果は、使用できる場合も、むしろ望ましい場合もあります。</span><span class="sxs-lookup"><span data-stu-id="05412-134">A truncation generates results that might be usable or even desirable.</span></span> <span data-ttu-id="05412-135">切り捨てをエラーとして扱うか、または許容できる条件として扱うかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="05412-135">You can elect to treat truncations as errors or as acceptable conditions.</span></span> <span data-ttu-id="05412-136">たとえば、15 文字の文字列を、文字幅が 1 文字のみの列に挿入する場合、文字列の切り捨てを選択できます。</span><span class="sxs-lookup"><span data-stu-id="05412-136">For example, if you are inserting a 15-character string into a column that is only one character wide, you can elect to truncate the string.</span></span>  
  
 <span data-ttu-id="05412-137">変換元、変換、および変換先によるエラーと切り捨ての処理方法を構成できます。</span><span class="sxs-lookup"><span data-stu-id="05412-137">You can configure how sources, transformations, and destinations handle errors and truncations.</span></span> <span data-ttu-id="05412-138">次の表では、このオプションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="05412-138">The following table describes the options.</span></span>  
  
|<span data-ttu-id="05412-139">オプション</span><span class="sxs-lookup"><span data-stu-id="05412-139">Option</span></span>|<span data-ttu-id="05412-140">説明</span><span class="sxs-lookup"><span data-stu-id="05412-140">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="05412-141">エラー コンポーネント</span><span class="sxs-lookup"><span data-stu-id="05412-141">Fail Component</span></span>|<span data-ttu-id="05412-142">エラーまたは切り捨てが発生すると、データ フロー タスクは失敗します。</span><span class="sxs-lookup"><span data-stu-id="05412-142">The Data Flow task fails when an error or a truncation occurs.</span></span> <span data-ttu-id="05412-143">[失敗] は、エラーおよび切り捨ての既定のオプションです。</span><span class="sxs-lookup"><span data-stu-id="05412-143">Failure is the default option for an error and a truncation.</span></span>|  
|<span data-ttu-id="05412-144">エラーを無視する</span><span class="sxs-lookup"><span data-stu-id="05412-144">Ignore Failure</span></span>|<span data-ttu-id="05412-145">エラーまたは切り捨ては無視され、データ行は変換または変換元の出力に送られます。</span><span class="sxs-lookup"><span data-stu-id="05412-145">The error or the truncation is ignored and the data row is directed to the output of the transformation or source.</span></span>|  
|<span data-ttu-id="05412-146">行のリダイレクト</span><span class="sxs-lookup"><span data-stu-id="05412-146">Redirect Row</span></span>|<span data-ttu-id="05412-147">エラーまたは切り捨てのデータ行は、変換元、変換、または変換先のエラー出力に送られます。</span><span class="sxs-lookup"><span data-stu-id="05412-147">The error or the truncation data row is directed to the error output of the source, transformation, or destination.</span></span>|  
  
## <a name="adding-the-error-description"></a><span data-ttu-id="05412-148">エラーの説明の追加</span><span class="sxs-lookup"><span data-stu-id="05412-148">Adding the Error Description</span></span>  
 <span data-ttu-id="05412-149">既定では、エラー出力により数値エラー コードが提供され、通常、エラー出力にはエラーが発生した列の ID が含まれています。</span><span class="sxs-lookup"><span data-stu-id="05412-149">By default an error output provides the numeric error code and usually contains the identifier of the column in which the error occurred.</span></span> <span data-ttu-id="05412-150">スクリプト コンポーネントを使用して追加列にエラーの説明を含めることができます。この操作は、1 行のスクリプトを使用して、<xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100.GetErrorDescription%2A> インターフェイスの <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100> メソッドを呼び出して行います。</span><span class="sxs-lookup"><span data-stu-id="05412-150">You can use the Script component to include the error description in an additional column by using a single line of script to call the <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100.GetErrorDescription%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.Wrapper.IDTSComponentMetaData100> interface.</span></span>  
  
 <span data-ttu-id="05412-151">このスクリプト コンポーネントは、エラーをキャプチャするデータ フロー コンポーネントよりデータ フローの下流にある任意のエラー セグメントに追加できますが、エラー行を出力先に書き込む直前の位置に配置するのが普通です。</span><span class="sxs-lookup"><span data-stu-id="05412-151">The Script component can be added to the error segment of the data flow anywhere downstream from the data flow components whose errors that you want to capture, but is typically placed immediately before the error rows are written to a destination.</span></span> <span data-ttu-id="05412-152">これによりスクリプトは、書き込まれたエラー行についてのみ、説明を参照することができます。</span><span class="sxs-lookup"><span data-stu-id="05412-152">This way, the script looks up only descriptions for error rows that are written.</span></span> <span data-ttu-id="05412-153">たとえば、データ フロー内のエラー セグメントでエラーの一部が修正され、出力先にエラー行が書き込まれないこともあり得るからです。</span><span class="sxs-lookup"><span data-stu-id="05412-153">For example, the error segment of the data flow may correct some errors and not write those rows to an error destination.</span></span> <span data-ttu-id="05412-154">詳細については、「[スクリプトコンポーネントによるエラー出力の拡張](../extending-packages-scripting-data-flow-script-component-examples/enhancing-an-error-output-with-the-script-component.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="05412-154">For more information, see [Enhancing an Error Output with the Script Component](../extending-packages-scripting-data-flow-script-component-examples/enhancing-an-error-output-with-the-script-component.md).</span></span>  
  
### <a name="to-configure-an-error-output"></a><span data-ttu-id="05412-155">エラー出力を構成するには</span><span class="sxs-lookup"><span data-stu-id="05412-155">To configure an error output</span></span>  
  
-   [<span data-ttu-id="05412-156">データ フロー コンポーネントでエラー出力を構成する</span><span class="sxs-lookup"><span data-stu-id="05412-156">Configure an Error Output in a Data Flow Component</span></span>](../configure-an-error-output-in-a-data-flow-component.md)  
  
## <a name="see-also"></a><span data-ttu-id="05412-157">参照</span><span class="sxs-lookup"><span data-stu-id="05412-157">See Also</span></span>  
 <span data-ttu-id="05412-158">[データ フロー](data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="05412-158">[Data Flow](data-flow.md) </span></span>  
 <span data-ttu-id="05412-159">[変換を使用してデータを変換する](transformations/transform-data-with-transformations.md) </span><span class="sxs-lookup"><span data-stu-id="05412-159">[Transform Data with Transformations](transformations/transform-data-with-transformations.md) </span></span>  
 <span data-ttu-id="05412-160">[パスを使用してコンポーネントを連結する](../connect-components-with-paths.md) </span><span class="sxs-lookup"><span data-stu-id="05412-160">[Connect Components with Paths](../connect-components-with-paths.md) </span></span>  
 <span data-ttu-id="05412-161">[データ フロー タスク](../control-flow/data-flow-task.md) </span><span class="sxs-lookup"><span data-stu-id="05412-161">[Data Flow Task](../control-flow/data-flow-task.md) </span></span>  
 [<span data-ttu-id="05412-162">データ フロー</span><span class="sxs-lookup"><span data-stu-id="05412-162">Data Flow</span></span>](data-flow.md)  
  
  
