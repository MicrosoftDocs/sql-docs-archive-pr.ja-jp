---
title: 文字列データの比較 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5670f434470d8fad0a8b593ccde0c01ae307e417
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87644577"
---
# <a name="comparing-string-data"></a><span data-ttu-id="51f74-102">比較、文字列データ</span><span class="sxs-lookup"><span data-stu-id="51f74-102">Comparing String Data</span></span>
  <span data-ttu-id="51f74-103">文字列比較は、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]によって実行される多くの変換において重要な部分です。また、文字列比較は、変数内の式やプロパティ式の評価でも使用されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-103">String comparisons are an important part of many of the transformations performed by [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], and string comparisons are also used in the evaluation of expressions in variables and property expressions.</span></span> <span data-ttu-id="51f74-104">たとえば、並べ替え変換はデータセット内の値を比較し、昇順または降順にデータを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="51f74-104">For example, the Sort transformation compares values in a dataset to sort data in ascending or descending order.</span></span>  
  
## <a name="configuring-transformations-for-string-comparisons"></a><span data-ttu-id="51f74-105">文字列の比較時の変換の構成</span><span class="sxs-lookup"><span data-stu-id="51f74-105">Configuring Transformations for String Comparisons</span></span>  
 <span data-ttu-id="51f74-106">並べ替え変換、集計変換、あいまいグループ化変換、およびあいまい参照変換をカスタマイズして、文字列の比較方法を列レベルで変更できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-106">The Sort, Aggregate, Fuzzy Grouping, and Fuzzy Lookup transformations can be customized to change the way strings are compared at the column level.</span></span> <span data-ttu-id="51f74-107">たとえば、比較で大文字と小文字を区別しないように指定できます。この場合は、大文字と小文字が同じ文字として扱われます。</span><span class="sxs-lookup"><span data-stu-id="51f74-107">For example, you can specify that a comparison ignores case, which means that uppercase and lowercase characters are treated as the same character.</span></span>  
  
 <span data-ttu-id="51f74-108">次の変換は、文字列比較を含むことができる式を使用します。</span><span class="sxs-lookup"><span data-stu-id="51f74-108">The following transformations use expressions that can include string comparisons.</span></span>  
  
-   <span data-ttu-id="51f74-109">条件分割変換は、式の内部で文字列比較を使用し、データ行を送信する出力を決定できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-109">The Conditional Split transformation can use string comparisons in expressions to determine which output to send the data row to.</span></span> <span data-ttu-id="51f74-110">詳細については、「 [Conditional Split Transformation](transformations/conditional-split-transformation.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="51f74-110">For more information, see [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span></span>  
  
-   <span data-ttu-id="51f74-111">派生列変換は、式の内部で文字列比較を使用し、新しい列の値を生成できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-111">The Derived Column transformation can use string comparisons in expressions to generate new column values.</span></span> <span data-ttu-id="51f74-112">詳細については、「 [派生列変換](transformations/derived-column-transformation.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="51f74-112">For more information, see [Derived Column Transformation](transformations/derived-column-transformation.md).</span></span>  
  
 <span data-ttu-id="51f74-113">変数、変数マッピング、および優先順位制約でも、文字列比較を含めた式を使用できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-113">Variables, variable mappings, and precedence constraints also use expressions, which can include string comparisons.</span></span> <span data-ttu-id="51f74-114">式の詳細については、「[Integration Services &#40;SSIS&#41; の式](../expressions/integration-services-ssis-expressions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="51f74-114">For more information about expressions, see [Integration Services &#40;SSIS&#41; Expressions](../expressions/integration-services-ssis-expressions.md).</span></span>  
  
## <a name="processing-during-string-comparison"></a><span data-ttu-id="51f74-115">文字列の比較時の処理</span><span class="sxs-lookup"><span data-stu-id="51f74-115">Processing during String Comparison</span></span>  
 <span data-ttu-id="51f74-116">データおよび変換の構成によっては、文字列データの比較中に次の処理が発生する場合があります。</span><span class="sxs-lookup"><span data-stu-id="51f74-116">Depending on the data and the configuration of the transformation, the following processing may occur during the comparison of string data:</span></span>  
  
-   <span data-ttu-id="51f74-117">データの Unicode への変換。</span><span class="sxs-lookup"><span data-stu-id="51f74-117">Converting data to Unicode.</span></span> <span data-ttu-id="51f74-118">変換元のデータが Unicode でない場合、比較が行われる前に自動的に Unicode に変換されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-118">If the source data is not already Unicode, the data is automatically converted to Unicode before the comparison occurs.</span></span>  
  
-   <span data-ttu-id="51f74-119">ロケールを使用した、日付、時間、10 進数データ、および並べ替え順序を解釈するための、ロケール固有のルールの適用。</span><span class="sxs-lookup"><span data-stu-id="51f74-119">Using locale to apply locale-specific rules for interpreting date, time, decimal data, and sort order.</span></span>  
  
-   <span data-ttu-id="51f74-120">比較の区別を変更するための、列レベルでの比較オプションの適用。</span><span class="sxs-lookup"><span data-stu-id="51f74-120">Applying comparison options at the column level to change the sensitivity of comparisons.</span></span>  
  
## <a name="converting-string-data-to-unicode"></a><span data-ttu-id="51f74-121">文字列データの Unicode への変換</span><span class="sxs-lookup"><span data-stu-id="51f74-121">Converting String Data to Unicode</span></span>  
 <span data-ttu-id="51f74-122">変換が実行する操作や変換の構成によっては、文字列データは、文字列の Unicode 表現である DT_WSTR データ型に変換される場合があります。</span><span class="sxs-lookup"><span data-stu-id="51f74-122">Depending on the operations that the transformation performs and the configuration of the transformation, string data may be converted to the DT_WSTR data type, which is a Unicode representation of string characters.</span></span>  
  
 <span data-ttu-id="51f74-123">DT_STR データ型の文字列データは、列のコード ページを使用して Unicode に変換されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-123">String data that has the DT_STR data type is converted to Unicode using the code page of the column.</span></span> [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="51f74-124">では、列レベルでのコード ページがサポートされており、各列はそれぞれ異なるコード ページを使用して変換できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-124">supports code pages at the column level, and each column can be converted by using a different code page.</span></span>  
  
 <span data-ttu-id="51f74-125">多くの場合、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] はデータ ソースから正しいコード ページを識別できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-125">In most cases, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] can identify the correct code page from the data source.</span></span> <span data-ttu-id="51f74-126">たとえば、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では、データベースおよび列レベルで照合順序を設定できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-126">For example, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can set a collation at the database and column levels.</span></span> <span data-ttu-id="51f74-127">コード ページは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の照合順序から取得します。この照合順序には、Windows または SQL の照合順序のどちらかを設定できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-127">The code page is derived from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collation, which can be either a Windows or an SQL collation.</span></span>  
  
 <span data-ttu-id="51f74-128">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] が予期しないコード ページを提供する場合、またはパッケージが正しいコード ページを決定するための十分な情報を提供しないプロバイダーを使用してデータ ソースにアクセスする場合は、OLE DB ソースおよび OLE DB 変換先で既定のコード ページを指定できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-128">If [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides an unexpected code page, or if the package accesses a data source by using a provider that does not supply sufficient information to determine the correct code page, you can specify a default code page in the OLE DB source and the OLE DB destination.</span></span> <span data-ttu-id="51f74-129">既定のコード ページは、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] で提供されるコード ページの代わりに使用されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-129">The default code pages are used instead of the code pages that [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span>  
  
 <span data-ttu-id="51f74-130">ファイルにはコード ページはありません。</span><span class="sxs-lookup"><span data-stu-id="51f74-130">Files do not have code pages.</span></span> <span data-ttu-id="51f74-131">代わりに、パッケージがファイル データへの接続に使用するフラット ファイル接続マネージャーおよび複数フラット ファイル接続マネージャーに、ファイルのコード ページを指定するプロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="51f74-131">Instead, the Flat File and the Multiple Flat Files connection managers that a package uses to connect to file data include a property for specifying the code page of the file.</span></span> <span data-ttu-id="51f74-132">コード ページはファイル レベルでのみ設定できます。列レベルでは設定できません。</span><span class="sxs-lookup"><span data-stu-id="51f74-132">The code page can be set at the file level only, not at the column level.</span></span>  
  
## <a name="setting-locale"></a><span data-ttu-id="51f74-133">ロケールの設定</span><span class="sxs-lookup"><span data-stu-id="51f74-133">Setting Locale</span></span>  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="51f74-134">は、データを並べ替えたり、日付、時間、および 10 進数データを解釈するためのロケール固有のルールを推定する場合、コード ページを使用しません。</span><span class="sxs-lookup"><span data-stu-id="51f74-134">does not use the code page to infer locale-specific rules for sorting data or interpreting date, time, and decimal data.</span></span> <span data-ttu-id="51f74-135">その代わり、変換はデータ フロー コンポーネント、データ フロー タスク、コンテナー、またはパッケージ上の LocaleId プロパティによって設定されるロケールを読み取ります。</span><span class="sxs-lookup"><span data-stu-id="51f74-135">Instead, the transformation reads the locale that is set by the LocaleId property on the data flow component, Data Flow task, container, or package.</span></span> <span data-ttu-id="51f74-136">既定では、変換のロケールはデータ フロー タスクから継承され、データ フロー タスクはパッケージからロケールを継承します。</span><span class="sxs-lookup"><span data-stu-id="51f74-136">By default, the locale of a transformation is inherited from its Data Flow task, which in turn inherits from the package.</span></span> <span data-ttu-id="51f74-137">データ フロー タスクが For ループ コンテナーなどのコンテナー内にある場合は、コンテナーからロケールを継承します。</span><span class="sxs-lookup"><span data-stu-id="51f74-137">If the Data Flow task is in a container such as the For Loop container, it inherits its locale from the container.</span></span>  
  
 <span data-ttu-id="51f74-138">また、フラット ファイル接続マネージャーや、複数のフラット ファイル接続マネージャー用のロケールも指定できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-138">You can also specify a locale for a Flat File connection manager and a Multiple Flat Files connection manager.</span></span>  
  
## <a name="setting-comparison-options"></a><span data-ttu-id="51f74-139">比較オプションの設定</span><span class="sxs-lookup"><span data-stu-id="51f74-139">Setting Comparison Options</span></span>  
 <span data-ttu-id="51f74-140">ロケールは、文字列データの比較に関する基本ルールを提供します。</span><span class="sxs-lookup"><span data-stu-id="51f74-140">The locale provides the basic rules for comparing string data.</span></span> <span data-ttu-id="51f74-141">たとえば、ロケールは、アルファベット内の各文字の並べ替えの位置を指定します。</span><span class="sxs-lookup"><span data-stu-id="51f74-141">For example, the locale specifies the sort position of each letter in the alphabet.</span></span> <span data-ttu-id="51f74-142">ただし、こうしたルールは一部の変換が実行する比較に対しては十分でない場合があり、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] ではロケールの比較ルールよりも詳細な比較オプションのセットがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="51f74-142">However, these rules may not be sufficient for the comparisons that some transformations perform, and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] supports a set of advanced comparison options that go beyond the comparison rules of a locale.</span></span> <span data-ttu-id="51f74-143">これらの比較オプションは、列レベルで設定されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-143">These comparison options are set at the column level.</span></span> <span data-ttu-id="51f74-144">たとえば、詳細比較オプションの 1 つを使用すると、分音文字を無視できます。</span><span class="sxs-lookup"><span data-stu-id="51f74-144">For example, one of the comparison options lets you ignore nonspacing characters.</span></span> <span data-ttu-id="51f74-145">このオプションの効果は、アクセントなどの分音文字を無視することです。これにより、比較のために "a" と "時間" が同一になります。</span><span class="sxs-lookup"><span data-stu-id="51f74-145">The effect of this option is to ignore diacritics such as the accent, which makes "a" and "å" identical for comparison purposes.</span></span>  
  
 <span data-ttu-id="51f74-146">次の表では、比較オプションと並べ替えスタイルについて説明します。</span><span class="sxs-lookup"><span data-stu-id="51f74-146">The following table describes the comparison options and a sort style.</span></span>  
  
|<span data-ttu-id="51f74-147">比較オプション</span><span class="sxs-lookup"><span data-stu-id="51f74-147">Comparison option</span></span>|<span data-ttu-id="51f74-148">説明</span><span class="sxs-lookup"><span data-stu-id="51f74-148">Description</span></span>|  
|-----------------------|-----------------|  
|<span data-ttu-id="51f74-149">大文字と小文字を区別しない</span><span class="sxs-lookup"><span data-stu-id="51f74-149">Ignore case</span></span>|<span data-ttu-id="51f74-150">比較時に、大文字と小文字を区別するかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="51f74-150">Specifies whether the comparison distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="51f74-151">このオプションを設定した場合、文字列比較で大文字と小文字は区別されません。</span><span class="sxs-lookup"><span data-stu-id="51f74-151">If this option is set, the string comparison ignores case.</span></span> <span data-ttu-id="51f74-152">たとえば、"ABC" は "abc" と同一になります。</span><span class="sxs-lookup"><span data-stu-id="51f74-152">For example, "ABC" becomes the same as "abc".</span></span>|  
|<span data-ttu-id="51f74-153">カタカナを区別しない</span><span class="sxs-lookup"><span data-stu-id="51f74-153">Ignore kana type</span></span>|<span data-ttu-id="51f74-154">日本語の比較で、2 種類のかな文字である、ひらがなとカタカナを区別するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="51f74-154">Specifies whether the comparison distinguishes between the two types of Japanese kana characters: hiragana and katakana.</span></span> <span data-ttu-id="51f74-155">このオプションを設定した場合、文字列比較でひらがなとカタカナは区別されません。</span><span class="sxs-lookup"><span data-stu-id="51f74-155">If this option is set, the string comparison ignores kana type.</span></span>|  
|<span data-ttu-id="51f74-156">文字幅を区別しない</span><span class="sxs-lookup"><span data-stu-id="51f74-156">Ignore character width</span></span>|<span data-ttu-id="51f74-157">比較で、1 バイト文字と、それと同じ文字を表記した 2 バイト文字を区別するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="51f74-157">Specifies whether the comparison distinguishes between a single-byte character and the same character when it is represented as a double-byte character.</span></span> <span data-ttu-id="51f74-158">このオプションを設定した場合、文字列比較で 1 バイト表記と 2 バイト表記は同一文字として扱われます。</span><span class="sxs-lookup"><span data-stu-id="51f74-158">If this option is set, the string comparison treats single-byte and double-byte representations of the same character as identical.</span></span>|  
|<span data-ttu-id="51f74-159">分音文字を無視する</span><span class="sxs-lookup"><span data-stu-id="51f74-159">Ignore nonspacing characters</span></span>|<span data-ttu-id="51f74-160">比較で、通常の文字と分音文字付きの文字を区別するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="51f74-160">Specifies whether the comparison distinguishes between spacing characters and diacritics.</span></span> <span data-ttu-id="51f74-161">このオプションを設定した場合、比較で分音文字は無視されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-161">If this option is set, the comparison ignores diacritics.</span></span> <span data-ttu-id="51f74-162">たとえば、"&#xE5;" は "a" と同じ文字になります。</span><span class="sxs-lookup"><span data-stu-id="51f74-162">For example, "å" is equal to "a".</span></span>|  
|<span data-ttu-id="51f74-163">記号を無視する</span><span class="sxs-lookup"><span data-stu-id="51f74-163">Ignore symbols</span></span>|<span data-ttu-id="51f74-164">比較で、通常の文字を、空白文字、句読点、通貨記号、数学記号などの記号と区別するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="51f74-164">Specifies whether the comparison distinguishes between letter characters and symbols such as white-space characters, punctuation, currency symbols, and mathematical symbols.</span></span> <span data-ttu-id="51f74-165">このオプションを設定した場合、文字列比較で記号は無視されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-165">If this option is set, the string comparison ignores symbols.</span></span> <span data-ttu-id="51f74-166">たとえば、" New York" は "New York" と同一になり、"\*ABC" は "ABC" と同一になります。</span><span class="sxs-lookup"><span data-stu-id="51f74-166">For example, " New York" becomes the same as "New York" and "\*ABC" is the same as "ABC"'.</span></span>|  
|<span data-ttu-id="51f74-167">句読点を記号として並べ替え</span><span class="sxs-lookup"><span data-stu-id="51f74-167">Sort punctuation as symbols</span></span>|<span data-ttu-id="51f74-168">比較で、ハイフンとアポストロフィを除くすべての句読点記号を、英数文字の前に並べ替えるかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="51f74-168">Specifies whether the comparison sorts all punctuation symbols, except the hyphen and apostrophe, before the alphanumeric characters.</span></span> <span data-ttu-id="51f74-169">たとえば、このオプションを設定すると、".ABC" は "ABC" の前に並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="51f74-169">For example, if this option is set, ".ABC" sorts before "ABC".</span></span>|  
  
 <span data-ttu-id="51f74-170">並べ替え変換、集計変換、あいまいグループ化変換、およびあいまい参照変換には、データを比較するためのこれらのオプションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="51f74-170">The Sort, Aggregate, Fuzzy Grouping and Fuzzy Lookup transformations include these options for comparing data.</span></span>  
  
 <span data-ttu-id="51f74-171">あいまいグループ化変換およびあいまい参照変換の **[詳細エディター]** ダイアログ ボックスには、 **[FullySensitive]** 比較フラグが表示されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-171">The **FullySensitive** comparison flag displays in the **Advanced Editor** dialog box for the Fuzzy Grouping and Fuzzy Lookup transformations.</span></span> <span data-ttu-id="51f74-172">**[FullySensitive]** 比較フラグを選択すると、すべての比較オプションが適用されます。</span><span class="sxs-lookup"><span data-stu-id="51f74-172">Selecting the **FullySensitive** comparison flag means that all the comparison options apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="51f74-173">参照</span><span class="sxs-lookup"><span data-stu-id="51f74-173">See Also</span></span>  
 <span data-ttu-id="51f74-174">[Integration Services のデータ型](integration-services-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="51f74-174">[Integration Services Data Types](integration-services-data-types.md) </span></span>  
 <span data-ttu-id="51f74-175">[高速解析](../fast-parse.md) </span><span class="sxs-lookup"><span data-stu-id="51f74-175">[Fast Parse](../fast-parse.md) </span></span>  
 [<span data-ttu-id="51f74-176">標準解析</span><span class="sxs-lookup"><span data-stu-id="51f74-176">Standard Parse</span></span>](../standard-parse.md)  
  
  
