---
title: パッケージで変数を使用する |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: chugugrace
ms.author: chugu
ms.openlocfilehash: acfb6813406bd3a143712e40ec510a4658d4e5da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633196"
---
# <a name="use-variables-in-packages"></a><span data-ttu-id="6d340-102">パッケージで変数を使用する</span><span class="sxs-lookup"><span data-stu-id="6d340-102">Use Variables in Packages</span></span>
  <span data-ttu-id="6d340-103">変数は、 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] パッケージに追加できる便利で柔軟な機能です。変数を使用すると、パッケージのオブジェクト間、および親パッケージと子パッケージとの間で情報を交換できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-103">Variables are a useful and flexible addition to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages; they can provide communication among objects in the package, and between parent and child packages.</span></span> <span data-ttu-id="6d340-104">また、変数は式やスクリプトでも使用できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-104">Variables can also be used in expressions and scripts.</span></span>  
  
## <a name="user-defined-variables-and-system-variables"></a><span data-ttu-id="6d340-105">ユーザー定義変数とシステム変数</span><span class="sxs-lookup"><span data-stu-id="6d340-105">User-Defined Variables and System Variables</span></span>  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="6d340-106">ではシステム変数が用意されているほか、ユーザー定義変数をサポートします。</span><span class="sxs-lookup"><span data-stu-id="6d340-106">provides system variables and supports user-defined variables.</span></span> <span data-ttu-id="6d340-107">新しいパッケージを作成した場合、コンテナーやタスクをパッケージに追加した場合、またはイベント ハンドラーを作成した場合、 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] によってコンテナーに一連のシステム変数が追加されます。</span><span class="sxs-lookup"><span data-stu-id="6d340-107">When you create a new package, add a container or a task to a package, or create an event handler, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] includes a set of system variables for the container.</span></span> <span data-ttu-id="6d340-108">システム変数には、パッケージ、コンテナー、タスク、またはイベント ハンドラーに関する有益な情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="6d340-108">System variables contain useful information about a package, container, task, or event handler.</span></span> <span data-ttu-id="6d340-109">たとえば、パッケージの実行時に、 **MachineName** システム変数にはパッケージを実行しているコンピューターの名前が含まれ、 **StartTime** にはパッケージの実行が開始された時刻が含まれます。</span><span class="sxs-lookup"><span data-stu-id="6d340-109">For example, at run time the **MachineName** system variable contains the name of the computer on which the package is running and **StartTime** the time the package started to run.</span></span> <span data-ttu-id="6d340-110">システム変数は読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="6d340-110">System variables are read-only.</span></span> <span data-ttu-id="6d340-111">詳細については、「 [システム変数](system-variables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-111">For more information, see [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="6d340-112">ユーザー定義変数を作成して、パッケージで使用できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-112">You can create user-defined variables and then use them in packages.</span></span> <span data-ttu-id="6d340-113">ユーザー定義変数は、 [!INCLUDE[ssIS](../includes/ssis-md.md)]の優先順位制約、For ループ コンテナー、派生列変換、および条件分割変換で使用される式、スクリプト、およびプロパティの値を更新するプロパティ式など、多くの方法で使用できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-113">User-defined variables can be used in many ways in [!INCLUDE[ssIS](../includes/ssis-md.md)]: in scripts; in the expressions used by precedence constraints, the For Loop container, the Derived Column transformation, and the Conditional Split transformation; and in the property expressions that update property values.</span></span>  
  
 <span data-ttu-id="6d340-114">たとえば、For ループ コンテナーの評価条件でユーザー定義変数を使用できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-114">For example, you can use a user-defined variable in the evaluation condition for the For Loop container.</span></span> <span data-ttu-id="6d340-115">また、Foreach ループ コンテナーの列挙子コレクション値を変数にマップしたり、SQL 実行タスクがパラメーター化された SQL ステートメントを使用する場合にステートメントのパラメーターを変数にマップしたりできます。</span><span class="sxs-lookup"><span data-stu-id="6d340-115">You can also map the enumerator collection value in a Foreach Loop container to a variable, and if an Execute SQL task uses a parameterized SQL statement, you can map the parameters for the statement to variables.</span></span> <span data-ttu-id="6d340-116">詳細については、「 [Integration Services &#40;SSIS&#41; の変数](integration-services-ssis-variables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-116">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>  
  
## <a name="variables-usage-scenarios"></a><span data-ttu-id="6d340-117">変数の使用法のシナリオ</span><span class="sxs-lookup"><span data-stu-id="6d340-117">Variables Usage Scenarios</span></span>  
 <span data-ttu-id="6d340-118">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] パッケージでは、変数をさまざまな方法で使用します。</span><span class="sxs-lookup"><span data-stu-id="6d340-118">Variables are used in many different ways in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages.</span></span> <span data-ttu-id="6d340-119">パッケージにユーザー定義変数を追加して、ソリューションに必要な柔軟性と管理性を実装しないと、パッケージ開発があまり進まない場合もあります。</span><span class="sxs-lookup"><span data-stu-id="6d340-119">You will probably find that package development does not progress far before you have to add a user-defined variable to your package to implement the flexibility and manageability your solution requires.</span></span> <span data-ttu-id="6d340-120">シナリオによっては、システム変数もよく使用します。</span><span class="sxs-lookup"><span data-stu-id="6d340-120">Depending on the scenario, system variables are also commonly used.</span></span>  
  
 <span data-ttu-id="6d340-121">**プロパティの式** パッケージおよびパッケージ オブジェクトのプロパティを設定するプロパティ式に値を提供するために、変数を使用します。</span><span class="sxs-lookup"><span data-stu-id="6d340-121">**Property Expressions** Use variables to provide values in the property expressions that set the properties of packages and package objects.</span></span> <span data-ttu-id="6d340-122">たとえば、式 `SELECT * FROM @varTableName` に含まれている変数 `varTableName` は、SQL 実行タスクによって実行される SQL ステートメントを更新します。</span><span class="sxs-lookup"><span data-stu-id="6d340-122">For example, the expression, `SELECT * FROM @varTableName` includes the variable `varTableName` that updates the SQL statement that an Execute SQL task runs.</span></span> <span data-ttu-id="6d340-123">式 `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`では、 `varPackageFirst` 変数で指定されたパッケージを月の最初の日に実行し、 `varPackageOther` 変数で指定されたパッケージを別の日に実行することにより、[パッケージの実行] タスクで実行されるパッケージを更新しています。</span><span class="sxs-lookup"><span data-stu-id="6d340-123">The expression, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", updates the package that the Execute Package task runs, by running the package specified in the `varPackageFirst` variable on the first day of the month and running the package specified in the `varPackageOther` variable on other days.</span></span> <span data-ttu-id="6d340-124">詳細については、「 [パッケージでプロパティ式を使用する](expressions/use-property-expressions-in-packages.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-124">For more information, see [Use Property Expressions in Packages](expressions/use-property-expressions-in-packages.md).</span></span>  
  
 <span data-ttu-id="6d340-125">**データ フロー式** 変数を使用して、派生列変換と条件分割変換で列に値を設定するための式や、データ行を各種の変換出力に送るための式に値を提供します。</span><span class="sxs-lookup"><span data-stu-id="6d340-125">**Data Flow Expressions** Use variables to provide values in the expressions that the Derived Column and Conditional Split transformations use to populate columns, or to direct data rows to different transformation outputs.</span></span> <span data-ttu-id="6d340-126">たとえば、式 `@varSalutation + LastName`は、 `VarSalutation` 変数の値と `LastName` 列を連結します。</span><span class="sxs-lookup"><span data-stu-id="6d340-126">For example, the expression, `@varSalutation + LastName`, concatenates the value in the `VarSalutation` variable and the `LastName` column.</span></span> <span data-ttu-id="6d340-127">式 `Income < @HighIncome` は、`Income` 列の値が `HighIncome` 変数の値よりも小さいデータ行を出力に送信します。</span><span class="sxs-lookup"><span data-stu-id="6d340-127">The expression, `Income < @HighIncome`, directs data rows in which the value of the `Income` column is less than the value in the `HighIncome` variable to an output.</span></span> <span data-ttu-id="6d340-128">詳細については、「[派生列変換](data-flow/transformations/derived-column-transformation.md)」、「[条件分割変換](data-flow/transformations/conditional-split-transformation.md)」、および「[Integration Services (SSIS) の式](expressions/integration-services-ssis-expressions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-128">For more information, see [Derived Column Transformation](data-flow/transformations/derived-column-transformation.md), [Conditional Split Transformation](data-flow/transformations/conditional-split-transformation.md), and [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="6d340-129">**優先順位制約の式** 優先順位制約で制約付き実行可能ファイルを実行するかどうかを決定するために使用する値を提供します。</span><span class="sxs-lookup"><span data-stu-id="6d340-129">**Precedence Constraint Expressions** Provide values to use in precedence constraints to determine whether a constrained executable runs.</span></span> <span data-ttu-id="6d340-130">これらの式は、実行結果 (成功、失敗、完了) と組み合わせて使用することも、実行結果の代わりに使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="6d340-130">The expressions can be used either together with an execution outcome (success, failure, completion), or instead of an execution outcome.</span></span> <span data-ttu-id="6d340-131">たとえば、式 `@varMax > @varMin` が `true` に評価される場合、実行可能ファイルは実行されます。</span><span class="sxs-lookup"><span data-stu-id="6d340-131">For example, if the expression, `@varMax > @varMin`, evaluates to `true`, the executable runs.</span></span> <span data-ttu-id="6d340-132">詳細については、「 [優先順位制約に式を追加する](control-flow/precedence-constraints.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-132">For more information, see [Add Expressions to Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="6d340-133">**パラメーターおよびリターン コード** 入力パラメーターに値を提供したり、出力パラメーターおよびリターン コードの値を格納したりします。</span><span class="sxs-lookup"><span data-stu-id="6d340-133">**Parameters and Return Codes** Provide values to input parameters, or store the values of output parameters and return codes.</span></span> <span data-ttu-id="6d340-134">そのためには、変数をパラメーターおよび戻り値にマップします。</span><span class="sxs-lookup"><span data-stu-id="6d340-134">You do this by mapping the variables to parameters and return values.</span></span> <span data-ttu-id="6d340-135">たとえば、変数 `varProductId` を 23 に設定して SQL ステートメント `SELECT * from Production.Product WHERE ProductID = ?`を実行すると、 `ProductID` が 23 である製品が取得されます。</span><span class="sxs-lookup"><span data-stu-id="6d340-135">For example, if you set the variable `varProductId` to 23 and run the SQL statement, `SELECT * from Production.Product WHERE ProductID = ?`, the query retrieves the product with a `ProductID` of 23.</span></span> <span data-ttu-id="6d340-136">詳細については、「 [SQL 実行タスク](control-flow/execute-sql-task.md) 」と「 [SQL 実行タスクのパラメーターとリターン コード](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-136">For more information, see [Execute SQL Task](control-flow/execute-sql-task.md) and [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="6d340-137">**For ループ式** For ループの初期化式、評価式、および代入式で使用する値を提供します。</span><span class="sxs-lookup"><span data-stu-id="6d340-137">**For Loop Expressions** Provide values to use in the initialization, evaluation, and assignment expressions of the For Loop.</span></span> <span data-ttu-id="6d340-138">たとえば、変数 `varCount` が 2、変数 `varMaxCount` が 10、初期化式が `@varCount`、評価式が  `@varCount < @varMaxCount`、代入式が `@varCount =@varCount +1`の場合、ループは 8 回繰り返されます。</span><span class="sxs-lookup"><span data-stu-id="6d340-138">For example, if the variable `varCount` is 2 and `varMaxCount` is 10, the initialization expression is `@varCount`, the evaluation expression is  `@varCount < @varMaxCount`, and the assignment expression is `@varCount =@varCount +1`, then the loop repeats 8 times.</span></span> <span data-ttu-id="6d340-139">詳細については、「 [For ループ コンテナー](control-flow/for-loop-container.md)に評価されるまでそのワークフローを繰り返します。</span><span class="sxs-lookup"><span data-stu-id="6d340-139">For more information, see [For Loop Container](control-flow/for-loop-container.md).</span></span>  
  
 <span data-ttu-id="6d340-140">**親パッケージ変数の構成** 親パッケージから子パッケージに値を渡します。</span><span class="sxs-lookup"><span data-stu-id="6d340-140">**Parent Package Variable Configurations** Pass values from parent packages to child packages.</span></span> <span data-ttu-id="6d340-141">子パッケージは、親パッケージ変数の構成を使用することにより、親パッケージの変数にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6d340-141">Child packages can access variables in the parent package by using parent package variable configurations.</span></span> <span data-ttu-id="6d340-142">たとえば、子パッケージが親パッケージと同じ日付を使用する必要がある場合、子パッケージは親パッケージの GETDATE 関数によって設定される変数を指定する親パッケージ変数の構成を定義できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-142">For example, if the child package must use the same date as the parent package, the child package can define a parent package variable configuration that specifies a variable set by the GETDATE function in the parent package.</span></span> <span data-ttu-id="6d340-143">詳細については、「 [パッケージ実行タスク](control-flow/execute-package-task.md) 」と「 [パッケージ構成](../../2014/integration-services/package-configurations.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-143">For more information, see [Execute Package Task](control-flow/execute-package-task.md) and [Package Configurations](../../2014/integration-services/package-configurations.md).</span></span>  
  
 <span data-ttu-id="6d340-144">**スクリプト タスクおよびスクリプト コンポーネント** 読み取り専用変数および読み取り/書き込み変数の一覧をスクリプト タスクまたはスクリプト コンポーネントに提供し、スクリプト内の読み取り/書き込み変数を更新して、更新された値をスクリプトの内外で使用します。</span><span class="sxs-lookup"><span data-stu-id="6d340-144">**Script Task and Script Component** Provide a list of read-only and read/write variable to the Script task or Script component, update the read/write variables within the script, and then use the updated values in or outside the script.</span></span> <span data-ttu-id="6d340-145">たとえば、コード `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`では、スクリプト変数 `numberOfCars` が変数 `NumberOfCars`の値によって更新されます。</span><span class="sxs-lookup"><span data-stu-id="6d340-145">For example, in the code, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, the script variable `numberOfCars` is updated by the value in the variable, `NumberOfCars`.</span></span> <span data-ttu-id="6d340-146">詳細については、「 [スクリプト タスクでの変数の使用](control-flow/script-task.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-146">For more information, see [Using Variables in the Script Task](control-flow/script-task.md).</span></span>  
  
## <a name="configurations-and-variables"></a><span data-ttu-id="6d340-147">構成と変数</span><span class="sxs-lookup"><span data-stu-id="6d340-147">Configurations and Variables</span></span>  
 <span data-ttu-id="6d340-148">変数を動的に更新するために、変数の構成を作成し、パッケージと共に構成を配置して、パッケージの配置時に構成ファイルの変数の値を更新できます。</span><span class="sxs-lookup"><span data-stu-id="6d340-148">To dynamically update variables, you can create configurations for the variables, deploy the configurations with the package, and then update the variable values in the configuration file when you deploy the packages.</span></span> <span data-ttu-id="6d340-149">実行時に、パッケージは更新された変数の値を使用します。</span><span class="sxs-lookup"><span data-stu-id="6d340-149">At run time, the package uses the updated variable values.</span></span> <span data-ttu-id="6d340-150">詳細については、「 [パッケージ構成を作成する](../../2014/integration-services/create-package-configurations.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d340-150">For more information, see [Create Package Configurations](../../2014/integration-services/create-package-configurations.md).</span></span>  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a><span data-ttu-id="6d340-151">ユーザー定義変数を追加、修正、および削除するには</span><span class="sxs-lookup"><span data-stu-id="6d340-151">To add, modify, and delete user-defined variables</span></span>  
  
-   [<span data-ttu-id="6d340-152">パッケージ内のユーザー定義変数のスコープの追加、削除、変更</span><span class="sxs-lookup"><span data-stu-id="6d340-152">Add, Delete, Change Scope of User-Defined Variable in a Package</span></span>](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [<span data-ttu-id="6d340-153">ユーザー定義変数のプロパティを設定する</span><span class="sxs-lookup"><span data-stu-id="6d340-153">Set the Properties of a User-Defined Variable</span></span>](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
