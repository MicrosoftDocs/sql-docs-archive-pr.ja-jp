---
title: Integration Services パッケージのアップグレード | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services, migrating
- migrating packages [Integration Services]
ms.assetid: 68dbdf81-032c-4a73-99f6-41420e053980
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5a6ca4f80b25a8cc4628da4382c1aae971c74bf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87641147"
---
# <a name="upgrade-integration-services-packages"></a><span data-ttu-id="a1e3c-102">Integration Services パッケージのアップグレード</span><span class="sxs-lookup"><span data-stu-id="a1e3c-102">Upgrade Integration Services Packages</span></span>
  <span data-ttu-id="a1e3c-103">またはのインスタンスを [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] の現在のリリースにアップグレードすると [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 、既存の [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] パッケージは、現在のリリースで使用されているパッケージ形式に自動的にアップグレードされません [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-103">When you upgrade an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your existing [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] packages are not automatically upgraded to the package format that the current release [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] uses.</span></span> <span data-ttu-id="a1e3c-104">アップグレード方法を選択して、パッケージを手動でアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-104">You will have to select an upgrade method and manually upgrade your packages.</span></span>  
  
 <span data-ttu-id="a1e3c-105">パッケージをアップグレードすると [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 、によって、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 任意のスクリプトタスクおよびスクリプトコンポーネントのスクリプトが [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] TOOLS for Applications (VSTA) に移行されます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-105">When you upgrade a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] migrates the scripts in any Script task and Script component to [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA).</span></span> <span data-ttu-id="a1e3c-106">では [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 、スクリプトタスクまたはスクリプトコンポーネント内のスクリプトは、 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] アプリケーション (VSA) に使用されます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-106">In [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the scripts in Script tasks or Script components used [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] for Applications (VSA).</span></span> <span data-ttu-id="a1e3c-107">移行前に必要となる可能性があるスクリプトへの変更やスクリプトの変換エラーに関する詳細については、「[VSTA へのスクリプトの移行](../../sql-server/install/migrate-scripts-to-vsta.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-107">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>  
  
 <span data-ttu-id="a1e3c-108">プロジェクトをプロジェクトの配置モデルに変換する際のパッケージのアップグレードについては、「 [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-108">For information on upgrading packages when you convert a project to the project deployment model, see [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md).</span></span>  
  
## <a name="sql-server-2000-data-transformation-services-packages"></a><span data-ttu-id="a1e3c-109">SQL Server 2000 データ変換サービス パッケージ</span><span class="sxs-lookup"><span data-stu-id="a1e3c-109">SQL Server 2000 Data Transformation Services Packages</span></span>  
 <span data-ttu-id="a1e3c-110">現在のリリースのでは、データ変換サービス (DTS) パッケージの移行または実行のサポートは廃止されました [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-110">Support for migrating or running Data Transformation Services (DTS) packages has been discontinued in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="a1e3c-111">次の DTS 機能は廃止されました。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-111">The following DTS functionality has been discontinued.</span></span>  
  
-   <span data-ttu-id="a1e3c-112">DTS ランタイム</span><span class="sxs-lookup"><span data-stu-id="a1e3c-112">DTS runtime</span></span>  
  
-   <span data-ttu-id="a1e3c-113">DTS API</span><span class="sxs-lookup"><span data-stu-id="a1e3c-113">DTS API</span></span>  
  
-   <span data-ttu-id="a1e3c-114">DTS パッケージを次期バージョンの [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a1e3c-114">Package Migration Wizard for migrating DTS packages to the next version of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span></span>  
  
-   <span data-ttu-id="a1e3c-115">DTS パッケージのメンテナンス機能のサポート [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a1e3c-115">Support for DTS package maintenance in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span></span>  
  
-   <span data-ttu-id="a1e3c-116">DTS 2000 パッケージ実行タスク</span><span class="sxs-lookup"><span data-stu-id="a1e3c-116">Execute DTS 2000 Package task</span></span>  
  
-   <span data-ttu-id="a1e3c-117">アップグレード アドバイザーによる DTS パッケージのスキャン</span><span class="sxs-lookup"><span data-stu-id="a1e3c-117">Upgrade Advisor scan of DTS packages.</span></span>  
  
 <span data-ttu-id="a1e3c-118">DTS パッケージを移行する場合は、次のオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-118">The following options are available for migrating DTS packages.</span></span>  
  
-   <span data-ttu-id="a1e3c-119">パッケージを [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] または [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] に移行し、その後でパッケージを [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] にアップグレードする。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-119">Migrate the packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], and then upgrade the packages to [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="a1e3c-120">[!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] と [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] に DTS パッケージを移行する方法の詳細については、「[データ変換サービス パッケージの移行](https://go.microsoft.com/fwlink/?LinkId=251870)」(2005) および「[データ変換サービス パッケージの移行](https://go.microsoft.com/fwlink/?LinkId=251871)」(2008) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-120">For information about migrating DTS packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] and [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], see [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) and [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251871) (2008).</span></span>  
  
-   <span data-ttu-id="a1e3c-121">[!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] を使用して DTS パッケージを再作成する。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-121">Recreate the DTS packages by using [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="a1e3c-122">[!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] の新機能については、「[新機能 &#40;Integration Services&#41;](../what-s-new-in-integration-services-in-sql-server-2016.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-122">For information about the new features in [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)], see [What's New &#40;Integration Services&#41;](../what-s-new-in-integration-services-in-sql-server-2016.md).</span></span> <span data-ttu-id="a1e3c-123">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] パッケージの構造の概要については、「[Integration Services &#40;SSIS&#41; パッケージ](../integration-services-ssis-packages.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-123">For an overview of the structure of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [Integration Services &#40;SSIS&#41; Packages](../integration-services-ssis-packages.md).</span></span>  
  
## <a name="selecting-an-upgrade-method"></a><span data-ttu-id="a1e3c-124">アップグレード方法の選択</span><span class="sxs-lookup"><span data-stu-id="a1e3c-124">Selecting an Upgrade Method</span></span>  
 <span data-ttu-id="a1e3c-125">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] および [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] パッケージは、さまざまな方法でアップグレードできます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-125">You can use various methods to upgrade [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages.</span></span> <span data-ttu-id="a1e3c-126">その方法によって、アップグレードが一時的な場合と</span><span class="sxs-lookup"><span data-stu-id="a1e3c-126">For some of these methods, the upgrade is only temporary.</span></span> <span data-ttu-id="a1e3c-127">永続的な場合があります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-127">For others, the upgrade is permanent.</span></span> <span data-ttu-id="a1e3c-128">次の表に、それらの各方法とアップグレードが一時的か永続的かを示します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-128">The following table describes each of these methods and whether the upgrade is temporary or permanent.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a1e3c-129">現在のリリースの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] と共にインストールされる **dtexec** ユーティリティ (dtexec.exe) を使用して [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]または [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] パッケージを実行すると、一時パッケージのアップグレードが行われることで、実行時間が増加します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-129">When you run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package using the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the temporary package upgrade increases the execution time.</span></span> <span data-ttu-id="a1e3c-130">パッケージ実行時間の増加比率は、パッケージのサイズに応じて異なります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-130">The rate of increase in package execution time varies depending on the size of the package.</span></span> <span data-ttu-id="a1e3c-131">実行時間が増加しないようにするには、パッケージの実行前にアップグレードしておくことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-131">To avoid an increase in the execution time, it is recommended that you upgrade the package before running it.</span></span>  
  
|<span data-ttu-id="a1e3c-132">アップグレード方法</span><span class="sxs-lookup"><span data-stu-id="a1e3c-132">Upgrade Method</span></span>|<span data-ttu-id="a1e3c-133">アップグレードの種類</span><span class="sxs-lookup"><span data-stu-id="a1e3c-133">Type of Upgrade</span></span>|  
|--------------------|---------------------|  
|<span data-ttu-id="a1e3c-134">現在のリリースの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] と共にインストールされる **dtexec** ユーティリティ (dtexec.exe) を使用して、[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] または [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] パッケージを実行します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-134">Use the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package.</span></span><br /><br /> <span data-ttu-id="a1e3c-135">詳細については、「[dtexec ユーティリティ](../packages/dtexec-utility.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-135">For more information, see [dtexec Utility](../packages/dtexec-utility.md).</span></span>|<span data-ttu-id="a1e3c-136">パッケージのアップグレードは一時的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-136">The package upgrade is temporary.</span></span> <span data-ttu-id="a1e3c-137">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] パッケージでは、スクリプトの移行は一時的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-137">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is temporary.</span></span><br /><br /> <span data-ttu-id="a1e3c-138">変更を保存することはできません。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-138">The changes cannot be saved.</span></span>|  
|<span data-ttu-id="a1e3c-139">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] で [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] または [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] パッケージ ファイルを開きます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-139">Open a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package file in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="a1e3c-140">パッケージのアップグレードは、パッケージを保存した場合は永続的になり、パッケージを保存しなかった場合は一時的になります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-140">The package upgrade is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span><br /><br /> <span data-ttu-id="a1e3c-141">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] パッケージでは、スクリプトの移行は、パッケージを保存した場合は永続的になり、パッケージを保存しなかった場合は一時的になります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-141">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span>|  
|<span data-ttu-id="a1e3c-142">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] または [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] パッケージを [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] の既存のプロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-142">Add a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package to an existing project in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="a1e3c-143">パッケージのアップグレードは永続的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-143">The package upgrade is permanent.</span></span> <span data-ttu-id="a1e3c-144">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] パッケージでは、スクリプトの移行は永続的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-144">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="a1e3c-145">[!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] で [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] または [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] プロジェクト ファイルを開き、[!INCLUDE[ssIS](../../includes/ssis-md.md)] パッケージ アップグレード ウィザードを使用してプロジェクト内の複数のパッケージをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-145">Open a [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] project file in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], and then use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade multiple packages in the project.</span></span><br /><br /> <span data-ttu-id="a1e3c-146">詳細については、「 [SSIS パッケージ アップグレード ウィザードを使用した Integration Services パッケージのアップグレード](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) 」および [SSIS パッケージ アップグレード ウィザードの F1 ヘルプ](../ssis-package-upgrade-wizard-f1-help.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-146">For more information, see [Upgrade Integration Services Packages Using the SSIS Package Upgrade Wizard](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) and [SSIS Package Upgrade Wizard F1 Help](../ssis-package-upgrade-wizard-f1-help.md).</span></span>|<span data-ttu-id="a1e3c-147">パッケージのアップグレードは永続的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-147">The package upgrade is permanent.</span></span> <span data-ttu-id="a1e3c-148">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] パッケージでは、スクリプトの移行は永続的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-148">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="a1e3c-149">現在のリリースの <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> メソッドを使用して、1 つまたは複数の [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] パッケージは、さまざまな方法でアップグレードできます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-149">Use the <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> method to upgrade one or more [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages.</span></span>|<span data-ttu-id="a1e3c-150">パッケージのアップグレードは永続的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-150">The package upgrade is permanent.</span></span> <span data-ttu-id="a1e3c-151">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] パッケージでは、スクリプトの移行は永続的です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-151">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
  
## <a name="custom-applications-and-custom-components"></a><span data-ttu-id="a1e3c-152">カスタム アプリケーションおよびカスタム コンポーネント</span><span class="sxs-lookup"><span data-stu-id="a1e3c-152">Custom Applications and Custom Components</span></span>  
 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] <span data-ttu-id="a1e3c-153">現在のリリースの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]では、 カスタム コンポーネントが動作しません。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-153">custom components will not work with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="a1e3c-154">現在のリリースのツールを使用して、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] およびカスタムコンポーネントを含むパッケージを実行および管理でき [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssIS](../../includes/ssis-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-154">You can use the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tools to run and manage packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)][!INCLUDE[ssIS](../../includes/ssis-md.md)] custom components.</span></span> <span data-ttu-id="a1e3c-155">ランタイム アセンブリを Version 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) から Version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]) にリダイレクトする際に役立つ 4 つのバインド リダイレクト ルールが次のファイルに追加されました。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-155">We added four binding redirection rules to the following files to help redirect the runtime assemblies from version 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span>  
  
-   <span data-ttu-id="a1e3c-156">DTExec.exe.config</span><span class="sxs-lookup"><span data-stu-id="a1e3c-156">DTExec.exe.config</span></span>  
  
-   <span data-ttu-id="a1e3c-157">dtshost.exe.config</span><span class="sxs-lookup"><span data-stu-id="a1e3c-157">dtshost.exe.config</span></span>  
  
-   <span data-ttu-id="a1e3c-158">DTSWizard.exe.config</span><span class="sxs-lookup"><span data-stu-id="a1e3c-158">DTSWizard.exe.config</span></span>  
  
-   <span data-ttu-id="a1e3c-159">DTUtil.exe.config</span><span class="sxs-lookup"><span data-stu-id="a1e3c-159">DTUtil.exe.config</span></span>  
  
-   <span data-ttu-id="a1e3c-160">DTExecUI.exe.config</span><span class="sxs-lookup"><span data-stu-id="a1e3c-160">DTExecUI.exe.config</span></span>  
  
 <span data-ttu-id="a1e3c-161">を使用し [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] て、カスタムコンポーネントを含むパッケージを設計するに [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] は、 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] : common7\ide にあるファイルを devenv.exe.config 変更する必要があり *\<drive>* ます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-161">To use [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] to design packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] custom components, you need to modify the devenv.exe.config file that is located at *\<drive>*:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE.</span></span>  
  
 <span data-ttu-id="a1e3c-162">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]のランタイムで構築された顧客アプリケーションでこれらのパッケージを使用するには、実行可能ファイルに対応する \*.exe.config ファイルの configuration セクションにリダイレクト ルールを含めます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-162">To use these packages with customer applications that are built with the runtime for [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], include redirection rules in the configuration section of the \*.exe.config file for the executable.</span></span> <span data-ttu-id="a1e3c-163">これらのルールにより、ランタイム アセンブリが Version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]) にリダイレクトされます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-163">The rules redirect the runtime assemblies to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span> <span data-ttu-id="a1e3c-164">アセンブリ バージョン リダイレクトの詳細については、[\<runtime> の \<assemblyBinding> 要素](https://msdn.microsoft.com/library/twy1dw1e.aspx)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-164">For more information about assembly version redirection, see [\<assemblyBinding> Element for \<runtime>](https://msdn.microsoft.com/library/twy1dw1e.aspx).</span></span>  
  
### <a name="locating-the-assemblies"></a><span data-ttu-id="a1e3c-165">アセンブリの場所</span><span class="sxs-lookup"><span data-stu-id="a1e3c-165">Locating the Assemblies</span></span>  
 <span data-ttu-id="a1e3c-166">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]では、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] アセンブリが .NET 4 にアップグレードされました。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-166">In [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies were upgraded to .NET 4.0.</span></span> <span data-ttu-id="a1e3c-167">*\<drive>* :\Windows\Microsoft.NET\assembly に、.NET 4 用の別のグローバル アセンブリ キャッシュが用意されています。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-167">There is a separate global assembly cache for .NET 4, located in *\<drive>*:\Windows\Microsoft.NET\assembly.</span></span> <span data-ttu-id="a1e3c-168">すべての [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] アセンブリは、通常、このパスの GAC_MSIL フォルダーにあります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-168">You can find all of the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies under this path, usually in the GAC_MSIL folder.</span></span>  
  
 <span data-ttu-id="a1e3c-169">以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] と同様に、[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] のコア機能拡張 .dll ファイルは *\<drive>* :\Program Files\Microsoft SQL Server\100\SDK\Assemblies にあります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-169">As in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the core [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] extensibility .dll files are also located at *\<drive>*:\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span></span>  
  
## <a name="understanding-sql-server-package-upgrade-results"></a><span data-ttu-id="a1e3c-170">SQL Server パッケージのアップグレード結果について</span><span class="sxs-lookup"><span data-stu-id="a1e3c-170">Understanding SQL Server Package Upgrade Results</span></span>  
 <span data-ttu-id="a1e3c-171">パッケージのアップグレード プロセス中に、[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] および [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] パッケージ内のほとんどのコンポーネントと機能が、現在のリリースの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の対応するコンポーネントと機能にシームレスに変換されます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-171">During the package upgrade process, most components and features in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages convert seamlessly to their counterparts in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a1e3c-172">ただし、いくつかのコンポーネントと機能については、アップグレードされないか、アップグレード結果に注意が必要です。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-172">However, there are several components and features that either will not be upgraded or have upgrade results of which you should be aware.</span></span> <span data-ttu-id="a1e3c-173">それらのコンポーネントと機能を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-173">The following table identifies these components and features.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a1e3c-174">この表の一覧に示された問題を含むパッケージを識別するには、アップグレード アドバイザーを実行します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-174">To identify which packages have the issues listed in this table, run Upgrade Advisor.</span></span> <span data-ttu-id="a1e3c-175">詳細については、「 [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-175">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
|<span data-ttu-id="a1e3c-176">コンポーネントまたは機能</span><span class="sxs-lookup"><span data-stu-id="a1e3c-176">Component or Feature</span></span>|<span data-ttu-id="a1e3c-177">アップグレード結果</span><span class="sxs-lookup"><span data-stu-id="a1e3c-177">Upgrade Results</span></span>|  
|--------------------------|---------------------|  
|<span data-ttu-id="a1e3c-178">Connection strings</span><span class="sxs-lookup"><span data-stu-id="a1e3c-178">Connection strings</span></span>|<span data-ttu-id="a1e3c-179">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] および [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] パッケージでは、特定のプロバイダーの名前が変更されているため、接続文字列の値を変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-179">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages, the names of certain providers have changed and require different values in the connection strings.</span></span> <span data-ttu-id="a1e3c-180">接続文字列を更新するには、次のいずれかの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-180">To update the connection strings, use one of the following procedures:</span></span><br /><br /> <span data-ttu-id="a1e3c-181">- [!INCLUDE[ssIS](../../includes/ssis-md.md)] パッケージアップグレードウィザードを使用してパッケージをアップグレードし、[**新しいプロバイダー名を使用するための接続文字列を更新**する] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-181">-Use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade the package, and select the **Update connection strings to use new provider names** option.</span></span><br /><br /> <span data-ttu-id="a1e3c-182">-の [ [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] オプション] ダイアログボックスの [全般] ページで、[**新しいプロバイダー名を使用する接続文字列を更新する**] オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-182">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], on the General page of the Options dialog box, select the **Update connection strings to use new provider names** option.</span></span> <span data-ttu-id="a1e3c-183">このオプションの詳細については、「 [[全般] ページ](../general-page-of-integration-services-designers-options.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-183">For more information about this option, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span><br /><br /> <span data-ttu-id="a1e3c-184">[!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]でパッケージを開き、ConnectionString プロパティのテキストを手動で変更します。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-184">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open the package and manually change the text of the ConnectionString property.</span></span><br /><br /> <span data-ttu-id="a1e3c-185">注: 接続文字列が構成ファイルまたはデータ ソース ファイルに格納されている場合、または式で `ConnectionString` プロパティを設定する場合は、上記の手順を使用して接続文字列を更新することはできません。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-185">Note: You cannot use the previous procedures to update a connection string when the connection string is stored in either a configuration file or a data source file, or when an expression sets the `ConnectionString` property.</span></span> <span data-ttu-id="a1e3c-186">このような場合に接続文字列を更新するには、ファイルまたは式を手動で更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-186">To update the connection string in these cases, you must manually update the file or the expression.</span></span><br /><br /> <span data-ttu-id="a1e3c-187">使用できるデータ ソースの詳細については、「 [データ ソース](../connection-manager/data-sources.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-187">For more information about data sources, see [Data Sources](../connection-manager/data-sources.md).</span></span>|  
|<span data-ttu-id="a1e3c-188">参照変換</span><span class="sxs-lookup"><span data-stu-id="a1e3c-188">Lookup transformation</span></span>|<span data-ttu-id="a1e3c-189">パッケージの場合 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 、アップグレードプロセスでは、参照変換がの現在のリリースに自動的にアップグレードされ [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-189">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically upgrades the Lookup transformation to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="a1e3c-190">ただし、現在のリリースのこのコンポーネントには、それ以外にも利用できる機能がいくつか追加されています。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-190">However, the current release of this component has some additional capabilities of which you might want to take advantage.</span></span><br /><br /> <span data-ttu-id="a1e3c-191">詳細については、「 [Lookup Transformation](../data-flow/transformations/lookup-transformation.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-191">For more information, see [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span></span>|  
|<span data-ttu-id="a1e3c-192">スクリプト タスクとスクリプト コンポーネント</span><span class="sxs-lookup"><span data-stu-id="a1e3c-192">Script task and Script component</span></span>|<span data-ttu-id="a1e3c-193">スクリプト タスクおよびスクリプト コンポーネント内のスクリプトは、[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] パッケージのアップグレード プロセスで VSA から VSTA に自動的に移行されます。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-193">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically migrates scripts in the Script task and Script component from VSA to VSTA.</span></span><br /><br /> <span data-ttu-id="a1e3c-194">移行前に必要となる可能性があるスクリプトへの変更やスクリプトの変換エラーに関する詳細については、「[VSTA へのスクリプトの移行](../../sql-server/install/migrate-scripts-to-vsta.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-194">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>|  
  
### <a name="scripts-that-depend-on-adodbdll"></a><span data-ttu-id="a1e3c-195">ADODB.dll に依存するスクリプト</span><span class="sxs-lookup"><span data-stu-id="a1e3c-195">Scripts that Depend on ADODB.dll</span></span>  
 <span data-ttu-id="a1e3c-196">[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] または [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] がインストールされていないコンピューターでは、ADODB.dll を明示的に参照するスクリプト タスクおよびスクリプト コンポーネントのスクリプトをアップグレードしたり、実行したりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-196">Script Task and Script Component scripts that explicitly reference ADODB.dll may not upgrade or run on machines without [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] installed.</span></span> <span data-ttu-id="a1e3c-197">このようなスクリプト タスクまたはスクリプト コンポーネントのスクリプトをアップグレードするには、ADODB.dll に対する依存関係を削除することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-197">In order to upgrade these Script Task or Script Component scripts, it is recommended that you remove the dependency on ADODB.dll.</span></span>  <span data-ttu-id="a1e3c-198">また、VB や C# のスクリプトなどのマネージド コードの代わりに ADO.NET を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a1e3c-198">Ado.Net is the recommended alternative for managed code such as VB and C# scripts.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="a1e3c-199">外部リソース</span><span class="sxs-lookup"><span data-stu-id="a1e3c-199">External Resources</span></span>  
  
-   <span data-ttu-id="a1e3c-200">msdn.microsoft.com の技術記事「[SSIS から SQL Server 2012 へのスムーズなアップグレードのための 5 つのヒント](https://go.microsoft.com/fwlink/?LinkId=235321)」</span><span class="sxs-lookup"><span data-stu-id="a1e3c-200">Technical article, [5 Tips for a Smooth SSIS Upgrade to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=235321), on msdn.microsoft.com.</span></span>  
  
-   <span data-ttu-id="a1e3c-201">blogs.msdn.com のブログ記事「 [既存のカスタムSSIS拡張機能とアプリケーションをデナリで動作させる](https://go.microsoft.com/fwlink/?LinkId=238157)」</span><span class="sxs-lookup"><span data-stu-id="a1e3c-201">Blog entry, [Making your Existing Custom SSIS Extensions and Applications Work in Denali](https://go.microsoft.com/fwlink/?LinkId=238157), on blogs.msdn.com.</span></span>  
  
-   <span data-ttu-id="a1e3c-202">channel9.msdn.com の Web キャスト「[Upgrading SSIS Packages to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674)」</span><span class="sxs-lookup"><span data-stu-id="a1e3c-202">Webcast, [Upgrading SSIS Packages to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674), on channel9.msdn.com.</span></span>  
  
  
