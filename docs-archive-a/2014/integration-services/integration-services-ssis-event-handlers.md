---
title: Integration Services (SSIS) のイベント ハンドラー | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services packages, events
- run-time [Integration Services]
- SQL Server Integration Services packages, events
- event handlers [Integration Services], about event handlers
- events [Integration Services]
- packages [Integration Services], events
- event handlers [Integration Services]
- SSIS packages, events
- containers [Integration Services], events
- events [Integration Services], about events
ms.assetid: 6f60cf93-35dc-431c-908d-2049c4ab66ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 78bcd6579aa8306c89fd9530fad3557ac57f102a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87641130"
---
# <a name="integration-services-ssis-event-handlers"></a><span data-ttu-id="0271f-102">Integration Services (SSIS) のイベント ハンドラー</span><span class="sxs-lookup"><span data-stu-id="0271f-102">Integration Services (SSIS) Event Handlers</span></span>
  <span data-ttu-id="0271f-103">実行可能ファイル (パッケージ、Foreach ループ コンテナー、For ループ コンテナー、シーケンス コンテナー、およびタスク ホスト コンテナー) は実行時にイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="0271f-103">At run time, executables (packages and Foreach Loop, For Loop, Sequence, and task host containers) raise events.</span></span> <span data-ttu-id="0271f-104">たとえば、エラーが発生すると、OnError イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-104">For example, an OnError event is raised when an error occurs.</span></span> <span data-ttu-id="0271f-105">これらのイベントに対してカスタム イベント ハンドラーを作成し、パッケージ機能を拡張すると、実行時のパッケージを容易に管理できます。</span><span class="sxs-lookup"><span data-stu-id="0271f-105">You can create custom event handlers for these events to extend package functionality and make packages easier to manage at run time.</span></span> <span data-ttu-id="0271f-106">イベント ハンドラーは、次のタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="0271f-106">Event handlers can perform tasks such as the following:</span></span>

-   <span data-ttu-id="0271f-107">パッケージまたはタスクの実行が完了したとき、一時データ ストレージをクリーンアップします。</span><span class="sxs-lookup"><span data-stu-id="0271f-107">Clean up temporary data storage when a package or task finishes running.</span></span>

-   <span data-ttu-id="0271f-108">システム情報を取得して、パッケージを実行する前にリソースの可用性を評価します。</span><span class="sxs-lookup"><span data-stu-id="0271f-108">Retrieve system information to assess resource availability before a package runs.</span></span>

-   <span data-ttu-id="0271f-109">参照テーブル内の参照が失敗したとき、テーブル内のデータを更新します。</span><span class="sxs-lookup"><span data-stu-id="0271f-109">Refresh data in a table when a lookup in a reference table fails.</span></span>

-   <span data-ttu-id="0271f-110">エラーまたは警告が発生したとき、またはタスクが失敗したときに、電子メール メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="0271f-110">Send an e-mail message when an error or a warning occurs or when a task fails.</span></span>

 <span data-ttu-id="0271f-111">イベントにイベント ハンドラーがない場合、パッケージのコンテナー階層で上位にあたる次のコンテナーでイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-111">If an event has no event handler, the event is raised to the next container up the container hierarchy in a package.</span></span> <span data-ttu-id="0271f-112">このコンテナーにイベント ハンドラーがある場合、イベントに応答してイベント ハンドラーが実行されます。</span><span class="sxs-lookup"><span data-stu-id="0271f-112">If this container has an event handler, the event handler runs in response to the event.</span></span> <span data-ttu-id="0271f-113">イベント ハンドラーがない場合、コンテナー階層で上位にあたる次のコンテナーでイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-113">If not, the event is raised to the next container up the container hierarchy.</span></span>

 <span data-ttu-id="0271f-114">次の図は、1 つの SQL 実行タスクを含む For ループ コンテナーを持つ、簡単なパッケージを示しています。</span><span class="sxs-lookup"><span data-stu-id="0271f-114">The following diagram shows a simple package that has a For Loop container that contains one Execute SQL task.</span></span>

 <span data-ttu-id="0271f-115">![パッケージ、For ループ、タスク ホスト、および SQL 実行タスク](media/mw-dts-eventhandlerpkg.gif "パッケージ、For ループ、タスク ホスト、および SQL 実行タスク")</span><span class="sxs-lookup"><span data-stu-id="0271f-115">![Package, For Loop, task host, and Execute SQL task](media/mw-dts-eventhandlerpkg.gif "Package, For Loop, task host, and Execute SQL task")</span></span>

 <span data-ttu-id="0271f-116">`OnError` イベントに対するイベント ハンドラーを持つのは、パッケージのみです。</span><span class="sxs-lookup"><span data-stu-id="0271f-116">Only the package has an event handler, for its `OnError` event.</span></span> <span data-ttu-id="0271f-117">SQL 実行タスクの実行時にエラーが発生した場合、パッケージの `OnError` イベント ハンドラーが実行されます。</span><span class="sxs-lookup"><span data-stu-id="0271f-117">If an error occurs when the Execute SQL task runs, the `OnError` event handler for the package runs.</span></span> <span data-ttu-id="0271f-118">次の図は、パッケージの `OnError` イベント ハンドラーにより実行される呼び出しの順序を示しています。</span><span class="sxs-lookup"><span data-stu-id="0271f-118">The following diagram shows the sequence of calls that causes the `OnError` event handler for the package to execute.</span></span>

 <span data-ttu-id="0271f-119">![イベント ハンドラーのフロー](media/mw-dts-eventhandlers.gif "イベント ハンドラーのフロー")</span><span class="sxs-lookup"><span data-stu-id="0271f-119">![Event handler flow](media/mw-dts-eventhandlers.gif "Event handler flow")</span></span>

 <span data-ttu-id="0271f-120">イベント ハンドラーは、イベント ハンドラー コレクションのメンバーであり、このコレクションはすべてのコンテナーに含まれています。</span><span class="sxs-lookup"><span data-stu-id="0271f-120">Event handlers are members of an event handler collection, and all containers include this collection.</span></span> <span data-ttu-id="0271f-121">[!INCLUDE[ssIS](../includes/ssis-md.md)] デザイナーを使用してパッケージを作成すると、イベント ハンドラー コレクションのメンバーは、 **デザイナーの** [パッケージ エクスプローラー] **タブ上の** [イベント ハンドラー] [!INCLUDE[ssIS](../includes/ssis-md.md)] フォルダー内に表示されます。</span><span class="sxs-lookup"><span data-stu-id="0271f-121">If you create the package using [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, you can see the members of the event handler collections in the **Event Handlers** folders on the **Package Explorer** tab of [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer.</span></span>

 <span data-ttu-id="0271f-122">イベント ハンドラーのコンテナーは、次の方法で構成できます。</span><span class="sxs-lookup"><span data-stu-id="0271f-122">You can configure the event handler container in the following ways:</span></span>

-   <span data-ttu-id="0271f-123">イベント ハンドラーの名前と説明を指定します。</span><span class="sxs-lookup"><span data-stu-id="0271f-123">Specify a name and description for the event handler.</span></span>

-   <span data-ttu-id="0271f-124">イベント ハンドラーを実行するかどうか、イベント ハンドラーが失敗した場合にパッケージが失敗するかどうか、イベント ハンドラーが失敗するまでに発生するエラーの最大数を示します。</span><span class="sxs-lookup"><span data-stu-id="0271f-124">Indicate whether the event handler runs, whether the package fails if the event handler fails, and the number of errors that can occur before the event handler fails.</span></span>

-   <span data-ttu-id="0271f-125">実行時にイベント ハンドラーが返す実際の実行結果の代わりに、返される実行結果を指定します。</span><span class="sxs-lookup"><span data-stu-id="0271f-125">Specify an execution result to return instead of the actual execution result that the event handler returns at run time.</span></span>

-   <span data-ttu-id="0271f-126">イベント ハンドラーのトランザクション オプションを指定します。</span><span class="sxs-lookup"><span data-stu-id="0271f-126">Specify the transaction option for the event handler.</span></span>

-   <span data-ttu-id="0271f-127">イベント ハンドラーが使用するログ モードを指定します。</span><span class="sxs-lookup"><span data-stu-id="0271f-127">Specify the logging mode that the event handler uses.</span></span>

## <a name="event-handler-content"></a><span data-ttu-id="0271f-128">イベント ハンドラーの内容</span><span class="sxs-lookup"><span data-stu-id="0271f-128">Event Handler Content</span></span>
 <span data-ttu-id="0271f-129">イベント ハンドラーの作成方法は、パッケージの構築方法と同様です。つまり、イベント ハンドラーには、制御フロー内で順序付けられたタスクとコンテナーがあります。また、イベント ハンドラーにデータ フローを含めることもできます。</span><span class="sxs-lookup"><span data-stu-id="0271f-129">Creating an event handler is similar to building a package; an event handler has tasks and containers, which are sequenced into a control flow, and an event handler can also include data flows.</span></span> <span data-ttu-id="0271f-130">[!INCLUDE[ssIS](../includes/ssis-md.md)] デザイナーには **[イベント ハンドラー]** タブが含まれており、これを使用してカスタム イベント ハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="0271f-130">The [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer includes the **Event Handlers** tab for creating custom event handlers.</span></span> <span data-ttu-id="0271f-131">詳細については、「 [SSIS パッケージのイベントハンドラー](integration-services-ssis-event-handlers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0271f-131">For more information, see [SSIS Package Event Handlers](integration-services-ssis-event-handlers.md).</span></span>

 <span data-ttu-id="0271f-132">イベント ハンドラーは、プログラムによって作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="0271f-132">You can also create event handlers programmatically.</span></span> <span data-ttu-id="0271f-133">詳細については、「 [プログラムによるイベントの処理](building-packages-programmatically/handling-events-programmatically.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0271f-133">For more information, see [Handling Events Programmatically](building-packages-programmatically/handling-events-programmatically.md).</span></span>

## <a name="run-time-events"></a><span data-ttu-id="0271f-134">実行時イベント</span><span class="sxs-lookup"><span data-stu-id="0271f-134">Run-Time Events</span></span>
 <span data-ttu-id="0271f-135">次の表に、 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] で用意されているイベント ハンドラーの一覧を示します。また、イベント ハンドラーによって実行される実行時イベントについて説明します。</span><span class="sxs-lookup"><span data-stu-id="0271f-135">The following table lists the event handlers that [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides, and describes the run-time events that cause the event handler to run.</span></span>

|<span data-ttu-id="0271f-136">イベント ハンドラー</span><span class="sxs-lookup"><span data-stu-id="0271f-136">Event handler</span></span>|<span data-ttu-id="0271f-137">Event</span><span class="sxs-lookup"><span data-stu-id="0271f-137">Event</span></span>|
|-------------------|-----------|
|`OnError`|<span data-ttu-id="0271f-138">`OnError` イベントのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="0271f-138">The event handler for the `OnError` event.</span></span> <span data-ttu-id="0271f-139">このイベントは、エラー発生時に実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-139">This event is raised by an executable when an error occurs.</span></span>|
|<span data-ttu-id="0271f-140">**OnExecStatusChanged**</span><span class="sxs-lookup"><span data-stu-id="0271f-140">**OnExecStatusChanged**</span></span>|<span data-ttu-id="0271f-141">**OnExecStatusChanged** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-141">The event handler for the **OnExecStatusChanged** event.</span></span> <span data-ttu-id="0271f-142">このイベントは、実行状態が変化したときに実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-142">This event is raised by an executable when its execution status changes.</span></span>|
|<span data-ttu-id="0271f-143">**OnInformation**</span><span class="sxs-lookup"><span data-stu-id="0271f-143">**OnInformation**</span></span>|<span data-ttu-id="0271f-144">**OnInformation** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-144">The event handler for the **OnInformation** event.</span></span> <span data-ttu-id="0271f-145">このイベントは、実行可能ファイルの検証時および実行時に、情報をレポートするために発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-145">This event is raised during the validation and execution of an executable to report information.</span></span> <span data-ttu-id="0271f-146">このイベントは情報を伝達するだけのもので、エラーや警告は発生しません。</span><span class="sxs-lookup"><span data-stu-id="0271f-146">This event conveys information only, no errors or warnings.</span></span>|
|<span data-ttu-id="0271f-147">**OnPostExecute**</span><span class="sxs-lookup"><span data-stu-id="0271f-147">**OnPostExecute**</span></span>|<span data-ttu-id="0271f-148">**OnPostExecute** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-148">The event handler for the **OnPostExecute** event.</span></span> <span data-ttu-id="0271f-149">このイベントは、実行可能ファイルの実行完了直後に、実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-149">This event is raised by an executable immediately after it has finished running.</span></span>|
|<span data-ttu-id="0271f-150">**OnPostValidate**</span><span class="sxs-lookup"><span data-stu-id="0271f-150">**OnPostValidate**</span></span>|<span data-ttu-id="0271f-151">**OnPostValidate** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-151">The event handler for the **OnPostValidate** event.</span></span> <span data-ttu-id="0271f-152">このイベントは、実行可能ファイルの検証が完了したときに、実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-152">This event is raised by an executable when its validation is finished.</span></span>|
|<span data-ttu-id="0271f-153">**OnPreExecute**</span><span class="sxs-lookup"><span data-stu-id="0271f-153">**OnPreExecute**</span></span>|<span data-ttu-id="0271f-154">**OnPreExecute** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-154">The event handler for the **OnPreExecute** event.</span></span> <span data-ttu-id="0271f-155">このイベントは、実行可能ファイルが実行される直前に、実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-155">This event is raised by an executable immediately before it runs.</span></span>|
|<span data-ttu-id="0271f-156">**OnPreValidate**</span><span class="sxs-lookup"><span data-stu-id="0271f-156">**OnPreValidate**</span></span>|<span data-ttu-id="0271f-157">**OnPreValidate** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-157">The event handler for the **OnPreValidate** event.</span></span> <span data-ttu-id="0271f-158">このイベントは、実行可能ファイルの検証を開始するときに、実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-158">This event is raised by an executable when its validation starts.</span></span>|
|<span data-ttu-id="0271f-159">**OnProgress**</span><span class="sxs-lookup"><span data-stu-id="0271f-159">**OnProgress**</span></span>|<span data-ttu-id="0271f-160">**OnProgress** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-160">The event handler for the **OnProgress** event.</span></span> <span data-ttu-id="0271f-161">このイベントは、実行可能ファイルで重要な進行があったときに、実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-161">This event is raised by an executable when measurable progress is made by the executable.</span></span>|
|<span data-ttu-id="0271f-162">**OnQueryCancel**</span><span class="sxs-lookup"><span data-stu-id="0271f-162">**OnQueryCancel**</span></span>|<span data-ttu-id="0271f-163">**OnQueryCancel** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-163">The event handler for the **OnQueryCancel** event.</span></span> <span data-ttu-id="0271f-164">このイベントは、実行可能ファイルの実行を停止するかどうかを決定するために、実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-164">This event is raised by an executable to determine whether it should stop running.</span></span>|
|<span data-ttu-id="0271f-165">**OnTaskFailed**</span><span class="sxs-lookup"><span data-stu-id="0271f-165">**OnTaskFailed**</span></span>|<span data-ttu-id="0271f-166">**OnTaskFailed** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-166">The event handler for the **OnTaskFailed** event.</span></span> <span data-ttu-id="0271f-167">このイベントは、タスクが失敗したときにタスクから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-167">This event is raised by a task when it fails.</span></span>|
|<span data-ttu-id="0271f-168">**OnVariableValueChanged**</span><span class="sxs-lookup"><span data-stu-id="0271f-168">**OnVariableValueChanged**</span></span>|<span data-ttu-id="0271f-169">**OnVariableValueChanged** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-169">The event handler for the **OnVariableValueChanged** event.</span></span> <span data-ttu-id="0271f-170">このイベントは、変数の値が変化したときに実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-170">This event is raised by an executable when the value of a variable changes.</span></span> <span data-ttu-id="0271f-171">イベントは、変数が定義されている実行可能ファイルで発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-171">The event is raised by the executable on which the variable is defined.</span></span> <span data-ttu-id="0271f-172">変数の**RaiseChangeEvent**プロパティをに設定すると、このイベントは発生しません `False` 。</span><span class="sxs-lookup"><span data-stu-id="0271f-172">This event is not raised if you set the **RaiseChangeEvent** property for the variable to `False`.</span></span> <span data-ttu-id="0271f-173">詳細については、「 [Integration Services &#40;SSIS&#41; の変数](integration-services-ssis-variables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0271f-173">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>|
|<span data-ttu-id="0271f-174">**OnWarning**</span><span class="sxs-lookup"><span data-stu-id="0271f-174">**OnWarning**</span></span>|<span data-ttu-id="0271f-175">**OnWarning** イベントのイベント ハンドラーです。</span><span class="sxs-lookup"><span data-stu-id="0271f-175">The event handler for the **OnWarning** event.</span></span> <span data-ttu-id="0271f-176">このイベントは、警告の発生時に実行可能ファイルから発生します。</span><span class="sxs-lookup"><span data-stu-id="0271f-176">This event is raised by an executable when a warning occurs.</span></span>|

## <a name="configuration-of-an-event-handler"></a><span data-ttu-id="0271f-177">イベント ハンドラーの構成</span><span class="sxs-lookup"><span data-stu-id="0271f-177">Configuration of an Event Handler</span></span>
 <span data-ttu-id="0271f-178">プロパティを設定するには、 **の** [プロパティ] [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] ウィンドウで行うか、またはプログラムによって設定します。</span><span class="sxs-lookup"><span data-stu-id="0271f-178">You can set properties in the **Properties** window of [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] or programmatically.</span></span>

 <span data-ttu-id="0271f-179">これらのプロパティを [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)]で設定する方法については、「 [タスクまたはコンテナーのプロパティを設定する](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0271f-179">For information about how to set these properties in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], see [Set the Properties of a Task or Container](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span></span>

 <span data-ttu-id="0271f-180">プログラムによってこれらのプロパティを設定する方法については、 <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0271f-180">For information about programmatically setting these properties, see <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="0271f-181">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="0271f-181">Related Tasks</span></span>
 <span data-ttu-id="0271f-182">パッケージにイベント ハンドラーを追加する方法については、「 [パッケージにイベント ハンドラーを追加する](../../2014/integration-services/add-an-event-handler-to-a-package.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0271f-182">For information about how to add an event handler to a package, see [Add an Event Handler to a Package](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span></span>


