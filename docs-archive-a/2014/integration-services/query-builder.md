---
title: クエリビルダー |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81be066d92ef1e19a141414dad4359b60efca2f9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713282"
---
# <a name="query-builder"></a><span data-ttu-id="41216-102">[クエリ ビルダー]</span><span class="sxs-lookup"><span data-stu-id="41216-102">Query Builder</span></span>
  <span data-ttu-id="41216-103">**[クエリ ビルダー]** ダイアログ ボックスを使用すると、SQL 実行タスク、OLE DB 変換元と OLE DB 変換先、および参照変換で使用するクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="41216-103">Use the **Query Builder** dialog box to create a query for use in the Execute SQL task, the OLE DB source and the OLE DB destination, and the Lookup transformation.</span></span>  
  
 <span data-ttu-id="41216-104">クエリ ビルダーを使用すると、次のタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="41216-104">You can use Query Builder to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="41216-105">**クエリのグラフィカルな表現と SQL コマンドの操作** クエリ ビルダーには、クエリをグラフィカルに表示するペインと、クエリの SQL テキストを表示するペインがあります。</span><span class="sxs-lookup"><span data-stu-id="41216-105">**Working with a graphical representation of a query or with SQL commands** Query Builder includes a pane that displays your query graphically and a pane that displays the SQL text of your query.</span></span> <span data-ttu-id="41216-106">グラフィカル ペインとテキスト ペインのどちらでも作業ができます。</span><span class="sxs-lookup"><span data-stu-id="41216-106">You can work in either the graphical pane or the text pane.</span></span> <span data-ttu-id="41216-107">クエリ ビルダーでは、ビューの同期をとっているため、どちらにも常に最新の状態が表示されます。</span><span class="sxs-lookup"><span data-stu-id="41216-107">Query Builder synchronizes the views so that they are always current.</span></span>  
  
-   <span data-ttu-id="41216-108">**関連テーブルの結合** クエリに複数のテーブルを追加する場合、クエリ ビルダーはテーブル間の関係を自動的に認識し、適切な結合コマンドを作成します。</span><span class="sxs-lookup"><span data-stu-id="41216-108">**Joining related tables** If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="41216-109">**データベースのクエリまたは更新** クエリ ビルダーでは、Transact-SQL の SELECT ステートメントを使用してデータを返すことができます。また、データベースのレコードの更新、追加、削除を行うクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="41216-109">**Querying or updating databases** You can use Query Builder to return data by using Transact-SQL SELECT statements and to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="41216-110">**結果の即時の表示と編集** クエリを実行し、グリッドのレコードセットを使用して、データベースのレコードをスクロールし、編集できます。</span><span class="sxs-lookup"><span data-stu-id="41216-110">**Viewing and editing results immediately** You can run your query and work with a recordset in a grid that allows you to scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="41216-111">**[クエリ ビルダー]** ダイアログ ボックスのグラフィカル ツールにより、ドラッグ アンド ドロップ操作でクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="41216-111">The graphical tools in the **Query Builder** dialog box let you construct queries using drag-and-drop operations.</span></span> <span data-ttu-id="41216-112">既定では、[クエリ ビルダー] ダイアログ ボックスは SELECT クエリを構築しますが、INSERT、UPDATE、または DELETE クエリも作成できます。</span><span class="sxs-lookup"><span data-stu-id="41216-112">By default, the Query Builder dialog box constructs SELECT queries, but you can also build INSERT, UPDATE, or DELETE queries.</span></span> <span data-ttu-id="41216-113">**[クエリ ビルダー]** ダイアログ ボックスで、すべての種類の SQL ステートメントを解析して実行できます。</span><span class="sxs-lookup"><span data-stu-id="41216-113">All types of SQL statements can be parsed and run in the **Query Builder** dialog box.</span></span> <span data-ttu-id="41216-114">パッケージの SQL ステートメントの詳細については、「[Integration Services (SSIS) のクエリ](integration-services-ssis-queries.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41216-114">For more information about SQL statements in packages, see [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="41216-115">Transact-SQL 言語およびその構文の詳細については、「[Transact-SQL リファレンス (データベース エンジン)](/sql/t-sql/language-reference)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41216-115">To learn more about the Transact-SQL language and its syntax, see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference).</span></span>  
  
 <span data-ttu-id="41216-116">クエリで変数を使用して、入力パラメーターへの値の指定、出力パラメーターの値の取得、およびリターン コードの格納を行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="41216-116">You can also use variables in a query to provide values to an input parameter, to capture values of output parameters, and to store return codes.</span></span> <span data-ttu-id="41216-117">パッケージで使用するクエリでの変数の使用の詳細については、「[SQL 実行タスク](control-flow/execute-sql-task.md)」、「[OLE DB ソース](data-flow/ole-db-source.md)」、および「[Integration Services (SSIS) のクエリ](integration-services-ssis-queries.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41216-117">To learn more about using variables in the queries that packages use, see [Execute SQL Task](control-flow/execute-sql-task.md), [OLE DB Source](data-flow/ole-db-source.md), and [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span> <span data-ttu-id="41216-118">SQL 実行タスクでの変数の使用の詳細については、「 [SQL 実行タスクのパラメーターとリターン コード](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) 」および「 [SQL 実行タスクにおける結果セット](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41216-118">To learn more about using variables in the Execute SQL Task, see [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) and [Result Sets in the Execute SQL Task](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="41216-119">参照変換およびあいまい参照変換でも、パラメーターとリターン コードに変数を使用できます。</span><span class="sxs-lookup"><span data-stu-id="41216-119">The Lookup and Fuzzy lookup transformations can also use variables with parameters and return codes.</span></span> <span data-ttu-id="41216-120">OLE DB ソースに関する情報は、これら 2 つの変換にも適用されます。</span><span class="sxs-lookup"><span data-stu-id="41216-120">The information about the OLE DB source applies to these two transformations also.</span></span>  
  
## <a name="options"></a><span data-ttu-id="41216-121">Options</span><span class="sxs-lookup"><span data-stu-id="41216-121">Options</span></span>  
 <span data-ttu-id="41216-122">**ツール バー**</span><span class="sxs-lookup"><span data-stu-id="41216-122">**Toolbar**</span></span>  
 <span data-ttu-id="41216-123">ツール バーは、データセットの管理、表示するペインの選択、クエリ機能の制御に使用します。</span><span class="sxs-lookup"><span data-stu-id="41216-123">Use the toolbar to manage datasets, select panes to display, and control query functions.</span></span>  
  
|<span data-ttu-id="41216-124">値</span><span class="sxs-lookup"><span data-stu-id="41216-124">Value</span></span>|<span data-ttu-id="41216-125">説明</span><span class="sxs-lookup"><span data-stu-id="41216-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="41216-126">**[ダイアグラム ペインの表示/非表示]**</span><span class="sxs-lookup"><span data-stu-id="41216-126">**Show/Hide Diagram Pane**</span></span>|<span data-ttu-id="41216-127">**[ダイアグラム]** ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="41216-127">Shows or hides the **Diagram** pane.</span></span>|  
|<span data-ttu-id="41216-128">**[グリッド ペインの表示/非表示]**</span><span class="sxs-lookup"><span data-stu-id="41216-128">**Show/Hide Grid Pane**</span></span>|<span data-ttu-id="41216-129">**[グリッド]** ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="41216-129">Shows or hides the **Grid** pane.</span></span>|  
|<span data-ttu-id="41216-130">**[SQL ペインの表示/非表示]**</span><span class="sxs-lookup"><span data-stu-id="41216-130">**Show/Hide SQL Pane**</span></span>|<span data-ttu-id="41216-131">**SQL**ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="41216-131">Shows or hides the **SQL** pane.</span></span>|  
|<span data-ttu-id="41216-132">**[結果ペインの表示/非表示]**</span><span class="sxs-lookup"><span data-stu-id="41216-132">**Show/Hide Results Pane**</span></span>|<span data-ttu-id="41216-133">**[結果]** ペインの表示と非表示を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="41216-133">Shows or hides the **Results** pane.</span></span>|  
|<span data-ttu-id="41216-134">**実行**</span><span class="sxs-lookup"><span data-stu-id="41216-134">**Run**</span></span>|<span data-ttu-id="41216-135">クエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="41216-135">Runs the query.</span></span> <span data-ttu-id="41216-136">結果は結果ペインに表示されます。</span><span class="sxs-lookup"><span data-stu-id="41216-136">Results are displayed in the result pane.</span></span>|  
|<span data-ttu-id="41216-137">**[SQL の確認]**</span><span class="sxs-lookup"><span data-stu-id="41216-137">**Verify SQL**</span></span>|<span data-ttu-id="41216-138">SQL ステートメントが有効であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="41216-138">Verifies that the SQL statement is valid.</span></span>|  
|<span data-ttu-id="41216-139">**昇順で並べ替え**</span><span class="sxs-lookup"><span data-stu-id="41216-139">**Sort Ascending**</span></span>|<span data-ttu-id="41216-140">[グリッド] ペインで選択した列の出力行を昇順で並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="41216-140">Sorts output rows on the selected column in the grid pane, in ascending order.</span></span>|  
|<span data-ttu-id="41216-141">**降順で並べ替え**</span><span class="sxs-lookup"><span data-stu-id="41216-141">**Sort Descending**</span></span>|<span data-ttu-id="41216-142">[グリッド] ペインで選択した列の出力行を降順で並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="41216-142">Sorts output rows on the selected column in the grid pane, in descending order.</span></span>|  
|<span data-ttu-id="41216-143">**フィルターの削除**</span><span class="sxs-lookup"><span data-stu-id="41216-143">**Remove Filter**</span></span>|<span data-ttu-id="41216-144">[グリッド] ペインの列名を選択してから、 **[フィルターの削除]** をクリックして列の並べ替え条件を削除します。</span><span class="sxs-lookup"><span data-stu-id="41216-144">Select a column name in the grid pane, and then click **Remove Filter** to remove sort criteria for the column.</span></span>|  
|<span data-ttu-id="41216-145">**[Group By の使用]**</span><span class="sxs-lookup"><span data-stu-id="41216-145">**Use Group By**</span></span>|<span data-ttu-id="41216-146">クエリに GROUP BY 機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="41216-146">Adds GROUP BY functionality to the query.</span></span>|  
|<span data-ttu-id="41216-147">**[テーブルの追加]**</span><span class="sxs-lookup"><span data-stu-id="41216-147">**Add Table**</span></span>|<span data-ttu-id="41216-148">新しいテーブルをクエリに追加します。</span><span class="sxs-lookup"><span data-stu-id="41216-148">Adds a new table to the query.</span></span>|  
  
 <span data-ttu-id="41216-149">**クエリ定義**</span><span class="sxs-lookup"><span data-stu-id="41216-149">**Query Definition**</span></span>  
 <span data-ttu-id="41216-150">クエリ定義は、クエリの定義およびテストを行うツール バーおよびペインを提供します。</span><span class="sxs-lookup"><span data-stu-id="41216-150">The query definition provides a toolbar and panes in which to define and test the query.</span></span>  
  
|<span data-ttu-id="41216-151">ペイン</span><span class="sxs-lookup"><span data-stu-id="41216-151">Pane</span></span>|<span data-ttu-id="41216-152">説明</span><span class="sxs-lookup"><span data-stu-id="41216-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="41216-153">**ダイアグラム**ペイン</span><span class="sxs-lookup"><span data-stu-id="41216-153">**Diagram** pane</span></span>|<span data-ttu-id="41216-154">クエリをダイアグラムに表示します。</span><span class="sxs-lookup"><span data-stu-id="41216-154">Displays the query in a diagram.</span></span> <span data-ttu-id="41216-155">このダイアグラムには、クエリに含まれるテーブルと、その結合状態が表示されます。</span><span class="sxs-lookup"><span data-stu-id="41216-155">The diagram shows the tables included in the query, and how they are joined.</span></span> <span data-ttu-id="41216-156">テーブルの列の横にあるチェック ボックスをオンにすると、クエリの出力にその列が追加されます。オフにすると、削除されます。</span><span class="sxs-lookup"><span data-stu-id="41216-156">Select or clear the check box next to a column in a table to add or remove it from the query output.</span></span><br /><br /> <span data-ttu-id="41216-157">テーブルをクエリに追加すると、クエリ ビルダーにより、テーブルのキーに応じてテーブル間の結合が行われます。</span><span class="sxs-lookup"><span data-stu-id="41216-157">When you add tables to the query, Query Builder creates joins between tables based on tables, depending on the keys in the table.</span></span> <span data-ttu-id="41216-158">結合を追加するには、あるテーブルのフィールドを別のテーブルのフィールドにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="41216-158">To add a join, drag a field from one table onto a field in another table.</span></span> <span data-ttu-id="41216-159">結合を管理するには、結合を右クリックしてからメニュー オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="41216-159">To manage a join, right-click the join, and then select a menu option.</span></span><br /><br /> <span data-ttu-id="41216-160">**ダイアグラム**ペインを右クリックすると、テーブルの追加や削除、すべてのテーブルの選択、ペインの表示と非表示の切り替えを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="41216-160">Right-click the **Diagram** pane to add or remove tables, select all the tables, and show or hide panes.</span></span>|  
|<span data-ttu-id="41216-161">**グリッド**ペイン</span><span class="sxs-lookup"><span data-stu-id="41216-161">**Grid** pane</span></span>|<span data-ttu-id="41216-162">クエリをグリッドに表示します。</span><span class="sxs-lookup"><span data-stu-id="41216-162">Displays the query in a grid.</span></span> <span data-ttu-id="41216-163">このペインを使用して、クエリの列の追加や削除を行うことができます。また、各列の設定も変更できます。</span><span class="sxs-lookup"><span data-stu-id="41216-163">You can use this pane to add to and remove columns from the query and change the settings for each column.</span></span>|  
|<span data-ttu-id="41216-164">**SQL**ペイン</span><span class="sxs-lookup"><span data-stu-id="41216-164">**SQL** pane</span></span>|<span data-ttu-id="41216-165">クエリを SQL テストとして表示します。</span><span class="sxs-lookup"><span data-stu-id="41216-165">Displays the query as SQL text.</span></span> <span data-ttu-id="41216-166">**[ダイアグラム]** ペインおよび **[グリッド]** ペインで行われた変更がここに表示されます。このペインで行われた変更は、 **[ダイアグラム]** ペインおよび **[グリッド]** ペインに表示されます。</span><span class="sxs-lookup"><span data-stu-id="41216-166">Changes made in the **Diagram** pane and the **Grid** pane will appear here, and changes made here will appear in the **Diagram** pane and the **Grid** pane.</span></span>|  
|<span data-ttu-id="41216-167">**[結果]** ペイン</span><span class="sxs-lookup"><span data-stu-id="41216-167">**Results** pane</span></span>|<span data-ttu-id="41216-168">ツール バーの **[実行]** をクリックしたときに、クエリの結果が表示されます。</span><span class="sxs-lookup"><span data-stu-id="41216-168">Displays the results of the query when you click **Run** on the toolbar.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="41216-169">参照</span><span class="sxs-lookup"><span data-stu-id="41216-169">See Also</span></span>  
 <span data-ttu-id="41216-170">[SQL 実行タスク](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="41216-170">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 <span data-ttu-id="41216-171">[OLE DB ソース](data-flow/ole-db-source.md) </span><span class="sxs-lookup"><span data-stu-id="41216-171">[OLE DB Source](data-flow/ole-db-source.md) </span></span>  
 <span data-ttu-id="41216-172">[OLE DB 変換先](data-flow/ole-db-destination.md) </span><span class="sxs-lookup"><span data-stu-id="41216-172">[OLE DB Destination](data-flow/ole-db-destination.md) </span></span>  
 <span data-ttu-id="41216-173">[参照変換](data-flow/transformations/lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="41216-173">[Lookup Transformation](data-flow/transformations/lookup-transformation.md) </span></span>  
 <span data-ttu-id="41216-174">[SSIS&#41; クエリ &#40;Integration Services](integration-services-ssis-queries.md) </span><span class="sxs-lookup"><span data-stu-id="41216-174">[Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md) </span></span>  
 [<span data-ttu-id="41216-175">Integration Services パッケージで MERGE を実行する</span><span class="sxs-lookup"><span data-stu-id="41216-175">MERGE in Integration Services Packages</span></span>](control-flow/merge-in-integration-services-packages.md)  
  
  
