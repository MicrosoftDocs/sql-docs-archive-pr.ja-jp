---
title: SQL 実行タスクのパラメーターとリターンコード |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- return codes [Integration Services]
- parameters [Integration Services]
- parameterized SQL statements [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: a3ca65e8-65cf-4272-9a81-765a706b8663
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cdc32e103642e086e81f6499bf56e5fbb71c3bd1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87644544"
---
# <a name="parameters-and-return-codes-in-the-execute-sql-task"></a><span data-ttu-id="fa42c-102">SQL 実行タスクのパラメーターとリターン コード</span><span class="sxs-lookup"><span data-stu-id="fa42c-102">Parameters and Return Codes in the Execute SQL Task</span></span>
  <span data-ttu-id="fa42c-103">SQL ステートメントとストアド プロシージャでは多くの場合、`input` パラメーター、`output` パラメーター、およびリターン コードを使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-103">SQL statements and stored procedures frequently use `input` parameters, `output` parameters, and return codes.</span></span> <span data-ttu-id="fa42c-104">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] の SQL 実行タスクでは、`Input`、`Output`、および `ReturnValue` という、パラメーターの型がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="fa42c-104">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="fa42c-105">入力パラメーターには `Input` 型、出力パラメーターには `Output` 型、およびリターン コードには `ReturnValue` 型を使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-105">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fa42c-106">SQL 実行タスクでは、データ プロバイダーがサポートしている場合のみ、パラメーターを使用できます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-106">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="fa42c-107">クエリやストアド プロシージャなど、SQL コマンドのパラメーターは、SQL 実行タスクのスコープ内、親コンテナー、またはパッケージのスコープ内に作成されたユーザー定義変数にマップされます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-107">Parameters in SQL commands, including queries and stored procedures, are mapped to user-defined variables that are created within the scope of the Execute SQL task, a parent container, or within the scope of the package.</span></span> <span data-ttu-id="fa42c-108">変数の値はデザイン時に設定することも、実行時に動的に設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-108">The values of variables can be set at design time or populated dynamically at run time.</span></span> <span data-ttu-id="fa42c-109">パラメーターは、システム変数にマップすることもできます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-109">You can also map parameters to system variables.</span></span> <span data-ttu-id="fa42c-110">詳細については、「[Integration Services &#40;SSIS&#41; の変数](integration-services-ssis-variables.md)」および「[システム変数](system-variables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-110">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="fa42c-111">SQL 実行タスクでパラメーターやリターン コードを使用すると、タスクでサポートされるパラメーターの型やこれらのパラメーターのマップ方法を把握するだけでなく、その他の情報も取得できます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-111">However, working with parameters and return codes in an Execute SQL task is more than just knowing what parameter types the task supports and how these parameters will be mapped.</span></span> <span data-ttu-id="fa42c-112">SQL 実行タスクでパラメーターおよびリターン コードを正しく使用する際に必要となる、追加の使用要件やガイドラインがあります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-112">There are additional usage requirements and guidelines to successfully use parameters and return codes in the Execute SQL task.</span></span> <span data-ttu-id="fa42c-113">以降では、こうした使用要件およびガイドラインについて説明します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-113">The remainder of this topic covers these usage requirements and guidelines:</span></span>  
  
-   [<span data-ttu-id="fa42c-114">パラメーター名とパラメーター マーカーの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-114">Using parameters names and markers</span></span>](#Parameter_names_and_markers)  
  
-   [<span data-ttu-id="fa42c-115">日付と時刻のデータ型のパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-115">Using parameters with date and time data types</span></span>](#Date_and_time_data_types)  
  
-   [<span data-ttu-id="fa42c-116">WHERE 句でのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-116">Using parameters in WHERE clauses</span></span>](#WHERE_clauses)  
  
-   [<span data-ttu-id="fa42c-117">ストアド プロシージャでのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-117">Using parameters with stored procedures</span></span>](#Stored_procedures)  
  
-   [<span data-ttu-id="fa42c-118">リターン コードの値の取得</span><span class="sxs-lookup"><span data-stu-id="fa42c-118">Getting values of return codes</span></span>](#Return_codes)  
  
-   [<span data-ttu-id="fa42c-119">SQL 実行タスクのパラメーターとリターン コードの構成</span><span class="sxs-lookup"><span data-stu-id="fa42c-119">Configuring parameters and return codes in the Execute SQL Task Editor</span></span>](#Configure_parameters_and_return_codes)  
  
##  <a name="using-parameter-names-and-markers"></a><a name="Parameter_names_and_markers"></a><span data-ttu-id="fa42c-120">パラメーター名とマーカーの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-120">Using Parameter Names and Markers</span></span>  
 <span data-ttu-id="fa42c-121">SQL コマンドの構文では、SQL 実行タスクが使用する接続の種類によって、異なるパラメーター マーカーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-121">Depending on the connection type that the Execute SQL task uses, the syntax of the SQL command uses different parameter markers.</span></span> <span data-ttu-id="fa42c-122">たとえば、[!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーの場合は、SQL コマンドが使用するパラメーター マーカーの形式を **\@varParameter** にする必要がありますが、OLE DB 接続の場合は疑問符 (?) パラメーター マーカーが必要です。</span><span class="sxs-lookup"><span data-stu-id="fa42c-122">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type requires that the SQL command uses a parameter marker in the format **\@varParameter**, whereas OLE DB connection type requires the question mark (?) parameter marker.</span></span>  
  
 <span data-ttu-id="fa42c-123">変数とパラメーターの間でのマッピングでパラメーター名として使用できる名前も、接続マネージャーの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-123">The names that you can use as parameter names in the mappings between variables and parameters also vary by connection manager type.</span></span> <span data-ttu-id="fa42c-124">たとえば、[!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーでは \@ プレフィックス付きのユーザー定義名を使用し、OLE DB 接続マネージャーではパラメーター名として 0 から始まる序数の数値を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-124">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type uses a user-defined name with a \@ prefix, whereas the OLE DB connection manager type requires that you use the numeric value of a 0-based ordinal as the parameter name.</span></span>  
  
 <span data-ttu-id="fa42c-125">次の表に、SQL 実行タスクで使用できる接続マネージャーの種類の SQL コマンドの要件をまとめます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-125">The following table summarizes the requirements for SQL commands for the connection manager types that the Execute SQL task can use.</span></span>  
  
|<span data-ttu-id="fa42c-126">接続の種類</span><span class="sxs-lookup"><span data-stu-id="fa42c-126">Connection type</span></span>|<span data-ttu-id="fa42c-127">パラメーター マーカー</span><span class="sxs-lookup"><span data-stu-id="fa42c-127">Parameter marker</span></span>|<span data-ttu-id="fa42c-128">パラメーター名</span><span class="sxs-lookup"><span data-stu-id="fa42c-128">Parameter name</span></span>|<span data-ttu-id="fa42c-129">SQL コマンドの例</span><span class="sxs-lookup"><span data-stu-id="fa42c-129">Example SQL command</span></span>|  
|---------------------|----------------------|--------------------|-------------------------|  
|<span data-ttu-id="fa42c-130">ADO (ADO)</span><span class="sxs-lookup"><span data-stu-id="fa42c-130">ADO</span></span>|<span data-ttu-id="fa42c-131">?</span><span class="sxs-lookup"><span data-stu-id="fa42c-131">?</span></span>|<span data-ttu-id="fa42c-132">Param1、Param2、...</span><span class="sxs-lookup"><span data-stu-id="fa42c-132">Param1, Param2, ...</span></span>|<span data-ttu-id="fa42c-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="fa42c-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|\@\<parameter name>|\@\<parameter name>|<span data-ttu-id="fa42c-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span><span class="sxs-lookup"><span data-stu-id="fa42c-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span></span>|  
|<span data-ttu-id="fa42c-135">ODBC</span><span class="sxs-lookup"><span data-stu-id="fa42c-135">ODBC</span></span>|<span data-ttu-id="fa42c-136">?</span><span class="sxs-lookup"><span data-stu-id="fa42c-136">?</span></span>|<span data-ttu-id="fa42c-137">1、2、3、...</span><span class="sxs-lookup"><span data-stu-id="fa42c-137">1, 2, 3, ...</span></span>|<span data-ttu-id="fa42c-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="fa42c-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|<span data-ttu-id="fa42c-139">EXCEL および OLE DB</span><span class="sxs-lookup"><span data-stu-id="fa42c-139">EXCEL and OLE DB</span></span>|<span data-ttu-id="fa42c-140">?</span><span class="sxs-lookup"><span data-stu-id="fa42c-140">?</span></span>|<span data-ttu-id="fa42c-141">0、1、2、3、…</span><span class="sxs-lookup"><span data-stu-id="fa42c-141">0, 1, 2, 3, ...</span></span>|<span data-ttu-id="fa42c-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="fa42c-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
  
### <a name="using-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="fa42c-143">ADO.NET 接続マネージャーおよび ADO 接続マネージャーでのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-143">Using Parameters with ADO.NET and ADO Connection Managers</span></span>  
 [!INCLUDE[vstecado](../includes/vstecado-md.md)] <span data-ttu-id="fa42c-144">および ADO 接続マネージャーでは、パラメーターを使用する SQL コマンドに関する特定の要件があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-144">and ADO connection managers have specific requirements for SQL commands that use parameters:</span></span>  
  
-   [!INCLUDE[vstecado](../includes/vstecado-md.md)] <span data-ttu-id="fa42c-145">接続マネージャーでは、SQL コマンド内のパラメーター マーカーとしてパラメーター名を使用することが必要になります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-145">connection managers require that the SQL command use parameter names as parameter markers.</span></span> <span data-ttu-id="fa42c-146">これは、変数をパラメーターに直接マップできることを意味します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-146">This means that variables can be mapped directly to parameters.</span></span> <span data-ttu-id="fa42c-147">たとえば、変数 `@varName` は、 `@parName` という名前のパラメーターにマップされ、パラメーター `@parName`に変数を提供します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-147">For example, the variable `@varName` is mapped to the parameter named `@parName` and provides a value to the parameter `@parName`.</span></span>  
  
-   <span data-ttu-id="fa42c-148">ADO 接続マネージャーでは、SQL コマンド内のパラメーター マーカーとして疑問符 (?) を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-148">ADO connection managers require that the SQL command use question marks (?) as parameter markers.</span></span> <span data-ttu-id="fa42c-149">ただし、パラメーター名として任意のユーザー定義名 (整数値を除く) を使用できます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-149">However, you can use any user-defined name, except for integer values, as parameter names.</span></span>  
  
 <span data-ttu-id="fa42c-150">パラメーターに値を提供するプロセスで、変数がパラメーター名にマップされます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-150">To provide values to parameters, variables are mapped to parameter names.</span></span> <span data-ttu-id="fa42c-151">その後、SQL 実行タスクがパラメーター リスト内にあるパラメーター名の序数値を使用して、変数からパラメーターに値を読み込みます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-151">Then, the Execute SQL task uses the ordinal value of the parameter name in the parameter list to load values from variables to parameters.</span></span>  
  
### <a name="using-parameters-with-excel-odbc-and-ole-db-connection-managers"></a><span data-ttu-id="fa42c-152">EXCEL、ODBC、および OLE DB 接続マネージャーでのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-152">Using Parameters with EXCEL, ODBC, and OLE DB Connection Managers</span></span>  
 <span data-ttu-id="fa42c-153">EXCEL、ODBC、および OLE DB の各接続マネージャーでは、SQL コマンド内のパラメーター マーカーとして疑問符 (?) を使用し、パラメーター名として 0 または 1 から始まる序数を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-153">EXCEL, ODBC, and OLE DB connection managers require that the SQL command use question marks (?) as parameter markers and 0-based or 1-based numeric values as parameter names.</span></span> <span data-ttu-id="fa42c-154">SQL 実行タスクで ODBC 接続マネージャーが使用される場合、クエリの最初のパラメーターにマップされるパラメーター名は 1 になります。それ以外の場合、パラメーター名は 0 になります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-154">If the Execute SQL task uses the ODBC connection manager, the parameter name that maps to the first parameter in the query is named 1; otherwise, the parameter is named 0.</span></span> <span data-ttu-id="fa42c-155">後続のパラメーター名の数値は、パラメーター名のマップ先である SQL コマンドのパラメーターを示します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-155">For subsequent parameters, the numeric value of the parameter name indicates the parameter in the SQL command that the parameter name maps to.</span></span> <span data-ttu-id="fa42c-156">たとえば、3 というパラメーター名は、SQL コマンド内の 3 番目の疑問符 (?) で表される、3 番目のパラメーターにマップされます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-156">For example, the parameter named 3 maps to the third parameter, which is represented by the third question mark (?) in the SQL command.</span></span>  
  
 <span data-ttu-id="fa42c-157">パラメーターに値を提供するプロセスで、変数がパラメーター名にマップされ、SQL 実行タスクがパラメーター名の序数値を使用して、変数からパラメーターに値を読み込みます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-157">To provide values to parameters, variables are mapped to parameter names and the Execute SQL task uses the ordinal value of the parameter name to load values from variables to parameters.</span></span>  
  
 <span data-ttu-id="fa42c-158">接続マネージャーが使用するプロバイダーによっては、一部の OLE DB データ型がサポートされないことがあります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-158">Depending on the provider that the connection manager uses, some OLE DB data types may not be supported.</span></span> <span data-ttu-id="fa42c-159">たとえば、Excel ドライバーは限定されたデータ型のセットしか認識しません。</span><span class="sxs-lookup"><span data-stu-id="fa42c-159">For example, the Excel driver recognizes only a limited set of data types.</span></span> <span data-ttu-id="fa42c-160">Excel ドライバーでの Jet プロバイダーの動作の詳細については、「 [Excel ソース](data-flow/excel-source.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-160">For more information about the behavior of the Jet provider with the Excel driver, see [Excel Source](data-flow/excel-source.md).</span></span>  
  
#### <a name="using-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="fa42c-161">OLE DB 接続マネージャーでのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-161">Using Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="fa42c-162">SQL 実行タスクが OLE DB 接続マネージャーを使用する場合は、タスクの BypassPrepare プロパティを使用できます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-162">When the Execute SQL task uses the OLE DB connection manager, the BypassPrepare property of the task is available.</span></span> <span data-ttu-id="fa42c-163">SQL 実行タスクが、パラメーターと共に SQL ステートメントを使用する場合は、このプロパティを `true` に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-163">You should set this property to `true` if the Execute SQL task uses SQL statements with parameters.</span></span>  
  
 <span data-ttu-id="fa42c-164">OLE DB 接続マネージャーを使用する場合、パラメーター化サブクエリは使用できません。これは、SQL 実行タスクが OLE DB プロバイダーを介してパラメーター情報を取得できないからです。</span><span class="sxs-lookup"><span data-stu-id="fa42c-164">When you use an OLE DB connection manager, you cannot use parameterized subqueries because the Execute SQL Task cannot derive parameter information through the OLE DB provider.</span></span> <span data-ttu-id="fa42c-165">ただし、式を使用することで、パラメーター値をクエリ文字列に連結したり、タスクの SqlStatementSource プロパティを設定したりできます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-165">However, you can use an expression to concatenate the parameter values into the query string and to set the SqlStatementSource property of the task.</span></span>  
  
##  <a name="using-parameters-with-date-and-time-data-types"></a><a name="Date_and_time_data_types"></a><span data-ttu-id="fa42c-166">日付と時刻のデータ型でのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-166">Using Parameters with Date and Time Data Types</span></span>  
  
### <a name="using-date-and-time-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="fa42c-167">ADO.NET 接続マネージャーおよび ADO 接続マネージャーでの日付と時刻のパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-167">Using Date and Time Parameters with ADO.NET and ADO Connection Managers</span></span>  
 <span data-ttu-id="fa42c-168">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 型 (`time` および `datetimeoffset`) のデータを読み取る場合、[!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーまたは ADO 接続マネージャーのいずれかを使用する SQL 実行タスクには、次の追加要件があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-168">When reading data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] types, `time` and `datetimeoffset`, an Execute SQL task that uses either an [!INCLUDE[vstecado](../includes/vstecado-md.md)] or ADO connection manager has the following additional requirements:</span></span>  
  
-   <span data-ttu-id="fa42c-169">データの場合 `time` 、 [!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーは、パラメーターの型が `Input` またはで、データ型がであるパラメーターにこのデータを格納する必要があり `Output` `string` ます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-169">For `time` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `string`.</span></span>  
  
-   <span data-ttu-id="fa42c-170">`datetimeoffset` 型のデータの場合、[!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーでは、次のいずれかのパラメーターにこのデータを格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-170">For `datetimeoffset` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="fa42c-171">パラメーターの型が `Input` で、データ型が `string` のパラメーター。</span><span class="sxs-lookup"><span data-stu-id="fa42c-171">A parameter whose parameter type is `Input` and whose data type is `string`.</span></span>  
  
    -   <span data-ttu-id="fa42c-172">パラメーターの型が `Output` または `ReturnValue` で、データ型が `datetimeoffset`、`string`、または `datetime2` のパラメーター。</span><span class="sxs-lookup"><span data-stu-id="fa42c-172">A parameter whose parameter type is `Output` or `ReturnValue`, and whose data type is `datetimeoffset`, `string`, or `datetime2`.</span></span> <span data-ttu-id="fa42c-173">データ型が `string` または `datetime2` のパラメーターを選択した場合、[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] ではデータが string または datetime2 に変換されます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-173">If you select a parameter whose data type is either `string` or `datetime2`, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] converts the data to either string or datetime2.</span></span>  
  
-   <span data-ttu-id="fa42c-174">ADO 接続マネージャーでは、`time` 型または `datetimeoffset` 型のデータを、パラメーターの型が `Input` または `Output` で、データ型が `adVarWchar` のパラメーターに格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-174">An ADO connection manager requires that either `time` or `datetimeoffset` data be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `adVarWchar`.</span></span>  
  
 <span data-ttu-id="fa42c-175">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データ型の詳細とそれを [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] データ型にマッピングする方法については、「[データ型 &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql)」と「[Integration Services のデータ型](data-flow/integration-services-data-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-175">For more information about [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types and how they map to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) and [Integration Services Data Types](data-flow/integration-services-data-types.md).</span></span>  
  
### <a name="using-date-and-time-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="fa42c-176">OLE DB 接続マネージャーでの日付と時刻のパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-176">Using Date and Time Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="fa42c-177">OLE DB 接続マネージャーを使用する場合、SQL 実行タスクには、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データ型 (`date`、`time`、`datetime`、`datetime2`、および `datetimeoffset`) のデータに関して特定のストレージ要件があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-177">When using an OLE DB connection manager, an Execute SQL task has specific storage requirements for data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, and `datetimeoffset`.</span></span> <span data-ttu-id="fa42c-178">このデータは、次のいずれかの型のパラメーターに格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-178">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="fa42c-179">NVARCHAR データ型の入力パラメーター。</span><span class="sxs-lookup"><span data-stu-id="fa42c-179">An input parameter of the NVARCHAR data type.</span></span>  
  
-   <span data-ttu-id="fa42c-180">次の表に示す、適切なデータ型の出力パラメーター。</span><span class="sxs-lookup"><span data-stu-id="fa42c-180">An output parameter of with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="fa42c-181">`Output` パラメーターの型</span><span class="sxs-lookup"><span data-stu-id="fa42c-181">`Output` parameter type</span></span>|<span data-ttu-id="fa42c-182">Date データ型</span><span class="sxs-lookup"><span data-stu-id="fa42c-182">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="fa42c-183">DBDATE</span><span class="sxs-lookup"><span data-stu-id="fa42c-183">DBDATE</span></span>|`date`|  
    |<span data-ttu-id="fa42c-184">DBTIME2</span><span class="sxs-lookup"><span data-stu-id="fa42c-184">DBTIME2</span></span>|`time`|  
    |<span data-ttu-id="fa42c-185">DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="fa42c-185">DBTIMESTAMP</span></span>|<span data-ttu-id="fa42c-186">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="fa42c-186">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="fa42c-187">DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="fa42c-187">DBTIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="fa42c-188">データが適切な入力パラメーターまたは出力パラメーターに格納されないと、パッケージは失敗します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-188">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
### <a name="using-date-and-time-parameters-with-odbc-connection-managers"></a><span data-ttu-id="fa42c-189">ODBC 接続マネージャーでの日付と時刻のパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-189">Using Date and Time Parameters with ODBC Connection Managers</span></span>  
 <span data-ttu-id="fa42c-190">ODBC 接続マネージャーを使用する場合、SQL 実行タスクには、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データ型 (`date`、`time`、`datetime`、`datetime2`、または `datetimeoffset`) のデータに関して特定のストレージ要件があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-190">When using an ODBC connection manager, an Execute SQL task has specific storage requirements for data with one of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, or `datetimeoffset`.</span></span> <span data-ttu-id="fa42c-191">このデータは、次のいずれかの型のパラメーターに格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-191">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="fa42c-192">SQL_WVARCHAR データ型の `input` パラメーター。</span><span class="sxs-lookup"><span data-stu-id="fa42c-192">An `input` parameter of the SQL_WVARCHAR data type</span></span>  
  
-   <span data-ttu-id="fa42c-193">次の表に示す、適切なデータ型の `output` パラメーター。</span><span class="sxs-lookup"><span data-stu-id="fa42c-193">An `output` parameter with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="fa42c-194">`Output` パラメーターの型</span><span class="sxs-lookup"><span data-stu-id="fa42c-194">`Output` parameter type</span></span>|<span data-ttu-id="fa42c-195">Date データ型</span><span class="sxs-lookup"><span data-stu-id="fa42c-195">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="fa42c-196">SQL_DATE</span><span class="sxs-lookup"><span data-stu-id="fa42c-196">SQL_DATE</span></span>|`date`|  
    |<span data-ttu-id="fa42c-197">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="fa42c-197">SQL_SS_TIME2</span></span>|`time`|  
    |<span data-ttu-id="fa42c-198">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="fa42c-198">SQL_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="fa42c-199">または</span><span class="sxs-lookup"><span data-stu-id="fa42c-199">-or-</span></span><br /><br /> <span data-ttu-id="fa42c-200">SQL_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="fa42c-200">SQL_TIMESTAMP</span></span>|<span data-ttu-id="fa42c-201">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="fa42c-201">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="fa42c-202">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="fa42c-202">SQL_SS_TIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="fa42c-203">データが適切な入力パラメーターまたは出力パラメーターに格納されないと、パッケージは失敗します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-203">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
##  <a name="using-parameters-in-where-clauses"></a><a name="WHERE_clauses"></a><span data-ttu-id="fa42c-204">WHERE 句でのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-204">Using Parameters in WHERE Clauses</span></span>  
 <span data-ttu-id="fa42c-205">SELECT、INSERT、UPDATE、および DELETE コマンドには、多くの場合、WHERE 句が含まれています。WHERE 句は、SQL コマンドを限定するために、ソース テーブル内の各行が満たすべき条件を定義したフィルターの役割を果たします。</span><span class="sxs-lookup"><span data-stu-id="fa42c-205">SELECT, INSERT, UPDATE, and DELETE commands frequently include WHERE clauses to specify filters that define the conditions each row in the source tables must meet to qualify for an SQL command.</span></span> <span data-ttu-id="fa42c-206">パラメーターは、WHERE 句で使用されるフィルター値を提供します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-206">Parameters provide the filter values in the WHERE clauses.</span></span>  
  
 <span data-ttu-id="fa42c-207">パラメーター マーカーを使用して、パラメーター値を動的に指定できます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-207">You can use parameter markers to dynamically provide parameter values.</span></span> <span data-ttu-id="fa42c-208">SQL ステートメントで使用できるパラメーター マーカーとパラメーター名に関する規則は、SQL 実行タスクで使用される接続マネージャーの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-208">The rules for which parameter markers and parameter names can be used in the SQL statement depend on the type of connection manager that the Execute SQL uses.</span></span>  
  
 <span data-ttu-id="fa42c-209">次の表に、SELECT コマンドの例を接続マネージャーの種類別に示します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-209">The following table lists examples of the SELECT command by connection manager type.</span></span> <span data-ttu-id="fa42c-210">INSERT、UPDATE、および DELETE ステートメントでも同様です。</span><span class="sxs-lookup"><span data-stu-id="fa42c-210">The INSERT, UPDATE, and DELETE statements are similar.</span></span> <span data-ttu-id="fa42c-211">この例では、SELECT を使用して、2 つのパラメーターで指定された値よりも **ProductID** の値が大きい製品と小さい製品を、 [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] の **Product** テーブルから返します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-211">The examples use SELECT to return products from the **Product** table in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] that have a **ProductID** greater than and less than the values specified by two parameters.</span></span>  
  
|<span data-ttu-id="fa42c-212">接続の種類</span><span class="sxs-lookup"><span data-stu-id="fa42c-212">Connection type</span></span>|<span data-ttu-id="fa42c-213">SELECT 構文</span><span class="sxs-lookup"><span data-stu-id="fa42c-213">SELECT syntax</span></span>|  
|---------------------|-------------------|  
|<span data-ttu-id="fa42c-214">EXCEL、ODBC、OLEDB</span><span class="sxs-lookup"><span data-stu-id="fa42c-214">EXCEL, ODBC, and OLEDB</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|<span data-ttu-id="fa42c-215">ADO (ADO)</span><span class="sxs-lookup"><span data-stu-id="fa42c-215">ADO</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|`SELECT* FROM Production.Product WHERE ProductId > @parmMinProductID AND ProductID < @parmMaxProductID`|  
  
 <span data-ttu-id="fa42c-216">この例では、次の名前のパラメーターが必要になります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-216">The examples would require parameters that have the following names:</span></span>  
  
-   <span data-ttu-id="fa42c-217">EXCEL 接続マネージャーと OLE DB 接続マネージャーでは、パラメーター名 0 と 1 を使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-217">The EXCEL and OLED DB connection managers use the parameter names 0 and 1.</span></span> <span data-ttu-id="fa42c-218">ODBC 接続では、1 と 2 を使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-218">The ODBC connection type uses 1 and 2.</span></span>  
  
-   <span data-ttu-id="fa42c-219">ADO 接続では、Param1 や Param2 など、任意の 2 つのパラメーター名を使用します。ただし、これらのパラメーター名は、パラメーター リストの序数位置によってマップされる必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-219">The ADO connection type could use any two parameter names, such as Param1 and Param2, but the parameters must be mapped by their ordinal position in the parameter list.</span></span>  
  
-   <span data-ttu-id="fa42c-220">[!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続では、パラメーター名 \@parmMinProductID と \@parmMaxProductID を使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-220">The [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection type uses the parameter names \@parmMinProductID and \@parmMaxProductID.</span></span>  
  
##  <a name="using-parameters-with-stored-procedures"></a><a name="Stored_procedures"></a><span data-ttu-id="fa42c-221">ストアドプロシージャでのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="fa42c-221">Using Parameters with Stored Procedures</span></span>  
 <span data-ttu-id="fa42c-222">ストアド プロシージャを実行する SQL コマンドでは、パラメーター マッピングを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-222">SQL commands that run stored procedures can also use parameter mapping.</span></span> <span data-ttu-id="fa42c-223">パラメーター マーカーとパラメーター名の使用方法に関する規則は、パラメーター化クエリの規則と同様に、SQL 実行タスクで使用される接続マネージャーの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-223">The rules for how to use parameter markers and parameter names depends on the type of connection manager that the Execute SQL uses, just like the rules for parameterized queries.</span></span>  
  
 <span data-ttu-id="fa42c-224">次の表に、EXEC コマンドの例を接続マネージャーの種類別に示します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-224">The following table lists examples of the EXEC command by connection manager type.</span></span> <span data-ttu-id="fa42c-225">この例では、 **の** uspGetBillOfMaterials [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)]ストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-225">The examples run the **uspGetBillOfMaterials** stored procedure in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span></span> <span data-ttu-id="fa42c-226">ストアドプロシージャでは、 `@StartProductID` パラメーターとパラメーターを使用し `@CheckDate` `input` ます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-226">The stored procedure uses the `@StartProductID` and `@CheckDate` `input` parameters.</span></span>  
  
|<span data-ttu-id="fa42c-227">接続の種類</span><span class="sxs-lookup"><span data-stu-id="fa42c-227">Connection type</span></span>|<span data-ttu-id="fa42c-228">EXEC 構文</span><span class="sxs-lookup"><span data-stu-id="fa42c-228">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="fa42c-229">EXCEL および OLEDB</span><span class="sxs-lookup"><span data-stu-id="fa42c-229">EXCEL and OLEDB</span></span>|`EXEC uspGetBillOfMaterials ?, ?`|  
|<span data-ttu-id="fa42c-230">ODBC</span><span class="sxs-lookup"><span data-stu-id="fa42c-230">ODBC</span></span>|`{call uspGetBillOfMaterials(?, ?)}`<br /><br /> <span data-ttu-id="fa42c-231">ODBC の呼び出し構文の詳細については、MSDN ライブラリの ODBC プログラマ リファレンスにある「 [プロシージャのパラメーター](https://go.microsoft.com/fwlink/?LinkId=89462)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-231">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="fa42c-232">ADO (ADO)</span><span class="sxs-lookup"><span data-stu-id="fa42c-232">ADO</span></span>|<span data-ttu-id="fa42c-233">IsQueryStoredProcedure がに設定されている場合 `False` 、`EXEC uspGetBillOfMaterials ?, ?`</span><span class="sxs-lookup"><span data-stu-id="fa42c-233">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials ?, ?`</span></span><br /><br /> <span data-ttu-id="fa42c-234">IsQueryStoredProcedure がに設定されている場合 `True` 、`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="fa42c-234">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="fa42c-235">IsQueryStoredProcedure がに設定されている場合 `False` 、`EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span><span class="sxs-lookup"><span data-stu-id="fa42c-235">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span></span><br /><br /> <span data-ttu-id="fa42c-236">IsQueryStoredProcedure がに設定されている場合 `True` 、`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="fa42c-236">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
  
 <span data-ttu-id="fa42c-237">出力パラメーターを使用するには、構文で各パラメーター マーカーの後に OUTPUT キーワードを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-237">To use output parameters, the syntax requires that the OUTPUT keyword follow each parameter marker.</span></span> <span data-ttu-id="fa42c-238">たとえば、 `EXEC myStoredProcedure ? OUTPUT`という出力パラメーターの構文は正しい構文です。</span><span class="sxs-lookup"><span data-stu-id="fa42c-238">For example, the following output parameter syntax is correct: `EXEC myStoredProcedure ? OUTPUT`.</span></span>  
  
 <span data-ttu-id="fa42c-239">Transact-SQL ストアド プロシージャでの入力パラメーターと出力パラメーターの使用の詳細については、「[EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-239">For more information about using input and output parameters with Transact-SQL stored procedures, see [EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql).</span></span>  
  
##  <a name="getting-values-of-return-codes"></a><a name="Return_codes"></a><span data-ttu-id="fa42c-240">リターンコードの値の取得</span><span class="sxs-lookup"><span data-stu-id="fa42c-240">Getting Values of Return Codes</span></span>  
 <span data-ttu-id="fa42c-241">ストアド プロシージャは、リターン コードという整数値を返してプロシージャの実行状態を表すことができます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-241">A stored procedure can return an integer value, called a return code, to indicate the execution status of a procedure.</span></span> <span data-ttu-id="fa42c-242">SQL 実行タスクにリターン コードを実装するには、`ReturnValue` 型のパラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-242">To implement return codes in the Execute SQL task, you use parameters of the `ReturnValue` type.</span></span>  
  
 <span data-ttu-id="fa42c-243">次の表に、リターン コードを実装する EXEC コマンドの一部の例を接続の種類別に示します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-243">The following table lists by connection type some examples of EXEC commands that implement return codes.</span></span> <span data-ttu-id="fa42c-244">すべての例で、`input` パラメーターを使用します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-244">All examples use an `input` parameter.</span></span> <span data-ttu-id="fa42c-245">パラメーターマーカーとパラメーター名の使用方法に関する規則は、すべてのパラメーターの型 (、、および) で同じです `Input` `Output` `ReturnValue` 。</span><span class="sxs-lookup"><span data-stu-id="fa42c-245">The rules for how to use parameter markers and parameter names are the same for all parameter types-`Input`, `Output`, and `ReturnValue`.</span></span>  
  
 <span data-ttu-id="fa42c-246">一部の構文では、パラメーターのリテラルがサポートされません。</span><span class="sxs-lookup"><span data-stu-id="fa42c-246">Some syntax does not support parameter literals.</span></span> <span data-ttu-id="fa42c-247">その場合は、変数を使用してパラメーター値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fa42c-247">In that case, you must provide the parameter value by using a variable.</span></span>  
  
|<span data-ttu-id="fa42c-248">接続の種類</span><span class="sxs-lookup"><span data-stu-id="fa42c-248">Connection type</span></span>|<span data-ttu-id="fa42c-249">EXEC 構文</span><span class="sxs-lookup"><span data-stu-id="fa42c-249">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="fa42c-250">EXCEL および OLEDB</span><span class="sxs-lookup"><span data-stu-id="fa42c-250">EXCEL and OLEDB</span></span>|`EXEC ? = myStoredProcedure 1`|  
|<span data-ttu-id="fa42c-251">ODBC</span><span class="sxs-lookup"><span data-stu-id="fa42c-251">ODBC</span></span>|`{? = call myStoredProcedure(1)}`<br /><br /> <span data-ttu-id="fa42c-252">ODBC の呼び出し構文の詳細については、MSDN ライブラリの ODBC プログラマ リファレンスにある「 [プロシージャのパラメーター](https://go.microsoft.com/fwlink/?LinkId=89462)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-252">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="fa42c-253">ADO (ADO)</span><span class="sxs-lookup"><span data-stu-id="fa42c-253">ADO</span></span>|<span data-ttu-id="fa42c-254">IsQueryStoreProcedure がに設定されている場合 `False` 、`EXEC ? = myStoredProcedure 1`</span><span class="sxs-lookup"><span data-stu-id="fa42c-254">If IsQueryStoreProcedure is set to `False`, `EXEC ? = myStoredProcedure 1`</span></span><br /><br /> <span data-ttu-id="fa42c-255">IsQueryStoreProcedure がに設定されている場合 `True` 、`myStoredProcedure`</span><span class="sxs-lookup"><span data-stu-id="fa42c-255">If IsQueryStoreProcedure is set to `True`, `myStoredProcedure`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="fa42c-256">Set IsQueryStoreProcedure がに設定されて `True` います。</span><span class="sxs-lookup"><span data-stu-id="fa42c-256">Set IsQueryStoreProcedure is set to `True`.</span></span><br /><br /> `myStoredProcedure`|  
  
 <span data-ttu-id="fa42c-257">前の表に示した構文では、SQL 実行タスクは **[直接入力]** ソース タイプを使用してストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-257">In the syntax shown in the previous table, the Execute SQL task uses the **Direct Input** source type to run the stored procedure.</span></span> <span data-ttu-id="fa42c-258">SQL 実行タスクは **[ファイル接続]** ソース タイプを使用してストアド プロシージャを実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="fa42c-258">The Execute SQL task can also use the **File Connection** source type to run a stored procedure.</span></span> <span data-ttu-id="fa42c-259">SQL 実行タスクが**直接入力**または**ファイル接続**のソースの種類を使用するかどうかにかかわらず、型のパラメーターを使用して `ReturnValue` リターンコードを実装します。</span><span class="sxs-lookup"><span data-stu-id="fa42c-259">Regardless of whether the Execute SQL task uses the **Direct Input** or **File Connection** source type, use a parameter of the `ReturnValue` type to implement the return code.</span></span> <span data-ttu-id="fa42c-260">SQL 実行タスクで実行される SQL ステートメントのソース タイプの構成方法の詳細については、「[[SQL 実行タスク エディター] &#40;[全般] タブ&#41;](general-page-of-integration-services-designers-options.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-260">For more information about how to configure the source type of the SQL statement that the Execute SQL task runs, see [Execute SQL Task Editor &#40;General Page&#41;](general-page-of-integration-services-designers-options.md).</span></span>  
  
 <span data-ttu-id="fa42c-261">Transact-SQL ストアド プロシージャでのリターン コードの使用の詳細については、「[RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-261">For more information about using return codes with Transact-SQL stored procedures, see [RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql).</span></span>  
  
##  <a name="configuring-parameters-and-return-codes-in-the-execute-sql-task"></a><a name="Configure_parameters_and_return_codes"></a><span data-ttu-id="fa42c-262">SQL 実行タスクでのパラメーターとリターンコードの構成</span><span class="sxs-lookup"><span data-stu-id="fa42c-262">Configuring Parameters and Return Codes in the Execute SQL Task</span></span>  
 <span data-ttu-id="fa42c-263">[!INCLUDE[ssIS](../includes/ssis-md.md)] デザイナーで設定できる、パラメーターとリターン コードのプロパティの詳細については、次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-263">For more information about the properties of parameters and return codes that you can set in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   <span data-ttu-id="fa42c-264">[[SQL 実行タスクエディター] &#40;[パラメーターマッピング] ページ&#41;](../../2014/integration-services/execute-sql-task-editor-parameter-mapping-page.md)</span><span class="sxs-lookup"><span data-stu-id="fa42c-264">[Execute SQL Task Editor &#40;Parameter Mapping Page&#41;](../../2014/integration-services/execute-sql-task-editor-parameter-mapping-page.md)</span></span>  
  
 <span data-ttu-id="fa42c-265">[!INCLUDE[ssIS](../includes/ssis-md.md)] デザイナーでこれらのプロパティを設定する方法については、次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="fa42c-265">For more information about how to set these properties in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="fa42c-266">タスクまたはコンテナーのプロパティを設定する</span><span class="sxs-lookup"><span data-stu-id="fa42c-266">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="fa42c-267">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="fa42c-267">Related Tasks</span></span>  
 [<span data-ttu-id="fa42c-268">タスクまたはコンテナーのプロパティを設定する</span><span class="sxs-lookup"><span data-stu-id="fa42c-268">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-content"></a><span data-ttu-id="fa42c-269">関連コンテンツ</span><span class="sxs-lookup"><span data-stu-id="fa42c-269">Related Content</span></span>  
  
-   <span data-ttu-id="fa42c-270">blogs.msdn.com のブログ「 [出力パラメーターを使用するストアド プロシージャ](https://go.microsoft.com/fwlink/?LinkId=157786)」</span><span class="sxs-lookup"><span data-stu-id="fa42c-270">Blog entry, [Stored procedures with output parameters](https://go.microsoft.com/fwlink/?LinkId=157786), on blogs.msdn.com</span></span>  
  
-   <span data-ttu-id="fa42c-271">msftisprodsamples.codeplex.com の CodePlex サンプル「 [Execute SQL Parameters and Result Sets](https://go.microsoft.com/fwlink/?LinkId=157863)」</span><span class="sxs-lookup"><span data-stu-id="fa42c-271">CodePlex sample, [Execute SQL Parameters and Result Sets](https://go.microsoft.com/fwlink/?LinkId=157863), on msftisprodsamples.codeplex.com</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fa42c-272">参照</span><span class="sxs-lookup"><span data-stu-id="fa42c-272">See Also</span></span>  
 <span data-ttu-id="fa42c-273">[SQL 実行タスク](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="fa42c-273">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 [<span data-ttu-id="fa42c-274">SQL 実行タスクにおける結果セット</span><span class="sxs-lookup"><span data-stu-id="fa42c-274">Result Sets in the Execute SQL Task</span></span>](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)  
  
  
