---
title: プログラムによる接続マネージャーの操作 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- connection managers [Integration Services], programming
ms.assetid: 2686fe84-1ecc-48b8-9160-e7122274bd84
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 01fc61a4a5c85366c7af8c5c68a73777049d3cba
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87642858"
---
# <a name="working-with-connection-managers-programmatically"></a><span data-ttu-id="90ae8-102">プログラムによる接続マネージャーの操作</span><span class="sxs-lookup"><span data-stu-id="90ae8-102">Working with Connection Managers Programmatically</span></span>
  <span data-ttu-id="90ae8-103">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] では、関連付けられた接続マネージャー クラスの AcquireConnection メソッドは、マネージド コードで接続マネージャーを操作する場合に呼び出すことの多いメソッドです。</span><span class="sxs-lookup"><span data-stu-id="90ae8-103">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the AcquireConnection method of the associated connection manager class is the method that you call most often when you are working with connection managers in managed code.</span></span> <span data-ttu-id="90ae8-104">マネージド コードを記述する場合、接続マネージャーの機能を使用するには AcquireConnection メソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="90ae8-104">When you write managed code, you have to call the AcquireConnection method to use the functionality of a connection manager.</span></span> <span data-ttu-id="90ae8-105">このメソッドは、マネージド コードを記述する場所がスクリプト タスク、スクリプト コンポーネント、カスタム オブジェクト、またはカスタム アプリケーションのいずれであっても、呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="90ae8-105">You have to call this method regardless of whether you are writing managed code in a Script task, Script component, custom object, or custom application.</span></span>  
  
 <span data-ttu-id="90ae8-106">AcquireConnection メソッドを正常に呼び出すには、次の点を理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="90ae8-106">To call the AcquireConnection method successfully, you have to know the answers to the following questions:</span></span>  
  
-   <span data-ttu-id="90ae8-107">**AcquireConnection メソッドからマネージド オブジェクトを返す接続マネージャーはどれか**</span><span class="sxs-lookup"><span data-stu-id="90ae8-107">**Which connection managers return a managed object from the AcquireConnection method?**</span></span>  
  
     <span data-ttu-id="90ae8-108">多くの接続マネージャーはアンマネージド COM オブジェクト (System.__ComObject) を返します。このオブジェクトをマネージド コードから使用するのは簡単ではありません。</span><span class="sxs-lookup"><span data-stu-id="90ae8-108">Many connection managers return unmanaged COM objects (System.__ComObject) and these objects cannot easily be used from managed code.</span></span> <span data-ttu-id="90ae8-109">このような接続マネージャーには、使用頻度の高い OLE DB 接続マネージャーも含まれます。</span><span class="sxs-lookup"><span data-stu-id="90ae8-109">The list of these connection managers includes the frequently used OLE DB connection manager.</span></span>  
  
-   <span data-ttu-id="90ae8-110">**マネージド オブジェクトを返す接続マネージャーの AcquireConnection メソッドによって返されるオブジェクトは何か**</span><span class="sxs-lookup"><span data-stu-id="90ae8-110">**For those connection managers that return a managed object, what objects do their AcquireConnection methods return?**</span></span>  
  
     <span data-ttu-id="90ae8-111">戻り値を適切な型にキャストするには、AcquireConnection メソッドによって返されるオブジェクトの型を把握しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="90ae8-111">To cast the return value to the appropriate type, you have to know what type of object the AcquireConnection method returns.</span></span> <span data-ttu-id="90ae8-112">たとえば、SqlClient プロバイダーを使用する場合、[!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーの AcquireConnection メソッドは、開かれている SqlConnection オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="90ae8-112">For example, the AcquireConnection method for the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager returns an open SqlConnection object when you use the SqlClient provider.</span></span> <span data-ttu-id="90ae8-113">これに対し、ファイル接続マネージャーの AcquireConnection メソッドは、文字列のみを返します。</span><span class="sxs-lookup"><span data-stu-id="90ae8-113">However, the AcquireConnection method for the File connection manager just returns a string.</span></span>  
  
 <span data-ttu-id="90ae8-114">このトピックでは、[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] に付属の接続マネージャーについて、上記の点を説明します。</span><span class="sxs-lookup"><span data-stu-id="90ae8-114">This topic answers these questions for the connection managers that are included with [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span>  
  
## <a name="connection-managers-that-do-not-return-a-managed-object"></a><span data-ttu-id="90ae8-115">マネージド オブジェクトを返さない接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-115">Connection Managers That Do Not Return a Managed Object</span></span>  
 <span data-ttu-id="90ae8-116">次の表に、AcquireConnection メソッドからネイティブ COM オブジェクト (System.__ComObject) を返す接続マネージャーを示します。</span><span class="sxs-lookup"><span data-stu-id="90ae8-116">The following table lists the connection managers that return a native COM object (System.__ComObject) from the AcquireConnection method.</span></span> <span data-ttu-id="90ae8-117">これらのアンマネージド オブジェクトは、マネージド コードから簡単には使用できません。</span><span class="sxs-lookup"><span data-stu-id="90ae8-117">These unmanaged objects cannot easily be used from managed code.</span></span>  
  
|<span data-ttu-id="90ae8-118">接続マネージャーの種類</span><span class="sxs-lookup"><span data-stu-id="90ae8-118">Connection Manager Type</span></span>|<span data-ttu-id="90ae8-119">接続マネージャー名</span><span class="sxs-lookup"><span data-stu-id="90ae8-119">Connection Manager Name</span></span>|  
|-----------------------------|-----------------------------|  
|<span data-ttu-id="90ae8-120">ADO (ADO)</span><span class="sxs-lookup"><span data-stu-id="90ae8-120">ADO</span></span>|<span data-ttu-id="90ae8-121">ADO 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-121">ADO Connection Manager</span></span>|  
|<span data-ttu-id="90ae8-122">MSOLAP90</span><span class="sxs-lookup"><span data-stu-id="90ae8-122">MSOLAP90</span></span>|[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] <span data-ttu-id="90ae8-123">接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-123">Connection Manager</span></span>|  
|<span data-ttu-id="90ae8-124">EXCEL</span><span class="sxs-lookup"><span data-stu-id="90ae8-124">EXCEL</span></span>|<span data-ttu-id="90ae8-125">Excel 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-125">Excel Connection Manager</span></span>|  
|<span data-ttu-id="90ae8-126">FTP</span><span class="sxs-lookup"><span data-stu-id="90ae8-126">FTP</span></span>|<span data-ttu-id="90ae8-127">FTP 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-127">FTP Connection Manager</span></span>|  
|<span data-ttu-id="90ae8-128">HTTP</span><span class="sxs-lookup"><span data-stu-id="90ae8-128">HTTP</span></span>|<span data-ttu-id="90ae8-129">HTTP 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-129">HTTP Connection Manager</span></span>|  
|<span data-ttu-id="90ae8-130">ODBC</span><span class="sxs-lookup"><span data-stu-id="90ae8-130">ODBC</span></span>|<span data-ttu-id="90ae8-131">ODBC 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-131">ODBC Connection Manager</span></span>|  
|<span data-ttu-id="90ae8-132">OLEDB</span><span class="sxs-lookup"><span data-stu-id="90ae8-132">OLEDB</span></span>|<span data-ttu-id="90ae8-133">OLE DB 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-133">OLE DB Connection Manager</span></span>|  
  
 <span data-ttu-id="90ae8-134">通常は、マネージド コードから [!INCLUDE[vstecado](../includes/vstecado-md.md)] 接続マネージャーを使用すると、ADO、Excel、ODBC、または OLE DB の各データ ソースに接続できます。</span><span class="sxs-lookup"><span data-stu-id="90ae8-134">Typically, you can use an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager from managed code to connect to an ADO, Excel, ODBC, or OLE DB data source.</span></span>  
  
## <a name="return-values-from-the-acquireconnection-method"></a><span data-ttu-id="90ae8-135">AcquireConnection メソッドからの戻り値</span><span class="sxs-lookup"><span data-stu-id="90ae8-135">Return Values from the AcquireConnection Method</span></span>  
 <span data-ttu-id="90ae8-136">次の表に、AcquireConnection メソッドからマネージド オブジェクトを返す接続マネージャーを示します。</span><span class="sxs-lookup"><span data-stu-id="90ae8-136">The following table lists the connection managers that return a managed object from the AcquireConnection method.</span></span> <span data-ttu-id="90ae8-137">これらのマネージド オブジェクトは、マネージド コードから簡単に使用できます。</span><span class="sxs-lookup"><span data-stu-id="90ae8-137">These managed objects can easily be used from managed code.</span></span>  
  
|<span data-ttu-id="90ae8-138">接続マネージャーの種類</span><span class="sxs-lookup"><span data-stu-id="90ae8-138">Connection Manager Type</span></span>|<span data-ttu-id="90ae8-139">接続マネージャー名</span><span class="sxs-lookup"><span data-stu-id="90ae8-139">Connection Manager Name</span></span>|<span data-ttu-id="90ae8-140">戻り値の型</span><span class="sxs-lookup"><span data-stu-id="90ae8-140">Type of Return Value</span></span>|<span data-ttu-id="90ae8-141">追加情報</span><span class="sxs-lookup"><span data-stu-id="90ae8-141">Additional Information</span></span>|  
|-----------------------------|-----------------------------|--------------------------|----------------------------|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|[!INCLUDE[vstecado](../includes/vstecado-md.md)] <span data-ttu-id="90ae8-142">接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-142">Connection Manager</span></span>|`System.Data.SqlClient.SqlConnection`||  
|<span data-ttu-id="90ae8-143">FILE</span><span class="sxs-lookup"><span data-stu-id="90ae8-143">FILE</span></span>|<span data-ttu-id="90ae8-144">ファイル接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-144">File Connection Manager</span></span>|`System.String`|<span data-ttu-id="90ae8-145">ファイルへのパス。</span><span class="sxs-lookup"><span data-stu-id="90ae8-145">Path to the file.</span></span>|  
|<span data-ttu-id="90ae8-146">FLATFILE</span><span class="sxs-lookup"><span data-stu-id="90ae8-146">FLATFILE</span></span>|<span data-ttu-id="90ae8-147">フラット ファイル接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-147">Flat File Connection Manager</span></span>|`System.String`|<span data-ttu-id="90ae8-148">ファイルへのパス。</span><span class="sxs-lookup"><span data-stu-id="90ae8-148">Path to the file.</span></span>|  
|<span data-ttu-id="90ae8-149">MSMQ (MSMQ)</span><span class="sxs-lookup"><span data-stu-id="90ae8-149">MSMQ</span></span>|<span data-ttu-id="90ae8-150">MSMQ 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-150">MSMQ Connection Manager</span></span>|`System.Messaging.MessageQueue`||  
|<span data-ttu-id="90ae8-151">MULTIFILE</span><span class="sxs-lookup"><span data-stu-id="90ae8-151">MULTIFILE</span></span>|<span data-ttu-id="90ae8-152">複数ファイル接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-152">Multiple Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="90ae8-153">いずれかのファイルへのパス。</span><span class="sxs-lookup"><span data-stu-id="90ae8-153">Path to one of the files.</span></span>|  
|<span data-ttu-id="90ae8-154">MULTIFLATFILE</span><span class="sxs-lookup"><span data-stu-id="90ae8-154">MULTIFLATFILE</span></span>|<span data-ttu-id="90ae8-155">複数フラット ファイル接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-155">Multiple Flat Files Connection Manager</span></span>|`System.String`|<span data-ttu-id="90ae8-156">いずれかのファイルへのパス。</span><span class="sxs-lookup"><span data-stu-id="90ae8-156">Path to one of the files.</span></span>|  
|<span data-ttu-id="90ae8-157">SMOServer</span><span class="sxs-lookup"><span data-stu-id="90ae8-157">SMOServer</span></span>|<span data-ttu-id="90ae8-158">SMO 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-158">SMO Connection Manager</span></span>|`Microsoft.SqlServer.Management.Smo.Server`||  
|<span data-ttu-id="90ae8-159">SMTP</span><span class="sxs-lookup"><span data-stu-id="90ae8-159">SMTP</span></span>|<span data-ttu-id="90ae8-160">SMTP 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-160">SMTP Connection Manager</span></span>|`System.String`|<span data-ttu-id="90ae8-161">例: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span><span class="sxs-lookup"><span data-stu-id="90ae8-161">For example: `SmtpServer=<server name>;UseWindowsAuthentication=True;EnableSsl=False;`</span></span>|  
|<span data-ttu-id="90ae8-162">WMI</span><span class="sxs-lookup"><span data-stu-id="90ae8-162">WMI</span></span>|<span data-ttu-id="90ae8-163">WMI 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-163">WMI Connection Manager</span></span>|`System.Management.ManagementScope`||  
|<span data-ttu-id="90ae8-164">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="90ae8-164">SQLMOBILE</span></span>|<span data-ttu-id="90ae8-165">SQL Server Compact 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="90ae8-165">SQL Server Compact Connection Manager</span></span>|`System.Data.SqlServerCe.SqlCeConnection`||  
  
<span data-ttu-id="90ae8-166">![Integration Services アイコン (小)](media/dts-16.gif "Integration Services のアイコン (小)")**は Integration Services で最新の**状態を維持  </span><span class="sxs-lookup"><span data-stu-id="90ae8-166">![Integration Services icon (small)](media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="90ae8-167">マイクロソフトが提供する最新のダウンロード、アーティクル、サンプル、ビデオ、およびコミュニティで選択されたソリューションについては、MSDN の [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] のページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="90ae8-167">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="90ae8-168">MSDN の Integration Services のページを参照する</span><span class="sxs-lookup"><span data-stu-id="90ae8-168">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="90ae8-169">これらの更新が自動で通知されるようにするには、ページの RSS フィードを定期受信します。</span><span class="sxs-lookup"><span data-stu-id="90ae8-169">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="90ae8-170">参照</span><span class="sxs-lookup"><span data-stu-id="90ae8-170">See Also</span></span>  
 <span data-ttu-id="90ae8-171">[スクリプトタスクでのデータソースへの接続](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span><span class="sxs-lookup"><span data-stu-id="90ae8-171">[Connecting to Data Sources in the Script Task](extending-packages-scripting/task/connecting-to-data-sources-in-the-script-task.md) </span></span>  
 <span data-ttu-id="90ae8-172">[スクリプトコンポーネントでのデータソースへの接続](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span><span class="sxs-lookup"><span data-stu-id="90ae8-172">[Connecting to Data Sources in the Script Component](extending-packages-scripting/data-flow-script-component/connecting-to-data-sources-in-the-script-component.md) </span></span>  
 [<span data-ttu-id="90ae8-173">カスタム タスクでのデータ ソースへの接続</span><span class="sxs-lookup"><span data-stu-id="90ae8-173">Connecting to Data Sources in a Custom Task</span></span>](extending-packages-custom-objects/task/connecting-to-data-sources-in-a-custom-task.md)  
  
  
