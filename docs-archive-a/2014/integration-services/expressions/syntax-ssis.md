---
title: 構文 (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- expressions [Integration Services], syntax
- syntax [Integration Services]
ms.assetid: 61c053c5-1182-4ad0-b804-51cbd19aa0ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d7be12ee5e0467e3789fbe2771d881d9ae3f25f3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87716457"
---
# <a name="syntax-ssis"></a><span data-ttu-id="f3dc0-102">構文 (SSIS)</span><span class="sxs-lookup"><span data-stu-id="f3dc0-102">Syntax (SSIS)</span></span>
  <span data-ttu-id="f3dc0-103">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 式の構文は、C 言語および C# 言語が使用する構文と同様です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-103">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] expression syntax is similar to the syntax that the C and C# languages use.</span></span> <span data-ttu-id="f3dc0-104">式には、識別子 (列および変数)、リテラル、演算子、関数などの要素が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-104">Expressions include elements such as identifiers (columns and variables), literals, operators, and functions.</span></span> <span data-ttu-id="f3dc0-105">このトピックでは、式エバリュエーターの構文がさまざまな式要素を適用する際の、一意の必要条件の概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-105">This topic summarizes the unique requirements of the expression evaluator syntax as they apply to different expression elements.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f3dc0-106">前のリリースの [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]では、式の評価結果の [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] データ型が DT_WSTR または DT_STR であるとき、結果の文字数が 4,000 文字に制限されていました。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-106">In previous releases of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], there was a 4000-character limit on the evaluation result of an expression when the result had the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] data type DT_WSTR or DT_STR.</span></span> <span data-ttu-id="f3dc0-107">この制限はなくなっています。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-107">This limit has been removed.</span></span>  
  
 <span data-ttu-id="f3dc0-108">特定の演算子と関数を使用するサンプル式については、「[演算子 (SSIS 式)](operators-ssis-expression.md)」および「[関数 (SSIS 式)](functions-ssis-expression.md)」の各演算子と関数のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-108">For sample expressions that use specific operators and functions, see the topic about each operator and function in the topics: [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md) and [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
 <span data-ttu-id="f3dc0-109">複数の演算子と関数、および識別子とリテラルを使用するサンプル式については、「 [Integration Services 式の詳細の例](examples-of-advanced-integration-services-expressions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-109">For sample expressions that use multiple operators and functions as well as identifiers and literals, see [Examples of Advanced Integration Services Expressions](examples-of-advanced-integration-services-expressions.md).</span></span>  
  
 <span data-ttu-id="f3dc0-110">プロパティの式で使用するサンプル式については、「 [パッケージでプロパティ式を使用する](use-property-expressions-in-packages.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-110">For sample expressions to use in property expressions, see [Use Property Expressions in Packages](use-property-expressions-in-packages.md).</span></span>  
  
## <a name="identifiers"></a><span data-ttu-id="f3dc0-111">識別子</span><span class="sxs-lookup"><span data-stu-id="f3dc0-111">Identifiers</span></span>  
 <span data-ttu-id="f3dc0-112">式には、列および変数の識別子を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-112">Expressions can include column and variable identifiers.</span></span> <span data-ttu-id="f3dc0-113">列はデータ ソースで生成されるか、またはデータ フローの変換によって作成できます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-113">The columns can originate in the data source or can be created by transformations in the data flow.</span></span> <span data-ttu-id="f3dc0-114">式では、系列 ID を使用して列を参照できます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-114">Expressions can use lineage identifiers to refer to columns.</span></span> <span data-ttu-id="f3dc0-115">系列 ID は、パッケージの要素を一意に識別する数値です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-115">Lineage identifiers are numbers that uniquely identify package elements.</span></span> <span data-ttu-id="f3dc0-116">系列 ID を式の内部で参照する場合、系列 ID にポンド (#) プレフィックスを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-116">Lineage identifiers, referenced in an expression, must include the pound (#) prefix.</span></span> <span data-ttu-id="f3dc0-117">たとえば、系列 ID 138 を参照するには、#138 を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-117">For example, the lineage identifier 138 is referenced using #138.</span></span>  
  
 <span data-ttu-id="f3dc0-118">式には、 [!INCLUDE[ssIS](../../includes/ssis-md.md)] で用意されているシステム変数と、カスタム変数を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-118">Expressions can include the system variables that [!INCLUDE[ssIS](../../includes/ssis-md.md)] provides and custom variables.</span></span> <span data-ttu-id="f3dc0-119">変数を式の内部で参照する場合、変数に \@ プレフィックスを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-119">Variables, when referenced in an expression, must include the \@ prefix.</span></span> <span data-ttu-id="f3dc0-120">たとえば、`Counter` 変数を参照する場合、\@Counter を使用します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-120">For example, the `Counter` variable is referenced using \@Counter.</span></span> <span data-ttu-id="f3dc0-121">\@ 文字は変数名の一部ではなく、式の評価において識別子が変数であることを示すだけのものです。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-121">The \@ character is not part of the variable name; it only indicates to the expression evaluator that the identifier is a variable.</span></span> <span data-ttu-id="f3dc0-122">詳しくは、「[識別子 &#40;SSIS&#41;](identifiers-ssis.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-122">For more information, see [Identifiers &#40;SSIS&#41;](identifiers-ssis.md).</span></span>  
  
## <a name="literals"></a><span data-ttu-id="f3dc0-123">リテラル</span><span class="sxs-lookup"><span data-stu-id="f3dc0-123">Literals</span></span>  
 <span data-ttu-id="f3dc0-124">式には、数値、文字列、およびブール値のリテラルを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-124">Expressions can include numeric, string, and Boolean literals.</span></span> <span data-ttu-id="f3dc0-125">文字列リテラルを式で使用するには、引用符で囲む必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-125">String literals used in expressions must be enclosed in quotation marks.</span></span> <span data-ttu-id="f3dc0-126">数値リテラルおよびブール値のリテラルには、引用符は付けません。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-126">Numeric and Boolean literals do not take quotation marks.</span></span> <span data-ttu-id="f3dc0-127">式言語には、通常エスケープされる文字のエスケープ シーケンスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-127">The expression language includes escape sequences for characters that are frequently escaped.</span></span> <span data-ttu-id="f3dc0-128">詳細については、「[リテラル (SSIS)](numeric-string-and-boolean-literals.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-128">For more information, see [Literals &#40;SSIS&#41;](numeric-string-and-boolean-literals.md).</span></span>  
  
## <a name="operators"></a><span data-ttu-id="f3dc0-129">オペレーター</span><span class="sxs-lookup"><span data-stu-id="f3dc0-129">Operators</span></span>  
 <span data-ttu-id="f3dc0-130">式エバリュエーターで提供される演算子セットの機能は、Transact-SQL、C++、C# などの言語に含まれる、演算子セットの機能と同様です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-130">The expression evaluator provides a set of operators that provides functionality similar to the set of operators in languages such as Transact-SQL, C++, and C#.</span></span> <span data-ttu-id="f3dc0-131">ただし、式言語には別の演算子が含まれており、周知の記号とは異なる記号が使用されます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-131">However, the expression language includes additional operators and uses different symbols than those you may be familiar with.</span></span> <span data-ttu-id="f3dc0-132">詳細については、「[演算子 (SSIS)](operators-ssis-expression.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-132">For more information, see [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md).</span></span>  
  
### <a name="namespace-resolution-operator"></a><span data-ttu-id="f3dc0-133">名前空間を解決する演算子</span><span class="sxs-lookup"><span data-stu-id="f3dc0-133">Namespace Resolution Operator</span></span>  
 <span data-ttu-id="f3dc0-134">式では名前空間を解決する演算子 (::) が使用され、同じ名前を持つ複数の変数を明確に識別します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-134">Expressions use the namespace resolution operator (::) to disambiguate variables that have the same name.</span></span> <span data-ttu-id="f3dc0-135">名前空間を解決する演算子を使用すると、変数をその名前空間で修飾でき、これによって、同じ名前を持つ複数の変数をパッケージ内で使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-135">By using the namespace resolution operator, you can qualify the variable with its namespace, which makes it possible to use multiple variables with the same name in a package.</span></span>  
  
#### <a name="cast-operator"></a><span data-ttu-id="f3dc0-136">キャスト演算子</span><span class="sxs-lookup"><span data-stu-id="f3dc0-136">Cast Operator</span></span>  
 <span data-ttu-id="f3dc0-137">キャスト演算子は、式の結果、列の値、変数の値、および定数を、あるデータ型から別のデータ型に変換します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-137">The cast operator converts expression results, column values, variable values, and constants from one data type to another.</span></span> <span data-ttu-id="f3dc0-138">式言語が提供するキャスト演算子は、C および C# 言語が提供するものと同様です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-138">The cast operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="f3dc0-139">Transact-SQL では、CAST 関数と CONVERT 関数によってこの機能が提供されます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-139">In Transact-SQL, the CAST and CONVERT functions provide this functionality.</span></span> <span data-ttu-id="f3dc0-140">キャスト演算子の構文は、CAST 関数や CONVERT 関数が使用する構文と、次の点が異なります。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-140">The syntax of the cast operator is different from ones used by CAST and CONVERT in the following ways:</span></span>  
  
-   <span data-ttu-id="f3dc0-141">式を引数として使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-141">It can use an expression as an argument.</span></span>  
  
-   <span data-ttu-id="f3dc0-142">構文に CAST キーワードが含まれません。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-142">Its syntax does not include the CAST keyword.</span></span>  
  
-   <span data-ttu-id="f3dc0-143">構文に AS キーワードが含まれません。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-143">Its syntax does not include the AS keyword.</span></span>  
  
##### <a name="conditional-operator"></a><span data-ttu-id="f3dc0-144">条件演算子</span><span class="sxs-lookup"><span data-stu-id="f3dc0-144">Conditional Operator</span></span>  
 <span data-ttu-id="f3dc0-145">条件演算子は、ブール式の評価に基づいて 2 つの式のうちのいずれかの式を返します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-145">The conditional operator returns one of two expressions, based on the evaluation of a Boolean expression.</span></span> <span data-ttu-id="f3dc0-146">式言語が提供する条件演算子は、C および C# 言語が提供する条件演算子と同様です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-146">The conditional operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="f3dc0-147">多次元式 (MDX) では、IIF 関数が同様の機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-147">In multidimensional expressions (MDX), the IIF function provides similar functionality.</span></span>  
  
###### <a name="logical-operators"></a><span data-ttu-id="f3dc0-148">論理演算子</span><span class="sxs-lookup"><span data-stu-id="f3dc0-148">Logical Operators</span></span>  
 <span data-ttu-id="f3dc0-149">式言語では、論理 NOT 演算子の !</span><span class="sxs-lookup"><span data-stu-id="f3dc0-149">The expression language supports the !</span></span> <span data-ttu-id="f3dc0-150">文字がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-150">character for the logical NOT operator.</span></span> <span data-ttu-id="f3dc0-151">Transact-SQL では、!</span><span class="sxs-lookup"><span data-stu-id="f3dc0-151">In Transact-SQL, the !</span></span> <span data-ttu-id="f3dc0-152">演算子は関係演算子のセットに組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-152">operator is built into the set of relational operators.</span></span> <span data-ttu-id="f3dc0-153">たとえば、Transact-SQL には、> 演算子および !> 演算子が用意されています。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-153">For example, Transact-SQL provides the > and the !> operators.</span></span> <span data-ttu-id="f3dc0-154">[!INCLUDE[ssIS](../../includes/ssis-md.md)] 式言語では、!</span><span class="sxs-lookup"><span data-stu-id="f3dc0-154">The [!INCLUDE[ssIS](../../includes/ssis-md.md)] expression language does not support the combination of the !</span></span> <span data-ttu-id="f3dc0-155">演算子とその他の演算子の組み合わせはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-155">operator and other operators.</span></span> <span data-ttu-id="f3dc0-156">たとえば、!</span><span class="sxs-lookup"><span data-stu-id="f3dc0-156">For example, it is not valid to combine !</span></span> <span data-ttu-id="f3dc0-157">と > を結合して !> にすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-157">and > into !>.</span></span> <span data-ttu-id="f3dc0-158">ただし、この式言語では、等しくない比較を表すために、!= の文字の組み合わせがあらかじめサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-158">However, the expression language does support a built-in != combination of characters for the not-equal-to comparison.</span></span>  
  
###### <a name="equality-operators"></a><span data-ttu-id="f3dc0-159">等価演算子</span><span class="sxs-lookup"><span data-stu-id="f3dc0-159">Equality Operators</span></span>  
 <span data-ttu-id="f3dc0-160">式エバリュエーターの文法では、== 等価演算子が用意されています。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-160">The expression evaluator grammar provides the == equality operator.</span></span> <span data-ttu-id="f3dc0-161">この演算子は、Transact-SQL での = 演算子、および C# での == 演算子と同等です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-161">This operator is the equivalent of the = operator in Transact-SQL and the == operator in C#.</span></span>  
  
## <a name="functions"></a><span data-ttu-id="f3dc0-162">関数</span><span class="sxs-lookup"><span data-stu-id="f3dc0-162">Functions</span></span>  
 <span data-ttu-id="f3dc0-163">式言語には、日付と時刻の関数、数学関数、および文字列関数が提供されています。これらの関数は、Transact-SQL 関数や C# のメソッドと同様です。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-163">The expression language includes date and time functions, mathematical functions, and string functions that are similar to Transact-SQL functions and C# methods.</span></span>  
  
 <span data-ttu-id="f3dc0-164">いくつかの関数は、Transact-SQL 関数と同じ名前を持っていますが、式エバリュエーターの関数の機能は微妙に異なります。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-164">A few functions have the same names as Transact-SQL functions, but have subtly different functionality in the expression evaluator.</span></span>  
  
-   <span data-ttu-id="f3dc0-165">Transact-SQL の ISNULL 関数は指定した値に NULL 値を置き換えますが、式エバリュエーターの ISNULL 関数は、式が NULL であるかどうかに基づくブール値を返します。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-165">In Transact-SQL, the ISNULL function replaces null values with a specified value, whereas the expression evaluator ISNULL function returns a Boolean based on whether an expression is null.</span></span>  
  
-   <span data-ttu-id="f3dc0-166">Transact-SQL の ROUND 関数には、結果セットを切り捨てるオプションが含まれますが、式エバリュエーターの ROUND 関数には含まれません。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-166">In Transact-SQL, the ROUND function includes an option to truncate the result set, whereas the expression evaluator ROUND function does not.</span></span>  
  
 <span data-ttu-id="f3dc0-167">詳細については、「[関数 (SSIS 式)](functions-ssis-expression.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3dc0-167">For more information, see [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="f3dc0-168">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="f3dc0-168">Related Tasks</span></span>  
 [<span data-ttu-id="f3dc0-169">データ フロー コンポーネントで式を使用する</span><span class="sxs-lookup"><span data-stu-id="f3dc0-169">Use an Expression in a Data Flow Component</span></span>](../use-an-expression-in-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="f3dc0-170">関連コンテンツ</span><span class="sxs-lookup"><span data-stu-id="f3dc0-170">Related Content</span></span>  
  
-   <span data-ttu-id="f3dc0-171">pragmaticworks.com の技術記事「 [SSIS 式チート シート](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet)」</span><span class="sxs-lookup"><span data-stu-id="f3dc0-171">Technical article, [SSIS Expression Cheat Sheet](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet), on pragmaticworks.com</span></span>  
  
-   <span data-ttu-id="f3dc0-172">social.technet.microsoft.com の技術記事「 [SSIS 式の例](https://go.microsoft.com/fwlink/?LinkId=220761)」</span><span class="sxs-lookup"><span data-stu-id="f3dc0-172">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>  
  
  
