---
title: パッケージでプロパティ式を使用する | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- packages [Integration Services], expressions
- Integration Services packages, expressions
- SQL Server Integration Services packages, expressions
- dynamic properties
- updating package properties
- SSIS packages, expressions
- expressions [Integration Services], property expressions
- property expressions [Integration Services]
ms.assetid: a4bfc925-3ef6-431e-b1dd-7e0023d3a92d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: bb373428e91cfc8cb4b26a986da6d795ab2fea98
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643465"
---
# <a name="use-property-expressions-in-packages"></a><span data-ttu-id="13574-102">パッケージでプロパティ式を使用する</span><span class="sxs-lookup"><span data-stu-id="13574-102">Use Property Expressions in Packages</span></span>
  <span data-ttu-id="13574-103">プロパティ式とは、実行時にプロパティの動的更新を可能にするためにプロパティに割り当てられた式のことです。</span><span class="sxs-lookup"><span data-stu-id="13574-103">A property expression is an expression that is assigned to a property to enable dynamic update of the property at run time.</span></span> <span data-ttu-id="13574-104">たとえば、プロパティ式を使用して、変数に格納された電子メール アドレスを挿入して、メール送信タスクで使用される [宛先] 行を更新できます。</span><span class="sxs-lookup"><span data-stu-id="13574-104">For example, a property expression can update the To line that a Send Mail task uses by inserting an e-mail address that is stored in a variable.</span></span>

 <span data-ttu-id="13574-105">式は、パッケージ、タスク、Foreach ループ、For ループ、シーケンス、Foreach 列挙子、イベント ハンドラー、パッケージまたはプロジェクト レベルの接続マネージャー、またはログ プロバイダーに追加できます。</span><span class="sxs-lookup"><span data-stu-id="13574-105">An expression can be added to a package, task, Foreach Loop, For Loop, Sequence, Foreach enumerator, event handler, a package or project level connection manager, or log provider.</span></span> <span data-ttu-id="13574-106">これらのオブジェクトの読み取り/書き込みプロパティはすべて、プロパティ式を実装できます。</span><span class="sxs-lookup"><span data-stu-id="13574-106">Any property of these objects that is read/write can implement a property expression.</span></span> [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="13574-107">では、データ フロー コンポーネントの一部のカスタム プロパティでプロパティ式を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="13574-107">also supports the use of property expressions in some custom properties of data flow components.</span></span> <span data-ttu-id="13574-108">変数と優先順位制約では、プロパティ式がサポートされていませんが、式を使用できる特殊なプロパティが使用されています。</span><span class="sxs-lookup"><span data-stu-id="13574-108">Variables and precedence constraints do not support property expressions, but they include special properties in which you can use expressions.</span></span>

 <span data-ttu-id="13574-109">プロパティ式は、いろいろな方法で更新できます。</span><span class="sxs-lookup"><span data-stu-id="13574-109">Property expressions can be updated in different ways:</span></span>

-   <span data-ttu-id="13574-110">ユーザー定義変数をパッケージ構成に含め、パッケージを配置するときに更新できます。</span><span class="sxs-lookup"><span data-stu-id="13574-110">User-defined variables can be included in package configurations and then updated when the package is deployed.</span></span> <span data-ttu-id="13574-111">実行時には、プロパティ式は更新された変数値を使用して評価されます。</span><span class="sxs-lookup"><span data-stu-id="13574-111">At run time, the property expression is evaluated using the updated variable value.</span></span>

-   <span data-ttu-id="13574-112">式に含まれるシステム変数は実行時に更新されます。これにより、プロパティの評価結果が変わります。</span><span class="sxs-lookup"><span data-stu-id="13574-112">System variables that are included in expressions are updated at run time, which changes the results of the property evaluation.</span></span>

-   <span data-ttu-id="13574-113">日付と時刻の関数は実行時に評価され、更新された値をプロパティ式に提供します。</span><span class="sxs-lookup"><span data-stu-id="13574-113">Date and time functions are evaluated at run time and provide the updated values to property expressions.</span></span>

-   <span data-ttu-id="13574-114">式内の変数は、スクリプト タスクおよびスクリプト コンポーネントが実行するスクリプトによって更新できます。</span><span class="sxs-lookup"><span data-stu-id="13574-114">Variables in expressions can be updated by the scripts that the Script task and the Script component run.</span></span>

 <span data-ttu-id="13574-115">式は、[!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 式言語を使用して作成します。</span><span class="sxs-lookup"><span data-stu-id="13574-115">The expressions are built using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression language.</span></span> <span data-ttu-id="13574-116">式では、式言語で提供される演算子、関数、および型キャストと組み合わせて、システム変数またはユーザー定義変数を使用できます。</span><span class="sxs-lookup"><span data-stu-id="13574-116">The expressions can use system or user-defined variables, together with the operators, functions, and type casts that the expression language provides.</span></span>

> [!NOTE]
>  <span data-ttu-id="13574-117">ユーザー定義変数およびシステム変数の名前では、大文字と小文字が区別されます。</span><span class="sxs-lookup"><span data-stu-id="13574-117">The names of user-defined and system variables are case-sensitive.</span></span>

 <span data-ttu-id="13574-118">詳細については、「 [Integration Services (SSIS) 式](integration-services-ssis-expressions.md)に評価されるまでそのワークフローを繰り返します。</span><span class="sxs-lookup"><span data-stu-id="13574-118">For more information, see [Integration Services &#40;SSIS&#41; Expressions](integration-services-ssis-expressions.md).</span></span>

 <span data-ttu-id="13574-119">プロパティ式の重要な使い方として、パッケージを配置するインスタンスごとに構成をカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="13574-119">An important use of property expressions is to customize configurations for each deployed instance of a package.</span></span> <span data-ttu-id="13574-120">これにより、異なる環境に合わせてパッケージのプロパティを動的に更新できます。</span><span class="sxs-lookup"><span data-stu-id="13574-120">This makes it possible to dynamically update package properties for different environments.</span></span> <span data-ttu-id="13574-121">たとえば、接続マネージャーの接続文字列に変数を割り当てるプロパティ式を作成し、パッケージが配置されたときに変数が更新されるようにしておくと、実行時に適切な接続文字列が使用されます。</span><span class="sxs-lookup"><span data-stu-id="13574-121">For example, you can create a property expression that assigns a variable to the connection string of a connection manager, and then update the variable when the package is deployed, ensuring that the connection string is correct at run time.</span></span> <span data-ttu-id="13574-122">パッケージの構成は、プロパティ式が評価される前に読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="13574-122">Package configurations are loaded before the property expressions are evaluated.</span></span>

 <span data-ttu-id="13574-123">1 つのプロパティで使用できるプロパティ式は 1 つだけであり、1 つのプロパティ式は 1 つのプロパティだけに適用できます。</span><span class="sxs-lookup"><span data-stu-id="13574-123">A property can use only one property expression and a property expression can apply only to one property.</span></span> <span data-ttu-id="13574-124">ただし、同じプロパティ式を複数個作成し、それらを異なるプロパティに割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="13574-124">However, you can build multiple identical property expressions and assign them to different properties.</span></span>

 <span data-ttu-id="13574-125">プロパティによっては、列挙子の値を使用して設定するものもあります。</span><span class="sxs-lookup"><span data-stu-id="13574-125">Some properties are set by using values from enumerators.</span></span> <span data-ttu-id="13574-126">プロパティ式で列挙子メンバーを参照するときは、その列挙子メンバーの表示名に相当する数値を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="13574-126">When you reference the enumerator member in a property expression, you must use the numeric value that is equivalent to the friendly name of the enumerator member.</span></span> <span data-ttu-id="13574-127">たとえば、プロパティ式で `LoggingMode` 列挙からの値を使用する `DTSLoggingMode` プロパティを設定する場合、プロパティ式では表示名 `Enabled`、`Disabled`、または `UseParentSetting` ではなく 0、1、または 2 を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="13574-127">For example, if a property expression sets the `LoggingMode` property, which uses a value from the `DTSLoggingMode` enumeration, the property expression must use 0, 1, or 2 instead of the friendly names `Enabled`, `Disabled`, or `UseParentSetting`.</span></span> <span data-ttu-id="13574-128">詳細については、「 [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md)」(プロパティ式における列挙定数) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="13574-128">For more information, see [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md).</span></span>

## <a name="property-expression-user-interface"></a><span data-ttu-id="13574-129">プロパティ式のユーザー インターフェイス</span><span class="sxs-lookup"><span data-stu-id="13574-129">Property Expression User Interface</span></span>
 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="13574-130">には、プロパティ式を作成および管理するためのツール セットが用意されています。</span><span class="sxs-lookup"><span data-stu-id="13574-130">provides a set of tools for building and managing property expressions.</span></span>

-   <span data-ttu-id="13574-131">タスク、For ループ コンテナー、および Foreach コンテナーのカスタム エディターにある **[式]** ページ。</span><span class="sxs-lookup"><span data-stu-id="13574-131">The **Expressions** page, found in the custom editors for tasks, the For Loop container, and the Foreach containers.</span></span> <span data-ttu-id="13574-132">**[式]** ページでは、式を編集したり、タスク、Foreach ループ、または For ループで使用されるプロパティ式のリストを表示できます。</span><span class="sxs-lookup"><span data-stu-id="13574-132">The **Expressions** page lets you edit expressions and view a list of the property expressions that a task, Foreach Loop, or For Loop uses.</span></span>

-   <span data-ttu-id="13574-133">**[プロパティ]** ウィンドウ。式を編集したり、パッケージまたはパッケージ オブジェクトで使用されるプロパティ式のリストを表示できます。</span><span class="sxs-lookup"><span data-stu-id="13574-133">The **Properties** window, for editing expressions and viewing a list of the property expressions that a package or package objects use.</span></span>

-   <span data-ttu-id="13574-134">**[プロパティ式エディター]** ダイアログ ボックス。プロパティ式を作成、更新、および削除できます。</span><span class="sxs-lookup"><span data-stu-id="13574-134">The **Property Expressions Editor** dialog box, for creating, updating, and deleting property expressions.</span></span>

-   <span data-ttu-id="13574-135">**[式ビルダー]** ダイアログ ボックス。グラフィカルなツールを使用して式を作成できます。</span><span class="sxs-lookup"><span data-stu-id="13574-135">The **Expression Builder** dialog box, for building an expression using graphical tools.</span></span> <span data-ttu-id="13574-136">**[式ビルダー]** ダイアログ ボックスでは、評価結果をプロパティに割り当てることなく、式の評価を確認できます。</span><span class="sxs-lookup"><span data-stu-id="13574-136">The **Expression Builder** dialog box can evaluate expressions for your review without assigning the evaluation result to the property.</span></span>

 <span data-ttu-id="13574-137">次の図は、プロパティ式を追加、変更、および削除するために使用するユーザー インターフェイスを示しています。</span><span class="sxs-lookup"><span data-stu-id="13574-137">The following diagram shows the user interfaces that you use to add, change, and remove property expressions.</span></span>

 <span data-ttu-id="13574-138">![プロパティ式のユーザー インターフェイス](../media/ssis-propertyexpressionui.gif "プロパティ式のユーザー インターフェイス")</span><span class="sxs-lookup"><span data-stu-id="13574-138">![The user interface for property expressions](../media/ssis-propertyexpressionui.gif "The user interface for property expressions")</span></span>

 <span data-ttu-id="13574-139">**[プロパティ]** ウィンドウおよび **[式]** ページでは、 **[式]** コレクション レベルの参照ボタン **[...]** をクリックして **[プロパティ式エディター]** ダイアログ ボックスを開きます。</span><span class="sxs-lookup"><span data-stu-id="13574-139">In the **Properties** window and the **Expressions** page, click the browse button **(...)** at the **Expressions** collection level to open the **Property Expressions Editor** dialog box.</span></span> <span data-ttu-id="13574-140">プロパティ式エディターでは、プロパティを式にマップし、プロパティ式を入力できます。</span><span class="sxs-lookup"><span data-stu-id="13574-140">The Property Expressions Editor allows you to map a property to an expression and to type a property expression.</span></span> <span data-ttu-id="13574-141">グラフィカルな式ツールを使用して式を作成してから検証する場合は、式レベルの参照ボタン **[...]** をクリックして **[式ビルダー]** ダイアログ ボックスを開き、式を作成または変更します。その後、必要に応じて式を検証します。</span><span class="sxs-lookup"><span data-stu-id="13574-141">If you want to use the graphical expression tools to create and then validate the expression, click the browse button **(...)** at the expression level to open the **Expression Builder** dialog box, and then create or modify and optionally validate the expression.</span></span>

 <span data-ttu-id="13574-142">**[式ビルダー]** ダイアログ ボックスは、 **[プロパティ式エディター]** ダイアログ ボックスから開くこともできます。</span><span class="sxs-lookup"><span data-stu-id="13574-142">You can also open the **Expression Builder** dialog box from the **Property Expressions Editor** dialog box.</span></span>

#### <a name="to-work-with-property-expressions"></a><span data-ttu-id="13574-143">プロパティ式を操作するには</span><span class="sxs-lookup"><span data-stu-id="13574-143">To work with property expressions</span></span>

-   [<span data-ttu-id="13574-144">プロパティ式を追加または変更する</span><span class="sxs-lookup"><span data-stu-id="13574-144">Add or Change a Property Expression</span></span>](add-or-change-a-property-expression.md)

### <a name="setting-property-expressions-of-data-flow-components"></a><span data-ttu-id="13574-145">データ フロー コンポーネントのプロパティ式の設定</span><span class="sxs-lookup"><span data-stu-id="13574-145">Setting Property Expressions of Data Flow Components</span></span>
 <span data-ttu-id="13574-146">[!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]でパッケージを構築すると、プロパティ式をサポートするデータ フロー コンポーネントのプロパティが、そのデータ フロー コンポーネントが属するデータ フロー タスクに表示されます。</span><span class="sxs-lookup"><span data-stu-id="13574-146">If you construct a package in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the properties of data flow components that support property expressions are exposed on the Data Flow task to which they belong.</span></span> <span data-ttu-id="13574-147">データ フロー コンポーネントのプロパティ式を追加、変更、および削除するには、データ フロー コンポーネントが属するデータ フローのデータ フロー タスクを右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="13574-147">To add, change, and remove the property expressions of data flow components, you right-click the Data Flow task for the data flow to which the data flow components belong and click **Properties**.</span></span> <span data-ttu-id="13574-148">[プロパティ] ウィンドウに、プロパティ式を使用できるデータ フロー コンポーネントのプロパティが一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="13574-148">The Properties window lists the properties of data flow components with which you can use property expressions.</span></span> <span data-ttu-id="13574-149">たとえば、SampleCustomer という名前のデータ フローで行サンプリング変換の SamplingValue プロパティのプロパティ式を作成または変更するには、行サンプリング変換が属するデータ フローのデータ フロー タスクを右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="13574-149">For example, to create or modify a property expression for the SamplingValue property of a Row Sampling transformation in a data flow named SampleCustomer, right-click the Data Flow task for the data flow to which the Row Sampling transformation belongs and click **Properties**.</span></span> <span data-ttu-id="13574-150">[プロパティ] ウィンドウに、SamplingValue プロパティが [SampleCustomer].[SamplingValue] の形式で一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="13574-150">The SamplingValue property is listed in the Properties window, and has the format [SampleCustomer].[SamplingValue].</span></span>

 <span data-ttu-id="13574-151">[プロパティ] ウィンドウで、データ フロー コンポーネントのプロパティ式を他の種類の [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] オブジェクトのプロパティ式と同じ方法で追加、変更、および削除します。</span><span class="sxs-lookup"><span data-stu-id="13574-151">In the Properties window, you add, change, and remove property expressions for data flow components in the same way as property expressions for other [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] object types.</span></span> <span data-ttu-id="13574-152">また、[プロパティ] ウィンドウから、データ フロー コンポーネントのプロパティ式を追加、変更、または削除するために使用するさまざまなダイアログ ボックスやビルダーにアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="13574-152">The Properties window also provides access to the various dialog boxes and builders that you use to add, change, or remove property expressions for data flow components.</span></span> <span data-ttu-id="13574-153">プロパティ式で更新できるデータ フロー コンポーネントのプロパティの詳細については、「 [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md)」(変換のカスタム プロパティ) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="13574-153">For more information about the properties of data flow components that can be updated by property expressions, see [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span></span>

## <a name="loading-property-expressions"></a><span data-ttu-id="13574-154">プロパティ式の読み込み</span><span class="sxs-lookup"><span data-stu-id="13574-154">Loading Property Expressions</span></span>
 <span data-ttu-id="13574-155">プロパティ式が読み込まれるタイミングは、指定したり制御することができません。</span><span class="sxs-lookup"><span data-stu-id="13574-155">You cannot specify or control when property expressions are loaded.</span></span> <span data-ttu-id="13574-156">プロパティ式は、パッケージとパッケージ オブジェクトの検証時に評価され読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="13574-156">The property expressions are evaluated and loaded when the package and the package objects are validated.</span></span> <span data-ttu-id="13574-157">パッケージを保存し、 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] デザイナーでパッケージを開いて、パッケージを実行すると、検証が行われます。</span><span class="sxs-lookup"><span data-stu-id="13574-157">Validation occurs when you save the package, open the package in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, and run the package.</span></span>

 <span data-ttu-id="13574-158">そのため、プロパティ式の追加後にパッケージを保存するか、パッケージを実行するか、パッケージを再度開かない限り、プロパティ式を使用するパッケージ オブジェクトのプロパティの更新値は [!INCLUDE[ssIS](../../../includes/ssis-md.md)] デザイナーに表示されません。</span><span class="sxs-lookup"><span data-stu-id="13574-158">You will therefore not see the updated values of the properties of the package objects that use property expressions in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer until you save the package, run the package, or reopen the package after adding the property expressions.</span></span>

 <span data-ttu-id="13574-159">各種のオブジェクト (接続マネージャー、ログ プロバイダー、列挙子) に関連付けられているプロパティ式は、その種類のオブジェクトに固有のメソッドを呼び出したときにも読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="13574-159">The property expressions associated with different types of objects-connection managers, log providers, and enumerators-are also loaded when methods specific to that object type are called.</span></span> <span data-ttu-id="13574-160">たとえば、接続マネージャーのプロパティは、 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] が接続のインスタンスを作成する前に読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="13574-160">For example, the properties of connection managers are loaded before [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] creates an instance of the connection.</span></span>

 <span data-ttu-id="13574-161">プロパティ式は、パッケージ構成が読み込まれた後に読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="13574-161">Property expressions are loaded after package configurations have loaded.</span></span> <span data-ttu-id="13574-162">たとえば変数は、対応する構成でまず更新されてから、その変数を使用するプロパティ式が評価され読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="13574-162">For example, variables are updated first by their configurations, and then the property expressions that use the variables are evaluated and loaded.</span></span> <span data-ttu-id="13574-163">つまり、プロパティ式が使用する変数の値は常に、構成によって設定された値です。</span><span class="sxs-lookup"><span data-stu-id="13574-163">This means that the property expressions always use the values of variables that are set by configurations.</span></span>

> [!NOTE]
>  <span data-ttu-id="13574-164">`Set` **Dtexec**ユーティリティのオプションを使用してプロパティ式を設定することはできません。</span><span class="sxs-lookup"><span data-stu-id="13574-164">You cannot use the `Set` option of the **dtexec** utility to populate a property expression.</span></span>

 <span data-ttu-id="13574-165">次の表に、 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] のプロパティ式が評価され読み込まれるタイミングをまとめます。</span><span class="sxs-lookup"><span data-stu-id="13574-165">The following table summarizes when property expressions of [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] are evaluated and loaded.</span></span>

|<span data-ttu-id="13574-166">オブジェクトの種類</span><span class="sxs-lookup"><span data-stu-id="13574-166">Object type</span></span>|<span data-ttu-id="13574-167">読み込みと評価</span><span class="sxs-lookup"><span data-stu-id="13574-167">Load and evaluate</span></span>|
|-----------------|-----------------------|
|<span data-ttu-id="13574-168">パッケージ、Foreach ループ、For ループ、シーケンス、タスク、データ フロー コンポーネント</span><span class="sxs-lookup"><span data-stu-id="13574-168">Package, Foreach loop, For Loop, Sequence, tasks, and data flow components</span></span>|<span data-ttu-id="13574-169">構成の読み込み後</span><span class="sxs-lookup"><span data-stu-id="13574-169">After loading configurations</span></span><br /><br /> <span data-ttu-id="13574-170">検証前</span><span class="sxs-lookup"><span data-stu-id="13574-170">Before validation</span></span><br /><br /> <span data-ttu-id="13574-171">実行前</span><span class="sxs-lookup"><span data-stu-id="13574-171">Before execution</span></span>|
|<span data-ttu-id="13574-172">接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="13574-172">Connection managers</span></span>|<span data-ttu-id="13574-173">構成の読み込み後</span><span class="sxs-lookup"><span data-stu-id="13574-173">After loading configurations</span></span><br /><br /> <span data-ttu-id="13574-174">検証前</span><span class="sxs-lookup"><span data-stu-id="13574-174">Before validation</span></span><br /><br /> <span data-ttu-id="13574-175">実行前</span><span class="sxs-lookup"><span data-stu-id="13574-175">Before execution</span></span><br /><br /> <span data-ttu-id="13574-176">接続インスタンスの作成前</span><span class="sxs-lookup"><span data-stu-id="13574-176">Before creating a connection instance</span></span>|
|<span data-ttu-id="13574-177">ログ プロバイダー</span><span class="sxs-lookup"><span data-stu-id="13574-177">Log providers</span></span>|<span data-ttu-id="13574-178">構成の読み込み後</span><span class="sxs-lookup"><span data-stu-id="13574-178">After loading configurations</span></span><br /><br /> <span data-ttu-id="13574-179">検証前</span><span class="sxs-lookup"><span data-stu-id="13574-179">Before validation</span></span><br /><br /> <span data-ttu-id="13574-180">実行前</span><span class="sxs-lookup"><span data-stu-id="13574-180">Before execution</span></span><br /><br /> <span data-ttu-id="13574-181">ログを開く前</span><span class="sxs-lookup"><span data-stu-id="13574-181">Before opening logs</span></span>|
|<span data-ttu-id="13574-182">Foreach 列挙子</span><span class="sxs-lookup"><span data-stu-id="13574-182">Foreach enumerators</span></span>|<span data-ttu-id="13574-183">構成の読み込み後</span><span class="sxs-lookup"><span data-stu-id="13574-183">After loading configurations</span></span><br /><br /> <span data-ttu-id="13574-184">検証前</span><span class="sxs-lookup"><span data-stu-id="13574-184">Before validation</span></span><br /><br /> <span data-ttu-id="13574-185">実行前</span><span class="sxs-lookup"><span data-stu-id="13574-185">Before execution</span></span><br /><br /> <span data-ttu-id="13574-186">ループの各列挙前</span><span class="sxs-lookup"><span data-stu-id="13574-186">Before each enumeration of the loop</span></span>|

## <a name="using-property-expressions-in-the-foreach-loop"></a><span data-ttu-id="13574-187">Foreach ループでのプロパティ式の使用</span><span class="sxs-lookup"><span data-stu-id="13574-187">Using Property Expressions in the Foreach Loop</span></span>
 <span data-ttu-id="13574-188">多くの場合、Foreach ループ コンテナー内部で使用される接続マネージャーの `ConnectionString` プロパティ値を設定するには、プロパティ式の実装が役立ちます。</span><span class="sxs-lookup"><span data-stu-id="13574-188">It is frequently useful to implement a property expression to set the value of the `ConnectionString` property of connection managers that are used inside the Foreach Loop container.</span></span> <span data-ttu-id="13574-189">ループの各反復処理で列挙子の現在値が変数にマップされた後、プロパティ式でこの変数の値を使用して `ConnectionString` プロパティの値を動的に更新できます。</span><span class="sxs-lookup"><span data-stu-id="13574-189">After the enumerator maps its current value to a variable on each iteration of the loop, the property expression can use the value of this variable to update the value of the `ConnectionString` property dynamically .</span></span>

 <span data-ttu-id="13574-190">Foreach ループで使用されるファイル、複数のファイル、フラット ファイル、および複数フラット ファイル接続マネージャーの `ConnectionString` プロパティでプロパティ式を使用する場合は、いくつかの点について考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="13574-190">If you want to use property expressions with the `ConnectionString` property of File, Multiple Files, Flat Files, and Multiple Flat Files connection managers that a Foreach Loop uses, there are some things that you should consider.</span></span> <span data-ttu-id="13574-191">`MaxConcurrentExecutables` プロパティを 1 より大きな値または -1 に設定することにより、複数の実行可能ファイルが同時に実行されるようにパッケージを構成できます。</span><span class="sxs-lookup"><span data-stu-id="13574-191">A package can be configured to run multiple executables concurrently by setting the `MaxConcurrentExecutables` property either to a value greater than 1 or to the value -1.</span></span> <span data-ttu-id="13574-192">値が -1 の場合は、同時に実行できる実行可能ファイルの最大数が、プロセッサの総数に 2 を加えた数と等しいことを意味します。</span><span class="sxs-lookup"><span data-stu-id="13574-192">A value of -1 allows the maximum number of concurrently running executables to equal the number of processors plus two.</span></span> <span data-ttu-id="13574-193">実行可能ファイルを並列実行することに起因する不適切な結果を回避するには、値 `MaxConcurrentExecutables` を 1 に設定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="13574-193">To avoid negative consequences from the parallel execution of executables, the value `MaxConcurrentExecutables` should be set to 1.</span></span> <span data-ttu-id="13574-194">`MaxConcurrentExecutables` を 1 に設定しないと、`ConnectionString` プロパティの値を保証できず、結果を予測できません。</span><span class="sxs-lookup"><span data-stu-id="13574-194">If `MaxConcurrentExecutables` is not set to 1, then the value of the `ConnectionString` property cannot be guaranteed and results are unpredictable.</span></span>

 <span data-ttu-id="13574-195">たとえば、フォルダー内のファイルを列挙し、ファイル名を取得し、SQL 実行タスクを使用してテーブルに各ファイル名を挿入する Foreach ループを考えます。</span><span class="sxs-lookup"><span data-stu-id="13574-195">For example, consider a Foreach Loop that enumerates files in a folder, retrieves the file names, and then uses an Execute SQL task to insert each file name into a table.</span></span> <span data-ttu-id="13574-196">`MaxConcurrentExecutables` を 1 に設定しないと、SQL 実行タスクの 2 つのインスタンスが同時にテーブルへの書き込みを行う場合、書き込みが競合する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="13574-196">If `MaxConcurrentExecutables` is not set to 1, then write conflicts could occur if two instances of the Execute SQL task attempted to write to the table at the same time.</span></span>

## <a name="sample-property-expressions"></a><span data-ttu-id="13574-197">サンプルのプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-197">Sample Property Expressions</span></span>
 <span data-ttu-id="13574-198">プロパティ式でのシステム変数、演算子、関数、および文字列リテラルの使い方を次のサンプル式に示します。</span><span class="sxs-lookup"><span data-stu-id="13574-198">The following sample expressions show how to use system variables, operators, functions, and string literals in property expressions.</span></span>

### <a name="property-expression-for-the-loggingmode-property-of-a-package"></a><span data-ttu-id="13574-199">パッケージの LoggingMode プロパティ用のプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-199">Property Expression for the LoggingMode Property of a Package</span></span>
 <span data-ttu-id="13574-200">次のプロパティ式を使用すると、パッケージの LoggingMode プロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="13574-200">The following property expression can be used to set the LoggingMode property of a package.</span></span> <span data-ttu-id="13574-201">この式では、DAY 関数と GETDATE 関数を使用して、ある日付の日要素を表す整数を取得します。</span><span class="sxs-lookup"><span data-stu-id="13574-201">The expression uses the DAY and GETDATE functions to get an integer that represents the day datepart of a date.</span></span> <span data-ttu-id="13574-202">日要素が 1 日または 15 日の場合、ログ記録が有効です。それ以外の場合は、ログ記録が無効です。</span><span class="sxs-lookup"><span data-stu-id="13574-202">If the day is the 1st or 15th, logging is enabled; otherwise, logging is disabled.</span></span> <span data-ttu-id="13574-203">値1は、"ログインモード" 列挙子のメンバーに相当する整数で、 `Enabled` 値2はメンバーに相当する整数です `Disabled` 。</span><span class="sxs-lookup"><span data-stu-id="13574-203">The value 1 is the integer equivalent of the LoggingMode enumerator member `Enabled`, and the value 2 is the integer equivalent of the member `Disabled`.</span></span> <span data-ttu-id="13574-204">式では、列挙子のメンバー名ではなく、数値を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="13574-204">You must use the numeric value instead of the enumerator member name in the expression.</span></span>

 `DAY((DT_DBTIMESTAMP)GETDATE())==1||DAY((DT_DBTIMESTAMP)GETDATE())==15?1:2`

### <a name="property-expression-for-the-subject-of-an-e-mail-message"></a><span data-ttu-id="13574-205">電子メール メッセージの件名用のプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-205">Property Expression for the Subject of an E-mail Message</span></span>
 <span data-ttu-id="13574-206">次のプロパティ式を使用すると、メール送信タスクの Subject プロパティを設定して、適切な電子メールの件名を入力できます。</span><span class="sxs-lookup"><span data-stu-id="13574-206">The following property expression can be used to set the Subject property of a Send Mail task and provide a useful e-mail subject.</span></span> <span data-ttu-id="13574-207">この式では、文字列リテラル、システム変数、連結演算子 (+)、キャスト演算子、DATEDIFF 関数、および GETDATE 関数の組み合わせを使用しています。</span><span class="sxs-lookup"><span data-stu-id="13574-207">The expression uses a combination of string literals, system variables, the concatenation (+) and cast operators, and the DATEDIFF and GETDATE functions.</span></span> <span data-ttu-id="13574-208">システム変数は `PackageName` 変数と `StartTime` 変数です。</span><span class="sxs-lookup"><span data-stu-id="13574-208">The system variables are the `PackageName` and `StartTime` variables.</span></span>

 `"PExpression-->Package: (" + @[System::PackageName] + ") Started:"+  (DT_WSTR, 30) @[System::StartTime] + " Duration:"  +  (DT_WSTR,10) (DATEDIFF( "ss", @[System::StartTime] , GETDATE()  )) + " seconds"`

 <span data-ttu-id="13574-209">パッケージの名前が EmailRowCountPP であり、3/4/2005 に実行され、実行された期間が 9 秒間であった場合、この式は次の文字列に評価されます。</span><span class="sxs-lookup"><span data-stu-id="13574-209">If the package name is EmailRowCountPP, was run on 3/4/2005, and the duration of the run was 9 seconds, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="13574-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span><span class="sxs-lookup"><span data-stu-id="13574-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span></span>

### <a name="property-expression-for-the-message-of-an-e-mail-message"></a><span data-ttu-id="13574-211">電子メール メッセージのメッセージ用のプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-211">Property Expression for the Message of an E-mail Message</span></span>
 <span data-ttu-id="13574-212">次のプロパティ式を使用すると、メール送信タスクの MessageSource プロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="13574-212">The following property expression can be used to set the MessageSource property of a Send Mail task.</span></span> <span data-ttu-id="13574-213">この式では、文字列リテラル、ユーザー定義変数、および連結演算子 (+) の組み合わせを使用しています。</span><span class="sxs-lookup"><span data-stu-id="13574-213">The expression uses a combination of string literals, user-defined variables, and the concatenation (+) operator.</span></span> <span data-ttu-id="13574-214">ユーザー定義変数の名前は、 `nasdaqrawrows`、 `nyserawrows`、および `amexrawrows`です。</span><span class="sxs-lookup"><span data-stu-id="13574-214">The user-defined variables are named `nasdaqrawrows`, `nyserawrows`, and `amexrawrows`.</span></span> <span data-ttu-id="13574-215">文字列 "\n" は、復帰を示します。</span><span class="sxs-lookup"><span data-stu-id="13574-215">The string "\n" indicates a carriage return.</span></span>

 `"Rows Processed: "  +   "\n" +"   NASDAQ: "  +   (dt_wstr,9)@[nasdaqrawrows]   + "\n" + "   NYSE: "  +  (dt_wstr,9)@[nyserawrows]  + "\n" + "   Amex: "  +  (dt_wstr,9)@[amexrawrows]`

 <span data-ttu-id="13574-216">`nasdaqrawrows` が 7058、 `nyserawrows` が 3528、 `amexrawrows` が 1102 である場合、式は次の文字列に評価されます。</span><span class="sxs-lookup"><span data-stu-id="13574-216">If `nasdaqrawrows` is 7058, `nyserawrows` is 3528, and `amexrawrows` is 1102, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="13574-217">Rows Processed:</span><span class="sxs-lookup"><span data-stu-id="13574-217">Rows Processed:</span></span>

 <span data-ttu-id="13574-218">NASDAQ: 7058</span><span class="sxs-lookup"><span data-stu-id="13574-218">NASDAQ: 7058</span></span>

 <span data-ttu-id="13574-219">NYSE: 3528</span><span class="sxs-lookup"><span data-stu-id="13574-219">NYSE: 3528</span></span>

 <span data-ttu-id="13574-220">AMEX: 1102</span><span class="sxs-lookup"><span data-stu-id="13574-220">AMEX: 1102</span></span>

### <a name="property-expression-for-the-executable-property-of-an-execute-process-task"></a><span data-ttu-id="13574-221">プロセス実行タスクの Executable プロパティ用のプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-221">Property Expression for the Executable Property of an Execute Process Task</span></span>
 <span data-ttu-id="13574-222">次のプロパティ式を使用すると、プロセス実行タスクの Executable プロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="13574-222">The following property expression can be used to set the Executable property of an Execute Process task.</span></span> <span data-ttu-id="13574-223">この式では、文字列リテラル、演算子、および関数の組み合わせを使用しています。</span><span class="sxs-lookup"><span data-stu-id="13574-223">The expression uses a combination of string literals, operators, and functions.</span></span> <span data-ttu-id="13574-224">この式では、DATEPART 関数、GETDATE 関数、および条件演算子を使用しています。</span><span class="sxs-lookup"><span data-stu-id="13574-224">The expression uses the DATEPART and GETDATE functions and the conditional operator.</span></span>

 `DATEPART("weekday", GETDATE()) ==2?"notepad.exe":"mspaint.exe"`

 <span data-ttu-id="13574-225">プロセス実行タスクは週の 2 日目に notepad.exe を実行し、それ以外の日には mspaint.exe を実行します。</span><span class="sxs-lookup"><span data-stu-id="13574-225">If it is the second day in the week, the Execute Process task runs notepad.exe, otherwise the task runs mspaint.exe.</span></span>

### <a name="property-expression-for-the-connectionstring-property-of-a-flat-file-connection-manager"></a><span data-ttu-id="13574-226">フラット ファイル接続マネージャーの ConnectionString プロパティ用のプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-226">Property Expression for the ConnectionString Property of a Flat File Connection Manager</span></span>
 <span data-ttu-id="13574-227">次のプロパティ式を使用すると、フラット ファイル接続マネージャーの ConnectionString プロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="13574-227">The following property expression can be used to set the ConnectionString property of a Flat File connection manager.</span></span> <span data-ttu-id="13574-228">この式では、テキスト ファイルへのパスを格納するユーザー定義変数 `myfilenamefull`を 1 つだけ使用しています。</span><span class="sxs-lookup"><span data-stu-id="13574-228">The expression uses a single user-defined variable, `myfilenamefull`, which contains the path to a text file.</span></span>

 `@[User::myfilenamefull]`

> [!NOTE]
>  <span data-ttu-id="13574-229">接続マネージャー用のプロパティ式には、[プロパティ] ウィンドウからのみアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="13574-229">Property expressions for connection managers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="13574-230">接続マネージャーのプロパティを表示するには、[プロパティ] ウィンドウが開いているときに **デザイナーの** [接続マネージャー] [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 領域で接続マネージャーを選択するか、接続マネージャーを右クリックして **[プロパティ]** を選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="13574-230">To view the properties for a connection manager, you must select the connection manager in the **Connection Managers** area of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the connection manager and select **Properties**.</span></span>

### <a name="property-expression-for-the-configstring-property-of-a-text-file-log-provider"></a><span data-ttu-id="13574-231">テキスト ファイル ログ プロバイダーの ConfigString プロパティ用のプロパティ式</span><span class="sxs-lookup"><span data-stu-id="13574-231">Property Expression for the ConfigString Property of a Text File Log Provider</span></span>
 <span data-ttu-id="13574-232">次のプロパティ式を使用すると、テキスト ファイル ログ プロバイダーの ConfigString プロパティを設定できます。</span><span class="sxs-lookup"><span data-stu-id="13574-232">The following property expression can be used to set the ConfigString property of a Text File log provider.</span></span> <span data-ttu-id="13574-233">この式では、使用するファイル接続マネージャーの名前を格納するユーザー定義変数 `varConfigString`を 1 つだけ使用しています。</span><span class="sxs-lookup"><span data-stu-id="13574-233">The expression uses a single user-defined variable, `varConfigString`, which contains the name of the File connection manager to use.</span></span> <span data-ttu-id="13574-234">ファイル接続マネージャーにより、ログ エントリの書き込み先のテキスト ファイルのパスが指定されます。</span><span class="sxs-lookup"><span data-stu-id="13574-234">The File connection manager specifies the path of the text file to which log entries are written.</span></span>

 `@[User::varConfigString]`

> [!NOTE]
>  <span data-ttu-id="13574-235">ログ プロバイダー用のプロパティ式には、[プロパティ] ウィンドウからのみアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="13574-235">Property expressions for log providers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="13574-236">ログ プロバイダーのプロパティを表示するには、[プロパティ] ウィンドウが開いているときに **デザイナーの** [パッケージ エクスプローラー] [!INCLUDE[ssIS](../../../includes/ssis-md.md)] タブでログ プロバイダーを選択するか、パッケージ エクスプローラーでログ プロバイダーを右クリックし、 **[プロパティ]** をクリックする必要があります。</span><span class="sxs-lookup"><span data-stu-id="13574-236">To view the properties of a log provider, you must select the log provider on the **Package Explorer** tab of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the log provider in Package Explorer and click **Properties**.</span></span>

## <a name="external-resources"></a><span data-ttu-id="13574-237">外部リソース</span><span class="sxs-lookup"><span data-stu-id="13574-237">External Resources</span></span>

-   [<span data-ttu-id="13574-238">式/構成マーカー (CodePlex プロジェクト)</span><span class="sxs-lookup"><span data-stu-id="13574-238">Expression and Configuration Highlighter (CodePlex Project)</span></span>](https://go.microsoft.com/fwlink/?LinkId=146625)

-   <span data-ttu-id="13574-239">social.technet.microsoft.com の技術記事「 [SSIS 式の例](https://go.microsoft.com/fwlink/?LinkId=220761)」</span><span class="sxs-lookup"><span data-stu-id="13574-239">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>

## <a name="see-also"></a><span data-ttu-id="13574-240">参照</span><span class="sxs-lookup"><span data-stu-id="13574-240">See Also</span></span>
 [<span data-ttu-id="13574-241">パッケージで変数を使用する</span><span class="sxs-lookup"><span data-stu-id="13574-241">Use Variables in Packages</span></span>](../use-variables-in-packages.md)


