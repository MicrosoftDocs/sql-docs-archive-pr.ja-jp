---
title: スクリプト コンポーネントでの変数の使用 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Script component [Integration Services], using variables
ms.assetid: 92d1881a-1ef1-43ae-b1ca-48d0536bdbc2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4328a938c56ad8383c12cdae1d6511604ec65582
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87720259"
---
# <a name="using-variables-in-the-script-component"></a><span data-ttu-id="99db2-102">スクリプト コンポーネントでの変数の使用</span><span class="sxs-lookup"><span data-stu-id="99db2-102">Using Variables in the Script Component</span></span>
  <span data-ttu-id="99db2-103">変数には、パッケージとそのコンテナー、タスク、およびイベント ハンドラーが実行時に使用できる値が格納されます。</span><span class="sxs-lookup"><span data-stu-id="99db2-103">Variables store values that a package and its containers, tasks, and event handlers can use at run time.</span></span> <span data-ttu-id="99db2-104">詳細については、「 [Integration Services &#40;SSIS&#41; の変数](../../integration-services-ssis-variables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="99db2-104">For more information, see [Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md).</span></span>  
  
 <span data-ttu-id="99db2-105">カスタムスクリプトでは、既存の変数を読み取り専用または読み取り/書き込みアクセスで使用できるようにすることができます。そのためには、 `ReadOnlyVariables` [ `ReadWriteVariables` **スクリプト変換エディター**] の [**スクリプト**] ページにあるフィールドとフィールドに変数の一覧をコンマで区切って入力します。</span><span class="sxs-lookup"><span data-stu-id="99db2-105">You can make existing variables available for read-only or read/write access by your custom script by entering comma-delimited lists of variables in the `ReadOnlyVariables` and `ReadWriteVariables` fields on the **Script** page of the **Script Transformation Editor**.</span></span> <span data-ttu-id="99db2-106">変数名の大文字と小文字は区別されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="99db2-106">Keep in mind that variable names are case-sensitive.</span></span> <span data-ttu-id="99db2-107">`Value` プロパティを使用して、各変数に対する読み取りおよび書き込みを行います。</span><span class="sxs-lookup"><span data-stu-id="99db2-107">Use the `Value` property to read from and write to individual variables.</span></span> <span data-ttu-id="99db2-108">スクリプトが実行時に変数を処理すると、スクリプト コンポーネントは状況に応じて自動的に必要なロックを処理します。</span><span class="sxs-lookup"><span data-stu-id="99db2-108">The Script component handles any required locking behind the scenes as your script manipulates the variables at run time.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="99db2-109">`ReadWriteVariables` のコレクションは、`PostExecute` メソッド内でのみ、パフォーマンスを最大化し、ロックによる競合のリスクを最小限に抑えるために使用できます。</span><span class="sxs-lookup"><span data-stu-id="99db2-109">The collection of `ReadWriteVariables` is only available in the `PostExecute` method to maximize performance and minimize the risk of locking conflicts.</span></span> <span data-ttu-id="99db2-110">したがって、データ行を処理するたびにパッケージ変数の値を直接増やすことはできません。</span><span class="sxs-lookup"><span data-stu-id="99db2-110">Therefore you cannot directly increment the value of a package variable as you process each row of data.</span></span> <span data-ttu-id="99db2-111">このような場合、ローカル変数の値を増やし、すべてのデータが処理された後で、`PostExecute` メソッド内でパッケージ変数の値をローカル変数の値に設定します。</span><span class="sxs-lookup"><span data-stu-id="99db2-111">Increment the value of a local variable instead, and set the value of the package variable to the value of the local variable in the `PostExecute` method after all data has been processed.</span></span> <span data-ttu-id="99db2-112">また、<xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> プロパティを使用してこの制限を回避できます。この方法については、このトピックの後半で説明します。</span><span class="sxs-lookup"><span data-stu-id="99db2-112">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property to work around this limitation, as described later in this topic.</span></span> <span data-ttu-id="99db2-113">ただし、各行が処理されているときにパッケージ変数に直接書き込みを行うと、パフォーマンスに悪影響を与え、ロックによる競合のリスクが増えます。</span><span class="sxs-lookup"><span data-stu-id="99db2-113">However, writing directly to a package variable as each row is processed will negatively impact performance and increase the risk of locking conflicts.</span></span>  
  
 <span data-ttu-id="99db2-114">**[スクリプト変換エディター]** の **[スクリプト]** ページの詳細については、「[スクリプト コンポーネント エディターでのスクリプト コンポーネントの構成](configuring-the-script-component-in-the-script-component-editor.md)」および「[スクリプト変換エディター &#40;[スクリプト] ページ&#41;](../../script-transformation-editor-script-page.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="99db2-114">For more information about the **Script** page of the **Script Transformation Editor**, see [Configuring the Script Component in the Script Component Editor](configuring-the-script-component-in-the-script-component-editor.md) and [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="99db2-115">スクリプト コンポーネントは、`Variables` プロジェクト アイテム内に、`ComponentWrapper` コレクション クラスを作成します。ここには、構成済みの各変数の値に対して、変数自体と同じ名前を持つ、厳密に型指定されたアクセサー プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="99db2-115">The Script component creates a `Variables` collection class in the `ComponentWrapper` project item with a strongly-typed accessor property for the value of each preconfigured variable where the property has the same name as the variable itself.</span></span> <span data-ttu-id="99db2-116">このコレクションは、`Variables` クラスの `ScriptMain` プロパティを介して公開されます。</span><span class="sxs-lookup"><span data-stu-id="99db2-116">This collection is exposed through the `Variables` property of the `ScriptMain` class.</span></span> <span data-ttu-id="99db2-117">アクセサー プロパティにより、変数の値が読み取り専用か読み取り/書き込み用かが決まります。</span><span class="sxs-lookup"><span data-stu-id="99db2-117">The accessor property provides read-only or read/write permission to the value of the variable as appropriate.</span></span> <span data-ttu-id="99db2-118">たとえば、`MyIntegerVariable` という整数型の変数を `ReadOnlyVariables` 一覧に追加した場合、次のコードを使用して、この値をスクリプト内で取得できます。</span><span class="sxs-lookup"><span data-stu-id="99db2-118">For example, if you have added an integer variable named `MyIntegerVariable` to the `ReadOnlyVariables` list, you can retrieve its value in your script by using the following code:</span></span>  
  
 `Dim myIntegerVariableValue As Integer = Me.Variables.MyIntegerVariable`  
  
 <span data-ttu-id="99db2-119">スクリプト コンポーネントで変数を扱うには、`Me.VariableDispenser` を呼び出してアクセスする <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> プロパティを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="99db2-119">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property, accessed by calling `Me.VariableDispenser`, to work with variables in the Script component.</span></span> <span data-ttu-id="99db2-120">この場合には、変数の型指定された名前付きのアクセサー プロパティを使用せずに、直接的に変数にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="99db2-120">In this case you are not using the typed and named accessor properties for variables, but accessing the variables directly.</span></span> <span data-ttu-id="99db2-121"><xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> を使用する場合は、コード内で、ロック セマンティクスと、変数値のデータ型のキャストの両方を処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="99db2-121">When using the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>, you must handle both the locking semantics and the casting of data types for variable values in your own code.</span></span> <span data-ttu-id="99db2-122">デザイン時には使用できないが、実行時にプログラムによって生成される変数を扱う必要がある場合は、名前付きの型指定されたアクセサー プロパティではなく、<xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> プロパティを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="99db2-122">You have to use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property instead of the named and typed accessor properties if you want to work with a variable that is not available at design time but is created programmatically at run time.</span></span>  
  
<span data-ttu-id="99db2-123">![Integration Services アイコン (小)](../../media/dts-16.gif "Integration Services のアイコン (小)")**は Integration Services で最新の**状態を維持  </span><span class="sxs-lookup"><span data-stu-id="99db2-123">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="99db2-124">マイクロソフトが提供する最新のダウンロード、アーティクル、サンプル、ビデオ、およびコミュニティで選択されたソリューションについては、MSDN の [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] のページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="99db2-124">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="99db2-125">MSDN の Integration Services のページを参照する</span><span class="sxs-lookup"><span data-stu-id="99db2-125">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="99db2-126">これらの更新が自動で通知されるようにするには、ページの RSS フィードを定期受信します。</span><span class="sxs-lookup"><span data-stu-id="99db2-126">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="99db2-127">参照</span><span class="sxs-lookup"><span data-stu-id="99db2-127">See Also</span></span>  
 <span data-ttu-id="99db2-128">[Integration Services &#40;SSIS&#41; の変数](../../integration-services-ssis-variables.md) </span><span class="sxs-lookup"><span data-stu-id="99db2-128">[Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md) </span></span>  
 [<span data-ttu-id="99db2-129">パッケージで変数を使用する</span><span class="sxs-lookup"><span data-stu-id="99db2-129">Use Variables in Packages</span></span>](../../use-variables-in-packages.md)  
  
  
