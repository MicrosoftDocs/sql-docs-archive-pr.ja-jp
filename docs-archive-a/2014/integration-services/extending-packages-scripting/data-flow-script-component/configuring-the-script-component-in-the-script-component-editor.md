---
title: スクリプト コンポーネント エディターでのスクリプト コンポーネントの構成 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4a9925d29c7a960c46e217f1e96c0bcae4f217b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87642179"
---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a><span data-ttu-id="f5314-102">スクリプト コンポーネント エディターでのスクリプト コンポーネントの構成</span><span class="sxs-lookup"><span data-stu-id="f5314-102">Configuring the Script Component in the Script Component Editor</span></span>
  <span data-ttu-id="f5314-103">スクリプト コンポーネント内でカスタム コードを記述する前に、作成するデータ フロー コンポーネントの種類 (変換元、変換、または変換先) を選択し、 **[スクリプト変換エディター]** でスクリプト コンポーネントのメタデータおよびプロパティを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-103">Before you write custom code in the Script component, you must select the type of data flow component that you want to create-source, transformation, or destination-and then configure the component's metadata and properties in the **Script Transformation Editor**.</span></span>

## <a name="selecting-the-type-of-component-to-create"></a><span data-ttu-id="f5314-104">作成するコンポーネントの種類の選択</span><span class="sxs-lookup"><span data-stu-id="f5314-104">Selecting the Type of Component to Create</span></span>
 <span data-ttu-id="f5314-105">[!INCLUDE[ssIS](../../../includes/ssis-md.md)] デザイナーの [データ フロー] ペインにスクリプト コンポーネントを追加すると、 **[スクリプト コンポーネントの種類を選択]** ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-105">When you add a Script component to the Data Flow pane of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears.</span></span> <span data-ttu-id="f5314-106">コンポーネントをあらかじめ、変換元、変換、または変換先として構成しておきます。</span><span class="sxs-lookup"><span data-stu-id="f5314-106">You preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="f5314-107">最初にこれを選択したら、引き続き **[スクリプト変換エディター]** でスクリプト コンポーネントを構成できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-107">After you make this initial selection, you can continue to configure the component in the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="f5314-108">スクリプト コンポーネントの既定のスクリプト言語を設定するには、**[オプション]** ダイアログ ボックスの **[全般]** ページにある **[スクリプト言語]** オプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="f5314-108">To set the default script language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="f5314-109">詳細については、「 [General Page](../../general-page-of-integration-services-designers-options.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5314-109">For more information, see [General Page](../../general-page-of-integration-services-designers-options.md).</span></span>

## <a name="understanding-the-two-design-time-modes"></a><span data-ttu-id="f5314-110">デザイン時の 2 つのモードについて</span><span class="sxs-lookup"><span data-stu-id="f5314-110">Understanding the Two Design-Time Modes</span></span>
 <span data-ttu-id="f5314-111">[!INCLUDE[ssIS](../../../includes/ssis-md.md)] デザイナーでは、スクリプト コンポーネントにメタデータ デザイン モードとコード デザイン モードの 2 つのモードがあります。</span><span class="sxs-lookup"><span data-stu-id="f5314-111">In [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata design mode and code design mode.</span></span>

 <span data-ttu-id="f5314-112">**[スクリプト変換エディター]** を開くと、スクリプト コンポーネントはメタデータ デザイン モードになります。</span><span class="sxs-lookup"><span data-stu-id="f5314-112">When you open the **Script Transformation Editor**, the component enters metadata design mode.</span></span> <span data-ttu-id="f5314-113">このモードでは、入力列の選択、および出力と出力列の追加または構成を行うことができますが、コードは記述できません。</span><span class="sxs-lookup"><span data-stu-id="f5314-113">In this mode, you can select input columns, and add or configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="f5314-114">このコンポーネントのメタデータを構成した後で、コード デザイン モードに切り替えてスクリプトを記述できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-114">After you have configured the component's metadata, you can switch to code design mode to write the script.</span></span>

 <span data-ttu-id="f5314-115">**[スクリプトの編集]** をクリックしてコード デザイン モードに切り替えると、スクリプト コンポーネントではメタデータがロックされ、追加の変更ができなくなり、入力と出力のメタデータから基本コードが自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-115">When you switch to code design mode by clicking **Edit Script**, the Script component locks metadata to prevent additional changes, and then automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="f5314-116">コードの自動生成が完了すると、カスタム コードを入力できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f5314-116">After the autogenerated code is complete, you will be able to enter your custom code.</span></span> <span data-ttu-id="f5314-117">作成したコードは自動生成された基本クラスを使用し、すべて厳密に型指定されたオブジェクトとして、入力行の処理、バッファーおよびバッファー内の列へのアクセス、およびパッケージからの接続マネージャーと変数の取得を行います。</span><span class="sxs-lookup"><span data-stu-id="f5314-117">Your code uses the auto-generated base classes to process input rows, to access buffers and columns in the buffers, and to retrieve connection managers and variables from the package, all as strongly-typed objects.</span></span>

 <span data-ttu-id="f5314-118">コード デザイン モードでカスタム コードを入力したら、モードを切り替えてメタデータ デザイン モードに戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="f5314-118">After entering your custom code in code design mode, you can switch back to metadata design mode.</span></span> <span data-ttu-id="f5314-119">これによって入力したコードが削除されることはありませんが、次にメタデータを変更すると、基本クラスが再生成されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-119">This does not delete any code that you have entered; however, subsequent changes to the metadata cause the base class to be regenerated.</span></span> <span data-ttu-id="f5314-120">その後、カスタム コードが参照するオブジェクトが存在しないか、または変更されたために、コンポーネントの検証に失敗する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-120">Afterward, your component may fail validation because objects referenced by your custom code may no longer exist or may have been modified.</span></span> <span data-ttu-id="f5314-121">その場合、再生成された基本クラスに対してコードが正常にコンパイルされるように、コードを手動で修正する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-121">In this case, you must fix your code manually so that it can be compiled successfully against the regenerated base class.</span></span>

## <a name="configuring-the-component-in-metadata-design-mode"></a><span data-ttu-id="f5314-122">メタデータ デザイン モードでのコンポーネントの構成</span><span class="sxs-lookup"><span data-stu-id="f5314-122">Configuring the Component in Metadata Design Mode</span></span>
 <span data-ttu-id="f5314-123">メタデータ デザイン モードでは、入力列の選択、および出力と出力列の追加や構成を行うことができますが、コードは記述できません。</span><span class="sxs-lookup"><span data-stu-id="f5314-123">In metadata design mode, you can select input columns, and add and configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="f5314-124">コンポーネントのメタデータを構成した後で、コード デザイン モードに切り替えてスクリプトを記述します。</span><span class="sxs-lookup"><span data-stu-id="f5314-124">After you have configured the component's metadata, switch to code design mode to write the script.</span></span>

 <span data-ttu-id="f5314-125">カスタム エディターで構成する必要のあるプロパティは、スクリプト コンポーネントの使用法に応じて異なります。</span><span class="sxs-lookup"><span data-stu-id="f5314-125">The properties that you must configure in the custom editor depend on the usage of the Script component.</span></span> <span data-ttu-id="f5314-126">スクリプト コンポーネントは、変換元、変換、または変換先として構成できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-126">The Script component can be configured as a source, a transformation, or a destination.</span></span> <span data-ttu-id="f5314-127">コンポーネントの使用方法に応じて、入力または出力のどちらか、またはその両方がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="f5314-127">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="f5314-128">記述するカスタム コードでは、入力および出力の行と列が処理されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-128">The custom code that you will write processes the input and output rows and columns.</span></span>

### <a name="inputs-columns-page-of-the-script-transformation-editor"></a><span data-ttu-id="f5314-129">[スクリプト変換エディター] の [入力列] ページ</span><span class="sxs-lookup"><span data-stu-id="f5314-129">Inputs Columns Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="f5314-130">変換および変換先では、**[スクリプト変換エディター]** の **[入力列]** ページが表示されます。変換元では表示されません。</span><span class="sxs-lookup"><span data-stu-id="f5314-130">The **Input Columns** page of the **Script Transformation Editor** is displayed for transformations and destinations, but not for sources.</span></span> <span data-ttu-id="f5314-131">このページでは、使用できる入力列から、使用するカスタム スクリプトを選択し、その入力列に読み取り専用でアクセスするか、または読み取り/書き込みでアクセスするかを指定します。</span><span class="sxs-lookup"><span data-stu-id="f5314-131">On this page, you select the available input columns that you want to make available to your custom script, and specify read-only or read/write access to them.</span></span>

 <span data-ttu-id="f5314-132">このメタデータに基づいて生成されるコード プロジェクトでは、BufferWrapper プロジェクト アイテムに、各入力のクラスが含まれます。このクラスには、選択した各入力列用の型指定されたアクセサー プロパティが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5314-132">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input, and this class contains typed accessor properties for each input column selected.</span></span> <span data-ttu-id="f5314-133">たとえば、という名前の入力から整数の CustomerID**列と文字列の** **customerid**列を選択した場合、 `CustomerInput` bufferwrapper プロジェクトアイテムには、 `CustomerInput` から派生したクラスが含まれ <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> ます。このクラスでは、 `CustomerInput` CustomerID という**CustomerName**整数プロパティと、 **CustomerID**という名前の文字列プロパティが公開されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-133">For example, if you select an integer **CustomerID** column and a string **CustomerName** column from an input named `CustomerInput`, the BufferWrapper project item will contain a `CustomerInput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerInput` class will expose an integer property named **CustomerID** and a string property named **CustomerName**.</span></span> <span data-ttu-id="f5314-134">この規則により、次のような型チェック付きのコードが記述できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-134">This convention makes it possible to write code with type-checking like the following:</span></span>

```vb
Dim currentCustomerID as Integer = CustomerInput.CustomerID
Dim currentCustomerName as String = CustomerInput.CustomerName
```

 <span data-ttu-id="f5314-135">特定の種類のデータ フロー コンポーネントの入力列を構成する方法の詳細については、「[特定の種類のスクリプト コンポーネントの開発](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)」で、該当する例を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5314-135">For more information about how to configure input columns for a specific type of data flow component, see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a><span data-ttu-id="f5314-136">[スクリプト変換エディター] の [入力および出力] ページ</span><span class="sxs-lookup"><span data-stu-id="f5314-136">Inputs and Outputs Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="f5314-137">変換元、変換、および変換先では、**[スクリプト変換エディター]** の **[入力および出力]** ページが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-137">The **Input and Outputs** page of the **Script Transformation Editor** is displayed for sources, transformations, and destinations.</span></span> <span data-ttu-id="f5314-138">このページでは、カスタム スクリプトで使用する入力、出力、および出力列を追加、削除、および構成します。ただし、次のような制限があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-138">On this page, you add, remove, and configure inputs, outputs, and output columns that you want to use in your custom script, within the following limitations:</span></span>

-   <span data-ttu-id="f5314-139">スクリプト コンポーネントを変換元として使用する場合、入力はありませんが複数の出力がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="f5314-139">When used as a source, the Script component has no input and supports multiple outputs.</span></span>

-   <span data-ttu-id="f5314-140">スクリプト コンポーネントを変換として使用する場合、1 つの入力と複数の出力がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="f5314-140">When used as a transformation, the Script component supports one input and multiple outputs.</span></span>

-   <span data-ttu-id="f5314-141">スクリプト コンポーネントを変換先として使用する場合、1 つの入力がサポートされますが出力はありません。</span><span class="sxs-lookup"><span data-stu-id="f5314-141">When used as a destination, the Script component supports one input and has no outputs.</span></span>

 <span data-ttu-id="f5314-142">このメタデータに基づいて生成されるコード プロジェクトでは、BufferWrapper プロジェクト アイテムに、各入力および出力のクラスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="f5314-142">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input and output.</span></span> <span data-ttu-id="f5314-143">たとえば、という名前の出力を作成した場合、 `CustomerOutput` BufferWrapper プロジェクトアイテムには、 `CustomerOutput` から派生したクラスが含まれ <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> ます。このクラスには、 `CustomerOutput` 作成された各出力列の型指定されたアクセサープロパティが含まれます。</span><span class="sxs-lookup"><span data-stu-id="f5314-143">For example, if you create an output named `CustomerOutput`, the BufferWrapper project item will contain a `CustomerOutput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerOutput` class will contain typed accessor properties for each output column created.</span></span>

 <span data-ttu-id="f5314-144">出力列は、 **[入力および出力]** ページでのみ構成できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-144">You can configure output columns only on the **Input and Outputs** page.</span></span> <span data-ttu-id="f5314-145">変換および変換先の入力列は、 **[入力列]** ページで選択できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-145">You can select input columns for transformations and destinations on the **Input Columns** page.</span></span> <span data-ttu-id="f5314-146">BufferWrapper プロジェクト アイテムで作成された、型指定されたアクセサー プロパティは、出力列の書き込み専用プロパティです。</span><span class="sxs-lookup"><span data-stu-id="f5314-146">The typed accessor properties created for you in the BufferWrapper project item will be write-only for output columns.</span></span> <span data-ttu-id="f5314-147">入力列のアクセサー プロパティは、 **[入力列]** ページで各列に選択した使用法の種類に応じて、読み取り専用または読み取り/書き込みのプロパティになります。</span><span class="sxs-lookup"><span data-stu-id="f5314-147">The accessor properties for input columns will be read-only or read/write depending on the usage type that you have selected for each column on the **Input Columns** page.</span></span>

 <span data-ttu-id="f5314-148">特定の種類のデータ フロー コンポーネントの入力および出力を構成する方法の詳細については、「[特定の種類のスクリプト コンポーネントの開発](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)」で、該当する例を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5314-148">For more information about configuring inputs and outputs for a specific type of data flow component see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="f5314-149">エラー行の自動処理のスクリプト コンポーネントでエラー出力として出力を直接構成することはできませんが、別の出力を作成するか、可能な場合はスクリプトを使用してこの出力に行を送信することによって、エラー出力の機能を再現することができます。</span><span class="sxs-lookup"><span data-stu-id="f5314-149">Although you cannot directly configure an output as an error output in the Script component for automatic handling of error rows, you can reproduce the functionality of an error output by creating an additional output and using script to direct rows to this output when appropriate.</span></span> <span data-ttu-id="f5314-150">詳細については、「[スクリプト コンポーネントに対するエラー出力のシミュレート](../../data-flow/transformations/script-component.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5314-150">For more information, see [Simulating an Error Output for the Script Component](../../data-flow/transformations/script-component.md).</span></span>

#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a><span data-ttu-id="f5314-151">出力の ExclusionGroup プロパティおよび SynchronousInputID プロパティ</span><span class="sxs-lookup"><span data-stu-id="f5314-151">ExclusionGroup and SynchronousInputID Properties of Outputs</span></span>
 <span data-ttu-id="f5314-152">`ExclusionGroup` プロパティは、同期出力型の変換でのみ、0 以外の値になります。この場合、コードはフィルターまたは分岐を実行し、各行を、`ExclusionGroup` の 0 以外の同じ値を共有する出力の 1 つに送ります。</span><span class="sxs-lookup"><span data-stu-id="f5314-152">The `ExclusionGroup` property has a non-zero value only in transformations with synchronous outputs, where your code performs filtering or branching and directs each row to one of the outputs that share the same non-zero `ExclusionGroup` value.</span></span> <span data-ttu-id="f5314-153">たとえば変換は、行を既定の出力またはエラー出力のどちらかに送信できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-153">For example, the transformation can direct rows either to the default output or to an error output.</span></span> <span data-ttu-id="f5314-154">この場合に追加の出力を作成するには、`SynchronousInputID` プロパティの値が、コンポーネントの入力の `ID` と一致する整数に設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="f5314-154">When you create additional outputs for this scenario, make sure to set the value of the `SynchronousInputID` property to the integer that matches the `ID` of the component's input.</span></span>

 <span data-ttu-id="f5314-155">`SynchronousInputID` プロパティは、同期出力型の変換でのみ、0 以外の値になります。</span><span class="sxs-lookup"><span data-stu-id="f5314-155">The `SynchronousInputID` property has a non-zero value only in transformations with synchronous outputs.</span></span> <span data-ttu-id="f5314-156">このプロパティの値が 0 の場合、出力が非同期型であることを示します。</span><span class="sxs-lookup"><span data-stu-id="f5314-156">If the value of this property is zero, it means that the output is asynchronous.</span></span> <span data-ttu-id="f5314-157">同期出力では、新しい行を追加せず、選択した出力に行が渡されます。このプロパティには、コンポーネントの入力の `ID` が含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-157">For a synchronous output, where rows are passed through to the selected output or outputs without adding any new rows, this property should contain the `ID` of the component's input.</span></span>

> [!NOTE]
>  <span data-ttu-id="f5314-158">[**スクリプト変換エディター** ] によって最初の出力が作成されると、エディターによって、 `SynchronousInputID` 出力のプロパティが `ID` コンポーネントの入力のに設定されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-158">When the **Script Transformation Editor** creates the first output, the editor sets the `SynchronousInputID` property of the output to the `ID` of the component's input.</span></span> <span data-ttu-id="f5314-159">しかし、その後の出力時には、出力の `SynchronousInputID` プロパティが 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-159">However, when the editor creates subsequent outputs, the editor sets the `SynchronousInputID` properties of those outputs to zero.</span></span>
> 
>  <span data-ttu-id="f5314-160">同期出力型のコンポーネントを作成する場合は、各出力 `SynchronousInputID` のプロパティがコンポーネントの入力のに設定されている必要があり `ID` ます。</span><span class="sxs-lookup"><span data-stu-id="f5314-160">If you are creating a component with synchronous outputs, each output must have its `SynchronousInputID` property set to the `ID` of the component's input.</span></span> <span data-ttu-id="f5314-161">このため、最初の出力後は、エディターで出力を作成するたびに、`SynchronousInputID` 値を 0 からコンポーネントの入力の `ID` に変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-161">Therefore, each output that the editor creates after the first output must have its `SynchronousInputID` value changed from zero to the `ID` of the component's input.</span></span>
> 
>  <span data-ttu-id="f5314-162">非同期出力型コンポーネントを作成する場合、各出力の `SynchronousInputID` プロパティを 0 に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-162">If you are creating a component with asynchronous outputs, each output must have its `SynchronousInputID` property set to zero.</span></span> <span data-ttu-id="f5314-163">したがって、最初の出力の `SynchronousInputID` 値は、 `ID` コンポーネントの入力のから0に変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-163">Therefore, the first output must have its `SynchronousInputID` value changed from the `ID` of the component's input to zero.</span></span>

 <span data-ttu-id="f5314-164">スクリプト コンポーネントで 2 つの同期出力のうちのいずれかに行を送信する例については、「[スクリプト コンポーネントによる同期変換の作成](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5314-164">For an example of directing rows to one of two synchronous outputs in the Script component, see [Creating a Synchronous Transformation with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span></span>

### <a name="object-names-in-generated-script"></a><span data-ttu-id="f5314-165">生成されたスクリプトのオブジェクト名</span><span class="sxs-lookup"><span data-stu-id="f5314-165">Object Names in Generated Script</span></span>
 <span data-ttu-id="f5314-166">スクリプト コンポーネントは、入力と出力の名前を解析し、入力と出力内の列の名前を解析します。次に、これらの名前に基づいて、BufferWrapper プロジェクト アイテムにクラスとプロパティを生成します。</span><span class="sxs-lookup"><span data-stu-id="f5314-166">The Script component parses the names of inputs and outputs, and parse the names of columns in the inputs and outputs, and based on these names generates classes and properties in the BufferWrapper project item.</span></span> <span data-ttu-id="f5314-167">見つかった名前に、Unicode カテゴリの `UppercaseLetter`、`LowercaseLetter`、`TitlecaseLetter`、`ModifierLetter`、`OtherLetter`、または `DecimalDigitLetter` に属していない文字が含まれている場合、無効な文字は生成された名前から削除されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-167">If the found names include characters that do not belong to the Unicode categories `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter`, or `DecimalDigitLetter`, the invalid characters are dropped in the generated names.</span></span> <span data-ttu-id="f5314-168">たとえば、スペースは削除されるため、**FirstName** と **[First Name]** という名前の 2 つの入力列は、どちらも列名 **FirstName** を持つと解釈され、予期しない結果が生じます。</span><span class="sxs-lookup"><span data-stu-id="f5314-168">For example, spaces are dropped, therefore two input columns that have the names **FirstName** and [**First Name**] are both interpreted as having the column name **FirstName**, with unpredictable results.</span></span> <span data-ttu-id="f5314-169">このような状況を防ぐには、スクリプト コンポーネントで使用される入力と出力の名前、および入力と出力の列の名前には、このセクションで一覧表示されている Unicode カテゴリに属する文字のみが含まれるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-169">To avoid this situation, the names of inputs and outputs and of input and output columns used by the Script component should contain only characters in the Unicode categories listed in this section.</span></span>

### <a name="script-page-of-the-script-transformation-editor"></a><span data-ttu-id="f5314-170">[スクリプト変換エディター] の [スクリプト] ページ</span><span class="sxs-lookup"><span data-stu-id="f5314-170">Script Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="f5314-171">**[スクリプト変換エディター]** の **[スクリプト]** ページでは、スクリプト タスクに一意の名前および説明を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="f5314-171">On the **Script** page of the **Script Task Editor**, you assign a unique name and a description for the Script task.</span></span> <span data-ttu-id="f5314-172">また、次のプロパティの値を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="f5314-172">You can also assign values for the following properties.</span></span>

> [!NOTE]
>  <span data-ttu-id="f5314-173">[!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] およびそれ以降のバージョンでは、すべてのスクリプトがプリコンパイル済みです。</span><span class="sxs-lookup"><span data-stu-id="f5314-173">In [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions, all scripts are precompiled.</span></span> <span data-ttu-id="f5314-174">以前のバージョンでは、タスクの `Precompile` プロパティを設定することによって、スクリプトをプリコンパイルするかどうかを指定していました。</span><span class="sxs-lookup"><span data-stu-id="f5314-174">In previous versions, you specified whether scripts were precompiled by setting a `Precompile` property for the task.</span></span>

#### <a name="validateexternalmetadata-property"></a><span data-ttu-id="f5314-175">ValidateExternalMetadata プロパティ</span><span class="sxs-lookup"><span data-stu-id="f5314-175">ValidateExternalMetadata Property</span></span>
 <span data-ttu-id="f5314-176">`ValidateExternalMetadata` プロパティのブール値は、コンポーネントがデザイン時に外部データ ソースに対する検証を実行するかどうか、または実行時まで検証を延期するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="f5314-176">The Boolean value of the `ValidateExternalMetadata` property specifies whether the component should perform validation against external data sources at design time, or whether it should postpone validation until run time.</span></span> <span data-ttu-id="f5314-177">既定では、このプロパティの値は `True` です。つまり、外部メタデータはデザイン時と実行時の両方で検証されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-177">By default, the value of this property is `True`; that is, the external metadata is validated both at design time and at run time.</span></span> <span data-ttu-id="f5314-178">外部データ ソースをデザイン時に使用しない場合、たとえば、パッケージの実行時にのみ外部データ ソースをダウンロードしたり、変換先を作成する場合には、このプロパティの値を `False` に設定できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-178">You may want to set the value of this property to `False` when an external data source is not available at design time: for example, when the package downloads the source or creates the destination only at run time.</span></span>

#### <a name="readonlyvariables-and-readwritevariables-properties"></a><span data-ttu-id="f5314-179">ReadOnlyVariables プロパティおよび ReadWriteVariables プロパティ</span><span class="sxs-lookup"><span data-stu-id="f5314-179">ReadOnlyVariables and ReadWriteVariables Properties</span></span>
 <span data-ttu-id="f5314-180">既存の変数をコンマ区切りリストとして、これらのプロパティの値に入力すると、スクリプト コンポーネントのコード内で、その変数に読み取り専用アクセスまたは読み取り/書き込みアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="f5314-180">You can enter comma-delimited lists of existing variables as the values of these properties to make the variables available for read-only or read/write access within the Script component code.</span></span> <span data-ttu-id="f5314-181">変数には、自動生成された基本クラスの <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> および <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> プロパティを介して、コード内でアクセスします。</span><span class="sxs-lookup"><span data-stu-id="f5314-181">Variables are accessed in code through the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> and <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> properties of the autogenerated base class.</span></span> <span data-ttu-id="f5314-182">詳しくは、「[スクリプト コンポーネントでの変数の使用](using-variables-in-the-script-component.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f5314-182">For more information, see [Using Variables in the Script Component](using-variables-in-the-script-component.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="f5314-183">変数名の大文字と小文字は区別されます。</span><span class="sxs-lookup"><span data-stu-id="f5314-183">Variable names are case-sensitive.</span></span>

#### <a name="scriptlanguage"></a><span data-ttu-id="f5314-184">[ScriptLanguage]</span><span class="sxs-lookup"><span data-stu-id="f5314-184">ScriptLanguage</span></span>
 <span data-ttu-id="f5314-185">スクリプト コンポーネントのプログラミング言語として、[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic または [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# を選択できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-185">You can select either [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# as the programming language for the Script component.</span></span>

#### <a name="edit-script-button"></a><span data-ttu-id="f5314-186">[スクリプトの編集] ボタン</span><span class="sxs-lookup"><span data-stu-id="f5314-186">Edit Script Button</span></span>
 <span data-ttu-id="f5314-187">**[スクリプトの編集]** ボタンをクリックすると [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE が開き、カスタム スクリプトを記述できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-187">The **Edit Script** button opens the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE in which you write your custom script.</span></span> <span data-ttu-id="f5314-188">詳しくは、「[スクリプト コンポーネントのコーディングおよびデバッグ](coding-and-debugging-the-script-component.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f5314-188">For more information, see [Coding and Debugging the Script Component](coding-and-debugging-the-script-component.md).</span></span>

### <a name="connection-managers-page-of-the-script-transformation-editor"></a><span data-ttu-id="f5314-189">[スクリプト変換エディター] の [接続マネージャー] ページ</span><span class="sxs-lookup"><span data-stu-id="f5314-189">Connection Managers Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="f5314-190">**[スクリプト変換エディター]** の **[接続マネージャー]** ページでは、カスタム スクリプトで使用する接続マネージャーを追加および削除します。</span><span class="sxs-lookup"><span data-stu-id="f5314-190">On the **Connection Managers** page of the **Script Transformation Editor**, you add and remove connection managers that you want to use in your custom script.</span></span> <span data-ttu-id="f5314-191">通常、変換元または変換先コンポーネントを作成する場合は、接続マネージャーを参照する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f5314-191">Normally you need to reference connection managers when you create a source or destination component.</span></span>

 <span data-ttu-id="f5314-192">このメタデータに基づいて生成されるコード プロジェクトの `ComponentWrapper` プロジェクト アイテムには、選択した各接続マネージャー用の型指定されたアクセサー プロパティを格納する `Connections` コレクション クラスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="f5314-192">In the code project that will be generated based on this metadata, the `ComponentWrapper` project item contains a `Connections` collection class that has a typed accessor property for each selected connection manager.</span></span> <span data-ttu-id="f5314-193">型指定された各アクセサー プロパティの名前は、接続マネージャー自体の名前と同じであり、<xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100> のインスタンスとして、接続マネージャーへの参照を返します。</span><span class="sxs-lookup"><span data-stu-id="f5314-193">Each typed accessor property has the same name as the connection manager itself and returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="f5314-194">たとえば、エディターの **[接続マネージャー]** ページに `MyADONETConnection` という名前の接続マネージャーを追加した場合、次のコードを使用して、スクリプト内のその接続マネージャーへの参照を取得できます。</span><span class="sxs-lookup"><span data-stu-id="f5314-194">For example, if you have added a connection manager named `MyADONETConnection` on the **Connection Managers** page of the editor, you can obtain a reference to the connection manager in your script by using the following code:</span></span>

```vb
Dim myADONETConnectionManager As IDTSConnectionManager100 = _
    Me.Connections.MyADONETConnection
```

 <span data-ttu-id="f5314-195">詳しくは、「[スクリプト コンポーネントでのデータ ソースへの接続](connecting-to-data-sources-in-the-script-component.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f5314-195">For more information, see [Connecting to Data Sources in the Script Component](connecting-to-data-sources-in-the-script-component.md).</span></span>

<span data-ttu-id="f5314-196">![Integration Services アイコン (小)](../../media/dts-16.gif "Integration Services のアイコン (小)")**は Integration Services で最新の**状態を維持  </span><span class="sxs-lookup"><span data-stu-id="f5314-196">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="f5314-197">マイクロソフトが提供する最新のダウンロード、アーティクル、サンプル、ビデオ、およびコミュニティで選択されたソリューションについては、MSDN の [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] のページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f5314-197">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="f5314-198">MSDN の Integration Services のページを参照する</span><span class="sxs-lookup"><span data-stu-id="f5314-198">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="f5314-199">これらの更新が自動で通知されるようにするには、ページの RSS フィードを定期受信します。</span><span class="sxs-lookup"><span data-stu-id="f5314-199">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="f5314-200">参照</span><span class="sxs-lookup"><span data-stu-id="f5314-200">See Also</span></span>
 [<span data-ttu-id="f5314-201">スクリプト コンポーネントのコーディングおよびデバッグ</span><span class="sxs-lookup"><span data-stu-id="f5314-201">Coding and Debugging the Script Component</span></span>](coding-and-debugging-the-script-component.md)


