---
title: SharePoint サーバーに Analysis Services OLE DB Provider をインストールする |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: 2c62daf9-1f2d-4508-a497-af62360ee859
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 371d344a451e7702a525e0cb6afa3421b6598cac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643126"
---
# <a name="install-the-analysis-services-ole-db-provider-on-sharepoint-servers"></a><span data-ttu-id="b34b6-102">SharePoint サーバーへの Analysis Services OLE DB プロバイダーのインストール</span><span class="sxs-lookup"><span data-stu-id="b34b6-102">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>
  <span data-ttu-id="b34b6-103">Microsoft OLE DB Provider for Analysis Services (MSOLAP) は、[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] データを操作するためにクライアント アプリケーションで使用されるインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="b34b6-103">The Microsoft OLE DB Provider for Analysis Services (MSOLAP) is an interface that client applications use to interact with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="b34b6-104">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] を含んだ SharePoint 環境では、このプロバイダーによって [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] データに対する接続要求が処理されます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-104">In a SharePoint environment that includes [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], the provider handles connection requests for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data.</span></span>  
  
 <span data-ttu-id="b34b6-105">データ プロバイダーは [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] インストール パッケージ (spPowerPivot.msi) に含まれていますが、手動でインストールすることが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-105">The data provider is included in the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi), but might require manual installation.</span></span> <span data-ttu-id="b34b6-106">SharePoint サーバーにクライアント ライブラリまたはデータ プロバイダーを手動でインストールしなければならない理由が 2 つあります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-106">There are two reasons why you might need to manually install a client library or data provider on a SharePoint server.</span></span>  
  
-   <span data-ttu-id="b34b6-107">**下位互換性を有効に**します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-107">**Enable backwards compatibility**.</span></span> [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] <span data-ttu-id="b34b6-108">のブックは、[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンの Analysis Services OLE DB プロバイダーを接続文字列に指定します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-108">workbooks specify the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the Analysis Services OLE DB provider in their connection string.</span></span> <span data-ttu-id="b34b6-109">したがって、要求を正常に終了させるには、このプロバイダー バージョンがコンピューターに存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-109">As such, this provider version must be present on the computer in order for the request to succeed.</span></span>  
  
-   <span data-ttu-id="b34b6-110">**専用の Excel Services インスタンスでデータアクセスを有効に**します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-110">**Enable data access on a dedicated Excel Services instance**.</span></span> <span data-ttu-id="b34b6-111">SharePoint ファーム内の [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] がインストールされていないサーバー上に Excel Services が存在する場合は、[!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] インストール パッケージを使用して、[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] バージョンのプロバイダーおよびその他のクライアント接続コンポーネントをインストールしてください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-111">If your SharePoint farm includes Excel Services on a server that does not also have [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] version of the provider and other client connectivity components by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b34b6-112">これらのシナリオは、共存することができます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-112">These scenarios are not mutually exclusive.</span></span> <span data-ttu-id="b34b6-113">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] インスタンスを使用せずに Excel Services を実行するアプリケーション サーバーを含むファーム上で複数のブック バージョンをホストするには、各 Excel Services コンピューターに古いバージョンと新しいバージョンのデータ プロバイダーをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-113">Hosting multiple workbook versions on a farm that includes application servers running Excel Services without a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instance will require that you install both older and newer versions of the data provider on each Excel Services computer.</span></span>  
  
  
##  <a name="versions-of-the-ole-db-provider-supporting-powerpivot-data-access"></a><a name="bkmk_vers"></a><span data-ttu-id="b34b6-114">PowerPivot データアクセスをサポートする OLE DB プロバイダーのバージョン</span><span class="sxs-lookup"><span data-stu-id="b34b6-114">Versions of the OLE DB Provider Supporting PowerPivot Data Access</span></span>  
 <span data-ttu-id="b34b6-115">SharePoint ファームには、PowerPivot データ アクセスをサポートしていない旧バージョンを含め、複数のバージョンの Analysis Services OLE DB プロバイダーが含まれていることがあります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-115">A SharePoint farm might include multiple versions of the Analysis Services OLE DB provider, including older versions that do not support PowerPivot data access.</span></span>  
  
 <span data-ttu-id="b34b6-116">既定では、SharePoint 2010 により [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] バージョンのプロバイダーがインストールされます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-116">By default, SharePoint 2010 installs the [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the provider.</span></span> <span data-ttu-id="b34b6-117">このバージョンは、MSOLAP.4 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 用に使用されるのと同じバージョン番号) として認識されますが、PowerPivot データ アクセス用には機能しません。</span><span class="sxs-lookup"><span data-stu-id="b34b6-117">Although it is identified as MSOLAP.4 (the same version number used for [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), this version does not work for PowerPivot data access.</span></span> <span data-ttu-id="b34b6-118">正常に接続するには、[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] または [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] バージョンのプロバイダーが必要です。</span><span class="sxs-lookup"><span data-stu-id="b34b6-118">In order for connections to succeed, you must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of the provider.</span></span>  
  
 <span data-ttu-id="b34b6-119">[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] バージョン以降の OLE DB プロバイダーは、[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] データ構造に対するトランスポートおよび接続をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="b34b6-119">A post [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the OLE DB provider includes transports and connection support for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data structures.</span></span> [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] <span data-ttu-id="b34b6-120">ブックでは、このプロバイダーの新しいバージョンを使用して、ファーム内の [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] サーバーからクエリ処理を要求します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-120">workbooks use newer versions of this provider to request query processing from [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] servers in the farm.</span></span> <span data-ttu-id="b34b6-121">更新後のバージョンを入手するには、SQL Server 機能パックのページからダウンロードしてインストールします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-121">To get an updated version, you can download and install it through a SQL Server Feature Pack page.</span></span>  
  
 <span data-ttu-id="b34b6-122">次の表に、有効なバージョンを示します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-122">The following table describes the valid versions:</span></span>  
  
|<span data-ttu-id="b34b6-123">製品バージョン</span><span class="sxs-lookup"><span data-stu-id="b34b6-123">Product version</span></span>|<span data-ttu-id="b34b6-124">ファイル バージョン</span><span class="sxs-lookup"><span data-stu-id="b34b6-124">File version</span></span>|<span data-ttu-id="b34b6-125">有効な対象データ</span><span class="sxs-lookup"><span data-stu-id="b34b6-125">Valid for:</span></span>|  
|---------------------|------------------|----------------|  
|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]|<span data-ttu-id="b34b6-126">ファイル システム内の MSOLAP100.dll</span><span class="sxs-lookup"><span data-stu-id="b34b6-126">MSOLAP100.dll in the file system</span></span><br /><br /> <span data-ttu-id="b34b6-127">Excel 接続文字列内の MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="b34b6-127">MSOLAP.4 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="b34b6-128">ファイル バージョン詳細の 10.50.1600 以降</span><span class="sxs-lookup"><span data-stu-id="b34b6-128">10.50.1600 or later in file version details</span></span>|<span data-ttu-id="b34b6-129">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンの PowerPivot for Excel を使用して作成されたデータ モデルに使用します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-129">Use for data models created using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel.</span></span>|  
|[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]|<span data-ttu-id="b34b6-130">ファイル システム内の MSOLAP110.dll</span><span class="sxs-lookup"><span data-stu-id="b34b6-130">MSOLAP110.dll in the file system</span></span><br /><br /> <span data-ttu-id="b34b6-131">Excel 接続文字列内の MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="b34b6-131">MSOLAP.5 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="b34b6-132">ファイル バージョン詳細の 11.0.0000 以降</span><span class="sxs-lookup"><span data-stu-id="b34b6-132">11.0.0000 or later in file version details</span></span>|<span data-ttu-id="b34b6-133">[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] または [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] バージョンの [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel を使用して作成されたデータ モデルに使用します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-133">Use for data models created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span>|  
|[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]|<span data-ttu-id="b34b6-134">ファイル システム内の MSOLAP120.dll</span><span class="sxs-lookup"><span data-stu-id="b34b6-134">MSOLAP120.dll in the file system</span></span><br /><br /> <span data-ttu-id="b34b6-135">ファイル バージョン詳細の 12.0.20000 以降</span><span class="sxs-lookup"><span data-stu-id="b34b6-135">12.0.20000 or later in file version details</span></span>|<span data-ttu-id="b34b6-136">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] モデル以外のデータ モデルに使用します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-136">Use for data models other than [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] models.</span></span>|  
  
  
##  <a name="why-you-need-to-install-the-ole-db-provider"></a><a name="bkmk_why"></a><span data-ttu-id="b34b6-137">OLE DB プロバイダーをインストールする必要がある理由</span><span class="sxs-lookup"><span data-stu-id="b34b6-137">Why you need to install the OLE DB Provider</span></span>  
 <span data-ttu-id="b34b6-138">ファーム内のサーバーに OLE DB プロバイダーを手動でインストールしなければならないケースとしては、2 つのシナリオが挙げられます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-138">There are two scenarios that call for manually installing the OLE DB provider on servers in the farm.</span></span>  
  
 <span data-ttu-id="b34b6-139">**最も一般的なシナリオは、** [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] ファーム内のドキュメントライブラリに保存されている古いバージョンと新しいバージョンのブックがある場合です。</span><span class="sxs-lookup"><span data-stu-id="b34b6-139">**The most common scenario** is when you have older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks that are saved in document libraries in the farm.</span></span> <span data-ttu-id="b34b6-140">組織内のアナリストがバージョンの for Excel を使用していて、 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] それらのブックをインストールに保存している場合 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 、古いブックは機能しません。</span><span class="sxs-lookup"><span data-stu-id="b34b6-140">If analysts in your organization are using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel, and they save those workbooks to a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, the older workbook will not work.</span></span> <span data-ttu-id="b34b6-141">この接続文字列は、プロバイダーの古いバージョンを参照します。これは、インストールしない限り、サーバー上には存在しません。</span><span class="sxs-lookup"><span data-stu-id="b34b6-141">Its connection string will reference an older version of the provider, which won't be on the server unless you install it.</span></span> <span data-ttu-id="b34b6-142">両方のバージョンをインストールすると、古いバージョンと新しいバージョンの [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel で作成された PowerPivot ブックに対してデータ アクセスが可能になります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-142">Installing both versions will enable data access for PowerPivot workbooks created in older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span> [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] <span data-ttu-id="b34b6-143">のセットアップでは [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンのプロバイダーはインストールされないため、以前のバージョンのブックを使用している場合には、これを手動でインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-143">Setup does not install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider, so you must install it manually if you are using workbooks from a previous version.</span></span>  
  
 <span data-ttu-id="b34b6-144">**2 つ目のシナリオ**は、Excel Services を実行するサーバーが SharePoint ファーム内にあり、ではない場合です [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="b34b6-144">**The second scenario** is when you have a server in a SharePoint farm that runs Excel Services, but not [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="b34b6-145">このような場合には、Excel Services を実行しているアプリケーション サーバーを、新しいバージョンのプロバイダーに手動で更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-145">In this case, the application server that runs Excel Services must be manually updated to use a newer version of the provider.</span></span> <span data-ttu-id="b34b6-146">これは、PowerPivot for SharePoint インスタンスに接続するために必要です。</span><span class="sxs-lookup"><span data-stu-id="b34b6-146">This is necessary for connecting to a PowerPivot for SharePoint instance.</span></span> <span data-ttu-id="b34b6-147">Excel Services で以前のバージョンのプロバイダーを使用している場合は、接続要求が失敗します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-147">If Excel Services is using an older version of the provider, the connection request will fail.</span></span> <span data-ttu-id="b34b6-148">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] をサポートするために必要なすべてのコンポーネントが確実にインストールされるように、[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] セットアップまたは [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] インストール パッケージ (spPowerPivot.msi) を使用してプロバイダーをインストールする必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-148">Note that the provider must be installed by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup or the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi) in order to ensure that all components required support [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] are installed.</span></span>  
  
  
##  <a name="install-the-sql-server-2012-ole-db-provider-on-an-excel-services-server-by-using-sql-server-setup"></a><a name="bkmk_sql11"></a><span data-ttu-id="b34b6-149">SQL Server セットアップを使用して Excel Services サーバーに SQL Server 2012 OLE DB プロバイダーをインストールする</span><span class="sxs-lookup"><span data-stu-id="b34b6-149">Install the SQL Server 2012 OLE DB Provider on an Excel Services server by using SQL Server Setup</span></span>  
 <span data-ttu-id="b34b6-150">OLE DB プロバイダーおよび他のクライアント接続コンポーネントがまだインストールされていない SharePoint サーバー (同じハードウェア上に PowerPivot for SharePoint がない状態で Excel Services を実行しているアプリケーション サーバーなど) に OLE DB プロバイダーおよび他のクライアント接続コンポーネントを追加するには、次の説明に従います。</span><span class="sxs-lookup"><span data-stu-id="b34b6-150">Use the following instructions to add the OLE DB provider and other client connectivity components to SharePoint servers that do not already have them installed, such as application servers that run Excel Services without PowerPivot for SharePoint on the same hardware.</span></span>  
  
 <span data-ttu-id="b34b6-151">次の手順を使用して、現在の Analysis Services OLE DB プロバイダーをインストールし、グローバルアセンブリに**Microsoft.AnalysisServices.Xmla.dll**を追加します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-151">Use these instructions to install the current Analysis Services OLE DB provider and to add the **Microsoft.AnalysisServices.Xmla.dll** to the global assembly.</span></span>  
  
#### <a name="run-sql-server-setup-and-install-the-client-connectivity-tools"></a><span data-ttu-id="b34b6-152">SQL Server セットアップの実行とクライアント接続ツールのインストール</span><span class="sxs-lookup"><span data-stu-id="b34b6-152">Run SQL Server Setup and Install the Client Connectivity Tools</span></span>  
  
1.  <span data-ttu-id="b34b6-153">Excel Services をホストするアプリケーション サーバー上で、SQL Server セットアップを実行します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-153">On the application server that hosts Excel Services, run SQL Server Setup.</span></span>  
  
2.  <span data-ttu-id="b34b6-154">[インストール] ページで、[**新規 SQL Server スタンドアロンインストールを選択するか、既存のインストールに機能を追加**します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-154">On the Installation page, choose **New SQL Server stand-alone installation or add features to an existing installation**.</span></span>  
  
3.  <span data-ttu-id="b34b6-155">[インストールの種類] ページで、[ **SQL Server 2012 の新規インストールを実行する**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-155">On the Installation Type page, choose **Perform a new installation of SQL Server 2012**.</span></span>  
  
4.  <span data-ttu-id="b34b6-156">[セットアップロール] ページで、[ **SQL Server 機能のインストール**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-156">On the Setup Role page, choose **SQL Server Feature Installation**.</span></span>  
  
5.  <span data-ttu-id="b34b6-157">[**機能の選択**] ページで、[**クライアントツール接続**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-157">On the **Feature Selection** page, click **Client Tools Connectivity**.</span></span> <span data-ttu-id="b34b6-158">このオプションを選択すると、がインストールされ**Microsoft.AnalysisServices.Xmla.dll**</span><span class="sxs-lookup"><span data-stu-id="b34b6-158">This option installs **Microsoft.AnalysisServices.Xmla.dll**</span></span>  
  
     <span data-ttu-id="b34b6-159">それ以外の機能は選択しないでください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-159">Do not select any other features.</span></span>  
  
6.  <span data-ttu-id="b34b6-160">[**次**へ] をクリックしてウィザードを終了し、[**インストール**] をクリックしてセットアップを実行します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-160">Click **Next** to finish the wizard, and then click **Install** to run Setup.</span></span>  
  
7.  <span data-ttu-id="b34b6-161">Excel Services を実行しているが PowerPivot for SharePoint はインストールされていないサーバーが他にある場合は、前の手順を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-161">Repeat the previous steps if you have other servers running Excel Services, without a PowerPivot for SharePoint installation on the same server.</span></span>  
  
#### <a name="verify-msolap5-is-a-trusted-provider"></a><span data-ttu-id="b34b6-162">MSOLAP.5 が信頼できるプロバイダーであるかどうかの確認</span><span class="sxs-lookup"><span data-stu-id="b34b6-162">Verify MSOLAP.5 is a trusted provider</span></span>  
  
1.  <span data-ttu-id="b34b6-163">サーバーの全体管理で、 **[アプリケーション構成の管理]** をクリックし、Excel Services サービス アプリケーションをクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-163">In Central Administration, click **Manage service applications**, and then click the Excel Services service application.</span></span>  
  
2.  <span data-ttu-id="b34b6-164">**[信頼できるデータ プロバイダー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-164">Click **Trusted Data Providers**.</span></span>  
  
3.  <span data-ttu-id="b34b6-165">MSOLAP.5 が一覧に表示されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-165">Verify that MSOLAP.5 appears in the list.</span></span> <span data-ttu-id="b34b6-166">PowerPivot for SharePoint の構成方法によっては、MSOLAP.5 が既に信頼されている場合があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-166">Depending on how you configured PowerPivot for SharePoint, MSOLAP.5 might already be trusted.</span></span> <span data-ttu-id="b34b6-167">PowerPivot 構成ツールを使用したにもかかわらず、このアクションがタスクの一覧から除外された場合、MSOLAP.5 は Excel Services によって信頼されないため、手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-167">If you used the PowerPivot Configuration tool, but then excluded this action from the task list, MSOLAP.5 will not be trusted by Excel Services and now needs to be added manually.</span></span>  
  
4.  <span data-ttu-id="b34b6-168">MSOLAP が一覧に表示されない場合は、[**信頼された Data Provider の追加**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-168">If MSOLAP is not listed, click **Add Trusted Data Provider**.</span></span>  
  
5.  <span data-ttu-id="b34b6-169">[プロバイダー ID] に、「`MSOLAP.5`」と入力します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-169">In Provider ID, type `MSOLAP.5`.</span></span>  
  
6.  <span data-ttu-id="b34b6-170">[プロバイダーの種類] では、OLE DB が選択されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-170">For Provider Type, ensure that OLE DB is selected.</span></span>  
  
7.  <span data-ttu-id="b34b6-171">[プロバイダーの説明] に、「 **Microsoft OLE DB プロバイダー (OLAP Services 11.0 用)**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-171">In Provider Description, type **Microsoft OLE DB Provider for OLAP Services 11.0**.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="b34b6-172">インストールの確認</span><span class="sxs-lookup"><span data-stu-id="b34b6-172">Verify installation</span></span>  
  
1.  <span data-ttu-id="b34b6-173">Program files\Microsoft Analysis Services\AS OLEDB\110 に移動します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-173">Go to Program files\Microsoft Analysis Services\AS OLEDB\110.</span></span>  
  
2.  <span data-ttu-id="b34b6-174">msolap110.dll を右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-174">Right-click msolap110.dll and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="b34b6-175">**[詳細]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-175">Click **Details**.</span></span>  
  
4.  <span data-ttu-id="b34b6-176">ファイルのバージョン情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-176">View the file version information.</span></span> <span data-ttu-id="b34b6-177">バージョンには 11.00. が含まれている必要が \<buildnumber> あります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-177">The version should include 11.00.\<buildnumber>.</span></span>  
  
5.  <span data-ttu-id="b34b6-178">Windows\assembly フォルダーで、Microsoft.AnalysisServices.Xmla.dll、バージョン 11.0.0.0 が表示されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-178">In the Windows\assembly folder, verify that Microsoft.AnalysisServices.Xmla.dll, version 11.0.0.0, is listed.</span></span>  
  
  
##  <a name="use-the-powerpivot-for-sharepoint-installation-package-sppowerpivotmsi-to-install-the-sql-server-2012-ole-db-provider"></a><a name="bkmk_install2012_from_sppowerpivot_msi"></a><span data-ttu-id="b34b6-179">PowerPivot for SharePoint インストールパッケージ (spPowerPivot.msi) を使用して SQL Server 2012 OLE DB プロバイダーをインストールする</span><span class="sxs-lookup"><span data-stu-id="b34b6-179">Use the PowerPivot for SharePoint Installation package (spPowerPivot.msi) to install the SQL Server 2012 OLE DB Provider</span></span>  
 <span data-ttu-id="b34b6-180">[!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] インストールパッケージ **(spPowerPivot.msi)** を使用して、および Excel Services サーバーに OLE DB プロバイダーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-180">Install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] OLE DB Provider on and Excel Services Server by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package **(spPowerPivot.msi)**.</span></span>  
  
#### <a name="download-the-msolap5-provider-from-the-sssql11sp1-feature-pack"></a><span data-ttu-id="b34b6-181">[!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack から MSOLAP.5 プロバイダーをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-181">Download the MSOLAP.5 provider from the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack.</span></span>  
  
1.  <span data-ttu-id="b34b6-182">[Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-182">Browse to [Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)</span></span>  
  
2.  <span data-ttu-id="b34b6-183">[**インストール手順**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-183">Click **Install Instructions**.</span></span>  
  
3.  <span data-ttu-id="b34b6-184">「Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-184">See the section "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1".</span></span> <span data-ttu-id="b34b6-185">ファイルをダウンロードし、インストールを開始します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-185">Download the file and start the installation.</span></span>  
  
4.  <span data-ttu-id="b34b6-186">[**機能の選択**] ページで、[ **SQL Server の Analysis Services OLE DB Provider**を選択します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-186">On the **Feature Selection** page, select **Analysis Services OLE DB Provider for SQL Server**.</span></span> <span data-ttu-id="b34b6-187">他のコンポーネントの選択を解除して、インストールを完了します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-187">Unselect the other components and complete the installation.</span></span> <span data-ttu-id="b34b6-188">spPowerPivot.msi の詳細については、「 [SharePoint 2013&#41;&#40;PowerPivot for SharePoint アドインをインストールまたはアンインストールする](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-188">For more information on spPowerPivot.msi, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
5.  <span data-ttu-id="b34b6-189">MSOLAP.5 を信頼できるプロバイダーとして SharePoint Excel Services に登録します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-189">Register MSOLAP.5 as a trusted provider with SharePoint Excel Services.</span></span> <span data-ttu-id="b34b6-190">詳細については、「 [Excel Services で信頼できるデータ プロバイダーとして MSOLAP.5 を追加](https://technet.microsoft.com/library/hh758436.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b34b6-190">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://technet.microsoft.com/library/hh758436.aspx).</span></span>  
  
  
##  <a name="install-the-sql-server-2008-r2-ole-db-provider-to-host-earlier-version-workbooks"></a><a name="bkmk_kj"></a><span data-ttu-id="b34b6-191">以前のバージョンのブックをホストするために SQL Server 2008 R2 OLE DB プロバイダーをインストールする</span><span class="sxs-lookup"><span data-stu-id="b34b6-191">Install the SQL Server 2008 R2 OLE DB Provider to host earlier version workbooks</span></span>  
 <span data-ttu-id="b34b6-192">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンの MSOLAP.4 プロバイダーをインストールして、Microsoft.AnalysisServices.ChannelTransport.dll ファイルを登録するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="b34b6-192">Use the following instructions to install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the MSOLAP.4 provider, and register the Microsoft.AnalysisServices.ChannelTransport.dll file.</span></span> <span data-ttu-id="b34b6-193">ChannelTransport は Analysis Services OLE DB プロバイダーのサブコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="b34b6-193">The ChannelTransport is a subcomponent of the Analysis Services OLE DB provider.</span></span> <span data-ttu-id="b34b6-194">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンのプロバイダーは、ChannelTransport を使用して接続を行うときにレジストリを読み取ります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-194">The [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider reads the registry when using ChannelTransport to make a connection.</span></span> <span data-ttu-id="b34b6-195">このファイルの登録は、[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] サーバー上の [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] プロバイダーによって処理される接続にのみ必要なインストール後の手順です。</span><span class="sxs-lookup"><span data-stu-id="b34b6-195">Registering this file is a post-installation step required only for connections handled by the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] provider on a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] server.</span></span>  
  
#### <a name="step-1-download-and-install-the-client-library"></a><span data-ttu-id="b34b6-196">手順 1: クライアント ライブラリのダウンロードとインストール</span><span class="sxs-lookup"><span data-stu-id="b34b6-196">Step 1: Download and install the client library</span></span>  
  
1.  <span data-ttu-id="b34b6-197">[ [SQL Server 2008 R2 Feature Pack] ページ](https://www.microsoft.com/download/details.aspx?id=44272)で Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 r2 を見つけます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-197">On the [SQL Server 2008 R2 Feature Pack page](https://www.microsoft.com/download/details.aspx?id=44272), find Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2.</span></span>  
  
2.  <span data-ttu-id="b34b6-198">`SQLServer2008_ASOLEDB10.msi` インストール プログラムの x64 パッケージをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-198">Download the x64 Package of the `SQLServer2008_ASOLEDB10.msi` installation program.</span></span> <span data-ttu-id="b34b6-199">ファイル名には SQLServer2008 が含まれていますが、これは SQL Server 2008 R2 バージョンのプロバイダーに対応する適切なファイルです。</span><span class="sxs-lookup"><span data-stu-id="b34b6-199">Although the file name contains SQLServer2008, it is the correct file for the SQL Server 2008 R2 version of the provider.</span></span>  
  
3.  <span data-ttu-id="b34b6-200">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] がインストールされているコンピューターで、.msi を実行してライブラリをインストールします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-200">On the computer that has an installation of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], run the .msi to install the library.</span></span>  
  
4.  <span data-ttu-id="b34b6-201">Excel Services を実行しているが [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] はインストールされていないサーバーが他にファーム内にある場合は、前の手順を繰り返して 2008 R2 バージョンのプロバイダーを Excel Services コンピューターにインストールします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-201">If you have other servers in the farm that run just Excel Services, without [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] on the same server, repeat the previous steps to install the 2008 R2 version of the provider on the Excel Services computer.</span></span>  
  
#### <a name="step-2-register-the-microsoftanalysisserviceschanneltransportdll-file"></a><span data-ttu-id="b34b6-202">手順 2: Microsoft.AnalysisServices.ChannelTransport.dll ファイルの登録</span><span class="sxs-lookup"><span data-stu-id="b34b6-202">Step 2: Register the Microsoft.AnalysisServices.ChannelTransport.dll file</span></span>  
  
1.  <span data-ttu-id="b34b6-203">regasm.exe ユーティリティを使用してファイルを登録します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-203">Use the regasm.exe utility to register the file.</span></span> <span data-ttu-id="b34b6-204">以前に regasm.exe を実行していない場合は、その親フォルダーの C:\Windows\Microsoft.NET\Framework64\v4.0.30319 \\ をシステムの path 変数に追加します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-204">If you have not run regasm.exe before, add its parent folder, C:\Windows\Microsoft.NET\Framework64\v4.0.30319\\, to the system path variable.</span></span>  
  
2.  <span data-ttu-id="b34b6-205">管理者権限を使用してコマンド プロンプトを開きます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-205">Open a command prompt with administrator permissions.</span></span>  
  
3.  <span data-ttu-id="b34b6-206">C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91 フォルダーに移動します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-206">Go to this folder C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span></span>  
  
4.  <span data-ttu-id="b34b6-207">次のコマンドを入力します。`regasm microsoft.analysisservices.channeltransport.dll`</span><span class="sxs-lookup"><span data-stu-id="b34b6-207">Enter the following command: `regasm microsoft.analysisservices.channeltransport.dll`</span></span>  
  
5.  <span data-ttu-id="b34b6-208">2008 R2 バージョンのプロバイダーを手動でインストールしたすべてのコンピューターについて前の手順を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-208">Repeat the previous steps for any computer on which you manually installed the 2008 R2 version of the provider.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="b34b6-209">インストールの確認</span><span class="sxs-lookup"><span data-stu-id="b34b6-209">Verify installation</span></span>  
  
1.  <span data-ttu-id="b34b6-210">これで、[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] のブックのスライスまたはフィルター処理を行うことができるようになります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-210">You should now be able to slice or filter [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks.</span></span> <span data-ttu-id="b34b6-211">エラーが発生した場合は、64 ビット版の regasm.exe を使用してファイルを登録したことを確認します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-211">If an error occurs, verify that you used the 64-bit version of regasm.exe to register the file.</span></span>  
  
2.  <span data-ttu-id="b34b6-212">さらに、ファイルのバージョンを確認することができます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-212">Additionally, you can check the file version.</span></span>  
  
     <span data-ttu-id="b34b6-213">`C:\Program files\Microsoft Analysis Services\AS OLEDB\10` にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-213">Go to `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span></span> <span data-ttu-id="b34b6-214">**msolap100.dll**を右クリックし、[**プロパティ**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="b34b6-214">Right-click **msolap100.dll** and select **Properties**.</span></span> <span data-ttu-id="b34b6-215">**[詳細]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="b34b6-215">Click **Details**.</span></span>  
  
     <span data-ttu-id="b34b6-216">ファイルのバージョン情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="b34b6-216">View the file version information.</span></span> <span data-ttu-id="b34b6-217">バージョンには 10.50. が含まれている必要が \<buildnumber> あります。</span><span class="sxs-lookup"><span data-stu-id="b34b6-217">The version should include 10.50.\<buildnumber>.</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="b34b6-218">参照</span><span class="sxs-lookup"><span data-stu-id="b34b6-218">See Also</span></span>  
 [<span data-ttu-id="b34b6-219">PowerPivot for SharePoint 2010 のインストール</span><span class="sxs-lookup"><span data-stu-id="b34b6-219">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
  
  
