---
title: SQL Server のアクセスを許可するための Windows ファイアウォールの構成 | Microsoft Docs
ms.custom: ''
ms.date: 06/22/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- Windows Firewall ports
- WMI firewall ports
- Windows Firewall [Database Engine]
- firewall systems, configuring
- advfirewall
- firewall systems
- rules firewall
- firewall systems, overview and port list
- 1433 TCP port
- portopening using netsh
- ports [SQL Server], TCP
- netsh to open firewall ports
ms.assetid: f55c6a0e-b6bd-4803-b51a-f3a419803024
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: d1a0bc32040fc90e5f73faa708f314722bc8f3b5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634243"
---
# <a name="configure-the-windows-firewall-to-allow-sql-server-access"></a><span data-ttu-id="5ced0-102">Configure the Windows Firewall to Allow SQL Server Access</span><span class="sxs-lookup"><span data-stu-id="5ced0-102">Configure the Windows Firewall to Allow SQL Server Access</span></span>
  <span data-ttu-id="5ced0-103">ファイアウォール システムは、コンピューター リソースへの不正アクセスを防ぐのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-103">Firewall systems help prevent unauthorized access to computer resources.</span></span> <span data-ttu-id="5ced0-104">ファイアウォールがオンになっているが、正しく構成されていない場合、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] への接続の試行がブロックされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-104">If a firewall is turned on but not correctly configured, attempts to connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might be blocked.</span></span>  
  
 <span data-ttu-id="5ced0-105">ファイアウォールを経由して [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスにアクセスするには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] を実行しているコンピューターで、アクセスを許可するようにファイアウォールを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-105">To access an instance of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] through a firewall, you must configure the firewall on the computer that is running [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to allow access.</span></span> <span data-ttu-id="5ced0-106">ファイアウォールは [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows のコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-106">The firewall is a component of [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span></span> <span data-ttu-id="5ced0-107">他社製のファイアウォール プログラムをインストールすることもできます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-107">You can also install a firewall from another company.</span></span> <span data-ttu-id="5ced0-108">このトピックでは、Windows ファイアウォールを構成する方法について説明しますが、基本的な原則は他のファイアウォール プログラムにも適用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-108">This topic discusses how to configure the Windows firewall, but the basic principles apply to other firewall programs.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5ced0-109">このトピックでは、ファイアウォール構成の概要について説明し、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理者を対象とした情報がまとめられています。</span><span class="sxs-lookup"><span data-stu-id="5ced0-109">This topic provides an overview of firewall configuration and summarizes information of interest to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] administrator.</span></span> <span data-ttu-id="5ced0-110">ファイアウォールの詳細および管理ファイアウォール情報については、「 [セキュリティが強化された Windows ファイアウォールの設計ガイド](https://go.microsoft.com/fwlink/?LinkID=116904)」などのファイアウォールのマニュアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-110">For more information about the firewall and for authoritative firewall information, see the firewall documentation, such as [Windows Firewall with Advanced Security and IPsec](https://go.microsoft.com/fwlink/?LinkID=116904).</span></span>  
  
 <span data-ttu-id="5ced0-111">コントロール パネルの **[Windows ファイアウォール]** と、セキュリティが強化された Windows ファイアウォールの Microsoft 管理コンソール (MMC) スナップインの操作に慣れているユーザーや、どのファイアウォール設定を構成するかがわかっているユーザーは、次の一覧にあるトピックに直接進んでください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-111">Users familiar with the **Windows Firewall** item in Control Panel and with the Windows Firewall with Advanced Security Microsoft Management Console (MMC) snap-in and who know which firewall settings they want to configure can move directly to the topics in the following list:</span></span>  
  
-   [<span data-ttu-id="5ced0-112">データベース エンジン アクセスを有効にするための Windows ファイアウォールを構成する</span><span class="sxs-lookup"><span data-stu-id="5ced0-112">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
-   [<span data-ttu-id="5ced0-113">Analysis Services のアクセスを許可するための Windows ファイアウォールの構成</span><span class="sxs-lookup"><span data-stu-id="5ced0-113">Configure the Windows Firewall to Allow Analysis Services Access</span></span>](../../../2014/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [<span data-ttu-id="5ced0-114">レポート サーバー アクセスに対するファイアウォールの構成</span><span class="sxs-lookup"><span data-stu-id="5ced0-114">Configure a Firewall for Report Server Access</span></span>](../../reporting-services/report-server/configure-a-firewall-for-report-server-access.md)  
  

  
##  <a name="basic-firewall-information"></a><a name="BKMK_basic"></a> <span data-ttu-id="5ced0-115">ファイアウォールに関する基本情報</span><span class="sxs-lookup"><span data-stu-id="5ced0-115">Basic Firewall Information</span></span>  
 <span data-ttu-id="5ced0-116">ファイアウォールは、受信パケットを調べて一連のルールと比較することによって機能します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-116">Firewalls work by inspecting incoming packets, and comparing them against a set of rules.</span></span> <span data-ttu-id="5ced0-117">ルールでパケットの使用が許可されている場合、パケットはファイアウォールを通過して TCP/IP プロトコルに渡され、さらに処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-117">If the rules allow the packet, the firewall passes the packet to the TCP/IP protocol for additional processing.</span></span> <span data-ttu-id="5ced0-118">ルールでパケットの使用が許可されていない場合は、ファイアウォールでパケットが破棄され、ログ記録が有効になっている場合は、ファイアウォール ログ ファイルにエントリが作成されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-118">If the rules do not allow the packet, the firewall discards the packet and, if logging is enabled, creates an entry in the firewall logging file.</span></span>  
  
 <span data-ttu-id="5ced0-119">次のいずれかの方法で、許可されたトラフィックの一覧が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-119">The list of allowed traffic is populated in one of the following ways:</span></span>  
  
-   <span data-ttu-id="5ced0-120">ファイアウォールが有効になっているコンピューターで通信が開始されると、それに対する応答が許可されるようにファイアウォールによって一覧内にエントリが作成されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-120">When the computer that has the firewall enabled initiates communication, the firewall creates an entry in the list so that the response is allowed.</span></span> <span data-ttu-id="5ced0-121">受信した応答は、要請されたトラフィックと見なされるので、この応答を構成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-121">The incoming response is considered solicited traffic and you do not have to configure this.</span></span>  
  
-   <span data-ttu-id="5ced0-122">管理者がファイアウォールの例外を構成します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-122">An administrator configures exceptions to the firewall.</span></span> <span data-ttu-id="5ced0-123">これにより、コンピューターで実行されている指定したプログラムへのアクセス、またはコンピューター上の指定した接続ポートへのアクセスが許可されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-123">This allows either access to specified programs running on your computer, or access to specified connection ports on your computer.</span></span> <span data-ttu-id="5ced0-124">この場合、サーバー、リスナー、またはピアとして機能しているコンピューターは、要請されていない受信トラフィックを受け入れます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-124">In this case, the computer accepts unsolicited incoming traffic when acting as a server, a listener, or a peer.</span></span> <span data-ttu-id="5ced0-125">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]に接続するには、この種類の構成を完了している必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-125">This is the type of configuration that must be completed to connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="5ced0-126">ファイアウォール戦略の選択は、特定のポートを開くか閉じるかを単に決定するよりも複雑です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-126">Choosing a firewall strategy is more complex than just deciding if a given port should be open or closed.</span></span> <span data-ttu-id="5ced0-127">企業に合ったファイアウォール戦略を策定するときは、必ず使用できるすべてのルールと構成オプションについて検討してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-127">When designing a firewall strategy for your enterprise, make sure that you consider all the rules and configuration options available to you.</span></span> <span data-ttu-id="5ced0-128">このトピックでは、可能なファイアウォール オプションすべてを検討するわけではありません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-128">This topic does not review all the possible firewall options.</span></span> <span data-ttu-id="5ced0-129">次のドキュメントを確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-129">We recommend that you review the following documents:</span></span>  
  
 [<span data-ttu-id="5ced0-130">セキュリティが強化された Windows ファイアウォール ファースト ステップ ガイド</span><span class="sxs-lookup"><span data-stu-id="5ced0-130">Windows Firewall with Advanced Security Getting Started Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=116080)  
  
 [<span data-ttu-id="5ced0-131">セキュリティが強化された Windows ファイアウォールの設計ガイド</span><span class="sxs-lookup"><span data-stu-id="5ced0-131">Windows Firewall with Advanced Security Design Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=116904)  
  
 [<span data-ttu-id="5ced0-132">サーバーとドメインの分離の概要</span><span class="sxs-lookup"><span data-stu-id="5ced0-132">Introduction to Server and Domain Isolation</span></span>](https://go.microsoft.com/fwlink/?LinkId=116081)  
  
##  <a name="default-firewall-settings"></a><a name="BKMK_default"></a> <span data-ttu-id="5ced0-133">既定のファイアウォール設定</span><span class="sxs-lookup"><span data-stu-id="5ced0-133">Default Firewall Settings</span></span>  
 <span data-ttu-id="5ced0-134">ファイアウォール構成を計画するには、まずオペレーティング システムのファイアウォールについて現在の状態を確認します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-134">The first step in planning your firewall configuration is to determine the current status of the firewall for your operating system.</span></span> <span data-ttu-id="5ced0-135">オペレーティング システムが前のバージョンからアップグレードされた場合、以前のファイアウォール設定が維持されている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-135">If the operating system was upgraded from a previous version, the earlier firewall settings may have been preserved.</span></span> <span data-ttu-id="5ced0-136">また、他の管理者やドメイン内のグループ ポリシーによってファイアウォール設定が変更された可能性もあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-136">Also, the firewall settings could have been changed by another administrator or by a Group Policy in your domain.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5ced0-137">ファイアウォールをオンにすると、ファイルとプリンターの共有やリモート デスクトップ接続など、このコンピューターにアクセスする他のプログラムに影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-137">Turning on the firewall will affect other programs that access this computer, such as file and print sharing, and remote desktop connections.</span></span> <span data-ttu-id="5ced0-138">管理者はファイアウォール設定を調整する前に、コンピューターで実行されているすべてのアプリケーションについて検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-138">Administrators should consider all applications that are running on the computer before adjusting the firewall settings.</span></span>  
  
##  <a name="programs-to-configure-the-firewall"></a><a name="BKMK_programs"></a> <span data-ttu-id="5ced0-139">ファイアウォールを構成するためのプログラム</span><span class="sxs-lookup"><span data-stu-id="5ced0-139">Programs to Configure the Firewall</span></span>  
 <span data-ttu-id="5ced0-140">Windows ファイアウォールの設定を構成するには、次の 3 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-140">There are three ways to configure the Windows Firewall settings.</span></span>  
  
-   <span data-ttu-id="5ced0-141">**コントロール パネルの [Windows ファイアウォール]**</span><span class="sxs-lookup"><span data-stu-id="5ced0-141">**Windows Firewall item in Control Panel**</span></span>  
  
     <span data-ttu-id="5ced0-142">**[Windows ファイアウォール]** は、コントロール パネルから開くことができます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-142">The **Windows Firewall** item can be opened from Control Panel.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="5ced0-143">コントロール パネルの **[Windows ファイアウォール]** で行った変更は、現在のプロファイルにのみ影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-143">Changes made in the **Windows Firewall** item in Control Panel only affect the current profile.</span></span> <span data-ttu-id="5ced0-144">ラップトップなどのモバイル デバイスでは、別の設定で接続されるときにプロファイルが変更される可能性があるので、コントロール パネルの **[Windows ファイアウォール]** は使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-144">Mobile devices, for example a laptop, should not use the **Windows Firewall** item in Control Panel as the profile might change when it is connected in a different configuration.</span></span> <span data-ttu-id="5ced0-145">以前に構成されたプロファイルには影響を及ぼしません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-145">Then the previously-configured profile will not be in effect.</span></span> <span data-ttu-id="5ced0-146">プロファイルの詳細については、「 [セキュリティが強化された Windows ファイアウォール ファースト ステップ ガイド](https://go.microsoft.com/fwlink/?LinkId=116080)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-146">For more information about profiles, see [Windows Firewall with Advanced Security Getting Started Guide](https://go.microsoft.com/fwlink/?LinkId=116080).</span></span>  
  
     <span data-ttu-id="5ced0-147">コントロール パネルの **[Windows ファイアウォール]** で基本的なオプションを構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-147">The **Windows Firewall** item in Control Panel allows you to configure basic options.</span></span> <span data-ttu-id="5ced0-148">コーディネートは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-148">These include the following:</span></span>  
  
    -   <span data-ttu-id="5ced0-149">コントロール パネルの **[Windows ファイアウォール]** のオンとオフを切り替える</span><span class="sxs-lookup"><span data-stu-id="5ced0-149">Turning the **Windows Firewall** item in Control Panel on or off</span></span>  
  
    -   <span data-ttu-id="5ced0-150">ルールを有効または無効にする</span><span class="sxs-lookup"><span data-stu-id="5ced0-150">Enabling and disabling rules</span></span>  
  
    -   <span data-ttu-id="5ced0-151">ポートおよびプログラムの例外を許可する</span><span class="sxs-lookup"><span data-stu-id="5ced0-151">Granting exceptions for ports and programs</span></span>  
  
    -   <span data-ttu-id="5ced0-152">一部のスコープの制限を設定する</span><span class="sxs-lookup"><span data-stu-id="5ced0-152">Setting some scope restrictions</span></span>  
  
     <span data-ttu-id="5ced0-153">コントロール パネルの **[Windows ファイアウォール]** は、ファイアウォールの構成に慣れていないユーザーや、モバイル デバイスでないコンピューターに基本的なファイアウォール オプションを構成するユーザーに最適です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-153">The **Windows Firewall** item in Control Panel is most appropriate for users who are not experienced in firewall configuration, and who are configuring basic firewall options for computers that are not mobile.</span></span> <span data-ttu-id="5ced0-154">次の手順に従って、コマンドからコントロールパネルの [ **Windows ファイアウォール**] を開くこともでき `run` ます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-154">You can also open the **Windows Firewall** item in Control Panel from the `run` command by using the following procedure:</span></span>  
  
    #### <a name="to-open-the-windows-firewall-item"></a><span data-ttu-id="5ced0-155">[Windows ファイアウォール] を開くには</span><span class="sxs-lookup"><span data-stu-id="5ced0-155">To open the Windows Firewall item</span></span>  
  
    1.  <span data-ttu-id="5ced0-156">**[スタート]** ボタンをクリックし、 **[ファイル名を指定して実行]** をクリックして、「 `firewall.cpl`」と入力します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-156">On the **Start** menu, click **Run**, and then enter `firewall.cpl`.</span></span>  
  
    2.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
-   <span data-ttu-id="5ced0-157">**Microsoft 管理コンソール (MMC)**</span><span class="sxs-lookup"><span data-stu-id="5ced0-157">**Microsoft Management Console (MMC)**</span></span>  
  
     <span data-ttu-id="5ced0-158">セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用して、詳細なファイアウォール設定を構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-158">The Windows Firewall with Advanced Security MMC snap-in lets you configure more advanced firewall settings.</span></span> <span data-ttu-id="5ced0-159">このスナップインは、ほとんどのファイアウォール オプションが使いやすい形式で表示され、すべてのファイアウォール プロファイルが提供されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-159">This snap-in presents most of the firewall options in an easy-to-use manner, and presents all firewall profiles.</span></span> <span data-ttu-id="5ced0-160">詳細については、後の「 [セキュリティが強化された Windows ファイアウォールのスナップインの使用](#BKMK_WF_msc) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-160">For more information, see [Using the Windows Firewall with Advanced Security Snap-in](#BKMK_WF_msc) later in this topic.</span></span>  
  
-   <span data-ttu-id="5ced0-161">**netsh**</span><span class="sxs-lookup"><span data-stu-id="5ced0-161">**netsh**</span></span>  
  
     <span data-ttu-id="5ced0-162">**netsh.exe** ツールを使用して、管理者はコマンド プロンプトまたはバッチ ファイルで Windows ベースのコンピューターの構成および監視を行うことができます **。**</span><span class="sxs-lookup"><span data-stu-id="5ced0-162">The **netsh.exe** tool can be used by an administrator to configure and monitor Windows-based computers at a command prompt or using a batch file **.**</span></span> <span data-ttu-id="5ced0-163">**netsh** ツールを使用すれば、入力したコンテキスト コマンドを適切なヘルパーに渡し、ヘルパーによってコマンドを実行できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-163">By using the **netsh** tool, you can direct the context commands you enter to the appropriate helper, and the helper then performs the command.</span></span> <span data-ttu-id="5ced0-164">ヘルパーは、1 つ以上のサービス、ユーティリティ、またはプロトコルの構成、監視、サポートを行って **netsh** ツールの機能を拡張するダイナミック リンク ライブラリ (.dll) ファイルです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-164">A helper is a Dynamic Link Library (.dll) file that extends the functionality of the **netsh** tool by providing configuration, monitoring, and support for one or more services, utilities, or protocols.</span></span> <span data-ttu-id="5ced0-165">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] をサポートしているすべてのオペレーティング システムには、ファイアウォール ヘルパーが組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="5ced0-165">All operating systems that support [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] have a firewall helper.</span></span> [!INCLUDE[firstref_longhorn](../../includes/firstref-longhorn-md.md)] <span data-ttu-id="5ced0-166">には、 **advfirewall**という高度なファイアウォール ヘルパーも組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="5ced0-166">also has an advanced firewall helper called **advfirewall**.</span></span> <span data-ttu-id="5ced0-167">**netsh** の使用方法の詳細については、このトピックでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-167">The details of using **netsh** are not discussed in this topic.</span></span> <span data-ttu-id="5ced0-168">ただし、このトピックで説明する構成オプションの多くは、 **netsh**を使用して構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-168">However, many of the configuration options described can be configured by using **netsh**.</span></span> <span data-ttu-id="5ced0-169">たとえば、コマンド プロンプトで次のスクリプトを実行すると、TCP ポート 1433 を開くことができます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-169">For example, run the following script at a command prompt to open TCP port 1433:</span></span>  
  
    ```  
    netsh firewall set portopening protocol = TCP port = 1433 name = SQLPort mode = ENABLE scope = SUBNET profile = CURRENT  
    ```  
  
     <span data-ttu-id="5ced0-170">セキュリティを強化するための Windows ファイアウォール ヘルパーを使用した同様の例</span><span class="sxs-lookup"><span data-stu-id="5ced0-170">A similar example using the Windows Firewall for Advanced Security helper:</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name = SQLPort dir = in protocol = tcp action = allow localport = 1433 remoteip = localsubnet profile = DOMAIN  
    ```  
  
     <span data-ttu-id="5ced0-171">**netsh**の詳細については、次のリンクを参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-171">For more information about **netsh**, see the following links:</span></span>  
  
    -   [<span data-ttu-id="5ced0-172">Netsh.exe ツールとコマンド ライン スイッチの使用方法</span><span class="sxs-lookup"><span data-stu-id="5ced0-172">How to Use the Netsh.exe Tool and Command-Line Switches</span></span>](https://support.microsoft.com/kb/242468)  
  
    -   [<span data-ttu-id="5ced0-173">"netsh firewall" コンテキストの代わりに "netsh advfirewall firewall" コンテキストを使用して、Windows Server 2008 および Windows Vista で Windows ファイアウォールの動作を制御する方法</span><span class="sxs-lookup"><span data-stu-id="5ced0-173">How to use the "netsh advfirewall firewall" context instead of the "netsh firewall" context to control Windows Firewall behavior in Windows Server 2008 and in Windows Vista</span></span>](https://support.microsoft.com/kb/947709)  
  
    -   [<span data-ttu-id="5ced0-174">"profile=all" パラメーターと共に "netsh firewall" コマンドを使用しても、Windows Vista ベースのコンピューターでパブリック プロファイルが構成されない</span><span class="sxs-lookup"><span data-stu-id="5ced0-174">The "netsh firewall" command together with the "profile=all" parameter does not configure the public profile on a Windows Vista-based computer</span></span>](https://support.microsoft.com/kb/947213)  
  
## <a name="ports-used-by-ssnoversion"></a><span data-ttu-id="5ced0-175">で使用されるポート [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5ced0-175">Ports Used By [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>  
 <span data-ttu-id="5ced0-176">次の表で、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]で使用されるポートを確認できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-176">The following tables can help you identify the ports being used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
###  <a name="ports-used-by-the-database-engine"></a><a name="BKMK_ssde"></a> <span data-ttu-id="5ced0-177">Ports Used By the Database Engine</span><span class="sxs-lookup"><span data-stu-id="5ced0-177">Ports Used By the Database Engine</span></span>  
 <span data-ttu-id="5ced0-178">次の表に、 [!INCLUDE[ssDE](../../includes/ssde-md.md)]で頻繁に使用されるポートの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-178">The following table lists the ports that are frequently used by the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>  
  
|<span data-ttu-id="5ced0-179">シナリオ</span><span class="sxs-lookup"><span data-stu-id="5ced0-179">Scenario</span></span>|<span data-ttu-id="5ced0-180">Port</span><span class="sxs-lookup"><span data-stu-id="5ced0-180">Port</span></span>|<span data-ttu-id="5ced0-181">説明</span><span class="sxs-lookup"><span data-stu-id="5ced0-181">Comments</span></span>|  
|--------------|----------|--------------|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-182">の既定のインスタンス</span><span class="sxs-lookup"><span data-stu-id="5ced0-182">default instance running over TCP</span></span>|<span data-ttu-id="5ced0-183">TCP ポート 1433</span><span class="sxs-lookup"><span data-stu-id="5ced0-183">TCP port 1433</span></span>|<span data-ttu-id="5ced0-184">これは、ファイアウォールを通過することを許可されている最も一般的なポートです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-184">This is the most common port allowed through the firewall.</span></span> <span data-ttu-id="5ced0-185">[!INCLUDE[ssDE](../../includes/ssde-md.md)]の既定のインストール、またはコンピューターで実行中の唯一のインスタンスである名前付きインスタンスへの、通常の接続に適用されます</span><span class="sxs-lookup"><span data-stu-id="5ced0-185">It applies to routine connections to the default installation of the [!INCLUDE[ssDE](../../includes/ssde-md.md)], or a named instance that is the only instance running on the computer.</span></span> <span data-ttu-id="5ced0-186">(名前付きインスタンスには注意事項があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-186">(Named instances have special considerations.</span></span> <span data-ttu-id="5ced0-187">このトピックで後述する「[動的ポート](#BKMK_dynamic_ports)」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="5ced0-187">See [Dynamic Ports](#BKMK_dynamic_ports) later in this topic.)</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-188">名前付きインスタンス</span><span class="sxs-lookup"><span data-stu-id="5ced0-188">named instances in the default configuration</span></span>|<span data-ttu-id="5ced0-189">TCP ポートは、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] の起動時に決定される動的ポートです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-189">The TCP port is a dynamic port determined at the time the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts.</span></span>|<span data-ttu-id="5ced0-190">後の「 [動的ポート](#BKMK_dynamic_ports)」の説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-190">See the discussion below in the section [Dynamic Ports](#BKMK_dynamic_ports).</span></span> <span data-ttu-id="5ced0-191">名前付きインスタンスを使用している場合、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser サービスで UDP ポート 1434 が必要になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-191">UDP port 1434 might be required for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser Service when you are using named instances.</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-192">名前付きインスタンス</span><span class="sxs-lookup"><span data-stu-id="5ced0-192">named instances when they are configured to use a fixed port</span></span>|<span data-ttu-id="5ced0-193">管理者が構成するポート番号</span><span class="sxs-lookup"><span data-stu-id="5ced0-193">The port number configured by the administrator.</span></span>|<span data-ttu-id="5ced0-194">後の「 [動的ポート](#BKMK_dynamic_ports)」の説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-194">See the discussion below in the section [Dynamic Ports](#BKMK_dynamic_ports).</span></span>|  
|<span data-ttu-id="5ced0-195">専用管理者接続</span><span class="sxs-lookup"><span data-stu-id="5ced0-195">Dedicated Admin Connection</span></span>|<span data-ttu-id="5ced0-196">TCP ポート 1434 (既定のインスタンスに使用)。</span><span class="sxs-lookup"><span data-stu-id="5ced0-196">TCP port 1434 for the default instance.</span></span> <span data-ttu-id="5ced0-197">その他のポートは名前付きインスタンスに使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-197">Other ports are used for named instances.</span></span> <span data-ttu-id="5ced0-198">ポート番号については、エラー ログを確認してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-198">Check the error log for the port number.</span></span>|<span data-ttu-id="5ced0-199">既定では、専用管理者接続 (DAC) へのリモート接続は有効になっていません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-199">By default, remote connections to the Dedicated Administrator Connection (DAC) are not enabled.</span></span> <span data-ttu-id="5ced0-200">リモート DAC を有効にするには、セキュリティ構成ファセットを使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-200">To enable remote DAC, use the Surface Area Configuration facet.</span></span> <span data-ttu-id="5ced0-201">詳細については、「 [Surface Area Configuration](../../relational-databases/security/surface-area-configuration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-201">For more information, see [Surface Area Configuration](../../relational-databases/security/surface-area-configuration.md).</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-202">Browser サービス</span><span class="sxs-lookup"><span data-stu-id="5ced0-202">Browser service</span></span>|<span data-ttu-id="5ced0-203">UDP ポート 1434</span><span class="sxs-lookup"><span data-stu-id="5ced0-203">UDP port 1434</span></span>|<span data-ttu-id="5ced0-204">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser サービスは、名前付きインスタンスへの着信接続をリッスンし、その名前付きインスタンスに対応する TCP ポート番号をクライアントに提供します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-204">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service listens for incoming connections to a named instance and provides the client the TCP port number that corresponds to that named instance.</span></span> <span data-ttu-id="5ced0-205">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の名前付きインスタンスが使用されている場合は、通常 [!INCLUDE[ssDE](../../includes/ssde-md.md)] Browser サービスを開始します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-205">Normally the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service is started whenever named instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] are used.</span></span> <span data-ttu-id="5ced0-206">名前付きインスタンスの特定のポートに接続するようにクライアントが構成されている場合は、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser サービスを開始する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-206">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service does not have to be started if the client is configured to connect to the specific port of the named instance.</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-207">インスタンス</span><span class="sxs-lookup"><span data-stu-id="5ced0-207">instance running over an HTTP endpoint.</span></span>|<span data-ttu-id="5ced0-208">HTTP エンドポイントの作成時に指定できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-208">Can be specified when an HTTP endpoint is created.</span></span> <span data-ttu-id="5ced0-209">既定の TCP ポートは、CLEAR_PORT トラフィックでは 80、SSL_PORT トラフィックでは 443 です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-209">The default is TCP port 80 for CLEAR_PORT traffic and 443 for SSL_PORT traffic.</span></span>|<span data-ttu-id="5ced0-210">URL を使用した HTTP 接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-210">Used for an HTTP connection through a URL.</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-211">の既定のインスタンス</span><span class="sxs-lookup"><span data-stu-id="5ced0-211">default instance running over an HTTPS endpoint.</span></span>|<span data-ttu-id="5ced0-212">TCP ポート 443</span><span class="sxs-lookup"><span data-stu-id="5ced0-212">TCP port 443</span></span>|<span data-ttu-id="5ced0-213">URL を使用した HTTPS 接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-213">Used for an HTTPS connection through a URL.</span></span> <span data-ttu-id="5ced0-214">HTTPS は、Secure Sockets Layer (SSL) を使用した HTTP 接続です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-214">HTTPS is an HTTP connection that uses secure sockets layer (SSL).</span></span>|  
|[!INCLUDE[ssSB](../../includes/sssb-md.md)]|<span data-ttu-id="5ced0-215">TCP ポート 4022。</span><span class="sxs-lookup"><span data-stu-id="5ced0-215">TCP port 4022.</span></span> <span data-ttu-id="5ced0-216">使用されるポートを確認するには、次のクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-216">To verify the port used, execute the following query:</span></span><br /><br /> `SELECT name, protocol_desc, port, state_desc`<br /><br /> `FROM sys.tcp_endpoints`<br /><br /> `WHERE type_desc = 'SERVICE_BROKER'`|<span data-ttu-id="5ced0-217">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssSB](../../includes/sssb-md.md)]の既定のポートはありませんが、これがオンライン ブックの例で使用される通常の構成です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-217">There is no default port for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssSB](../../includes/sssb-md.md)], but this is the conventional configuration used in Books Online examples.</span></span>|  
|<span data-ttu-id="5ced0-218">データベース ミラーリング</span><span class="sxs-lookup"><span data-stu-id="5ced0-218">Database Mirroring</span></span>|<span data-ttu-id="5ced0-219">管理者が選択したポート。</span><span class="sxs-lookup"><span data-stu-id="5ced0-219">Administrator chosen port.</span></span> <span data-ttu-id="5ced0-220">ポートを特定するには、次のクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-220">To determine the port, execute the following query:</span></span><br /><br /> `SELECT name, protocol_desc, port, state_desc FROM sys.tcp_endpoints`<br /><br /> `WHERE type_desc = 'DATABASE_MIRRORING'`|<span data-ttu-id="5ced0-221">データベース ミラーリング用の既定のポートはありませんが、オンライン ブックの例では TCP ポート 7022 が使用されています。</span><span class="sxs-lookup"><span data-stu-id="5ced0-221">There is no default port for database mirroring however Books Online examples use TCP port 7022.</span></span> <span data-ttu-id="5ced0-222">特に自動フェールオーバーを伴う高い安全性モードでは、使用中のミラーリング エンドポイントが中断しないようにすることはきわめて重要です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-222">It is very important to avoid interrupting an in-use mirroring endpoint, especially in high-safety mode with automatic failover.</span></span> <span data-ttu-id="5ced0-223">ファイアウォール構成によりクォーラムが分割されないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-223">Your firewall configuration must avoid breaking quorum.</span></span> <span data-ttu-id="5ced0-224">詳細については、「 [サーバー ネットワーク アドレスの指定 &#40;データベース ミラーリング&#41;](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md)を使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-224">For more information, see [Specify a Server Network Address &#40;Database Mirroring&#41;](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md).</span></span>|  
|<span data-ttu-id="5ced0-225">レプリケーション</span><span class="sxs-lookup"><span data-stu-id="5ced0-225">Replication</span></span>|<span data-ttu-id="5ced0-226">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] へのレプリケーション接続では、一般的な正規の [!INCLUDE[ssDE](../../includes/ssde-md.md)] ポートを使用します (既定のインスタンスに使用される TCP ポート 1433 など)。</span><span class="sxs-lookup"><span data-stu-id="5ced0-226">Replication connections to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] use the typical regular [!INCLUDE[ssDE](../../includes/ssde-md.md)] ports (TCP port 1433 for the default instance, etc.)</span></span><br /><br /> <span data-ttu-id="5ced0-227">レプリケーション スナップショットのための Web 同期と FTP/UNC アクセスには、ファイアウォール上で追加のポートを開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-227">Web synchronization and FTP/UNC access for replication snapshot require additional ports to be opened on the firewall.</span></span> <span data-ttu-id="5ced0-228">ある場所から別の場所に初期データおよびスキーマを転送するために、レプリケーションでは FTP (TCP ポート 21)、HTTP (TCP ポート 80) を使用した同期、またはファイル共有を使用できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-228">To transfer initial data and schema from one location to another, replication can use FTP (TCP port 21), or sync over HTTP (TCP port 80) or File Sharing.</span></span> <span data-ttu-id="5ced0-229">ファイル共有では、NetBIOS を使用する場合、UDP ポート 137 と 138、および TCP ポート 139 を使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-229">File sharing uses UDP port 137 and 138, and TCP port 139 if it using NetBIOS.</span></span> <span data-ttu-id="5ced0-230">ファイル共有は TCP ポート 445 を使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-230">File Sharing uses TCP port 445.</span></span>|<span data-ttu-id="5ced0-231">HTTP を使用した同期のために、レプリケーションでは IIS エンドポイント (既定ではポート 80 だが構成可能) を使用しますが、IIS プロセスは標準のポート (既定のインスタンスの場合は 1433) を使用してバックエンドの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に接続します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-231">For sync over HTTP, replication uses the IIS endpoint (ports for which are configurable but is port 80 by default), but the IIS process connects to the backend [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] through the standard ports (1433 for the default instance.</span></span><br /><br /> <span data-ttu-id="5ced0-232">FTP を使用した Web 同期時は、サブスクライバーと IIS の間ではなく、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 発行者と IIS の間で FTP 転送が行われます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-232">During Web synchronization using FTP, the FTP transfer is between IIS and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] publisher, not between subscriber and IIS.</span></span>|  
|[!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="5ced0-233">デバッガー</span><span class="sxs-lookup"><span data-stu-id="5ced0-233">debugger</span></span>|<span data-ttu-id="5ced0-234">TCP ポート 135</span><span class="sxs-lookup"><span data-stu-id="5ced0-234">TCP port 135</span></span><br /><br /> <span data-ttu-id="5ced0-235">「 [ポート 135 に関する注意事項](#BKMK_port_135)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-235">See [Special Considerations for Port 135](#BKMK_port_135)</span></span><br /><br /> <span data-ttu-id="5ced0-236">[IPsec](#BKMK_additional_ports) の例外が必要な場合もあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-236">The [IPsec](#BKMK_additional_ports) exception might also be required.</span></span>|<span data-ttu-id="5ced0-237">[!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]ホスト コンピューターで [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] を使用している場合は、 **Devenv.exe** を例外リストに追加し、TCP ポート 135 を開く必要もあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-237">If using [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], on the [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] host computer, you must also add **Devenv.exe** to the Exceptions list and open TCP port 135.</span></span><br /><br /> <span data-ttu-id="5ced0-238">[!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]ホスト コンピューターで [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] を使用している場合は、 **ssms.exe** を例外リストに追加し、TCP ポート 135 を開く必要もあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-238">If using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], on the [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] host computer, you must also add **ssms.exe** to the Exceptions list and open TCP port 135.</span></span> <span data-ttu-id="5ced0-239">詳細については、「 [Transact-sql デバッガーの構成](../../relational-databases/scripting/configure-firewall-rules-before-running-the-tsql-debugger.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-239">For more information, see [Configure the Transact-SQL Debugger](../../relational-databases/scripting/configure-firewall-rules-before-running-the-tsql-debugger.md).</span></span>|  
  
 <span data-ttu-id="5ced0-240">[!INCLUDE[ssDE](../../includes/ssde-md.md)]で Windows ファイアウォールを構成する詳細な手順については、「 [データベース エンジン アクセスを有効にするための Windows ファイアウォールを構成する](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-240">For step by step instructions to configure the Windows Firewall for the [!INCLUDE[ssDE](../../includes/ssde-md.md)], see [Configure a Windows Firewall for Database Engine Access](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md).</span></span>  
  
####  <a name="dynamic-ports"></a><a name="BKMK_dynamic_ports"></a> <span data-ttu-id="5ced0-241">動的ポート</span><span class="sxs-lookup"><span data-stu-id="5ced0-241">Dynamic Ports</span></span>  
 <span data-ttu-id="5ced0-242">既定では、名前付きインスタンス ( [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)]を含む) では動的ポートを使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-242">By default, named instances (including [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)]) use dynamic ports.</span></span> <span data-ttu-id="5ced0-243">したがって、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] が起動するたびに使用可能なポートが特定され、そのポート番号が使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-243">That means that every time that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts, it identifies an available port and uses that port number.</span></span> <span data-ttu-id="5ced0-244">インストールされている [!INCLUDE[ssDE](../../includes/ssde-md.md)] のインスタンスが名前付きインスタンスのみの場合、通常は TCP ポート 1433 が使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-244">If the named instance is the only instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] installed, it will probably use TCP port 1433.</span></span> <span data-ttu-id="5ced0-245">[!INCLUDE[ssDE](../../includes/ssde-md.md)] の他のインスタンスがインストールされている場合は、別の TCP ポートが使用される可能性が高くなります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-245">If other instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] are installed, it will probably use a different TCP port.</span></span> <span data-ttu-id="5ced0-246">選択されたポートは、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] が起動するたびに変わる可能性があるので、正しいポート番号にアクセスできるようにファイアウォールを構成することは容易ではありません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-246">Because the port selected might change every time that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is started, it is difficult to configure the firewall to enable access to the correct port number.</span></span> <span data-ttu-id="5ced0-247">したがって、ファイアウォールを使用する場合は、毎回同じポート番号を使用するように [!INCLUDE[ssDE](../../includes/ssde-md.md)] を再構成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-247">Therefore, if a firewall is used, we recommend reconfiguring the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to use the same port number every time.</span></span> <span data-ttu-id="5ced0-248">このポートを固定ポートまたは静的なポートと呼びます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-248">This is called a fixed port or a static port.</span></span> <span data-ttu-id="5ced0-249">詳細については、「[特定の TCP ポートで受信待ちするようにサーバーを構成する方法 &#40;SQL Server 構成マネージャー&#41;](../../database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-249">For more information, see [Configure a Server to Listen on a Specific TCP Port &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md).</span></span>  
  
 <span data-ttu-id="5ced0-250">固定ポートでリッスンするように名前付きインスタンスを構成する代わりに、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sqlservr.exe **(** ) などの [!INCLUDE[ssDE](../../includes/ssde-md.md)]プログラムを対象としてファイアウォールで例外を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-250">An alternative to configuring a named instance to listen on a fixed port is to create an exception in the firewall for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] program such as **sqlservr.exe** (for the [!INCLUDE[ssDE](../../includes/ssde-md.md)]).</span></span> <span data-ttu-id="5ced0-251">この方法が有効な場合もありますが、セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用しているときは、 **[受信の規則]** ページの **[ローカル ポート]** 列にポート番号が表示されません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-251">This can be convenient, but the port number will not appear in the **Local Port** column of the **Inbound Rules** page when you are using the Windows Firewall with Advanced Security MMC snap-in.</span></span> <span data-ttu-id="5ced0-252">そのため、どのポートが開いているかを調べるのが難しくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-252">This can make it more difficult to audit which ports are open.</span></span> <span data-ttu-id="5ced0-253">もう 1 つの注意事項は、Service Pack または累積された更新によって [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 実行可能ファイルへのパスが変更され、ファイアウォールのルールが無効になる可能性があるということです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-253">Another consideration is that a service pack or cumulative update can change the path to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] executable which will invalidate the firewall rule.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5ced0-254">次の手順では、コントロール パネルの **[Windows ファイアウォール]** を使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-254">The following procedure uses the **Windows Firewall** item in Control Panel.</span></span> <span data-ttu-id="5ced0-255">セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用して、より複雑なルールを構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-255">The Windows Firewall with Advanced Security MMC snap-in can configure a more complex rule.</span></span> <span data-ttu-id="5ced0-256">その場合は、サービスの例外の設定も行います。これは、多層防御を実装する場合に有効です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-256">This includes configuring a service exception which can be useful for providing defense in depth.</span></span> <span data-ttu-id="5ced0-257">後の「 [セキュリティが強化された Windows ファイアウォールのスナップインの使用](#BKMK_WF_msc) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-257">See [Using the Windows Firewall with Advanced Security Snap-in](#BKMK_WF_msc) below.</span></span>  
  
###### <a name="to-add-a-program-exception-to-the-firewall-using-the-windows-firewall-item-in-control-panel"></a><span data-ttu-id="5ced0-258">コントロール パネルの [Windows ファイアウォール] を使用して、ファイアウォールにプログラムの例外を追加するには</span><span class="sxs-lookup"><span data-stu-id="5ced0-258">To add a program exception to the firewall using the Windows Firewall item in Control Panel.</span></span>  
  
1.  <span data-ttu-id="5ced0-259">コントロール パネルの **[Windows ファイアウォール]** の **[例外]** タブをクリックし、 **[プログラムの追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-259">On the **Exceptions** tab of the **Windows Firewall** item in Control Panel, click **Add a program**.</span></span>  
  
2.  <span data-ttu-id="5ced0-260">ファイアウォール経由で許可するのインスタンスの場所を参照します。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] たとえば、 **C:\PROGRAM Server\MSSQL12. SQL <instance_name> \mssql\binn**、[ **sqlservr.exe**] の順に選択し、[**開く**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-260">Browse to the location of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that you want to allow through the firewall, for example **C:\Program Files\Microsoft SQL Server\MSSQL12.<instance_name>\MSSQL\Binn**, select **sqlservr.exe**, and then click **Open**.</span></span>  
  
3.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
 <span data-ttu-id="5ced0-261">エンドポイントの詳細については、「[複数の TCP ポートでリッスンするデータベース エンジンの構成](../../database-engine/configure-windows/configure-the-database-engine-to-listen-on-multiple-tcp-ports.md)」と「[エンドポイントのカタログ ビュー &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/endpoints-catalog-views-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-261">For more information about endpoints, see [Configure the Database Engine to Listen on Multiple TCP Ports](../../database-engine/configure-windows/configure-the-database-engine-to-listen-on-multiple-tcp-ports.md) and [Endpoints Catalog Views &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/endpoints-catalog-views-transact-sql).</span></span>  
  
###  <a name="ports-used-by-analysis-services"></a><a name="BKMK_ssas"></a> <span data-ttu-id="5ced0-262">Analysis Services で使用されるポート</span><span class="sxs-lookup"><span data-stu-id="5ced0-262">Ports Used By Analysis Services</span></span>  
 <span data-ttu-id="5ced0-263">次の表に、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]で頻繁に使用されるポートの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-263">The following table lists the ports that are frequently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
|<span data-ttu-id="5ced0-264">機能</span><span class="sxs-lookup"><span data-stu-id="5ced0-264">Feature</span></span>|<span data-ttu-id="5ced0-265">Port</span><span class="sxs-lookup"><span data-stu-id="5ced0-265">Port</span></span>|<span data-ttu-id="5ced0-266">説明</span><span class="sxs-lookup"><span data-stu-id="5ced0-266">Comments</span></span>|  
|-------------|----------|--------------|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]|<span data-ttu-id="5ced0-267">TCP ポート 2383 (既定のインスタンスに使用)</span><span class="sxs-lookup"><span data-stu-id="5ced0-267">TCP port 2383 for the default instance</span></span>|<span data-ttu-id="5ced0-268">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]の既定のインスタンスに使用される標準ポートです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-268">The standard port for the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-269">Browser サービス</span><span class="sxs-lookup"><span data-stu-id="5ced0-269">Browser service</span></span>|<span data-ttu-id="5ced0-270">TCP ポート 2382 ( [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] の名前付きインスタンスにのみ必要)</span><span class="sxs-lookup"><span data-stu-id="5ced0-270">TCP port 2382 only needed for an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instance</span></span>|<span data-ttu-id="5ced0-271">ポート番号を指定せずに [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] の名前付きインスタンスに対してクライアントが接続要求を行うと、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser がリッスンするポート 2382 が指定されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-271">Client connection requests for a named instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] that do not specify a port number are directed to port 2382, the port on which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser listens.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-272">Browser は、名前付きインスタンスが使用するポートに要求をリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-272">Browser then redirects the request to the port that the named instance uses.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="5ced0-273">IIS/HTTP 経由で使用するように構成された</span><span class="sxs-lookup"><span data-stu-id="5ced0-273">configured for use through IIS/HTTP</span></span><br /><br /> <span data-ttu-id="5ced0-274">(PivotTable?</span><span class="sxs-lookup"><span data-stu-id="5ced0-274">(The PivotTable??</span></span> <span data-ttu-id="5ced0-275">サービスは HTTP または HTTPS を使用します)</span><span class="sxs-lookup"><span data-stu-id="5ced0-275">Service uses HTTP or HTTPS)</span></span>|<span data-ttu-id="5ced0-276">TCP ポート 80</span><span class="sxs-lookup"><span data-stu-id="5ced0-276">TCP port 80</span></span>|<span data-ttu-id="5ced0-277">URL を使用した HTTP 接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-277">Used for an HTTP connection through a URL.</span></span>|  
|[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="5ced0-278">IIS/HTTPS 経由で使用するように構成された</span><span class="sxs-lookup"><span data-stu-id="5ced0-278">configured for use through IIS/HTTPS</span></span><br /><br /> <span data-ttu-id="5ced0-279">(PivotTable?</span><span class="sxs-lookup"><span data-stu-id="5ced0-279">(The PivotTable??</span></span> <span data-ttu-id="5ced0-280">サービスは HTTP または HTTPS を使用します)</span><span class="sxs-lookup"><span data-stu-id="5ced0-280">Service uses HTTP or HTTPS)</span></span>|<span data-ttu-id="5ced0-281">TCP ポート 443</span><span class="sxs-lookup"><span data-stu-id="5ced0-281">TCP port 443</span></span>|<span data-ttu-id="5ced0-282">URL を使用した HTTPS 接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-282">Used for an HTTPS connection through a URL.</span></span> <span data-ttu-id="5ced0-283">HTTPS は、Secure Sockets Layer (SSL) を使用した HTTP 接続です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-283">HTTPS is an HTTP connection that uses secure sockets layer (SSL).</span></span>|  
  
 <span data-ttu-id="5ced0-284">ユーザーが IIS やインターネットを経由して [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] にアクセスする場合は、IIS がリッスンするポートを開き、クライアントの接続文字列にそのポートを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-284">If users access [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] through IIS and the Internet, you must open the port on which IIS is listening and specify that port in the client connection string.</span></span> <span data-ttu-id="5ced0-285">この場合、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]に直接アクセスするためのポートを開く必要はありません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-285">In this case, no ports have to be open for direct access to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="5ced0-286">必要のない他のすべてのポートと共に、既定のポート 2389 およびポート 2382 を制限する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-286">The default port 2389, and port 2382, should be restricted together with all other ports that are not required.</span></span>  
  
 <span data-ttu-id="5ced0-287">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]で Windows ファイアウォールを構成する詳細な手順については、「 [Analysis Services のアクセスを許可するための Windows ファイアウォールの構成](../../../2014/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-287">For step by step instructions to configure the Windows Firewall for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [Configure the Windows Firewall to Allow Analysis Services Access](../../../2014/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
###  <a name="ports-used-by-reporting-services"></a><a name="BKMK_ssrs"></a> <span data-ttu-id="5ced0-288">Reporting Services で使用されるポート</span><span class="sxs-lookup"><span data-stu-id="5ced0-288">Ports Used By Reporting Services</span></span>  
 <span data-ttu-id="5ced0-289">次の表に、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]で頻繁に使用されるポートの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-289">The following table lists the ports that are frequently used by [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span>  
  
|<span data-ttu-id="5ced0-290">機能</span><span class="sxs-lookup"><span data-stu-id="5ced0-290">Feature</span></span>|<span data-ttu-id="5ced0-291">Port</span><span class="sxs-lookup"><span data-stu-id="5ced0-291">Port</span></span>|<span data-ttu-id="5ced0-292">説明</span><span class="sxs-lookup"><span data-stu-id="5ced0-292">Comments</span></span>|  
|-------------|----------|--------------|  
|[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="5ced0-293">Web サービス</span><span class="sxs-lookup"><span data-stu-id="5ced0-293">Web Services</span></span>|<span data-ttu-id="5ced0-294">TCP ポート 80</span><span class="sxs-lookup"><span data-stu-id="5ced0-294">TCP port 80</span></span>|<span data-ttu-id="5ced0-295">URL を使用した [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] への HTTP 接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-295">Used for an HTTP connection to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] through a URL.</span></span> <span data-ttu-id="5ced0-296">**[World Wide Web サービス (HTTP)]** のあらかじめ構成されたルールは使用しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-296">We recommend that you do not use the preconfigured rule **World Wide Web Services (HTTP)**.</span></span> <span data-ttu-id="5ced0-297">詳細については、後の「 [その他のファイアウォール ルールの操作](#BKMK_other_rules) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-297">For more information, see the [Interaction with Other Firewall Rules](#BKMK_other_rules) section below.</span></span>|  
|[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="5ced0-298">HTTPS 経由で使用するように構成された</span><span class="sxs-lookup"><span data-stu-id="5ced0-298">configured for use through HTTPS</span></span>|<span data-ttu-id="5ced0-299">TCP ポート 443</span><span class="sxs-lookup"><span data-stu-id="5ced0-299">TCP port 443</span></span>|<span data-ttu-id="5ced0-300">URL を使用した HTTPS 接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-300">Used for an HTTPS connection through a URL.</span></span> <span data-ttu-id="5ced0-301">HTTPS は、Secure Sockets Layer (SSL) を使用した HTTP 接続です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-301">HTTPS is an HTTP connection that uses secure sockets layer (SSL).</span></span> <span data-ttu-id="5ced0-302">**[セキュア World Wide Web サービス (HTTPS)]** のあらかじめ構成されたルールは使用しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-302">We recommend that you do not use the preconfigured rule **Secure World Wide Web Services (HTTPS)**.</span></span> <span data-ttu-id="5ced0-303">詳細については、後の「 [その他のファイアウォール ルールの操作](#BKMK_other_rules) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-303">For more information, see the [Interaction with Other Firewall Rules](#BKMK_other_rules) section below.</span></span>|  
  
 <span data-ttu-id="5ced0-304">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] から [!INCLUDE[ssDE](../../includes/ssde-md.md)] または [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]のインスタンスに接続する場合、そのサービス用の適切なポートを開く必要もあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-304">When [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] connects to an instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] or [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], you must also open the appropriate ports for those services.</span></span> <span data-ttu-id="5ced0-305">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]で Windows ファイアウォールを構成する詳細な手順については、「 [レポート サーバー アクセスに対するファイアウォールの構成](../../reporting-services/report-server/configure-a-firewall-for-report-server-access.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-305">For step-by-step instructions to configure the Windows Firewall for [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], [Configure a Firewall for Report Server Access](../../reporting-services/report-server/configure-a-firewall-for-report-server-access.md).</span></span>  
  
###  <a name="ports-used-by-integration-services"></a><a name="BKMK_ssis"></a> <span data-ttu-id="5ced0-306">Integration Services で使用されるポート</span><span class="sxs-lookup"><span data-stu-id="5ced0-306">Ports Used By Integration Services</span></span>  
 <span data-ttu-id="5ced0-307">次の表に、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] サービスで使用されるポートの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-307">The following table lists the ports that are used by the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service.</span></span>  
  
|<span data-ttu-id="5ced0-308">機能</span><span class="sxs-lookup"><span data-stu-id="5ced0-308">Feature</span></span>|<span data-ttu-id="5ced0-309">Port</span><span class="sxs-lookup"><span data-stu-id="5ced0-309">Port</span></span>|<span data-ttu-id="5ced0-310">説明</span><span class="sxs-lookup"><span data-stu-id="5ced0-310">Comments</span></span>|  
|-------------|----------|--------------|  
|[!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="5ced0-311">リモート プロシージャ呼び出し (MS RPC)</span><span class="sxs-lookup"><span data-stu-id="5ced0-311">remote procedure calls (MS RPC)</span></span><br /><br /> <span data-ttu-id="5ced0-312">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] ランタイムで使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-312">Used by the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] runtime.</span></span>|<span data-ttu-id="5ced0-313">TCP ポート 135</span><span class="sxs-lookup"><span data-stu-id="5ced0-313">TCP port 135</span></span><br /><br /> <span data-ttu-id="5ced0-314">「 [ポート 135 に関する注意事項](#BKMK_port_135)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-314">See [Special Considerations for Port 135](#BKMK_port_135)</span></span>|<span data-ttu-id="5ced0-315">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] サービスでは、ポート 135 で DCOM を使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-315">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service uses DCOM on port 135.</span></span> <span data-ttu-id="5ced0-316">サービス コントロール マネージャーではポート 135 を使用して、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] サービスの開始と停止、実行中のサービスに対する制御要求の転送などのタスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-316">The Service Control Manager uses port 135 to perform tasks such as starting and stopping the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service and transmitting control requests to the running service.</span></span> <span data-ttu-id="5ced0-317">ポート番号を変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-317">The port number cannot be changed.</span></span><br /><br /> <span data-ttu-id="5ced0-318">このポートは、 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] またはカスタム アプリケーションから [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] サービスのリモート インスタンスに接続する場合にのみ、開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-318">This port is only required to be open if you are connecting to a remote instance of the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] service from [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] or a custom application.</span></span>|  
  
 <span data-ttu-id="5ced0-319">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]で Windows ファイアウォールを構成する詳細な手順については、「 [SSIS サービスにアクセスするように Windows ファイアウォールを構成する](../../../2014/integration-services/configure-a-windows-firewall-for-access-to-the-ssis-service.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-319">For step-by-step instructions to configure the Windows Firewall for [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], see [Configure a Windows Firewall for Access to the SSIS Service](../../../2014/integration-services/configure-a-windows-firewall-for-access-to-the-ssis-service.md).</span></span>  
  
###  <a name="additional-ports-and-services"></a><a name="BKMK_additional_ports"></a> <span data-ttu-id="5ced0-320">追加のポートとサービス</span><span class="sxs-lookup"><span data-stu-id="5ced0-320">Additional Ports and Services</span></span>  
 <span data-ttu-id="5ced0-321">次の表に、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] が依存している可能性があるポートとサービスの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-321">The following table lists ports and services that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might depend on.</span></span>  
  
|<span data-ttu-id="5ced0-322">シナリオ</span><span class="sxs-lookup"><span data-stu-id="5ced0-322">Scenario</span></span>|<span data-ttu-id="5ced0-323">Port</span><span class="sxs-lookup"><span data-stu-id="5ced0-323">Port</span></span>|<span data-ttu-id="5ced0-324">説明</span><span class="sxs-lookup"><span data-stu-id="5ced0-324">Comments</span></span>|  
|--------------|----------|--------------|  
|<span data-ttu-id="5ced0-325">Windows Management Instrumentation (Windows Management Instrumentation)</span><span class="sxs-lookup"><span data-stu-id="5ced0-325">Windows Management Instrumentation</span></span><br /><br /> <span data-ttu-id="5ced0-326">WMI の詳細については、「 [WMI Provider for Configuration Management Concepts](../../relational-databases/wmi-provider-configuration/wmi-provider-for-configuration-management.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-326">For more information about WMI, see [WMI Provider for Configuration Management Concepts](../../relational-databases/wmi-provider-configuration/wmi-provider-for-configuration-management.md)</span></span>|<span data-ttu-id="5ced0-327">WMI は、DCOM によってポートが割り当てられている共有サービス ホストの一部として実行されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-327">WMI runs as part of a shared service host with ports assigned through DCOM.</span></span> <span data-ttu-id="5ced0-328">WMI では TCP ポート 135 を使用している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-328">WMI might be using TCP port 135.</span></span><br /><br /> <span data-ttu-id="5ced0-329">「 [ポート 135 に関する注意事項](#BKMK_port_135)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-329">See [Special Considerations for Port 135](#BKMK_port_135)</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-330">構成マネージャーでは、WMI を使用してサービスの一覧を表示し、管理します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-330">Configuration Manager uses WMI to list and manage services.</span></span> <span data-ttu-id="5ced0-331">**[Windows Management Instrumentation (WMI)]** のあらかじめ構成されたルール グループを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-331">We recommend that you use the preconfigured rule group **Windows Management Instrumentation (WMI)**.</span></span> <span data-ttu-id="5ced0-332">詳細については、後の「 [その他のファイアウォール ルールの操作](#BKMK_other_rules) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-332">For more information, see the [Interaction with Other Firewall Rules](#BKMK_other_rules) section below.</span></span>|  
|[!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="5ced0-333">分散トランザクション コーディネーター (MS DTC)</span><span class="sxs-lookup"><span data-stu-id="5ced0-333">Distributed Transaction Coordinator (MS DTC)</span></span>|<span data-ttu-id="5ced0-334">TCP ポート 135</span><span class="sxs-lookup"><span data-stu-id="5ced0-334">TCP port 135</span></span><br /><br /> <span data-ttu-id="5ced0-335">「 [ポート 135 に関する注意事項](#BKMK_port_135)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-335">See [Special Considerations for Port 135](#BKMK_port_135)</span></span>|<span data-ttu-id="5ced0-336">アプリケーションで分散トランザクションを使用する場合は、 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 分散トランザクション コーディネーター (MS DTC) トラフィックが、各 MS DTC インスタンス間、および [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]などのリソース マネージャーと MS DTC との間を流れるように、ファイアウォールを構成することが必要になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-336">If your application uses distributed transactions, you might have to configure the firewall to allow [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) traffic to flow between separate MS DTC instances, and between the MS DTC and resource managers such as [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="5ced0-337">**[分散トランザクション コーディネーター]** のあらかじめ構成されたルール グループを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-337">We recommend that you use the preconfigured **Distributed Transaction Coordinator** rule group.</span></span><br /><br /> <span data-ttu-id="5ced0-338">個別のリソース グループのクラスター全体に対して 1 つの共有 MS DTC が構成されている場合は、ファイアウォールに sqlservr.exe を例外として追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-338">When a single shared MS DTC is configured for the entire cluster in a separate resource group you should add sqlservr.exe as an exception to the firewall.</span></span>|  
|<span data-ttu-id="5ced0-339">[!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] の参照ボタンを押すと、UDP を使用して [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser サービスに接続できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-339">The browse button in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] uses UDP to connect to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser Service.</span></span> <span data-ttu-id="5ced0-340">詳細については、「[SQL Server Browser サービス &#40;データベース エンジンと SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md)」を参照してください。参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-340">For more information, see [SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md).</span></span>|<span data-ttu-id="5ced0-341">UDP ポート 1434</span><span class="sxs-lookup"><span data-stu-id="5ced0-341">UDP port 1434</span></span>|<span data-ttu-id="5ced0-342">UDP はコネクションレスのプロトコルです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-342">UDP is a connectionless protocol.</span></span><br /><br /> <span data-ttu-id="5ced0-343">ファイアウォールには、 [INetFwProfile インターフェイスの UnicastResponsesToMulticastBroadcastDisabled プロパティ](https://go.microsoft.com/fwlink/?LinkId=118371) という設定があります。この設定は、ブロードキャスト (またはマルチキャスト) UDP 要求へのユニキャスト応答に関するファイアウォールの動作を制御します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-343">The firewall has a setting, which is named [UnicastResponsesToMulticastBroadcastDisabled Property of the INetFwProfile Interface](https://go.microsoft.com/fwlink/?LinkId=118371) which controls the behavior of the firewall with respect to unicast responses to a broadcast (or multicast) UDP request.</span></span>  <span data-ttu-id="5ced0-344">この設定には次の 2 つの動作があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-344">It has two behaviors:</span></span><br /><br /> <span data-ttu-id="5ced0-345">設定が TRUE の場合、ブロードキャスト要求へのユニキャスト応答はまったく許可されません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-345">If the setting is TRUE, no unicast responses to a broadcast are permitted at all.</span></span> <span data-ttu-id="5ced0-346">サービスの列挙は失敗します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-346">Enumerating services will fail.</span></span><br /><br /> <span data-ttu-id="5ced0-347">設定が FALSE (既定) の場合、ユニキャスト応答が 3 秒間許可されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-347">If the setting is FALSE (default), unicast responses are permitted for 3 seconds.</span></span> <span data-ttu-id="5ced0-348">この時間の長さは構成できません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-348">The length of time is not configurable.</span></span> <span data-ttu-id="5ced0-349">混雑しているネットワークや待機時間の長いネットワークまたは負荷の大きいサーバーで [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスを列挙しようとすると、一覧の一部しか返されない可能性があり、ユーザーの混乱を招くことがあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-349">in a congested or high-latency network, or for heavily loaded servers, tries to enumerate instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might return a partial list, which might mislead users.</span></span>|  
|<span data-ttu-id="5ced0-350">IPsec トラフィック</span><span class="sxs-lookup"><span data-stu-id="5ced0-350">IPsec traffic</span></span>|<span data-ttu-id="5ced0-351">UDP ポート 500 および UDP ポート 4500</span><span class="sxs-lookup"><span data-stu-id="5ced0-351">UDP port 500 and UDP port 4500</span></span>|<span data-ttu-id="5ced0-352">ドメインのポリシーにより IPsec 経由でネットワーク通信を行う必要がある場合は、UDP ポート 4500 と UDP ポート 500 も例外の一覧に追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-352">If the domain policy requires network communications to be done through IPsec, you must also add UDP port 4500 and UDP port 500 to the exception list.</span></span> <span data-ttu-id="5ced0-353">IPsec は、Windows ファイアウォール スナップインの **新規の受信の規則ウィザード** を使用するオプションです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-353">IPsec is an option using the **New Inbound Rule Wizard** in the Windows Firewall snap-in.</span></span> <span data-ttu-id="5ced0-354">詳細については、後の「 [セキュリティが強化された Windows ファイアウォールのスナップインの使用](#BKMK_WF_msc) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-354">For more information, see [Using the Windows Firewall with Advanced Security Snap-in](#BKMK_WF_msc) below.</span></span>|  
|<span data-ttu-id="5ced0-355">信頼されたドメインでの Windows 認証の使用</span><span class="sxs-lookup"><span data-stu-id="5ced0-355">Using Windows Authentication with Trusted Domains</span></span>|<span data-ttu-id="5ced0-356">認証要求を許可するようにファイアウォールを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-356">Firewalls must be configured to allow authentication requests.</span></span>|<span data-ttu-id="5ced0-357">詳細については、「 [ドメインの信頼関係を使用するためのファイアウォールの構成方法](https://support.microsoft.com/kb/179442/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-357">For more information, see [How to configure a firewall for domains and trusts](https://support.microsoft.com/kb/179442/).</span></span>|  
|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5ced0-358">と Windows のクラスタリング</span><span class="sxs-lookup"><span data-stu-id="5ced0-358">and Windows Clustering</span></span>|<span data-ttu-id="5ced0-359">クラスタリングでは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]に直接関連付けられていない追加のポートが必要です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-359">Clustering requires additional ports that are not directly related to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|<span data-ttu-id="5ced0-360">詳細については、「 [クラスターで使用するネットワークを有効にする](https://go.microsoft.com/fwlink/?LinkId=118372)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-360">For more information, see [Enable a network for cluster use](https://go.microsoft.com/fwlink/?LinkId=118372).</span></span>|  
|<span data-ttu-id="5ced0-361">HTTP サーバー API (HTTP.SYS) で予約された URL 名前空間</span><span class="sxs-lookup"><span data-stu-id="5ced0-361">URL namespaces reserved in the HTTP Server API (HTTP.SYS)</span></span>|<span data-ttu-id="5ced0-362">通常は TCP ポート 80 を使用しますが、他のポートに構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-362">Probably TCP port 80, but can be configured to other ports.</span></span> <span data-ttu-id="5ced0-363">一般的な情報については、「 [HTTP および HTTPS の構成](https://go.microsoft.com/fwlink/?LinkId=118373)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-363">For general information, see [Configuring HTTP and HTTPS](https://go.microsoft.com/fwlink/?LinkId=118373).</span></span>|<span data-ttu-id="5ced0-364">HttpCfg.exe を使用した HTTP.SYS エンドポイントの予約に関する [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 固有の情報については、「[URL の予約と登録について &#40;SSRS 構成マネージャー&#41;](../../reporting-services/install-windows/about-url-reservations-and-registration-ssrs-configuration-manager.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-364">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specific information about reserving an HTTP.SYS endpoint using HttpCfg.exe, see [About URL Reservations and Registration  &#40;SSRS Configuration Manager&#41;](../../reporting-services/install-windows/about-url-reservations-and-registration-ssrs-configuration-manager.md).</span></span>|  
  
##  <a name="special-considerations-for-port-135"></a><a name="BKMK_port_135"></a> <span data-ttu-id="5ced0-365">ポート 135 に関する注意事項</span><span class="sxs-lookup"><span data-stu-id="5ced0-365">Special Considerations for Port 135</span></span>  
 <span data-ttu-id="5ced0-366">RPC と共にトランスポートとして TCP/IP または UDP/IP を使用する場合、必要に応じて受信ポートがシステム サービスに動的に割り当てられることがよくあります。ポート 1024 より大きい TCP/IP ポートや UDP/IP ポートが使用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-366">When you use RPC with TCP/IP or with UDP/IP as the transport, inbound ports are frequently dynamically assigned to system services as required; TCP/IP and UDP/IP ports that are larger than port 1024 are used.</span></span> <span data-ttu-id="5ced0-367">これらはしばしば "ランダム RPC ポート" と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-367">These are frequently informally referred to as "random RPC ports."</span></span> <span data-ttu-id="5ced0-368">これらの場合、RPC クライアントは RPC エンドポイント マッパーを使用して、サーバーにどの動的ポートが割り当てられたかを指示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-368">In these cases, RPC clients rely on the RPC endpoint mapper to tell them which dynamic ports were assigned to the server.</span></span> <span data-ttu-id="5ced0-369">RPC ベースのサービスによっては、RPC によってポートが動的に割り当てられるのではなく、ユーザーが特定のポートを構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-369">For some RPC-based services, you can configure a specific port instead of letting RPC assign one dynamically.</span></span> <span data-ttu-id="5ced0-370">サービスに関係なく、RPC によって動的に割り当てられるポートを狭い範囲に制限することもできます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-370">You can also restrict the range of ports that RPC dynamically assigns to a small range, regardless of the service.</span></span> <span data-ttu-id="5ced0-371">ポート 135 は多くのサービスで使用されるので、悪意のあるユーザーによって頻繁に攻撃されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-371">Because port 135 is used for many services it is frequently attacked by malicious users.</span></span> <span data-ttu-id="5ced0-372">ポート 135 を開く場合は、ファイアウォール ルールのスコープを制限することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-372">When opening port 135, consider restricting the scope of the firewall rule.</span></span>  
  
 <span data-ttu-id="5ced0-373">ポート 135 の詳細については、次の資料を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-373">For more information about port 135, see the following references:</span></span>  
  
-   [<span data-ttu-id="5ced0-374">Windows サーバー システムのサービス概要とネットワーク ポート要件</span><span class="sxs-lookup"><span data-stu-id="5ced0-374">Service overview and network port requirements for the Windows Server system</span></span>](https://support.microsoft.com/kb/832017)  
  
-   [<span data-ttu-id="5ced0-375">製品 CD-ROM の Windows Server 2003 サポート ツールを使用した、RPC エンドポイント マッパー エラーのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="5ced0-375">Troubleshooting RPC Endpoint Mapper errors using the Windows Server 2003 Support Tools from the product CD</span></span>](https://support.microsoft.com/kb/839880)  
  
-   [<span data-ttu-id="5ced0-376">リモート プロシージャ呼び出し (RPC)</span><span class="sxs-lookup"><span data-stu-id="5ced0-376">Remote procedure call (RPC)</span></span>](https://go.microsoft.com/fwlink/?LinkId=118375)  
  
-   [<span data-ttu-id="5ced0-377">ファイアウォールで動作するように RPC の動的ポート割り当てを構成する方法</span><span class="sxs-lookup"><span data-stu-id="5ced0-377">How to configure RPC dynamic port allocation to work with firewalls</span></span>](https://support.microsoft.com/kb/154596/)  
  
##  <a name="interaction-with-other-firewall-rules"></a><a name="BKMK_other_rules"></a> <span data-ttu-id="5ced0-378">その他のファイアウォール ルールの操作</span><span class="sxs-lookup"><span data-stu-id="5ced0-378">Interaction with Other Firewall Rules</span></span>  
 <span data-ttu-id="5ced0-379">Windows ファイアウォールでは、ルールおよびルール グループを使用して、その構成が設定されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-379">The Windows Firewall uses rules and rule groups to establish its configuration.</span></span> <span data-ttu-id="5ced0-380">各ルールまたはルール グループは一般に、特定のプログラムやサービスに関連付けられており、そのプログラムやサービスによって、ユーザーの知らない間にそのルールが変更されたり削除されたりする場合があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-380">Each rule or rule group is generally associated with a particular program or service, and that program or service might modify or delete that rule without your knowledge.</span></span> <span data-ttu-id="5ced0-381">たとえば、ルール グループ **[World Wide Web サービス (HTTP)]** と **[セキュア World Wide Web サービス (HTTPS)]** は IIS に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="5ced0-381">For example, the rule groups **World Wide Web Services (HTTP)** and **World Wide Web Services (HTTPS)** are associated with IIS.</span></span> <span data-ttu-id="5ced0-382">これらのルールを有効にすると、ポート 80 とポート 443 が開き、これらのルールが有効になっている場合にポート 80 とポート 443 に依存する [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 機能が有効になります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-382">Enabling those rules will open ports 80 and 443, and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that depend on ports 80 and 443 will function if those rules are enabled.</span></span> <span data-ttu-id="5ced0-383">ただし、IIS を構成する管理者が、それらのルールを変更するか無効にする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-383">However, administrators configuring IIS might modify or disable those rules.</span></span> <span data-ttu-id="5ced0-384">したがって、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]にポート 80 またはポート 443 を使用している場合は、他の IIS ルールとは別に希望のポート構成を維持する独自のルールまたはルール グループを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-384">Therefore, if you are using port 80 or port 443 for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you should create your own rule or rule group that maintains your desired port configuration independently of the other IIS rules.</span></span>  
  
 <span data-ttu-id="5ced0-385">セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用して、該当する許可ルールと一致するトラフィックを許可できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-385">The Windows Firewall with Advanced Security MMC snap-in allows any traffic that matches any applicable allow rule.</span></span> <span data-ttu-id="5ced0-386">したがって、どちらもポート 80 に該当する、パラメーターの異なるルールが 2 つある場合、いずれかのルールと一致するトラフィックが許可されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-386">So if there are two rules that both apply to port 80 (with different parameters), traffic that matches either rule will be permitted.</span></span> <span data-ttu-id="5ced0-387">一方のルールでローカル サブネットからのポート 80 経由のトラフィックが許可され、もう一方のルールで任意のアドレスからのトラフィックが許可される場合、結果として、発信元に関係なくポート 80 へのすべてのトラフィックが許可されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-387">So if one rule allows traffic over port 80 from local subnet and one rule allows traffic from any address, the net effect is that all traffic to port 80 is permitted regardless of the source.</span></span> <span data-ttu-id="5ced0-388">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]へのアクセスを有効に管理するために、管理者はサーバーで有効になっているすべてのファイアウォール ルールを定期的に確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-388">To effectively manage access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], administrators should periodically review all firewall rules enabled on the server.</span></span>  
  
##  <a name="overview-of-firewall-profiles"></a><a name="BKMK_profiles"></a> <span data-ttu-id="5ced0-389">ファイアウォール プロファイルの概要</span><span class="sxs-lookup"><span data-stu-id="5ced0-389">Overview of Firewall Profiles</span></span>  
 <span data-ttu-id="5ced0-390">ファイアウォール プロファイルについては、「 [セキュリティが強化された Windows ファイアウォール ファースト ステップ ガイド](https://go.microsoft.com/fwlink/?LinkId=116080) 」の「 **ネットワークの場所を認識するホスト ファイアウォール**」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ced0-390">Firewall profiles are discussed in [Windows Firewall with Advanced Security Getting Started Guide](https://go.microsoft.com/fwlink/?LinkId=116080) in the section **Network location-aware host firewall**.</span></span> <span data-ttu-id="5ced0-391">要約すると、オペレーティング システムでは、接続性、接続状態、およびカテゴリに関して、接続する各ネットワークが識別され記憶されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-391">To summarize, the operating systems identify and remember each of the networks to which they connect with regard to connectivity, connections, and category.</span></span>  
  
 <span data-ttu-id="5ced0-392">セキュリティが強化された Windows ファイアウォールでは、ネットワークの場所として 3 種類の設定があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-392">There are three network location types in Windows Firewall with Advanced Security:</span></span>  
  
-   <span data-ttu-id="5ced0-393">ドメイン。</span><span class="sxs-lookup"><span data-stu-id="5ced0-393">Domain.</span></span> <span data-ttu-id="5ced0-394">Windows では、コンピューターが参加しているドメインのドメイン コントローラーへのアクセスを認証できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-394">Windows can authenticate access to the domain controller for the domain to which the computer is joined.</span></span>  
  
-   <span data-ttu-id="5ced0-395">パブリック。</span><span class="sxs-lookup"><span data-stu-id="5ced0-395">Public.</span></span> <span data-ttu-id="5ced0-396">ドメイン ネットワーク以外のすべてのネットワークがパブリックとして最初に分類されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-396">Other than domain networks, all networks are initially categorized as public.</span></span> <span data-ttu-id="5ced0-397">インターネットへの直接接続となるネットワーク、または空港やコーヒー ショップのような公共の場所にあるネットワークです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-397">Networks that represent direct connections to the Internet or are in public locations, such as airports and coffee shops should be left public.</span></span>  
  
-   <span data-ttu-id="5ced0-398">プライベート。</span><span class="sxs-lookup"><span data-stu-id="5ced0-398">Private.</span></span> <span data-ttu-id="5ced0-399">ユーザーまたはアプリケーションによってプライベートと見なされるネットワークです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-399">A network identified by a user or application as private.</span></span> <span data-ttu-id="5ced0-400">信頼されたネットワークだけをプライベート ネットワークと見なす必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-400">Only trusted networks should be identified as private networks.</span></span> <span data-ttu-id="5ced0-401">通常は、ホーム ネットワークまたは小規模ビジネス ネットワークをプライベートと見なすことができます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-401">Users will likely want to identify home or small business networks as private.</span></span>  
  
 <span data-ttu-id="5ced0-402">管理者はネットワークの場所の種類ごとにプロファイルを作成できます。各プロファイルに、さまざまなファイアウォール ポリシーを指定できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-402">The administrator can create a profile for each network location type, with each profile containing different firewall policies.</span></span> <span data-ttu-id="5ced0-403">どの時点においても 1 つのプロファイルのみが適用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-403">Only one profile is applied at any time.</span></span> <span data-ttu-id="5ced0-404">次のようなプロファイル順序が適用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-404">Profile order is applied as follows:</span></span>  
  
1.  <span data-ttu-id="5ced0-405">Windows では、コンピューターが参加しているドメインのドメイン コントローラーへのアクセスに対してすべてのインターフェイスが認証される場合、ドメイン プロファイルが適用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-405">If all interfaces are authenticated to the domain controller for the domain of which the computer is a member, the domain profile is applied.</span></span>  
  
2.  <span data-ttu-id="5ced0-406">すべてのインターフェイスがドメイン コントローラーに対して認証されるか、プライベート ネットワークの場所として分類されるネットワークに接続されている場合、プライベート プロファイルが適用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-406">If all interfaces are either authenticated to the domain controller or are connected to networks that are classified as private network locations, the private profile is applied.</span></span>  
  
3.  <span data-ttu-id="5ced0-407">それ以外の場合は、パブリック プロファイルが適用されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-407">Otherwise, the public profile is applied.</span></span>  
  
 <span data-ttu-id="5ced0-408">セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用して、すべてのファイアウォール プロファイルを表示し、構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-408">Use the Windows Firewall with Advanced Security MMC snap-in to view and configure all firewall profiles.</span></span> <span data-ttu-id="5ced0-409">コントロール パネルの **[Windows ファイアウォール]** では、現在のプロファイルのみを構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-409">The **Windows Firewall** item in Control Panel only configures the current profile.</span></span>  
  
##  <a name="additional-firewall-settings-using-the-windows-firewall-item-in-control-panel"></a><a name="BKMK_additional_settings"></a> <span data-ttu-id="5ced0-410">コントロール パネルの [Windows ファイアウォール] を使用した追加のファイアウォール設定</span><span class="sxs-lookup"><span data-stu-id="5ced0-410">Additional Firewall Settings Using the Windows Firewall Item in Control Panel</span></span>  
 <span data-ttu-id="5ced0-411">ファイアウォールに例外を追加した場合、特定のコンピューターまたはローカル サブネットからの着信接続のみに対してポートを開くように制限できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-411">Exceptions that you add to the firewall can restrict the opening of the port to incoming connections from specific computers or the local subnet.</span></span> <span data-ttu-id="5ced0-412">ポートを開くスコープを制限すると、コンピューターが悪意のあるユーザーの攻撃にさらされるリスクを軽減できるので、このように設定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-412">This restriction of the scope of the port opening can reduce how much your computer is exposed to malicious users, and is recommended.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5ced0-413">コントロール パネルの **[Windows ファイアウォール]** では、現在のファイアウォール プロファイルのみを構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-413">Using the **Windows Firewall** item in Control Panel only configures the current firewall profile.</span></span>  
  
#### <a name="to-change-the-scope-of-a-firewall-exception-using-the-windows-firewall-item-in-control-panel"></a><span data-ttu-id="5ced0-414">コントロール パネルの [Windows ファイアウォール] を使用して、ファイアウォールの例外のスコープを変更するには</span><span class="sxs-lookup"><span data-stu-id="5ced0-414">To change the scope of a firewall exception using the Windows Firewall item in Control Panel</span></span>  
  
1.  <span data-ttu-id="5ced0-415">コントロール パネルの **[Windows ファイアウォール]** の **[例外]** タブでプログラムまたはポートを選択し、 **[プロパティ]** または **[編集]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-415">In the **Windows Firewall** item in Control Panel, select a program or port on the **Exceptions** tab, and then click **Properties** or **Edit**.</span></span>  
  
2.  <span data-ttu-id="5ced0-416">**[プログラムの編集]** または **[ポートの編集]** ダイアログ ボックスの **[スコープの変更]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-416">In the **Edit a Program** or **Edit a Port** dialog box, click **Change Scope**.</span></span>  
  
3.  <span data-ttu-id="5ced0-417">次のいずれかのオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-417">Choose one of the following options:</span></span>  
  
    -   <span data-ttu-id="5ced0-418">**[任意のコンピューター (インターネット上のコンピューターを含む)]**</span><span class="sxs-lookup"><span data-stu-id="5ced0-418">**Any computer (including those on the Internet)**</span></span>  
  
         <span data-ttu-id="5ced0-419">推奨されません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-419">Not recommended.</span></span> <span data-ttu-id="5ced0-420">この設定によって、自分のコンピューターのアドレスを指定した任意のコンピューターが、特定のプログラムまたはポートに接続できるようになります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-420">This will allow any computer that can address your computer to connect to the specified program or port.</span></span> <span data-ttu-id="5ced0-421">このような設定は、インターネット上の匿名ユーザーに情報を提供できるようにするために必要な場合がありますが、悪意のあるユーザーの攻撃にさらされるリスクが大きくなります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-421">This setting might be necessary to allow information to be presented to anonymous users on the internet, but increases your exposure to malicious users.</span></span> <span data-ttu-id="5ced0-422">この設定を有効にし、[エッジ トラバーサルを許可する] オプションなどのネットワーク アドレス変換 (NAT) トラバーサルも許可する場合は、悪意のあるユーザーの攻撃にさらされる可能性がさらに高くなります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-422">Your exposure can be further increased if you enable this setting and also allow Network Address Translation (NAT) traversal, such as the Allow edge traversal option.</span></span>  
  
    -   <span data-ttu-id="5ced0-423">**[ユーザーのネットワーク (サブネット) のみ]**</span><span class="sxs-lookup"><span data-stu-id="5ced0-423">**My network (subnet) only**</span></span>  
  
         <span data-ttu-id="5ced0-424">**[任意のコンピューター]** より安全な設定です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-424">This is a more secure setting than **Any computer**.</span></span> <span data-ttu-id="5ced0-425">ネットワークのローカル サブネット上のコンピューターのみがプログラムまたはポートに接続できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-425">Only computers on the local subnet of your network can connect to the program or port.</span></span>  
  
    -   <span data-ttu-id="5ced0-426">**[カスタムの一覧]**</span><span class="sxs-lookup"><span data-stu-id="5ced0-426">**Custom list:**</span></span>  
  
     <span data-ttu-id="5ced0-427">作成した一覧に IP アドレスが載っているコンピューターだけが接続できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-427">Only computers that have the IP addresses you list can connect.</span></span> <span data-ttu-id="5ced0-428">この設定は、 **[ユーザーのネットワーク (サブネット) のみ]** よりもさらに安全ですが、DHCP を使用するクライアント コンピューターでは、その IP アドレスが変更されることがあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-428">This can be a more secure setting than **My network (subnet) only**, however, client computers using DHCP can occasionally change their IP address.</span></span> <span data-ttu-id="5ced0-429">その場合、意図していたコンピューターは接続することができません。</span><span class="sxs-lookup"><span data-stu-id="5ced0-429">Then the intended computer will not be able to connect.</span></span> <span data-ttu-id="5ced0-430">その代わり、認証の対象として意図していなかった別のコンピューターに一覧の IP アドレスが割り当てられてしまい、そのコンピューターから接続できるようになる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-430">Another computer, which you had not intended to authorize, might accept the listed IP address and then be able to connect.</span></span> <span data-ttu-id="5ced0-431">**[カスタムの一覧]** オプションは、固定 IP アドレスを使用するように構成されている他のサーバーの一覧を作成する場合に適しています。ただし、侵入者が IP アドレスを偽装する可能性もあります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-431">The **Custom list** option might be appropriate for listing other servers which are configured to use a fixed IP address; however, IP addresses might be spoofed by an intruder.</span></span> <span data-ttu-id="5ced0-432">ファイアウォール ルールを制限することは、最低限のネットワーク インフラストラクチャです。</span><span class="sxs-lookup"><span data-stu-id="5ced0-432">Restricting firewall rules are only as strong as your network infrastructure.</span></span>  
  
##  <a name="using-the-windows-firewall-with-advanced-security-snap-in"></a><a name="BKMK_WF_msc"></a> <span data-ttu-id="5ced0-433">セキュリティが強化された Windows ファイアウォールのスナップインの使用</span><span class="sxs-lookup"><span data-stu-id="5ced0-433">Using the Windows Firewall with Advanced Security Snap-in</span></span>  
 <span data-ttu-id="5ced0-434">セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用して、さらに詳細なファイアウォール設定を構成できます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-434">Additional advanced firewall settings can be configured by using the Windows Firewall with Advanced Security MMC snap-in.</span></span> <span data-ttu-id="5ced0-435">スナップインにはルール ウィザードが組み込まれており、コントロール パネルの **[Windows ファイアウォール]** では使用できない設定も表示されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-435">The snap-in includes a rule wizard and exposes additional settings that are not available in the **Windows Firewall** item in Control Panel.</span></span> <span data-ttu-id="5ced0-436">これらの設定には、次の内容が含まれています。</span><span class="sxs-lookup"><span data-stu-id="5ced0-436">These settings include the following:</span></span>  
  
-   <span data-ttu-id="5ced0-437">暗号化の設定</span><span class="sxs-lookup"><span data-stu-id="5ced0-437">Encryption settings</span></span>  
  
-   <span data-ttu-id="5ced0-438">サービスの制限</span><span class="sxs-lookup"><span data-stu-id="5ced0-438">Services restrictions</span></span>  
  
-   <span data-ttu-id="5ced0-439">名前によってコンピューターの接続を制限する</span><span class="sxs-lookup"><span data-stu-id="5ced0-439">Restricting connections for computers by name</span></span>  
  
-   <span data-ttu-id="5ced0-440">特定のユーザーまたはプロファイルに接続を制限する</span><span class="sxs-lookup"><span data-stu-id="5ced0-440">Restricting connections to specific users or profiles</span></span>  
  
-   <span data-ttu-id="5ced0-441">エッジ トラバーサルにより、トラフィックが NAT (Network Address Translation) ルーターをバイパスするのを許可する</span><span class="sxs-lookup"><span data-stu-id="5ced0-441">Edge traversal allowing traffic to bypass Network Address Translation (NAT) routers</span></span>  
  
-   <span data-ttu-id="5ced0-442">送信ルールを構成する</span><span class="sxs-lookup"><span data-stu-id="5ced0-442">Configuring outbound rules</span></span>  
  
-   <span data-ttu-id="5ced0-443">セキュリティ ルールを構成する</span><span class="sxs-lookup"><span data-stu-id="5ced0-443">Configuring security rules</span></span>  
  
-   <span data-ttu-id="5ced0-444">着信接続用に IPsec を要求する</span><span class="sxs-lookup"><span data-stu-id="5ced0-444">Requiring IPsec for incoming connections</span></span>  
  
#### <a name="to-create-a-new-firewall-rule-using-the-new-rule-wizard"></a><span data-ttu-id="5ced0-445">新しい規則ウィザードを使用して、新しいファイアウォール ルールを作成するには</span><span class="sxs-lookup"><span data-stu-id="5ced0-445">To create a new firewall rule using the New Rule wizard</span></span>  
  
1.  <span data-ttu-id="5ced0-446">[スタート] ボタンをクリックし、 **[ファイル名を指定して実行]** をクリックして **「WF.msc」** と入力し、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-446">On the Start menu, click **Run**, type **WF.msc**, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="5ced0-447">**[セキュリティが強化された Windows ファイアウォール]** の左ウィンドウの **[受信の規則]** を右クリックし、 **[新しい規則]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5ced0-447">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule**.</span></span>  
  
3.  <span data-ttu-id="5ced0-448">**新規の受信の規則ウィザード** で、必要な設定を行います。</span><span class="sxs-lookup"><span data-stu-id="5ced0-448">Complete the **New Inbound Rule Wizard** using the settings that you want.</span></span>  
  
##  <a name="troubleshooting-firewall-settings"></a><a name="BKMK_troubleshooting"></a> <span data-ttu-id="5ced0-449">ファイアウォール設定のトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="5ced0-449">Troubleshooting Firewall Settings</span></span>  
 <span data-ttu-id="5ced0-450">ファイアウォールの問題をトラブルシューティングする場合は、次のツールと手法が役立ちます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-450">The following tools and techniques can be useful in troubleshooting firewall issues:</span></span>  
  
-   <span data-ttu-id="5ced0-451">有効なポート ステータスは、ポートに関連付けられているすべてのルールの和集合です。</span><span class="sxs-lookup"><span data-stu-id="5ced0-451">The effective port status is the union of all rules related to the port.</span></span> <span data-ttu-id="5ced0-452">ポートを経由するアクセスをブロックしようとするときは、そのポート番号を参照しているすべてのルールの確認が有効な場合があります。</span><span class="sxs-lookup"><span data-stu-id="5ced0-452">When trying to block access through a port, it can be helpful to review all the rules which cite the port number.</span></span> <span data-ttu-id="5ced0-453">このためには、セキュリティが強化された Windows ファイアウォールの MMC スナップインを使用して、ポート番号によって受信ルールと送信ルールを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-453">To do this, use the Windows Firewall with Advanced Security MMC snap-in and sort the inbound and outbound rules by port number.</span></span>  
  
-   <span data-ttu-id="5ced0-454">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] を実行しているコンピューターでアクティブになっているポートを確認します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-454">Review the ports that are active on the computer on which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running.</span></span> <span data-ttu-id="5ced0-455">この確認処理では、リッスンしている TCP/IP ポートの確認とポートのステータスの確認も行います。</span><span class="sxs-lookup"><span data-stu-id="5ced0-455">This review process includes verifying which TCP/IP ports are listening and also verifying the status of the ports.</span></span>  
  
     <span data-ttu-id="5ced0-456">受信待ちしているポートを確認するには、 **netstat** コマンド ライン ユーティリティを使用します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-456">To verify which ports are listening, use the **netstat** command-line utility.</span></span> <span data-ttu-id="5ced0-457">**netstat** ユーティリティでは、アクティブな TCP 接続の表示以外にさまざまな IP の統計および情報も表示されます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-457">In addition to displaying active TCP connections, the **netstat** utility also displays a variety of IP statistics and information.</span></span>  
  
    #### <a name="to-list-which-tcpip-ports-are-listening"></a><span data-ttu-id="5ced0-458">リッスンしている TCP/IP ポートの一覧を表示するには</span><span class="sxs-lookup"><span data-stu-id="5ced0-458">To list which TCP/IP ports are listening</span></span>  
  
    1.  <span data-ttu-id="5ced0-459">コマンド プロンプト ウィンドウを開きます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-459">Open the Command Prompt window.</span></span>  
  
    2.  <span data-ttu-id="5ced0-460">コマンド プロンプトで、「`netstat -n -a`」と入力します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-460">At the command prompt, type `netstat -n -a`.</span></span>  
  
         <span data-ttu-id="5ced0-461">**-n** スイッチは、 **netstat** に対して、アクティブな TCP 接続のアドレスおよびポート番号を数字で表示するように指示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-461">The **-n** switch instructs **netstat** to numerically display the address and port number of active TCP connections.</span></span> <span data-ttu-id="5ced0-462">**-a** スイッチは、 **netstat** に対して、コンピューターがリッスンしている TCP ポートおよび UDP ポートを表示するように指示します。</span><span class="sxs-lookup"><span data-stu-id="5ced0-462">The **-a** switch instructs **netstat** to display the TCP and UDP ports on which the computer is listening.</span></span>  
  
-   <span data-ttu-id="5ced0-463">**PortQry** ユーティリティを使用して、TCP/IP ポートのステータスを LISTENING、NOT LISTENING、FILTERED としてレポートできます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-463">The **PortQry** utility can be used to report the status of TCP/IP ports as listening, not listening, or filtered.</span></span> <span data-ttu-id="5ced0-464">(FILTERED ステータスは、ポートが、LISTENING、NOT LISTENING のどちらか不明で、ユーティリティがポートからの応答を受信していないことを示します)。**PortQry** ユーティリティは、 [Microsoft ダウンロード センター](https://www.microsoft.com/download/details.aspx?id=17148)からダウンロードできます。</span><span class="sxs-lookup"><span data-stu-id="5ced0-464">(With a filtered status, the port might or might not be listening; this status indicates that the utility did not receive a response from the port.) The **PortQry** utility is available for download from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=17148).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5ced0-465">参照</span><span class="sxs-lookup"><span data-stu-id="5ced0-465">See Also</span></span>  
 [<span data-ttu-id="5ced0-466">Windows サーバー システムのサービス概要およびネットワーク ポート要件</span><span class="sxs-lookup"><span data-stu-id="5ced0-466">Service overview and network port requirements for the Windows Server system</span></span>](https://support.microsoft.com/kb/832017)  
