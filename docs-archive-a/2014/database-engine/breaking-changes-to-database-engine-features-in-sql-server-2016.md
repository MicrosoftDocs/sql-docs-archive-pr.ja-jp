---
title: SQL Server 2014 | のデータベースエンジン機能の重大な変更Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: release-landing
ms.topic: conceptual
helpviewer_keywords:
- Database Engine [SQL Server], what's new
- breaking changes [SQL Server]
ms.assetid: 47edefbd-a09b-4087-937a-453cd5c6e061
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: bf1a25aabde1e684407218da7365ae7a2b4265a7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87742585"
---
# <a name="breaking-changes-to-database-engine-features-in-sql-server-2014"></a><span data-ttu-id="b0a46-102">SQL Server 2014 におけるデータベース エンジン機能の重大な変更</span><span class="sxs-lookup"><span data-stu-id="b0a46-102">Breaking Changes to Database Engine Features in SQL Server 2014</span></span>
  <span data-ttu-id="b0a46-103">このトピックでは、以前のバージョンのにおける重大な変更について説明し [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] [!INCLUDE[ssDE](../includes/ssde-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-103">This topic describes breaking changes in the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] [!INCLUDE[ssDE](../includes/ssde-md.md)] and earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b0a46-104">これらの変更によって、以前のバージョンの [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]に基づくアプリケーション、スクリプト、または機能が使用できなくなる場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-104">These changes might break applications, scripts, or functionalities that are based on earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b0a46-105">この問題は、アップグレードするときに発生することがあります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-105">You might encounter these issues when you upgrade.</span></span> <span data-ttu-id="b0a46-106">詳細については、「 [Use Upgrade Advisor to Prepare for Upgrades](../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-106">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
##  <a name="breaking-changes-in-sssql14"></a><a name="SQL14"></a><span data-ttu-id="b0a46-107">[!INCLUDE[ssSQL14](../includes/sssql14-md.md)] における重大な変更</span><span class="sxs-lookup"><span data-stu-id="b0a46-107">Breaking Changes in [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]</span></span>  
 <span data-ttu-id="b0a46-108">新しい事項はありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-108">No new issues.</span></span>  
  
##  <a name="breaking-changes-in-sssql11"></a><a name="Denali"></a><span data-ttu-id="b0a46-109">における重大な変更[!INCLUDE[ssSQL11](../includes/sssql11-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b0a46-109">Breaking Changes in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]</span></span>  
  
### <a name="transact-sql"></a><span data-ttu-id="b0a46-110">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b0a46-110">Transact-SQL</span></span>  
  
|<span data-ttu-id="b0a46-111">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-111">Feature</span></span>|<span data-ttu-id="b0a46-112">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-112">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-113">NEXT という名前の列またはテーブルから選択している</span><span class="sxs-lookup"><span data-stu-id="b0a46-113">Selecting from columns or tables named NEXT</span></span>|<span data-ttu-id="b0a46-114">シーケンスでは、ANSI 標準の NEXT VALUE FOR 関数が使用されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-114">Sequences use the ANSI standard NEXT VALUE FOR function.</span></span> <span data-ttu-id="b0a46-115">テーブルまたは列の名前が NEXT で、テーブルまたは列に値が指定されていて、ANSI 標準の AS が省略されている場合は、結果のステートメントによってエラーが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-115">If a table or a column is named NEXT and the table or column is aliased as VALUE, and if the ANSI standard AS is omitted, the resultant statement can cause an error.</span></span> <span data-ttu-id="b0a46-116">問題を回避するには、ANSI 標準の AS キーワードを含めます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-116">To work around, include the ANSI standard AS keyword.</span></span> <span data-ttu-id="b0a46-117">たとえば、`SELECT NEXT VALUE FROM Table` は `SELECT NEXT AS VALUE FROM Table` に書き直す必要があり、`SELECT Col1 FROM NEXT VALUE` は `SELECT Col1 FROM NEXT AS VALUE` に書き直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-117">For example, `SELECT NEXT VALUE FROM Table` should be rewritten as `SELECT NEXT AS VALUE FROM Table` and `SELECT Col1 FROM NEXT VALUE` should be rewritten as `SELECT Col1 FROM NEXT AS VALUE`.</span></span>|  
|<span data-ttu-id="b0a46-118">PIVOT 演算子</span><span class="sxs-lookup"><span data-stu-id="b0a46-118">PIVOT operator</span></span>|<span data-ttu-id="b0a46-119">PIVOT 演算子は、データベースの互換性レベルが 110 に設定されている場合、再帰共通テーブル式 (CTE) クエリでは許可されません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-119">The PIVOT operator is not allowed in a recursive common table expression (CTE) query when the database compatibility level is set to 110.</span></span> <span data-ttu-id="b0a46-120">クエリを書き直すか、または互換性レベルを 100 以下に変更してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-120">Rewrite the query, or change the compatibility level to 100 or lower.</span></span> <span data-ttu-id="b0a46-121">再帰 CTE クエリで PIVOT を使用すると、グループごとに複数の行がある場合に、誤った結果が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-121">Using PIVOT in a recursive CTE query produces incorrect results when there is more than a single row per grouping.</span></span>|  
|<span data-ttu-id="b0a46-122">sp_setapprole と sp_unsetapprole</span><span class="sxs-lookup"><span data-stu-id="b0a46-122">sp_setapprole and sp_unsetapprole</span></span>|<span data-ttu-id="b0a46-123">の cookie `OUTPUT` パラメーター `sp_setapprole` は現在、 `varbinary(8000)` 正しい最大長であるとしてドキュメントに記載されています。</span><span class="sxs-lookup"><span data-stu-id="b0a46-123">The cookie `OUTPUT` parameter for `sp_setapprole` is currently documented as `varbinary(8000)` which is the correct maximum length.</span></span> <span data-ttu-id="b0a46-124">ただし、現在の実装では `varbinary(50)` を返します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-124">However the current implementation returns `varbinary(50)`.</span></span> <span data-ttu-id="b0a46-125">`varbinary(8000)`将来のリリースでクッキーの戻り値のサイズが増加してもアプリケーションが正常に動作するように、アプリケーションの予約を続行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-125">Applications should continue to reserve `varbinary(8000)` so that the application continues to operate correctly if the cookie return size increases in a future release.</span></span> <span data-ttu-id="b0a46-126">詳細については、「[sp_setapprole &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setapprole-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-126">For more information, see [sp_setapprole &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setapprole-transact-sql).</span></span>|  
|<span data-ttu-id="b0a46-127">EXECUTE AS</span><span class="sxs-lookup"><span data-stu-id="b0a46-127">EXECUTE AS</span></span>|<span data-ttu-id="b0a46-128">EXECUTE AS のクッキーの OUTPUT パラメーターは現在、適切な最大長である `varbinary(8000)` としてドキュメントに記載されています。</span><span class="sxs-lookup"><span data-stu-id="b0a46-128">The cookie OUTPUT parameter for EXECUTE AS is currently documented as `varbinary(8000)` which is the correct maximum length.</span></span> <span data-ttu-id="b0a46-129">ただし、現在の実装では `varbinary(100)` を返します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-129">However the current implementation returns `varbinary(100)`.</span></span> <span data-ttu-id="b0a46-130">`varbinary(8000)`将来のリリースでクッキーの戻り値のサイズが増加してもアプリケーションが正常に動作するように、アプリケーションの予約を続行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-130">Applications should continue to reserve `varbinary(8000)` so that the application continues to operate correctly if the cookie return size increases in a future release.</span></span> <span data-ttu-id="b0a46-131">詳細については、「[EXECUTE AS &#40;Transact-SQL&#41;](/sql/t-sql/statements/execute-as-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-131">For more information, see [EXECUTE AS &#40;Transact-SQL&#41;](/sql/t-sql/statements/execute-as-transact-sql).</span></span>|  
|<span data-ttu-id="b0a46-132">sys.fn_get_audit_file 関数</span><span class="sxs-lookup"><span data-stu-id="b0a46-132">sys.fn_get_audit_file function</span></span>|<span data-ttu-id="b0a46-133">ユーザー定義の監査イベントをサポートするために、2つの列 (**user_defined_event_id**と**user_defined_information**) が追加されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-133">Two additional columns (**user_defined_event_id** and **user_defined_information**) have been added to support user-defined audit events.</span></span> <span data-ttu-id="b0a46-134">名前で列を選択しないアプリケーションは、予想よりも多くの列を返す場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-134">Applications that do not select columns by name might return more columns than expected.</span></span> <span data-ttu-id="b0a46-135">名前で列を選択するか、これらの追加列を受け入れるようにアプリケーションを調整してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-135">Either select columns by name, or adjust the application to accept these additional columns.</span></span>|  
|<span data-ttu-id="b0a46-136">WITHIN 予約キーワード</span><span class="sxs-lookup"><span data-stu-id="b0a46-136">WITHIN reserved keyword</span></span>|<span data-ttu-id="b0a46-137">WITHIN は予約キーワードになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-137">WITHIN is now a reserved keyword.</span></span> <span data-ttu-id="b0a46-138">"within" という名前のオブジェクトまたは列への参照は失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-138">References to objects or columns named 'within' will fail.</span></span> <span data-ttu-id="b0a46-139">オブジェクトまたは列の名前を変更するか、または角かっこや引用符を使用して名前を区切ってください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-139">Rename the object or column name or delimit the name by using brackets or quotes.</span></span>  <span data-ttu-id="b0a46-140">たとえば、「 `SELECT * FROM [within]` 」のように入力します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-140">For example, `SELECT * FROM [within]`.</span></span>|  
|<span data-ttu-id="b0a46-141">`time` または `datetime2` 型の計算列に対する CAST および CONVERT 操作</span><span class="sxs-lookup"><span data-stu-id="b0a46-141">CAST and CONVERT operations on computed columns of type `time` or `datetime2`</span></span>|<span data-ttu-id="b0a46-142">以前のバージョンの [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] では、`time` および `datetime2` データ型に対する CAST および CONVERT 操作の既定のスタイルは、いずれかの型が計算列の式で使用されている場合を除き、121 です。</span><span class="sxs-lookup"><span data-stu-id="b0a46-142">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the default style for CAST and CONVERT operations on `time` and `datetime2` data types is 121 except when either type is used in a computed column expression.</span></span> <span data-ttu-id="b0a46-143">計算列の場合、既定のスタイルは 0 です。</span><span class="sxs-lookup"><span data-stu-id="b0a46-143">For computed columns, the default style is 0.</span></span> <span data-ttu-id="b0a46-144">この動作は、計算列が作成されるとき、自動パラメーター化を含むクエリで使用されるとき、または制約の定義で使用されるときに、計算列に影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-144">This behavior impacts computed columns when they are created, used in queries involving auto-parameterization, or used in constraint definitions.</span></span><br /><br /> <span data-ttu-id="b0a46-145">互換性レベル 110 では、`time` および `datetime2` データ型に対する CAST および CONVERT 操作の既定のスタイルは常に 121 です。</span><span class="sxs-lookup"><span data-stu-id="b0a46-145">Under compatibility level 110, the default style for CAST and CONVERT operations on `time` and `datetime2` data types is always 121.</span></span> <span data-ttu-id="b0a46-146">クエリが古い動作に依存する場合は、110 より小さい互換性レベルを使用するか、または影響を受けるクエリで 0 スタイルを明示的に指定してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-146">If your query relies on the old behavior, use a compatibility level less than 110, or explicitly specify the 0 style in the affected query.</span></span><br /><br /> <span data-ttu-id="b0a46-147">データベースを互換性レベル 110 にアップグレードしても、ディスクに格納されているユーザー データは変更されません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-147">Upgrading the database to compatibility level 110 will not change user data that has been stored to disk.</span></span> <span data-ttu-id="b0a46-148">このようなデータは手動で適切に修正する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-148">You must manually correct this data as appropriate.</span></span> <span data-ttu-id="b0a46-149">たとえば、SELECT INTO を使用して、前に説明した計算列の式を含むソースからテーブルを作成した場合は、計算列の定義自体ではなく、(スタイル 0 を使用する) データが格納されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-149">For example, if you used SELECT INTO to create a table from a source that contained a computed column expression described above, the data (using style 0) would be stored rather than the computed column definition itself.</span></span> <span data-ttu-id="b0a46-150">このようなデータは、手動で更新してスタイル 121 に一致させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-150">You would need to manually update this data to match style 121.</span></span>|  
|<span data-ttu-id="b0a46-151">ALTER TABLE</span><span class="sxs-lookup"><span data-stu-id="b0a46-151">ALTER TABLE</span></span>|<span data-ttu-id="b0a46-152">ALTER TABLE ステートメントでは、2 部構成 (schema.object) のテーブル名だけを使用できます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-152">The ALTER TABLE statement allows only two-part (schema.object) table names.</span></span> <span data-ttu-id="b0a46-153">次の形式を使用してテーブル名を指定すると、コンパイル時にエラー117が発生して失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-153">Specifying a table name using the following formats now fails at compile time with error 117:</span></span><br /><br /> <span data-ttu-id="b0a46-154">server.database.schema.table</span><span class="sxs-lookup"><span data-stu-id="b0a46-154">server.database.schema.table</span></span><br /><br /> <span data-ttu-id="b0a46-155">.database.schema.table</span><span class="sxs-lookup"><span data-stu-id="b0a46-155">.database.schema.table</span></span><br /><br /> <span data-ttu-id="b0a46-156">..schema.table</span><span class="sxs-lookup"><span data-stu-id="b0a46-156">..schema.table</span></span><br /><br /> <span data-ttu-id="b0a46-157">以前のバージョンでは、server.database.schema.table という形式を指定すると、エラー 4902 が返されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-157">In earlier versions specifying the format server.database.schema.table returned error 4902.</span></span> <span data-ttu-id="b0a46-158">.database.schema.table または ..schema.table という形式を指定すると、成功しました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-158">Specifying the format .database.schema.table or the format ..schema.table succeeded.</span></span> <span data-ttu-id="b0a46-159">問題を解決するには、4 部構成のプレフィックスの使用を削除してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-159">To resolve the problem, remove the use of a 4-part prefix.</span></span>|  
|<span data-ttu-id="b0a46-160">メタデータの参照</span><span class="sxs-lookup"><span data-stu-id="b0a46-160">Browsing metadata</span></span>|<span data-ttu-id="b0a46-161">FOR BROWSE または SET NO_BROWSETABLE ON を使用してビューをクエリすると、基になるオブジェクトのメタデータではなく、ビューのメタデータが返されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-161">Querying a view using FOR BROWSE or SET NO_BROWSETABLE ON now returns the metadata of the view, not the metadata of the underlying object.</span></span> <span data-ttu-id="b0a46-162">この動作は現在、他のメタデータ参照方法と一致します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-162">This behavior now matches other methods of browsing metadata.</span></span>|  
|<span data-ttu-id="b0a46-163">SOUNDEX</span><span class="sxs-lookup"><span data-stu-id="b0a46-163">SOUNDEX</span></span>|<span data-ttu-id="b0a46-164">データベース互換性レベル 110 では、SOUNDEX 関数は新しいルールを実装します。このため、この関数により計算される値が、110 未満の互換性レベルで計算された値と異なる結果になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-164">Under database compatibility level 110, the SOUNDEX function implements new rules that may cause the values computed by the function to be different than the values computed under earlier compatibility levels.</span></span> <span data-ttu-id="b0a46-165">互換性レベル 110 へのアップグレード後に、SOUNDEX 関数を使用するインデックス、ヒープ、または CHECK 制約の再構築が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-165">After upgrading to compatibility level 110, you may need to rebuild the indexes, heaps, or CHECK constraints that use the SOUNDEX function.</span></span> <span data-ttu-id="b0a46-166">詳細については、「[SOUNDEX (Transact-SQL)](/sql/t-sql/functions/soundex-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-166">For more information, see [SOUNDEX &#40;Transact-SQL&#41;](/sql/t-sql/functions/soundex-transact-sql)</span></span>
|<span data-ttu-id="b0a46-167">失敗した DML ステートメントの行数メッセージ</span><span class="sxs-lookup"><span data-stu-id="b0a46-167">Row count message for failed DML statements</span></span>|<span data-ttu-id="b0a46-168">[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] では、DML ステートメントが失敗した場合、[!INCLUDE[ssDE](../includes/ssde-md.md)] は一貫して RowCount: 0 の TDS DONE トークンをクライアントに送信します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-168">In [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], the [!INCLUDE[ssDE](../includes/ssde-md.md)] will consistently send the TDS DONE token with RowCount: 0 to clients when a DML statement fails.</span></span> <span data-ttu-id="b0a46-169">以前のバージョンの [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] では、失敗する DML ステートメントが TRY-CATCH ブロックに含まれていて、それが [!INCLUDE[ssDE](../includes/ssde-md.md)] によって自動パラメーター化されるか、または TRY-CATCH ブロックが失敗したステートメントと同じレベルにない場合、-1 という間違った値がクライアントに送信されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-169">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], an incorrect value of -1 is sent to the client when the DML statement that fails is contained in a TRY-CATCH block and is either autoparameterized by the [!INCLUDE[ssDE](../includes/ssde-md.md)] or the TRY-CATCH block is not on the same level as the failed statement.</span></span> <span data-ttu-id="b0a46-170">たとえば、TRY-CATCH ブロックがストアド プロシージャを呼び出し、そのプロシージャ内の DML ステートメントが失敗した場合、クライアントは -1 という間違った値を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-170">For example, if a TRY-CATCH block calls a stored procedure and a DML statement in the procedure fails, the client will incorrectly receive a -1 value.</span></span><br /><br /> <span data-ttu-id="b0a46-171">この不適切な動作に依存するアプリケーションは失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-171">Applications that rely on this incorrect behavior will fail.</span></span>|  
|<span data-ttu-id="b0a46-172">SERVERPROPERTY (' Edition ')</span><span class="sxs-lookup"><span data-stu-id="b0a46-172">SERVERPROPERTY ('Edition')</span></span>|<span data-ttu-id="b0a46-173">[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] インスタンスのインストールされている製品のエディション。</span><span class="sxs-lookup"><span data-stu-id="b0a46-173">Installed product edition of the instance of [!INCLUDE[ssSQL11](../includes/sssql11-md.md)].</span></span> <span data-ttu-id="b0a46-174">このプロパティの値を使用すると、インストールされている製品でサポートされている CPU の最大数など、機能や制限を確認できます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-174">Use the value of this property to determine the features and the limits, such as maximum number of CPUs that are supported by the installed product.</span></span><br /><br /> <span data-ttu-id="b0a46-175">インストールされている Enterprise edition に基づいて、"Enterprise Edition" または "Enterprise Edition: コアベースのライセンス" が返される場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-175">Based on the installed Enterprise edition, this can return 'Enterprise Edition' or 'Enterprise Edition: Core-based Licensing'.</span></span> <span data-ttu-id="b0a46-176">Enterprise のエディションは、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] の単一のインスタンスによる最大計算容量に基づいて区別されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-176">The Enterprise editions are differentiated based on the maximum compute capacity by a single instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b0a46-177">の計算容量制限の詳細について [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] は、「 [SQL Server のエディション別の計算容量制限](../sql-server/compute-capacity-limits-by-edition-of-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-177">For more information on Compute capacity limits in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], see [Compute Capacity Limits by Edition of SQL Server](../sql-server/compute-capacity-limits-by-edition-of-sql-server.md).</span></span>|  
|<span data-ttu-id="b0a46-178">CREATE LOGIN</span><span class="sxs-lookup"><span data-stu-id="b0a46-178">CREATE LOGIN</span></span>|<span data-ttu-id="b0a46-179">`CREATE LOGIN WITH PASSWORD = '`*パスワード* `' HASHED` オプションは、7以前で作成されたハッシュでは使用できません [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="b0a46-179">The `CREATE LOGIN WITH PASSWORD = '`*password*`' HASHED` option cannot be used with hashes created by [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 7 or earlier.</span></span>|  
|<span data-ttu-id="b0a46-180">`datetimeoffset` の CAST 操作と CONVERT 操作</span><span class="sxs-lookup"><span data-stu-id="b0a46-180">CAST and CONVERT operations for `datetimeoffset`</span></span>|<span data-ttu-id="b0a46-181">日付型と時刻型を `datetimeoffset` に変換するときにサポートされているスタイルは、0 または 1 のみです。</span><span class="sxs-lookup"><span data-stu-id="b0a46-181">The only styles that are supported when converting from date and time types to `datetimeoffset` are 0 or 1.</span></span> <span data-ttu-id="b0a46-182">他のすべての変換スタイルでは 9809 が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-182">All other conversion styles return error 9809.</span></span> <span data-ttu-id="b0a46-183">たとえば、次のコードではエラー 9809 が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-183">For example, the following code returns error 9809.</span></span><br /><br /> `SELECT CONVERT(date, CAST('7070-11-25 16:25:01.00986 -02:07' as datetimeoffset(5)), 107);`|  
  
### <a name="dynamic-management-views"></a><span data-ttu-id="b0a46-184">動的管理ビュー</span><span class="sxs-lookup"><span data-stu-id="b0a46-184">Dynamic Management Views</span></span>  
  
|<span data-ttu-id="b0a46-185">表示</span><span class="sxs-lookup"><span data-stu-id="b0a46-185">View</span></span>|<span data-ttu-id="b0a46-186">[説明]</span><span class="sxs-lookup"><span data-stu-id="b0a46-186">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="b0a46-187">sys.dm_exec_requests</span><span class="sxs-lookup"><span data-stu-id="b0a46-187">sys.dm_exec_requests</span></span>|<span data-ttu-id="b0a46-188">command 列が `nvarchar(16)` から `nvarchar(32)` に変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-188">The command column changes from `nvarchar(16)` to `nvarchar(32)`.</span></span>|  
|<span data-ttu-id="b0a46-189">sys.dm_os_memory_cache_counters</span><span class="sxs-lookup"><span data-stu-id="b0a46-189">sys.dm_os_memory_cache_counters</span></span>|<span data-ttu-id="b0a46-190">次の列の名前が変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-190">The following columns have been renamed:</span></span><br /><br /> <span data-ttu-id="b0a46-191">single_pages_kb は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-191">single_pages_kb is now:</span></span> <br />                          <span data-ttu-id="b0a46-192">pages_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-192">pages_kb</span></span><br /><br /> <span data-ttu-id="b0a46-193">multi_pages_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-193">multi_pages_kb</span></span><br />                           <span data-ttu-id="b0a46-194">次のようになりました: pages_in_use_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-194">is now: pages_in_use_kb</span></span>|  
|<span data-ttu-id="b0a46-195">sys.dm_os_memory_cache_entries</span><span class="sxs-lookup"><span data-stu-id="b0a46-195">sys.dm_os_memory_cache_entries</span></span>|<span data-ttu-id="b0a46-196">列 pages_allocated_count 列の名前が pages_kb に変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-196">The column pages_allocated_count column has been renamed pages_kb.</span></span>|  
|<span data-ttu-id="b0a46-197">sys.dm_os_memory_clerks</span><span class="sxs-lookup"><span data-stu-id="b0a46-197">sys.dm_os_memory_clerks</span></span>|<span data-ttu-id="b0a46-198">列 multi_pages_kb が削除されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-198">The column multi_pages_kb has been removed.</span></span><br /><br /> <span data-ttu-id="b0a46-199">列 single_pages_kb 列の名前が pages_kb に変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-199">The column single_pages_kb column has been renamed pages_kb.</span></span>|  
|<span data-ttu-id="b0a46-200">sys.dm_os_memory_nodes</span><span class="sxs-lookup"><span data-stu-id="b0a46-200">sys.dm_os_memory_nodes</span></span>|<span data-ttu-id="b0a46-201">次の列の名前が変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-201">The following columns have been renamed:</span></span><br /><br /> <span data-ttu-id="b0a46-202">single_pages_kb は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-202">single_pages_kb is now:</span></span> <br />                            <span data-ttu-id="b0a46-203">pages_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-203">pages_kb</span></span><br /><br /> <span data-ttu-id="b0a46-204">multi_pages_kb は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-204">multi_pages_kb is now:</span></span> <br />                            <span data-ttu-id="b0a46-205">foreign_committed_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-205">foreign_committed_kb</span></span>|  
|<span data-ttu-id="b0a46-206">sys.dm_os_memory_objects</span><span class="sxs-lookup"><span data-stu-id="b0a46-206">sys.dm_os_memory_objects</span></span>|<span data-ttu-id="b0a46-207">以下の列の名前が変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-207">The following columns have been renamed.</span></span><br /><br /> <span data-ttu-id="b0a46-208">pages_allocated_count は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-208">pages_allocated_count is now:</span></span><br />                            <span data-ttu-id="b0a46-209">pages_in_bytes</span><span class="sxs-lookup"><span data-stu-id="b0a46-209">pages_in_bytes</span></span><br /><br /> <span data-ttu-id="b0a46-210">max_pages_allocated_count は次のようになりました: max_pages_in_bytes</span><span class="sxs-lookup"><span data-stu-id="b0a46-210">max_pages_allocated_count is now: max_pages_in_bytes</span></span>|  
|<span data-ttu-id="b0a46-211">sys.dm_os_sys_info</span><span class="sxs-lookup"><span data-stu-id="b0a46-211">sys.dm_os_sys_info</span></span>|<span data-ttu-id="b0a46-212">次の列の名前が変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-212">The following columns have been renamed:</span></span><br /><br /> <span data-ttu-id="b0a46-213">physical_memory_in_bytes は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-213">physical_memory_in_bytes is now:</span></span> <br />                            <span data-ttu-id="b0a46-214">physical_memory_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-214">physical_memory_kb</span></span><br /><br /> <span data-ttu-id="b0a46-215">bpool_commit_target は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-215">bpool_commit_target is now:</span></span> <br />                            <span data-ttu-id="b0a46-216">committed_target_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-216">committed_target_kb</span></span><br /><br /> <span data-ttu-id="b0a46-217">bpool_visible は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-217">bpool_visible is now:</span></span> <br />                            <span data-ttu-id="b0a46-218">visible_target_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-218">visible_target_kb</span></span><br /><br /> <span data-ttu-id="b0a46-219">virtual_memory_in_bytes は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-219">virtual_memory_in_bytes is now:</span></span> <br />                            <span data-ttu-id="b0a46-220">virtual_memory_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-220">virtual_memory_kb</span></span><br /><br /> <span data-ttu-id="b0a46-221">bpool_commited は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-221">bpool_commited is now:</span></span><br />                            <span data-ttu-id="b0a46-222">committed_kb</span><span class="sxs-lookup"><span data-stu-id="b0a46-222">committed_kb</span></span>|  
|<span data-ttu-id="b0a46-223">sys.dm_os_workers</span><span class="sxs-lookup"><span data-stu-id="b0a46-223">sys.dm_os_workers</span></span>|<span data-ttu-id="b0a46-224">ロケール列は削除されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-224">The locale column has been removed.</span></span>|  
  
### <a name="catalog-views"></a><span data-ttu-id="b0a46-225">カタログ ビュー</span><span class="sxs-lookup"><span data-stu-id="b0a46-225">Catalog Views</span></span>  
  
|<span data-ttu-id="b0a46-226">表示</span><span class="sxs-lookup"><span data-stu-id="b0a46-226">View</span></span>|<span data-ttu-id="b0a46-227">[説明]</span><span class="sxs-lookup"><span data-stu-id="b0a46-227">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="b0a46-228">sys.data_spaces</span><span class="sxs-lookup"><span data-stu-id="b0a46-228">sys.data_spaces</span></span><br /><br /> <span data-ttu-id="b0a46-229">sys.partition_schemes</span><span class="sxs-lookup"><span data-stu-id="b0a46-229">sys.partition_schemes</span></span><br /><br /> <span data-ttu-id="b0a46-230">sys.filegroups</span><span class="sxs-lookup"><span data-stu-id="b0a46-230">sys.filegroups</span></span><br /><br /> <span data-ttu-id="b0a46-231">sys.partition_functions</span><span class="sxs-lookup"><span data-stu-id="b0a46-231">sys.partition_functions</span></span>|<span data-ttu-id="b0a46-232">sys.data_spaces と sys.partition_functions に、新しい列 (is_system) が追加されました </span><span class="sxs-lookup"><span data-stu-id="b0a46-232">A new column, is_system, has been added to sys.data_spaces and sys.partition_functions.</span></span> <span data-ttu-id="b0a46-233">(sys.partition_schemes と sys.filegroups は、sys.data_spaces の列を継承します)。</span><span class="sxs-lookup"><span data-stu-id="b0a46-233">(sys.partition_schemes and sys.filegroups inherit the columns of sys.data_spaces.)</span></span><br /><br /> <span data-ttu-id="b0a46-234">この列では、値 1 は、そのオブジェクトがフルテキスト インデックス フラグメントに使用されることを示します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-234">A value of 1 in this column indicates that the object is used for full-text index fragments.</span></span><br /><br /> <span data-ttu-id="b0a46-235">sys.partition_functions、sys.partition_schemes、および sys.filegroups では、この新しい列は末尾の列ではありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-235">In sys.partition_functions, sys.partition_schemes, and sys.filegroups, the new column is not the last column.</span></span> <span data-ttu-id="b0a46-236">これらのカタログ ビューから返される列の順序に依存する既存のクエリを修正してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-236">Revise existing queries that rely on the order of columns returned from these catalog views.</span></span>|  
  
### <a name="sql-clr-data-types-geometry-geography-and-hierarchyid"></a><span data-ttu-id="b0a46-237">SQL CLR データ型 (geometry、geography、および hierarchyid)</span><span class="sxs-lookup"><span data-stu-id="b0a46-237">SQL CLR Data Types (geometry, geography, and hierarchyid)</span></span>  
 <span data-ttu-id="b0a46-238">空間データ型および hierarchyid 型を含むアセンブリ**Microsoft.SqlServer.Types.dll**が、バージョン10.0 からバージョン11.0 にアップグレードされました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-238">The assembly **Microsoft.SqlServer.Types.dll**, which contains the spatial data types and the hierarchyid type, has been upgraded from version 10.0 to version 11.0.</span></span> <span data-ttu-id="b0a46-239">このアセンブリを参照するカスタム アプリケーションは、次の条件に該当する場合に失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-239">Custom applications that reference this assembly may fail when the following conditions are true.</span></span>  
  
-   <span data-ttu-id="b0a46-240">がインストールされているコンピューターから、がインストールされているコンピューターにカスタムアプリケーションを移動すると、参照されている [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] バージョン10.0 の**SqlTypes**アセンブリが存在しないため、アプリケーションは失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-240">When you move a custom application from a computer on which [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] was installed to a computer on which only [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] is installed, the application will fail because the referenced version 10.0 of the **SqlTypes** assembly is not present.</span></span> <span data-ttu-id="b0a46-241">この場合、次のエラー メッセージが返されることがあります: `"Could not load file or assembly 'Microsoft.SqlServer.Types, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91' or one of its dependencies. The system cannot find the file specified."`</span><span class="sxs-lookup"><span data-stu-id="b0a46-241">You may see this error message: `"Could not load file or assembly 'Microsoft.SqlServer.Types, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91' or one of its dependencies. The system cannot find the file specified."`</span></span>  
  
-   <span data-ttu-id="b0a46-242">**SqlTypes**アセンブリバージョン11.0 を参照するときに、バージョン10.0 もインストールされていると、次のエラーメッセージが表示されることがあります。`"System.InvalidCastException: Unable to cast object of type 'Microsoft.SqlServer.Types.SqlGeometry' to type 'Microsoft.SqlServer.Types.SqlGeometry'."`</span><span class="sxs-lookup"><span data-stu-id="b0a46-242">When you reference the **SqlTypes** assembly version 11.0, and version 10.0 is also installed, you may see this error message: `"System.InvalidCastException: Unable to cast object of type 'Microsoft.SqlServer.Types.SqlGeometry' to type 'Microsoft.SqlServer.Types.SqlGeometry'."`</span></span>  
  
-   <span data-ttu-id="b0a46-243">.NET 3.5、4、または4.5 を対象とするカスタムアプリケーションから**SqlTypes**アセンブリバージョン11.0 を参照する場合、アプリケーションは失敗します。これは、の仕様では、アセンブリのバージョン10.0 が読み込まれるためです。</span><span class="sxs-lookup"><span data-stu-id="b0a46-243">When you reference the **SqlTypes** assembly version 11.0 from a custom application that targets .NET 3.5, 4, or 4.5, the application will fail because SqlClient by design loads version 10.0 of the assembly.</span></span> <span data-ttu-id="b0a46-244">このエラーは、アプリケーションが次のいずれかのメソッドを呼び出したときに発生します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-244">This failure occurs when the application calls one of the following methods:</span></span>  
  
    -   <span data-ttu-id="b0a46-245">`GetValue` クラスの `SqlDataReader` メソッド</span><span class="sxs-lookup"><span data-stu-id="b0a46-245">`GetValue` method of the `SqlDataReader` class</span></span>  
  
    -   <span data-ttu-id="b0a46-246">`GetValues` クラスの `SqlDataReader` メソッド</span><span class="sxs-lookup"><span data-stu-id="b0a46-246">`GetValues` method of the `SqlDataReader` class</span></span>  
  
    -   <span data-ttu-id="b0a46-247">`SqlDataReader` クラスの角かっこインデックス演算子 []</span><span class="sxs-lookup"><span data-stu-id="b0a46-247">bracket index operator [] of the `SqlDataReader` class</span></span>  
  
    -   <span data-ttu-id="b0a46-248">`ExecuteScalar` クラスの `SqlCommand` メソッド</span><span class="sxs-lookup"><span data-stu-id="b0a46-248">`ExecuteScalar` method of the `SqlCommand` class</span></span>  
  
 <span data-ttu-id="b0a46-249">この問題は、次のいずれかの方法を使用して回避できます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-249">You can work around this issue by using one of the following methods:</span></span>  
  
-   <span data-ttu-id="b0a46-250">この問題を回避するには、コード内で、上にリストされている Get メソッドの代わりに `GetSqlBytes` メソッドを呼び出して、CLR [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] システム型を取得します。次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-250">You can work around this issue in your code by calling the `GetSqlBytes` method, instead of the Get methods listed above, to retrieve CLR [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] system types, as shown in the following example:</span></span>  
  
    ```csharp  
    string query = "SELECT [SpatialColumn] FROM [SpatialTable]";  
          using (SqlConnection conn = new SqlConnection("..."))  
          {  
                SqlCommand cmd = new SqlCommand(query, conn);  
  
                conn.Open();  
                SqlDataReader reader = cmd.ExecuteReader();  
  
                while (reader.Read())  
                {  
                      // In version 11.0 only  
                      SqlGeometry g =   
    SqlGeometry.Deserialize(reader.GetSqlBytes(0));  
  
                      // In version 10.0 or 11.0  
                      SqlGeometry g2 = new SqlGeometry();  
                      g.Read(new BinaryReader(reader.GetSqlBytes(0).Stream));  
                }  
          }  
    ```  
  
-   <span data-ttu-id="b0a46-251">この問題を回避するには、アプリケーション構成ファイル内でアセンブリのリダイレクトを使用します。次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-251">You can work around this issue by using assembly redirection in the application configuration file, as shown in the following example:</span></span>  
  
    ```xml  
    <runtime>  
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">  
        ...  
        <dependentAssembly>  
            <assemblyIdentity name="Microsoft.SqlServer.Types" publicKeyToken="89845dcd8080cc91" culture="neutral" />  
            <bindingRedirect oldVersion="10.0.0.0" newVersion="11.0.0.0" />  
        </dependentAssembly>  
        ...  
    </assemblyBinding>  
    <runtime>  
    ```  
  
-   <span data-ttu-id="b0a46-252">この問題を回避するには、接続文字列内で、"Type System Version" 属性の値を "SQL Server 2012" と指定することにより、SqlClient がバージョン 11.0 のアセンブリを読み込むようにします。</span><span class="sxs-lookup"><span data-stu-id="b0a46-252">You can work around this issue in your connection string by specifying a value of "SQL Server 2012" for the "Type System Version" attribute to force SqlClient to load version 11.0 of the assembly.</span></span> <span data-ttu-id="b0a46-253">この接続文字列属性は、.NET 4.5 以上でのみ使用可能です。</span><span class="sxs-lookup"><span data-stu-id="b0a46-253">This connection string attribute is available only in .NET 4.5 and above.</span></span>  
  
-   <span data-ttu-id="b0a46-254">`assemblyBinding` タグは `runtime` タグの下に含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-254">The `assemblyBinding` tag should be wrapped under the `runtime` tag.</span></span>  
  
### <a name="support-for-awe"></a><span data-ttu-id="b0a46-255">AWE のサポート</span><span class="sxs-lookup"><span data-stu-id="b0a46-255">Support for AWE</span></span>  
 <span data-ttu-id="b0a46-256">32 ビット Address Windowing Extensions (AWE) のサポートは廃止されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-256">32-bit Address Windowing Extensions (AWE) support is discontinued.</span></span> <span data-ttu-id="b0a46-257">これにより、32 ビット オペレーティング システム上でのパフォーマンスが低下する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-257">This might result in slower performance on 32-bit operating systems.</span></span> <span data-ttu-id="b0a46-258">大量のメモリを使用するインストールについては、64 ビット オペレーティング システムに移行してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-258">For installations using large amounts of memory, migrate to a 64-bit operating system.</span></span>  
  
### <a name="xquery-functions-are-surrogate-aware"></a><span data-ttu-id="b0a46-259">サロゲート対応の XQuery 関数</span><span class="sxs-lookup"><span data-stu-id="b0a46-259">XQuery Functions Are Surrogate-Aware</span></span>  
 <span data-ttu-id="b0a46-260">W3C 勧告では、XQuery 関数および演算子は、上位 Unicode 文字を表すサロゲート ペアを UTF-16 エンコードの単一グリフとしてカウントするよう要求されています。</span><span class="sxs-lookup"><span data-stu-id="b0a46-260">The W3C recommendation for XQuery functions and operators requires them to count a surrogate pair that represents a high-range Unicode character as a single glyph in UTF-16 encoding.</span></span> <span data-ttu-id="b0a46-261">しかし、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 以前のバージョンの [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] では、文字列関数はサロゲート ペアを単一の文字として認識しません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-261">However, in versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] prior to [!INCLUDE[ssSQL11](../includes/sssql11-md.md)], string functions did not recognize surrogate pairs as a single character.</span></span> <span data-ttu-id="b0a46-262">文字列操作 (文字列長の計算、部分文字列の抽出など) では、正しくない結果が返されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-262">Some string operations - such as string length calculations and substring extractions - returned incorrect results.</span></span> [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] <span data-ttu-id="b0a46-263">では、UTF-16 と、サロゲート ペアの正しい処理が完全にサポートされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-263">now fully supports UTF-16 and the correct handling of surrogate pairs.</span></span>  
  
 <span data-ttu-id="b0a46-264">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] の XML データ型では、整形式のサロゲート ペアのみが許可されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-264">The XML data type in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] only allows well-formed surrogate pairs.</span></span> <span data-ttu-id="b0a46-265">ただし、一部の関数では、一定の状況下において、未定義または予期しない結果が依然として返されることがあります。これは、無効または部分的なサロゲート ペアが XQuery 関数に文字列値として渡される可能性があるためです。</span><span class="sxs-lookup"><span data-stu-id="b0a46-265">However, some functions can still return undefined or unexpected results in certain circumstances, since it is possible to pass invalid or partial surrogate pairs to XQuery functions as string values.</span></span> <span data-ttu-id="b0a46-266">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] で XQuery を使用する場合は、次の方法で文字列値を生成することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-266">Consider the following methods for generating string values when using XQuery in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="b0a46-267">定数文字列値をバイナリ値として提供する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-267">Provide a constant string value as a binary value.</span></span> <span data-ttu-id="b0a46-268">この方法を使用した場合、無効または部分的なサロゲート ペアが渡される可能性は残ります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-268">When using this method, it remains possible to pass invalid or partial surrogate pairs.</span></span>  
  
-   <span data-ttu-id="b0a46-269">定数文字列値を、文字エンティティを提供することによって提供する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-269">Provide a constant string value by providing character entities.</span></span> <span data-ttu-id="b0a46-270">この方法を使用した場合、無効なサロゲート ペアを渡すことはできなくなります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-270">When using this method, it is not possible to pass invalid surrogate pairs.</span></span> <span data-ttu-id="b0a46-271">XQuery 関数では、高レベルの文字に単一の文字エンティティを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-271">The XQuery functions require a single character entity for the high-level character.</span></span> <span data-ttu-id="b0a46-272">これらの関数では、サロゲート ペア文字用の文字エンティティが提供された場合にエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-272">These functions raise an error if the character entities for the surrogate pair characters are provided.</span></span>  
  
-   <span data-ttu-id="b0a46-273">**Sql: column**または**sql: variable**を使用して外部の値をインポートします。</span><span class="sxs-lookup"><span data-stu-id="b0a46-273">Import external values by using **sql:column** or **sql:variable**.</span></span> <span data-ttu-id="b0a46-274">これらの方法を使用した場合、無効または部分的なサロゲート ペアが使用される可能性は残ります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-274">When using these methods, it remains possible to introduce invalid or partial surrogate pairs.</span></span>  
  
#### <a name="affected-xquery-functions-and-operators"></a><span data-ttu-id="b0a46-275">影響を受ける XQuery 関数と演算子</span><span class="sxs-lookup"><span data-stu-id="b0a46-275">Affected XQuery Functions and Operators</span></span>  
 <span data-ttu-id="b0a46-276">次の XQuery 関数および演算子は、[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] では UTF-16 のサロゲート ペアを正しく処理するようになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-276">The following XQuery functions and operators now handle UTF-16 surrogate pairs correctly in [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]:</span></span>  
  
-   <span data-ttu-id="b0a46-277">**fn: 文字列の長さ**。</span><span class="sxs-lookup"><span data-stu-id="b0a46-277">**fn:string-length**.</span></span> <span data-ttu-id="b0a46-278">ただし、無効または部分的なサロゲートペアが引数として渡された場合、**文字列長**の動作は未定義になります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-278">However, if an invalid or partial surrogate pair is passed as an argument, the behavior of **string-length** is undefined.</span></span>  
  
-   <span data-ttu-id="b0a46-279">**fn: substring**。</span><span class="sxs-lookup"><span data-stu-id="b0a46-279">**fn:substring**.</span></span>  
  
-   <span data-ttu-id="b0a46-280">**fn: contains が含まれて**います。</span><span class="sxs-lookup"><span data-stu-id="b0a46-280">**fn:contains**.</span></span> <span data-ttu-id="b0a46-281">ただし、部分的なサロゲートペアが値として渡された場合、 **contains**は、適切な形式のサロゲートペアに含まれる部分的なサロゲートペアを見つけることがあるため、予期しない結果が返されることがあります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-281">However, if a partial surrogate pair is passed as a value, **contains** may return unexpected results, since it may find the partial surrogate pair contained in well-formed surrogate pair.</span></span>  
  
-   <span data-ttu-id="b0a46-282">**fn: concat**。</span><span class="sxs-lookup"><span data-stu-id="b0a46-282">**fn:concat**.</span></span> <span data-ttu-id="b0a46-283">ただし、部分的なサロゲートペアが値として渡された場合、 **concat**では正しくないサロゲートペアまたは部分的なサロゲートペアが生成されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-283">However, if a partial surrogate pair is passed as a value, **concat** can produce incorrect surrogate pairs or partial surrogate pairs.</span></span>  
  
-   <span data-ttu-id="b0a46-284">比較演算子と**order by**句。</span><span class="sxs-lookup"><span data-stu-id="b0a46-284">Comparison operators and the **order by** clause.</span></span> <span data-ttu-id="b0a46-285">比較演算子には、+、 \<, > 、=、、、、 \<=, > 、およびがあり `eq` `lt` `gt` `le` `ge` ます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-285">Comparison operators include +, \<, >, \<=, >=, `eq`, `lt`, `gt`, `le`, and `ge`.</span></span>  
  
#### <a name="distributed-query-calls-to-a-system-procedure"></a><span data-ttu-id="b0a46-286">システムプロシージャに対する分散クエリ呼び出し</span><span class="sxs-lookup"><span data-stu-id="b0a46-286">Distributed Query Calls to a System Procedure</span></span>  
 <span data-ttu-id="b0a46-287">`OPENQUERY` を通じた一部のシステム プロシージャへの分散クエリ呼び出しは、[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] から別のサーバーへの呼び出しである場合に失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-287">Distributed query calls through `OPENQUERY` to some system procedures will fail when called from one [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] server to another.</span></span> <span data-ttu-id="b0a46-288">これは、[!INCLUDE[ssDE](../includes/ssde-md.md)]がプロシージャのメタデータを検出できない場合に発生します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-288">This occurs when the [!INCLUDE[ssDE](../includes/ssde-md.md)] cannot discovery metadata for a procedure.</span></span> <span data-ttu-id="b0a46-289">たとえば、「 `SELECT * FROM OPENQUERY(..., 'EXEC xp_loginfo')` 」のように入力します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-289">For example, `SELECT * FROM OPENQUERY(..., 'EXEC xp_loginfo')`.</span></span>  
  
#### <a name="isolation-level-and-sp_reset_connection"></a><span data-ttu-id="b0a46-290">分離レベルと sp_reset_connection</span><span class="sxs-lookup"><span data-stu-id="b0a46-290">Isolation Level and sp_reset_connection</span></span>  
 <span data-ttu-id="b0a46-291">接続の分離レベルは、クライアント ドライバーによって次のように処理されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-291">The isolation level for connections is handled in the following way by client drivers:</span></span>  
  
-   <span data-ttu-id="b0a46-292">すべてのネイティブのドライバー (SNAC、MDAC、ODBC) では、sp_reset_connection において (アプリケーション設定に基づいて) 分離レベルが設定されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-292">All of the native drivers (SNAC, MDAC, ODBC) set the isolation level (based on app setting) upon sp_reset_connection.</span></span>  
  
-   <span data-ttu-id="b0a46-293">ADO.NET では、実際にはプールから取得する接続によって (かつアプリケーションが異なる分離レベルを使用するかに応じて)、ランダムな分離レベルが得られます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-293">For ADO.NET you will essentially get a random isolation level depending on which connection you get from the pool (and if the application uses different isolation level).</span></span> <span data-ttu-id="b0a46-294">ADO.NET のプールは、内部的かつ透過的に接続をリサイクルできます。プールから何が出てくるかを予測することはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-294">Since ADO.NET pool can recycle connections internally and transparently, you cannot predict what will come out of the pool.</span></span>  
  
-   <span data-ttu-id="b0a46-295">JDBC Driver では、動作は ADO.NET と同じになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-295">For the JDBC driver you get same behavior as ADO.NET</span></span>  
  
     <span data-ttu-id="b0a46-296">アプリケーションは、必要なものを取得するために接続を開いた後、常に明示的に分離レベルを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-296">The application must always explicitly set isolation level after opening the connection to get what it wants.</span></span>  
  
     <span data-ttu-id="b0a46-297">JDBC の接続はプールすることができます。そのため、アプリケーションがランダムな分離レベルを取得しても、それについて認識されていない場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-297">The JDBC connection can be pooled, so the application may get a random isolation level and not know about it.</span></span>  
  
 <span data-ttu-id="b0a46-298">下位互換性を保持するため、この新しい動作は TDS 7.4 以降の最近使用したクライアントに対してのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-298">To preserve backward compatibility this new behavior only applies for recent clients beginning with TDS 7.4.</span></span>  
  
#### <a name="backward-compatibility"></a><span data-ttu-id="b0a46-299">Backward Compatibility</span><span class="sxs-lookup"><span data-stu-id="b0a46-299">Backward Compatibility</span></span>  
 <span data-ttu-id="b0a46-300">**新しい動作は互換性レベルに依存します**</span><span class="sxs-lookup"><span data-stu-id="b0a46-300">**New behavior depends on compatibility level**</span></span>  
  
 <span data-ttu-id="b0a46-301">次の関数と演算子は、互換性レベルが 110 以上の場合にのみ、上記の新しい動作を示します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-301">The following functions and operators demonstrate the new behavior described above only when the compatibility level is 110 or higher:</span></span>  
  
-   <span data-ttu-id="b0a46-302">**fn: contains が含まれて**います。</span><span class="sxs-lookup"><span data-stu-id="b0a46-302">**fn:contains**.</span></span>  
  
-   <span data-ttu-id="b0a46-303">**fn: concat**。</span><span class="sxs-lookup"><span data-stu-id="b0a46-303">**fn:concat**.</span></span>  
  
-   <span data-ttu-id="b0a46-304">比較演算子と**order by**句</span><span class="sxs-lookup"><span data-stu-id="b0a46-304">comparison operators and **order by** clause</span></span>  
  
 <span data-ttu-id="b0a46-305">**新しい動作は、関数の既定の名前空間 URI に依存します**</span><span class="sxs-lookup"><span data-stu-id="b0a46-305">**New behavior depends on default namespace URI for functions**</span></span>  
  
 <span data-ttu-id="b0a46-306">次の関数は、既定の名前空間 URI が最終的な推奨設定の名前空間に対応する場合にのみ、上記の新しい動作を示して [http://www.w3.org/2005/xpath-functions](http://www.w3.org/2005/xpath-functions) います。</span><span class="sxs-lookup"><span data-stu-id="b0a46-306">The following functions demonstrate the new behavior described above only when the default namespace URI corresponds to the namespace in the final recommendation, that is, [http://www.w3.org/2005/xpath-functions](http://www.w3.org/2005/xpath-functions).</span></span> <span data-ttu-id="b0a46-307">互換性レベルが 110 以上の場合、既定では、[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] は既定の関数名前空間をこの名前空間にバインドします。</span><span class="sxs-lookup"><span data-stu-id="b0a46-307">When the compatibility level is 110 or higher, then by default [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] binds the default function namespace to this namespace.</span></span> <span data-ttu-id="b0a46-308">ただし、これらの関数は、この名前空間が互換性レベルにかかわらず使用される場合にのみ、新しい動作を示します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-308">However these functions demonstrate the new behavior when this namespace is used regardless of the compatibility level.</span></span>  
  
-   <span data-ttu-id="b0a46-309">**fn: 文字列の長さ**</span><span class="sxs-lookup"><span data-stu-id="b0a46-309">**fn:string-length**</span></span>  
  
-   <span data-ttu-id="b0a46-310">**fn: substring**</span><span class="sxs-lookup"><span data-stu-id="b0a46-310">**fn:substring**</span></span>  
  
##  <a name="breaking-changes-in-sql-server-2008sql-server-2008r2"></a><a name="KJKatmai"></a><span data-ttu-id="b0a46-311">SQL Server 2008/SQL Server 2008R2 での重大な変更</span><span class="sxs-lookup"><span data-stu-id="b0a46-311">Breaking Changes in SQL Server 2008/SQL Server 2008R2</span></span>  
 <span data-ttu-id="b0a46-312">このセクションでは、[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] で導入された重大な変更について説明します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-312">This section contains the breaking changes introduced in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="b0a46-313">[!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] で導入された変更はありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-313">No changes were introduced in [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)].</span></span>  
  
### <a name="collations"></a><span data-ttu-id="b0a46-314">照合順序</span><span class="sxs-lookup"><span data-stu-id="b0a46-314">Collations</span></span>  
  
|<span data-ttu-id="b0a46-315">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-315">Feature</span></span>|<span data-ttu-id="b0a46-316">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-316">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-317">新しい照合順序</span><span class="sxs-lookup"><span data-stu-id="b0a46-317">New collations</span></span>|[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] <span data-ttu-id="b0a46-318">では、Windows Server 2008 が提供する照合順序に完全に対応する新しい照合順序が導入されています。</span><span class="sxs-lookup"><span data-stu-id="b0a46-318">introduces new collations that are in full alignment with the collations provided by Windows Server 2008.</span></span> <span data-ttu-id="b0a46-319">この 80 個の新しい照合順序は、言語面での精度が向上しており、\*_100 というバージョン参照で示されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-319">These 80 new collations have improved linguistic accuracy and are denoted by \*_100 version references.</span></span> <span data-ttu-id="b0a46-320">サーバーまたはデータベースに新しい照合順序を選択する場合は、古いクライアント ドライバーを使用するクライアントではその照合順序が認識されない可能性があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-320">If you choose a new collation for your server or database, be aware that the collation may not be recognized by clients with older client drivers.</span></span> <span data-ttu-id="b0a46-321">照合順序が認識されないと、アプリケーションはエラーを返して失敗する場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-321">Unrecognized collations can cause the application to return errors and fail.</span></span> <span data-ttu-id="b0a46-322">次の解決策を検討してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-322">Consider the following solutions:</span></span><br /><br /> <span data-ttu-id="b0a46-323">クライアント オペレーティング システムをアップグレードして、基になるシステムの照合順序を更新する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-323">Upgrade the client operating system so that the underlying system collations are updated.</span></span><br /><br /> <span data-ttu-id="b0a46-324">クライアントにデータベース クライアント ソフトウェアがインストールされている場合、データベース クライアント ソフトウェアにサービスの更新プログラムを適用する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-324">If your client has database client software installed, consider applying a service update to the database client software.</span></span><br /><br /> <span data-ttu-id="b0a46-325">クライアントのコード ページにマップする既存の照合順序を選択する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-325">Choose an existing collation that maps to a code page on the client.</span></span>|  
  
### <a name="common-language-runtime-clr"></a><span data-ttu-id="b0a46-326">共通言語ランタイム (CLR)</span><span class="sxs-lookup"><span data-stu-id="b0a46-326">Common Language Runtime (CLR)</span></span>  
  
|<span data-ttu-id="b0a46-327">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-327">Feature</span></span>|<span data-ttu-id="b0a46-328">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-328">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-329">CLR アセンブリ</span><span class="sxs-lookup"><span data-stu-id="b0a46-329">CLR Assemblies</span></span>|<span data-ttu-id="b0a46-330">データベースを [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] にアップグレードすると、新しいデータ型をサポートする `Microsoft.SqlServer.Types` アセンブリが自動的にインストールされます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-330">When a database is upgraded to [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], the `Microsoft.SqlServer.Types` assembly to support new data types is automatically installed.</span></span> <span data-ttu-id="b0a46-331">アップグレードアドバイザールールでは、名前が競合するユーザーの種類またはアセンブリが検出されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-331">Upgrade Advisor rules detect any user type or assemblies with conflicting names.</span></span> <span data-ttu-id="b0a46-332">アップグレードアドバイザーは、競合しているアセンブリの名前を変更し、競合している型の名前を変更するか、コード内の2つの部分で構成される名前を使用して、既存のユーザーの種類を参照します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-332">The Upgrade Advisor will advise renaming of any conflicting assembly, and either renaming any conflicting type, or using two-part names in the code to refer to that preexisting user type.</span></span><br /><br /> <span data-ttu-id="b0a46-333">データベースのアップグレードによって、競合する名前を持つユーザーアセンブリが検出されると、そのアセンブリの名前が自動的に変更され、データベースが問題のあるモードになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-333">If a database upgrade detects a user assembly with a conflicting name, it will automatically rename that assembly and put the database into suspect mode.</span></span><br /><br /> <span data-ttu-id="b0a46-334">アップグレード時に競合する名前を持つユーザー型が検出された場合、特別な処理は実行されません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-334">If a user type with conflicting name exists during the upgrade, no special steps are taken.</span></span> <span data-ttu-id="b0a46-335">アップグレード後は、古いユーザー型と新しいシステム型の両方が存在することになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-335">After the upgrade, both the old user type, and the new system type, will exist.</span></span> <span data-ttu-id="b0a46-336">ユーザー型は、2 つの部分から構成される名前を介してのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-336">The user type will be available only through two-part names.</span></span>|  
|<span data-ttu-id="b0a46-337">CLR アセンブリ</span><span class="sxs-lookup"><span data-stu-id="b0a46-337">CLR Assemblies</span></span>|[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] <span data-ttu-id="b0a46-338">では .NET Framework 3.5 SP1 がインストールされ、グローバル アセンブリ キャッシュ (GAC) 内のライブラリが更新されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-338">installs .NET Framework 3.5 SP1, which updates libraries in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="b0a46-339">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データベースにサポートされていないライブラリが登録されている場合、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] にアップグレードすると、[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] アプリケーションの動作が停止する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-339">If you have unsupported libraries registered in a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database, your [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] application may stop working after upgrading to [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="b0a46-340">これは、GAC でライブラリを提供またはアップグレードしても [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 内でアセンブリが更新されないためです。</span><span class="sxs-lookup"><span data-stu-id="b0a46-340">This is because servicing or upgrading libraries in the GAC does not update assemblies inside [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b0a46-341">アセンブリが [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データベースと GAC の両方に存在する場合、アセンブリの 2 つのコピーが完全に一致する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-341">If an assembly exists both in a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] database and in the GAC, the two copies of the assembly must exactly match.</span></span> <span data-ttu-id="b0a46-342">一致しない場合、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] CLR 統合によってアセンブリが使用されたときにエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-342">If they do not match, an error will occur when the assembly is used by [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] CLR integration.</span></span> <span data-ttu-id="b0a46-343">詳細については、「[サポートされている .NET Framework ライブラリ](../relational-databases/clr-integration/database-objects/supported-net-framework-libraries.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-343">For more information, see [Supported .NET Framework Libraries](../relational-databases/clr-integration/database-objects/supported-net-framework-libraries.md).</span></span><br /><br /> <span data-ttu-id="b0a46-344">データベースをアップグレードした後、ALTER ASSEMBLY ステートメントを使用して、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データベース内でアセンブリのコピーを提供またはアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="b0a46-344">After upgrading your database, service or upgrade the copy of the assembly inside your [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] databases with the ALTER ASSEMBLY statement.</span></span> <span data-ttu-id="b0a46-345">詳細については、[サポート技術情報の記事 949080](https://go.microsoft.com/fwlink/?LinkId=154563)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-345">For more information, see [Knowledge Base article 949080](https://go.microsoft.com/fwlink/?LinkId=154563).</span></span><br /><br /> <span data-ttu-id="b0a46-346">サポートされていない .NET Framework ライブラリをアプリケーションで使用しているかどうかを検出するには、データベースで次のクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-346">To detect whether you are using any unsupported .NET framework library in your application, run the following query in your database.</span></span><br /><br /> `SELECT name FROM sys.assemblies WHERE clr_name LIKE '%publickeytoken=b03f5f7f11d50a3a,%';`|  
|<span data-ttu-id="b0a46-347">CLR ルーチン</span><span class="sxs-lookup"><span data-stu-id="b0a46-347">CLR Routines</span></span>|<span data-ttu-id="b0a46-348">CLR のユーザー定義関数、ユーザー定義集計、またはユーザー定義型 (UDT) 内で権限借用を使用すると、[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] にアップグレードした後に、アプリケーションがエラー 6522 で失敗する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-348">Using impersonation inside CLR user-defined functions, user-defined aggregates, or user-defined types (UDTs) may cause your application to fail with error 6522 after upgrading to [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="b0a46-349">次のシナリオは、[!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] では成功しますが、[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-349">The following scenarios succeed in [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] but fail in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="b0a46-350">それぞれのシナリオに解決策があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-350">Resolutions are provided for each scenario.</span></span><br /><br /> <span data-ttu-id="b0a46-351">権限借用を使用する CLR ユーザー定義関数、ユーザー定義集計、または udt メソッドに、型、、、、、、または大きな udt のパラメーターがあり、この `nvarchar(max)` `varchar(max)` `varbinary(max)` `ntext` `text` `image` メソッドに**dataaccesskind. Read**属性がありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-351">A CLR user-defined function, user-defined aggregate, or UDT method that uses impersonation has a parameter of type `nvarchar(max)`, `varchar(max)`, `varbinary(max)`, `ntext`, `text`, `image`, or a large UDT, and does not have the **DataAccessKind.Read** attribute on the method.</span></span> <span data-ttu-id="b0a46-352">この問題を解決するには、メソッドに**Dataaccesskind. Read**属性を追加し、アセンブリを再コンパイルして、ルーチンとアセンブリを再配置します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-352">To resolve this issue, add the **DataAccessKind.Read** attribute on the method, recompile the assembly, and re-deploy the routine and the assembly.</span></span><br /><br /> <span data-ttu-id="b0a46-353">権限借用を実行する**Init**メソッドを持つ CLR テーブル値関数。</span><span class="sxs-lookup"><span data-stu-id="b0a46-353">A CLR table-valued function that has an **Init** method that performs impersonation.</span></span> <span data-ttu-id="b0a46-354">この問題を解決するには、メソッドに**Dataaccesskind. Read**属性を追加し、アセンブリを再コンパイルして、ルーチンとアセンブリを再配置します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-354">To resolve this issue add the **DataAccessKind.Read** attribute on the method, recompile the assembly, and re-deploy the routine and the assembly.</span></span><br /><br /> <span data-ttu-id="b0a46-355">権限借用を実行する**Fillrow**メソッドを持つ CLR テーブル値関数。</span><span class="sxs-lookup"><span data-stu-id="b0a46-355">A CLR table-valued function that has a **FillRow** method that performs impersonation.</span></span> <span data-ttu-id="b0a46-356">この問題を解決するには、 **Fillrow**メソッドから権限借用を削除します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-356">To resolve this issue, remove impersonation from the **FillRow** method.</span></span> <span data-ttu-id="b0a46-357">**Fillrow**メソッドを使用して外部リソースにアクセスしないでください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-357">Do not access external resources by using the **FillRow** method.</span></span> <span data-ttu-id="b0a46-358">代わりに、 **Init**メソッドから外部リソースにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="b0a46-358">Instead, access external resources from the **Init** method.</span></span>|  
  
### <a name="dynamic-management-views"></a><span data-ttu-id="b0a46-359">動的管理ビュー</span><span class="sxs-lookup"><span data-stu-id="b0a46-359">Dynamic Management Views</span></span>  
  
|<span data-ttu-id="b0a46-360">表示</span><span class="sxs-lookup"><span data-stu-id="b0a46-360">View</span></span>|<span data-ttu-id="b0a46-361">[説明]</span><span class="sxs-lookup"><span data-stu-id="b0a46-361">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="b0a46-362">sys.dm_os_sys_info</span><span class="sxs-lookup"><span data-stu-id="b0a46-362">sys.dm_os_sys_info</span></span>|<span data-ttu-id="b0a46-363">cpu_ticks_in_ms 列と sqlserver_start_time_cpu_ticks 列を削除しました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-363">Removed the cpu_ticks_in_ms and sqlserver_start_time_cpu_ticks columns.</span></span>|  
|<span data-ttu-id="b0a46-364">dm_exec_query_resource_semaphoressys。 dm_exec_query_memory_grants</span><span class="sxs-lookup"><span data-stu-id="b0a46-364">sys.dm_exec_query_resource_semaphoressys.dm_exec_query_memory_grants</span></span>|<span data-ttu-id="b0a46-365">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では、resource_semaphore_id 列は一意な ID ではありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-365">The resource_semaphore_id column is not a unique ID in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="b0a46-366">この変更は、クエリの実行のトラブルシューティングに影響する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-366">This change can affect troubleshooting query execution.</span></span> <span data-ttu-id="b0a46-367">詳細については、「 [sys. dm_exec_query_resource_semaphores &#40;transact-sql&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-query-resource-semaphores-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-367">For more information, see [sys.dm_exec_query_resource_semaphores &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-query-resource-semaphores-transact-sql).</span></span>|  
  
### <a name="errors-and-events"></a><span data-ttu-id="b0a46-368">エラーとイベント</span><span class="sxs-lookup"><span data-stu-id="b0a46-368">Errors and Events</span></span>  
  
|<span data-ttu-id="b0a46-369">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-369">Feature</span></span>|<span data-ttu-id="b0a46-370">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-370">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-371">ログイン エラー</span><span class="sxs-lookup"><span data-stu-id="b0a46-371">Login errors</span></span>|<span data-ttu-id="b0a46-372">[!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] では、Windows 認証のみを使用するように構成されたサーバーに接続する際に SQL ログインを使用すると、エラー 18452 が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-372">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], error 18452 is returned when a SQL login is used to connect to a server configured to use only Windows Authentication.</span></span> <span data-ttu-id="b0a46-373">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では、代わりに、エラー 18456 が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-373">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], error 18456 is returned instead.</span></span>|  
  
### <a name="showplan"></a><span data-ttu-id="b0a46-374">Showplan</span><span class="sxs-lookup"><span data-stu-id="b0a46-374">Showplan</span></span>  
  
|<span data-ttu-id="b0a46-375">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-375">Feature</span></span>|<span data-ttu-id="b0a46-376">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-376">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-377">プラン表示の XML スキーマ</span><span class="sxs-lookup"><span data-stu-id="b0a46-377">Showplan XML schema</span></span>|<span data-ttu-id="b0a46-378">新しい**SeekPredicateNew**要素が Showplan XML スキーマに追加され、それを囲む xsd シーケンス (**SqlPredicatesType**) が項目に変換され **\<xsd:choice>** ます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-378">A new **SeekPredicateNew** element is added to the Showplan XML schema, and the enclosing xsd sequence (**SqlPredicatesType**) is converted into an **\<xsd:choice>** item.</span></span> <span data-ttu-id="b0a46-379">1つ以上の**Seekpredicate**要素の代わりに、Showplan XML に1つ以上の**SeekPredicateNew**要素が表示されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-379">Instead of one or more **SeekPredicate** elements, one or more **SeekPredicateNew** elements may now appear in the Showplan XML.</span></span> <span data-ttu-id="b0a46-380">この 2 つの要素を同時に指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-380">The two elements are mutually exclusive.</span></span> <span data-ttu-id="b0a46-381">**Seekpredicate**は、旧バージョンとの互換性のために Showplan XML スキーマで保持されます。ただし、で作成されたクエリプランには、 [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] **SeekPredicateNew**要素が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-381">**SeekPredicate** is maintained in the Showplan XML schema for backwards compatibility; however, query plans created in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] may contain the **SeekPredicateNew** element.</span></span> <span data-ttu-id="b0a46-382">ノード Showplan Xml/BatchSequence/Batch/ステートメント/StmtSimple/QueryPlan/RelOp/IndexScan/Seekpredicate からの**seekpredicate**子のみを取得するアプリケーションは、 **seekpredicate**要素が存在しない場合に失敗することがあります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-382">Applications that expect to retrieve only the **SeekPredicate** child from the node ShowPlanXML/BatchSequence/Batch/Statements/StmtSimple/QueryPlan/RelOp/IndexScan/SeekPredicates may fail if the **SeekPredicate** element does not exist.</span></span> <span data-ttu-id="b0a46-383">このノードの**Seekpredicate**要素または**SeekPredicateNew**要素のいずれかを想定するようにアプリケーションを書き直してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-383">Rewrite the application to expect either the **SeekPredicate** or **SeekPredicateNew** element in this node.</span></span> <span data-ttu-id="b0a46-384">詳細については、「」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-384">For more information, see .</span></span>|  
|<span data-ttu-id="b0a46-385">プラン表示の XML スキーマ</span><span class="sxs-lookup"><span data-stu-id="b0a46-385">Showplan XML schema</span></span>|<span data-ttu-id="b0a46-386">新しい**Indexkind**属性が Showplan XML スキーマの**ObjectType**複合型に追加されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-386">A new **IndexKind** attribute is added to the **ObjectType** complex type in the Showplan XML schema.</span></span> <span data-ttu-id="b0a46-387">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] プランを [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] スキーマに対して厳密に検証するアプリケーションは失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-387">Applications that strictly validate [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] plans against the [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] schema will fail.</span></span>|  
  
### <a name="transact-sql"></a><span data-ttu-id="b0a46-388">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="b0a46-388">Transact-SQL</span></span>  
  
|<span data-ttu-id="b0a46-389">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-389">Feature</span></span>|<span data-ttu-id="b0a46-390">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-390">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-391">ALTER_AUTHORIZATION_DATABASE DDL イベント</span><span class="sxs-lookup"><span data-stu-id="b0a46-391">ALTER_AUTHORIZATION_DATABASE DDL event</span></span>|<span data-ttu-id="b0a46-392">では [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] 、ddl イベント ALTER_AUTHORIZATION_DATABASE が発生すると、データ定義言語 (DDL) 操作でセキュリティ保護可能なエンティティ型がオブジェクトである場合に、このイベントの**ObjectType**要素に値 ' object ' が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-392">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], when the DDL event ALTER_AUTHORIZATION_DATABASE fires, the value 'object' is returned in the **ObjectType** element of the EVENTDATA xml for this event when the entity type of the securable in the data definition language (DDL) operation is an object.</span></span> <span data-ttu-id="b0a46-393">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では、実際の種類 (たとえば 'table' や 'function') が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-393">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], the actual type (for example, 'table', or 'function') is returned.</span></span>|  
|<span data-ttu-id="b0a46-394">CONVERT</span><span class="sxs-lookup"><span data-stu-id="b0a46-394">CONVERT</span></span>|<span data-ttu-id="b0a46-395">CONVERT 関数に無効なスタイルが渡されると、変換の種類がバイナリから文字、または文字からバイナリの場合にエラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-395">If an invalid style is passed to the CONVERT function, an error is returned when the type of conversion is binary to character or character to binary.</span></span> <span data-ttu-id="b0a46-396">以前のバージョンの [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] では、バイナリから文字への変換および文字からバイナリへの変換の既定のスタイルに無効なスタイルが設定されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-396">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the invalid style is set to the default style for binary-to-character and character-to-binary conversions.</span></span>|  
|<span data-ttu-id="b0a46-397">アセンブリに対する EXECUTE の GRANT/DENY/REVOKE</span><span class="sxs-lookup"><span data-stu-id="b0a46-397">GRANT/DENY/REVOKE EXECUTE on assemblies</span></span>|<span data-ttu-id="b0a46-398">アセンブリに対する EXECUTE 権限の許可、拒否、および取り消しを行うことはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-398">EXECUTE permission cannot be granted, denied, or revoked to assemblies.</span></span> <span data-ttu-id="b0a46-399">この権限を設定しても効果がなく、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-399">This permission has no affect and now causes an error.</span></span> <span data-ttu-id="b0a46-400">代わりに、アセンブリ メソッドを参照するストアド プロシージャまたは関数に対して EXECUTE 権限の許可、拒否、および取り消しを行ってください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-400">Grant, deny, or revoke EXECUTE permission on the stored procedures or functions that reference the assembly method instead.</span></span>|  
|<span data-ttu-id="b0a46-401">システム型に対する GRANT/DENY/REVOKE 権限</span><span class="sxs-lookup"><span data-stu-id="b0a46-401">GRANT/DENY/REVOKE permissions on system types</span></span>|<span data-ttu-id="b0a46-402">システム型に対する権限の許可、拒否、および取り消しを行うことはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-402">Permissions cannot be granted, denied, or revoked to system types.</span></span> <span data-ttu-id="b0a46-403">以前のバージョンの [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] では、このステートメントは正常に実行されますが、効果はありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-403">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], these statements succeed but have no effect.</span></span> <span data-ttu-id="b0a46-404">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では、エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-404">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], an error is returned.</span></span>|  
|<span data-ttu-id="b0a46-405">GROUP BY</span><span class="sxs-lookup"><span data-stu-id="b0a46-405">GROUP BY</span></span>|<span data-ttu-id="b0a46-406">GROUP BY 句では、GROUP BY リストに使用される式にサブクエリを含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-406">The GROUP BY clause cannot contain a subquery in an expression that is used for the group by list.</span></span> <span data-ttu-id="b0a46-407">以前のバージョンの [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] では、この処理は可能でした。</span><span class="sxs-lookup"><span data-stu-id="b0a46-407">In earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], this was allowed.</span></span> <span data-ttu-id="b0a46-408">[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では、エラー 144 が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-408">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], error 144 is returned.</span></span><br /><br /> <span data-ttu-id="b0a46-409">たとえば、次のコードは、SQL Server 2005 では正常に実行されますが、SQL Server 2008 では実行に失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-409">For example, the following code will succeed in SQL Server 2005 and fail in SQL Server 2008.</span></span><br /><br /> `DECLARE @Test TABLE(a int NOT NULL);` <br /> `INSERT INTO @Test SELECT 1 union ALL SELECT 2;` <br /> `SELECT COUNT(*)` <br /> `FROM @Test` <br /> `GROUP BY CASE WHEN a IN (SELECT t.a FROM @Test AS t)` <br /> `THEN 1 ELSE 0` <br /> `END;`|  
|<span data-ttu-id="b0a46-410">OUTPUT 句</span><span class="sxs-lookup"><span data-stu-id="b0a46-410">OUTPUT clause</span></span>|<span data-ttu-id="b0a46-411">非決定的な動作を防ぐために、ビューまたはインライン テーブル値関数から返される列が次のいずれかの方法で定義されている場合、OUTPUT 句ではその列を参照できません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-411">To prevent nondeterministic behavior, the OUTPUT clause cannot reference a column from a view or inline table-valued function when that column is defined by one of the following methods:</span></span><br /><br /> <span data-ttu-id="b0a46-412">サブクエリ。</span><span class="sxs-lookup"><span data-stu-id="b0a46-412">A subquery.</span></span><br /><br /> <span data-ttu-id="b0a46-413">ユーザーまたはシステムデータへのアクセスを実行するユーザー定義関数、またはこのようなアクセスを実行することを前提としています。</span><span class="sxs-lookup"><span data-stu-id="b0a46-413">A user-defined function that performs user- or system-data access, or is assumed to perform such access.</span></span><br /><br /> <span data-ttu-id="b0a46-414">ユーザー データまたはシステム データにアクセスするユーザー定義関数を定義に含む計算列</span><span class="sxs-lookup"><span data-stu-id="b0a46-414">A computed column that contains in its definition a user-defined function that performs user- or system-data access.</span></span><br /><br /> <br /><br /> <span data-ttu-id="b0a46-415">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] が OUTPUT 句でそのような列を検出すると、エラー 4186 が発生します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-415">When [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] detects such a column in the OUTPUT clause, error 4186 is raised.</span></span> <span data-ttu-id="b0a46-416">詳細については、「 [MSSQLSERVER_4186](../relational-databases/errors-events/mssqlserver-4186-database-engine-error.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-416">For more information, see [MSSQLSERVER_4186](../relational-databases/errors-events/mssqlserver-4186-database-engine-error.md).</span></span>|  
|<span data-ttu-id="b0a46-417">OUTPUT INTO 句</span><span class="sxs-lookup"><span data-stu-id="b0a46-417">OUTPUT INTO clause</span></span>|<span data-ttu-id="b0a46-418">OUTPUT INTO 句の対象のテーブルに有効なトリガーを指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-418">The target table of the OUTPUT INTO clause cannot have any enabled triggers.</span></span>|  
|<span data-ttu-id="b0a46-419">precompute rank サーバー レベル オプション</span><span class="sxs-lookup"><span data-stu-id="b0a46-419">precompute rank server-level option</span></span>|<span data-ttu-id="b0a46-420">このオプションは、[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] ではサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-420">This option is not supported in [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="b0a46-421">この機能を現在使用しているアプリケーションはできるだけ早く変更してください。</span><span class="sxs-lookup"><span data-stu-id="b0a46-421">Modify applications that currently use this feature as soon as possible.</span></span>|  
|<span data-ttu-id="b0a46-422">READPAST テーブル ヒント</span><span class="sxs-lookup"><span data-stu-id="b0a46-422">READPAST table hint</span></span>|<span data-ttu-id="b0a46-423">スナップショット分離で READPAST ヒントを指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-423">You cannot specify the READPAST hint under Snapshot Isolation.</span></span><br /><br /> <span data-ttu-id="b0a46-424">READ_COMMITED_SNAPSHOT データベース オプションまたは ALLOW_SNAPSHOT_ISOLATION データベース オプションのいずれかが ON に設定されている場合、READPAST ヒントは無視されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-424">The READPAST hint is ignored when either the READ_COMMITED_SNAPSHOT or ALLOW_SNAPSHOT_ISOLATION database option is set to ON.</span></span> <span data-ttu-id="b0a46-425">ただし、READPAST ヒントを READCOMMITTEDLOCK と組み合わせた場合、READPAST の動作は READCOMMITTED ヒントをブロックするのと同じになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-425">However, if you combine the READPAST hint with READCOMMITTEDLOCK, the READPAST behavior is same as with the blocking READCOMMITTED hint.</span></span>|  
|<span data-ttu-id="b0a46-426">sp_helpuser</span><span class="sxs-lookup"><span data-stu-id="b0a46-426">sp_helpuser</span></span>|<span data-ttu-id="b0a46-427">Sp_helpuser ストアドプロシージャの結果セットに返される次の列名が変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-427">The following column names that are returned in the result set of the sp_helpuser stored procedure have changed:</span></span><br /><br /> <span data-ttu-id="b0a46-428">GroupName は次のようになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-428">GroupName is now:</span></span><br />                            <span data-ttu-id="b0a46-429">RoleName</span><span class="sxs-lookup"><span data-stu-id="b0a46-429">RoleName</span></span><br /><br /> <span data-ttu-id="b0a46-430">Group_name は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-430">Group_name is now:</span></span><br />                            <span data-ttu-id="b0a46-431">Role_name</span><span class="sxs-lookup"><span data-stu-id="b0a46-431">Role_name</span></span><br /><br /> <span data-ttu-id="b0a46-432">Group_id は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-432">Group_id is now:</span></span><br />                            <span data-ttu-id="b0a46-433">Role_id</span><span class="sxs-lookup"><span data-stu-id="b0a46-433">Role_id</span></span><br /><br /> <span data-ttu-id="b0a46-434">Users_in_group は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-434">Users_in_group is now:</span></span><br />                            <span data-ttu-id="b0a46-435">Users_in_role</span><span class="sxs-lookup"><span data-stu-id="b0a46-435">Users_in_role</span></span>|  
|<span data-ttu-id="b0a46-436">透過的なデータ暗号化</span><span class="sxs-lookup"><span data-stu-id="b0a46-436">Transparent Data Encryption</span></span>|<span data-ttu-id="b0a46-437">透過的なデータ暗号化 (TDE) は I/O レベルで実行されます。そのため、ページ構造は、メモリ内では暗号化されず、ページがディスクに書き込まれるときだけ暗号化されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-437">Transparent data encryption (TDE) is performed at the I/O level: the page structure is unencrypted in memory and is encrypted only when the page is written to disk.</span></span> <span data-ttu-id="b0a46-438">データベース ファイルとログ ファイルの両方が暗号化されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-438">Both the database files and log files are encrypted.</span></span> <span data-ttu-id="b0a46-439">通常の [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] メカニズムを使用せずに (たとえば、データ ファイルやログ ファイルを直接スキャンして) ページにアクセスするサードパーティのアプリケーションは、ファイル内のデータが暗号化されているため、データベースで TDE を使用すると失敗します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-439">Third-party applications that bypass the regular [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] mechanism for accessing pages (for example, by scanning the data or log files directly), will fail when a database uses TDE because the data is encrypted in the files.</span></span> <span data-ttu-id="b0a46-440">このようなアプリケーションでは、Window Cryptographic API を使用すると、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 以外のデータの暗号化を解除するためのソリューションを開発できます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-440">Such applications can leverage the Window Cryptographic API to develop a solution for decrypting the data outside of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>|  
  
### <a name="xquery"></a><span data-ttu-id="b0a46-441">XQuery</span><span class="sxs-lookup"><span data-stu-id="b0a46-441">XQuery</span></span>  
  
|<span data-ttu-id="b0a46-442">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-442">Feature</span></span>|<span data-ttu-id="b0a46-443">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-443">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-444">Datetime のサポート</span><span class="sxs-lookup"><span data-stu-id="b0a46-444">Datetime support</span></span>|<span data-ttu-id="b0a46-445">では、、 [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] 、およびの各データ型には、 `xs:time` `xs:date` タイムゾーンのサポートはあり `xs:dateTime` ません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-445">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], the data types `xs:time`, `xs:date`, and `xs:dateTime` do not have timezone support.</span></span> <span data-ttu-id="b0a46-446">タイム ゾーン データは UTC タイム ゾーンにマップされます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-446">Timezone data is mapped to the UTC timezone.</span></span> [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] <span data-ttu-id="b0a46-447">では、標準に準拠した動作を提供するため、次のように変更されました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-447">, provides standard conformant behavior, resulting in the following changes:</span></span><br /><br /> <span data-ttu-id="b0a46-448">タイム ゾーンを使用しない値の検証</span><span class="sxs-lookup"><span data-stu-id="b0a46-448">Values without timezone are validated.</span></span><br /><br /> <span data-ttu-id="b0a46-449">タイム ゾーン指定の有無の保持</span><span class="sxs-lookup"><span data-stu-id="b0a46-449">The provided timezone or the absence of a timezone is preserved.</span></span><br /><br /> <span data-ttu-id="b0a46-450">内部ストレージ表現の変更</span><span class="sxs-lookup"><span data-stu-id="b0a46-450">The internal storage representation is modified.</span></span><br /><br /> <span data-ttu-id="b0a46-451">格納された値の解決を増加</span><span class="sxs-lookup"><span data-stu-id="b0a46-451">Resolution of stored values is increased.</span></span><br /><br /> <span data-ttu-id="b0a46-452">負の年の使用禁止</span><span class="sxs-lookup"><span data-stu-id="b0a46-452">Negative years are disallowed.</span></span><br /><br /> <br /><br /> <span data-ttu-id="b0a46-453">注: 新しい型の値を考慮するようにアプリケーションと XQuery 式を変更します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-453">Note: Modify applications and XQuery expressions to account for the new type values.</span></span>|  
|<span data-ttu-id="b0a46-454">XQuery 式と Xpath 式</span><span class="sxs-lookup"><span data-stu-id="b0a46-454">XQuery and Xpath expressions</span></span>|<span data-ttu-id="b0a46-455">では [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] 、コロン (': ') で始まる XQuery 式または XPath 式のステップが許可されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-455">In [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], steps in an XQuery or XPath expression that begin with a colon (':') are allowed.</span></span> <span data-ttu-id="b0a46-456">たとえば、次のステートメントのパス式には、コロンで始まる名前テスト (`CTR02)`) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="b0a46-456">For example, the following statement contains a name test (`CTR02)` within the path expression that begins with a colon.</span></span><br /><br /> `SELECT FileContext.query('for n$ in //CTR return <C>{data )(n$/:CTR02)} </C>) AS Files FROM dbo.MyTable;`<br /><br /> <span data-ttu-id="b0a46-457">この使用法は XML 標準に準拠していないため、[!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] では許可されません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-457">In [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], this usage is disallowed because it does not conform to XML standards.</span></span> <span data-ttu-id="b0a46-458">エラー9341が返されます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-458">Error 9341 is returned.</span></span> <span data-ttu-id="b0a46-459">先頭のコロンを削除するか、名前テストにプレフィックスを指定してください (n$/CTR02 や n$/p1:CTR02 など)。</span><span class="sxs-lookup"><span data-stu-id="b0a46-459">Remove the leading colon or specify a prefix for the name test--for example, (n$/CTR02) or (n$/p1:CTR02).</span></span>|  
  
### <a name="connecting"></a><span data-ttu-id="b0a46-460">接続</span><span class="sxs-lookup"><span data-stu-id="b0a46-460">Connecting</span></span>  
  
|<span data-ttu-id="b0a46-461">特徴量</span><span class="sxs-lookup"><span data-stu-id="b0a46-461">Feature</span></span>|<span data-ttu-id="b0a46-462">説明</span><span class="sxs-lookup"><span data-stu-id="b0a46-462">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b0a46-463">SSL を使用した [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client からの接続</span><span class="sxs-lookup"><span data-stu-id="b0a46-463">Connecting from [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client using SSL</span></span>|<span data-ttu-id="b0a46-464">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client を使用して接続するとき、以前は、緩和された検証により、サブジェクトに完全修飾ドメイン名 (FQDN) が指定されている証明書で "SERVER=shortname; FORCE ENCRYPTION=true" を使用するアプリケーションでも接続できましたが、</span><span class="sxs-lookup"><span data-stu-id="b0a46-464">When connecting with [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client, applications that use "SERVER=shortname; FORCE ENCRYPTION=true" with certificate whose Subjects specify Fully Qualified Domain Names (FQDN's) have connected in the past due to relaxed validation.</span></span> <span data-ttu-id="b0a46-465">SQL Server 2008 R2 では、セキュリティ強化のために証明書で FQDN のサブジェクトが強制されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b0a46-465">SQL Server 2008 R2 enhances security by enforcing FQDN subjects for certificates.</span></span> <span data-ttu-id="b0a46-466">緩和された検証に依存しているアプリケーションでは次のいずれかの対処が必要になります。</span><span class="sxs-lookup"><span data-stu-id="b0a46-466">Applications that rely upon relaxed validation must take one of the following actions:</span></span><br /><br /> <span data-ttu-id="b0a46-467">接続文字列で FQDN を使用する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-467">Use the FQDN in the connection string.</span></span><br /><br /> <span data-ttu-id="b0a46-468">-接続文字列の SERVER キーワードがアプリケーションの外部で構成されている場合、このオプションではアプリケーションを再コンパイルする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-468">-This option does not require recompiling the application if the SERVER keyword of the connection string is configured outside the application.</span></span><br /><br /> <span data-ttu-id="b0a46-469">-接続文字列がハードコードされているアプリケーションでは、このオプションは機能しません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-469">-This option does not work for applications that have their connection strings hardcoded.</span></span><br /><br /> <span data-ttu-id="b0a46-470">-ミラーサーバーが簡易名で応答するため、データベースミラーリングを使用するアプリケーションでは、このオプションは機能しません。</span><span class="sxs-lookup"><span data-stu-id="b0a46-470">-This option does not work for applications that use Database Mirroring since the mirrored server replies with a simple name.</span></span>|  
||<span data-ttu-id="b0a46-471">shortname の別名を追加して FQDN にマップする。</span><span class="sxs-lookup"><span data-stu-id="b0a46-471">Add an alias for the shortname to map to the FQDN.</span></span><br /><br /> <span data-ttu-id="b0a46-472">-このオプションは、接続文字列がハードコードされているアプリケーションでも機能します。</span><span class="sxs-lookup"><span data-stu-id="b0a46-472">-This option works even for applications that have their connection strings hardcoded.</span></span><br /><br /> <span data-ttu-id="b0a46-473">-このオプションは、データベースミラーリングを使用するアプリケーションに対しては機能しません。これは、プロバイダーが受信したフェールオーバーパートナー名のエイリアスを参照しないためです。</span><span class="sxs-lookup"><span data-stu-id="b0a46-473">-This option does not work for applications that use Database Mirroring since the providers don't look up aliases for received failover partner names.</span></span>|  
||<span data-ttu-id="b0a46-474">shortname に対して発行された証明書を使用する。</span><span class="sxs-lookup"><span data-stu-id="b0a46-474">Have a certificate issued for shortname.</span></span><br /><br /> <span data-ttu-id="b0a46-475">-このオプションは、すべてのアプリケーションで使用できます。</span><span class="sxs-lookup"><span data-stu-id="b0a46-475">-This option works for all applications.</span></span>|  

## <a name="breaking-changes-in-sql-server-2005"></a><a name="Yukon"></a><span data-ttu-id="b0a46-476">SQL Server 2005 での重大な変更</span><span class="sxs-lookup"><span data-stu-id="b0a46-476">Breaking Changes in SQL Server 2005</span></span>  

[!INCLUDE[Archived documentation for very old versions of SQL Server](../includes/paragraph-content/previous-versions-archive-documentation-sql-server.md)]

## <a name="see-also"></a><span data-ttu-id="b0a46-477">参照</span><span class="sxs-lookup"><span data-stu-id="b0a46-477">See Also</span></span>  
 <span data-ttu-id="b0a46-478">[SQL Server 2014 の非推奨のデータベースエンジン機能](deprecated-database-engine-features-in-sql-server-2016.md?view=sql-server-2014) </span><span class="sxs-lookup"><span data-stu-id="b0a46-478">[Deprecated Database Engine Features in SQL Server 2014](deprecated-database-engine-features-in-sql-server-2016.md?view=sql-server-2014) </span></span>  
 <span data-ttu-id="b0a46-479">[SQL Server 2014 のデータベースエンジン機能の動作の変更](../../2014/database-engine/behavior-changes-to-database-engine-features-in-sql-server-2014.md?view=sql-server-2014) </span><span class="sxs-lookup"><span data-stu-id="b0a46-479">[Behavior Changes to Database Engine Features in SQL Server 2014](../../2014/database-engine/behavior-changes-to-database-engine-features-in-sql-server-2014.md?view=sql-server-2014) </span></span>  
 <span data-ttu-id="b0a46-480">[SQL Server 2014 で廃止されたデータベースエンジン機能](discontinued-database-engine-functionality-in-sql-server-2016.md?view=sql-server-2014) </span><span class="sxs-lookup"><span data-stu-id="b0a46-480">[Discontinued Database Engine Functionality in SQL Server 2014](discontinued-database-engine-functionality-in-sql-server-2016.md?view=sql-server-2014) </span></span>  
 <span data-ttu-id="b0a46-481">[SQL Server データベース エンジンの旧バージョンとの互換性](sql-server-database-engine-backward-compatibility.md) </span><span class="sxs-lookup"><span data-stu-id="b0a46-481">[SQL Server Database Engine Backward Compatibility](sql-server-database-engine-backward-compatibility.md) </span></span>  
 [<span data-ttu-id="b0a46-482">ALTER DATABASE 互換性レベル &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b0a46-482">ALTER DATABASE Compatibility Level &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-database-transact-sql-compatibility-level)  
 [<span data-ttu-id="b0a46-483">SQL Server 2014 の管理ツール機能における重大な変更</span><span class="sxs-lookup"><span data-stu-id="b0a46-483">Breaking Changes to Management Tools Features in SQL Server 2014</span></span>](breaking-changes-to-management-tools-features-in-sql-server-2014.md?view=sql-server-2014)  
  
