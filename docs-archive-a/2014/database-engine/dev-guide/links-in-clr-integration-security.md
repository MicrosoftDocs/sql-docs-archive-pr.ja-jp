---
title: CLR 統合セキュリティのリンク |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: reference
helpviewer_keywords:
- table-access links [CLR integration]
- security [CLR integration]
- invocation links [CLR integration]
- gated links [CLR integration]
ms.assetid: 168efd01-d12e-4bdf-a1b3-0b5c76474eaf
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 52a4f8084a8a90384c8916f2219faaf2c138b11c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87742490"
---
# <a name="links-in-clr-integration-security"></a><span data-ttu-id="b0b68-102">CLR 統合のセキュリティのリンク</span><span class="sxs-lookup"><span data-stu-id="b0b68-102">Links in CLR Integration Security</span></span>
  <span data-ttu-id="b0b68-103">ここでは、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] またはいずれかのマネージド言語で、[!INCLUDE[tsql](../../includes/tsql-md.md)] 内のユーザー コードが相互に呼び出すしくみを説明します。</span><span class="sxs-lookup"><span data-stu-id="b0b68-103">This section describes how pieces of user code can call each other in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], either in [!INCLUDE[tsql](../../includes/tsql-md.md)] or in one of the managed languages.</span></span> <span data-ttu-id="b0b68-104">このようなオブジェクト間のリレーションシップをリンクと呼びます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-104">These relationships between objects are referred to as links.</span></span>  
  
## <a name="invocation-links"></a><span data-ttu-id="b0b68-105">呼び出しリンク</span><span class="sxs-lookup"><span data-stu-id="b0b68-105">Invocation Links</span></span>  
 <span data-ttu-id="b0b68-106">呼び出しリンクは、オブジェクトを呼び出すユーザーからのコード呼び出し (ストアド プロシージャを呼び出す [!INCLUDE[tsql](../../includes/tsql-md.md)] バッチなど)、または共通言語ランタイム (CLR) ストアド プロシージャや関数からのコード呼び出しのいずれかに対応しています。</span><span class="sxs-lookup"><span data-stu-id="b0b68-106">Invocation links correspond to a code invocation, either from a user calling an object (such as a [!INCLUDE[tsql](../../includes/tsql-md.md)] batch calling a stored procedure), or a common language runtime (CLR) stored procedure or function.</span></span> <span data-ttu-id="b0b68-107">呼び出しリンクにより、呼び出し先の `EXECUTE` 権限がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-107">Invocation links cause an `EXECUTE` permission on the callee to be checked.</span></span>  
  
## <a name="table-access-links"></a><span data-ttu-id="b0b68-108">テーブル アクセス リンク</span><span class="sxs-lookup"><span data-stu-id="b0b68-108">Table-Access Links</span></span>  
 <span data-ttu-id="b0b68-109">テーブル アクセス リンクは、テーブル、ビュー、またはテーブル値関数の値の取得や変更に対応します。</span><span class="sxs-lookup"><span data-stu-id="b0b68-109">Table access links correspond to retrieving or modifying values in a table, view, or a table-valued function.</span></span> <span data-ttu-id="b0b68-110">テーブル アクセス リンクは、SELECT 権限、INSERT 権限、UPDATE 権限、および DELETE 権限に関してアクセス制御の粒度が細かいという点を除いて、呼び出しリンクと同じです。</span><span class="sxs-lookup"><span data-stu-id="b0b68-110">They are similar to invocation links, except that they have a finer-grained access control in terms of SELECT, INSERT, UPDATE, and DELETE permissions.</span></span>  
  
## <a name="gated-links"></a><span data-ttu-id="b0b68-111">ゲートリンク</span><span class="sxs-lookup"><span data-stu-id="b0b68-111">Gated Links</span></span>  
 <span data-ttu-id="b0b68-112">ゲート リンクは、一度確立されると、実行されている間、オブジェクトのリレーションシップ間で権限がチェックされることはありません。</span><span class="sxs-lookup"><span data-stu-id="b0b68-112">Gated links mean that during execution, permissions are not checked across the object relationship once it has been established.</span></span> <span data-ttu-id="b0b68-113">2つのオブジェクト (オブジェクト**x** 、オブジェクト**y**など) の間にゲートリンクがある場合、オブジェクト**y**およびオブジェクト**y**からアクセスされる他のオブジェクトに対する権限は、オブジェクト**x**の作成時にのみチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-113">When there is a gated link between two objects (for example, object **x** and object **y**), permissions on object **y** and other objects accessed from object **y** are checked only at the creation time of object **x**.</span></span> <span data-ttu-id="b0b68-114">オブジェクト**x**の作成時に、 `REFERENCE` **x**の所有者に対して**y**でアクセス許可がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-114">At the creation time of object **x**, `REFERENCE` permission is checked on **y** against the owner of **x**.</span></span> <span data-ttu-id="b0b68-115">実行時 (たとえば、だれかがオブジェクト**x**を呼び出したとき) には、 **y**またはその他のオブジェクトに対して静的に参照されるアクセス許可はチェックされません。</span><span class="sxs-lookup"><span data-stu-id="b0b68-115">At execution time, (for example, when someone calls object **x**), there are no permissions checked against **y** or other objects it references statically.</span></span> <span data-ttu-id="b0b68-116">実行時に、オブジェクト**x**自体に対して適切なアクセス許可がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-116">At execution time, an appropriate permission will be checked against object **x** itself.</span></span>  
  
 <span data-ttu-id="b0b68-117">ゲート リンクは、2 つのオブジェクト間のメタデータの依存関係と常に組み合わせて使用されます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-117">Gated links are always used in conjunction with a metadata dependency between two objects.</span></span> <span data-ttu-id="b0b68-118">このメタデータの依存関係とは、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] カタログで確立されるリレーションシップです。このリレーションシップにより、別のオブジェクトが依存しているオブジェクトの削除が回避されます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-118">This metadata dependency is a relationship established in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] catalogs that prevents an object from being dropped as long as another object depends on it.</span></span>  
  
 <span data-ttu-id="b0b68-119">ゲート リンクは、多くの依存オブジェクトに権限を許可することが不適切または管理不可能である場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-119">Gated links are useful when it is not appropriate or manageable to give permissions to many dependent objects.</span></span> <span data-ttu-id="b0b68-120">CLR アセンブリ (CLR プロシージャ、トリガー、関数、型、集計など) への [!INCLUDE[tsql](../../includes/tsql-md.md)] エントリ ポイントを定義するオブジェクトと、それらを定義する際のベースになるアセンブリとの間にゲート リンクが導入されています。</span><span class="sxs-lookup"><span data-stu-id="b0b68-120">Gated links are introduced between objects that define [!INCLUDE[tsql](../../includes/tsql-md.md)] entry points into CLR assemblies (for example, CLR procedures, triggers, functions, types, and aggregates) and the assemblies from which they are defined.</span></span> <span data-ttu-id="b0b68-121">このようなオブジェクトに対してゲート セキュリティを使用するということは、CLR アセンブリ内で定義された [!INCLUDE[tsql](../../includes/tsql-md.md)] エントリ ポイントを呼び出すために呼び出し元で必要になるのは、その [!INCLUDE[tsql](../../includes/tsql-md.md)] エントリ ポイントに対する適切な権限のみであることを意味します。</span><span class="sxs-lookup"><span data-stu-id="b0b68-121">Gated security against these objects implies that in order to invoke a [!INCLUDE[tsql](../../includes/tsql-md.md)] entry point defined in a CLR assembly, the caller only needs an appropriate permission on that [!INCLUDE[tsql](../../includes/tsql-md.md)] entry point.</span></span> <span data-ttu-id="b0b68-122">呼び出し元には、そのアセンブリまたはそのアセンブリが静的に参照するその他のアセンブリに対する権限は不要です。</span><span class="sxs-lookup"><span data-stu-id="b0b68-122">The caller is not required to have permissions on that assembly or any other assemblies it statically references.</span></span> <span data-ttu-id="b0b68-123">アセンブリに対する権限は、[!INCLUDE[tsql](../../includes/tsql-md.md)] エントリ ポイントの作成時にチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-123">The permissions on the assembly are checked at creation time of the [!INCLUDE[tsql](../../includes/tsql-md.md)] entry point.</span></span>  
  
## <a name="sql-server-authorization-based-security"></a><span data-ttu-id="b0b68-124">SQL Server 承認ベースのセキュリティ</span><span class="sxs-lookup"><span data-stu-id="b0b68-124">SQL Server Authorization-Based Security</span></span>  
 <span data-ttu-id="b0b68-125">CLR ベースのデータベース オブジェクトの呼び出しと、これらのオブジェクト間で実行される [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] セキュリティ チェックを支える基本的な規則を次に示します。最初の 3 つの規則では、どの権限がどのオブジェクトに対してチェックされるかを定義し、4 つ目の規則では、権限がチェックされる対象の実行コンテキストを定義します。</span><span class="sxs-lookup"><span data-stu-id="b0b68-125">The following are the basic rules behind the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] security checks for invocations of and between CLR-based database objects; the first three rules define which permissions are checked and against which object; the fourth rule defines which execution context the permission is checked against.</span></span>  
  
1.  <span data-ttu-id="b0b68-126">呼び出しが同じオブジェクト内で発生する場合を除いて、すべての呼び出しに `EXECUTE` 権限が必要になります。つまり、同じアセンブリ内での呼び出しには権限チェックは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="b0b68-126">All invocations require `EXECUTE` permission unless the invocations occur within the same object; this means that calls within the same assembly do not require any permission checks.</span></span> <span data-ttu-id="b0b68-127">権限は実行時にチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-127">The permission is checked at execution time.</span></span>  
  
2.  <span data-ttu-id="b0b68-128">ゲート リンクでは、呼び出し元オブジェクトの作成時に、呼び出し先に対する `REFERENCE` 権限が必要になります。</span><span class="sxs-lookup"><span data-stu-id="b0b68-128">Gated links require `REFERENCE` permission against the callee when the calling object is created.</span></span> <span data-ttu-id="b0b68-129">呼び出し元オブジェクトの作成時に、そのオブジェクトの所有者の権限がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-129">The permission is checked for the owner of the calling object when the object is created.</span></span>  
  
3.  <span data-ttu-id="b0b68-130">テーブル アクセス リンクでは、アクセス先のテーブルまたはビューに対する `SELECT` 権限、`INSERT` 権限、`UPDATE` 権限、または `DELETE` 権限が必要になります。</span><span class="sxs-lookup"><span data-stu-id="b0b68-130">Table-access links require the corresponding `SELECT`, `INSERT`, `UPDATE`, or `DELETE` permission against the table or view being accessed.</span></span>  
  
4.  <span data-ttu-id="b0b68-131">現在の実行コンテキストに対して権限がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-131">The permission is checked against the current execution context.</span></span> <span data-ttu-id="b0b68-132">呼び出し元とは異なる実行コンテキストでプロシージャや関数を作成できます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-132">Procedures and functions can be created with an execution context that is different from the caller.</span></span> <span data-ttu-id="b0b68-133">アセンブリは、常に、プロシージャ、関数、またはトリガーに対して定義されている実行コンテキストで作成されます。</span><span class="sxs-lookup"><span data-stu-id="b0b68-133">Assemblies are always created with the execution context of the procedure, function, or trigger that is defined against it.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b0b68-134">参照</span><span class="sxs-lookup"><span data-stu-id="b0b68-134">See Also</span></span>  
 [<span data-ttu-id="b0b68-135">CLR 統合のセキュリティ</span><span class="sxs-lookup"><span data-stu-id="b0b68-135">CLR Integration Security</span></span>](../../relational-databases/clr-integration/security/clr-integration-security.md)  
  
  
