---
title: データベース ミラーリング セッション中の役割の交代 (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
- mirroring partners [SQL Server]
- failover [SQL Server]
- failover partners [SQL Server]
- database mirroring [SQL Server], partners
- partners in database mirroring sessions [SQL Server]
- failover [SQL Server], database mirroring
- database mirroring [SQL Server], failover
ms.assetid: a782d60d-0373-4386-bd77-9ec192553700
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5e16adbad2106d623279edf9d443eae3755c7be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87716749"
---
# <a name="role-switching-during-a-database-mirroring-session-sql-server"></a><span data-ttu-id="3379f-102">データベース ミラーリング セッション中の役割の交代 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="3379f-102">Role Switching During a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="3379f-103">データベース ミラーリング セッションでは、 *役割の交代*という処理により、一般的にプリンシパルとミラーの役割を相互交換できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-103">Within the context of a database mirroring session, the principal and mirror roles are typically interchangeable in a process known as *role switching*.</span></span> <span data-ttu-id="3379f-104">役割の交代では、ミラー サーバーはプリンシパル サーバーに対する *フェールオーバー パートナー* として機能します。プリンシパルの役割を引き継ぎ、サーバー内のデータベースのコピーを復旧し、それを新しいプリンシパル データベースとしてオンラインにします。</span><span class="sxs-lookup"><span data-stu-id="3379f-104">In role switching, the mirror server acts as the *failover partner* for the principal server, taking over the principal role, recovering its copy of the database and bringing it online as the new principal database.</span></span> <span data-ttu-id="3379f-105">以前のプリンシパル サーバーは利用可能であればミラーの役割を担い、サーバー内のデータベースを新しいミラー データベースにします。</span><span class="sxs-lookup"><span data-stu-id="3379f-105">The former principal server, when available, assumes the mirror role, and its database becomes the new mirror database.</span></span> <span data-ttu-id="3379f-106">場合によっては、複数のエラーに対する対応として、または管理目的のために、役割を何度も交代できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-106">Potentially, the roles can switch back and forth either in response to multiple failures or for administrative purposes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3379f-107">このトピックは、データベース ミラーリングの動作モードに詳しいユーザーを対象にしています。</span><span class="sxs-lookup"><span data-stu-id="3379f-107">This topic assumes that you are familiar with the database mirroring operating modes.</span></span> <span data-ttu-id="3379f-108">詳しくは、「 [Database Mirroring Operating Modes](database-mirroring-operating-modes.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="3379f-108">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="3379f-109">次の図は、ミラーリング パートナーである **Partner_A** と **Partner_B**を示しています。一連の自動フェールオーバーまたは手動フェールオーバーで、プリンシパルとミラーの役割を交代しています。</span><span class="sxs-lookup"><span data-stu-id="3379f-109">The following illustration shows mirroring partners, **Partner_A** and **Partner_B**, switching the principal and mirror roles over a series of automatic or manual failovers.</span></span>  
  
 <span data-ttu-id="3379f-110">![パートナーの役割の交代 (2 回)](../media/dbm-roleswitching.gif "パートナーの役割の交代 (2 回)")</span><span class="sxs-lookup"><span data-stu-id="3379f-110">![Partners switching twice between roles](../media/dbm-roleswitching.gif "Partners switching twice between roles")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3379f-111">役割の交代後、以前のプリンシパル データベースで実行されていたジョブを新しいプリンシパル サーバーで実行するには、その新しいプリンシパル サーバーで再作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-111">After a role switch, jobs that ran on the former principal database must be recreated on the new principal server to run there.</span></span> <span data-ttu-id="3379f-112">詳細については、「[役割の交代後のログインとジョブの管理 &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-112">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="3379f-113">役割の交代には、自動フェールオーバー、手動フェールオーバー、およびサービスの強制 (データ損失の可能性あり) の 3 つの形式があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-113">Three types of role switching exist: automatic failover, manual failover, and forced service (with possible data loss).</span></span> <span data-ttu-id="3379f-114">各形式がサポートされるかどうかは、セッションの動作モードによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-114">Support for each form depends on the operating mode of the session.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3379f-115">動作モードについて詳しく理解していない場合は、「 [データベース ミラーリングの動作モード](database-mirroring-operating-modes.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-115">If you are unfamiliar with these operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="3379f-116">**手動フェールオーバー**</span><span class="sxs-lookup"><span data-stu-id="3379f-116">**Manual failover**</span></span>  
  
     <span data-ttu-id="3379f-117">高い安全性モードでは、手動フェールオーバーがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-117">High-safety mode supports manual failover.</span></span> <span data-ttu-id="3379f-118">データベース所有者は、データベースが同期されていれば、いつでも手動フェールオーバーを開始できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-118">Whenever the database is synchronized, the database owner can initiate a manual failover.</span></span>  
  
     <span data-ttu-id="3379f-119">手動フェールオーバーは、管理用に用意されています。</span><span class="sxs-lookup"><span data-stu-id="3379f-119">Manual failover is provided for administrative purposes.</span></span> <span data-ttu-id="3379f-120">詳細については、このトピックの「 [手動フェールオーバー](#ManualFailover)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-120">For more information, see [Manual Failover](#ManualFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="3379f-121">**Automatic failover**</span><span class="sxs-lookup"><span data-stu-id="3379f-121">**Automatic failover**</span></span>  
  
     <span data-ttu-id="3379f-122">ミラーリング監視サーバーを伴う高い安全性モードで、自動フェールオーバーがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-122">In the presence of a witness, high-safety mode supports automatic failover.</span></span> <span data-ttu-id="3379f-123">ミラーリング監視サーバーとミラー サーバーの相互接続が維持されていて、データベースの同期が完了しているときに、プリンシパル サーバーが使用できなくなった場合のみ、自動フェールオーバーが行われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-123">Automatic failover occurs only on the loss of the principal server when the witness and mirror server are still connected to each other and the database is already synchronized.</span></span> <span data-ttu-id="3379f-124">詳細については、このトピックの「 [自動フェールオーバー](#AutomaticFailover)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-124">For more information, see [Automatic Failover](#AutomaticFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="3379f-125">**サービスの強制 (データ損失の可能性あり)**</span><span class="sxs-lookup"><span data-stu-id="3379f-125">**Forced service (with possible data loss)**</span></span>  
  
     <span data-ttu-id="3379f-126">サービスの強制は、ミラーリング監視サーバーを伴わない高い安全性モード、および高パフォーマンス モードでサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-126">Forcing service is supported in high-safety mode when no witness is set and in high-performance mode.</span></span> <span data-ttu-id="3379f-127">プリンシパル サーバーが停止した場合、データベース所有者はミラー サーバーにサービスを強制して (データ損失の可能性あり)、データベースを利用できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="3379f-127">On the loss of the principal server, the database owner can make the database available by forcing service to the mirror server (with possible data loss).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-128">高パフォーマンス モードでは、WITNESS プロパティを OFF に設定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3379f-128">We recommend that the WITNESS property be set to OFF in high-performance mode.</span></span> <span data-ttu-id="3379f-129">それ以外の設定では、データベースをオンラインにするためには、ミラー サーバーをミラーリング監視サーバーに接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-129">Otherwise, to bring the database online, the mirror server must connected to the witness.</span></span>  
  
     <span data-ttu-id="3379f-130">詳細については、このトピックの「 [サービスの強制 (データ損失の可能性あり)](#ForcedService)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-130">For more information, see [Forced Service (with Possible Data Loss)](#ForcedService), later in this topic.</span></span>  
  
 <span data-ttu-id="3379f-131">次の表に、各動作モードでサポートされるフェールオーバーの形式をまとめます。</span><span class="sxs-lookup"><span data-stu-id="3379f-131">The following table summarizes which forms of failover are supported under each of the operating modes.</span></span>  
  
||<span data-ttu-id="3379f-132">高パフォーマンス</span><span class="sxs-lookup"><span data-stu-id="3379f-132">High performance</span></span>|<span data-ttu-id="3379f-133">ミラーリング監視サーバーを伴わない高い安全性モード</span><span class="sxs-lookup"><span data-stu-id="3379f-133">High-safety mode without a witness</span></span>|<span data-ttu-id="3379f-134">ミラーリング監視サーバーを伴う高い安全性モード</span><span class="sxs-lookup"><span data-stu-id="3379f-134">High-safety mode with a witness</span></span>|  
|-|----------------------|-----------------------------------------|--------------------------------------|  
|<span data-ttu-id="3379f-135">自動フェールオーバー</span><span class="sxs-lookup"><span data-stu-id="3379f-135">Automatic failover</span></span>|<span data-ttu-id="3379f-136">いいえ</span><span class="sxs-lookup"><span data-stu-id="3379f-136">No</span></span>|<span data-ttu-id="3379f-137">いいえ</span><span class="sxs-lookup"><span data-stu-id="3379f-137">No</span></span>|<span data-ttu-id="3379f-138">はい</span><span class="sxs-lookup"><span data-stu-id="3379f-138">Yes</span></span>|  
|<span data-ttu-id="3379f-139">手動フェールオーバー</span><span class="sxs-lookup"><span data-stu-id="3379f-139">Manual failover</span></span>|<span data-ttu-id="3379f-140">いいえ</span><span class="sxs-lookup"><span data-stu-id="3379f-140">No</span></span>|<span data-ttu-id="3379f-141">はい</span><span class="sxs-lookup"><span data-stu-id="3379f-141">Yes</span></span>|<span data-ttu-id="3379f-142">はい</span><span class="sxs-lookup"><span data-stu-id="3379f-142">Yes</span></span>|  
|<span data-ttu-id="3379f-143">サービスの強制</span><span class="sxs-lookup"><span data-stu-id="3379f-143">Forced service</span></span>|<span data-ttu-id="3379f-144">○</span><span class="sxs-lookup"><span data-stu-id="3379f-144">Yes</span></span>|<span data-ttu-id="3379f-145">はい</span><span class="sxs-lookup"><span data-stu-id="3379f-145">Yes</span></span>|<span data-ttu-id="3379f-146">いいえ</span><span class="sxs-lookup"><span data-stu-id="3379f-146">No</span></span>|  
  
 <span data-ttu-id="3379f-147">役割の交代後、すべてのデータベース ユーザーが新しいプリンシパル データベースにアクセスできるようにするには、特定のメタデータが両方のパートナーに存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-147">After a role switch, certain metadata must exist on both partners to ensure that all of the database users can access the new principal database.</span></span> <span data-ttu-id="3379f-148">また、データベースが定期的にバックアップされ続けるようにするには、新しいプリンシパル サーバーでバックアップ ジョブを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-148">In addition, backup jobs must be created on the new principal server, to ensure that the database continues to be backed up on its regular schedule.</span></span> <span data-ttu-id="3379f-149">詳細については、「[役割の交代後のログインとジョブの管理 &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-149">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="3379f-150">役割の交代中、データベース ミラーリングが使用できなくなる時間の長さは、役割の交代の形式、および原因によって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-150">During a role switch, the amount of time that database mirroring will be out of service depends on the type of role switching and on the cause.</span></span> <span data-ttu-id="3379f-151">詳しくは、「 [役割の交代中に発生するサービスの中断時間の算出 &#40;データベース ミラーリング&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md)という処理により、一般的にプリンシパルとミラーの役割を相互交換できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-151">For more information, see [Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span></span>  
  
##  <a name="manual-failover"></a><a name="ManualFailover"></a> <span data-ttu-id="3379f-152">Manual Failover</span><span class="sxs-lookup"><span data-stu-id="3379f-152">Manual Failover</span></span>  
 <span data-ttu-id="3379f-153">手動フェールオーバーによりデータベースからクライアントが切断され、パートナーの役割が元に戻ります。</span><span class="sxs-lookup"><span data-stu-id="3379f-153">Manual failover disconnects the clients from the database and reverses the roles of the partners.</span></span> <span data-ttu-id="3379f-154">手動フェールオーバーがサポートされているのは、高い安全性モードのみです。</span><span class="sxs-lookup"><span data-stu-id="3379f-154">Only high-safety mode supports manual failover.</span></span>  
  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="AvailabilityDuringUpgrades"></a> <span data-ttu-id="3379f-155">アップグレード中の可用性の維持</span><span class="sxs-lookup"><span data-stu-id="3379f-155">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="3379f-156">データベース管理者は、可用性を損なうことなくハードウェアやソフトウェアをアップグレードするために、手動フェールオーバーを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="3379f-156">The database administrator can use manual failover for upgrading hardware or software without sacrificing availability.</span></span> <span data-ttu-id="3379f-157">ソフトウェアをアップグレードするためにデータベース ミラーリングを使用する場合、ミラー サーバーのソフトウェア、ハードウェアのアップグレードを先に行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-157">To use database mirroring for software upgrades, the mirror server and/or system must have already received the upgrades.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3379f-158">データベース ミラーリングではローリング アップグレードを実行できることになっていますが、将来の変更については不明であるため、この動作は保証されていません。</span><span class="sxs-lookup"><span data-stu-id="3379f-158">Database mirroring should be able to do a rolling upgrade, but this is not guaranteed, because future changes are unknown.</span></span> <span data-ttu-id="3379f-159">詳しくは、「 [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="3379f-159">For more information, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span></span>  
  
 <span data-ttu-id="3379f-160">次の図は、データベース サーバー インスタンスをアップグレードするときに、データベースの可用性を保持するために手動フェールオーバーを使用している例を示しています。</span><span class="sxs-lookup"><span data-stu-id="3379f-160">The following figure illustrates an instance of using manual failover to maintain database availability while you upgrade a database server instance.</span></span> <span data-ttu-id="3379f-161">アップグレードが完了すると、管理者は必要に応じて元のサーバー インスタンスにフェールオーバーを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="3379f-161">When the upgrade is completed, an administrator may optionally fail over back to the original server instance.</span></span> <span data-ttu-id="3379f-162">これは、管理者がミラーリング セッションを停止し、他の場所にあるミラー サーバーを使用する場合に役に立ちます。</span><span class="sxs-lookup"><span data-stu-id="3379f-162">This is useful when the administrator wants to stop the mirroring session and use the mirror server elsewhere.</span></span> <span data-ttu-id="3379f-163">この方法により、一連のデータベース サーバー インスタンスを更新するときに、1 つのサーバー インスタンスを繰り返し使用できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-163">In this way, a single server instance can be used repeatedly when updating a series of database server instances.</span></span>  
  
 <span data-ttu-id="3379f-164">![計画的な手動フェールオーバー](../media/dbm-failovmanuplanned.gif "計画的な手動フェールオーバー")</span><span class="sxs-lookup"><span data-stu-id="3379f-164">![Planned manual failover](../media/dbm-failovmanuplanned.gif "Planned manual failover")</span></span>  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ConditionsForManualFo"></a> <span data-ttu-id="3379f-165">手動フェールオーバーに必要な条件</span><span class="sxs-lookup"><span data-stu-id="3379f-165">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="3379f-166">手動フェールオーバーでは、トランザクションの安全性が FULL (高い安全性モード) に設定されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-166">Manual failover requires transaction safety to be set to FULL (that is, high-safety mode).</span></span> <span data-ttu-id="3379f-167">パートナーが接続され、データベースが既に同期されている場合、手動フェールオーバーがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-167">When the partners are connected and the database is already synchronized, manual failover is supported.</span></span>  
  
###  <a name="how-manual-failover-works"></a><a name="HowManualFoWorks"></a> <span data-ttu-id="3379f-168">手動フェールオーバーの動作</span><span class="sxs-lookup"><span data-stu-id="3379f-168">How Manual Failover Works</span></span>  
 <span data-ttu-id="3379f-169">手動フェールオーバーにより、次の一連の操作が開始されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-169">Manual failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="3379f-170">プリンシパル サーバーでは、プリンシパル データベースからクライアントが切断され、ログの末尾がミラー サーバーに送信されます。また、ミラー ロールへの切り替えの準備として、ミラーリングの状態が SYNCHRONIZING に設定されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-170">The principal server disconnects clients from the principal database, sends the tail of the log to the mirror server, and, in preparation for switching to the mirror role, sets the mirroring state to SYNCHRONIZING.</span></span>  
  
2.  <span data-ttu-id="3379f-171">フェールオーバーのログ シーケンス番号 (LSN) としてプリンシパルから受信した、最後のログ レコードの LSN が、ミラー サーバーに記録されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-171">The mirror server records the log sequence number (LSN) of the last log record received from the principal as the failover LSN.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-172">この LSN を表示するには、[sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql) から **mirroring_failover_lsn** 列を選択します。</span><span class="sxs-lookup"><span data-stu-id="3379f-172">To view this LSN, select the **mirroring_failover_lsn** column from [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span></span>  
  
3.  <span data-ttu-id="3379f-173">再実行キューで待機しているログがある場合は、ミラー サーバーがミラー データベースのロールフォワードを完了します。</span><span class="sxs-lookup"><span data-stu-id="3379f-173">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span> <span data-ttu-id="3379f-174">必要な時間は、システムの処理速度、最近の作業負荷、および再実行キューのログの量によって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-174">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the redo queue.</span></span> <span data-ttu-id="3379f-175">同期動作モードの場合、再実行キューのサイズを制限することでフェールオーバーの時間を調節できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-175">For a synchronous operating mode, the failover time can be regulated by limiting the size of the redo queue.</span></span> <span data-ttu-id="3379f-176">ただし、同期動作モードでは、ミラー サーバーの遅れを取り戻すためにプリンシパル サーバーの処理速度が低下する場合があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-176">However, this can cause the principal server to slow down to allow the mirror server to keep up.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-177">再実行キューの現在のサイズを調べるには、データベース ミラーリング パフォーマンス オブジェクトの **Redo Queue** パフォーマンス カウンターを使用します (詳細については、「[データベースミラーリングの監視 &#40;SQL Server&#41;](database-mirroring-sql-server.md)」を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="3379f-177">To learn the current size of the redo queue, use the **Redo Queue** performance counter in the database mirroring performance object (for more information, see [Monitoring Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span></span>  
  
4.  <span data-ttu-id="3379f-178">ミラー サーバーが新たにプリンシパル サーバーになり、前のプリンシパル サーバーが新たにミラー サーバーになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-178">The mirror server becomes the new principal server, and the former principal server becomes the new mirror server.</span></span>  
  
5.  <span data-ttu-id="3379f-179">新しいプリンシパル サーバーでは、コミットされていないトランザクションがロールバックされ、データベースのコピーがプリンシパル データベースとしてオンラインになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-179">The new principal server rolls back any uncommitted transactions and brings its copy of the database online as the principal database.</span></span>  
  
6.  <span data-ttu-id="3379f-180">前のプリンシパルがミラーの役割を引き継ぎ、前のプリンシパル データベースがミラー データベースになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-180">The former principal takes on the mirror role, and the former principal database becomes the mirror database.</span></span> <span data-ttu-id="3379f-181">新しいミラー サーバーでは、新しいミラー データベースと新しいプリンシパル データベースとの再同期が迅速に実行されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-181">The new mirror server quickly resynchronizes the new mirror database with the new principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-182">新しいミラー サーバーによってデータベースの再同期が完了すると、再度フェールオーバーが可能になりますが、今度は反対方向にフェールオーバーされることになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-182">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="3379f-183">フェールオーバー後は、クライアントから現在のプリンシパル データベースに再接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-183">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="3379f-184">詳細については、このトピックの「 [データベース ミラーリング セッションへのクライアントの接続 &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-184">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
 <span data-ttu-id="3379f-185">**手動フェールオーバーを開始するには**</span><span class="sxs-lookup"><span data-stu-id="3379f-185">**To initiate manual failover**</span></span>  
  
-   [<span data-ttu-id="3379f-186">データベース ミラーリング セッションを手動でフェールオーバーする方法 &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-186">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
-   <span data-ttu-id="3379f-187">[データベース ミラーリング セッションを手動でフェールオーバーする方法 &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md)。</span><span class="sxs-lookup"><span data-stu-id="3379f-187">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="3379f-188">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="3379f-188">Automatic Failover</span></span>  
 <span data-ttu-id="3379f-189">自動フェールオーバーは、ミラーリング監視サーバーを使用して高い安全性モードで実行されているデータベース ミラーリング セッション (*自動フェールオーバーを伴う高い安全性モード*) でのみサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-189">Automatic failover is supported only in database mirroring sessions running with a witness in high-safety mode (*high-safety mode with automatic failover*).</span></span> <span data-ttu-id="3379f-190">自動フェールオーバーを伴う高い安全性モードでは、一度データベースが同期されると、プリンシパル データベースが使用できなくなった場合に自動フェールオーバーが行われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-190">In high-safety mode with automatic failover, once the database is synchronized, if the principal database becomes unavailable, an automatic failover occurs.</span></span> <span data-ttu-id="3379f-191">自動フェールオーバーが発生すると、ミラー サーバーがプリンシパル サーバーの役割を引き継ぎ、ミラー サーバーのデータベースのコピーがプリンシパル データベースとしてオンラインになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-191">An automatic failover causes the mirror server to take over the role of principal server and bring its copy of the database online as the principal database.</span></span> <span data-ttu-id="3379f-192">データベースが同期していることを要件とすることで、プリンシパル データベースでコミットされたすべてのトランザクションがミラー データベースでもコミットされるため、フェールオーバーの間のデータの損失を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="3379f-192">Requiring that the database be synchronized prevents data loss during failover, because every transaction committed on the principal database is also committed on the mirror database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3379f-193">自動フェールオーバーの信頼性を向上させるには、ミラー データベースとプリンシパル データベースを別のコンピューターに配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-193">For automatic failover to improve reliability, the mirror and principal databases must reside on different computers.</span></span>  
  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="ConditionsForAutoFo"></a> <span data-ttu-id="3379f-194">自動フェールオーバーに必要な条件</span><span class="sxs-lookup"><span data-stu-id="3379f-194">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="3379f-195">自動フェールオーバーを行うには以下の条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-195">Automatic failover requires the following conditions:</span></span>  
  
-   <span data-ttu-id="3379f-196">データベース ミラーリング セッションを高い安全性モードで実行し、ミラーリング監視サーバーを配置している。</span><span class="sxs-lookup"><span data-stu-id="3379f-196">The database mirroring session must be running in high-safety mode and must possess a witness.</span></span> <span data-ttu-id="3379f-197">詳しくは、「 [Database Mirroring Operating Modes](database-mirroring-operating-modes.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="3379f-197">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="3379f-198">ミラー データベースが既に同期している。</span><span class="sxs-lookup"><span data-stu-id="3379f-198">The mirror database must already be synchronized.</span></span> <span data-ttu-id="3379f-199">同期することで、ミラー サーバーに送信されたすべてのログが再実行用としてディスクに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="3379f-199">This guarantees that all of the log sent to the mirror server has been written to disk.</span></span>  
  
-   <span data-ttu-id="3379f-200">プリンシパル サーバーとその他のデータベース ミラーリング構成との通信が切断され、ミラー サーバーとミラーリング監視サーバーはクォーラムを保持している。</span><span class="sxs-lookup"><span data-stu-id="3379f-200">The principal server has lost communication with the rest of the database mirroring configuration, while the mirror and witness retain quorum.</span></span> <span data-ttu-id="3379f-201">ただし、すべてのサーバー インスタンスで通信が切断された場合、ミラーリング監視サーバーとミラー サーバーの通信が回復しても、自動フェールオーバーは行われません。</span><span class="sxs-lookup"><span data-stu-id="3379f-201">If all server instances lose communication, however, and the witness and the mirror server later regain communication, automatic failover does not occur.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-202">詳細については、「[クォーラム: データベースの可用性にミラーリング監視サーバーが与える影響 (データベース ミラーリング)](quorum-how-a-witness-affects-database-availability-database-mirroring.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-202">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
-   <span data-ttu-id="3379f-203">プリンシパル サーバーの障害がミラー サーバーによって検出される。</span><span class="sxs-lookup"><span data-stu-id="3379f-203">The mirror server has detected the loss of the principal server.</span></span>  
  
     <span data-ttu-id="3379f-204">ミラー サーバーによってプリンシパル サーバーの障害がどのように検出されるかは、ハードウェアに関する障害とソフトウェアに関する障害とで異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-204">How the mirror server detects a failure of the principal server depends on whether it is a hard or soft failure.</span></span> <span data-ttu-id="3379f-205">詳細については、「 [データベース ミラーリング中に発生する可能性のあるエラー](possible-failures-during-database-mirroring.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-205">For more information, see [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="3379f-206">自動フェールオーバーの動作</span><span class="sxs-lookup"><span data-stu-id="3379f-206">How Automatic Failover Works</span></span>  
 <span data-ttu-id="3379f-207">上記の条件を満たしている場合、以下の順序で自動フェールオーバーの動作が開始されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-207">Under the preceding conditions, automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="3379f-208">プリンシパル サーバーがまだ実行中の場合は、プリンシパル データベースの状態が DISCONNECTED に変更され、プリンシパル データベースからすべてのクライアントが切断されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-208">If the principal server is still running, it changes the state of the principal database to DISCONNECTED and disconnects all clients from the principal database.</span></span>  
  
2.  <span data-ttu-id="3379f-209">プリンシパル サーバーが使用できなくなったことをミラーリング監視サーバーとミラー サーバーが登録します。</span><span class="sxs-lookup"><span data-stu-id="3379f-209">The witness and mirror servers register that the principal server is unavailable.</span></span>  
  
3.  <span data-ttu-id="3379f-210">再実行キューで待機しているログがある場合は、ミラー サーバーがミラー データベースのロールフォワードを完了します。</span><span class="sxs-lookup"><span data-stu-id="3379f-210">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-211">ログの適用に必要な時間は、システムの処理速度、最近の作業負荷、および再実行キューのログの量によって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-211">The amount of time required to apply the log depends on the speed of the system, the recent work load, and the amount of log in the redo queue.</span></span>  
  
4.  <span data-ttu-id="3379f-212">以前のミラー データベースが新しいプリンシパル データベースとしてオンラインになると、復旧によりコミットされていないすべてのトランザクションをできるだけ迅速にロールバックすることでそのようなトランザクションがクリーンアップされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-212">The former mirror database moves online as the new principal database, and recovery cleans up all uncommitted transactions by rolling them back as quickly as possible.</span></span> <span data-ttu-id="3379f-213">これらのトランザクションはロックによって分離されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-213">Locks isolate those transactions.</span></span>  
  
5.  <span data-ttu-id="3379f-214">以前のプリンシパル サーバーがセッションに再度参加すると、フェールオーバー パートナーがプリンシパルの役割を所有していることを認識します。</span><span class="sxs-lookup"><span data-stu-id="3379f-214">When the former principal server rejoins the session, it recognizes that its failover partner now owns the principal role.</span></span> <span data-ttu-id="3379f-215">以前のプリンシパル サーバーはミラーの役割を引き継ぎ、サーバー内のデータベースをミラー データベースにします。</span><span class="sxs-lookup"><span data-stu-id="3379f-215">The former principal server takes on the role of mirror, making its database the mirror database.</span></span> <span data-ttu-id="3379f-216">この新しいミラー サーバーの新しいミラー データベースは、できるだけ迅速にプリンシパル データベースと同期が取られます。</span><span class="sxs-lookup"><span data-stu-id="3379f-216">The new mirror server synchronizes the new mirror database with the principal database as quickly as possible.</span></span> <span data-ttu-id="3379f-217">新しいミラー サーバーによってデータベースの再同期が完了すると、再度フェールオーバーが可能になりますが、今度は反対方向にフェールオーバーされることになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-217">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="3379f-218">下図に、シングル インスタンスの自動フェールオーバーを示します。</span><span class="sxs-lookup"><span data-stu-id="3379f-218">The following illustration shows a single instance of automatic failover.</span></span>  
  
 <span data-ttu-id="3379f-219">![Automatic failover](../media/dbm-failovauto1round.gif "自動フェールオーバー")</span><span class="sxs-lookup"><span data-stu-id="3379f-219">![Automatic failover](../media/dbm-failovauto1round.gif "Automatic failover")</span></span>  
  
 <span data-ttu-id="3379f-220">最初、3 台のサーバーすべてが接続されています (セッションには完全なクォーラムがあります)。</span><span class="sxs-lookup"><span data-stu-id="3379f-220">Initially, all three servers are connected (the session has full quorum).</span></span> <span data-ttu-id="3379f-221">**Partner_A** がプリンシパル サーバーで、 **Partner_B** がミラー サーバーです。</span><span class="sxs-lookup"><span data-stu-id="3379f-221">**Partner_A** is the principal server and **Partner_B** is the mirror server.</span></span> <span data-ttu-id="3379f-222">**Partner_A** ( **Partner_A**のプリンシパル データベース) が使用できなくなります。</span><span class="sxs-lookup"><span data-stu-id="3379f-222">**Partner_A** (or the principal database on **Partner_A**) becomes unavailable.</span></span> <span data-ttu-id="3379f-223">ミラーリング監視サーバーと **Partner_B** は、プリンシパルが使用できなくなったことを認識します。セッションのクォーラムは保持されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-223">The witness and **Partner_B** both recognize that the principal is no longer available the session retains quorum.</span></span> <span data-ttu-id="3379f-224">**Partner_B** がプリンシパル サーバーになり、サーバー内のデータベースのコピーを新しいプリンシパル データベースとして使用可能にします。</span><span class="sxs-lookup"><span data-stu-id="3379f-224">**Partner_B** becomes the principal server and makes its copy of the database available as the new principal database.</span></span> <span data-ttu-id="3379f-225">その後、 **Partner_A** がセッションに再接続すると、 **Partner_B** がプリンシパルの役割を所有していることが検出されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-225">Eventually, **Partner_A** reconnects to the session and discovers that **Partner_B** now owns the principal role.</span></span> <span data-ttu-id="3379f-226">そこで**Partner_A** がミラーの役割を引き継ぎます。</span><span class="sxs-lookup"><span data-stu-id="3379f-226">**Partner_A** then takes on the mirror role.</span></span>  
  
 <span data-ttu-id="3379f-227">フェールオーバー後は、クライアントから現在のプリンシパル データベースに再接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-227">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="3379f-228">詳細については、このトピックの「 [データベース ミラーリング セッションへのクライアントの接続 &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-228">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3379f-229">[!INCLUDE[msCoName](../../includes/msconame-md.md)] 分散トランザクション コーディネーターを使用して準備したトランザクションのうち、フェールオーバーの発生時点ではコミットされていなかったトランザクションは、データベースのフェールオーバー後に中断したと見なされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-229">Transactions that have been prepared using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator but are still not committed when a failover occurs, are considered aborted after the database has failed over.</span></span>  
  
###  <a name="to-disable-automatic-failover-sql-server-management-studio"></a><a name="DisableAutoSSMS"></a> <span data-ttu-id="3379f-230">自動フェールオーバーを無効化するには (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="3379f-230">To Disable Automatic Failover (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="3379f-231">**[データベースのプロパティ] の [ミラーリング]** ページを開き、次のいずれかのオプションを選択して動作モードを変更します。</span><span class="sxs-lookup"><span data-stu-id="3379f-231">Open the **Database PropertiesMirroring** page, and change the operating mode by selecting one of the following options:</span></span>  
  
-   <span data-ttu-id="3379f-232">**[自動フェールオーバーを伴わない高い安全性 (同期)]**</span><span class="sxs-lookup"><span data-stu-id="3379f-232">**High safety without automatic failover (synchronous)**</span></span>  
  
     <span data-ttu-id="3379f-233">このモードでは、データベースの同期が継続され、引き続き手動フェールオーバーを実行できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-233">In this mode, the database continues to be synchronized, and manual failover remains possible.</span></span>  
  
-   <span data-ttu-id="3379f-234">**[高パフォーマンス (非同期)]**</span><span class="sxs-lookup"><span data-stu-id="3379f-234">**High performance (asynchronous)**</span></span>  
  
     <span data-ttu-id="3379f-235">このモードでは、ミラー データベースでプリンシパル データベースに対する多少の遅延が発生するため、手動フェールオーバーを実行できません。</span><span class="sxs-lookup"><span data-stu-id="3379f-235">In this mode, the mirror database might lag somewhat behind the principal database, and manual failover is no longer possible.</span></span>  
  
### <a name="to-disable-automatic-failover-using-transact-sql"></a><span data-ttu-id="3379f-236">自動フェールオーバーを無効化するには (Transact-SQL の使用)</span><span class="sxs-lookup"><span data-stu-id="3379f-236">To Disable Automatic Failover (Using Transact-SQL)</span></span>  
 <span data-ttu-id="3379f-237">データベース ミラーリング セッションの任意の時点で、データベース所有者はミラーリング監視サーバーを無効にすることで、自動フェールオーバーを無効にできます。</span><span class="sxs-lookup"><span data-stu-id="3379f-237">At any point in a database mirroring session, the database owner can disable automatic failover by turning off the witness.</span></span>  
  
 <span data-ttu-id="3379f-238">**ミラーリング監視サーバーを無効にするには**</span><span class="sxs-lookup"><span data-stu-id="3379f-238">**To turn off the witness**</span></span>  
  
-   [<span data-ttu-id="3379f-239">データベース ミラーリング セッションからのミラーリング監視サーバーの削除 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-239">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
    > [!NOTE]  
    >  <span data-ttu-id="3379f-240">トランザクションの安全性を FULL に保ったままミラーリング監視サーバーを無効にすると、セッションは自動フェールオーバーを伴わない高い安全性モードになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-240">Turning off the witness while retaining full transaction safety puts the session into high-safety mode without automatic failover.</span></span>  
  
##  <a name="forced-service-with-possible-data-loss"></a><a name="ForcedService"></a> <span data-ttu-id="3379f-241">Forced Service (with Possible Data Loss)</span><span class="sxs-lookup"><span data-stu-id="3379f-241">Forced Service (with Possible Data Loss)</span></span>  
 <span data-ttu-id="3379f-242">データベース ミラーリングには、ディザスター リカバリー方法としてサービスの強制 (データ損失の可能性あり) を利用でき、ミラー サーバーをウォーム スタンバイ サーバーとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-242">Database mirroring provides forcing service (with possible data loss) as a disaster recovery method to allow you to use a mirror server as a warm standby server.</span></span> <span data-ttu-id="3379f-243">サービスを強制できるのは、プリンシパル サーバーが、ミラーリング セッションでミラー サーバーから切断された場合だけです。</span><span class="sxs-lookup"><span data-stu-id="3379f-243">Forcing service is possible only if the principal server is disconnected from the mirror server in a mirroring session.</span></span> <span data-ttu-id="3379f-244">サービスを強制するとデータを損失する可能性があるので、サービスの強制は注意深く慎重に使用してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-244">Because forcing service risks possible data loss, it should be used cautiously and sparingly.</span></span>  
  
 <span data-ttu-id="3379f-245">強制的なサービスの起動がサポートされるかどうかは、次に示すように、動作モードとセッションの状態によって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-245">Support for forced service depends on the operating mode and the state of the session, as follows:</span></span>  
  
-   <span data-ttu-id="3379f-246">通常、高パフォーマンス モードでは、プリンシパル サーバーが切断されていれば、サービスの強制がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-246">Typically, high-performance mode supports forcing service whenever the principal server is disconnected.</span></span> <span data-ttu-id="3379f-247">しかし、不要な場合でも、ミラーリング監視サーバーが高パフォーマンス モードのセッション向けに存在する場合があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-247">However, though unnecessary, a witness can exist for a high-performance mode session.</span></span> <span data-ttu-id="3379f-248">この場合、サービスを強制するには、ミラー サーバーとミラーリング監視サーバーが相互に接続されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-248">In this case, forcing service requires that the mirror server and witness are connected to each other.</span></span>  
  
-   <span data-ttu-id="3379f-249">自動フェールオーバーを伴わない高い安全性モードでは、プリンシパル サーバーが切断されていれば、サービスの強制がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-249">High-safety mode without automatic failover supports forcing service whenever the principal server is disconnected.</span></span>  
  
-   <span data-ttu-id="3379f-250">自動フェールオーバーを伴う高い安全性モードでは、ミラー サーバーとミラーリング監視サーバーが相互に接続されていて、どちらもプリンシパル サーバーに接続されていなければ、サービスの強制がサポートされます (ただし、ミラー サーバーがプリンシパル サーバーに最後に接続したときに、ミラー サーバーがミラー データベースのロールバック処理中だった場合は除きます)。</span><span class="sxs-lookup"><span data-stu-id="3379f-250">High-safety mode with automatic failover supports forcing service whenever the mirror server and witness are connected to each other and neither is connected to the principal server (as long as the mirror server was not in the process of rolling back the mirror database when it was last connected to the principal).</span></span>  
  
 <span data-ttu-id="3379f-251">データベースにサービスをすぐに復元する必要があり、データが失われてもかまわない場合に限り、サービスを強制することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3379f-251">We recommend forcing service only if you must restore service to the database immediately and are willing to risk losing data.</span></span> <span data-ttu-id="3379f-252">サービスの強制による効果はミラーリングを削除した場合と似ています。異なる点は、サービスの強制では、データ損失の可能性はありますが、ミラーリングの再開時にデータベースを再同期することが容易になることです。</span><span class="sxs-lookup"><span data-stu-id="3379f-252">The effect of forcing service is similar to removing mirroring, except that forcing service facilitates resynchronizing the databases when mirroring is resumed, at the risk of possible data loss.</span></span> <span data-ttu-id="3379f-253">サービスの強制は、ミラー データベースにプリンシパルの役割をスムーズに移行するための機能です。</span><span class="sxs-lookup"><span data-stu-id="3379f-253">Forcing service initiates a smooth transition of the principal role to the mirror database.</span></span> <span data-ttu-id="3379f-254">ミラー サーバーはプリンシパル サーバーの役割を担うと、データベースのコピーをクライアントにすぐに提供します。</span><span class="sxs-lookup"><span data-stu-id="3379f-254">The mirror server assumes the role of principal server and immediately serves its copy of the database to clients.</span></span> <span data-ttu-id="3379f-255">新しいプリンシパル データベースはミラーなしで実行されます (つまり、データベースは公開された状態で実行されます)。</span><span class="sxs-lookup"><span data-stu-id="3379f-255">The new principal database runs without a mirror (that is, it runs exposed).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3379f-256">プリンシパル サーバーがデータベース ミラーリング セッションから切断されただけで、サーバー自体は実行されている場合、一部のクライアントが元のプリンシパル データベースにアクセスし続けることがあります。</span><span class="sxs-lookup"><span data-stu-id="3379f-256">If the principal server was merely disconnected from the database mirroring session and is still running, some clients might continue to access the original principal database.</span></span> <span data-ttu-id="3379f-257">サービスを強制する前に、クライアントが元のプリンシパル サーバーにアクセスできないようにすることが重要です。</span><span class="sxs-lookup"><span data-stu-id="3379f-257">Before you force service, it is important to prevent clients from accessing the original principal server.</span></span> <span data-ttu-id="3379f-258">そうしないと、サービスが強制された後、元のプリンシパル データベースと現在のプリンシパル データベースがそれぞれ、他方とは無関係に更新されることがあります。</span><span class="sxs-lookup"><span data-stu-id="3379f-258">Otherwise, after service is forced, the original principal database and the current principal database could be updated independently of the other.</span></span>  
  
  
  
###  <a name="typical-case-of-forced-service"></a><a name="TypicalCaseFS"></a> <span data-ttu-id="3379f-259">強制的なサービスの起動の一般的な事例</span><span class="sxs-lookup"><span data-stu-id="3379f-259">Typical Case of Forced Service</span></span>  
 <span data-ttu-id="3379f-260">次の図は、強制的なサービスの起動 (データ損失の可能性あり) の一般的な事例を示しています。</span><span class="sxs-lookup"><span data-stu-id="3379f-260">The following figure illustrates a typical case of forced service (with possible data loss).</span></span>  
  
 <span data-ttu-id="3379f-261">![データ損失の可能性があるサービスの強制](../media/dbm-forced-service.gif "データ損失の可能性があるサービスの強制")</span><span class="sxs-lookup"><span data-stu-id="3379f-261">![Forcing service with possible data loss](../media/dbm-forced-service.gif "Forcing service with possible data loss")</span></span>  
  
 <span data-ttu-id="3379f-262">図では、ミラー サーバー **Partner_B**から元のプリンシパル サーバー **Partner_A**を利用できなくなり、ミラー データベースが切断されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-262">In the figure, the original principal server, **Partner_A**, becomes unavailable to the mirror server, **Partner_B**, causing the mirror database to be disconnected.</span></span> <span data-ttu-id="3379f-263">クライアントが **Partner_A** を利用できないことを確認した後、データベース管理者は、データを失う可能性がありますが **Partner_B**でサービスを強制します。</span><span class="sxs-lookup"><span data-stu-id="3379f-263">After ensuring that **Partner_A** is not available to clients, the database administrator forces service, with possible data loss, on **Partner_B**.</span></span> <span data-ttu-id="3379f-264">**Partner_B** がプリンシパル サーバーになり、データベースが *公開* された状態で (つまり、ミラー化されずに) 実行されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-264">**Partner_B** becomes the principal server and runs with the database *exposed* (that is, unmirrored).</span></span> <span data-ttu-id="3379f-265">この時点で、クライアントは **Partner_B**に再接続できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-265">At this point, clients can reconnect to **Partner_B**.</span></span>  
  
 <span data-ttu-id="3379f-266">**Partner_A** は利用可能になると、新しいプリンシパル サーバーに再接続し、セッションにもう一度参加してミラーの役割を担います。</span><span class="sxs-lookup"><span data-stu-id="3379f-266">When **Partner_A** becomes available, it reconnects to the new principal server, rejoining the session and assuming the mirror role.</span></span> <span data-ttu-id="3379f-267">ミラーリング セッションは直ちに中断され、新しいミラー データベースは同期されません。</span><span class="sxs-lookup"><span data-stu-id="3379f-267">The mirroring session is suspended immediately, without having synchronized the new mirror database.</span></span> <span data-ttu-id="3379f-268">セッションの中断によって、データベース管理者はセッションを再開するかどうか、極端な場合はミラーリングを削除して以前のプリンシパル データベースからデータ復旧を試行するかどうかを決定できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-268">Suspending the session allows the database administrator to decide whether to resume the session or, in extreme cases, remove mirroring and attempt to salvage data from the former principal database.</span></span> <span data-ttu-id="3379f-269">ここでは、データベース管理者はミラーリングを再開することにしました。</span><span class="sxs-lookup"><span data-stu-id="3379f-269">In this case, the database administrator chooses to resume mirroring.</span></span> <span data-ttu-id="3379f-270">その時点で、 **Partner_A** がミラー サーバーの役割を継承し、以前のプリンシパル データベースを、同期トランザクションが最後に正常に完了した時点にロールバックします。コミットされたトランザクションが、サービスが強制される前にミラー サーバー上のディスクに書き込まれていなかった場合、それらのトランザクションは失われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-270">At that point, **Partner_A** takes over the role of mirror server and rolls back the former principal database to the point in time of the last successfully synchronized transaction; if any committed transactions were not written to disk on the mirror server before service was forced, they are lost.</span></span> <span data-ttu-id="3379f-271">その後、**Partner_A** は、以前のミラー サーバーが新しいプリンシパル サーバーになった後で新しいプリンシパル データベースに加えられた変更を適用することによって、新しいミラー データベースをロールフォワードします。</span><span class="sxs-lookup"><span data-stu-id="3379f-271">**Partner_A** then rolls forward the new mirror database by applying any changes made on the new principal database since the former mirror server became the new principal server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3379f-272">高パフォーマンス モードにはミラーリング監視サーバーは必要ありませんが、構成されている場合は、ミラーリング監視サーバーが現在ミラー サーバーに接続されている場合のみサービスの強制が可能です。</span><span class="sxs-lookup"><span data-stu-id="3379f-272">Although high-performance mode does not require a witness, if one is configured, forcing service is possible only if the witness is currently connected to the mirror server.</span></span>  
  
###  <a name="risks-of-forcing-service"></a><a name="FSrisks"></a> <span data-ttu-id="3379f-273">サービスの強制のリスク</span><span class="sxs-lookup"><span data-stu-id="3379f-273">Risks of Forcing Service</span></span>  
 <span data-ttu-id="3379f-274">サービスの強制によってデータが失われる可能性があることを理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-274">It is essential to understand that forcing service can cause data loss.</span></span> <span data-ttu-id="3379f-275">ミラー サーバーがプリンシパル サーバーと通信できなくなり、そのために 2 つのデータベースが必ずしも同期されなくなることが原因で、データが失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-275">Data loss is possible because the mirror server cannot communicate with the principal server and, therefore, cannot guarantee that the two databases are synchronized.</span></span> <span data-ttu-id="3379f-276">サービスを強制すると、新しい復旧分岐が始まります。</span><span class="sxs-lookup"><span data-stu-id="3379f-276">Forcing service starts a new recovery fork.</span></span> <span data-ttu-id="3379f-277">元のプリンシパル データベースとミラー データベースは別の復旧分岐に存在するので、それぞれのデータベースにはもう一方のデータベースには含まれていないデータが含まれることになります。つまり元のプリンシパル データベースには、その送信キューから以前のミラー データベースに送信されなかったすべての変更 (未送信ログ) が含まれ、以前のミラー データベースには、サービスの強制後に行われたすべての変更が含まれます。</span><span class="sxs-lookup"><span data-stu-id="3379f-277">Because the original principal database and mirror database are on different recovery forks, each database now contains data that the other database does not: the original principal database contains whatever changes were not yet sent from its send queue to the former mirror database (the unsent log); the former mirror database contains whatever changes occur after service was forced.</span></span>  
  
 <span data-ttu-id="3379f-278">プリンシパル サーバーで障害が発生したためにサービスが強制された場合、データが損失するかどうかは、障害発生前にミラー サーバーに送信されなかったトランザクション ログがあるかどうかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-278">If service is forced because the principal server has failed, potential data loss is depends on whether any transaction logs were not sent to the mirror server before the failure.</span></span> <span data-ttu-id="3379f-279">高い安全性モードの場合、データが損失するのは、ミラー データベースが同期された状態になるまでの間だけです。</span><span class="sxs-lookup"><span data-stu-id="3379f-279">Under high-safety mode, this is possible only until the mirror database becomes synchronized.</span></span> <span data-ttu-id="3379f-280">高パフォーマンス モードの場合、蓄積された未送信ログがある場合は常にデータ損失の可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-280">Under the high-performance mode, accumulated unsent log is always a possibility.</span></span>  
  
 <span data-ttu-id="3379f-281">サービスの強制による影響は、セッションにミラーリング監視サーバーが設定されているかどうかによって多少異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-281">The implications of forcing service depend partly on whether the session has a witness:</span></span>  
  
-   <span data-ttu-id="3379f-282">ミラーリング監視サーバーが存在しない場合、ネットワーク接続が切断されるなどの原因によってパートナーが切断されると、サービスを強制できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-282">In the absence of a witness, service can be forced if the partners become disconnected, for example, because their network connection is broken.</span></span> <span data-ttu-id="3379f-283">元のプリンシパル サーバーが実行されている場合、両方のパートナーがプリンシパルの役割を担います。</span><span class="sxs-lookup"><span data-stu-id="3379f-283">If the original principal server is still running, both partners own the principal role.</span></span> <span data-ttu-id="3379f-284">新しいプリンシパル サーバーに接続しているクライアントは、現在のバージョンのデータベースにアクセスし、元のプリンシパル サーバーに接続しているクライアントは元のプリンシパル データベースにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="3379f-284">Clients connecting to the new principal server will access the current version of the database, while clients connecting to the original principal server will access the original principal database.</span></span> <span data-ttu-id="3379f-285">この状況により、データ損失の可能性が大きくなります。</span><span class="sxs-lookup"><span data-stu-id="3379f-285">This situation increases the potential for data loss.</span></span> <span data-ttu-id="3379f-286">パートナーが再接続を許可されたら、元のプリンシパル サーバーはミラーの役割を担い、ミラーリングが中断される前にデータベースの状態を "復旧しています" の状態に変更します。</span><span class="sxs-lookup"><span data-stu-id="3379f-286">If the partners are allowed to reconnect, the original principal server assumes the mirror role and changes the status of its database to "recovering," before mirroring is suspended.</span></span> <span data-ttu-id="3379f-287">セッションが再開されると、前回切断されたときに送信キューにあったログを所有する元のプリンシパル データベースのトランザクションが失われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-287">If the session is resumed, transactions on the original principal database whose log was in the send queue as of the most recent disconnection are lost.</span></span> <span data-ttu-id="3379f-288">また、サービスの強制後に発生したトランザクションも失われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-288">In addition, any the transactions that occurred after service was forced are also lost.</span></span>  
  
-   <span data-ttu-id="3379f-289">ミラーリング監視サーバーが存在する場合、ミラー サーバーがプリンシパル サーバーとミラーリング監視サーバーの両方から切断されると、プリンシパル サーバーとミラーリング監視サーバーが相互に接続されている限り、プリンシパルが公開された状態で実行されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-289">In the presence of a witness, if the mirror server is disconnected from both the principal server and the witness, as long as the latter two remain connected to each other, the principal runs exposed.</span></span> <span data-ttu-id="3379f-290">その後、プリンシパル サーバーがミラーリング監視サーバーから切断されると、データベースとして機能しなくなります。</span><span class="sxs-lookup"><span data-stu-id="3379f-290">If the principal server then becomes disconnected from the witness, it stops serving the database.</span></span> <span data-ttu-id="3379f-291">そのため、ミラー サーバーがミラーリング監視サーバーに再接続した後、サービスの強制が可能になります。</span><span class="sxs-lookup"><span data-stu-id="3379f-291">Thereafter, if the mirror server reconnects to the witness, forcing service becomes possible.</span></span> <span data-ttu-id="3379f-292">サービスが強制されると、元のプリンシパル サーバーが再接続されたときに、元のプリンシパル サーバーが公開された状態で実行されていたときに行われたすべての変更が失われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-292">If service is forced, all the changes made while the original principal server was running exposed will be lost if the original principal server reconnects.</span></span>  
  
 <span data-ttu-id="3379f-293">詳細については、このトピックの「 [データ損失の可能性への対処](#ManageDataLoss)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3379f-293">For more information, see [Managing the Potential Data Loss](#ManageDataLoss), later in this topic.</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ManageDataLoss"></a> <span data-ttu-id="3379f-294">データ損失の可能性への対処</span><span class="sxs-lookup"><span data-stu-id="3379f-294">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="3379f-295">サービスの強制後、以前のプリンシパル サーバーが使用可能になると、そのデータベースは破損していないと想定されるので、データ損失の可能性に対処できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-295">After service is forced, once the former principal server is available, assuming that its database is undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="3379f-296">データ損失の可能性に対処するために使用できる方法は、元のプリンシパル サーバーがそのパートナーに再接続され、ミラーリング セッションにもう一度参加したかどうかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3379f-296">The available approach for managing potential data loss depends on whether the original principal server has reconnected to its partner and rejoined the mirroring session.</span></span> <span data-ttu-id="3379f-297">元のプリンシパル サーバーが新しいプリンシパル インスタンスにアクセスできる場合、自動的に再接続されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-297">Assuming that the original principal server can access the new principal instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-principal-server-has-reconnected"></a><span data-ttu-id="3379f-298">元のプリンシパル サーバーが再接続された場合</span><span class="sxs-lookup"><span data-stu-id="3379f-298">The Original Principal Server Has Reconnected</span></span>  
 <span data-ttu-id="3379f-299">通常、障害発生後は、元のプリンシパル サーバーは再起動するとすぐに、パートナーに再接続します。</span><span class="sxs-lookup"><span data-stu-id="3379f-299">Typically, after a failure, when the original principal server restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="3379f-300">再接続されると、元のプリンシパル サーバーがミラー サーバーになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-300">On reconnecting, the original principal server becomes the mirror server.</span></span> <span data-ttu-id="3379f-301">そのデータベースはミラー データベースになり、セッションが中断されるまで復旧中の状態になります。</span><span class="sxs-lookup"><span data-stu-id="3379f-301">Its database becomes the mirror database and enters the recovering state before the session is suspended.</span></span> <span data-ttu-id="3379f-302">ミラー データベースは、ミラーリングを再開しない限り、ロールバックされません。</span><span class="sxs-lookup"><span data-stu-id="3379f-302">The mirror database will not be not rolled back unless you resume mirroring.</span></span>  
  
 <span data-ttu-id="3379f-303">ただし、復旧中のデータベースにはアクセスできないので、データベースを調査し、ミラーリングを再開したときにどのデータが失われるのかを評価することができません。</span><span class="sxs-lookup"><span data-stu-id="3379f-303">However, the recovering database is inaccessible; therefore, you cannot inspect it to evaluate what data would be lost if you were to resume mirroring.</span></span> <span data-ttu-id="3379f-304">そのため、ミラーリングを再開するか削除するかは、データの損失を許容できるかどうかによって決まります。</span><span class="sxs-lookup"><span data-stu-id="3379f-304">Therefore, the decision on whether to resume or remove mirroring depends on whether you are willing to accept any data loss at all.</span></span>  
  
-   <span data-ttu-id="3379f-305">データの損失を許容できない場合は、ミラーリングを削除して、データを復旧する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-305">If losing any data would be unacceptable, you should remove mirroring to salvage them.</span></span>  
  
     <span data-ttu-id="3379f-306">ミラーリングを削除すると、データベース管理者は元のプリンシパル データベースを復旧し、失われる可能性のあるデータの復旧を試みることができます。</span><span class="sxs-lookup"><span data-stu-id="3379f-306">Removing mirroring would allow the database administrator to recover the original principal database and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="3379f-307">ただし、以前のミラー データベースがオンラインになると、以前のパートナーは同じ名前の異なるデータベースとして機能するようになります。</span><span class="sxs-lookup"><span data-stu-id="3379f-307">However, when the former mirror database comes online, the former partners will be serving divergent databases with the same name.</span></span> <span data-ttu-id="3379f-308">データベース管理者はそれらのデータベースのいずれかをクライアントからアクセスできないようにして、さらに別のデータベースが作成されたり、クライアントのフェールオーバー問題が発生することを防ぐ必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-308">The database administrator needs to make one of the databases inaccessible to clients to avoid further divergence of the database and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="3379f-309">データの損失を許容できる場合は、ミラーリングを再開できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-309">If losing any data would be acceptable, you can resume mirroring.</span></span>  
  
     <span data-ttu-id="3379f-310">ミラーリングを再開すると、新しいミラー データベースがデータベース同期の最初のステップとしてロールバックされます。</span><span class="sxs-lookup"><span data-stu-id="3379f-310">Resuming mirroring causes the new mirror database to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="3379f-311">障害発生時にログ レコードが送信キューで待機していた場合、対応するトランザクションはコミットされていた場合でも失われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-311">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-principal-server-has-not-reconnected"></a><span data-ttu-id="3379f-312">元のプリンシパル サーバーが再接続されなかった場合</span><span class="sxs-lookup"><span data-stu-id="3379f-312">The Original Principal Server Has Not Reconnected</span></span>  
 <span data-ttu-id="3379f-313">元のプリンシパル サーバーが新しいプリンシパル サーバーにネットワーク経由で再接続するのを一時的に防ぐことができる場合、元のプリンシパル データベースを調査して、ミラーリングが再開されたらどのデータが失われるのかを評価できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-313">If you can temporarily prevent the original principal server from reconnecting over the network to the new principal server, you can inspect the original principal database to evaluate what data would be lost if mirroring were resumed.</span></span>  
  
-   <span data-ttu-id="3379f-314">データ損失が許容される場合</span><span class="sxs-lookup"><span data-stu-id="3379f-314">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="3379f-315">元のプリンシパル サーバーがそのパートナーに再接続できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-315">Allow the original principal server to reconnect to its partner.</span></span> <span data-ttu-id="3379f-316">再接続を行うと、ミラーリングが中断されます。</span><span class="sxs-lookup"><span data-stu-id="3379f-316">Reconnecting causes mirroring to be suspended.</span></span> <span data-ttu-id="3379f-317">ミラーリングを続行するには、セッションを再開するだけです。</span><span class="sxs-lookup"><span data-stu-id="3379f-317">To proceed with mirroring, simply resume the session.</span></span> <span data-ttu-id="3379f-318">以前のプリンシパル サーバーがミラーの役割を担います。</span><span class="sxs-lookup"><span data-stu-id="3379f-318">The former principal server assumes the mirror role.</span></span> <span data-ttu-id="3379f-319">新しいミラー サーバーが元の復旧分岐を削除し、以前のミラー サーバーに送信されなかったか以前のミラー サーバーによって受信されなかったすべてのトランザクションが失われます。</span><span class="sxs-lookup"><span data-stu-id="3379f-319">The new mirror server drops the original recovery fork, losing any transactions that were never sent to or received by the former mirror server.</span></span>  
  
-   <span data-ttu-id="3379f-320">データ損失が許容されない場合</span><span class="sxs-lookup"><span data-stu-id="3379f-320">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="3379f-321">セッションを再開したら失われる重要なデータが元のプリンシパル サーバーに含まれている場合、ミラーリングを削除することにより元のプリンシパル サーバー上のデータを保持できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-321">If the original principal database contains critical data that would be lost if you resumed the session, you can preserve the data on the original principal server by removing mirroring.</span></span> <span data-ttu-id="3379f-322">この時点で、プリンシパルのログの末尾をバックアップしておくことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3379f-322">We recommend that you attempt to back up the tail of the principal's log at this point.</span></span> <span data-ttu-id="3379f-323">その後、復旧したいデータを最初のプリンシパル データベースからエクスポートして、そのデータを現在のプリンシパル データベースにインポートすることにより、現在のプリンシパル (以前のミラー データベース) を更新できます。</span><span class="sxs-lookup"><span data-stu-id="3379f-323">Then, you can update the current principal (the former mirror database) by exporting the data you want to salvage from the original principal database and importing it into the current principal database.</span></span> <span data-ttu-id="3379f-324">更新されたデータベースの完全バックアップを、できるだけ早く実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3379f-324">We recommend taking a full database backup of the updated database as quickly as possible.</span></span>  
  
     <span data-ttu-id="3379f-325">更新されたデータベースを最初のプリンシパル データベースとするミラーリングを再確立するには、このバックアップ (およびそれ以降のログ バックアップ 1 つ以上) を使用して、新しいミラー データベースを作成します。</span><span class="sxs-lookup"><span data-stu-id="3379f-325">To re-establish mirroring with the updated database as the initial principal database, use this backup (and least one subsequent log backup) to create a new mirror database.</span></span> <span data-ttu-id="3379f-326">ミラーリングの削除後に実行したログ バックアップをすべて適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3379f-326">Every log backup taken after mirroring was removed must be applied.</span></span> <span data-ttu-id="3379f-327">そのため、新しいミラーリング セッションが開始されるまで、プリンシパル データベースで追加のログ バックアップを作成しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3379f-327">Therefore, we recommend delaying additional log backups of the principal database until the new mirroring session starts.</span></span>  
  
###  <a name="related-tasks-for-managing-a-forced-failover"></a><a name="RelatedTasksForFS"></a> <span data-ttu-id="3379f-328">強制フェールオーバーを管理するための関連タスク</span><span class="sxs-lookup"><span data-stu-id="3379f-328">Related Tasks For Managing a Forced Failover</span></span>  
 <span data-ttu-id="3379f-329">**サービスを強制するには**</span><span class="sxs-lookup"><span data-stu-id="3379f-329">**To force service**</span></span>  
  
-   <span data-ttu-id="3379f-330">[データベース ミラーリング セッションでのサービスを強制する &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md)。</span><span class="sxs-lookup"><span data-stu-id="3379f-330">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span></span>  
  
 <span data-ttu-id="3379f-331">**データベース ミラーリングを再開するには**</span><span class="sxs-lookup"><span data-stu-id="3379f-331">**To resume database mirroring**</span></span>  
  
-   [<span data-ttu-id="3379f-332">データベース ミラーリング セッションを一時停止または再開する &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-332">Pause or Resume a Database Mirroring Session &#40;SQL Server&#41;</span></span>](pause-or-resume-a-database-mirroring-session-sql-server.md)  
  
 <span data-ttu-id="3379f-333">**新しいミラー データベースを作成するには**</span><span class="sxs-lookup"><span data-stu-id="3379f-333">**To create a new mirror database**</span></span>  
  
 [<span data-ttu-id="3379f-334">ミラーリングのためのミラー データベースの準備 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-334">Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;</span></span>](prepare-a-mirror-database-for-mirroring-sql-server.md)  
  
 <span data-ttu-id="3379f-335">**データベース ミラーリングを開始するには**</span><span class="sxs-lookup"><span data-stu-id="3379f-335">**To start up database mirroring**</span></span>  
  
-   [<span data-ttu-id="3379f-336">データベース ミラーリングの設定 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-336">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="3379f-337">Windows 認証を使用してデータベース ミラーリング セッションを確立する &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-337">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="3379f-338">参照</span><span class="sxs-lookup"><span data-stu-id="3379f-338">See Also</span></span>  
 <span data-ttu-id="3379f-339">[役割の交代中に発生するサービスの中断時間の算出 &#40;データベース ミラーリング&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="3379f-339">[Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span></span>  
 <span data-ttu-id="3379f-340">[データベース ミラーリング中に発生する可能性のあるエラー](possible-failures-during-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="3379f-340">[Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md) </span></span>  
 <span data-ttu-id="3379f-341">[データベース ミラーリング セッションへのクライアントの接続 &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="3379f-341">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="3379f-342">[データベース ミラーリング監視サーバー](database-mirroring-witness.md) </span><span class="sxs-lookup"><span data-stu-id="3379f-342">[Database Mirroring Witness](database-mirroring-witness.md) </span></span>  
 <span data-ttu-id="3379f-343">[データベースの全体復元 &#40;完全復旧モデル&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="3379f-343">[Complete Database Restores &#40;Full Recovery Model&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="3379f-344">[データベース ミラーリングの動作モード](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="3379f-344">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="3379f-345">ミラーリング状態 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3379f-345">Mirroring States &#40;SQL Server&#41;</span></span>](mirroring-states-sql-server.md)  
  
  
