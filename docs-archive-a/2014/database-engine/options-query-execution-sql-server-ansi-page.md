---
title: '[オプション] ([クエリ実行]-SQL Server-[ANSI] ページ) |Microsoft Docs'
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
f1_keywords:
- VS.ToolsOptionsPages.QueryExecution.SqlServer.SqlExecutionAnsi
ms.assetid: 0f4c6887-0562-417e-806c-b5cffb1e7c5c
author: rothja
ms.author: jroth
ms.openlocfilehash: 198505c5d14b9fda510d4635dbaa3d3d49483ddf
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87644610"
---
# <a name="options-query-execution-sql-server-ansi-page"></a><span data-ttu-id="4fe8a-102">[オプション] ([クエリ実行]-SQL Server-[ANSI] ページ)</span><span class="sxs-lookup"><span data-stu-id="4fe8a-102">Options (Query Execution-SQL Server-ANSI Page)</span></span>
  <span data-ttu-id="4fe8a-103">ユーザーのクエリや、トリガーやストアド プロシージャが実行されている間、これらの ANSI (ISO) 規格の SET オプションの組み合わせによってクエリ処理環境が定義されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-103">Together, these ANSI (ISO) standard SET options define the query processing environment for the duration of the user's query, a running trigger, or a stored procedure.</span></span> <span data-ttu-id="4fe8a-104">ただし、これらの SET オプションに、ISO 規格に準拠するために必要なオプションがすべて含まれているとは限りません。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-104">These SET options, however, do not include all of the options required to conform to the ISO standard.</span></span> <span data-ttu-id="4fe8a-105">このページを使用すると、 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ISO 規格で指定されているすべての設定または設定の一部を使用してクエリを実行するように指定できます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-105">Use this page to specify that [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] will run the queries using all or a portion of the settings specified in the ISO standard.</span></span> <span data-ttu-id="4fe8a-106">このオプションに加えた変更は、新規の [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] クエリにのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-106">Changes to these options are applied only to new [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] queries.</span></span> <span data-ttu-id="4fe8a-107">現在のクエリのオプションを変更するには、[**クエリ**] メニューの [**クエリオプション**] をクリックするか、クエリウィンドウを右クリック [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] して [**クエリオプション**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-107">To change the options for the current queries, click **Query Options** on the **Query** menu, or right-click in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Query window and select **Query Options**.</span></span> <span data-ttu-id="4fe8a-108">**[クエリ オプション]** ダイアログ ボックスで、**[実行]** の下にある **[ANSI]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-108">In the **Query Options** dialog box, under **Execution**, click **ANSI**.</span></span>  
  
## <a name="ui-element-list"></a><span data-ttu-id="4fe8a-109">UI 要素の一覧</span><span class="sxs-lookup"><span data-stu-id="4fe8a-109">UI element list</span></span>  
 <span data-ttu-id="4fe8a-110">**SET ANSI_DEFAULTS**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-110">**SET ANSI_DEFAULTS**</span></span>  
 <span data-ttu-id="4fe8a-111">このチェック ボックスをオンにすると、既定の ISO 設定がすべて選択されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-111">Select this check box to select all of the default ISO settings.</span></span> <span data-ttu-id="4fe8a-112">既定では、すべての ISO オプションが選択されるとは限りません。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-112">Not all ISO options are selected by default.</span></span>  
  
 <span data-ttu-id="4fe8a-113">**SET QUOTED_IDENTIFIER**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-113">**SET QUOTED_IDENTIFIER**</span></span>  
 <span data-ttu-id="4fe8a-114">このチェック ボックスをオンにすると、識別子とリテラル文字列を区切る引用符に関する ISO 規則が [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] によって遵守されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-114">When this check box is selected, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] follows the ISO rules regarding quotation mark delimiting identifiers and literal strings.</span></span> <span data-ttu-id="4fe8a-115">引用符で区切ることで、Transact-SQL の予約済みキーワードを識別子として指定することや、Transact-SQL の構文規則で通常は識別子として使用が認められていない文字を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-115">Identifiers delimited by quotation marks can be either Transact-SQL reserved keywords or can contain characters not usually allowed by the Transact-SQL syntax rules for identifiers.</span></span> <span data-ttu-id="4fe8a-116">既定では、このチェック ボックスはオンになっています。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-116">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="4fe8a-117">**SET ANSI_NULL_DFLT_ON**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-117">**SET ANSI_NULL_DFLT_ON**</span></span>  
 <span data-ttu-id="4fe8a-118">このチェック ボックスをオンにすると、CREATE TABLE ステートメントまたは ALTER TABLE ステートメントで明示的に NOT NULL に定義されなかったユーザー定義データ型または列が、すべて既定で NULL 値を許容するという設定になります。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-118">When this value is set, all user-defined data types or columns that are not explicitly defined as NOT NULL during a CREATE TABLE or ALTER TABLE statement default to allowing null values.</span></span> <span data-ttu-id="4fe8a-119">既定では、このチェック ボックスはオンになっています。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-119">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="4fe8a-120">**[SET IMPLICIT_TRANSACTIONS]**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-120">**SET IMPLICIT_TRANSACTIONS**</span></span>  
 <span data-ttu-id="4fe8a-121">このチェック ボックスをオンにすると、接続が暗黙のトランザクション モードに設定されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-121">When this check box is selected, SET IMPLICIT_TRANSACTIONS sets the connection into implicit transaction mode.</span></span> <span data-ttu-id="4fe8a-122">このチェック ボックスをオフにすると、接続は自動コミット トランザクション モードに戻ります。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-122">When this check box is cleared, it returns the connection to autocommit transaction mode.</span></span> <span data-ttu-id="4fe8a-123">暗黙のトランザクション モードが選択されているときに、暗黙のトランザクションを開始するステートメントについては、「[SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-123">To review the statements that start an implicit transaction when selected, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span> <span data-ttu-id="4fe8a-124">既定では、このチェック ボックスはオフです。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-124">This check box is cleared by default.</span></span>  
  
 <span data-ttu-id="4fe8a-125">**SET CURSOR_CLOSE_ON_COMMIT**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-125">**SET CURSOR_CLOSE_ON_COMMIT**</span></span>  
 <span data-ttu-id="4fe8a-126">このチェック ボックスをオンにすると、トランザクションがコミットされたときに、オープンしているカーソルが ISO に準拠して自動的にクローズします。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-126">When this check box is selected, any open cursors are closed automatically (in compliance with ISO) when a transaction is committed.</span></span> <span data-ttu-id="4fe8a-127">このチェック ボックスをオフにすると、トランザクションが変わってもカーソルはオープンしたままです。接続が終了するか、カーソルが明示的にクローズされたときだけカーソルがクローズします。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-127">When this value is set to OFF, cursors remain open across transaction boundaries, closing only when the connection is closed or when they are explicitly closed.</span></span> <span data-ttu-id="4fe8a-128">既定では、このチェック ボックスはオフです。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-128">This check box is cleared by default.</span></span>  
  
 <span data-ttu-id="4fe8a-129">**SET ANSI_PADDING**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-129">**SET ANSI_PADDING**</span></span>  
 <span data-ttu-id="4fe8a-130">列に定義されているサイズよりも短い値の名前を列に格納する方法と、値の後に **char**、**varchar**、**binary**、**varbinary** データ型で空白が続いている値を列に格納する方法を指定します。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-130">Controls the way the column stores value names shorter than the defined size of the column, and the way the column stores values that have trailing blanks in **char**, **varchar**, **binary**, and **varbinary** data.</span></span> <span data-ttu-id="4fe8a-131">この設定は新しい列の定義にだけ影響します。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-131">This setting affects only the definition of new columns.</span></span> <span data-ttu-id="4fe8a-132">列が作成された後は、 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] では列の作成時の設定に基づいて値が格納されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-132">After the column is created, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] stores the values based on the setting when the column was created.</span></span> <span data-ttu-id="4fe8a-133">この設定を後で変更しても、既存の列には影響がありません。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-133">Existing columns are not affected by a later change to this setting.</span></span> <span data-ttu-id="4fe8a-134">既定では、このチェック ボックスはオンになっています。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-134">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="4fe8a-135">**SET ANSI_WARNINGS**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-135">**SET ANSI_WARNINGS**</span></span>  
 <span data-ttu-id="4fe8a-136">複数のエラー条件に対して ISO 標準の動作をすることを指定します。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-136">Specifies ISO standard behavior for several error conditions:</span></span>  
  
-   <span data-ttu-id="4fe8a-137">このチェック ボックスをオンにすると、NULL 値が集計関数 (SUM、AVG、MAX、MIN、STDEV、STDEVP、VAR、VARP、COUNT など) で使用されている場合に、警告メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-137">When this check box is selected, if null values appear in aggregate functions (such as SUM, AVG, MAX, MIN, STDEV, STDEVP, VAR, VARP, or COUNT), a warning message is generated.</span></span> <span data-ttu-id="4fe8a-138">オフの場合は、警告メッセージは生成されません。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-138">When OFF, no warning is issued.</span></span>  
  
-   <span data-ttu-id="4fe8a-139">このチェック ボックスをオフにすると、0 除算や演算オーバーフロー エラーが発生したときにステートメントがロールバックされ、エラー メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-139">When this check box is cleared, divide-by-zero and arithmetic overflow errors cause the statement to be rolled back and an error message to be generated.</span></span> <span data-ttu-id="4fe8a-140">オフの場合は、0 除算や演算オーバーフロー エラーが発生したときに NULL 値が返されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-140">When OFF, divide-by-zero and arithmetic overflow errors cause null values to be returned.</span></span> <span data-ttu-id="4fe8a-141">INSERT 処理または UPDATE 処理が **character**、**Unicode**、**binary** 型の列に対して実行され、新しい値が列の最大サイズより長くなると、0 除算や演算オーバーフロー エラーが原因となって NULL 値が返されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-141">The behavior in which a divide-by-zero or arithmetic overflow error causes null values to be returned occurs if an INSERT or UPDATE operation is attempted on a **character**, **Unicode**, or **binary** column in which the length of a new value exceeds the maximum size of the column.</span></span> <span data-ttu-id="4fe8a-142">[SET ANSI_WARNINGS] がオンの場合は、INSERT 処理または UPDATE 処理は ISO 規格の指定に従って取り消されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-142">If SET ANSI_WARNINGS is ON, the INSERT or UPDATE operation is canceled as specified by the ISO standard.</span></span> <span data-ttu-id="4fe8a-143">文字型の列の末尾の空白文字とバイナリ列の末尾の NULL 値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-143">Trailing blanks are ignored for character columns and trailing nulls are ignored for binary columns.</span></span> <span data-ttu-id="4fe8a-144">OFF の場合、データは列のサイズに切り捨てられ、ステートメントは成功します。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-144">When OFF, data is truncated to the size of the column and the statement succeeds.</span></span>  
  
 <span data-ttu-id="4fe8a-145">既定では、このチェック ボックスはオンになっています。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-145">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="4fe8a-146">**SET ANSI_NULLS**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-146">**SET ANSI_NULLS**</span></span>  
 -   <span data-ttu-id="4fe8a-147">等号 (=) 比較演算子と不等号 (<>) 比較演算子を NULL 値に対して使用した場合に ISO に準拠した動作をすることを指定します。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-147">Specifies ISO compliant behavior of the equals (=) and not equal to (<>) comparison operators when used with null values.</span></span> <span data-ttu-id="4fe8a-148">[SET ANSI_NULLS] がオンの場合、NULL 値に対する比較はすべて UNKNOWN として評価されます。これは ISO 準拠した動作です。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-148">When SET ANSI_NULLS is selected, all comparisons against a null value evaluate to UNKNOWN, the ISO compliant behavior.</span></span> <span data-ttu-id="4fe8a-149">[SET ANSI_NULLS] がオフの場合、NULL 値に対するデータの比較はすべて TRUE に評価されます。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-149">When SET ANSI_NULLS is not selected, comparisons of all data against a null value evaluate to TRUE.</span></span> <span data-ttu-id="4fe8a-150">既定では、このチェック ボックスはオンになっています。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-150">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="4fe8a-151">**既定値にリセット**</span><span class="sxs-lookup"><span data-stu-id="4fe8a-151">**Reset to Default**</span></span>  
 <span data-ttu-id="4fe8a-152">このページ上のすべての値を元の既定値にリセットします。</span><span class="sxs-lookup"><span data-stu-id="4fe8a-152">Resets all values on this page to the original default values.</span></span>  
  
  
