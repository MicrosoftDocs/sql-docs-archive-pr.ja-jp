---
title: アップグレード PowerPivot for SharePoint |Microsoft Docs
ms.custom: ''
ms.date: 03/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 80ba9e43-f3f0-4730-9fb1-2afd2dd3e6fc
author: Minewiskan
ms.author: owend
ms.openlocfilehash: bebcfed02aa30ffc686b2a74807b6a4cc3955c90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634612"
---
# <a name="upgrade-powerpivot-for-sharepoint"></a><span data-ttu-id="0a204-102">PowerPivot for SharePoint のアップグレード</span><span class="sxs-lookup"><span data-stu-id="0a204-102">Upgrade PowerPivot for SharePoint</span></span>
  <span data-ttu-id="0a204-103">このトピックでは、 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] の配置を [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)]にアップグレードするために必要な手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="0a204-103">This topic summarizes the steps required to upgrade a deployment of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] to [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span></span> <span data-ttu-id="0a204-104">具体的な手順は、現在環境が実行されている SharePoint のバージョンによって異なり、PowerPivot for SharePoint アドイン (**spPowerPivot.msi**) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0a204-104">The specific steps depend on the version of SharePoint your environment is currently running and include the PowerPivot for SharePoint Add-in (**spPowerPivot.msi**).</span></span>  
  
 <span data-ttu-id="0a204-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="0a204-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span></span>  
  
 <span data-ttu-id="0a204-106">リリースノートについては、「 [SQL Server 2014 リリースノート](https://go.microsoft.com/fwlink/?LinkID=296445)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-106">For release notes, see [SQL Server 2014 Release Notes](https://go.microsoft.com/fwlink/?LinkID=296445).</span></span>  
  

  
## <a name="background"></a><span data-ttu-id="0a204-107">バックグラウンド</span><span class="sxs-lookup"><span data-stu-id="0a204-107">Background</span></span>  
  
-   <span data-ttu-id="0a204-108">複数の [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] インスタンスを含むマルチサーバー SharePoint 2010 ファームをアップグレードする場合は、各サーバーを完全にアップグレードした **後** で、次のサーバーのアップグレードを続行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-108">If you are upgrading a multi-server SharePoint 2010 farm that has two or more [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instances, you must fully upgrade each server **before** continuing to the next server.</span></span> <span data-ttu-id="0a204-109">完全なアップグレードでは、SQL Server セットアップを実行して [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] プログラム ファイルをアップグレードした後、アップグレードしたサービスを構成するアップグレード処理を実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-109">A full upgrade includes running SQL Server Setup to upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] program files, followed by SharePoint upgrade actions that configure the upgraded services.</span></span> <span data-ttu-id="0a204-110">適切な PowerPivot 構成ツールまたは Windows PowerShell でアップグレード処理を実行するまでは、サーバーの可用性が制限されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-110">Server availability will be limited until you run upgrade actions in the appropriate PowerPivot Configuration Tool or Windows PowerShell.</span></span>  
  
-   <span data-ttu-id="0a204-111">SharePoint 2010 ファーム内の PowerPivot System サービスおよび Analysis Services のインスタンスはすべて、同じバージョンである必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-111">All instances of PowerPivot System Service and Analysis Services in a SharePoint 2010 farm must be the same version.</span></span> <span data-ttu-id="0a204-112">バージョンを確認する方法については、このトピックの「 [PowerPivot のコンポーネントとサービスのバージョンを確認](#bkmk_verify_versions)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-112">For information on how to verify the version, see the section [Verify the Versions of PowerPivot Components and Services](#bkmk_verify_versions) in this topic.</span></span>  
  
-   <span data-ttu-id="0a204-113">PowerPivot 構成ツールは SQL Server の共有機能の 1 つで、すべての共有機能は同時にアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="0a204-113">The PowerPivot configuration tools are one of the SQL Server shared features and all shared features upgrade at the same time.</span></span> <span data-ttu-id="0a204-114">アップグレード プロセス中に、共有機能のアップグレードを必要とする他の SQL Server インスタンスまたは機能を選択すると、PowerPivot 構成ツールもアップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="0a204-114">If during an upgrade process you select other SQL Server instances or features that require a shared feature upgrade, then the PowerPivot configuration tool will also be upgraded.</span></span> <span data-ttu-id="0a204-115">PowerPivot 構成ツールがアップグレードされても PowerPivot インスタンスがアップグレードされない場合は、問題が発生している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-115">You may have issues if the PowerPivot configuration tool is upgraded but your PowerPivot instance is not.</span></span> <span data-ttu-id="0a204-116">SQL Server 共有機能の詳細については、「 [SQL Server 2014 へのアップグレード」 &#40;「インストールウィザードを使用したセットアップ&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-116">For more information about SQL Server shared features, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
-   <span data-ttu-id="0a204-117">PowerPivot for SharePoint アドイン (**spPowerPivot.msi**) は、以前のバージョンとサイドバイサイドでインストールされます。</span><span class="sxs-lookup"><span data-stu-id="0a204-117">The PowerPivot for SharePoint Add-in (**spPowerPivot.msi**) installs side by side with previous versions.</span></span> <span data-ttu-id="0a204-118">たとえば [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] アドインは、 `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`フォルダーにインストールされます。</span><span class="sxs-lookup"><span data-stu-id="0a204-118">For example the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] add-in installs to the folder `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span></span>  
  

  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="0a204-119">前提条件</span><span class="sxs-lookup"><span data-stu-id="0a204-119">Prerequisites</span></span>  
 <span data-ttu-id="0a204-120">**アクセス許可**</span><span class="sxs-lookup"><span data-stu-id="0a204-120">**Permissions**</span></span>  
  
-   <span data-ttu-id="0a204-121">PowerPivot for SharePoint のインストールをアップグレードするには、ファームの管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-121">You must be a farm administrator to upgrade a PowerPivot for SharePoint installation.</span></span> <span data-ttu-id="0a204-122">SQL Server セットアップを実行するには、ローカル管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-122">You must be a local administrator to run SQL Server Setup.</span></span>  
  
-   <span data-ttu-id="0a204-123">ファーム構成データベースに対する **db_owner** 権限を持っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-123">You must have **db_owner** permissions on the farm configuration database.</span></span>  
  
 <span data-ttu-id="0a204-124">**SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="0a204-124">**SQL Server:**</span></span>  
  
-   <span data-ttu-id="0a204-125">既存の PowerPivot のインストールがの場合は [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 、 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] へのアップグレードに Service Pack 2 (SP2) が必要です [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="0a204-125">If the existing PowerPivot installation is [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)], the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Service Pack 2 (SP2) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="0a204-126">既存の PowerPivot のインストールがの場合は、 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] へのアップグレードに Service Pack 1 (SP1) が必要です [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="0a204-126">If the existing PowerPivot installation is [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Service Pack 1 (SP1) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="0a204-127">**SharePoint 2010:**</span><span class="sxs-lookup"><span data-stu-id="0a204-127">**SharePoint 2010:**</span></span>  
  
-   <span data-ttu-id="0a204-128">既存のインストールで SharePoint 2010 が実行されている場合は、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0a204-128">If the existing installation is running SharePoint 2010, install the SharePoint 2010 Service Pack 2 before upgrading to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="0a204-129">詳細については、「 [Microsoft SharePoint 2010 Service Pack 2](https://www.microsoft.com/download/details.aspx?id=39672)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-129">For more information, see [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span></span> <span data-ttu-id="0a204-130">バージョンを確認するには、PowerShell コマンド `(Get-SPfarm).BuildVersion.ToString()` を使用します。</span><span class="sxs-lookup"><span data-stu-id="0a204-130">Use the PowerShell command `(Get-SPfarm).BuildVersion.ToString()` to verify the version.</span></span> <span data-ttu-id="0a204-131">リリース日でビルド バージョンを参照するには、「 [SharePoint 2010 のビルド番号](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-131">To reference the build version to release date, see [SharePoint 2010 Build Numbers](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2013-farm"></a><a name="bkmk_uprgade_sharepoint2013"></a> <span data-ttu-id="0a204-132">既存の SharePoint 2013 ファームのアップグレード</span><span class="sxs-lookup"><span data-stu-id="0a204-132">Upgrade an Existing SharePoint 2013 Farm</span></span>  
 <span data-ttu-id="0a204-133">SharePoint 2013 に配置された [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] をアップグレードするには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-133">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2013, do the following:</span></span>  
  
 <span data-ttu-id="0a204-134">![PowerPivot for SharePoint 2013 アップグレード](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "PowerPivot for SharePoint 2013 アップグレード")</span><span class="sxs-lookup"><span data-stu-id="0a204-134">![powerpivot for sharepoint 2013 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "powerpivot for sharepoint 2013 upgrade")</span></span>  
  
1.  <span data-ttu-id="0a204-135">SharePoint モードで [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] を実行するバックエンド サーバー上で [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] セットアップを実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-135">Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup on backend server(s) that run [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode.</span></span> <span data-ttu-id="0a204-136">サーバーで [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]の複数のインスタンスがホストされている場合は、少なくとも **POWERPIVOT** インスタンスをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="0a204-136">If the server hosts multiple instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], upgrade at least the **POWERPIVOT** instance.</span></span> <span data-ttu-id="0a204-137">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] のアップグレードに関連するセットアップ ウィザードの手順の概要を次に示します。</span><span class="sxs-lookup"><span data-stu-id="0a204-137">The following list is a summary of setup wizard steps related to a [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] upgrade:</span></span>  
  
    1.  <span data-ttu-id="0a204-138">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] セットアップ ウィザードで、 **[インストール]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-138">In the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup Wizard, click **Installation**.</span></span>  
  
    2.  <span data-ttu-id="0a204-139">**[SQL Server ... からのアップグレード]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-139">Click **Upgrade from SQL Server.....**.</span></span>  
  
    3.  <span data-ttu-id="0a204-140">**[インスタンスの選択]** ページで、 **POWERPIVOT** インスタンス名を選択し、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-140">On the **Select Instance** page, select the **POWERPIVOT** instance name and then click **Next**.</span></span>  
  
    4.  <span data-ttu-id="0a204-141">詳細については、「[インストールウィザード &#40;セットアップを使用した SQL Server 2014 へのアップグレード](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)」を参照してください&#41;</span><span class="sxs-lookup"><span data-stu-id="0a204-141">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span></span>  
  
2.  <span data-ttu-id="0a204-142">サーバーを再起動します。</span><span class="sxs-lookup"><span data-stu-id="0a204-142">Restart the server.</span></span>  
  
3.  <span data-ttu-id="0a204-143">SharePoint 2013 ファーム内の各サーバーで [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint アドイン (**spPowerPivot.msi**) を実行し、データ プロバイダーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="0a204-143">Run the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint add-in (**spPowerPivot.msi**) on each server in the SharePoint 2013 farm to install the data providers.</span></span> <span data-ttu-id="0a204-144">データ プロバイダーもアップグレードする SQL Server セットアップ ウィザードを実行したサーバーは例外です。</span><span class="sxs-lookup"><span data-stu-id="0a204-144">The exception is servers where you ran the SQL Server setup wizard, which also upgrades data providers.</span></span> <span data-ttu-id="0a204-145">詳細については、「 [SharePoint 2013&#41;&#40;PowerPivot for SharePoint アドインをインストールまたはアンインストールする](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-145">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
4.  <span data-ttu-id="0a204-146">SharePoint アプリケーションサーバーの1つで**PowerPivot for SharePoint 2013 構成**ツールを実行し、アドインによってインストールされた更新済みのソリューションファイルを使用して sharepoint ファームを構成します。</span><span class="sxs-lookup"><span data-stu-id="0a204-146">**Run the PowerPivot for SharePoint 2013 Configuration** tool on one of the SharePoint application servers to configure the SharePoint farm with the updated solution files that the add-in installed.</span></span> <span data-ttu-id="0a204-147">この手順に SharePoint サーバーの全体管理を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="0a204-147">You cannot use Central SharePoint Administration for this step.</span></span> <span data-ttu-id="0a204-148">詳細については、「</span><span class="sxs-lookup"><span data-stu-id="0a204-148">For more information, see the following:</span></span>  
  
    1.  <span data-ttu-id="0a204-149">Windows のスタートページで「 **PowerPivot** 」と入力し、検索結果で [ **PowerPivot for SharePoint 2013 構成**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-149">From the Windows Start page, type **PowerPivot** and in the search results, click **PowerPivot for SharePoint 2013 Configuration**.</span></span> <span data-ttu-id="0a204-150">検索結果には 2 つのバージョンの構成ツールが表示される場合があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-150">Note the search may return both versions of the configuration tool.</span></span>  
  
         <span data-ttu-id="0a204-151">![2 つの PowerPivot 構成ツール](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "2 つの PowerPivot 構成ツール")</span><span class="sxs-lookup"><span data-stu-id="0a204-151">![two powerpivot configuratoin tools](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "two powerpivot configuratoin tools")</span></span>  
  
         <span data-ttu-id="0a204-152">または</span><span class="sxs-lookup"><span data-stu-id="0a204-152">Or</span></span>  
  
         <span data-ttu-id="0a204-153">[**スタート**] ボタンをクリックし、[**すべてのプログラム**] をポイントします。次に、[]、[構成ツール] の順にクリックし、[ [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)] **PowerPivot for SharePoint 2013 構成**] をクリックし**Configuration Tools**ます。</span><span class="sxs-lookup"><span data-stu-id="0a204-153">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot for SharePoint 2013 Configuration Too**.</span></span> <span data-ttu-id="0a204-154">このツールは、 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] がローカル サーバーにインストールされている場合にのみ表示されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-154">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="0a204-155">起動時、構成ツールにより、PowerPivot ファーム ソリューションと PowerPivot Web アプリケーション ソリューションのアップグレード状態がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="0a204-155">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="0a204-156">これらのソリューションの古いバージョンが検出されると、"**新しいバージョンの PowerPivot ソリューションファイルが検出されました。ファームをアップグレードするには、アップグレードオプションを選択してください**。 "</span><span class="sxs-lookup"><span data-stu-id="0a204-156">If older versions of these solutions are detected, you will see the message "**Newer versions of the PowerPivot solution files have been detected. Please select the upgrade option to upgrade your farm**."</span></span> <span data-ttu-id="0a204-157">**[OK]** をクリックし、システムの検証メッセージを閉じます。</span><span class="sxs-lookup"><span data-stu-id="0a204-157">Click **OK** to close the system validation message.</span></span>  
  
    3.  <span data-ttu-id="0a204-158">**[機能、サービス、アプリケーション、およびソリューションのアップグレード]** をクリックし、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-158">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="0a204-159">左側のペインにあるタスク一覧内のアクションを確認し、ツールで実行しないアクションを除外します。</span><span class="sxs-lookup"><span data-stu-id="0a204-159">Review the actions in the left pane task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="0a204-160">既定ではすべてのアクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="0a204-160">All actions are included by default.</span></span> <span data-ttu-id="0a204-161">アクションを削除するには、左側のタスク一覧でアクションを選択し、 **[パラメーター]** ページの **[この操作をタスク一覧に含めます]** チェック ボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="0a204-161">To remove an action, select it in the left task list, and then on the **Parameters** page, clear the **Include this action in the task list** checkbox.</span></span>  
  
    5.  <span data-ttu-id="0a204-162">必要に応じて、 **[スクリプト]** タブまたは **[出力]** タブの詳細情報を確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-162">Optionally, review detailed information in the **Script** or **Output** tab.</span></span>  
  
         <span data-ttu-id="0a204-163">[出力] タブには、ツールによって実行されるアクションの概要が示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-163">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="0a204-164">この情報は、 `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`にあるログ ファイルに保存されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-164">This information is saved in log files at `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span></span>  
  
         <span data-ttu-id="0a204-165">[スクリプト] タブには、PowerShell コマンドレットや、ツールが実行する PowerShell スクリプト ファイルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-165">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    6.  <span data-ttu-id="0a204-166">**[検証]** をクリックして、それぞれのアクションが有効かどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-166">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="0a204-167">**[検証]** が使用不可能な場合、システムにおいてすべてのアクションが有効であることを意味します。</span><span class="sxs-lookup"><span data-stu-id="0a204-167">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="0a204-168">**[検証]** が使用可能な場合は、入力値 (たとえば、Excel サービス アプリケーション名) を変更している可能性があるか、または特定のアクションを実行できないことがツールによって検出された可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-168">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="0a204-169">アクションを実行できない場合は、そのアクションを除外するか、またはアクションが無効であることを示すフラグが設定された原因となっている根本的な条件を解決してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-169">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="0a204-170">最初のアクションである **[ファーム ソリューションのアップグレード]** は、常に最初に処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-170">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="0a204-171">このアクションを実行すると、サーバーの構成に使用する PowerShell コマンドレットを登録できます。</span><span class="sxs-lookup"><span data-stu-id="0a204-171">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="0a204-172">このアクションを実行したときにエラーが発生する場合は、続行しないでください。</span><span class="sxs-lookup"><span data-stu-id="0a204-172">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="0a204-173">タスク一覧の残りのアクションを処理する前に、エラーとして返された情報に基づいて問題を診断し、解決してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-173">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    7.  <span data-ttu-id="0a204-174">**[実行]** をクリックして、このタスクで有効なすべてのアクションを実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-174">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="0a204-175">**[実行]** は、検証チェックに合格した後でのみ使用可能になります。</span><span class="sxs-lookup"><span data-stu-id="0a204-175">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="0a204-176">**[実行]** をクリックすると、アクションがバッチ モードで処理されることを示す次の警告が表示されます: "**ツールで有効としてフラグが立てられている構成設定はすべて SharePoint ファームに適用されます。続行しますか?** "</span><span class="sxs-lookup"><span data-stu-id="0a204-176">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "**All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm. Do you want to continue?**".</span></span>  
  
    8.  <span data-ttu-id="0a204-177">**[はい]** をクリックして続行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-177">Click **Yes** to continue.</span></span>  
  
    9. <span data-ttu-id="0a204-178">ファーム内のソリューションおよび機能のアップグレードが完了するまで、数分かかります。</span><span class="sxs-lookup"><span data-stu-id="0a204-178">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="0a204-179">この間、PowerPivot データに対する接続要求は**失敗**し、"**データを更新できません**" や "**要求された操作を実行しようとしてエラーが発生しました。もう一度お試し**ください。 "</span><span class="sxs-lookup"><span data-stu-id="0a204-179">During this time, connection requests for PowerPivot data **will fail** with errors similar to "**Unable to refresh data**" or "**An error has occurred trying to perform the requested action. Please try again**."</span></span> <span data-ttu-id="0a204-180">アップグレードが完了すると、サーバーは使用可能になり、これらのエラーは発生しなくなります。</span><span class="sxs-lookup"><span data-stu-id="0a204-180">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
     <span data-ttu-id="0a204-181">詳細については、「</span><span class="sxs-lookup"><span data-stu-id="0a204-181">For more information, see the following:</span></span>  
  
    -   [<span data-ttu-id="0a204-182">PowerPivot Configuration Tools</span><span class="sxs-lookup"><span data-stu-id="0a204-182">PowerPivot Configuration Tools</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-tools)  
  
    -   [<span data-ttu-id="0a204-183">PowerPivot for SharePoint 2013 &#40;PowerPivot 構成ツールの構成または修復&#41;</span><span class="sxs-lookup"><span data-stu-id="0a204-183">Configure or Repair PowerPivot for SharePoint 2013 &#40;PowerPivot Configuration Tool&#41;</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-or-repair-power-pivot-for-sharepoint-2013)  
  
    -   [<span data-ttu-id="0a204-184">Windows PowerShell を使用した PowerPivot の構成</span><span class="sxs-lookup"><span data-stu-id="0a204-184">PowerPivot Configuration using Windows PowerShell</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-using-windows-powershell)  
  
    -   [<span data-ttu-id="0a204-185">PowerShell リファレンス (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="0a204-185">PowerShell Reference for PowerPivot for SharePoint</span></span>](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint)  
  
5.  <span data-ttu-id="0a204-186">アップグレード後の手順を実行し、ファーム内の PowerPivot サーバーのバージョンを確認して、アップグレードが成功したことを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-186">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="0a204-187">詳細については、このトピックの「 [アップグレード後の検証タスク](#verify) 」以降のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-187">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2010-farm"></a><a name="bkmk_uprgade_sharepoint2010"></a> <span data-ttu-id="0a204-188">既存の SharePoint 2010 ファームのアップグレード</span><span class="sxs-lookup"><span data-stu-id="0a204-188">Upgrade an Existing SharePoint 2010 Farm</span></span>  
 <span data-ttu-id="0a204-189">SharePoint 2010 に配置された [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] をアップグレードするには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-189">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2010, do the following:</span></span>  
  
 <span data-ttu-id="0a204-190">![PowerPivot for SharePoint 2010 アップグレード](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "PowerPivot for SharePoint 2010 アップグレード")</span><span class="sxs-lookup"><span data-stu-id="0a204-190">![powerpivot for sharepoint 2010 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "powerpivot for sharepoint 2010 upgrade")</span></span>  
  
1.  <span data-ttu-id="0a204-191">[Microsoft SharePoint 2010 Service Pack 2](https://www.microsoft.com/download/details.aspx?id=39672) をダウンロードして、ファーム内のすべてのサーバーに適用します。</span><span class="sxs-lookup"><span data-stu-id="0a204-191">Download [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) and apply it on all servers in the farm.</span></span> <span data-ttu-id="0a204-192">SharePoint SP2 のインストールが成功したことを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-192">Verify that SharePoint SP2 installation succeeded.</span></span> <span data-ttu-id="0a204-193">[サーバーの全体管理] の [アップグレードと移行] ページで、[製品および更新プログラムのインストール状態の確認] ページを開いて SP2 に関連するステータス メッセージを参照します。</span><span class="sxs-lookup"><span data-stu-id="0a204-193">In Central Administration, on the Upgrade and Migration page, open the Check product and patch installation status page to view status messages related to SP2.</span></span>  
  
2.  <span data-ttu-id="0a204-194">SharePoint 2010 Administration Windows Service が実行されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-194">Verify that the SharePoint 2010 Administration Windows service is running.</span></span>  
  
    ```powershell
    Get-Service | Where {$_.displayname -like "*SharePoint*"}  
    ```  
  
3.  <span data-ttu-id="0a204-195">Sharepoint services **SQL Server Analysis Services**を確認 SQL Server**し、** Sharepoint サーバーの全体管理で**PowerPivot System サービス**が開始されていることを確認するか、次の PowerShell コマンドを使用します。</span><span class="sxs-lookup"><span data-stu-id="0a204-195">Verify the **SharePoint** services **SQL Server Analysis Services** and **SQL Server PowerPivot System Service** are started in SharePoint Central Administration or use the following PowerShell command:.</span></span>  
  
    ```powershell
    Get-SPServiceInstance | where {$_.typename -like "*sql*"}  
    ```  
  
4.  <span data-ttu-id="0a204-196">**Windows**サービス**SQL Server Analysis Services (PowerPivot)** が実行されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-196">Verify the **Windows** service **SQL Server Analysis Services (PowerPivot)** is running.</span></span>  
  
    ```powershell
    Get-Service | where {$_.displayname -like "*powerpivot*"}  
    ```  
  
5.  <span data-ttu-id="0a204-197">**実行 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]** Powerpivot インスタンスをアップグレードするために、 **SQL Server Analysis Services (powerpivot)** Windows サービスを実行する最初の SharePoint アプリケーションサーバーでセットアップします。</span><span class="sxs-lookup"><span data-stu-id="0a204-197">**Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup** on the first SharePoint application server that runs the **SQL Server Analysis Services (PowerPivot)** Windows service to upgrade the POWERPIVOT instance.</span></span> <span data-ttu-id="0a204-198">SQL Server セットアップ ウィザードの [インストール] ページで、アップグレード オプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="0a204-198">On the Installation page of the SQL Server Setup Wizard, choose the upgrade option.</span></span> <span data-ttu-id="0a204-199">詳細については、「[インストールウィザード &#40;セットアップ&#41;を使用した SQL Server 2014 へのアップグレード](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-199">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
6.  <span data-ttu-id="0a204-200">構成ツールを実行する前に**サーバーを再起動します** 。</span><span class="sxs-lookup"><span data-stu-id="0a204-200">**Restart the server** before running the configuration tool.</span></span> <span data-ttu-id="0a204-201">これにより、SQLServer セットアップによってインストールされた更新プログラムや必須コンポーネントがシステムで完全に構成されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-201">This step ensures that any updates or prerequisites installed by SQL Server Setup are fully configured on the system.</span></span>  
  
7.  <span data-ttu-id="0a204-202">SQL Server Analysis Services (PowerPivot) サービスを実行する最初の SharePoint アプリケーションサーバーで**PowerPivot 構成ツールを実行**し、sharepoint のソリューションと Web サービスをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="0a204-202">**Run the PowerPivot Configuration Tool** on the first SharePoint application server that runs SQL Server Analysis Services (PowerPivot) service to upgrade the solutions and Web services in SharePoint.</span></span> <span data-ttu-id="0a204-203">この手順にサーバーの全体管理を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="0a204-203">You cannot use Central Administration for this step.</span></span>  
  
    1.  <span data-ttu-id="0a204-204">[**スタート**] ボタンをクリックし、[**すべてのプログラム**] をポイントします。次に、[]、[構成ツール]、[ [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)] **PowerPivot 構成ツール**] の順にクリックします。 **Configuration Tools**</span><span class="sxs-lookup"><span data-stu-id="0a204-204">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot Configuration Tool**.</span></span> <span data-ttu-id="0a204-205">このツールは、 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] がローカル サーバーにインストールされている場合にのみ表示されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-205">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="0a204-206">起動時、構成ツールにより、PowerPivot ファーム ソリューションと PowerPivot Web アプリケーション ソリューションのアップグレード状態がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="0a204-206">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="0a204-207">これらのソリューションの古いバージョンが検出されると、"新しいバージョンの PowerPivot ソリューションファイルが検出されました。</span><span class="sxs-lookup"><span data-stu-id="0a204-207">If older versions of these solutions are detected, you will see the message "Newer versions of the PowerPivot solution files have been detected.</span></span> <span data-ttu-id="0a204-208">ファームをアップグレードするために、アップグレード オプションを選択してください。" と表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-208">Please select the upgrade option to upgrade your farm."</span></span> <span data-ttu-id="0a204-209">**[OK]** をクリックして、このメッセージを閉じます。</span><span class="sxs-lookup"><span data-stu-id="0a204-209">Click **OK** to close the message.</span></span>  
  
    3.  <span data-ttu-id="0a204-210">**[機能、サービス、アプリケーション、およびソリューションのアップグレード]** をクリックし、 **[OK]** をクリックして続行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-210">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK** to continue.</span></span>  
  
    4.  <span data-ttu-id="0a204-211">次の警告が表示されます。 "PowerPivot 管理ダッシュボードのブックを最新バージョンにアップグレードしようとしています。</span><span class="sxs-lookup"><span data-stu-id="0a204-211">The following warning appears: "Workbooks in the PowerPivot Management Dashboard are about to be upgraded to the latest version.</span></span> <span data-ttu-id="0a204-212">既存のブックに加えたカスタマイズは失われます。</span><span class="sxs-lookup"><span data-stu-id="0a204-212">Any customizations you made to the existing workbooks will be lost.</span></span> <span data-ttu-id="0a204-213">続行しますか?"</span><span class="sxs-lookup"><span data-stu-id="0a204-213">Do you want to continue?"</span></span>  
  
         <span data-ttu-id="0a204-214">これは、データ更新操作を報告する PowerPivot 管理ダッシュボードのブックに関する警告です。</span><span class="sxs-lookup"><span data-stu-id="0a204-214">This warning refers to workbooks in the PowerPivot Management Dashboard that report on data refresh activity.</span></span> <span data-ttu-id="0a204-215">これらのブックをカスタマイズしている場合、これらのブックに加えた変更は、既存のファイルを新しいバージョンで置き換えるときに失われます。</span><span class="sxs-lookup"><span data-stu-id="0a204-215">If you customized these workbooks, any changes you made to those workbooks will be lost when existing files are replaced with newer versions.</span></span>  
  
         <span data-ttu-id="0a204-216">ブックを新しいバージョンで上書きする場合は、 **[はい]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-216">Click **Yes** to overwrite the workbooks with newer versions.</span></span> <span data-ttu-id="0a204-217">それ以外の場合は、 **[いいえ]** をクリックしてホーム ページに戻ります。</span><span class="sxs-lookup"><span data-stu-id="0a204-217">Otherwise, click **No** to return to the home page.</span></span> <span data-ttu-id="0a204-218">ブックを別の場所に保存してコピーを作成します。続行する準備が整ったら、この手順に戻ります。</span><span class="sxs-lookup"><span data-stu-id="0a204-218">Save the workbooks to a different location so that you have a copy, and then return to this step when you are ready to continue.</span></span>  
  
         <span data-ttu-id="0a204-219">ダッシュボードで使用されるブックのカスタマイズの詳細については、「 [PowerPivot 管理ダッシュボードのカスタマイズ](https://go.microsoft.com/fwlink/?linkID=229639)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-219">For more information about customizing workbooks used in the dashboard, see [Customizing the PowerPivot Management Dashboard](https://go.microsoft.com/fwlink/?linkID=229639).</span></span>  
  
    5.  <span data-ttu-id="0a204-220">タスク一覧内のアクションを確認し、ツールで実行しないアクションを除外します。</span><span class="sxs-lookup"><span data-stu-id="0a204-220">Review the actions in the task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="0a204-221">既定ではすべてのアクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="0a204-221">All actions are included by default.</span></span> <span data-ttu-id="0a204-222">アクションを削除するには、タスク一覧でアクションを選択し、[パラメーター] ページの **[この操作をタスク一覧に含めます]** チェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="0a204-222">To remove an action, select it in the task list, and then clear the **Include this action in the task list** checkbox on the Parameters page.</span></span>  
  
    6.  <span data-ttu-id="0a204-223">必要に応じて、 **[出力]** タブまたは **[スクリプト]** タブの詳細情報を確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-223">Optionally, review detailed information in the **Output** tab or **Script** tab.</span></span>  
  
         <span data-ttu-id="0a204-224">[出力] タブには、ツールによって実行されるアクションの概要が示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-224">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="0a204-225">この情報は、 `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`にあるログ ファイルに保存されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-225">This information is saved in log files at `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span></span>  
  
         <span data-ttu-id="0a204-226">[スクリプト] タブには、PowerShell コマンドレットや、ツールが実行する PowerShell スクリプト ファイルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-226">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    7.  <span data-ttu-id="0a204-227">**[検証]** をクリックして、それぞれのアクションが有効かどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-227">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="0a204-228">**[検証]** が使用不可能な場合、システムにおいてすべてのアクションが有効であることを意味します。</span><span class="sxs-lookup"><span data-stu-id="0a204-228">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="0a204-229">**[検証]** が使用可能な場合は、入力値 (たとえば、Excel サービス アプリケーション名) を変更している可能性があるか、または特定のアクションを実行できないことがツールによって検出された可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-229">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="0a204-230">アクションを実行できない場合は、そのアクションを除外するか、またはアクションが無効であることを示すフラグが設定された原因となっている根本的な条件を解決してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-230">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="0a204-231">最初のアクションである **[ファーム ソリューションのアップグレード]** は、常に最初に処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-231">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="0a204-232">このアクションを実行すると、サーバーの構成に使用する PowerShell コマンドレットを登録できます。</span><span class="sxs-lookup"><span data-stu-id="0a204-232">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="0a204-233">このアクションを実行したときにエラーが発生する場合は、続行しないでください。</span><span class="sxs-lookup"><span data-stu-id="0a204-233">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="0a204-234">タスク一覧の残りのアクションを処理する前に、エラーとして返された情報に基づいて問題を診断し、解決してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-234">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    8.  <span data-ttu-id="0a204-235">**[実行]** をクリックして、このタスクで有効なすべてのアクションを実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-235">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="0a204-236">**[実行]** は、検証チェックに合格した後でのみ使用可能になります。</span><span class="sxs-lookup"><span data-stu-id="0a204-236">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="0a204-237">**[実行]** をクリックすると、アクションがバッチ モードで処理されることを示す次の警告が表示されます: "ツールで有効としてフラグが立てられている構成設定はすべて SharePoint ファームに適用されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-237">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm.</span></span> <span data-ttu-id="0a204-238">続行しますか?"</span><span class="sxs-lookup"><span data-stu-id="0a204-238">Do you want to continue?"</span></span>  
  
    9. <span data-ttu-id="0a204-239">**[はい]** をクリックして続行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-239">Click **Yes** to continue.</span></span>  
  
    10. <span data-ttu-id="0a204-240">ファーム内のソリューションおよび機能のアップグレードが完了するまで、数分かかります。</span><span class="sxs-lookup"><span data-stu-id="0a204-240">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="0a204-241">この間、PowerPivot データに対する接続要求は、"データを更新できません" や "要求されたアクションを実行しようとしたときにエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="0a204-241">During this time, connection requests for PowerPivot data will fail with errors like "Unable to refresh data" or "An error has occurred trying to perform the requested action.</span></span> <span data-ttu-id="0a204-242">再試行してください。"</span><span class="sxs-lookup"><span data-stu-id="0a204-242">Please try again."</span></span> <span data-ttu-id="0a204-243">アップグレードが完了すると、サーバーは使用可能になり、これらのエラーは発生しなくなります。</span><span class="sxs-lookup"><span data-stu-id="0a204-243">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
8.  <span data-ttu-id="0a204-244">ファームの各 SQL Server Analysis Services (PowerPivot) サービスに対してこの手順を**繰り返し**ます。 1) SQL Server セットアップ 2) を実行して、powerpivot 構成ツールを実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-244">**Repeat the process** for each SQL Server Analysis Services (PowerPivot) service in the farm: 1) Run SQL Server setup 2) Run the PowerPivot Configuration tool.</span></span>  
  
9. <span data-ttu-id="0a204-245">アップグレード後の手順を実行し、ファーム内の PowerPivot サーバーのバージョンを確認して、アップグレードが成功したことを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-245">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="0a204-246">詳細については、このトピックの「 [アップグレード後の検証タスク](#verify) 」以降のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-246">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
10. <span data-ttu-id="0a204-247">**エラーのトラブルシューティング**</span><span class="sxs-lookup"><span data-stu-id="0a204-247">**Troubleshooting errors**</span></span>  
  
     <span data-ttu-id="0a204-248">各アクションのパラメーター ペインには、エラー情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-248">You can view error information in the Parameters pane for each action.</span></span>  
  
     <span data-ttu-id="0a204-249">ソリューションの配置または取り消しに関連する問題に対しては、SharePoint 2010 Administrator サービスが開始されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-249">For problems related to solution deployment or retraction, verify the SharePoint 2010 Administrator service is started.</span></span> <span data-ttu-id="0a204-250">このサービスは、ファームの構成の変更をトリガーするタイマー ジョブを実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-250">This service runs the timer jobs that trigger configuration changes in a farm.</span></span> <span data-ttu-id="0a204-251">サービスが実行されていない場合、ソリューションの配置または取り消しは失敗します。</span><span class="sxs-lookup"><span data-stu-id="0a204-251">If the service is not running, solution deployment or retraction will fail.</span></span> <span data-ttu-id="0a204-252">永続的なエラーは、既存の配置または取り消しジョブが既にキューに格納されていて、構成ツールの他のアクションがブロックされていることを示します。</span><span class="sxs-lookup"><span data-stu-id="0a204-252">Persistent errors indicate that an existing deployment or retraction job is already in the queue and blocking further action from the configuration tool.</span></span>  
  
    1.  <span data-ttu-id="0a204-253">SharePoint 2010 管理シェルを管理者として起動し、次のコマンドを実行してキュー内のジョブを表示します。</span><span class="sxs-lookup"><span data-stu-id="0a204-253">Start the SharePoint 2010 Management Shell as an administrator and then run the following command to view jobs in the queue:</span></span>  
  
        ```cmd
        stsadm -o enumdeployments  
        ```  
  
    2.  <span data-ttu-id="0a204-254">既存の配置について、 **[種類]** が "取り消し" または "展開" であり、 **[ファイル]** が powerpivotwebapp.wsp または powerpivotfarm.wsp であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-254">Review existing deployments for the following information: **Type** is Retraction or Deployment, **File** is powerpivotwebapp.wsp or powerpivotfarm.wsp.</span></span>  
  
    3.  <span data-ttu-id="0a204-255">PowerPivot ソリューションに関連する配置または取り消しアクションの場合は、 **JobId**の GUID 値をコピーし、次のコマンドに貼り付けます (シェルの [編集] メニューの [マーク]、[コピー]、[貼り付け] コマンドを使用して guid をコピーします)。</span><span class="sxs-lookup"><span data-stu-id="0a204-255">For deployments or retractions related to PowerPivot solutions, copy the GUID value for **JobId** and then paste it into the following command (use the Mark, Copy, and Paste commands on the Shell's Edit menu to copy the GUID):</span></span>  
  
        ```cmd
        stsadm -o canceldeployment -id "<GUID>"  
        ```  
  
    4.  <span data-ttu-id="0a204-256">構成ツールで **[検証]** に続けて **[実行]** をクリックして、タスクを再試行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-256">Retry the task in the configuration tool by clicking **Validate** followed by **Run**.</span></span>  
  
     <span data-ttu-id="0a204-257">他のエラーについては、ULS ログを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-257">For all other errors, check the ULS logs.</span></span> <span data-ttu-id="0a204-258">詳細については、「 [SharePoint ログファイルと診断ログの構成と表示 &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-258">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span></span>  
  

  
##  <a name="workbooks"></a><a name="bkmk_workbooks"></a> <span data-ttu-id="0a204-259">ブック</span><span class="sxs-lookup"><span data-stu-id="0a204-259">Workbooks</span></span>  
 <span data-ttu-id="0a204-260">サーバーをアップグレードしても、サーバー上で実行される PowerPivot ブックがアップグレードされない場合がありますが、前のバージョンの PowerPivot for Excel で作成された古いブックは、そのリリースで利用できる機能を使用して以前と同様に機能し続けます。</span><span class="sxs-lookup"><span data-stu-id="0a204-260">Upgrading a server does not necessarily upgrade the PowerPivot workbooks that run on it, but older workbooks created in the previous version of PowerPivot for Excel will continue to work as before, using the features available in that release.</span></span> <span data-ttu-id="0a204-261">ブックが機能し続けるのは、以前のインストールに含まれていた Analysis Services OLE DB プロバイダーのバージョンがアップグレードしたサーバーに残っているためです。</span><span class="sxs-lookup"><span data-stu-id="0a204-261">Workbooks remain functional because an upgraded server has the version of the Analysis Services OLE DB provider that was part of the previous installation.</span></span>  
  
  
  
##  <a name="data-refresh"></a><a name="bkmk_datarefresh"></a> <span data-ttu-id="0a204-262">データ更新</span><span class="sxs-lookup"><span data-stu-id="0a204-262">Data Refresh</span></span>  
 <span data-ttu-id="0a204-263">アップグレードはデータ更新操作に影響を及ぼします。</span><span class="sxs-lookup"><span data-stu-id="0a204-263">Upgrade will impact data refresh operations.</span></span> <span data-ttu-id="0a204-264">サーバーでのスケジュールされたデータ更新は、そのサーバー バージョンに対応するブックに対してのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="0a204-264">Scheduled data refresh on the server is available only for workbooks that match the server version.</span></span> <span data-ttu-id="0a204-265">以前のバージョンのブックをホストしている場合、それらのブックに対してデータ更新が機能しなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-265">If you are hosting workbooks from the previous version, data refresh might no longer work for those workbooks.</span></span> <span data-ttu-id="0a204-266">データ更新を再び有効にするには、ブックをアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-266">To re-enable data refresh, you must upgrade the workbooks.</span></span> <span data-ttu-id="0a204-267">PowerPivot for Excel で各ブックを手動でアップグレードするか、SharePoint 2010 でデータ更新機能の自動アップグレードを有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="0a204-267">You can upgrade each workbook manually in PowerPivot for Excel, or enable the auto-upgrade for data refresh feature in SharePoint 2010.</span></span> <span data-ttu-id="0a204-268">自動アップグレードでは、データ更新を実行する前にブックが最新のバージョンにアップグレードされます。これにより、データ更新操作をスケジュールどおり行うことができます。</span><span class="sxs-lookup"><span data-stu-id="0a204-268">Auto-upgrade will upgrade a workbook to the current version prior to running data refresh, allowing data refresh operations to remain on schedule.</span></span>  
  

  
##  <a name="verify-the-versions-of-powerpivot-components-and-services"></a><a name="bkmk_verify_versions"></a><span data-ttu-id="0a204-269">PowerPivot のコンポーネントとサービスのバージョンを確認する</span><span class="sxs-lookup"><span data-stu-id="0a204-269">Verify the Versions of PowerPivot Components and Services</span></span>  
 <span data-ttu-id="0a204-270">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] System サービスと Analysis Services のインスタンスはすべて、同じバージョンである必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-270">All instances of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] System Service and Analysis Services must be the same version.</span></span> <span data-ttu-id="0a204-271">すべてのサーバー コンポーネントが同じバージョンであることを確認するには、次のコンポーネントのバージョン情報を確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-271">To verify that all server components are at the same version, check version information for the following:</span></span>  
  
### <a name="verify-the-version-of-powerpivot-solutions-and-the-powerpivot-system-service"></a><span data-ttu-id="0a204-272">PowerPivot ソリューションおよび PowerPivot System サービスのバージョン確認</span><span class="sxs-lookup"><span data-stu-id="0a204-272">Verify the version of PowerPivot Solutions and the PowerPivot System Service</span></span>  
 <span data-ttu-id="0a204-273">次の PowerShell コマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="0a204-273">Run the following PowerShell command:</span></span>  
  
```powershell
Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="0a204-274">**CurrentSolutionVersion**を確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-274">Verify the **CurrentSolutionVersion**.</span></span> [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="0a204-275">のバージョンは 12.0. \<major build> です。\<minor build></span><span class="sxs-lookup"><span data-stu-id="0a204-275">is version 12.0.\<major build>.\<minor build></span></span>  
  
### <a name="verify-the-version-of-the-analysis-services-windows-service"></a><span data-ttu-id="0a204-276">Analysis Services Windows サービスのバージョン確認</span><span class="sxs-lookup"><span data-stu-id="0a204-276">Verify the version of the Analysis Services Windows Service</span></span>  
 <span data-ttu-id="0a204-277">SharePoint 2010 ファーム内の [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] サーバーの一部のみをアップグレードした場合は、アップグレードされていないサーバー上の [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスがファームで想定されるバージョンより古くなります。</span><span class="sxs-lookup"><span data-stu-id="0a204-277">If you upgraded only some of your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] servers in a SharePoint 2010 farm, the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] on un-upgraded servers will be older than the version expected in the farm.</span></span> <span data-ttu-id="0a204-278">すべてのサーバーを同じバージョンにアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-278">You will need to upgrade all of your servers to the same version in order for them to be usable.</span></span> <span data-ttu-id="0a204-279">次のいずれかの方法を使用して、各コンピューターの SQL Server Analysis Services (PowerPivot) Windows サービスのバージョンを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-279">Use one of the following methods to verify the version of the SQL Server Analysis Services (PowerPivot) Windows service on each computer.</span></span>  
  
 <span data-ttu-id="0a204-280">**エクスプローラーを使用した場合**:</span><span class="sxs-lookup"><span data-stu-id="0a204-280">**Windows File Explorer**:</span></span>  
  
1.  <span data-ttu-id="0a204-281">**インスタンスの** Bin [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] フォルダーに移動します。</span><span class="sxs-lookup"><span data-stu-id="0a204-281">Navigate to the **Bin** folder for the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] instance.</span></span> <span data-ttu-id="0a204-282">たとえば、「 `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin` 」のように指定します。</span><span class="sxs-lookup"><span data-stu-id="0a204-282">For example `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span></span>  
  
2.  <span data-ttu-id="0a204-283">`msmdsrv.exe`を右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-283">Right-click `msmdsrv.exe`, and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="0a204-284">**[詳細]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-284">Click **Details**.</span></span>  
  
4.  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="0a204-285">ファイルのバージョンは12.00 である必要があります.. \<major build> \<minor build> .</span><span class="sxs-lookup"><span data-stu-id="0a204-285">file version should be 12.00.\<major build>.\<minor build>.</span></span>  
  
5.  <span data-ttu-id="0a204-286">この数値が PowerPivot ソリューションおよびシステム サービスのバージョンと同じであることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-286">Verify that this number is identical to the PowerPivot solution and system service version.</span></span>  
  
 <span data-ttu-id="0a204-287">**サービスの開始情報を使用した場合:**</span><span class="sxs-lookup"><span data-stu-id="0a204-287">**Service start information:**</span></span>  
  
 <span data-ttu-id="0a204-288">PowerPivot サービスが開始されると、Windows イベント ログにバージョン情報が書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="0a204-288">When the PowerPivot service starts, it writes version information into the Windows event log.</span></span>  
  
1.  <span data-ttu-id="0a204-289">Windows の `eventvwr`</span><span class="sxs-lookup"><span data-stu-id="0a204-289">Run Windows `eventvwr`</span></span>  
  
2.  <span data-ttu-id="0a204-290">ソースの `MSOLAP$POWERPIVOT`のフィルターを作成します。</span><span class="sxs-lookup"><span data-stu-id="0a204-290">Create a filter for source `MSOLAP$POWERPIVOT`.</span></span>  
  
3.  <span data-ttu-id="0a204-291">次のような情報レベルのイベントを探します。</span><span class="sxs-lookup"><span data-stu-id="0a204-291">Look for an information level event similar to the following</span></span>  
  
     <span data-ttu-id="0a204-292">サービスが開始されました。</span><span class="sxs-lookup"><span data-stu-id="0a204-292">Service started.</span></span> <span data-ttu-id="0a204-293">Microsoft SQL Server Analysis Services 64 ビット評価 (x64) RTM **12.0.2000.8**。</span><span class="sxs-lookup"><span data-stu-id="0a204-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span></span>  
  
 <span data-ttu-id="0a204-294">**PowerShell を使用したファイル バージョンの確認**</span><span class="sxs-lookup"><span data-stu-id="0a204-294">**Use PowerShell to verify file version.**</span></span>  
  
 <span data-ttu-id="0a204-295">PowerShell を使用して製品バージョンを確認できます。</span><span class="sxs-lookup"><span data-stu-id="0a204-295">You can use PowerShell to verify the product version.</span></span> <span data-ttu-id="0a204-296">バージョンの確認をスクリプト化または自動化する場合は、PowerShell を使用すると便利です。</span><span class="sxs-lookup"><span data-stu-id="0a204-296">PowerShell is a good option if you want to script or automate version verification.</span></span>  
  
```powershell
(Get-ChildItem "C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe").VersionInfo  
```  
  
 <span data-ttu-id="0a204-297">上記の PowerShell コマンドによって、次のような情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-297">The above PowerShell command returns information similar to the following:</span></span>  
  
 <span data-ttu-id="0a204-298">ProductVersion   FileVersion           FileName</span><span class="sxs-lookup"><span data-stu-id="0a204-298">ProductVersion   FileVersion           FileName</span></span>  
  
 <span data-ttu-id="0a204-299">**12.0.2000.8** 2014.0120.200 C:\PROGRAM SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span><span class="sxs-lookup"><span data-stu-id="0a204-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span></span>  
  
### <a name="verify-the-msolap-data-provider-version-on-sharepoint"></a><span data-ttu-id="0a204-300">SharePoint での MSOLAP データ プロバイダーのバージョン確認</span><span class="sxs-lookup"><span data-stu-id="0a204-300">Verify the MSOLAP Data Provider Version on SharePoint</span></span>  
 <span data-ttu-id="0a204-301">Excel Services によって信頼されている Analysis Services OLE DB プロバイダーのバージョンを確認するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="0a204-301">Use the following instructions to check which versions of the Analysis Services OLE DB providers are trusted by Excel Services.</span></span> <span data-ttu-id="0a204-302">Excel Services の信頼できるデータ プロバイダーの設定を確認するには、ファームまたはサービス アプリケーションの管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-302">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="0a204-303">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-303">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="0a204-304">Excel Services サービス アプリケーションの名前 (たとえば **ExcelServiceApp1**) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-304">Click the name of the Excel Services service application, for example **ExcelServiceApp1**.</span></span>  
  
3.  <span data-ttu-id="0a204-305">**[信頼できるデータ プロバイダー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-305">Click **Trusted Data Providers**.</span></span> <span data-ttu-id="0a204-306">MSOLAP.5 (Microsoft OLE DB プロバイダー (OLAP Services 11.0 用)) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-306">You should see MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0).</span></span> <span data-ttu-id="0a204-307">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] をアップグレードした場合、以前のバージョンの MSOLAP.4 も表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-307">If you upgraded your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, you will also see MSOLAP.4 from the previous version.</span></span>  
  
4.  <span data-ttu-id="0a204-308">詳細については、「 [Excel Services で信頼できるデータ プロバイダーとして MSOLAP.5 を追加](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-308">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span></span>  
  
 <span data-ttu-id="0a204-309">MSOLAP.4 には、"Microsoft OLE DB プロバイダー (OLAP Services 10.0 用)" という説明が表示されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-309">MSOLAP.4 is described as the Microsoft OLE DB Provider for OLAP Services 10.0.</span></span> <span data-ttu-id="0a204-310">このバージョンは、Excel Services と共にインストールされる [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] に付属する既定のバージョンか、 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンである可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-310">This version might be the default version from [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] that is installed with Excel Services, or it might be the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version.</span></span> <span data-ttu-id="0a204-311">SharePoint によってインストールされる既定のバージョンでは、PowerPivot データ アクセスはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="0a204-311">The default version that SharePoint installs does not support PowerPivot data access.</span></span> <span data-ttu-id="0a204-312">SharePoint で PowerPivot ブックに接続するには、[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 以降のバージョンが必要です。</span><span class="sxs-lookup"><span data-stu-id="0a204-312">You must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version or later to connect to PowerPivot workbooks on SharePoint.</span></span> <span data-ttu-id="0a204-313">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] バージョンがインストールされていることを確認するには、前のセクションの手順に従って、ファイルのプロパティでバージョンを確認してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-313">To verify you have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version, use the instructions in the previous section that explain how to verify the version by viewing file properties.</span></span>  
  
### <a name="verify-the-adomdnet-data-provider-version"></a><span data-ttu-id="0a204-314">ADOMD.NET データ プロバイダーのバージョン確認</span><span class="sxs-lookup"><span data-stu-id="0a204-314">Verify the ADOMD.NET Data Provider Version</span></span>  
 <span data-ttu-id="0a204-315">インストールされている ADOMD.NET のバージョンを確認するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="0a204-315">Use the following instructions to check which version of ADOMD.NET is installed.</span></span> <span data-ttu-id="0a204-316">Excel Services の信頼できるデータ プロバイダーの設定を確認するには、ファームまたはサービス アプリケーションの管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-316">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="0a204-317">SharePoint アプリケーション サーバーで、 `c:\Windows\Assembly`を参照します。</span><span class="sxs-lookup"><span data-stu-id="0a204-317">On your SharePoint application server, browse to `c:\Windows\Assembly`.</span></span>  
  
2.  <span data-ttu-id="0a204-318">アセンブリ名で並べ替えて、 **Microsoft.Analysis Services.Adomd.Client**を見つけます。</span><span class="sxs-lookup"><span data-stu-id="0a204-318">Sort by assembly name and find the **Microsoft.Analysis Services.Adomd.Client**.</span></span>  
  
3.  <span data-ttu-id="0a204-319">バージョン12.0 があることを確認 \<build number> します。</span><span class="sxs-lookup"><span data-stu-id="0a204-319">Verify you have version 12.0.\<build number>.</span></span>  
  

##  <a name="upgrading-multiple-powerpivot-for-sharepoint-servers-in-a-sharepoint-farm"></a><a name="geminifarm"></a><span data-ttu-id="0a204-320">SharePoint ファーム内の複数の PowerPivot for SharePoint サーバーのアップグレード</span><span class="sxs-lookup"><span data-stu-id="0a204-320">Upgrading Multiple PowerPivot for SharePoint Servers in a SharePoint Farm</span></span>  
 <span data-ttu-id="0a204-321">複数の [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] サーバーを含むマルチサーバー トポロジでは、すべてのサーバー インスタンスとコンポーネントで同じバージョンを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-321">In a multi-server topology that includes more than one [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] server, all server instances and components must be the same version.</span></span> <span data-ttu-id="0a204-322">最新バージョンのソフトウェアを実行するサーバーによって、ファーム内のすべてのサーバーのレベルが設定されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-322">The server that runs the highest version of the software sets the level for all servers in the farm.</span></span> <span data-ttu-id="0a204-323">一部のサーバーのみをアップグレードすると、古いバージョンのソフトウェアを実行するサーバーは、同様にアップグレードを行うまで使用できなくなります。</span><span class="sxs-lookup"><span data-stu-id="0a204-323">If you upgrade just some of the servers, the ones that are running older versions of the software will become unavailable until they are also upgraded.</span></span>  
  
 <span data-ttu-id="0a204-324">最初のサーバーをアップグレードした後は、まだアップグレードされていない他のサーバーが **使用できなくなります**。</span><span class="sxs-lookup"><span data-stu-id="0a204-324">After you upgrade the first server, additional servers that are not yet upgraded **will become unavailable**.</span></span> <span data-ttu-id="0a204-325">すべてのサーバーが同じレベルで実行されるようになると、再び使用可能になります。</span><span class="sxs-lookup"><span data-stu-id="0a204-325">Availability is restored after all servers run at the same level.</span></span>  
  
 <span data-ttu-id="0a204-326">SQL Server セットアップによって PowerPivot ソリューション ファイルが物理コンピューター上の適切な位置でアップグレードされますが、ファームで使用中のソリューションをアップグレードするには、このトピックの前のセクションで説明した PowerPivot 構成ツールを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-326">SQL Server Setup upgrades the PowerPivot solution files in place on the physical computer, but to upgrade the solutions in use by the farm, you must use the PowerPivot Configuration Tool described in a previous section of this topic..</span></span>  

##  <a name="applying-a-qfe-to-a-powerpivot-instance-in-the-farm"></a><a name="qfe"></a><span data-ttu-id="0a204-327">ファーム内の PowerPivot インスタンスに QFE を適用する</span><span class="sxs-lookup"><span data-stu-id="0a204-327">Applying a QFE to a PowerPivot instance in the farm</span></span>  
 <span data-ttu-id="0a204-328">PowerPivot for SharePoint サーバーに修正プログラムを適用すると、既存のプログラム ファイルが、特定の問題の修正を含む新しいバージョンに更新されます。</span><span class="sxs-lookup"><span data-stu-id="0a204-328">Patching a PowerPivot for SharePoint server updates existing program files with a newer version that includes a fix for a specific problem.</span></span> <span data-ttu-id="0a204-329">QFE をマルチサーバー トポロジに適用するときに、最初に使用すべきプライマリ サーバーはありません。</span><span class="sxs-lookup"><span data-stu-id="0a204-329">When applying a QFE to a multi-server topology, there is no primary server that you must begin with.</span></span> <span data-ttu-id="0a204-330">ファーム内の他の PowerPivot サーバーに同じ QFE を適用している限り、どのサーバーからでも開始できます。</span><span class="sxs-lookup"><span data-stu-id="0a204-330">You can start with any server as long as you apply the same QFE to the other PowerPivot servers in the farm.</span></span>  
  
 <span data-ttu-id="0a204-331">QFE を適用した場合は、ファーム構成データベース内のサーバー バージョン情報を更新する構成手順も実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-331">When you apply the QFE, you must also perform a configuration step that updates the server version information in the farm configuration database.</span></span> <span data-ttu-id="0a204-332">修正プログラムを適用したサーバーのバージョンがファームに対して新たに想定されるバージョンになります。</span><span class="sxs-lookup"><span data-stu-id="0a204-332">The version of the patched server becomes the new expected version for the farm.</span></span> <span data-ttu-id="0a204-333">すべてのコンピューターに QFE が適用され、構成が完了するまで、QFE が適用されていない PowerPivot for SharePoint インスタンスを使用して PowerPivot データの要求を処理することはできません。</span><span class="sxs-lookup"><span data-stu-id="0a204-333">Until the QFE is applied and configured across all machines, the PowerPivot for SharePoint instances that do not have the QFE will be unavailable to handle requests for PowerPivot data.</span></span>  
  
 <span data-ttu-id="0a204-334">QFE を適切に適用および構成するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="0a204-334">To ensure the QFE is applied and configured correctly, follow these instructions:</span></span>  
  
1.  <span data-ttu-id="0a204-335">QFE で提供されている手順に従って修正プログラムをインストールします。</span><span class="sxs-lookup"><span data-stu-id="0a204-335">Install the patch using the instructions that are provided with the QFE.</span></span>  
  
2.  <span data-ttu-id="0a204-336">PowerPivot 構成ツールを起動します。</span><span class="sxs-lookup"><span data-stu-id="0a204-336">Start the PowerPivot Configuration Tool.</span></span>  
  
3.  <span data-ttu-id="0a204-337">**[機能、サービス、アプリケーション、およびソリューションのアップグレード]** をクリックし、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-337">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="0a204-338">アップグレード タスクに含まれているアクションを確認し、 **[検証]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-338">Review the actions that are included in the upgrade task, and then click **Validate**.</span></span>  
  
5.  <span data-ttu-id="0a204-339">**[実行]** をクリックしてアクションを適用します。</span><span class="sxs-lookup"><span data-stu-id="0a204-339">Click **Run** to apply the actions.</span></span>  
  
6.  <span data-ttu-id="0a204-340">ファーム内の追加の PowerPivot for SharePoint インスタンスに対して操作を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="0a204-340">Repeat for additional PowerPivot for SharePoint instances in the farm.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="0a204-341">マルチサーバー配置では、各インスタンスの修正を適用して構成した後で、次のコンピューターに進んでください。</span><span class="sxs-lookup"><span data-stu-id="0a204-341">In a multi-server deployment, be sure to both patch and configure each instance before continuing to the next machine.</span></span> <span data-ttu-id="0a204-342">PowerPivot 構成ツールでは、1 つのインスタンスのアップグレード タスクを完了してから、次のインスタンスに進む必要があります。</span><span class="sxs-lookup"><span data-stu-id="0a204-342">The PowerPivot Configuration Tool must complete the upgrade task for the current instance before you move on to the next instance.</span></span>  
  
 <span data-ttu-id="0a204-343">ファーム内のサービスのバージョン情報をチェックするには、サーバーの全体管理の [アップグレードと修正プログラムの管理] セクションにある **[製品と修正プログラムのインストール状態のチェック]** ページを使用します。</span><span class="sxs-lookup"><span data-stu-id="0a204-343">To check version information for services in the farm, use the **Check product and patch installation status** page in the Upgrade and Patch Management section in Central Administration.</span></span>  
  
##  <a name="post-upgrade-verification-tasks"></a><a name="verify"></a> <span data-ttu-id="0a204-344">アップグレード後の検証タスク</span><span class="sxs-lookup"><span data-stu-id="0a204-344">Post-upgrade verification tasks</span></span>  
 <span data-ttu-id="0a204-345">アップグレードが完了したら、次の手順を実行して、サーバーが動作可能であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-345">After upgrade is complete, use the following steps to verify the server is operational.</span></span>  
  
|<span data-ttu-id="0a204-346">タスク</span><span class="sxs-lookup"><span data-stu-id="0a204-346">Task</span></span>|<span data-ttu-id="0a204-347">Link</span><span class="sxs-lookup"><span data-stu-id="0a204-347">Link</span></span>|  
|----------|----------|  
|<span data-ttu-id="0a204-348">PowerPivot for SharePoint を実行するすべてのコンピューターでサービスが実行されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-348">Verify the service is running on all computers that run PowerPivot for SharePoint.</span></span>|[<span data-ttu-id="0a204-349">PowerPivot for SharePoint サーバーの開始または停止</span><span class="sxs-lookup"><span data-stu-id="0a204-349">Start or Stop a PowerPivot for SharePoint Server</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/start-or-stop-a-power-pivot-for-sharepoint-server)|  
|<span data-ttu-id="0a204-350">サイト コレクション レベルでの機能のアクティブ化を確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-350">Verify feature activation at the site collection level.</span></span>|[<span data-ttu-id="0a204-351">サイト コレクションを対象とした PowerPivot 機能の統合をサーバーの全体管理でアクティブ化する方法</span><span class="sxs-lookup"><span data-stu-id="0a204-351">Activate PowerPivot Feature Integration for Site Collections in Central Administration</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/activate-power-pivot-integration-for-site-collections-in-ca)|  
|<span data-ttu-id="0a204-352">ブックを開き、フィルターおよびスライサーをクリックしてクエリを開始することで、個々の PowerPivot ブックが適切に読み込まれることを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-352">Verify individual PowerPivot workbooks are loading properly by opening a workbook and clicking on filters and slicers to initiate a query.</span></span>|<span data-ttu-id="0a204-353">ハード ドライブのキャッシュ ファイルの存在をチェックします。</span><span class="sxs-lookup"><span data-stu-id="0a204-353">Check for the presence of cached files on the hard drive.</span></span> <span data-ttu-id="0a204-354">キャッシュ ファイルが存在する場合は、データ ファイルがその物理サーバーに読み込まれたことを示します。</span><span class="sxs-lookup"><span data-stu-id="0a204-354">A cached file confirms that the data file was loaded on that physical server.</span></span> <span data-ttu-id="0a204-355">c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup フォルダー内のキャッシュ ファイルを探します。</span><span class="sxs-lookup"><span data-stu-id="0a204-355">Look for cached files in the c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup folder.</span></span>|  
|<span data-ttu-id="0a204-356">データ更新が構成されているブックを選択して、データ更新をテストします。</span><span class="sxs-lookup"><span data-stu-id="0a204-356">Test data refresh on selected workbooks that are configured for data refresh.</span></span>|<span data-ttu-id="0a204-357">データ更新をテストする最も簡単な方法は、データ更新スケジュールを変更することです。具体的には、 **[さらに、できるだけ早く更新を行います]** チェック ボックスをオンにして、データ更新がすぐに実行されるようにします。</span><span class="sxs-lookup"><span data-stu-id="0a204-357">The easiest way to test data refresh is to modify a data refresh schedule, choosing the **Also refresh as soon as possible** checkbox so that data refresh runs immediately.</span></span> <span data-ttu-id="0a204-358">この手順によって、データ更新が現在のブックに対して成功するかどうかが判明します。</span><span class="sxs-lookup"><span data-stu-id="0a204-358">This step will determine whether data refresh is successful for the current workbook.</span></span> <span data-ttu-id="0a204-359">他のよく使用されるブックにもこの手順を実行して、データ更新が機能することを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-359">Repeat these steps for other frequently used workbooks to ensure that data refresh is functional.</span></span> <span data-ttu-id="0a204-360">データ更新のスケジュール設定の詳細については、「 [PowerPivot for SharePoint&#41;&#40;データ更新をスケジュールする](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-360">For more information about scheduling data refresh, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>|  
|<span data-ttu-id="0a204-361">随時、PowerPivot 管理ダッシュボードのデータ更新レポートを監視して、データ更新エラーがないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="0a204-361">Over time, monitor the data refresh reports in PowerPivot Management Dashboard to confirm there are no data refresh errors.</span></span>|[<span data-ttu-id="0a204-362">PowerPivot 管理ダッシュボードと使用状況データ</span><span class="sxs-lookup"><span data-stu-id="0a204-362">PowerPivot Management Dashboard and Usage Data</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data)|  
  
 <span data-ttu-id="0a204-363">PowerPivot の設定と機能を構成する方法の詳細については、「[サーバーの全体管理での Powerpivot サーバーの管理と構成](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-363">For more information about how to configure PowerPivot settings and features, see [PowerPivot Server Administration and Configuration in Central Administration](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span></span>  
  
 <span data-ttu-id="0a204-364">インストール後のすべての構成タスクについて説明する詳細な手順については、「[初期構成 &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0a204-364">For step-by-step instructions that guide you through all of the post-installation configuration tasks, see [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  

## <a name="see-also"></a><span data-ttu-id="0a204-365">参照</span><span class="sxs-lookup"><span data-stu-id="0a204-365">See Also</span></span>  
 <span data-ttu-id="0a204-366">[SQL Server 2014 の各エディションがサポートする機能](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span><span class="sxs-lookup"><span data-stu-id="0a204-366">[Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span></span>  
 [<span data-ttu-id="0a204-367">PowerPivot for SharePoint 2010 のインストール</span><span class="sxs-lookup"><span data-stu-id="0a204-367">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
