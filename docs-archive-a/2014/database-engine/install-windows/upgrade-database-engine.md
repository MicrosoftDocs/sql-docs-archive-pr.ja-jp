---
title: データベース エンジンのアップグレード | Microsoft Docs
ms.custom: ''
ms.date: 10/26/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- compatibility [SQL Server], databases
- compatibility levels [SQL Server], after upgrade
- Database Engine [SQL Server], upgrading
ms.assetid: 3c036813-36cf-4415-a0c9-248d0a433859
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ed13712678ab599e55b539d6226142b686106fe5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634619"
---
# <a name="upgrade-database-engine"></a><span data-ttu-id="5459b-102">データベース エンジンのアップグレード</span><span class="sxs-lookup"><span data-stu-id="5459b-102">Upgrade Database Engine</span></span>
  <span data-ttu-id="5459b-103">ここでは、アップグレード プロセスの準備および理解に必要な情報を提供します。内容は以下のとおりです。</span><span class="sxs-lookup"><span data-stu-id="5459b-103">This topic provides the information that you will need to prepare for and understand the upgrade process; it covers:</span></span>  
  
-   <span data-ttu-id="5459b-104">アップグレードに関する既知の問題</span><span class="sxs-lookup"><span data-stu-id="5459b-104">Known upgrade issues.</span></span>  
  
-   <span data-ttu-id="5459b-105">アップグレード前の作業と注意点</span><span class="sxs-lookup"><span data-stu-id="5459b-105">Pre-upgrade tasks and considerations.</span></span>  
  
-   <span data-ttu-id="5459b-106">[!INCLUDE[ssDE](../../includes/ssde-md.md)]をアップグレードするための手順のトピックへのリンク</span><span class="sxs-lookup"><span data-stu-id="5459b-106">Links to procedural topics for upgrading the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>  
  
-   <span data-ttu-id="5459b-107">データベースを [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]に移行するための手順のトピックへのリンク</span><span class="sxs-lookup"><span data-stu-id="5459b-107">Links to procedural topics for migrating databases to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="5459b-108">フェールオーバー クラスターに関する注意点</span><span class="sxs-lookup"><span data-stu-id="5459b-108">Considerations for failover clusters.</span></span>  
  
-   <span data-ttu-id="5459b-109">アップグレード後の作業と注意点</span><span class="sxs-lookup"><span data-stu-id="5459b-109">Post-upgrade tasks and considerations.</span></span>  
  
## <a name="known-upgrade-issues"></a><span data-ttu-id="5459b-110">アップグレードに関する既知の問題</span><span class="sxs-lookup"><span data-stu-id="5459b-110">Known Upgrade issues</span></span>  
 <span data-ttu-id="5459b-111">[!INCLUDE[ssDE](../../includes/ssde-md.md)] をアップグレードする前に、「[SQL Server データベース エンジンの旧バージョンとの互換性](../sql-server-database-engine-backward-compatibility.md)」を確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-111">Before upgrading the [!INCLUDE[ssDE](../../includes/ssde-md.md)], review [SQL Server Database Engine Backward Compatibility](../sql-server-database-engine-backward-compatibility.md).</span></span> <span data-ttu-id="5459b-112">サポートされるアップグレード シナリオとアップグレードの既知の問題については、「[サポートされているバージョンとエディションのアップグレード](supported-version-and-edition-upgrades.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-112">For information about supported upgrade scenarios and upgrade known issues, see [Supported Version and Edition Upgrades](supported-version-and-edition-upgrades.md).</span></span> <span data-ttu-id="5459b-113">その他の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コンポーネントの旧バージョンとの互換性の内容については、「[旧バージョンとの互換性](../../getting-started/backward-compatibility.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-113">For backward compatibility content for other [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] components, see [Backward Compatibility](../../getting-started/backward-compatibility.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="5459b-114">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のいずれかのエディションから別のエディションへアップグレードする前に、現在使用している機能がアップグレード先のエディションでサポートされているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-114">Before you upgrade from one edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to another, verify that the functionality that you are currently using is supported in the edition to which you are upgrading.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5459b-115">以前のバージョンの [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Enterprise Edition から [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] にアップグレードする場合は、"Enterprise Edition: コアベースのライセンス" または "Enterprise Edition" を選択してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-115">When you upgrade to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] from a prior version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise edition, choose between Enterprise Edition: Core-based Licensing and Enterprise Edition.</span></span> <span data-ttu-id="5459b-116">これらの Enterprise エディションは、ライセンス モードのみが異なります。</span><span class="sxs-lookup"><span data-stu-id="5459b-116">These Enterprise editions differ only with respect to the licensing modes.</span></span> <span data-ttu-id="5459b-117">詳細については、「 [Compute Capacity Limits by Edition of SQL Server](../../sql-server/compute-capacity-limits-by-edition-of-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-117">For more information, see [Compute Capacity Limits by Edition of SQL Server](../../sql-server/compute-capacity-limits-by-edition-of-sql-server.md).</span></span>  
  
## <a name="pre-upgrade-checklist"></a><span data-ttu-id="5459b-118">アップグレード前のチェック リスト</span><span class="sxs-lookup"><span data-stu-id="5459b-118">Pre-Upgrade Checklist</span></span>  
 <span data-ttu-id="5459b-119">以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のアップグレードは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] セットアップ プログラムでサポートされています。</span><span class="sxs-lookup"><span data-stu-id="5459b-119">Upgrading [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from an earlier version is supported by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup program.</span></span> <span data-ttu-id="5459b-120">また、以前の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] バージョンのデータベースを移行することもできます。</span><span class="sxs-lookup"><span data-stu-id="5459b-120">You can also migrate databases from previous [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] versions.</span></span> <span data-ttu-id="5459b-121">移行は、同じコンピューター上の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンス間で行うことも、別のコンピューター上の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスから行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="5459b-121">Migration can be from one [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance to another on the same computer, or from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance on another computer.</span></span> <span data-ttu-id="5459b-122">移行オプションには、データベース コピー ウィザードの使用、バックアップ機能と復元機能、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] インポート/エクスポート ウィザードの使用、一括エクスポート/一括インポート方式があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-122">Migration options include use of the Copy Database Wizard, Backup and restore functionality, use of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] Import and Export Wizard, and bulk export/bulk import methods.</span></span>  
  
 <span data-ttu-id="5459b-123">[!INCLUDE[ssDE](../../includes/ssde-md.md)]をアップグレードする前に、次のトピックを確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-123">Before upgrading the [!INCLUDE[ssDE](../../includes/ssde-md.md)], review the following:</span></span>  
  
-   <span data-ttu-id="5459b-124">「 [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md)」を確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-124">Review [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md).</span></span>  
  
-   <span data-ttu-id="5459b-125">「 [Check Parameters for the System Configuration Checker](check-parameters-for-the-system-configuration-checker.md)」を確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-125">Review [Check Parameters for the System Configuration Checker](check-parameters-for-the-system-configuration-checker.md).</span></span>  
  
-   <span data-ttu-id="5459b-126">「 [Security Considerations for a SQL Server Installation](../../sql-server/install/security-considerations-for-a-sql-server-installation.md)」を確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-126">Review [Security Considerations for a SQL Server Installation](../../sql-server/install/security-considerations-for-a-sql-server-installation.md).</span></span>  
  
-   <span data-ttu-id="5459b-127">「[サポートされているバージョンとエディションのアップグレード](supported-version-and-edition-upgrades.md)」を確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-127">Review [Supported Version and Edition Upgrades](supported-version-and-edition-upgrades.md).</span></span>  
  
-   <span data-ttu-id="5459b-128">「[アップグレード アドバイザーを使用したアップグレードの準備](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)」を確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-128">Review [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
-   <span data-ttu-id="5459b-129">「[分散再生ユーティリティを使用したアップグレードの準備](../../sql-server/install/use-the-distributed-replay-utility-to-prepare-for-upgrades.md)」を確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-129">Review [Use the Distributed Replay Utility to Prepare for Upgrades](../../sql-server/install/use-the-distributed-replay-utility-to-prepare-for-upgrades.md).</span></span>  
  
-   <span data-ttu-id="5459b-130">「 [SQL Server データベース エンジンの旧バージョンとの互換性](../sql-server-database-engine-backward-compatibility.md)」を確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-130">Review [SQL Server Database Engine Backward Compatibility](../sql-server-database-engine-backward-compatibility.md).</span></span>  
  
-   <span data-ttu-id="5459b-131">「[クエリ プランの移行](change-the-database-compatibility-mode-and-use-the-query-store.md)」を確認してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-131">Review [Migrate Query Plans](change-the-database-compatibility-mode-and-use-the-query-store.md).</span></span>  
  
 <span data-ttu-id="5459b-132">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]をアップグレードする前に、以下の問題点を確認して変更を行います。</span><span class="sxs-lookup"><span data-stu-id="5459b-132">Review the following issues and make changes before you upgrade [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="5459b-133">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントが MSX/TSX リレーションシップに参加している [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスをアップグレードする場合は、マスター サーバーをアップグレードする前に、ターゲット サーバーをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="5459b-133">When upgrading instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] where [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is enlisted in MSX/TSX relationships, upgrade target servers before you upgrade master servers.</span></span> <span data-ttu-id="5459b-134">ターゲット サーバーより前にマスター サーバーをアップグレードすると、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントは [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のマスター インスタンスに接続できなくなります。</span><span class="sxs-lookup"><span data-stu-id="5459b-134">If you upgrade master servers before target servers, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent will not be able to connect to master instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="5459b-135">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の 64 ビット版から [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]の 64 ビット版にアップグレードする場合は、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] をアップグレードしてから [!INCLUDE[ssDE](../../includes/ssde-md.md)]をアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-135">When upgrading from a 64-bit edition of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to a 64-bit edition of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you must upgrade [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] before you upgrade the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span>  
  
-   <span data-ttu-id="5459b-136">アップグレード対象のインスタンスからすべての [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] データベース ファイルをバックアップして、必要な場合はこれらのファイルを復元できるようにします。</span><span class="sxs-lookup"><span data-stu-id="5459b-136">Back up all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database files from the instance to be upgraded, so that you can restore them, if it is required.</span></span>  
  
-   <span data-ttu-id="5459b-137">アップグレード対象のデータベース上で適切なデータベース コンソール コマンド (DBCC) を実行して、データベースの一貫性を確保します。</span><span class="sxs-lookup"><span data-stu-id="5459b-137">Run the appropriate Database Console Commands (DBCC) on databases to be upgraded to ensure that they are in a consistent state.</span></span>  
  
-   <span data-ttu-id="5459b-138">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コンポーネントおよびユーザー データベースのアップグレードに必要なディスク容量を見積もります。</span><span class="sxs-lookup"><span data-stu-id="5459b-138">Estimate the disk space that is required to upgrade [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] components, in addition to user databases.</span></span> <span data-ttu-id="5459b-139">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コンポーネントで必要とされるディスク容量については、「[SQL Server 2014 のインストールに必要なハードウェアおよびソフトウェア](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-139">For disk space that is required by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] components, see [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md).</span></span>  
  
-   <span data-ttu-id="5459b-140">既存の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] システム データベース (master、model、msdb、tempdb) が自動拡張するように構成されていることを確認し、それらが十分なハード ディスク容量を備えていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-140">Ensure that existing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] system databases - master, model, msdb, and tempdb - are configured to autogrow, and ensure that they have sufficient hard disk space.</span></span>  
  
-   <span data-ttu-id="5459b-141">すべてのデータベース サーバーが master データベースにログオン情報を持っていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-141">Ensure that all database servers have logon information in the master database.</span></span> <span data-ttu-id="5459b-142">システム ログオン情報は master データベースに格納されるので、データベースを復元するにはこの作業が重要になります。</span><span class="sxs-lookup"><span data-stu-id="5459b-142">This is important for restoring a database, as system logon information resides in master.</span></span>  
  
-   <span data-ttu-id="5459b-143">すべての起動ストアド プロシージャを無効にします。アップグレード プロセスでは、サービスの起動および停止はアップグレード中の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンス上で行われます。</span><span class="sxs-lookup"><span data-stu-id="5459b-143">Disable all startup stored procedures, as the upgrade process will stop and start services on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance being upgraded.</span></span> <span data-ttu-id="5459b-144">起動時にストアド プロシージャを実行すると、アップグレード プロセスをブロックする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-144">Stored procedures processed at startup time might block the upgrade process.</span></span>  
  
-   <span data-ttu-id="5459b-145">レプリケーションが最新であることを確認してから、レプリケーションを停止します。</span><span class="sxs-lookup"><span data-stu-id="5459b-145">Make sure that Replication is current and then stop Replication.</span></span>  
  
-   <span data-ttu-id="5459b-146">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] との従属関係を持つすべてのサービスを含むすべてのアプリケーションを終了します。</span><span class="sxs-lookup"><span data-stu-id="5459b-146">Quit all applications, including all services that have [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dependencies.</span></span> <span data-ttu-id="5459b-147">アップグレード実行中のインスタンスにローカル アプリケーションが接続されている場合は、アップグレード操作が失敗する場合があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-147">Upgrade might fail if local applications are connected to the instance being upgraded.</span></span>  
  
-   <span data-ttu-id="5459b-148">データベース ミラーリングを使用する場合は、「[サーバー インスタンスのアップグレード時に、ミラー化されたデータベースのダウンタイムを最小化する](../database-mirroring/upgrading-mirrored-instances.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-148">If you use Database Mirroring, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](../database-mirroring/upgrading-mirrored-instances.md).</span></span>  
  
## <a name="upgrading-the-database-engine"></a><span data-ttu-id="5459b-149">データベース エンジンのアップグレード</span><span class="sxs-lookup"><span data-stu-id="5459b-149">Upgrading the Database Engine</span></span>  
 <span data-ttu-id="5459b-150">現在インストールされている [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以降のバージョンを、バージョン アップグレードで上書きすることができます。</span><span class="sxs-lookup"><span data-stu-id="5459b-150">You can overwrite an installation of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later with a version upgrade.</span></span> <span data-ttu-id="5459b-151">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] セットアップの実行時に以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] が検出された場合は、以前の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] プログラム ファイルがすべてアップグレードされ、以前の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスに保存されているすべてのデータが保持されます。</span><span class="sxs-lookup"><span data-stu-id="5459b-151">If an earlier version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is detected when you run [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup, all previous [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] program files are upgraded, and all data stored in the previous [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance is preserved.</span></span> <span data-ttu-id="5459b-152">また、以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] オンライン ブックがコンピューター上に元の状態のまま残ります。</span><span class="sxs-lookup"><span data-stu-id="5459b-152">In addition, earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online will remain intact on the computer.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="5459b-153">SQL Server 2014 セットアップ プログラムの実行中に、アップグレード前チェックの実行の一部として、SQL Server インスタンスが停止し、再起動します。</span><span class="sxs-lookup"><span data-stu-id="5459b-153">When running the SQL Server 2014 setup program, the SQL Server instance is stopped and restarted as part of running the pre-upgrade checks.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="5459b-154">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]をアップグレードすると、以前の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスは上書きされて、コンピューター上に存在しなくなります。</span><span class="sxs-lookup"><span data-stu-id="5459b-154">When you upgrade [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the previous [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance will be overwritten and will no longer exist on your computer.</span></span> <span data-ttu-id="5459b-155">アップグレードする前に、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] データベースおよび以前の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスに関連するその他のオブジェクトをバックアップしてください。</span><span class="sxs-lookup"><span data-stu-id="5459b-155">Before upgrading, back up [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases and other objects associated with the previous [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="5459b-156">[!INCLUDE[ssDE](../../includes/ssde-md.md)] をアップグレードするには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インストール ウィザードを使用します。</span><span class="sxs-lookup"><span data-stu-id="5459b-156">You can upgrade the [!INCLUDE[ssDE](../../includes/ssde-md.md)] by using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Installation Wizard.</span></span>  
  
### <a name="database-compatibility-level-after-upgrade"></a><span data-ttu-id="5459b-157">アップグレード後のデータベース互換性レベル</span><span class="sxs-lookup"><span data-stu-id="5459b-157">Database Compatibility Level After Upgrade</span></span>  
 <span data-ttu-id="5459b-158">`tempdb`、 `model` 、 `msdb` および**リソース**データベースの互換性レベルは、アップグレード後に120に設定されます。</span><span class="sxs-lookup"><span data-stu-id="5459b-158">The compatibility levels of the `tempdb`, `model`, `msdb` and **Resource** databases are set to 120 after upgrade.</span></span> <span data-ttu-id="5459b-159">`master` システム データベースの互換性レベルは、アップグレード前と同じです。</span><span class="sxs-lookup"><span data-stu-id="5459b-159">The `master` system database retains the compatibility level it had before upgrade.</span></span>  
  
 <span data-ttu-id="5459b-160">アップグレード前のユーザー データベースの互換性レベルが 100 以上の場合は、アップグレード後も互換性レベルは変わりません。</span><span class="sxs-lookup"><span data-stu-id="5459b-160">If the compatibility level of a user database was 100 or higher before the upgrade, it remains the same after upgrade.</span></span> <span data-ttu-id="5459b-161">アップグレード前の互換性レベルが 90 の場合、アップグレードされたデータベースの互換性レベルは 100 に設定されます。これは、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]でサポートされている下限の互換性レベルです。</span><span class="sxs-lookup"><span data-stu-id="5459b-161">If the compatibility level was 90 before upgrade, in the upgraded database, the compatibility level is set to 100, which is the lowest supported compatibility level in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5459b-162">新しいユーザー データベースには、`model` データベースの互換性レベルが継承されます。</span><span class="sxs-lookup"><span data-stu-id="5459b-162">New user databases will inherit the compatibility level of the `model` database.</span></span>  
  
## <a name="migrating-databases"></a><span data-ttu-id="5459b-163">データベースの移行</span><span class="sxs-lookup"><span data-stu-id="5459b-163">Migrating Databases</span></span>  
 <span data-ttu-id="5459b-164">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] でバックアップと復元またはデタッチとアタッチの機能を使用して、ユーザー データベースを [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]インスタンスに移行することができます。</span><span class="sxs-lookup"><span data-stu-id="5459b-164">You can move user databases to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using backup and restore or detach and attach functionalities in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="5459b-165">詳細については、「[バックアップと復元によるデータベースのコピー](../../relational-databases/databases/copy-databases-with-backup-and-restore.md)」または「[データベースのデタッチとアタッチ &#40;SQL Server&#41;](../../relational-databases/databases/database-detach-and-attach-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-165">For more information, see [Copy Databases with Backup and Restore](../../relational-databases/databases/copy-databases-with-backup-and-restore.md) or [Database Detach and Attach &#40;SQL Server&#41;](../../relational-databases/databases/database-detach-and-attach-sql-server.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="5459b-166">ソースや対象サーバーで同じ名前を持つデータベースは移動またはコピーすることはできません。</span><span class="sxs-lookup"><span data-stu-id="5459b-166">A database that has the identical name on both source and destination servers cannot be moved or copied.</span></span> <span data-ttu-id="5459b-167">このような場合は、"既に存在します" と通知されます。</span><span class="sxs-lookup"><span data-stu-id="5459b-167">In this case, it will be noted as "Already exists."</span></span>  
  
 <span data-ttu-id="5459b-168">詳細については、「 [Use the Copy Database Wizard](../../relational-databases/databases/use-the-copy-database-wizard.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-168">For more information, see [Use the Copy Database Wizard](../../relational-databases/databases/use-the-copy-database-wizard.md).</span></span>  
  
## <a name="after-upgrading-the-database-engine"></a><span data-ttu-id="5459b-169">データベース エンジンのアップグレード後の作業</span><span class="sxs-lookup"><span data-stu-id="5459b-169">After Upgrading the Database Engine</span></span>  
 <span data-ttu-id="5459b-170">[!INCLUDE[ssDE](../../includes/ssde-md.md)]をアップグレードした後は、次の作業を実行します。</span><span class="sxs-lookup"><span data-stu-id="5459b-170">After upgrading the [!INCLUDE[ssDE](../../includes/ssde-md.md)], complete the following tasks:</span></span>  
  
-   <span data-ttu-id="5459b-171">サーバーを再登録します。</span><span class="sxs-lookup"><span data-stu-id="5459b-171">Re-register your servers.</span></span> <span data-ttu-id="5459b-172">サーバーの登録の詳細については、「[サーバーの登録](../../ssms/register-servers/register-servers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-172">For more information about registering servers, see [Register Servers](../../ssms/register-servers/register-servers.md).</span></span>  
  
-   <span data-ttu-id="5459b-173">クエリ結果のセマンティクスの一貫性を維持するために、フルテキスト カタログを再作成します。</span><span class="sxs-lookup"><span data-stu-id="5459b-173">Re-populate full-text catalogs to ensure semantic consistency in query results.</span></span>  
  
     [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="5459b-174">により、フルテキスト検索およびセマンティック検索に使用する新しいワード ブレーカーがインストールされます。</span><span class="sxs-lookup"><span data-stu-id="5459b-174">installs new word breakers for use by Full-Text and Semantic Search.</span></span> <span data-ttu-id="5459b-175">ワード ブレーカーは、インデックスの作成時とクエリ時の両方に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5459b-175">The word breakers are used both at indexing time and at query time.</span></span> <span data-ttu-id="5459b-176">フルテキスト カタログを再構築しない場合は、検索結果の一貫性が失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-176">If you do not rebuild the full-text catalogs, your search results may be inconsistent.</span></span> <span data-ttu-id="5459b-177">以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のワード ブレーカーと現在のワード ブレーカーで区切りが異なるフレーズを検索するフルテキスト クエリを発行すると、そのフレーズを含むドキュメントまたは行が検索されない場合があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-177">If you issue a full-text query that looks for a phrase that is broken differently by the word breaker in a previous version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current word breaker, a document or row containing the phrase might not be retrieved.</span></span> <span data-ttu-id="5459b-178">これはインデックスされたフレーズがクエリとは異なるロジックで区切られたためです。</span><span class="sxs-lookup"><span data-stu-id="5459b-178">This is because the indexed phrases were broken using different logic than the query is using.</span></span> <span data-ttu-id="5459b-179">この問題を解決するには、新しいワード ブレーカーを使用してフルテキスト カタログを再作成 (再構築) し、インデックス時とクエリ時の動作が同一になるようにします。</span><span class="sxs-lookup"><span data-stu-id="5459b-179">The solution is to repopulate (rebuild) the full-text catalogs with the new word breakers so that index time and query time behavior are identical.</span></span>  
  
     <span data-ttu-id="5459b-180">詳細については、「[sp_fulltext_catalog &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-fulltext-catalog-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5459b-180">For more information, see [sp_fulltext_catalog &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-fulltext-catalog-transact-sql).</span></span>  
  
-   <span data-ttu-id="5459b-181">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インストールを構成します。</span><span class="sxs-lookup"><span data-stu-id="5459b-181">Configure the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation.</span></span> <span data-ttu-id="5459b-182">システムのセキュリティを向上させるため、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では、主要なサービスと機能を個別にインストールし、有効化できるようになっています。</span><span class="sxs-lookup"><span data-stu-id="5459b-182">To reduce the attackable surface area of a system, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] selectively installs and enables key services and features.</span></span>  
  
-   <span data-ttu-id="5459b-183">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] によって生成され、パーティション テーブルおよびパーティション インデックスに対するクエリに適用される USE PLAN ヒントを検証または削除します。</span><span class="sxs-lookup"><span data-stu-id="5459b-183">Validate or remove USE PLAN hints that are generated by [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and applied to queries on partitioned tables and indexes.</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="5459b-184">では、パーティション テーブルとインデックスでのクエリの処理方法が異なります。</span><span class="sxs-lookup"><span data-stu-id="5459b-184">changes the way queries on partitioned tables and indexes are processed.</span></span> <span data-ttu-id="5459b-185">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] で生成されたプランに USE PLAN ヒントを使用する、パーティション分割されたオブジェクトのクエリには、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]で使用できないプランが含まれる場合があります。</span><span class="sxs-lookup"><span data-stu-id="5459b-185">Queries on partitioned objects that use the USE PLAN hint for a plan that is generated by [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] might contain a plan that is not usable in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="5459b-186">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]にアップグレードした後は、次の手順を実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5459b-186">We recommend the following procedures after you upgrade to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
     <span data-ttu-id="5459b-187">**USE PLAN ヒントがクエリ内で直接指定されている場合 :**</span><span class="sxs-lookup"><span data-stu-id="5459b-187">**When the USE PLAN hint is specified directly in a query:**</span></span>  
  
    1.  <span data-ttu-id="5459b-188">USE PLAN ヒントをクエリから削除します。</span><span class="sxs-lookup"><span data-stu-id="5459b-188">Remove the USE PLAN hint from the query.</span></span>  
  
    2.  <span data-ttu-id="5459b-189">クエリをテストします。</span><span class="sxs-lookup"><span data-stu-id="5459b-189">Test the query.</span></span>  
  
    3.  <span data-ttu-id="5459b-190">オプティマイザーによって適切なプランが選択されない場合は、クエリをチューニングし、USE PLAN ヒントを必要なクエリ プランと共に指定することを検討します。</span><span class="sxs-lookup"><span data-stu-id="5459b-190">If the optimizer does not select an appropriate plan, tune the query, and then consider specifying the USE PLAN hint with the desired query plan.</span></span>  
  
     <span data-ttu-id="5459b-191">**USE PLAN ヒントがプラン ガイドで指定されている場合 :**</span><span class="sxs-lookup"><span data-stu-id="5459b-191">**When the USE PLAN hint is specified in a plan guide:**</span></span>  
  
    1.  <span data-ttu-id="5459b-192">sys.fn_validate_plan_guide 関数を使用して、プラン ガイドの有効性を確認します。</span><span class="sxs-lookup"><span data-stu-id="5459b-192">Use the sys.fn_validate_plan_guide function to check the validity of the plan guide.</span></span> <span data-ttu-id="5459b-193">また、 [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)]で、Plan Guide Unsuccessful イベントを使用して無効なプラン ガイドを確認することもできます。</span><span class="sxs-lookup"><span data-stu-id="5459b-193">Alternatively, you can check for invalid plans by using the Plan Guide Unsuccessful event in [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)].</span></span>  
  
    2.  <span data-ttu-id="5459b-194">プラン ガイドが有効でない場合は、プラン ガイドを削除します。</span><span class="sxs-lookup"><span data-stu-id="5459b-194">If the plan guide is not valid, drop the plan guide.</span></span> <span data-ttu-id="5459b-195">オプティマイザーによって適切なプランが選択されない場合は、クエリをチューニングし、USE PLAN ヒントを必要なクエリ プランと共に指定することを検討します。</span><span class="sxs-lookup"><span data-stu-id="5459b-195">If the optimizer does not select an appropriate plan, tune the query, and then consider specifying the USE PLAN hint with the query plan that you want.</span></span>  
  
     <span data-ttu-id="5459b-196">USE PLAN ヒントがプラン ガイドで指定されている場合、無効なプランが原因でクエリが失敗することはありません。</span><span class="sxs-lookup"><span data-stu-id="5459b-196">A plan that is not valid will not cause the query to fail when the USE PLAN hint is specified in a plan guide.</span></span> <span data-ttu-id="5459b-197">この場合、USE PLAN ヒントを使用せずにクエリがコンパイルされます。</span><span class="sxs-lookup"><span data-stu-id="5459b-197">Instead, the query is compiled without using the USE PLAN hint.</span></span>  
  
 <span data-ttu-id="5459b-198">アップグレード前にフルテキストが有効または無効にマーク付けされていたデータベースは、アップグレード後もその状態を維持します。</span><span class="sxs-lookup"><span data-stu-id="5459b-198">Any databases that were marked full-text enabled or disabled before the upgrade will maintain that status after upgrade.</span></span> <span data-ttu-id="5459b-199">アップグレード後は、フルテキストが許可されているすべてのデータベースで、フルテキスト カタログが再構築され、自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="5459b-199">After the upgrade, the full-text catalogs will be rebuilt and populated automatically for all full-text enabled databases.</span></span> <span data-ttu-id="5459b-200">この処理には、多くの時間とリソースが必要になります。</span><span class="sxs-lookup"><span data-stu-id="5459b-200">This is a time-consuming and resource-consuming operation.</span></span> <span data-ttu-id="5459b-201">次のステートメントを実行すると、フルテキストのインデックス処理を一時停止することができます。</span><span class="sxs-lookup"><span data-stu-id="5459b-201">You can pause the full-text indexing operation temporarily by running the following statement:</span></span>  
  
```  
EXEC sp_fulltext_service 'pause_indexing', 1;  
```  
  
 <span data-ttu-id="5459b-202">フルテキスト インデックスの作成を再開するには、次のステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="5459b-202">To resume full-text index population, run the following statement:</span></span>  
  
```  
EXEC sp_fulltext_service 'pause_indexing', 0;  
```  
  
## <a name="see-also"></a><span data-ttu-id="5459b-203">参照</span><span class="sxs-lookup"><span data-stu-id="5459b-203">See Also</span></span>  
 <span data-ttu-id="5459b-204">[サポートされているバージョンとエディションのアップグレード](supported-version-and-edition-upgrades.md) </span><span class="sxs-lookup"><span data-stu-id="5459b-204">[Supported Version and Edition Upgrades](supported-version-and-edition-upgrades.md) </span></span>  
 <span data-ttu-id="5459b-205">[SQL Server の複数のバージョンおよびインスタンスの操作](../../../2014/sql-server/install/work-with-multiple-versions-and-instances-of-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="5459b-205">[Work with Multiple Versions and Instances of SQL Server](../../../2014/sql-server/install/work-with-multiple-versions-and-instances-of-sql-server.md) </span></span>  
 <span data-ttu-id="5459b-206">[旧バージョンとの互換性](../../getting-started/backward-compatibility.md) </span><span class="sxs-lookup"><span data-stu-id="5459b-206">[Backward Compatibility](../../getting-started/backward-compatibility.md) </span></span>  
 [<span data-ttu-id="5459b-207">レプリケートされたデータベースのアップグレード</span><span class="sxs-lookup"><span data-stu-id="5459b-207">Upgrade Replicated Databases</span></span>](upgrade-replicated-databases.md)  
  
  
