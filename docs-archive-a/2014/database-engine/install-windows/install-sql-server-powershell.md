---
title: SQL Server PowerShell のインストール | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
ms.assetid: 854c0b2f-02d2-46a4-a8cc-6b7a5d191cf8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 53a2a295e6c38fead219e876cfedf040c2188b52
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713462"
---
# <a name="install-sql-server-powershell"></a><span data-ttu-id="81e71-102">SQL Server PowerShell のインストール</span><span class="sxs-lookup"><span data-stu-id="81e71-102">Install SQL Server PowerShell</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="81e71-103">セットアップは、Windows PowerShell 2.0 をインストールしていないのに、PowerShell コンポーネントを含む [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 機能を選択したことが検出された場合に停止します。</span><span class="sxs-lookup"><span data-stu-id="81e71-103">Setup will stop if it detects that you have selected [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that include PowerShell components, but Windows PowerShell 2.0 is not installed.</span></span> <span data-ttu-id="81e71-104">Windows 管理フレームワークを使用して PowerShell をインストールしてから、セットアップを再実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="81e71-104">You must install PowerShell by using the Windows Management Framework, and then rerun Setup.</span></span>  
  
## <a name="installing-ssnoversion-powershell-support"></a><span data-ttu-id="81e71-105">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell サポートのインストール</span><span class="sxs-lookup"><span data-stu-id="81e71-105">Installing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell Support</span></span>  
 <span data-ttu-id="81e71-106">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] セットアップを使用して、Windows PowerShell に [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] サポートを提供するソフトウェアをインストールします。</span><span class="sxs-lookup"><span data-stu-id="81e71-106">You install the software that provides [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] support for Windows PowerShell by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup.</span></span> <span data-ttu-id="81e71-107">PowerShell サポートを必要とする [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 機能を選択すると、Windows PowerShell 2.0 がインストールされているかどうかが確認されます。</span><span class="sxs-lookup"><span data-stu-id="81e71-107">When you select any [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that require PowerShell support, Setup checks that Windows PowerShell 2.0 is installed.</span></span> <span data-ttu-id="81e71-108">PowerShell 2.0 が存在する場合は、セットアップにより次の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell コンポーネントがインストールされます。</span><span class="sxs-lookup"><span data-stu-id="81e71-108">If PowerShell 2.0 is present, Setup then installs the following [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell components:</span></span>  
  
-   <span data-ttu-id="81e71-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell スナップイン。スナップインは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]用の以下の 2 種類の Windows PowerShell サポートを実装する dll ファイルです。</span><span class="sxs-lookup"><span data-stu-id="81e71-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The snap-ins are dll files that implement two types of Windows PowerShell support for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]:</span></span>  
  
    -   <span data-ttu-id="81e71-110">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コマンドレットのセット。</span><span class="sxs-lookup"><span data-stu-id="81e71-110">A set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlets.</span></span> <span data-ttu-id="81e71-111">コマンドレットは特定の操作を実装するコマンドです。</span><span class="sxs-lookup"><span data-stu-id="81e71-111">Cmdlets are commands that implement a specific action.</span></span> <span data-ttu-id="81e71-112">たとえば、 **Invoke-Sqlcmd** では、 [!INCLUDE[tsql](../../includes/tsql-md.md)] sqlcmd **ユーティリティを使用して実行することもできる** スクリプトまたは XQuery スクリプトが実行され、 **Invoke-PolicyEvaluation** では、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] オブジェクトがポリシー ベースの管理ポリシーに準拠しているかどうかが報告されます。</span><span class="sxs-lookup"><span data-stu-id="81e71-112">For example, **Invoke-Sqlcmd** runs a [!INCLUDE[tsql](../../includes/tsql-md.md)] or XQuery script that can also be run by using the **sqlcmd** utility, and **Invoke-PolicyEvaluation** reports whether [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] objects comply with policy-based management policies.</span></span>  
  
    -   <span data-ttu-id="81e71-113">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] プロバイダー。</span><span class="sxs-lookup"><span data-stu-id="81e71-113">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="81e71-114">プロバイダーでは、ファイル システム パスと同様のパスを使用して、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] オブジェクトの階層内を移動できます。</span><span class="sxs-lookup"><span data-stu-id="81e71-114">The provider lets you navigate the hierarchy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] objects using a path similar to a file system path.</span></span> <span data-ttu-id="81e71-115">各オブジェクトは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理オブジェクト モデルのクラスに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="81e71-115">Each object is associated with a class from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management object models.</span></span> <span data-ttu-id="81e71-116">クラスのメソッドやプロパティを使用して、オブジェクトの操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="81e71-116">You can use the methods and properties of the class to perform work on the objects.</span></span> <span data-ttu-id="81e71-117">たとえば、パスでデータベース オブジェクトに移動した場合、Microsoft.SqlServer.Managment.SMO.Database クラスのメソッドとプロパティを使用してデータベースを管理できます。</span><span class="sxs-lookup"><span data-stu-id="81e71-117">For example, if you cd to a databases object in a path, you can use the methods and properties of the Microsoft.SqlServer.Managment.SMO.Database class to manage the database.</span></span>  
  
-   <span data-ttu-id="81e71-118">スナップインを読み込むために Windows PowerShell 2.0 セッションにインポートされる**sqlps**モジュール [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="81e71-118">The **sqlps** module that is imported into Windows PowerShell 2.0 sessions to load the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins.</span></span>  
  
-   <span data-ttu-id="81e71-119">Windows PowerShell 2.0 セッションを開始し、 **sqlps**モジュールをインポートする非推奨の**sqlps**ユーティリティ。</span><span class="sxs-lookup"><span data-stu-id="81e71-119">The deprecated **sqlps** utility that starts a Windows PowerShell 2.0 session and imports the **sqlps** module.</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="81e71-120">は、オブジェクト エクスプローラー ツリーからの Windows PowerShell セッションの起動をサポートします。</span><span class="sxs-lookup"><span data-stu-id="81e71-120">supports starting Windows PowerShell sessions from the Object Explorer tree.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="81e71-121">エージェントは、Windows PowerShell ジョブ ステップをサポートします。</span><span class="sxs-lookup"><span data-stu-id="81e71-121">Agent supports Windows PowerShell job steps.</span></span>  
  
 <span data-ttu-id="81e71-122">Windows PowerShell 2.0 がインストールされていない場合、またはアンインストールされている場合は、「 [Windows 管理フレームワーク](https://go.microsoft.com/fwlink/?LinkId=186214)」ページの手順に従ってインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="81e71-122">If Windows PowerShell 2.0 has not been installed, or has been uninstalled, you must install it by following the instructions on the [Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214) page.</span></span>  
  
 <span data-ttu-id="81e71-123">セットアップの終了後に Windows PowerShell がアンインストールされると、Windows PowerShell 用の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 機能は機能しなくなります。</span><span class="sxs-lookup"><span data-stu-id="81e71-123">If Windows PowerShell is uninstalled after Setup finishes, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features for Windows PowerShell will not function.</span></span> <span data-ttu-id="81e71-124">Windows PowerShell をアンインストールできるのは Windows ユーザーです。また、Windows PowerShell のアンインストールは、Windows オペレーティング システムのアップグレードで必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="81e71-124">Windows PowerShell can be uninstalled by Windows users, and uninstalling Windows PowerShell might be required by some Windows operating system upgrades.</span></span> <span data-ttu-id="81e71-125">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 機能を使用するには、Windows Management Framework を使用して PowerShell 2.0 を再インストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="81e71-125">To use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell features, you must reinstall PowerShell 2.0 by using the Windows Management Framework.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="81e71-126">参照</span><span class="sxs-lookup"><span data-stu-id="81e71-126">See Also</span></span>  
 [<span data-ttu-id="81e71-127">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="81e71-127">SQL Server PowerShell</span></span>](../../powershell/sql-server-powershell.md)  
  
  
