---
title: Analysis Services と AlwaysOn 可用性グループ | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
ms.assetid: 14d16bfd-228c-4870-b463-a283facda965
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 9ea0c7f30fd8f431f70284122df7e2a036658f4e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87632134"
---
# <a name="analysis-services-with-always-on-availability-groups"></a><span data-ttu-id="3fa39-102">Analysis Services と Always On 可用性グループ</span><span class="sxs-lookup"><span data-stu-id="3fa39-102">Analysis Services with Always On Availability Groups</span></span>
  <span data-ttu-id="3fa39-103">AlwaysOn 可用性グループは SQL Server リレーショナル データベースの事前に定義されたコレクションで、その中の 1 つのデータベースが条件に従ってフェールオーバーするときに一緒にフェールオーバーし、同じ可用性グループの別のインスタンスのミラー化されたデータベースに要求をリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-103">An AlwaysOn availability group is a predefined collection of SQL Server relational databases that failover together when conditions trigger a failover in any one database, redirecting requests to a mirrored database on another instance in the same availability group.</span></span> <span data-ttu-id="3fa39-104">高可用性ソリューションとして可用性グループを使用している場合、そのグループ内のデータベースを Analysis Services テーブルまたは多次元ソリューションのデータ ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-104">If you are using availability groups as your high availability solution, you can use a database in that group as a data source in an Analysis Services tabular or multidimensional solution.</span></span> <span data-ttu-id="3fa39-105">可用性データベースを使用すると、次の Analysis Services の操作はすべて予期したとおりに動作します。その操作とは、データの処理またはインポート、リレーショナル データへの直接クエリ (ROLAP ストレージまたは DirectQuery モードを使用)、および書き戻しです。</span><span class="sxs-lookup"><span data-stu-id="3fa39-105">All of the following Analysis Services operations work as expected when using an availability database: processing or importing data, querying relational data directly (using ROLAP storage or DirectQuery mode), and writeback.</span></span>  
  
 <span data-ttu-id="3fa39-106">処理とクエリは、読み取り専用のワークロードです。</span><span class="sxs-lookup"><span data-stu-id="3fa39-106">Processing and querying are read-only workloads.</span></span> <span data-ttu-id="3fa39-107">このようなワークロードを読み取り可能なセカンダリ レプリカにオフロードすると、パフォーマンスが向上することがあります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-107">You can improve performance by offloading these workloads to a readable secondary replica.</span></span> <span data-ttu-id="3fa39-108">このシナリオには、追加の構成が必要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-108">Additional configuration is required for this scenario.</span></span> <span data-ttu-id="3fa39-109">このトピックのチェック リストを使用して、すべての手順に従っていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="3fa39-109">Use the checklist in this topic to ensure you follow all the steps.</span></span>  
  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="3fa39-110">前提条件</span><span class="sxs-lookup"><span data-stu-id="3fa39-110">Prerequisites</span></span>  
 <span data-ttu-id="3fa39-111">すべてのレプリカで SQL Server ログインが必要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-111">You must have a SQL Server login on all replicas.</span></span> <span data-ttu-id="3fa39-112">可用性グループ、リスナー、およびデータベースを構成するには **sysadmin** である必要がありますが、ユーザーの場合は Analysis Services クライアントからデータベースにアクセスするためには **db_datareader** アクセス許可のみ必要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-112">You must be a **sysadmin** to configure availability groups, listeners, and databases, but users only need **db_datareader** permissions to access the database from an Analysis Services client.</span></span>  
  
 <span data-ttu-id="3fa39-113">表形式データ ストリーム (TDS) プロトコル Version 7.4 以降をサポートするデータ プロバイダー (SQL Server Native Client 11.0、Data Provider for SQL Server in .NET Framework 4.02 など) を使用します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-113">Use a data provider that supports the tabular data stream (TDS) protocol version 7.4 or newer, such as the SQL Server Native Client 11.0 or the Data Provider for SQL Server in .NET Framework 4.02.</span></span>  
  
 <span data-ttu-id="3fa39-114">**(読み取り専用ワークロードの場合)**。</span><span class="sxs-lookup"><span data-stu-id="3fa39-114">**(For read-only workloads)**.</span></span> <span data-ttu-id="3fa39-115">セカンダリ レプリカのロールは、読み取り専用接続に対して構成されている必要があり、可用性グループはルーティング リストを持つ必要があり、Analysis Services データ ソース内の接続は可用性グループのリスナーを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-115">The secondary replica role must be configured for read-only connections, the availability group must have a routing list, and the connection in the Analysis Services data source must specify the availability group listener.</span></span> <span data-ttu-id="3fa39-116">手順はこのトピックで説明します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-116">Instructions are provided in this topic.</span></span>  
  
##  <a name="checklist-use-a-secondary-replica-for-read-only-operations"></a><a name="bkmk_UseSecondary"></a> <span data-ttu-id="3fa39-117">チェック リスト: 読み取り専用操作でセカンダリ レプリカを使用する</span><span class="sxs-lookup"><span data-stu-id="3fa39-117">Checklist: Use a secondary replica for read-only operations</span></span>  
 <span data-ttu-id="3fa39-118">Analysis Services ソリューションに書き戻しが含まれていない場合は、読み取り可能なセカンダリ レプリカを使用するようにデータ ソース接続を構成できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-118">Unless your Analysis Services solution includes writeback, you can configure a data source connection to use a readable secondary replica.</span></span> <span data-ttu-id="3fa39-119">高速ネットワーク接続がある場合、セカンダリ レプリカのデータ待機時間は非常に短くなり、プライマリ レプリカとほとんど同一のデータを持つことになります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-119">If you have a fast network connection, the secondary replica has very low data latency, providing nearly identical data as the primary replica.</span></span> <span data-ttu-id="3fa39-120">Analysis Services 操作のためにセカンダリ レプリカを使用すると、プライマリ レプリカ上の読み取りと書き込みの競合が削減され、可用性グループのセカンダリ レプリカの利用率が向上します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-120">By using the secondary replica for Analysis Services operations, you can reduce read-write contention on the primary replica and get better utilization of secondary replicas in your availability group.</span></span>  
  
 <span data-ttu-id="3fa39-121">既定では、プライマリ レプリカへの読み取り/書き込みアクセスと読み取りを目的としたアクセスの両方が許可され、セカンダリ レプリカへの接続は許可されません。</span><span class="sxs-lookup"><span data-stu-id="3fa39-121">By default, both read-write and read-intent access are allowed to the primary replica and no connections are allowed to secondary replicas.</span></span> <span data-ttu-id="3fa39-122">セカンダリ レプリカへの読み取り専用クライアント接続をセットアップするには、さらに構成が必要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-122">Additional configuration is required to set up a read-only client connection to a secondary replica.</span></span> <span data-ttu-id="3fa39-123">構成には、セカンダリ レプリカのプロパティ設定と、読み取り専用ルーティング リストを定義する T-SQL スクリプトの実行が必要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-123">Configuration requires setting properties on the secondary replica and running a T-SQL script that defines a read-only routing list.</span></span> <span data-ttu-id="3fa39-124">次のプロシージャを使用すると、両方の手順を確実に実行できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-124">Use the following procedures to ensure you have performed both steps.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3fa39-125">次の手順は、既存の AlwaysOn 可用性グループとデータベースがあることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-125">The following steps assume an existing AlwaysOn availability group and databases.</span></span> <span data-ttu-id="3fa39-126">新しいグループを構成する場合は、新しい可用性グループ ウィザードを使用してグループを作成し、データベースを結合します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-126">If you are configuring a new group, use the New Availability Group Wizard to create the group and join the databases.</span></span> <span data-ttu-id="3fa39-127">このウィザードでは、前提条件のチェック、それぞれの手順のガイド、および初期同期を実行します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-127">The wizard checks for prerequisites, provides guidance for each step, and performs the initial synchronization.</span></span> <span data-ttu-id="3fa39-128">詳細については、「[新しい可用性グループ ウィザードの使用 &#40;SQL Server Management Studio&#41;](use-the-availability-group-wizard-sql-server-management-studio.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3fa39-128">For more information, see [Use the Availability Group Wizard &#40;SQL Server Management Studio&#41;](use-the-availability-group-wizard-sql-server-management-studio.md).</span></span>  
  
#### <a name="step-1-configure-access-on-an-availability-replica"></a><span data-ttu-id="3fa39-129">手順 1. 可用性レプリカに対してアクセスを構成する</span><span class="sxs-lookup"><span data-stu-id="3fa39-129">Step 1: Configure access on an availability replica</span></span>  
  
1.  <span data-ttu-id="3fa39-130">オブジェクト エクスプローラーで、プライマリ レプリカをホストするサーバー インスタンスに接続し、サーバー ツリーを展開します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-130">In Object Explorer, connect to the server instance that hosts the primary replica, and expand the server tree.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3fa39-131">これらの手順は「[可用性レプリカでの読み取り専用アクセスの構成 &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md)」に記載されており、このタスクを実行するための追加情報と別の手順を示しています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-131">These steps are taken from [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md), which provides additional information and alternative instructions for performing this task.</span></span>  
  
2.  <span data-ttu-id="3fa39-132">**[AlwaysOn 高可用性]** ノードと **[可用性グループ]** ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-132">Expand the **AlwaysOn High Availability** node and the **Availability Groups** node.</span></span>  
  
3.  <span data-ttu-id="3fa39-133">変更するレプリカが含まれる可用性グループをクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-133">Click the availability group whose replica you want to change.</span></span> <span data-ttu-id="3fa39-134">[ **可用性レプリカ**] を展開します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-134">Expand **Availability Replicas**.</span></span>  
  
4.  <span data-ttu-id="3fa39-135">セカンダリ レプリカを右クリックし、[ **プロパティ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-135">Right-click the secondary replica, and click **Properties**.</span></span>  
  
5.  <span data-ttu-id="3fa39-136">[ **可用性レプリカ プロパティ** ] ダイアログ ボックスで、セカンダリ ロールの接続アクセスを次のように変更します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-136">In the **Availability Replica Properties** dialog box, change the connection access for the secondary role, as follows:</span></span>  
  
    -   <span data-ttu-id="3fa39-137">[ **読み取り可能なセカンダリ** ] ボックスの一覧の [ **読み取り目的のみ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-137">In the **Readable secondary** drop list, select **Read-intent only**.</span></span>  
  
    -   <span data-ttu-id="3fa39-138">[ **プライマリ ロールでの接続** ] ボックスの一覧の [ **すべての接続を許可**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-138">In the **Connections in primary role** drop list, select **Allow all connections**.</span></span> <span data-ttu-id="3fa39-139">既定値です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-139">This is the default.</span></span>  
  
    -   <span data-ttu-id="3fa39-140">必要に応じて、[ **可用性モード** ] ボックスの一覧の [ **同期コミット**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-140">Optionally, in **Availability mode** drop list, select **Synchronous commit**.</span></span> <span data-ttu-id="3fa39-141">この手順は必須ではありませんが、これを設定するとプライマリ レプリカとセカンダリ レプリカの間にデータ パリティがあることが確認できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-141">This step is not required, but setting it ensures that there is data parity between the primary and secondary replica.</span></span>  
  
         <span data-ttu-id="3fa39-142">このプロパティは、計画的なフェールオーバーに必須です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-142">This property is also a requirement for planned failover.</span></span> <span data-ttu-id="3fa39-143">テスト目的で計画的な手動フェールオーバーを実行する場合、プライマリ レプリカとセカンダリ レプリカの両方に対して [ **可用性モード** ] を [ **同期コミット** ] に設定します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-143">If you want to perform a planned manual failover for testing purposes, set **Availability mode** to **Synchronous commit** for both the primary and secondary replica.</span></span>  
  
#### <a name="step-2-configure-read-only-routing"></a><span data-ttu-id="3fa39-144">手順 2. 読み取り専用ルーティングを構成する</span><span class="sxs-lookup"><span data-stu-id="3fa39-144">Step 2: Configure read-only routing</span></span>  
  
1.  <span data-ttu-id="3fa39-145">プライマリ レプリカに接続します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-145">Connect to the primary replica.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3fa39-146">これらの手順は「[可用性グループの読み取り専用ルーティングの構成 &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md)」に記載されており、このタスクを実行するための追加情報と別の手順を示しています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-146">These steps are taken from [Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md), which provides additional information and alternative instructions for performing this task.</span></span>  
  
2.  <span data-ttu-id="3fa39-147">クエリ ウィンドウを開き、次のスクリプトを貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-147">Open a query window and paste in the following script.</span></span> <span data-ttu-id="3fa39-148">このスクリプトでは、次の 3 つのことを行います。セカンダリ レプリカへの読み取り可能な接続を有効にし (既定ではオフ)、読み取り専用ルーティング URL を設定し、接続要求をどのように送るかを優先度付けするルーティング リストを作成します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-148">This script does three things: enables readable connections to a secondary replica (which is off by default), sets the read-only routing URL, and creates the routing list that prioritizes how connection requests are directed.</span></span>  <span data-ttu-id="3fa39-149">読み取り可能な接続を許可する最初のステートメントは、 [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)]でプロパティを設定済みの場合は冗長ですが、完全を期すために含まれています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-149">The first statement, allowing readable connections, is redundant if you already set the properties in [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], but are included for completeness.</span></span>  
  
    ```  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER01' WITH   
    (SECONDARY_ROLE (ALLOW_CONNECTIONS = READ_ONLY));  
  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER01' WITH   
    (SECONDARY_ROLE (READ_ONLY_ROUTING_URL = N'TCP://COMPUTER01.contoso.com:1433'));  
  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER02' WITH   
    (SECONDARY_ROLE (ALLOW_CONNECTIONS = READ_ONLY));  
  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER02' WITH   
    (SECONDARY_ROLE (READ_ONLY_ROUTING_URL = N'TCP://COMPUTER02.contoso.com:1433'));  
  
    ALTER AVAILABILITY GROUP [AG1]   
    MODIFY REPLICA ON  
    N'COMPUTER01' WITH   
    (PRIMARY_ROLE (READ_ONLY_ROUTING_LIST=('COMPUTER02','COMPUTER01')));  
  
    ALTER AVAILABILITY GROUP [AG1]   
    MODIFY REPLICA ON  
    N'COMPUTER02' WITH   
    (PRIMARY_ROLE (READ_ONLY_ROUTING_LIST=('COMPUTER01','COMPUTER02')));  
    GO  
    ```  
  
3.  <span data-ttu-id="3fa39-150">個別の配置に対応する値でプレースホルダーを置換して、スクリプトを修正します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-150">Modify the script, replacing placeholders with values that are valid for your deployment:</span></span>  
  
    -   <span data-ttu-id="3fa39-151">'Computer01' を、プライマリ レプリカをホストしているサーバー インスタンスの名前で置換します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-151">Replace 'Computer01' with the name of the server instance that hosts the primary replica.</span></span>  
  
    -   <span data-ttu-id="3fa39-152">'Computer02' を、セカンダリ レプリカをホストしているサーバー インスタンスの名前で置換します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-152">Replace 'Computer02' with the name of the server instance that hosts the secondary replica.</span></span>  
  
    -   <span data-ttu-id="3fa39-153">ドメインの名前で 'contoso.com' を置換するか、すべてのコンピューターが同じドメインに含まれている場合はスクリプトからこのプレースホルダーを削除します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-153">Replace 'contoso.com' with the name of your domain, or omit it from the script if all computers are in the same domain.</span></span> <span data-ttu-id="3fa39-154">リスナーが既定のポートを使用している場合、ポート番号を保持します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-154">Keep the port number if the listener is using the default port.</span></span> <span data-ttu-id="3fa39-155">リスナーが実際に使用したポートは、 [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)]のプロパティ ページの一覧に示されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-155">The port that is actually used by the listener is listed in the properties page in [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)].</span></span>  
  
4.  <span data-ttu-id="3fa39-156">スクリプトを実行します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-156">Execute the script.</span></span>  
  
     <span data-ttu-id="3fa39-157">次に、構成したグループから、データベースを使用する Analysis Services モデルにデータ ソースを作成します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-157">Next, create a data source in an Analysis Services model that uses a database from the group you just configured.</span></span>  
  
##  <a name="create-an-analysis-services-data-source-using-an-alwayson-availability-database"></a><a name="bkmk_ssasAODB"></a><span data-ttu-id="3fa39-158">AlwaysOn 可用性データベースを使用して Analysis Services データソースを作成する</span><span class="sxs-lookup"><span data-stu-id="3fa39-158">Create an Analysis Services data source using an AlwaysOn availability database</span></span>  
 <span data-ttu-id="3fa39-159">ここでは、可用性グループのデータベースに接続する Analysis Services データ ソースを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-159">This section explains how to create an Analysis Services data source that connects to a database in an availability group.</span></span> <span data-ttu-id="3fa39-160">これらの指示を使用して、前のセクションの手順に基づいて構成したプライマリ レプリカ (既定) または読み取り可能なセカンダリ レプリカへの接続を構成できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-160">You can use these instructions to configure a connection to either a primary replica (default) or a readable secondary replica that you configured based on steps in a previous section.</span></span> <span data-ttu-id="3fa39-161">AlwaysOn 構成設定、およびクライアントで設定された接続プロパティによって、プライマリ レプリカとセカンダリ レプリカのどちらを使用するかが決まります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-161">AlwaysOn configuration settings, plus the connection properties set in the client, will determine whether a primary or secondary replica is used.</span></span>  
  
1.  <span data-ttu-id="3fa39-162">[!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)]の Analysis Services の多次元およびデータ マイニング モデル プロジェクトで、[ **データ ソース** ] を右クリックして [ **新しいデータ ソース**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-162">In [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)], in an Analysis Services Multidimensional and Data Mining Model project, right-click **Data Sources** and select **New Data Source**.</span></span> <span data-ttu-id="3fa39-163">新しいデータ ソースを作成するには、[ **新規作成** ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-163">Click **New** to create a new data source.</span></span>  
  
     <span data-ttu-id="3fa39-164">または、テーブル モデル プロジェクトの場合、[モデル] メニューをクリックし、[ **データ ソースからのインポート**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-164">Alternatively, for a tabular model project, click the Model menu, and then click **Import from Data Source**.</span></span>  
  
2.  <span data-ttu-id="3fa39-165">接続マネージャーで、プロバイダーには、表形式のデータ ストリーム (TDS) プロトコルをサポートするプロバイダーを選択します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-165">In Connection Manager, in Provider, choose a provider that supports the Tabular Data Stream (TDS) protocol.</span></span> <span data-ttu-id="3fa39-166">SQL Server Native Client 11.0 は、このプロトコルをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-166">The SQL Server Native Client 11.0 supports this protocol.</span></span>  
  
3.  <span data-ttu-id="3fa39-167">接続マネージャーで、[サーバー名] に *可用性グループ リスナー*の名前を入力し、グループで使用可能なデータベースを選択します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-167">In Connection Manager, in Server Name, enter the name of the *availability group listener*, and then choose a database that is available in the group.</span></span>  
  
     <span data-ttu-id="3fa39-168">可用性グループ リスナーは、読み取り/書き込み要求の場合はクライアント接続をプライマリ レプリカにリダイレクトし、接続文字列内で読み取りを目的と指定している場合はセカンダリ レプリカにリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-168">The availability group listener redirects a client connection to a primary replica for read-write requests or to a secondary replica if you specify read-intent in the connection string.</span></span> <span data-ttu-id="3fa39-169">フェールオーバー中にレプリカ ロールが変化する (プライマリがセカンダリになり、セカンダリがプライマリになる) ため、リスナーを常に指定してそれに従ってクライアント接続がリダイレクトされるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-169">Because replica roles will change during a failover (where the primary becomes the secondary and a secondary becomes a primary), you should always specify the listener so that the client connection is redirected accordingly.</span></span>  
  
     <span data-ttu-id="3fa39-170">可用性グループ リスナーの名前を判断するには、データベース管理者に問い合わせるか、可用性グループ内のインスタンスに接続して AlwaysOn 可用性設定を表示します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-170">To determine the name of the availability group listener, you can either ask a database administrator or connect to an instance in the availability group and view its AlwaysOn availability configuration.</span></span> <span data-ttu-id="3fa39-171">下のスクリーン ショットでは、可用性グループ リスナーは **AdventureWorks2**です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-171">In the screenshot below, the availability group listener is **AdventureWorks2**.</span></span>  
  
     <span data-ttu-id="3fa39-172">![Management Studio の AlwaysOn 可用性フォルダー](../../media/ssas-alwaysoninfoinssms.png "Management Studio の AlwaysOn 可用性フォルダー")</span><span class="sxs-lookup"><span data-stu-id="3fa39-172">![AlwaysOn Availability folder in Management Studio](../../media/ssas-alwaysoninfoinssms.png "AlwaysOn Availability folder in Management Studio")</span></span>  
  
4.  <span data-ttu-id="3fa39-173">また、接続マネージャーで、左側のナビゲーション ウィンドウで [ **すべて** ] をクリックしてデータ プロバイダーのプロパティ グリッドを表示します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-173">Still in Connection Manager, click **All** in the left navigation pane to view the property grid of data provider.</span></span>  
  
     <span data-ttu-id="3fa39-174">セカンダリ レプリカへの読み取り専用クライアント接続を構成する場合は、[ **Application Intent** ] を [ **READONLY** ] に設定します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-174">Set **Application Intent** to **READONLY** if you are configuring a read-only client connection to a secondary replica.</span></span> <span data-ttu-id="3fa39-175">または、既定の [ **READWRITE** ] を保持して接続をプライマリ レプリカにリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-175">Otherwise, keep the **READWRITE** default to redirect the connection to the primary replica.</span></span>  
  
5.  <span data-ttu-id="3fa39-176">[権限借用情報] では [ **特定の Windows ユーザー名とパスワードを使用する**] をクリックし、データベースに対して少なくとも **db_datareader** 権限を持つ、Windows ドメイン ユーザー アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-176">In Impersonation Information, select **Use a specific Windows user name and password**, and then enter a Windows domain user account that has a minimum of **db_datareader** permissions on the database.</span></span>  
  
     <span data-ttu-id="3fa39-177">[ **現在のユーザーの資格情報を使用する** ] または [ **継承する**] を選択しないでください。</span><span class="sxs-lookup"><span data-stu-id="3fa39-177">Do not choose **Use the credentials of the current user** or **Inherit**.</span></span> <span data-ttu-id="3fa39-178">[ **サービス アカウントを使用する**] を選択できますが、そのアカウントがデータベースに対する読み取り権限を持つ場合のみです。</span><span class="sxs-lookup"><span data-stu-id="3fa39-178">You can choose **Use the service account**, but only if that account has read permissions on the database.</span></span>  
  
     <span data-ttu-id="3fa39-179">データ ソースを完了してデータ ソース ウィザードを閉じます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-179">Finish the data source and close the Data Source Wizard.</span></span>  
  
6.  <span data-ttu-id="3fa39-180">接続文字列に **MultiSubnetFailover=Yes** を追加して、アクティブなサーバーを迅速に検出して接続できるようにします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-180">Add **MultiSubnetFailover=Yes** to the connection string to provide faster detection and connection to the active server.</span></span> <span data-ttu-id="3fa39-181">この接続プロパティの詳細については、「 [SQL Server Native Client の HADR サポート](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3fa39-181">For more information about this property, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
     <span data-ttu-id="3fa39-182">このプロパティは、プロパティ グリッドには表示されません。</span><span class="sxs-lookup"><span data-stu-id="3fa39-182">This property is not visible in the property grid.</span></span> <span data-ttu-id="3fa39-183">プロパティを追加するには、データ ソースを右クリックして [ **コードの表示**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-183">To add the property, right-click the data source and choose **View Code**.</span></span> <span data-ttu-id="3fa39-184">接続文字列に `MultiSubnetFailover=Yes` を追加します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-184">Add `MultiSubnetFailover=Yes` to the connection string.</span></span>  
  
 <span data-ttu-id="3fa39-185">これで、データ ソースが定義されました。</span><span class="sxs-lookup"><span data-stu-id="3fa39-185">The data source is now defined.</span></span> <span data-ttu-id="3fa39-186">これで、モデルを構築し、データ ソース ビューを開始するか、テーブル モデルの場合はリレーションシップを作成できるようになります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-186">You can now proceed to build a model, starting with the data source view, or in the case of tabular models, creating relationships.</span></span> <span data-ttu-id="3fa39-187">データを可用性データベースから取得する必要があるときに (たとえば、ソリューションの処理や導入の準備ができたとき)、構成をテストしてセカンダリ レプリカからデータにアクセスできることを確認できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-187">When you are at a point where data must be retrieved from the availability database (for example when you are ready to process or deploy the solution), you can test the configuration to verify data is accessed from the secondary replica.</span></span>  
  
##  <a name="test-the-configuration"></a><a name="bkmk_test"></a><span data-ttu-id="3fa39-188">構成をテストする</span><span class="sxs-lookup"><span data-stu-id="3fa39-188">Test the configuration</span></span>  
 <span data-ttu-id="3fa39-189">Analysis Services でセカンダリ レプリカを構成してデータ ソース接続を作成したら、処理とクエリのコマンドがセカンダリ レプリカにリダイレクトされていることを確認できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-189">After you configure the secondary replica and create a data source connection in Analysis Services, you can confirm that processing and query commands are redirected to the secondary replica.</span></span> <span data-ttu-id="3fa39-190">また、計画された手動フェールオーバーを実行して、このシナリオの復元計画を確認できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-190">You can also perform a planned manual failover to verify your recovery plan for this scenario.</span></span>  
  
#### <a name="step-1-confirm-the-data-source-connection-is-redirected-to-the-secondary-replica"></a><span data-ttu-id="3fa39-191">手順 1. データ ソース接続がセカンダリ レプリカにリダイレクトされることを確認する</span><span class="sxs-lookup"><span data-stu-id="3fa39-191">Step 1: Confirm the data source connection is redirected to the secondary replica</span></span>  
  
1.  <span data-ttu-id="3fa39-192">SQL Server Profiler を開始して、セカンダリ レプリカをホストしている SQL Server インスタンスに接続します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-192">Start SQL Server Profiler and connect to the SQL Server instance hosting the secondary replica.</span></span>  
  
     <span data-ttu-id="3fa39-193">トレースを実行すると、`SQL:BatchStarting` イベントおよび `SQL:BatchCompleting` イベントによって、データベース エンジン インスタンス上で実行している Analysis Services から発行されたクエリが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-193">As the trace runs, the `SQL:BatchStarting` and `SQL:BatchCompleting` events will show the queries issued from Analysis Services that are executing on the database engine instance.</span></span> <span data-ttu-id="3fa39-194">これらのイベントは既定で選択されるため、トレースを開始すればよいだけです。</span><span class="sxs-lookup"><span data-stu-id="3fa39-194">These events are selected by default so all you need to do is start the trace.</span></span>  
  
2.  <span data-ttu-id="3fa39-195">[!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)]で、テストするデータ ソース接続を含む Analysis Services プロジェクトまたはソリューションを開きます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-195">In [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)], open the Analysis Services project or solution containing a data source connection you want to test.</span></span> <span data-ttu-id="3fa39-196">データ ソースが可用性グループのリスナー (グループのインスタンスではなく) を指定していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-196">Be sure that the data source specifies the availability group listener and not an instance in the group.</span></span>  
  
     <span data-ttu-id="3fa39-197">このステップは重要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-197">This step is important.</span></span> <span data-ttu-id="3fa39-198">サーバー インスタンス名を指定している場合、セカンダリ レプリカへのルーティングは発生しません。</span><span class="sxs-lookup"><span data-stu-id="3fa39-198">Routing to the secondary replica will not occur if you specify a server instance name.</span></span>  
  
3.  <span data-ttu-id="3fa39-199">SQL Server Profiler と [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)] を並べて表示できるように、アプリケーション ウィンドウを整列します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-199">Arrange the application windows so that you can view SQL Server Profiler and [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)] side by side.</span></span>  
  
4.  <span data-ttu-id="3fa39-200">ソリューションを配置し、完了したらトレースを停止します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-200">Deploy the solution, and when it completes, stop the trace.</span></span>  
  
     <span data-ttu-id="3fa39-201">トレース ウィンドウには、アプリケーション **Microsoft SQL Server Analysis Services**からのイベントが表示されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-201">In the trace window, you should see events from the application **Microsoft SQL Server Analysis Services**.</span></span> <span data-ttu-id="3fa39-202">セカンダリ レプリカをホストしているサーバー インスタンスのデータベースからデータを取得する `SELECT` ステートメントが表示されます (リスナー経由でセカンダリ レプリカに接続された場合)。</span><span class="sxs-lookup"><span data-stu-id="3fa39-202">You should see `SELECT` statements that retrieve data from a database on the server instance that hosts the secondary replica, proving that the connection was made via the listener to the secondary replica.</span></span>  
  
#### <a name="step-2-perform-a-planned-failover-to-test-the-configuration"></a><span data-ttu-id="3fa39-203">手順 2. 計画されたフェールオーバーを実行して構成をテストする</span><span class="sxs-lookup"><span data-stu-id="3fa39-203">Step 2: Perform a planned failover to test the configuration</span></span>  
  
1.  <span data-ttu-id="3fa39-204">[!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] ではプライマリ レプリカとセカンダリ レプリカをチェックして、その両方で同期コミット モードが構成されていて、現在同期していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-204">In [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] check the primary and secondary replicas to ensure that both are configured for synchronous-commit mode and are currently synchronized.</span></span>  
  
     <span data-ttu-id="3fa39-205">次の手順は、セカンダリ レプリカに同期コミット モードが構成されていることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-205">The following steps assume a secondary replica is configured for synchronous commit.</span></span>  
  
     <span data-ttu-id="3fa39-206">同期を検証するには、プライマリ レプリカおよびセカンダリ レプリカをホストする各インスタンスへの接続を開き、[データベース] フォルダーを展開し、各レプリカ内でデータベースの名前に [**(同期済み)**] および [**(同期中)**] と追加されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-206">To verify synchronization, open a connection to each instance that hosts the primary and secondary replicas, expand the Databases folder, and ensure that the database has **(Synchronized)** and **(Synchronizing)** appended to its name in each replica.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3fa39-207">これらの手順は「[可用性グループの計画的な手動フェールオーバーの実行 &#40;SQL Server&#41;](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md)」に記載されており、このタスクを実行するための追加情報と別の手順を示しています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-207">These steps are taken from [Perform a Planned Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md), which provides additional information and alternative instructions for performing this task.</span></span>  
  
2.  <span data-ttu-id="3fa39-208">SQL Server Profiler で、各レプリカに対してトレースを開始して、それらのトレースを並べて表示します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-208">In SQL Server Profiler, start traces for each replica and view the traces side-by-side.</span></span> <span data-ttu-id="3fa39-209">次の手順では、トレースを比較し、Analysis Services からの処理またはクエリのために使用した SQL クエリが 1 つのレプリカから別のレプリカに切り替わっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-209">In the following steps, you will compare traces, confirming that the SQL queries used for processing or querying from Analysis Services switch from one replica to the other.</span></span>  
  
3.  <span data-ttu-id="3fa39-210">Analysis Services 内から処理またはクエリ コマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-210">Execute a processing or query command from within Analysis Services.</span></span> <span data-ttu-id="3fa39-211">データ ソースを読み取り専用接続用に構成したため、セカンダリ レプリカでのコマンド実行が表示されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-211">Because you configured the data source for a read-only connection, you should see the command execute on the secondary replica.</span></span>  
  
4.  <span data-ttu-id="3fa39-212">[!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)]で、セカンダリ レプリカに接続します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-212">In [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], connect to the secondary replica.</span></span>  
  
5.  <span data-ttu-id="3fa39-213">**[AlwaysOn 高可用性]** ノードと **[可用性グループ]** ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-213">Expand the **AlwaysOn High Availability** node and the **Availability Groups** node.</span></span>  
  
6.  <span data-ttu-id="3fa39-214">フェールオーバーする [可用性グループ] ノードを右クリックし、 **[フェールオーバー]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-214">Right-click the availability group to be failed over, and select the **Failover** command.</span></span> <span data-ttu-id="3fa39-215">可用性グループのフェールオーバー ウィザードが起動します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-215">This starts the Fail Over Availability Group Wizard.</span></span> <span data-ttu-id="3fa39-216">このウィザードを使用して、どのレプリカを新しいプライマリ レプリカにするか選択します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-216">Use the wizard to choose which replica to make the new primary replica.</span></span>  
  
7.  <span data-ttu-id="3fa39-217">フェールオーバーが正常に実行されたことを確認します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-217">Confirm that failover succeeded:</span></span>  
  
    -   <span data-ttu-id="3fa39-218">[!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)]で、可用性グループを展開して (プライマリ) 指定子と (セカンダリ) 指定子を表示します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-218">In [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], expand the availability groups to view the (primary) and (secondary) designations.</span></span> <span data-ttu-id="3fa39-219">以前プライマリ レプリカだったインスタンスが、セカンダリ レプリカになっています。</span><span class="sxs-lookup"><span data-stu-id="3fa39-219">The instance that was previously a primary replica should now be a secondary replica.</span></span>  
  
    -   <span data-ttu-id="3fa39-220">ダッシュボードを表示して、正常性の問題が検出されていないかどうか判断します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-220">View the dashboard to determine if any health issues were detected.</span></span> <span data-ttu-id="3fa39-221">可用性グループを右クリックし、[**ダッシュボードの表示**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-221">Right-click the availability group and select **Show Dashboard**.</span></span>  
  
8.  <span data-ttu-id="3fa39-222">バックエンドでフェールオーバーが完了するまで、1、2 分待ちます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-222">Wait one or two minutes for the failover to complete on the backend.</span></span>  
  
9. <span data-ttu-id="3fa39-223">Analysis Services ソリューションで処理またはクエリ コマンドを繰り返し、SQL Server Profiler にトレースを並べて確認します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-223">Repeat the processing or query command in the Analysis Services solution, and then watch the traces side by side in SQL Server Profiler.</span></span> <span data-ttu-id="3fa39-224">その他のインスタンス (新しくセカンダリ レプリカになったインスタンス) での処理の証拠が表示されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-224">You should see evidence of processing on the other instance, which is now the new secondary replica.</span></span>  
  
##  <a name="what-happens-after-a-failover-occurs"></a><a name="bkmk_whathappens"></a><span data-ttu-id="3fa39-225">フェールオーバーが発生した後の動作</span><span class="sxs-lookup"><span data-stu-id="3fa39-225">What happens after a failover occurs</span></span>  
 <span data-ttu-id="3fa39-226">フェールオーバー中に、セカンダリ レプリカはプライマリ ロールに移行し、元のプライマリ レプリカはセカンダリ レプリカに移行します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-226">During a failover, a secondary replica transitions to the primary role and the former primary replica transitions to the secondary role.</span></span> <span data-ttu-id="3fa39-227">すべてのクライアント接続が終了して、可用性グループ リスナーの所有権はプライマリ レプリカ ロールと共に新しい SQL Server インスタンスに移動し、リスナー エンドポイントは新しいインスタンスの仮想 IP アドレスと TCP ポートにバインドされます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-227">All client connections are terminated, ownership of the availability group listener moves with the primary replica role to a new SQL Server instance, and the listener endpoint is bound to the new instance's virtual IP addresses and TCP ports.</span></span> <span data-ttu-id="3fa39-228">詳細については、「[可用性レプリカに対するクライアント接続アクセスについて &#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3fa39-228">For more information, see [About Client Connection Access to Availability Replicas &#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md).</span></span>  
  
 <span data-ttu-id="3fa39-229">処理中にフェールオーバーが発生した場合、次のエラーが Analysis Services のログ ファイルまたは表示ウィンドウに発生します。"OLE DB エラー: OLE DB または ODBC エラー: 通信リンクが失敗しました; 08S01; TPC プロバイダー : 既存の接続はリモート ホストに強制的に切断されました。</span><span class="sxs-lookup"><span data-stu-id="3fa39-229">If failover occurs during processing, the following error occurs in Analysis Services in the log file or output window: "OLE DB error: OLE DB or ODBC error: Communication link failure; 08S01; TPC Provider: An existing connection was forcibly closed by the remote host.</span></span> <span data-ttu-id="3fa39-230">; 08S01。"</span><span class="sxs-lookup"><span data-stu-id="3fa39-230">; 08S01."</span></span>  
  
 <span data-ttu-id="3fa39-231">数分待ってから再試行すると、このエラーは解決されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-231">This error should resolve if you wait a minute and try again.</span></span> <span data-ttu-id="3fa39-232">可用性グループが読み取り可能なセカンダリ レプリカに対して正しく構成されている場合、処理を再試行すると、新しいセカンダリ レプリカで再開されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-232">If the availability group is configured correctly for readable secondary replica, processing will resume on the new secondary replica when you retry processing.</span></span>  
  
 <span data-ttu-id="3fa39-233">エラーが解決しない場合、多くは構成の問題が原因です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-233">Persistent errors are most likely due to a configuration problem.</span></span> <span data-ttu-id="3fa39-234">T-SQL スクリプトを再実行すると、セカンダリ レプリカのルーティング リスト、読み取り専用ルーティング URL、および読み取り専用の問題を解決できます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-234">You can try re-running the T-SQL script to resolve problems with the routing list, read-only routing URLs, and read-intent on the secondary replica.</span></span> <span data-ttu-id="3fa39-235">また、プライマリ レプリカがすべての接続を許可することを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-235">You should also verify that the primary replica allows all connections.</span></span>  
  
##  <a name="writeback-when-using-an-alwayson-availability-database"></a><a name="bkmk_writeback"></a><span data-ttu-id="3fa39-236">AlwaysOn 可用性データベースを使用する場合の書き戻し</span><span class="sxs-lookup"><span data-stu-id="3fa39-236">Writeback when using an AlwaysOn availability database</span></span>  
 <span data-ttu-id="3fa39-237">書き戻しは、Excel で What If 分析をサポートする Analysis Services 機能です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-237">Writeback is an Analysis Services feature that supports What If analysis in Excel.</span></span> <span data-ttu-id="3fa39-238">また、一般にはカスタム アプリケーションの予算タスクおよび予測タスクに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-238">It is also commonly used for budgeting and forecasting tasks in custom applications.</span></span>  
  
 <span data-ttu-id="3fa39-239">書き戻しのサポートには、READWRITE クライアント接続が必要です。</span><span class="sxs-lookup"><span data-stu-id="3fa39-239">Support for writeback requires a READWRITE client connection.</span></span> <span data-ttu-id="3fa39-240">Excel で、読み取り専用接続で書き戻しを試みた場合は、次のエラーが表示されます。"外部データ ソースのデータを取得できませんでした。"</span><span class="sxs-lookup"><span data-stu-id="3fa39-240">In Excel, if you attempt to write back on a read-only connection, the following error will occur: "Data could not be retrieved from the external data source."</span></span> <span data-ttu-id="3fa39-241">"外部データ ソースのデータを取得できませんでした。"</span><span class="sxs-lookup"><span data-stu-id="3fa39-241">"Data could not be retrieved from the external data source."</span></span>  
  
 <span data-ttu-id="3fa39-242">読み取り可能なセカンダリ レプリカに常時アクセスするように接続を構成している場合、プライマリ レプリカへの READWRITE 接続を使用する新しい接続を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3fa39-242">If you configured a connection to always access a readable secondary replica, you must now configure a new connection that uses a READWRITE connection to the primary replica.</span></span>  
  
 <span data-ttu-id="3fa39-243">そのために、Analysis Services モデルに追加のデータ ソースを作成して、読み取りと書き込みの接続をサポートします。</span><span class="sxs-lookup"><span data-stu-id="3fa39-243">To do this, create an additional data source in an Analysis Services model to support the read-write connection.</span></span> <span data-ttu-id="3fa39-244">追加のデータ ソースを作成するとき、読み取り専用接続で指定したものと同じリスナー名とデータベースを使用しますが、 **Application Intent**を修正しないで、READWRITE 接続をサポートする既定値を保持します。</span><span class="sxs-lookup"><span data-stu-id="3fa39-244">When creating the additional data source, use the same listener name and database that you specified in the read-only connection, but instead of modifying **Application Intent**, keep the default that supports READWRITE connections.</span></span> <span data-ttu-id="3fa39-245">読み取りと書き込みのデータ ソースに基づいたデータ ソース ビューに新しいファクトまたはディメンション テーブルを追加し、新しいテーブルへの書き戻しを有効にできます。</span><span class="sxs-lookup"><span data-stu-id="3fa39-245">You can now add new fact or dimension tables to your data source view that are based on the read-write data source, and then enable writeback on the new tables.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3fa39-246">参照</span><span class="sxs-lookup"><span data-stu-id="3fa39-246">See Also</span></span>  
 <span data-ttu-id="3fa39-247">[可用性グループ リスナー、クライアント接続、およびアプリケーションのフェールオーバー &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span><span class="sxs-lookup"><span data-stu-id="3fa39-247">[Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span></span>  
 <span data-ttu-id="3fa39-248">[アクティブなセカンダリ: 読み取り可能なセカンダリレプリカ &#40;AlwaysOn 可用性グループ&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="3fa39-248">[Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) </span></span>  
 <span data-ttu-id="3fa39-249">[AlwaysOn 可用性グループ &#40;SQL Server での運用上の問題のための AlwaysOn ポリシー&#41;](always-on-policies-for-operational-issues-always-on-availability.md) </span><span class="sxs-lookup"><span data-stu-id="3fa39-249">[AlwaysOn Policies for Operational Issues with AlwaysOn Availability Groups &#40;SQL Server&#41;](always-on-policies-for-operational-issues-always-on-availability.md) </span></span>  
 <span data-ttu-id="3fa39-250">[SSAS 多次元&#41;&#40;データソースを作成する](https://docs.microsoft.com/analysis-services/multidimensional-models/create-a-data-source-ssas-multidimensional) </span><span class="sxs-lookup"><span data-stu-id="3fa39-250">[Create a Data Source &#40;SSAS Multidimensional&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/create-a-data-source-ssas-multidimensional) </span></span>  
 [<span data-ttu-id="3fa39-251">ディメンションの書き戻しを有効にする</span><span class="sxs-lookup"><span data-stu-id="3fa39-251">Enable Dimension Writeback</span></span>](https://docs.microsoft.com/analysis-services/multidimensional-models/bi-wizard-enable-dimension-writeback)  
  
  
