---
title: AlwaysOn 可用性グループの概要 (SQL Server) |Microsoft Docs
ms.custom: ''
ms.date: 10/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- secondary databases [SQL Server], in availability group
- primary databases [SQL Server], in availability group
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], data movement
- Availability Groups [SQL Server]
ms.assetid: 04fd9d95-4624-420f-a3be-1794309b3a47
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: bc49a841daaeb0f7bda6f793890433f26c6b5c1f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633304"
---
# <a name="overview-of-alwayson-availability-groups-sql-server"></a><span data-ttu-id="a6ae2-102">AlwaysOn 可用性グループの概要 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="a6ae2-102">Overview of AlwaysOn Availability Groups (SQL Server)</span></span>
  <span data-ttu-id="a6ae2-103">このトピックでは、 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] の概念について説明します。これは、 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]での 1 つ以上の可用性グループの構成と管理において重要です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-103">This topic introduces the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] concepts that are central for configuring and managing one or more availability groups in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="a6ae2-104">可用性グループの利点の要約および [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] 用語の概要については、「[AlwaysOn 可用性グループ&#40;SQL Server&#41;](always-on-availability-groups-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-104">For a summary of the benefits offered by availability groups and an overview of [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] terminology, see [AlwaysOn Availability Groups &#40;SQL Server&#41;](always-on-availability-groups-sql-server.md).</span></span>

 <span data-ttu-id="a6ae2-105">*可用性グループ*は、相互にフェールオーバーされる個別のユーザーデータベース (*可用性データベース*と呼ばれます) のフェールオーバー環境をサポートします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-105">An *availability group* supports a failover environment for a discrete set of user databases, known as *availability databases*, that fail over together.</span></span> <span data-ttu-id="a6ae2-106">可用性グループは、プライマリ データベースのセットをサポートし、1 ～ 8 セットの対応するセカンダリ データベースをサポートします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-106">An availability group supports a set of primary databases and one to eight sets of corresponding secondary databases.</span></span> <span data-ttu-id="a6ae2-107">セカンダリ データベースは、バックアップではあ*りません*。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-107">Secondary databases are *not* backups.</span></span> <span data-ttu-id="a6ae2-108">継続してデータベースおよびそのトランザクション ログを定期的にバックアップします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-108">Continue to back up your databases and their transaction logs on a regular basis.</span></span>

> [!TIP]
>  <span data-ttu-id="a6ae2-109">プライマリ データベースのバックアップの種類を作成できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-109">You can create any type of backup of a primary database.</span></span> <span data-ttu-id="a6ae2-110">または、セカンダリ データベースのログ バックアップとコピーのみの完全バックアップを作成できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-110">Alternatively, you can create log backups and copy-only full backups of secondary databases.</span></span> <span data-ttu-id="a6ae2-111">詳細については、「[アクティブなセカンダリ: セカンダリ レプリカでのバックアップ &#40;AlwaysOn 可用性グループ&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-111">For more information, see [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span></span>

 <span data-ttu-id="a6ae2-112">可用性データベースの各セットは、 *可用性レプリカ*によりホストされます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-112">Each set of availability database is hosted by an *availability replica*.</span></span> <span data-ttu-id="a6ae2-113">可用性レプリカには、2 つの種類があります。1 つは、単一の *プライマリ レプリカ*で、</span><span class="sxs-lookup"><span data-stu-id="a6ae2-113">Two types of availability replicas exist: a single *primary replica*.</span></span> <span data-ttu-id="a6ae2-114">プライマリ データベースをホストします。もう 1 種類は、1 ～ 8 つの *セカンダリ レプリカ*で、それぞれがセカンダリ データベースのセットをホストし、可用性グループの潜在的なフェールオーバー ターゲットとして機能します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-114">which hosts the primary databases, and one to eight *secondary replicas*, each of which hosts a set of secondary databases and serves as a potential failover targets for the availability group.</span></span> <span data-ttu-id="a6ae2-115">可用性グループは、可用性レプリカのレベルでフェールオーバーします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-115">An availability group fails over at the level of an availability replica.</span></span> <span data-ttu-id="a6ae2-116">可用性レプリカでは、データセット レベル (1 つの可用性グループのデータベースのセット) でのみ冗長性が提供されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-116">An availability replica provides redundancy only at the database level-for the set of databases in one availability group.</span></span> <span data-ttu-id="a6ae2-117">データベースの問題 (たとえば、データ ファイルの損失やトランザクション ログの破損による障害が疑われる場合など) が発生してもフェールオーバーは行われません。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-117">Failovers are not caused by database issues such as a database becoming suspect due to a loss of a data file or corruption of a transaction log.</span></span>

 <span data-ttu-id="a6ae2-118">プライマリ レプリカは、クライアントからプライマリ データベースへの読み取り/書き込み接続を可能にします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-118">The primary replica makes the primary databases available for read-write connections from clients.</span></span> <span data-ttu-id="a6ae2-119">さらに、データベース レベルで発生する *データの同期*と呼ばれるプロセスを介して、</span><span class="sxs-lookup"><span data-stu-id="a6ae2-119">Also, in a process known as *data synchronization*, which occurs at the database level.</span></span> <span data-ttu-id="a6ae2-120">プライマリ レプリカは、各プライマリ データベースのトランザクション ログ レコードをすべてのセカンダリ データベースに送信します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-120">The primary replica sends transaction log records of each primary database to every secondary database.</span></span> <span data-ttu-id="a6ae2-121">すべてのセカンダリ レプリカは、トランザクション ログ レコードをキャッシュし (ログの*書き込み* )、それを対応するセカンダリ データベースに適用します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-121">Every secondary replica caches the transaction log records (*hardens* the log) and then applies them to its corresponding secondary database.</span></span> <span data-ttu-id="a6ae2-122">データの同期は、プライマリ データベースと接続されているそれぞれのセカンダリ データベースとの間で、他のデータベースとは無関係に発生します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-122">Data synchronization occurs between the primary database and each connected secondary database, independently of the other databases.</span></span> <span data-ttu-id="a6ae2-123">したがって、セカンダリ データベースの中断や障害が発生した場合でも他のセカンダリ データベースはその影響を受けません。また、プライマリ データベースの中断や障害が発生した場合でも他のプライマリ データベースはその影響を受けません。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-123">Therefore, a secondary database can be suspended or fail without affecting other secondary databases, and a primary database can be suspended or fail without affecting other primary databases.</span></span>

 <span data-ttu-id="a6ae2-124">必要に応じて、1 つ以上のセカンダリ レプリカでセカンダリ データベースへの読み取り専用アクセスをサポートするように構成できます。また、任意のセカンダリ レプリカでセカンダリ データベースのバックアップを許容するように構成できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-124">Optionally, you can configure one or more secondary replicas to support read-only access to secondary databases, and you can configure any secondary replica to permit backups on secondary databases.</span></span>

 <span data-ttu-id="a6ae2-125">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] を配置するには、Windows Server フェールオーバー クラスタリング (WSFC) クラスターが必要です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-125">Deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requires a Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="a6ae2-126">指定された可用性グループの各可用性レプリカは、同一の WSFC クラスターの異なるノード上に存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-126">Each availability replica of a given availability group must reside on a different node of the same WSFC cluster.</span></span> <span data-ttu-id="a6ae2-127">唯一の例外は、別の WSFC クラスターに移行するときに、可用性グループは一時的に 2 つのクラスターにまたがることができるという点です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-127">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>

 <span data-ttu-id="a6ae2-128">WSFC リソース グループは、作成されたすべての可用性グループに対して作成されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-128">A WSFC resource group is created for every availability group that you create.</span></span> <span data-ttu-id="a6ae2-129">WSFC クラスターは、このリソース グループを監視して、プライマリ レプリカの正常性を評価します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-129">The WSFC cluster monitors this resource group to evaluate the health of the primary replica.</span></span> <span data-ttu-id="a6ae2-130">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] のクォーラムは、クラスター ノードが可用性レプリカをホストしているかどうかに関係なく、WSFC クラスター内のすべてのノードに基づきます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-130">The quorum for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is based on all nodes in the WSFC cluster regardless of whether a given cluster node hosts any availability replicas.</span></span> <span data-ttu-id="a6ae2-131">データベース ミラーリングとは異なり、 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]には監視ロールはありません。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-131">In contrast to database mirroring, there is no witness role in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>

> [!NOTE]
>  <span data-ttu-id="a6ae2-132">SQL Server AlwaysOn コンポーネントと WSFC クラスターとの関係については、「[Windows Server フェールオーバー クラスタリング &#40;WSFC&#41; と SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-132">For information about the relationship of SQL Server AlwaysOn components to the WSFC cluster, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>

 <span data-ttu-id="a6ae2-133">次の図は、1 つのプライマリ レプリカと 4 つのセカンダリ レプリカを含む可用性グループを示しています。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-133">The following illustration shows an availability group that contains one primary replica and four secondary replicas.</span></span> <span data-ttu-id="a6ae2-134">最大 8 つのセカンダリ レプリカ (1 つのプライマリ レプリカと 2 つの同期コミット セカンダリ レプリカ) がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-134">Up to eight secondary replicas are supported, including one primary replica and two synchronous-commit secondary replicas.</span></span>

 <span data-ttu-id="a6ae2-135">![5 つのレプリカを使用する可用性グループ](../../media/aoag-agintrofigure.gif "5 つのレプリカを使用する可用性グループ")</span><span class="sxs-lookup"><span data-stu-id="a6ae2-135">![Availability group with five replicas](../../media/aoag-agintrofigure.gif "Availability group with five replicas")</span></span>


##  <a name="availability-databases"></a><a name="AvDbs"></a><span data-ttu-id="a6ae2-136">可用性データベース</span><span class="sxs-lookup"><span data-stu-id="a6ae2-136">Availability Databases</span></span>
 <span data-ttu-id="a6ae2-137">可用性グループに追加するデータベースは、オンラインの読み取り/書き込みデータベースであることが必要であり、プライマリ レプリカをホストするサーバー インスタンスに置かれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-137">To add a database to an availability group, the database must be an online, read-write database that exists on the server instance that hosts the primary replica.</span></span> <span data-ttu-id="a6ae2-138">追加されたデータベースは、プライマリ データベースとして可用性グループに参加しますが、引き続きクライアントから使用できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-138">When you add a database, it joins the availability group as a primary database, while remaining available to clients.</span></span> <span data-ttu-id="a6ae2-139">新しいプライマリ データベースのバックアップが、セカンダリ レプリカをホストするサーバー インスタンスに復元されない限り (RESTORE WITH NORECOVERY を使用します)、対応するセカンダリ データベースは存在しません。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-139">No corresponding secondary database exists until backups of the new primary database are restored to the server instance that hosts the secondary replica (using RESTORE WITH NORECOVERY).</span></span> <span data-ttu-id="a6ae2-140">新しいセカンダリ データベースは、可用性グループに参加するまでは RESTORING 状態です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-140">The new secondary database is in the RESTORING state until it is joined to the availability group.</span></span> <span data-ttu-id="a6ae2-141">詳細については、「[AlwaysOn セカンダリ データベース上のデータ移動の開始 &#40;SQL Server&#41;](start-data-movement-on-an-always-on-secondary-database-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-141">For more information, see [Start Data Movement on an AlwaysOn Secondary Database &#40;SQL Server&#41;](start-data-movement-on-an-always-on-secondary-database-sql-server.md).</span></span>

 <span data-ttu-id="a6ae2-142">可用性グループに参加すると、セカンダリ データベースは ONLINE 状態になり、対応するプライマリ データベースとのデータ同期が開始されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-142">Joining places the secondary database into the ONLINE state and initiates data synchronization with the corresponding primary database.</span></span> <span data-ttu-id="a6ae2-143">*データ同期* は、プライマリ データベースへの変更をセカンダリ データベースに再現するプロセスです。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-143">*Data synchronization* is the process by which changes to a primary database are reproduced on a secondary database.</span></span> <span data-ttu-id="a6ae2-144">データ同期では、プライマリ データベースがトランザクション ログ レコードをセカンダリ データベースに送信します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-144">Data synchronization involves the primary database sending transaction log records to the secondary database.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="a6ae2-145">可用性データベースは、 *、PowerShell、および SQL Server 管理オブジェクト (SMO) の名前では、* データベース レプリカ [!INCLUDE[tsql](../../../includes/tsql-md.md)]と呼ばれることがあります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-145">An availability database is sometimes called a *database replica* in [!INCLUDE[tsql](../../../includes/tsql-md.md)], PowerShell, and SQL Server Management Objects (SMO) names.</span></span> <span data-ttu-id="a6ae2-146">たとえば、可用性データベースに関する情報を返す AlwaysOn 動的管理ビューの名前では、**sys.dm_hadr_database_replica_states** や **sys.dm_hadr_database_replica_cluster_states** のように、"データベース レプリカ (database replica)" という語が使用されています。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-146">For example, the term "database replica" is used in the names of the AlwaysOn dynamic management views that return information about availability databases:  **sys.dm_hadr_database_replica_states** and **sys.dm_hadr_database_replica_cluster_states**.</span></span> <span data-ttu-id="a6ae2-147">ただし、SQL Server オンライン ブックでは、"レプリカ" という用語は一般に可用性レプリカを指します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-147">However, in SQL Server Books Online, the term "replica" typically refers to availability replicas.</span></span> <span data-ttu-id="a6ae2-148">たとえば、"プライマリ レプリカ" と "セカンダリ レプリカ" は、常に可用性レプリカを指します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-148">For example, "primary replica" and "secondary replica" always refer to availability replicas.</span></span>

##  <a name="availability-replicas"></a><a name="AGsARsADBs"></a><span data-ttu-id="a6ae2-149">可用性レプリカ</span><span class="sxs-lookup"><span data-stu-id="a6ae2-149">Availability Replicas</span></span>
 <span data-ttu-id="a6ae2-150">各可用性グループは、可用性レプリカと呼ばれる 2 つ以上のフェールオーバー パートナーを定義します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-150">Each availability group defines a set of two or more failover partners known as availability replicas.</span></span> <span data-ttu-id="a6ae2-151">*可用性レプリカ* は、可用性グループのコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-151">*Availability replicas* are components of the availability group.</span></span> <span data-ttu-id="a6ae2-152">各可用性レプリカは、可用性グループ内の可用性データベースのコピーをホストします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-152">Each availability replica hosts a copy of the availability databases in the availability group.</span></span> <span data-ttu-id="a6ae2-153">各可用性グループで、個々の可用性レプリカは、1 つの WSFC クラスターの別々のノード上に存在する [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の個々のインスタンスによってホストされる必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-153">For a given availability group, the availability replicas must be hosted by separate instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] residing on different nodes of a WSFC cluster.</span></span> <span data-ttu-id="a6ae2-154">これらのサーバー インスタンスそれぞれで、AlwaysOn を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-154">Each of these server instances must be enabled for AlwaysOn.</span></span>

 <span data-ttu-id="a6ae2-155">指定したインスタンスで、1 つの可用性グループにつき 1 つだけ可用性レプリカをホストすることができます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-155">A given instance can host only one availability replica per availability group.</span></span> <span data-ttu-id="a6ae2-156">ただし、各インスタンスを多数の可用性グループに使用することはできます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-156">However, each instance can be used for many availability groups.</span></span> <span data-ttu-id="a6ae2-157">指定したインスタンスは、スタンドアロン インスタンスまたは [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] フェールオーバー クラスター インスタンス (FCI) として使用できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-157">A given instance can be either a stand-alone instance or a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI).</span></span> <span data-ttu-id="a6ae2-158">サーバー レベルの冗長性が必要な場合は、フェールオーバー クラスター インスタンスを使用します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-158">If you require server-level redundancy, use Failover Cluster Instances.</span></span>

 <span data-ttu-id="a6ae2-159">すべての可用性レプリカには、初期ロールとして、*プライマリ ロール*または*セカンダリ ロール*が割り当てられています。これが、レプリカの可用性データベースによって継承されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-159">Every availability replica is assigned an initial role-either the *primary role* or the *secondary role*, which is inherited by the availability databases of that replica.</span></span> <span data-ttu-id="a6ae2-160">指定されたレプリカのロールにより、読み取り/書き込みデータベースと読み取り専用のデータベースのどちらがホストされるかが決定されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-160">The role of a given replica determines whether it hosts read-write databases or read-only databases.</span></span> <span data-ttu-id="a6ae2-161">*プライマリ レプリカ*と呼ばれる 1 つのレプリカには、プライマリ ロールが割り当てられ、 *プライマリ データベース*と呼ばれる読み取り/書き込みデータベースをホストします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-161">One replica, known as the *primary replica*, is assigned the primary role and hosts read-write databases, which are known as *primary databases*.</span></span> <span data-ttu-id="a6ae2-162">それ以外の 1 つ以上のレプリカは *セカンダリ レプリカ*と呼ばれ、セカンダリ ロールが割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-162">At least one other replica, known as a *secondary replica*, is assigned the secondary role.</span></span> <span data-ttu-id="a6ae2-163">セカンダリ レプリカは、セカンダリ データベースと呼ばれる読み取り専用のデータベースをホストします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-163">A secondary replica hosts read-only databases, known as secondary databases.</span></span>

> [!NOTE]
>  <span data-ttu-id="a6ae2-164">フェールオーバー中など、可用性レプリカのロールが不確定である場合、そのデータベースは一時的に NOT SYNCHRONIZING 状態になります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-164">When the role of an availability replica is indeterminate, such as during a failover, its databases are temporarily in a NOT SYNCHRONIZING state.</span></span> <span data-ttu-id="a6ae2-165">可用性レプリカのロールが解決されるまで、それらのロールは RESOLVING に設定されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-165">Their role is set to RESOLVING until the role of the availability replica has resolved.</span></span> <span data-ttu-id="a6ae2-166">可用性レプリカがプライマリ ロールに解決された場合、そのデータベースはプライマリ データベースになります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-166">If an availability replica resolves to the primary role, its databases become the primary databases.</span></span> <span data-ttu-id="a6ae2-167">可用性レプリカがセカンダリ ロールに解決された場合、そのデータベースはセカンダリ データベースになります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-167">If an availability replica resolves to the secondary role, its databases become secondary databases.</span></span>

##  <a name="availability-modes"></a><a name="AvailabilityModes"></a><span data-ttu-id="a6ae2-168">可用性モード</span><span class="sxs-lookup"><span data-stu-id="a6ae2-168">Availability Modes</span></span>
 <span data-ttu-id="a6ae2-169">可用性モードは、各可用性レプリカのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-169">The availability mode is a property of each availability replica.</span></span> <span data-ttu-id="a6ae2-170">可用性モードによって、特定のセカンダリ レプリカがディスクにトランザクション ログ レコードを書き込む (ログ書き込み) まで、プライマリ レプリカによるデータベースへのトランザクションのコミットを待機するかどうかが決定されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-170">The availability mode determines whether the primary replica waits to commit transactions on a database until a given secondary replica has written the transaction log records to disk (hardened the log).</span></span> [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="a6ae2-171">は、*非同期コミット モード*と*同期コミット モード*という 2 種類の可用性モードをサポートします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-171">supports two availability modes-*asynchronous-commit mode* and *synchronous-commit mode*.</span></span>

-   <span data-ttu-id="a6ae2-172">**Asynchronous-commit mode**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-172">**Asynchronous-commit mode**</span></span>

     <span data-ttu-id="a6ae2-173">この可用性モードを使用する可用性レプリカは、*非同期コミット レプリカ*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-173">An availability replica that uses this availability mode is known as an*asynchronous-commit replica*.</span></span> <span data-ttu-id="a6ae2-174">非同期コミット モードでは、非同期コミット セカンダリ レプリカによりログが書き込まれことが確認されるまで待機せずに、プライマリ レプリカがトランザクションをコミットします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-174">Under asynchronous-commit mode, the primary replica commits transactions without waiting for acknowledgement that an asynchronous-commit secondary replica has hardened the log.</span></span> <span data-ttu-id="a6ae2-175">非同期コミット モードでは、セカンダリ データベースでのトランザクションの遅延が最小になりますが、セカンダリ データベースがプライマリ データベースよりも遅延する場合があるため、一部のデータが失われる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-175">Asynchronous-commit mode minimizes transaction latency on the secondary databases but allows them to lag behind the primary databases, making some data loss possible.</span></span>

-   <span data-ttu-id="a6ae2-176">**Synchronous-commit mode**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-176">**Synchronous-commit mode**</span></span>

     <span data-ttu-id="a6ae2-177">この可用性モードを使用する可用性レプリカは、 *同期コミット レプリカ*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-177">An availability replica that uses this availability mode is known as a *synchronous-commit replica*.</span></span> <span data-ttu-id="a6ae2-178">同期コミット モードの場合、同期コミット プライマリ レプリカは、同期コミット セカンダリ レプリカによるログ書き込みが確認されるまで待機した後で、トランザクションをコミットします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-178">Under synchronous-commit mode, before committing transactions, a synchronous-commit primary replica waits for a synchronous-commit secondary replica to acknowledge that it has finished hardening the log.</span></span> <span data-ttu-id="a6ae2-179">同期コミット モードでは、特定のセカンダリ データベースがプライマリ データベースに 1 回同期されれば、コミットされたトランザクションが完全に保護されることが保証されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-179">Synchronous-commit mode ensures that once a given secondary database is synchronized with the primary database, committed transactions are fully protected.</span></span> <span data-ttu-id="a6ae2-180">この保護の欠点は、トランザクションの遅延が増加することです。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-180">This protection comes at the cost of increased transaction latency.</span></span>

 <span data-ttu-id="a6ae2-181">詳細については、「[可用性モード &#40;AlwaysOn 可用性グループ&#41;](availability-modes-always-on-availability-groups.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-181">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>

##  <a name="types-of-failover"></a><a name="FormsOfFailover"></a><span data-ttu-id="a6ae2-182">フェールオーバーの種類</span><span class="sxs-lookup"><span data-stu-id="a6ae2-182">Types of Failover</span></span>
 <span data-ttu-id="a6ae2-183">プライマリ レプリカとセカンダリ レプリカとのセッションのコンテキスト内で、プライマリ ロールとセカンダリ ロールが *フェールオーバー*と呼ばれるプロセスで交換されることがあります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-183">Within the context of a session between the primary replica and a secondary replica, the primary and secondary roles are potentially interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="a6ae2-184">フェールオーバー中に、対象のセカンダリ レプリカがプライマリ ロールに移行し、新しいプライマリ レプリカになります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-184">During a failover the target secondary replica transitions to the primary role, becoming the new primary replica.</span></span> <span data-ttu-id="a6ae2-185">新しいプライマリ レプリカのデータベースがプライマリ データベースとしてオンラインになります。クライアント アプリケーションから、これらのデータベースに接続できるようになります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-185">The new primary replica brings its databases online as the primary databases, and client applications can connect to them.</span></span> <span data-ttu-id="a6ae2-186">元のプライマリ レプリカは使用可能になるとセカンダリ ロールに移行し、セカンダリ レプリカになります</span><span class="sxs-lookup"><span data-stu-id="a6ae2-186">When the former primary replica is available, it transitions to the secondary role, becoming a secondary replica.</span></span> <span data-ttu-id="a6ae2-187">元のプライマリ データベースはセカンダリ データベースになり、データ同期が再開されます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-187">The former primary databases become secondary databases and data synchronization resumes.</span></span>

 <span data-ttu-id="a6ae2-188">フェールオーバーには、自動、手動、および強制 (データ損失の可能性あり) という 3 つの形式があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-188">Three forms of failover exist-automatic, manual, and forced (with possible data loss).</span></span> <span data-ttu-id="a6ae2-189">特定のセカンダリ レプリカでサポートされるフェールオーバーの形式は、可用性モードによって決まります。同期コミット モードでは、プライマリ レプリカのフェールオーバー モードおよび対象のセカンダリ レプリカによって決まります。次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-189">The form or forms of failover supported by a given secondary replica depends on its availability mode, and, for synchronous-commit mode, on the failover mode on the primary replica and target secondary replica, as follows.</span></span>

-   <span data-ttu-id="a6ae2-190">同期コミットモードでは、ターゲットのセカンダリレプリカが現在 avt1 と同期されている場合、フェールオーバーによる*計画的な手動フェールオーバー*と*自動フェールオーバー*の2つの形式がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-190">Synchronous-commit mode supports two forms of failover-*planned manual failover* and *automatic failover*, if the target secondary replica is currently synchronized with the avt1.</span></span> <span data-ttu-id="a6ae2-191">これらのフェールオーバーの形式のサポートは、フェールオーバー パートナーの *フェールオーバー モード プロパティ* の設定によって決まります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-191">The support for these forms of failover depends on the setting of the *failover mode property* on the failover partners.</span></span> <span data-ttu-id="a6ae2-192">プライマリ レプリカとセカンダリ レプリカのどちらかのフェールオーバー モードが "手動" に設定されている場合、そのセカンダリ レプリカに対しては手動フェールオーバーのみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-192">If failover mode is set to "manual" on either the primary or secondary replica, only manual failover is supported for that secondary replica.</span></span> <span data-ttu-id="a6ae2-193">プライマリ レプリカとセカンダリ レプリカのどちらのフェールオーバー モードも "自動" に設定されている場合、そのセカンダリ レプリカでは自動フェールオーバーと手動フェールオーバーの両方がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-193">If failover mode is set to "automatic" on both the primary and secondary replicas, both automatic and manual failover are supported on that secondary replica.</span></span>

    -   <span data-ttu-id="a6ae2-194">**計画的な手動フェールオーバー** (データ損失なし)</span><span class="sxs-lookup"><span data-stu-id="a6ae2-194">**Planned manual failover** (without data loss)</span></span>

         <span data-ttu-id="a6ae2-195">データベース管理者がフェールオーバー コマンドを発行した後に手動フェールオーバーが開始され、同期されたセカンダリ レプリカがプライマリ ロールに移行し (データ保護の保証あり)、プライマリ レプリカはセカンダリ ロールに移行します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-195">A manual failover occurs after a database administrator issues a failover command and causes a synchronized secondary replica to transition to the primary role (with guaranteed data protection) and the primary replica to transition to the secondary role.</span></span> <span data-ttu-id="a6ae2-196">手動フェールオーバーには、プライマリ レプリカと対象のセカンダリ レプリカの両方が同期コミット モードで実行されていることが必要です。また、セカンダリ レプリカが既に同期されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-196">A manual failover requires that both the primary replica and the target secondary replica are running under synchronous-commit mode, and the secondary replica must already be synchronized.</span></span>

    -   <span data-ttu-id="a6ae2-197">**自動フェールオーバー** (データ損失なし)</span><span class="sxs-lookup"><span data-stu-id="a6ae2-197">**Automatic failover** (without data loss)</span></span>

         <span data-ttu-id="a6ae2-198">エラーが発生すると、自動フェールオーバーが開始されて、同期されたセカンダリ レプリカがプライマリ ロールに移行します (データ保護が保証されます)。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-198">An automatic failover occurs in response to a failure that causes a synchronized secondary replica to transition to the primary role (with guaranteed data protection).</span></span> <span data-ttu-id="a6ae2-199">元のプライマリ レプリカは、使用可能になるとセカンダリ ロールに移行します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-199">When the former primary replica becomes available, it transitions to the secondary role.</span></span> <span data-ttu-id="a6ae2-200">自動フェールオーバーでは、プライマリ レプリカと対象のセカンダリ レプリカの両方が同期コミット モードで実行されていることが必要です。また、フェールオーバー モードが "自動" に設定されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-200">Automatic failover requires that both the primary replica and the target secondary replica are running under synchronous-commit mode with the failover mode set to "Automatic".</span></span> <span data-ttu-id="a6ae2-201">さらに、セカンダリ レプリカが既に同期され、WSFC クォーラムを持ち、可用性グループの [柔軟なフェールオーバー ポリシー](flexible-automatic-failover-policy-availability-group.md)で指定された条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-201">In addition, the secondary replica must already be synchronized, have WSFC quorum, and meet the conditions specified by the [flexible failover policy](flexible-automatic-failover-policy-availability-group.md)of the availability group.</span></span>

        > [!IMPORTANT]
        >  <span data-ttu-id="a6ae2-202">SQL Server フェールオーバー クラスター インスタンス (FCI) は可用性グループによる自動フェールオーバーをサポートしないため、FCI によってホストされる可用性レプリカは手動フェールオーバー用にのみ構成できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-202">SQL Server Failover Cluster Instances (FCIs) do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can only be configured for manual failover.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="a6ae2-203">同期されたセカンダリ レプリカ上で強制フェールオーバー コマンドを発行した場合、セカンダリ レプリカは計画された手動フェールオーバーの場合と同様に動作します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-203">Note that if you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a planned manual failover.</span></span>

-   <span data-ttu-id="a6ae2-204">非同期コミット モードで使用されるフェールオーバーは、 *強制フェールオーバー*と通常呼ばれる強制手動フェールオーバーのみです (データ損失の可能性あり)。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-204">Under asynchronous-commit mode, the only form of failover is forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="a6ae2-205">強制フェールオーバーは手動のみで開始できるため、手動フェールオーバーの一種と見なされます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-205">Forced failover is considered a form of manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="a6ae2-206">強制フェールオーバーは、障害復旧オプションです。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-206">Forced failover is a disaster recovery option.</span></span> <span data-ttu-id="a6ae2-207">対象のセカンダリ レプリカがプライマリ レプリカに同期されない場合に使用できる唯一のフェールオーバー形式です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-207">It is the only form of failover that is possible when the target secondary replica is not synchronized with the primary replica.</span></span>

 <span data-ttu-id="a6ae2-208">詳細については、「[フェールオーバーとフェールオーバー モード &#40;AlwaysOn 可用性グループ&#41;](failover-and-failover-modes-always-on-availability-groups.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-208">For more information, see [Failover and Failover Modes &#40;AlwaysOn Availability Groups&#41;](failover-and-failover-modes-always-on-availability-groups.md).</span></span>

##  <a name="client-connections"></a><a name="ClientConnections"></a> <span data-ttu-id="a6ae2-209">クライアント接続</span><span class="sxs-lookup"><span data-stu-id="a6ae2-209">Client Connections</span></span>
 <span data-ttu-id="a6ae2-210">可用性グループ リスナーを作成することによって、特定の可用性グループのプライマリ レプリカへのクライアント接続を提供できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-210">You can provide client connectivity to the primary replica of a given availability group by creating an availability group listener.</span></span> <span data-ttu-id="a6ae2-211">*可用性グループ リスナー* には、クライアント接続を適切な可用性レプリカに送るために特定の可用性グループにアタッチされる一連のリソースが用意されています。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-211">An *availability group listener* provides a set of resources that is attached to a given availability group to direct client connections to the appropriate availability replica.</span></span>

 <span data-ttu-id="a6ae2-212">可用性グループ リスナーは、仮想ネットワーク名 (VNN) として機能する一意の DNS 名、1 つ以上の仮想 IP アドレス (VIP)、および TCP ポート番号に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-212">An availability group listener is associated with a unique DNS name that serves as a virtual network name (VNN), one or more virtual IP addresses (VIPs), and a TCP port number.</span></span> <span data-ttu-id="a6ae2-213">詳細については、「 [可用性グループ リスナー、クライアント接続、およびアプリケーションのフェールオーバー &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)での 1 つ以上の可用性グループの構成と管理において重要です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-213">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>

> [!TIP]
>  <span data-ttu-id="a6ae2-214">可用性グループに 2 つしか可用性レプリカが存在せず、なおかつ、その可用性グループが、セカンダリ レプリカへの読み取りアクセスを許可する設定になっていない場合、クライアントは、 [データベース ミラーリングの接続文字列](../../database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md)を使用してプライマリ レプリカに接続できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-214">If an availability group possesses only two availability replicas and is not configured to allow read-access to the secondary replica, clients can connect to the primary replica by using a [database mirroring connection string](../../database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span> <span data-ttu-id="a6ae2-215">この方法は、データベースをデータベース ミラーリングから [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]に移行した後で、一時的に役に立つ場合があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-215">This approach can be useful temporarily after you migrate a database from database mirroring to [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="a6ae2-216">他のセカンダリ レプリカを追加する前に、可用性グループの可用性グループ リスナーを作成し、そのリスナーのネットワーク名を使用するようにアプリケーションを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-216">Before you add additional secondary replicas, you will need to create an availability group listener the availability group and update your applications to use the network name of the listener.</span></span>

##  <a name="active-secondary-replicas"></a><a name="ActiveSecondaries"></a><span data-ttu-id="a6ae2-217">アクティブなセカンダリレプリカ</span><span class="sxs-lookup"><span data-stu-id="a6ae2-217">Active Secondary Replicas</span></span>
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="a6ae2-218">は、アクティブなセカンダリ レプリカをサポートします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-218">supports active secondary replicas.</span></span> <span data-ttu-id="a6ae2-219">アクティブなセカンダリ機能では以下をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-219">Active secondary capabilities include support for:</span></span>

-   <span data-ttu-id="a6ae2-220">**セカンダリ レプリカでのバックアップ操作の実行**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-220">**Performing backup operations on secondary replicas**</span></span>

     <span data-ttu-id="a6ae2-221">セカンダリ レプリカでは、ログ バックアップと、データベース全体、ファイル、またはファイル グループの [コピーのみの](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) バックアップを実行できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-221">The secondary replicas support performing log backups and [copy-only](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) backups of a full database, file, or filegroup.</span></span> <span data-ttu-id="a6ae2-222">可用性グループを構成して、バックアップを実行する優先順位を指定できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-222">You can configure the availability group to specify a preference for where backups should be performed.</span></span> <span data-ttu-id="a6ae2-223">優先順位は SQL Server によって適用されるものではないので、アドホック バックアップには影響がないことを理解しておくことが重要です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-223">It is important to understand that the preference is not enforced by SQL Server, so it has no impact on ad-hoc backups.</span></span> <span data-ttu-id="a6ae2-224">この優先順位の解釈は、特定の可用性グループの各データベースに対するバックアップ ジョブのスクリプトでのロジックに依存します (ある場合)。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-224">The interpretation of this preference depends on the logic, if any, that you script into your back jobs for each of the databases in a given availability group.</span></span> <span data-ttu-id="a6ae2-225">同じ可用性グループ内の個々の可用性レプリカで実行されるバックアップの優先順位を指定できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-225">For an individual availability replica, you can specify your priority for performing backups on this replica relative to the other replicas in the same availability group.</span></span> <span data-ttu-id="a6ae2-226">詳細については、「[アクティブなセカンダリ: セカンダリ レプリカでのバックアップ &#40;AlwaysOn 可用性グループ&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-226">For more information, see [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).</span></span>

-   <span data-ttu-id="a6ae2-227">**1 つ以上のセカンダリ レプリカへの読み取り専用アクセス (読み取り可能なセカンダリ レプリカ)**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-227">**Read-only access to one or more secondary replicas (readable secondary replicas)**</span></span>

     <span data-ttu-id="a6ae2-228">セカンダリ ロールを実行するときに、ローカル データベースへの読み取り専用アクセスを許可するように可用性レプリカを構成できます (ただし、一部の操作は完全にはサポートされていません)。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-228">Any availability replica can be configured to allow read-only access to its local databases when performing the secondary role, though some operations are not fully supported.</span></span> <span data-ttu-id="a6ae2-229">また、読み取り専用ワークロードがプライマリ レプリカで実行されないようにする場合は、プライマリ ロールで実行されているときに読み取り/書き込みアクセスのみを許可するようにレプリカを構成できます。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-229">Also, if you would like to prevent read-only workloads from running on the primary replica, you can configure the replicas to allow only read-write access when running under the primary role.</span></span> <span data-ttu-id="a6ae2-230">詳細については、「[アクティブなセカンダリ: 読み取り可能なセカンダリ レプリカ &#40;AlwaysOn 可用性グループ&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-230">For more information, see [Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>

     <span data-ttu-id="a6ae2-231">可用性グループに、現在、可用性グループ リスナーと 1 つ以上の読み取り可能なセカンダリ レプリカが存在する場合、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] は読み取りを目的とした接続要求をそれらのいずれかにルーティングできます (*読み取り専用ルーティング*)。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-231">If an availability group currently possesses an availability group listener and one or more readable secondary replicas, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can route read-intent connection requests to one of them (*read-only routing*).</span></span> <span data-ttu-id="a6ae2-232">詳細については、「 [可用性グループ リスナー、クライアント接続、およびアプリケーションのフェールオーバー &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)での 1 つ以上の可用性グループの構成と管理において重要です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-232">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>

##  <a name="session-timeout-period"></a><a name="SessionTimeoutPerios"></a><span data-ttu-id="a6ae2-233">セッションタイムアウト期間</span><span class="sxs-lookup"><span data-stu-id="a6ae2-233">Session-Timeout Period</span></span>
 <span data-ttu-id="a6ae2-234">セッション タイムアウト期間は、可用性レプリカのプロパティで、他の可用性レプリカとの接続を閉じるまでに非アクティブに保持できる時間を決定します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-234">The session-timeout period is an availability-replica property that determines how long connection with another availability replica can remain inactive before the connection is closed.</span></span> <span data-ttu-id="a6ae2-235">プライマリ レプリカとセカンダリ レプリカは、アクティブであることを通知するために互いに ping を実行します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-235">The primary and secondary replicas ping each other to signal that they are still active.</span></span> <span data-ttu-id="a6ae2-236">他のレプリカからタイムアウト期間内に ping を受信した場合は、その接続がまだ開いており、サーバー インスタンスが通信していることを示します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-236">Receiving a ping from the other replica during the timeout period indicates that the connection is still open and that the server instances are communicating.</span></span> <span data-ttu-id="a6ae2-237">可用性レプリカは、ping を受信すると、接続のセッション タイムアウト カウンターをリセットします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-237">On receiving a ping, an availability replica resets its session-timeout counter on that connection.</span></span>

 <span data-ttu-id="a6ae2-238">セッション タイムアウト期間を設定することにより、相手レプリカからの ping を受信するまで無期限に待機することがなくなります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-238">The session-timeout period prevents either replica from waiting indefinitely to receive a ping from the other replica.</span></span> <span data-ttu-id="a6ae2-239">セッション タイムアウト期間中に相手のレプリカから ping を受信しなかった場合、レプリカはタイムアウトします。レプリカの接続は閉じられ、タイムアウトしたレプリカは DISCONNECTED 状態になります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-239">If no ping is received from the other replica within the session-timeout period, the replica times out. Its connection is closed, and the timed-out replica enters the DISCONNECTED state.</span></span> <span data-ttu-id="a6ae2-240">切断されたレプリカが同期コミット モード用に構成されている場合でも、トランザクションは、そのレプリカが再接続および再同期するのを待機しません。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-240">Even if a disconnected replica is configured for synchronous-commit mode, transactions will not wait for that replica to reconnect and resynchronize.</span></span>

 <span data-ttu-id="a6ae2-241">各可用性レプリカの既定のセッション タイムアウト期間は 10 秒です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-241">The default session-timeout period for each availability replica is 10 seconds.</span></span> <span data-ttu-id="a6ae2-242">この値はユーザーが構成でき、最小値は 5 秒です。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-242">This value is user-configurable, with a minimum of 5 seconds.</span></span> <span data-ttu-id="a6ae2-243">通常は、タイムアウト期間を 10 秒以上にしておくことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-243">Generally, we recommend that you keep the time-out period at 10 seconds or greater.</span></span> <span data-ttu-id="a6ae2-244">値を 10 秒未満に設定すると、負荷の高いシステムで誤認エラーが示される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-244">Setting the value to less than 10 seconds creates the possibility of a heavily loaded system declaring a false failure.</span></span>

> [!NOTE]
>  <span data-ttu-id="a6ae2-245">解決中のロールでは、ping が発生しないため、セッション タイムアウト期間は適用されません。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-245">In the resolving role, the session-timeout period does not apply because pinging does not occur.</span></span>

##  <a name="automatic-page-repair"></a><a name="APR"></a><span data-ttu-id="a6ae2-246">ページの自動修復</span><span class="sxs-lookup"><span data-stu-id="a6ae2-246">Automatic Page Repair</span></span>
 <span data-ttu-id="a6ae2-247">各可用性レプリカでは、ローカル データベースに破損ページがあると、データ ページの読み取りを妨げるエラーを解決して自動的に復旧しようとします。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-247">Each availability replica tries to automatically recover from corrupted pages on a local database by resolving certain types of errors that prevent reading a data page.</span></span> <span data-ttu-id="a6ae2-248">セカンダリ レプリカがページを読み取ることができない場合、プライマリ レプリカに対してページの新しいコピーを要求します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-248">If a secondary replica cannot read a page, the replica requests a fresh copy of the page from the primary replica.</span></span> <span data-ttu-id="a6ae2-249">プライマリ レプリカがページを読み取ることができない場合、すべてのセカンダリ レプリカに新しいコピーの要求をブロードキャストし、最初に応答したレプリカからページを取得します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-249">If the primary replica cannot read a page, the replica broadcasts a request for a fresh copy to all the secondary replicas and gets the page from the first to respond.</span></span> <span data-ttu-id="a6ae2-250">要求が受け入れられ、新しいコピーを取得できた場合は、読み取り不可能なページがそのコピーに置き換えられます。通常、これによりエラーは解決します。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-250">If this request succeeds, the unreadable page is replaced by the copy, which usually resolves the error.</span></span>

 <span data-ttu-id="a6ae2-251">詳細については、「[ページの自動修復 &#40;可用性グループとデータベース ミラーリング&#41;](../../../sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6ae2-251">For more information, see [Automatic Page Repair &#40;For Availability Groups and Database Mirroring&#41;](../../../sql-server/failover-clusters/automatic-page-repair-availability-groups-database-mirroring.md).</span></span>

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="a6ae2-252">関連タスク</span><span class="sxs-lookup"><span data-stu-id="a6ae2-252">Related Tasks</span></span>

-   [<span data-ttu-id="a6ae2-253">はじめに AlwaysOn 可用性グループ &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a6ae2-253">Getting Started with AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](getting-started-with-always-on-availability-groups-sql-server.md)

##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="a6ae2-254">関連コンテンツ</span><span class="sxs-lookup"><span data-stu-id="a6ae2-254">Related Content</span></span>

-   <span data-ttu-id="a6ae2-255">**ブログ:**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-255">**Blogs:**</span></span>

     [<span data-ttu-id="a6ae2-256">AlwaysON - HADRON 学習シリーズ:HADRON 対応データベースでのワーカー プールの使用</span><span class="sxs-lookup"><span data-stu-id="a6ae2-256">AlwaysON - HADRON Learning Series: Worker Pool Usage for HADRON Enabled Databases</span></span>](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)

     [<span data-ttu-id="a6ae2-257">SQL Server AlwaysOn チームのブログ:SQL Server AlwaysOn チームのオフィシャル ブログ</span><span class="sxs-lookup"><span data-stu-id="a6ae2-257">SQL Server AlwaysOn Team Blogs: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)

     [<span data-ttu-id="a6ae2-258">CSS SQL Server エンジニアのブログ</span><span class="sxs-lookup"><span data-stu-id="a6ae2-258">CSS SQL Server Engineers Blogs</span></span>](https://blogs.msdn.com/b/psssql/)

-   <span data-ttu-id="a6ae2-259">**ビデオ:**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-259">**Videos:**</span></span>

     [<span data-ttu-id="a6ae2-260">Microsoft SQL Server コード ネーム "Denali" AlwaysOn シリーズ パート 1: 次世代の高可用性ソリューションの概要</span><span class="sxs-lookup"><span data-stu-id="a6ae2-260">Microsoft SQL Server Code-Named "Denali" AlwaysOn Series,Part 1: Introducing the Next Generation High Availability Solution</span></span>](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/DBI302)

     [<span data-ttu-id="a6ae2-261">Microsoft SQL Server コードネーム "Denali" AlwaysOn シリーズ パート 2: AlwaysOn を使用したミッション クリティカルな高可用性ソリューションの構築</span><span class="sxs-lookup"><span data-stu-id="a6ae2-261">Microsoft SQL Server Code-Named "Denali" AlwaysOn Series,Part 2: Building a Mission-Critical High Availability Solution Using AlwaysOn</span></span>](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/DBI404)

-   <span data-ttu-id="a6ae2-262">**ホワイト ペーパー:**</span><span class="sxs-lookup"><span data-stu-id="a6ae2-262">**Whitepapers:**</span></span>

     [<span data-ttu-id="a6ae2-263">高可用性と災害復旧のための Microsoft SQL Server AlwaysOn ソリューション ガイド</span><span class="sxs-lookup"><span data-stu-id="a6ae2-263">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)

     [<span data-ttu-id="a6ae2-264">SQL Server 2012 に関する Microsoft ホワイト ペーパー</span><span class="sxs-lookup"><span data-stu-id="a6ae2-264">Microsoft White Papers for SQL Server 2012</span></span>](https://msdn.microsoft.com/library/hh403491.aspx)

     [<span data-ttu-id="a6ae2-265">SQL Server ユーザー諮問チームのホワイト ペーパー</span><span class="sxs-lookup"><span data-stu-id="a6ae2-265">SQL Server Customer Advisory Team Whitepapers</span></span>](http://sqlcat.com/)

## <a name="see-also"></a><span data-ttu-id="a6ae2-266">参照</span><span class="sxs-lookup"><span data-stu-id="a6ae2-266">See Also</span></span>
 <span data-ttu-id="a6ae2-267">[可用性モード &#40;AlwaysOn 可用性グループ&#41;](availability-modes-always-on-availability-groups.md) [フェールオーバーとフェールオーバーモード &#40;](failover-and-failover-modes-always-on-availability-groups.md) AlwaysOn 可用性グループ&#41;の[transact-sql ステートメントの概要](transact-sql-statements-for-always-on-availability-groups.md)AlwaysOn 可用性グループ &#40;SQL Server[の PowerShell コマンドレットの概要](overview-of-powershell-cmdlets-for-always-on-availability-groups-sql-server.md)&#41;AlwaysOn 可用性グループの[インメモリ OLTP データベースの高可用性サポート](../../../relational-databases/in-memory-oltp/high-availability-support-for-in-memory-oltp-databases.md)の[前提条件 AlwaysOn 可用性グループ &#40;SQL Server の制限事項と推奨事項&#41;](prereqs-restrictions-recommendations-always-on-availability.md) [可用性グループの作成と構成](creation-and-configuration-of-availability-groups-sql-server.md)&#40;SQL Server アクティブ[なセカンダリ: 読み取り可能なセカンダリレプリカ](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md)&#41;&#40;AlwaysOn 可用性グループ[アクティブなセカンダリ: セカンダリレプリカでのバックアップ](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md)&#41;&#40;AlwaysOn 可用性グループ[可用性グループリスナー、クライアント接続、アプリケーションのフェールオーバー&#41;](../../listeners-client-connectivity-application-failover.md) &#40;SQL Server</span><span class="sxs-lookup"><span data-stu-id="a6ae2-267">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) [Failover and Failover Modes &#40;AlwaysOn Availability Groups&#41;](failover-and-failover-modes-always-on-availability-groups.md) [Overview of Transact-SQL Statements for AlwaysOn Availability Groups &#40;SQL Server&#41;](transact-sql-statements-for-always-on-availability-groups.md) [Overview of PowerShell Cmdlets for AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-powershell-cmdlets-for-always-on-availability-groups-sql-server.md) [High Availability Support for In-Memory OLTP databases](../../../relational-databases/in-memory-oltp/high-availability-support-for-in-memory-oltp-databases.md) [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md) [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](creation-and-configuration-of-availability-groups-sql-server.md) [Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) [Active Secondaries: Backup on Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md) [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)</span></span>

