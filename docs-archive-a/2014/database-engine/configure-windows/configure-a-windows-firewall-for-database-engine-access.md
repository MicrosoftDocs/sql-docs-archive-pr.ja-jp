---
title: データベース エンジン アクセスを有効にするための Windows ファイアウォールを構成する | Microsoft Docs
ms.custom: ''
ms.date: 06/22/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- connections [SQL Server], firewall systems
- firewall systems, [Database Engine]
- security [SQL Server], firewalls
ms.assetid: 0093b43c-c6b5-4574-9b30-3a0e91e1a1f9
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: f76eecb4dd48f3e7f54cad79953773f8432f416e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645863"
---
# <a name="configure-a-windows-firewall-for-database-engine-access"></a><span data-ttu-id="6a9fb-102">データベース エンジン アクセスを有効にするための Windows ファイアウォールを構成する</span><span class="sxs-lookup"><span data-stu-id="6a9fb-102">Configure a Windows Firewall for Database Engine Access</span></span>
  <span data-ttu-id="6a9fb-103">このトピックでは、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] で SQL Server 構成マネージャーを使用して、データベース エンジン アクセスのための Windows ファイアウォールを構成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-103">This topic describes how to configure a Windows firewall for Database Engine access in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using SQL Server Configuration Manager.</span></span> <span data-ttu-id="6a9fb-104">ファイアウォール システムは、コンピューター リソースへの不正アクセスを防ぐのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-104">Firewall systems help prevent unauthorized access to computer resources.</span></span> <span data-ttu-id="6a9fb-105">ファイアウォールを経由して [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] のインスタンスにアクセスするには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] を実行しているコンピューターで、アクセスを許可するようにファイアウォールを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-105">To access an instance of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] through a firewall, you must configure the firewall on the computer running [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to allow access.</span></span>  
  
 <span data-ttu-id="6a9fb-106">Windows ファイアウォールの既定の設定の詳細と、 [!INCLUDE[ssDE](../../includes/ssde-md.md)]、Analysis Services、Reporting Services、および Integration Services に影響する TCP ポートの説明については、「 [SQL Server のアクセスを許可するための Windows ファイアウォールの構成](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-106">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the [!INCLUDE[ssDE](../../includes/ssde-md.md)], Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span> <span data-ttu-id="6a9fb-107">多くのファイアウォール システムが市販されています。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-107">There are many firewall systems available.</span></span> <span data-ttu-id="6a9fb-108">システム固有の情報については、ファイアウォールのマニュアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-108">For information specific to your system, see the firewall documentation.</span></span>  
  
 <span data-ttu-id="6a9fb-109">アクセスを許可するための主な手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-109">The principal steps to allow access are:</span></span>  
  
1.  <span data-ttu-id="6a9fb-110">特定の TCP/IP ポートを使用するように [!INCLUDE[ssDE](../../includes/ssde-md.md)] を構成します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-110">Configure the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to use a specific TCP/IP port.</span></span> <span data-ttu-id="6a9fb-111">[!INCLUDE[ssDE](../../includes/ssde-md.md)] の既定のインスタンスはポート 1433 を使用しますが、使用するポートは変更できます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-111">The default instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] uses port 1433, but that can be changed.</span></span> <span data-ttu-id="6a9fb-112">[!INCLUDE[ssDE](../../includes/ssde-md.md)] で使用されているポートは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エラー ログに記録されます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-112">The port used by the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is listed in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error log.</span></span> <span data-ttu-id="6a9fb-113">[!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] と [!INCLUDE[ssEW](../../includes/ssew-md.md)] のインスタンス、および[!INCLUDE[ssDE](../../includes/ssde-md.md)]の名前付きインスタンスは動的ポートを使用します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-113">Instances of [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)], [!INCLUDE[ssEW](../../includes/ssew-md.md)], and named instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] use dynamic ports.</span></span> <span data-ttu-id="6a9fb-114">特定のポートを使うようにこれらのインスタンスを構成する方法については、「[特定の TCP ポートで受信待ちするようにサーバーを構成する方法 &#40;SQL Server 構成マネージャー&#41;](configure-a-server-to-listen-on-a-specific-tcp-port.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-114">To configure these instances to use a specific port, see [Configure a Server to Listen on a Specific TCP Port &#40;SQL Server Configuration Manager&#41;](configure-a-server-to-listen-on-a-specific-tcp-port.md).</span></span>  
  
2.  <span data-ttu-id="6a9fb-115">認証済みのユーザーまたはコンピューターが上記で構成したポートにアクセスできるように、ファイアウォールを構成します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-115">Configure the firewall to allow access to that port for authorized users or computers.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6a9fb-116">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser サービスを使用すると、ユーザーはポート番号を意識することなく、ポート 1433 でリッスンしていない [!INCLUDE[ssDE](../../includes/ssde-md.md)] のインスタンスに接続できます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-116">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service lets users connect to instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] that are not listening on port 1433, without knowing the port number.</span></span> <span data-ttu-id="6a9fb-117">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser を使用するには、UDP ポート 1434 を開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-117">To use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser, you must open UDP port 1434.</span></span> <span data-ttu-id="6a9fb-118">環境のセキュリティを最大限に強化するには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser サービスを停止した状態で、ポート 1434 を使用して接続するようにクライアントを構成します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-118">To promote the most secure environment, leave the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser service stopped, and configure clients to connect using the port number.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6a9fb-119">[!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows では、既定で Windows ファイアウォールが有効になっており、ポート 1433 が閉じられ、インターネットからコンピューターの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の既定のインスタンスに接続できない状態になっています。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-119">By default, [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows enables the Windows Firewall, which closes port 1433 to prevent Internet computers from connecting to a default instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on your computer.</span></span> <span data-ttu-id="6a9fb-120">TCP/IP を使用して既定のインスタンスに接続するには、再度ポート 1433 を開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-120">Connections to the default instance using TCP/IP are not possible unless you reopen port 1433.</span></span> <span data-ttu-id="6a9fb-121">Windows ファイアウォールの基本的な構成手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-121">The basic steps to configure the Windows firewall are provided in the following procedures.</span></span> <span data-ttu-id="6a9fb-122">詳細については、Windows のマニュアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-122">For more information, see the Windows documentation.</span></span>  
  
 <span data-ttu-id="6a9fb-123">上記の方法のように、特定のポートでリッスンするように [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] を構成してそのポートを開く代わりに、ブロックするプログラムの例外の一覧に [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の実行可能ファイル (Sqlservr.exe) を追加することもできます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-123">As an alternative to configuring [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to listen on a fixed port and opening the port, you can list the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] executable (Sqlservr.exe) as an exception to the blocked programs.</span></span> <span data-ttu-id="6a9fb-124">この方法は、引き続き動的ポートを使用するときに使用します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-124">Use this method when you want to continue to use dynamic ports.</span></span> <span data-ttu-id="6a9fb-125">この方法でアクセスできる [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスは 1 つだけです。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-125">Only one instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be accessed in this way.</span></span>  
  
 <span data-ttu-id="6a9fb-126">**このトピックの内容**</span><span class="sxs-lookup"><span data-stu-id="6a9fb-126">**In This Topic**</span></span>  
  
-   <span data-ttu-id="6a9fb-127">**作業を開始する準備:**</span><span class="sxs-lookup"><span data-stu-id="6a9fb-127">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="6a9fb-128">Security</span><span class="sxs-lookup"><span data-stu-id="6a9fb-128">Security</span></span>](#Security)  
  
-   <span data-ttu-id="6a9fb-129">**データベース エンジン アクセスを有効にするように Windows ファイアウォールを構成するには、次のものを使用します。**</span><span class="sxs-lookup"><span data-stu-id="6a9fb-129">**To configure a Windows Firewall for Database Engine access, using:**</span></span>  
  
     [<span data-ttu-id="6a9fb-130">SQL Server 構成マネージャー</span><span class="sxs-lookup"><span data-stu-id="6a9fb-130">SQL Server Configuration Manager</span></span>](#SSMSProcedure)  
  
## <a name="before-you-begin"></a><span data-ttu-id="6a9fb-131">はじめに</span><span class="sxs-lookup"><span data-stu-id="6a9fb-131">Before You Begin</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="6a9fb-132">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="6a9fb-132">Security</span></span>  
 <span data-ttu-id="6a9fb-133">ファイアウォールのポートを開くと、サーバーが攻撃を受けやすくなります。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-133">Opening ports in your firewall can leave your server exposed to malicious attacks.</span></span> <span data-ttu-id="6a9fb-134">ポートを開く前に、ファイアウォール システムについて理解しておいてください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-134">Make sure that you understand firewall systems before you open ports.</span></span> <span data-ttu-id="6a9fb-135">詳細については、「 [Security Considerations for a SQL Server Installation](../../sql-server/install/security-considerations-for-a-sql-server-installation.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-135">For more information, see [Security Considerations for a SQL Server Installation](../../sql-server/install/security-considerations-for-a-sql-server-installation.md)</span></span>  
  
##  <a name="using-sql-server-configuration-manager"></a><a name="SSMSProcedure"></a> <span data-ttu-id="6a9fb-136">SQL Server 構成マネージャーの使用</span><span class="sxs-lookup"><span data-stu-id="6a9fb-136">Using SQL Server Configuration Manager</span></span>  
 <span data-ttu-id="6a9fb-137">Windows Vista、Windows 7、および Windows Server 2008 に適用されます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-137">Applies to Windows Vista, Windows 7, and Windows Server 2008</span></span>  
  
 <span data-ttu-id="6a9fb-138">次の手順では、セキュリティが強化された Windows ファイアウォールの Microsoft 管理コンソール (MMC) スナップインを使用して Windows ファイアウォールを構成します。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-138">The following procedures configure the Windows Firewall by using the Windows Firewall with Advanced Security Microsoft Management Console (MMC) snap-in.</span></span> <span data-ttu-id="6a9fb-139">セキュリティが強化された Windows ファイアウォールでは、現在のプロファイルのみを構成できます。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-139">The Windows Firewall with Advanced Security only configures the current profile.</span></span> <span data-ttu-id="6a9fb-140">セキュリティが強化された Windows ファイアウォールの詳細については、「 [SQL Server のアクセスを許可するための Windows ファイアウォールの構成](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-140">For more information about the Windows Firewall with Advanced Security, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md)</span></span>  
  
#### <a name="to-open-a-port-in-the-windows-firewall-for-tcp-access"></a><span data-ttu-id="6a9fb-141">TCP アクセス用に Windows ファイアウォールのポートを開くには</span><span class="sxs-lookup"><span data-stu-id="6a9fb-141">To open a port in the Windows firewall for TCP access</span></span>  
  
1.  <span data-ttu-id="6a9fb-142">**[スタート]** ボタンをクリックし、 **[ファイル名を指定して実行]** をクリックして **「WF.msc」** と入力し、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-142">On the **Start** menu, click **Run**, type **WF.msc**, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="6a9fb-143">**[セキュリティが強化された Windows ファイアウォール]** の左ペインの **[受信の規則]** をクリックし、[操作] ペインの **[新規の規則]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-143">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule** in the action pane.</span></span>  
  
3.  <span data-ttu-id="6a9fb-144">**[規則の種類]** ダイアログ ボックスで、 **[ポート]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-144">In the **Rule Type** dialog box, select **Port**, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="6a9fb-145">**[プロトコルおよびポート]** ダイアログ ボックスで、 **[TCP]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-145">In the **Protocol and Ports** dialog box, select **TCP**.</span></span> <span data-ttu-id="6a9fb-146">[**特定のローカルポート**] を選択し、のインスタンスのポート番号を入力し [!INCLUDE[ssDE](../../includes/ssde-md.md)] `1433` ます (既定のインスタンスの場合など)。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-146">Select **Specific local ports**, and then type the port number of the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)], such as `1433` for the default instance.</span></span> <span data-ttu-id="6a9fb-147">**[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-147">Click **Next**.</span></span>  
  
5.  <span data-ttu-id="6a9fb-148">**[操作]** ダイアログ ボックスで、 **[接続を許可する]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-148">In the **Action** dialog box, select **Allow the connection**, and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="6a9fb-149">**[プロファイル]** ダイアログ ボックスで、 [!INCLUDE[ssDE](../../includes/ssde-md.md)]に接続するときのコンピューター接続環境を表すプロファイルをすべて選択し、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-149">In the **Profile** dialog box, select any profiles that describe the computer connection environment when you want to connect to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="6a9fb-150">**[名前]** ダイアログ ボックスで、この規則の名前と説明を入力し、 **[完了]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-150">In the **Name** dialog box, type a name and description for this rule, and then click **Finish**.</span></span>  
  
#### <a name="to-open-access-to-sql-server-when-using-dynamic-ports"></a><span data-ttu-id="6a9fb-151">動的ポートの使用時に SQL Server にアクセスするには</span><span class="sxs-lookup"><span data-stu-id="6a9fb-151">To open access to SQL Server when using dynamic ports</span></span>  
  
1.  <span data-ttu-id="6a9fb-152">**[スタート]** ボタンをクリックし、 **[ファイル名を指定して実行]** をクリックして **「WF.msc」** と入力し、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-152">On the **Start** menu, click **Run**, type **WF.msc**, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="6a9fb-153">**[セキュリティが強化された Windows ファイアウォール]** の左ペインの **[受信の規則]** をクリックし、[操作] ペインの **[新規の規則]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-153">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule** in the action pane.</span></span>  
  
3.  <span data-ttu-id="6a9fb-154">**[規則の種類]** ダイアログ ボックスで、 **[プログラム]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-154">In the **Rule Type** dialog box, select **Program**, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="6a9fb-155">**[プログラム]** ダイアログ ボックスで、 **[このプログラムのパス]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-155">In the **Program** dialog box, select **This program path**.</span></span> <span data-ttu-id="6a9fb-156">**[参照]** をクリックし、ファイアウォール経由でアクセスする [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスに移動して、 **[開く]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-156">Click **Browse**, and navigate to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that you want to access through the firewall, and then click **Open**.</span></span> <span data-ttu-id="6a9fb-157">既定で [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] は、は**C:\PROGRAM の SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Sqlservr.exe**にあります。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-157">By default, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is at **C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Sqlservr.exe**.</span></span> <span data-ttu-id="6a9fb-158">**[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-158">Click **Next**.</span></span>  
  
5.  <span data-ttu-id="6a9fb-159">**[操作]** ダイアログ ボックスで、 **[接続を許可する]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-159">In the **Action** dialog box, select **Allow the connection**, and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="6a9fb-160">**[プロファイル]** ダイアログ ボックスで、 [!INCLUDE[ssDE](../../includes/ssde-md.md)]に接続するときのコンピューター接続環境を表すプロファイルをすべて選択し、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-160">In the **Profile** dialog box, select any profiles that describe the computer connection environment when you want to connect to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="6a9fb-161">**[名前]** ダイアログ ボックスで、この規則の名前と説明を入力し、 **[完了]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="6a9fb-161">In the **Name** dialog box, type a name and description for this rule, and then click **Finish**.</span></span>  
  
  
