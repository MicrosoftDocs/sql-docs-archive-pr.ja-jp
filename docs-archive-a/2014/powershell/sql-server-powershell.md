---
title: SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
ms.assetid: 89b70725-bbe7-4ffe-a27d-2a40005a97e7
author: stevestein
ms.author: sstein
ms.openlocfilehash: 87b4a21bf46bb27fba604c81af633576da6342c9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87715469"
---
# <a name="sql-server-powershell"></a><span data-ttu-id="a1947-102">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1947-102">SQL Server PowerShell</span></span>
  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="a1947-103">は、Windows PowerShell をサポートしています。これは、管理者および開発者がサーバー管理やアプリケーション配置を自動化できる強力なスクリプティング シェルです。</span><span class="sxs-lookup"><span data-stu-id="a1947-103">supports Windows PowerShell, which is a powerful scripting shell that lets administrators and developers automate server administration and application deployment.</span></span> <span data-ttu-id="a1947-104">Windows PowerShell 言語では [!INCLUDE[tsql](../includes/tsql-md.md)] スクリプトよりも複雑なロジックがサポートされ、 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理者は堅牢な管理スクリプトを構築できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-104">The Windows PowerShell language supports more complex logic than [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, giving [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] administrators the ability to build robust administration scripts.</span></span> <span data-ttu-id="a1947-105">Windows PowerShell スクリプトは他の [!INCLUDE[msCoName](../includes/msconame-md.md)] サーバー製品の管理にも使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-105">Windows PowerShell scripts can also be used to administer other [!INCLUDE[msCoName](../includes/msconame-md.md)] server products.</span></span> <span data-ttu-id="a1947-106">そのため、管理者はサーバー間で共通のスクリプト言語を使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="a1947-106">This gives administrators a common scripting language across servers.</span></span>  
  
## <a name="sql-server-powershell-components"></a><span data-ttu-id="a1947-107">SQL Server PowerShell のコンポーネント</span><span class="sxs-lookup"><span data-stu-id="a1947-107">SQL Server PowerShell Components</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="a1947-108">には、`sqlps` という Windows PowerShell モジュールが用意されており、これを使用して Windows PowerShell 2.0 環境またはスクリプトに [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] コンポーネントをインポートします。</span><span class="sxs-lookup"><span data-stu-id="a1947-108">provides a Windows PowerShell module named `sqlps` that is used to import the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components into a Windows PowerShell 2.0 environment or script.</span></span> <span data-ttu-id="a1947-109">`sqlps` モジュールは、以下のものを実装する 2 つの Windows PowerShell スナップインを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="a1947-109">The `sqlps` module loads two Windows PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="a1947-110">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] プロバイダー。プロバイダーを使用すると、ファイル システム パスと同様の簡単なナビゲーション メカニズムを使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-110">A [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider, which enables a simple navigation mechanism similar to file system paths.</span></span> <span data-ttu-id="a1947-111">ファイル システム パスと同様に、ドライブが [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理オブジェクト モデルに関連付けられ、ノードがオブジェクト モデルのクラスに基づくパスを構築できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-111">You can build paths similar to file system paths, where the drive is associated with a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model, and the nodes are based on the object model classes.</span></span> <span data-ttu-id="a1947-112">その後、 **cd** や **dir** などのなじみのあるコマンドを使用して、コマンド プロンプト ウィンドウでフォルダーを操作するのと同様の方法でパスを操作できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-112">You can then use familiar commands such as **cd** and **dir** to navigate the paths similar to the way you navigate folders in a command prompt window.</span></span> <span data-ttu-id="a1947-113">**ren** や **del**などの他のコマンドを使用すると、パスのノードで操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-113">You can use other commands, such as **ren** or **del**, to perform actions on the nodes in the path.</span></span>  
  
-   <span data-ttu-id="a1947-114">コマンドレットのセット。Windows PowerShell スクリプトで [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] の操作を指定するために使用されるコマンドです。</span><span class="sxs-lookup"><span data-stu-id="a1947-114">A set of cmdlets, which are commands used in Windows PowerShell scripts to specify a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] action.</span></span> <span data-ttu-id="a1947-115">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] コマンドレットは、 **または XQuery ステートメントを含む** sqlcmd [!INCLUDE[tsql](../includes/tsql-md.md)] スクリプトの実行などの操作をサポートします。</span><span class="sxs-lookup"><span data-stu-id="a1947-115">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets support actions such as running a **sqlcmd** script containing [!INCLUDE[tsql](../includes/tsql-md.md)] or XQuery statements.</span></span>  
  
 <span data-ttu-id="a1947-116">Windows PowerShell について学習するには、「[Windows PowerShell ファースト ステップ ガイド](https://msdn.microsoft.com/library/hh857337.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a1947-116">To learn about Windows PowerShell, see the [Windows PowerShell Getting Started Guide](https://msdn.microsoft.com/library/hh857337.aspx).</span></span>  
  
## <a name="sql-server-versions"></a><span data-ttu-id="a1947-117">SQL Server のバージョン</span><span class="sxs-lookup"><span data-stu-id="a1947-117">SQL Server Versions</span></span>  
 <span data-ttu-id="a1947-118">[!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell コンポーネントを使用して管理できるのは、 [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] 以降のインスタンスです。</span><span class="sxs-lookup"><span data-stu-id="a1947-118">The [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components can be used to manage instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] or later.</span></span> <span data-ttu-id="a1947-119">[!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] のインスタンスは、SP2 以降を実行している必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1947-119">Instances of [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] must be running SP2 or later.</span></span> <span data-ttu-id="a1947-120">[!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] のインスタンスは、SP4 以降を実行している必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1947-120">Instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] must be running SP4 or later.</span></span> <span data-ttu-id="a1947-121">以前のバージョンの [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] で [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]PowerShell コンポーネントを使用した場合、その機能は、以前のバージョンで利用できる機能に限定されます。</span><span class="sxs-lookup"><span data-stu-id="a1947-121">When the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components are used with earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], they are limited to the functionality available in those versions.</span></span>  
  
## <a name="sql-server-powershell-tasks"></a><span data-ttu-id="a1947-122">SQL Server PowerShell のタスク</span><span class="sxs-lookup"><span data-stu-id="a1947-122">SQL Server PowerShell Tasks</span></span>  
  
|<span data-ttu-id="a1947-123">タスクの説明</span><span class="sxs-lookup"><span data-stu-id="a1947-123">Task Description</span></span>|<span data-ttu-id="a1947-124">トピック</span><span class="sxs-lookup"><span data-stu-id="a1947-124">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="a1947-125">PowerShell セッションを開き、`sqlps` モジュールを読み込むという、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell コンポーネントを実行するための推奨メカニズムについて説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-125">Describes the preferred mechanism for running the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell components; to open a PowerShell session and load the `sqlps` module.</span></span> <span data-ttu-id="a1947-126">`sqlps` モジュールは、[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell プロバイダーおよびコマンドレットと、それらによって使用される SQL Server 管理オブジェクト (SMO) アセンブリを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="a1947-126">The `sqlps` module loads in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell provider and cmdlets, and the SQL Server Management Object (SMO) assemblies used by the provider and cmdlets.</span></span>|[<span data-ttu-id="a1947-127">SQLPS モジュールのインポート</span><span class="sxs-lookup"><span data-stu-id="a1947-127">Import the SQLPS Module</span></span>](../database-engine/import-the-sqlps-module.md)|  
|<span data-ttu-id="a1947-128">プロバイダーもコマンドレットも読み込まず、SMO アセンブリだけを読み込む方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-128">Describes how to load only the SMO assemblies without the provider or cmdlets.</span></span>|[<span data-ttu-id="a1947-129">Windows PowerShell への SMO アセンブリの読み込み</span><span class="sxs-lookup"><span data-stu-id="a1947-129">Load the SMO Assemblies in Windows PowerShell</span></span>](load-the-smo-assemblies-in-windows-powershell.md)|  
|<span data-ttu-id="a1947-130">**オブジェクト エクスプローラー**でノードを右クリックすることによって Windows PowerShell セッションを実行する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-130">Describes how to run a Windows PowerShell session by right-clicking a node in **Object Explorer**.</span></span> [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)] <span data-ttu-id="a1947-131">によって Windows PowerShell セッションが起動され、`sqlps` モジュールが読み込まれて、選択したオブジェクトへの SQL Server プロバイダー パスが設定されます。</span><span class="sxs-lookup"><span data-stu-id="a1947-131">launches a Windows PowerShell session, loads the `sqlps` module, and sets the SQL Server provider path to the object selected.</span></span>|[<span data-ttu-id="a1947-132">SQL Server Management Studio から Windows PowerShell を実行する方法</span><span class="sxs-lookup"><span data-stu-id="a1947-132">Run Windows PowerShell from SQL Server Management Studio</span></span>](run-windows-powershell-from-sql-server-management-studio.md)|  
|<span data-ttu-id="a1947-133">Windows PowerShell スクリプトを実行する SQL Server エージェントのジョブ ステップを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-133">Describes how to create SQL Server Agent job steps that run a Windows PowerShell script.</span></span> <span data-ttu-id="a1947-134">ジョブは、特定の時刻に実行したり、イベントに応答して実行したりするように設定できます。</span><span class="sxs-lookup"><span data-stu-id="a1947-134">The jobs can then be scheduled to run at specific times or in response to events.</span></span>|[<span data-ttu-id="a1947-135">SQL Server エージェントでの Windows PowerShell ステップの実行</span><span class="sxs-lookup"><span data-stu-id="a1947-135">Run Windows PowerShell Steps in SQL Server Agent</span></span>](run-windows-powershell-steps-in-sql-server-agent.md)|  
|<span data-ttu-id="a1947-136">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] オブジェクトの階層を移動するために [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] プロバイダーを使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-136">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider to navigate a hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects.</span></span>|[<span data-ttu-id="a1947-137">SQL Server PowerShell プロバイダー</span><span class="sxs-lookup"><span data-stu-id="a1947-137">SQL Server PowerShell Provider</span></span>](sql-server-powershell-provider.md)|  
|<span data-ttu-id="a1947-138">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] スクリプトの実行などの [!INCLUDE[ssDE](../includes/ssde-md.md)] 操作を指定する [!INCLUDE[tsql](../includes/tsql-md.md)] コマンドレットを使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-138">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets that specify [!INCLUDE[ssDE](../includes/ssde-md.md)] actions such as running a [!INCLUDE[tsql](../includes/tsql-md.md)] script.</span></span>|[<span data-ttu-id="a1947-139">データベース エンジン コマンドレットの使用</span><span class="sxs-lookup"><span data-stu-id="a1947-139">Use the Database Engine cmdlets</span></span>](../database-engine/use-the-database-engine-cmdlets.md)|  
|<span data-ttu-id="a1947-140">Windows PowerShell でサポートされていない文字を含む、 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] の区切られた識別子を指定する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-140">Describes how to specify [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] delimited identifiers that contain characters not supported by Windows PowerShell.</span></span>|[<span data-ttu-id="a1947-141">PowerShell での SQL Server 識別子</span><span class="sxs-lookup"><span data-stu-id="a1947-141">SQL Server Identifiers in PowerShell</span></span>](sql-server-identifiers-in-powershell.md)|  
|<span data-ttu-id="a1947-142">SQL Server 認証接続を確立する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-142">Describes how to make SQL Server Authentication connections.</span></span> <span data-ttu-id="a1947-143">既定では、SQL Server PowerShell コンポーネントは、Windows PowerShell を実行しているプロセスの Windows 資格情報を使用する Windows 認証接続を使用します。</span><span class="sxs-lookup"><span data-stu-id="a1947-143">By default, the SQL Server PowerShell components use Windows Authentication connections using the Windows credentials of the process running Windows PowerShell.</span></span>|[<span data-ttu-id="a1947-144">データベース エンジン PowerShell での認証の管理</span><span class="sxs-lookup"><span data-stu-id="a1947-144">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
|<span data-ttu-id="a1947-145">Windows PowerShell のタブ補完を使用する場合に一覧に表示されるオブジェクトの数を制御するために、SQL Server PowerShell プロバイダーによって実装されている変数を使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-145">Describes how to use variables implemented by the SQL Server PowerShell provider to control how many objects are listed when using Windows PowerShell tab completion.</span></span> <span data-ttu-id="a1947-146">これは、多数のオブジェクトを含むデータベースで作業する場合に、特に便利です。</span><span class="sxs-lookup"><span data-stu-id="a1947-146">This is particularly useful when working on databases that contain large numbers of objects.</span></span>|[<span data-ttu-id="a1947-147">タブ補完の管理 &#40;SQL Server PowerShell&#41;</span><span class="sxs-lookup"><span data-stu-id="a1947-147">Manage Tab Completion &#40;SQL Server PowerShell&#41;</span></span>](manage-tab-completion-sql-server-powershell.md)|  
|<span data-ttu-id="a1947-148">Windows PowerShell 環境で [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] コンポーネントの情報を取得するために Get-Help を使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1947-148">Describes how to use Get-Help to get information about the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components in the Windows PowerShell environment.</span></span>|[<span data-ttu-id="a1947-149">Get Help SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1947-149">Get Help SQL Server PowerShell</span></span>](../database-engine/get-help-sql-server-powershell.md)|  
  
  
