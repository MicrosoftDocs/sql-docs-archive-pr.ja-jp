---
title: 参照データ (外部) のナレッジを使用したデータのクレンジング | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-quality-services
ms.topic: conceptual
ms.assetid: 158009e9-8069-4741-8085-c14a5518d3fc
author: lrtoyou1223
ms.author: lle
ms.openlocfilehash: 107fd3bbf3c6f14e50cb6527400697aab7c7d6a8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87712421"
---
# <a name="cleanse-data-using-reference-data-external-knowledge"></a><span data-ttu-id="02f68-102">参照データ (外部) のナレッジを使用したデータのクレンジング</span><span class="sxs-lookup"><span data-stu-id="02f68-102">Cleanse Data Using Reference Data (External) Knowledge</span></span>
  <span data-ttu-id="02f68-103">このトピックでは、参照データ プロバイダーから提供されるナレッジを使用してデータをクレンジングする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="02f68-103">This topic describes how to cleanse data using knowledge from the reference data providers.</span></span> <span data-ttu-id="02f68-104">クレンジング アクティビティを実行する手順は、参照データ プロバイダーから提供されるナレッジを使ってデータをクレンジングする場合も「[DQS &#40;内部&#41; ナレッジを使用したデータのクレンジング](../../2014/data-quality-services/cleanse-data-using-dqs-internal-knowledge.md)」で説明した手順とすべて同じですが、このトピックでは、[!INCLUDE[ssDQSnoversion](../includes/ssdqsnoversion-md.md)] (DQS) での参照データ サービスを使ったデータ クレンジングに固有の情報を示します。</span><span class="sxs-lookup"><span data-stu-id="02f68-104">While all the steps of running a cleansing activity remains the same for cleansing your data using knowledge from the reference data providers as explained in the [Cleanse Data Using DQS &#40;Internal&#41; Knowledge](../../2014/data-quality-services/cleanse-data-using-dqs-internal-knowledge.md), this topic provides information specific to data cleansing using reference data service in [!INCLUDE[ssDQSnoversion](../includes/ssdqsnoversion-md.md)] (DQS).</span></span>

 <span data-ttu-id="02f68-105">DQS の参照データ サービス機能を使用してデータをクレンジングする場合、DQS のクレンジング プロセスで、マップされたドメイン値がバッチ要求として参照データ サービス プロバイダーに送信されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-105">When you use the reference data service feature in DQS to cleanse your data, the DQS cleansing process sends the mapped domain values to the reference data service provider as a batch request.</span></span> <span data-ttu-id="02f68-106">参照データ サービスから、次の情報を含む応答が返されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-106">The reference data service responds with the following information:</span></span>

-   <span data-ttu-id="02f68-107">修正案</span><span class="sxs-lookup"><span data-stu-id="02f68-107">Suggested correction</span></span>

-   <span data-ttu-id="02f68-108">Confidence</span><span class="sxs-lookup"><span data-stu-id="02f68-108">Confidence</span></span>

-   <span data-ttu-id="02f68-109">マップされたドメインに関する追加情報。</span><span class="sxs-lookup"><span data-stu-id="02f68-109">Additional information about the mapped domain.</span></span> <span data-ttu-id="02f68-110">参照データでは、この追加データを使用してソースを標準化、解析、または強化することもできます。</span><span class="sxs-lookup"><span data-stu-id="02f68-110">Reference data can also standardize, parse, or enrich the source with additional data.</span></span> <span data-ttu-id="02f68-111">この情報は応答の追加フィールドに記載されています。</span><span class="sxs-lookup"><span data-stu-id="02f68-111">This information is provided in additional fields in the response.</span></span>

 <span data-ttu-id="02f68-112">参照データ サービスから応答を受け取った後、DQS のクレンジング アクティビティで次の処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="02f68-112">After getting the response from reference data service, the following happens in DQS during the cleansing activity:</span></span>

-   <span data-ttu-id="02f68-113">ドメインを参照データ サービスにマップするときに指定した **[自動修正しきい値]** と **[最小信頼度]** の値に基づいて、ドメイン値が信頼レベルに応じて自動的に修正または提案されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-113">Based on the **Auto Correction Threshold** and **Min Confidence** values specified during mapping of the domains with reference data service, domain values are automatically corrected or suggested based on the confidence level.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="02f68-114">参照データ サービスのナレッジを使用してデータをクレンジングするときは、 **[全般設定]** タブの **[構成]** セクションで指定したしきい値ではなく、参照データ サービスにドメインをマップするときに指定したしきい値が適用されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-114">The threshold values that you specify during mapping a domain to a reference data service are applied while cleansing data using the knowledge in reference data service, and not the ones that are specified in the **General Settings** tab in the **Configuration** section.</span></span> <span data-ttu-id="02f68-115">参照データクレンジングのしきい値を指定する方法の詳細については、「[参照データへのドメインまたは複合ドメインのアタッチ](../../2014/data-quality-services/attach-a-domain-or-composite-domain-to-reference-data.md)」の手順 9. を参照してください。</span><span class="sxs-lookup"><span data-stu-id="02f68-115">For information about specifying threshold values for reference data cleansing, see step 9 in [Attach a Domain or Composite Domain to Reference Data](../../2014/data-quality-services/attach-a-domain-or-composite-domain-to-reference-data.md).</span></span>

-   <span data-ttu-id="02f68-116">ドメイン値が " **提案**"、" **新規**"、" **無効**"、" **修正済み**"、および " **適切**" に分類されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-116">Domain values are categorized into the following: **Suggested**, **New**, **Invalid**, **Corrected**, and **Correct**.</span></span>

-   <span data-ttu-id="02f68-117">追加データがソースに追加され、クレンジングされたデータと一緒に情報をエクスポートできるようになります。</span><span class="sxs-lookup"><span data-stu-id="02f68-117">Additional data is appended to the source, and the information is available along with the cleansed data for exporting.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="02f68-118">はじめに</span><span class="sxs-lookup"><span data-stu-id="02f68-118">Before You Begin</span></span>

###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="02f68-119">前提条件</span><span class="sxs-lookup"><span data-stu-id="02f68-119">Prerequisites</span></span>
 <span data-ttu-id="02f68-120">DQS のナレッジ ベース内の必要なドメインを適切な参照データ サービスにマップしておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="02f68-120">You must have mapped required domains in a DQS knowledge base to the appropriate reference data service.</span></span> <span data-ttu-id="02f68-121">また、クレンジングするデータの種類に関するナレッジがナレッジ ベースに含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="02f68-121">Additionally, the knowledge base must contain knowledge about the type of data that you want to cleanse.</span></span> <span data-ttu-id="02f68-122">たとえば、米国の住所が格納されたソース データをクレンジングする場合は、米国の住所に関する高品質データを提供する参照データ サービス プロバイダーにドメインをマップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="02f68-122">For example, if you want to cleanse your source data that contains US addresses, you must map your domains to a reference data service provider that provides high-quality" data for US addresses.</span></span> <span data-ttu-id="02f68-123">詳細については、「[参照データへのドメインまたは複合ドメインのアタッチ](../../2014/data-quality-services/attach-a-domain-or-composite-domain-to-reference-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="02f68-123">For more information, see [Attach a Domain or Composite Domain to Reference Data](../../2014/data-quality-services/attach-a-domain-or-composite-domain-to-reference-data.md).</span></span>

###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="02f68-124">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="02f68-124">Security</span></span>

####  <a name="permissions"></a><a name="Permissions"></a> <span data-ttu-id="02f68-125">Permissions</span><span class="sxs-lookup"><span data-stu-id="02f68-125">Permissions</span></span>
 <span data-ttu-id="02f68-126">データ クレンジングを実行するには、DQS_MAIN データベースの dqs_kb_editor ロールまたは dqs_kb_operator ロールが必要です。</span><span class="sxs-lookup"><span data-stu-id="02f68-126">You must have the dqs_kb_editor or dqs_kb_operator role on the DQS_MAIN database to perform data cleansing.</span></span>

##  <a name="cleanse-your-data-using-reference-data-knowledge"></a><a name="Cleanse"></a> <span data-ttu-id="02f68-127">参照データのナレッジを使用したデータのクレンジング</span><span class="sxs-lookup"><span data-stu-id="02f68-127">Cleanse Your Data Using Reference Data Knowledge</span></span>
 <span data-ttu-id="02f68-128">ここでは、Azure Marketplace の Melissa Data service を使用して、前のトピック「[ドメインまたは複合ドメインを参照データにアタッチ](../../2014/data-quality-services/attach-a-domain-or-composite-domain-to-reference-data.md)する」でマップしたドメインを使用する例についても説明します。</span><span class="sxs-lookup"><span data-stu-id="02f68-128">We will continue with the same example of using the domains that we mapped in the previous topic, [Attach a Domain or Composite Domain to Reference Data](../../2014/data-quality-services/attach-a-domain-or-composite-domain-to-reference-data.md), with the Melissa Data service in Azure Marketplace.</span></span> <span data-ttu-id="02f68-129">ここでは、同じドメインを使用して、いくつかのサンプルの米国の住所をクレンジングします。</span><span class="sxs-lookup"><span data-stu-id="02f68-129">Now, we will use the same domains to cleanse some sample US addresses.</span></span> <span data-ttu-id="02f68-130">データをクレンジングする手順は、「[DQS &#40;内部&#41; ナレッジを使用したデータのクレンジング](../../2014/data-quality-services/cleanse-data-using-dqs-internal-knowledge.md)」で説明されているものと同じです。</span><span class="sxs-lookup"><span data-stu-id="02f68-130">The steps to cleanse data are the same as described in [Cleanse Data Using DQS &#40;Internal&#41; Knowledge](../../2014/data-quality-services/cleanse-data-using-dqs-internal-knowledge.md).</span></span> <span data-ttu-id="02f68-131">処理中に注意が必要な箇所には説明を補足しています。</span><span class="sxs-lookup"><span data-stu-id="02f68-131">However, we will draw you attention wherever necessary during the process.</span></span>

1.  <span data-ttu-id="02f68-132">データ品質プロジェクトを作成し、 **[クレンジング]** アクティビティを選択します。</span><span class="sxs-lookup"><span data-stu-id="02f68-132">Create a data quality project, and select the **Cleansing** activity.</span></span> <span data-ttu-id="02f68-133">「 [Create a Data Quality Project](../../2014/data-quality-services/create-a-data-quality-project.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="02f68-133">See [Create a Data Quality Project](../../2014/data-quality-services/create-a-data-quality-project.md).</span></span>

2.  <span data-ttu-id="02f68-134">**[マップ]** ページで、 **Address Line**、 **City**、 **State**、および **Zip**の 4 つのドメインをソース データの適切な列にマップします。</span><span class="sxs-lookup"><span data-stu-id="02f68-134">On the **Map** page, map the following 4 domains with appropriate columns in your source data: **Address Line**, **City**, **State**, and **Zip**.</span></span> <span data-ttu-id="02f68-135">**[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02f68-135">Click **Next**.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="02f68-136">**Address Verification** 複合ドメイン内の 4 つのドメインをすべてマップしているため、データ クレンジングは、個々のドメイン レベルではなく、複合ドメイン レベルで実行されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-136">As you have mapped all the 4 domains within the **Address Verification** composite domain, the data cleansing will now be done at the composite domain level, and not at the individual domain level.</span></span>

3.  <span data-ttu-id="02f68-137">**[最適化]** ページで、 **[開始]** をクリックしてコンピューター支援型のクレンジング プロセスを実行します。</span><span class="sxs-lookup"><span data-stu-id="02f68-137">On the **Cleanse** page, run the computer-assisted cleansing process by clicking **Start**.</span></span> <span data-ttu-id="02f68-138">クレンジング プロセスが完了したら、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02f68-138">After the cleansing process is over, click **Next**.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="02f68-139">**[最適化]** ページには、参照データ サービスにアタッチされているドメインに関する情報が次の 2 とおりの方法で表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-139">On the **Cleanse** page, DQS displays information about the domains that are attached to reference data service in the following two ways:</span></span>
    > 
    >  -   <span data-ttu-id="02f68-140">[**開始**] ボタンの下に、"Domains \<Domain1> , \<Domain2> ,... \<DomainN> というメッセージが表示されます。参照データサービスプロバイダーを使用してクレンジングされます。 "</span><span class="sxs-lookup"><span data-stu-id="02f68-140">A message is displayed below the **Start** button: "Domains \<Domain1>, \<Domain2>,... \<DomainN> are cleansed using reference data service provider."</span></span> <span data-ttu-id="02f68-141">この例の場合、"ドメイン Address Verification を、参照データ サービス プロバイダーを使用してクレンジングします" というメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-141">In this example, the following message will be displayed: "Domain Address Verification is cleansed using reference data service provider."</span></span>
    > -   <span data-ttu-id="02f68-142">アイコン (![ドメインが RDS にアタッチ](../../2014/data-quality-services/media/dqs-rdsindicator.JPG "RDS にドメインがアタッチされている")されている) が、参照データサービスプロバイダーにアタッチされているドメインに対して**プロファイラー**領域に表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-142">An icon, ![Domain is attached to RDS](../../2014/data-quality-services/media/dqs-rdsindicator.JPG "Domain is attached to RDS"), is displayed in the **Profiler** area against the domains attached to reference data service provider.</span></span> <span data-ttu-id="02f68-143">この例の場合、 **Address Verification** 複合ドメインに対してこのアイコンが表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-143">In this example, the icon will be displayed against the **Address Verification** composite domain.</span></span>

4.  <span data-ttu-id="02f68-144">**[結果の管理と表示]** ページで、ドメイン値を確認します。</span><span class="sxs-lookup"><span data-stu-id="02f68-144">On the **Manage and view results** page, review your domain values.</span></span> <span data-ttu-id="02f68-145">参照データ サービスでは、値に対する提案が複数ある場合、参照データ サービスにドメインをマップするときに **[提案された候補]** ボックスで指定した提案の最大数に応じて表示できます。</span><span class="sxs-lookup"><span data-stu-id="02f68-145">The reference data service can display more than one suggestion, if available, for a value depending upon the maximum number of suggestions specified in the **Suggested Candidates** box during the mapping of the domain to the reference data service.</span></span> <span data-ttu-id="02f68-146">たとえば、次の米国の住所に対しては 2 つの提案が表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-146">For example, two suggestions are displayed for the following US address:</span></span>

     <span data-ttu-id="02f68-147">**元の値:**</span><span class="sxs-lookup"><span data-stu-id="02f68-147">**Original value:**</span></span>

    |<span data-ttu-id="02f68-148">Address Line</span><span class="sxs-lookup"><span data-stu-id="02f68-148">Address Line</span></span>|<span data-ttu-id="02f68-149">City</span><span class="sxs-lookup"><span data-stu-id="02f68-149">City</span></span>|<span data-ttu-id="02f68-150">State</span><span class="sxs-lookup"><span data-stu-id="02f68-150">State</span></span>|<span data-ttu-id="02f68-151">Zip</span><span class="sxs-lookup"><span data-stu-id="02f68-151">Zip</span></span>|
    |------------------|----------|-----------|---------|
    |<span data-ttu-id="02f68-152">1 msft way</span><span class="sxs-lookup"><span data-stu-id="02f68-152">1 msft way</span></span>|<span data-ttu-id="02f68-153">レドモンド</span><span class="sxs-lookup"><span data-stu-id="02f68-153">Redmond</span></span>||<span data-ttu-id="02f68-154">98052</span><span class="sxs-lookup"><span data-stu-id="02f68-154">98052</span></span>|

     <span data-ttu-id="02f68-155">**推奨される値:**</span><span class="sxs-lookup"><span data-stu-id="02f68-155">**Suggested values:**</span></span>

    |<span data-ttu-id="02f68-156">Address Line</span><span class="sxs-lookup"><span data-stu-id="02f68-156">Address Line</span></span>|<span data-ttu-id="02f68-157">City</span><span class="sxs-lookup"><span data-stu-id="02f68-157">City</span></span>|<span data-ttu-id="02f68-158">State</span><span class="sxs-lookup"><span data-stu-id="02f68-158">State</span></span>|<span data-ttu-id="02f68-159">Zip</span><span class="sxs-lookup"><span data-stu-id="02f68-159">Zip</span></span>|
    |------------------|----------|-----------|---------|
    |<span data-ttu-id="02f68-160">1 Microsoft Way</span><span class="sxs-lookup"><span data-stu-id="02f68-160">1 Microsoft Way</span></span>|<span data-ttu-id="02f68-161">レドモンド</span><span class="sxs-lookup"><span data-stu-id="02f68-161">Redmond</span></span>|<span data-ttu-id="02f68-162">WA</span><span class="sxs-lookup"><span data-stu-id="02f68-162">WA</span></span>|<span data-ttu-id="02f68-163">98052</span><span class="sxs-lookup"><span data-stu-id="02f68-163">98052</span></span>|
    |<span data-ttu-id="02f68-164">PO Box 1</span><span class="sxs-lookup"><span data-stu-id="02f68-164">PO Box 1</span></span>|<span data-ttu-id="02f68-165">レドモンド</span><span class="sxs-lookup"><span data-stu-id="02f68-165">Redmond</span></span>|<span data-ttu-id="02f68-166">WA</span><span class="sxs-lookup"><span data-stu-id="02f68-166">WA</span></span>|<span data-ttu-id="02f68-167">98073</span><span class="sxs-lookup"><span data-stu-id="02f68-167">98073</span></span>|

     <span data-ttu-id="02f68-168">![Reference Data Services の使用によるクレンジング](../../2014/data-quality-services/media/dqs-rdscleansing.JPG "Reference Data Services の使用によるクレンジング")</span><span class="sxs-lookup"><span data-stu-id="02f68-168">![Cleansing using reference data service](../../2014/data-quality-services/media/dqs-rdscleansing.JPG "Cleansing using reference data service")</span></span>

    > [!NOTE]
    >  <span data-ttu-id="02f68-169">複合ドメインについては、さらに、コンピューター支援型のクレンジング プロセスで修正された個々のドメインが別の色で強調表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-169">For composite domains, DQS also highlights the individual domains in a different color that were corrected during the computer-assisted cleansing process.</span></span> <span data-ttu-id="02f68-170">たとえば、この例では、 **Address Line** ドメインと **State** ドメインが修正されているため、それらのドメインがシアンで強調表示されます。</span><span class="sxs-lookup"><span data-stu-id="02f68-170">For example, in this case, the **Address Line** and **State** domains were corrected, and therefore highlighted in cyan.</span></span>

5.  <span data-ttu-id="02f68-171">すべてのドメイン値の確認が完了したら、 **[次へ]** をクリックしてデータをエクスポートします。</span><span class="sxs-lookup"><span data-stu-id="02f68-171">After you are done with reviewing all the domain values, click **Next** to export the data.</span></span>

6.  <span data-ttu-id="02f68-172">**[エクスポート]** ページに、各ドメインのクレンジング アクティビティに関する通常の情報 (ソース、理由、信頼度、およびステータス) に加え、住所データに関して Melissa Data 参照データ サービスから提供された追加の情報が表示されます。これには、住所の経度と緯度、郡の名前、住所タイプ (高層ビルや番地) などが含まれます。</span><span class="sxs-lookup"><span data-stu-id="02f68-172">On the **Export** page, you will notice that apart from the regular information about the cleansing activity for each domain (Source, Reason, Confidence, and Status), there is additional information provided by the Melissa Data reference data service about your address data, such as latitude and longitude of your address, county name, address type (highrise, street, etc.), and so on.</span></span>

7.  <span data-ttu-id="02f68-173">目的のエクスポート先 (SQL Server、CSV、または Excel) にデータをエクスポートし、 **[完了]** をクリックしてプロジェクトを閉じます。</span><span class="sxs-lookup"><span data-stu-id="02f68-173">Export your data to the required destination (SQL Server, CSV, or Excel), and click **Finish** to close the project.</span></span>

    > [!IMPORTANT]
    >  <span data-ttu-id="02f68-174">Excel の 64 ビット版を使用している場合、クレンジングされたデータは Excel ファイルにエクスポートできません。SQL Server データベースまたは .csv ファイルにのみエクスポートできます。</span><span class="sxs-lookup"><span data-stu-id="02f68-174">If you are using 64-bit version of Excel, you cannot export the cleansed data to an Excel file; you can export only to a SQL Server database or to a .csv file.</span></span>


