---
title: 行グループの集約 (Visual Database Tools) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- group collapsing [SQL Server]
- collapsing rows
- row collapsing [SQL Server]
ms.assetid: 7338dad0-965d-44ba-8c1a-b993acb7156d
author: stevestein
ms.author: sstein
ms.openlocfilehash: f7ec2f3072f9fea7c96179934924421080e75821
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634751"
---
# <a name="collapse-groups-of-rows-visual-database-tools"></a><span data-ttu-id="f77fa-102">行グループの集約 (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="f77fa-102">Collapse Groups of Rows (Visual Database Tools)</span></span>
  <span data-ttu-id="f77fa-103">基になるデータの行グループ全体に結果の各行が対応するようなクエリ結果を作成することができます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-103">You can create a query result in which each result row corresponds to an entire group of rows from the original data.</span></span> <span data-ttu-id="f77fa-104">行を集約するときは、次の点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="f77fa-104">When collapsing rows, there are several things to keep in mind:</span></span>  
  
-   <span data-ttu-id="f77fa-105">**重複する行を除外する** クエリによっては、同じ行が複数出現する結果セットが作成されます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-105">**You can eliminate duplicate rows** Some queries can create result sets in which multiple identical rows appear.</span></span> <span data-ttu-id="f77fa-106">たとえば、著者の居住地の市町村名と州名を各行に含む結果セットを作成するとします。この場合、複数の著者が住む市町村があると、同じ行が複数作成されます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-106">For example, you can create a result set in which each row contains the city and state name of a city containing an author - but if a city contains several authors, there will be several identical rows.</span></span> <span data-ttu-id="f77fa-107">結果の SQL ステートメントは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-107">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state  
    FROM authors  
    ```  
  
     <span data-ttu-id="f77fa-108">前のクエリで生成される結果セットは、あまり役に立ちません。</span><span class="sxs-lookup"><span data-stu-id="f77fa-108">The result set generated by the preceding query is not very useful.</span></span> <span data-ttu-id="f77fa-109">たとえば、ある市に 4 人の著者が住んでいる場合、結果セットには同じ行が 4 つ含まれることになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-109">If a city contains four authors, the result set will include four identical rows.</span></span> <span data-ttu-id="f77fa-110">結果セットには市町村名と州名以外の列は含まれていないので、同じ行を相互に区別する方法はありません。</span><span class="sxs-lookup"><span data-stu-id="f77fa-110">Since the result set does not include any columns other than city and state, there is no way to distinguish the identical rows from each other.</span></span> <span data-ttu-id="f77fa-111">重複する行の生成を防ぐ 1 つの方法は、各行を区別する列を追加することです。</span><span class="sxs-lookup"><span data-stu-id="f77fa-111">One way to avoid such duplicate rows is to include additional columns that can make the rows different.</span></span> <span data-ttu-id="f77fa-112">たとえば、著者の名前の列を加えると、同じ市内に同じ名前の著者が 2 人いない限り、各行を区別できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-112">For example, if you include author name, each row will be different (provided no two like-named authors live within any one city).</span></span> <span data-ttu-id="f77fa-113">結果の SQL ステートメントは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-113">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, fname, minit, lname  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="f77fa-114">上記のクエリを使用すると問題の状況は回避できますが、この方法では、問題を根本的に解決することはできません。</span><span class="sxs-lookup"><span data-stu-id="f77fa-114">Of course, the preceding query eliminates the symptom, but does not really solve the problem.</span></span> <span data-ttu-id="f77fa-115">つまり、結果セットから重複が除去される代わりに、結果セットが市町村に関するものではなくなってしまいます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-115">That is, the result set has no duplicates, but it is no longer a result set about cities.</span></span> <span data-ttu-id="f77fa-116">元の結果セットにあった重複を除去し、その上で各行が市町村の情報を示すようにするには、異なる行だけを返すクエリを作成します。</span><span class="sxs-lookup"><span data-stu-id="f77fa-116">To eliminate duplicates in the original result set, and still have each row describe a city, you can create a query returning only distinct rows.</span></span> <span data-ttu-id="f77fa-117">結果の SQL ステートメントは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-117">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT DISTINCT city, state  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="f77fa-118">重複除去の詳細については、「[重複する行の除外 (Visual Database Tools)](visual-database-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f77fa-118">For details about eliminating duplicates, see [Exclude Duplicate Rows &#40;Visual Database Tools&#41;](visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="f77fa-119">**行グループに対して計算を行う** 行グループの情報をまとめることができます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-119">**You can calculate on groups of rows** That is, you can summarize information in groups of rows.</span></span> <span data-ttu-id="f77fa-120">たとえば、著者の居住する市と州の名前、およびその市に居住する著者の人数を各行に格納した結果セットを作成できます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-120">For example, you can create a result set in which each row contains the city and state name of a city containing an author, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="f77fa-121">結果の SQL ステートメントは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-121">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
  
    ```  
  
     <span data-ttu-id="f77fa-122">行グループに対する計算については、「[クエリ結果の要約 (Visual Database Tools)](summarize-query-results-visual-database-tools.md)」と「[クエリ結果の並べ替えおよびグループ化 (Visual Database Tools)](sort-and-group-query-results-visual-database-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f77fa-122">For details about calculating on groups of rows, see [Summarize Query Results &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) and [Sort and Group Query Results &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="f77fa-123">**行グループを含む選択条件を使用する** たとえば、複数の著者が住んでいる市と州の名前、およびその市に住んでいる著者の数が各行に格納された結果セットを作成できます。</span><span class="sxs-lookup"><span data-stu-id="f77fa-123">**You can use selection criteria to include groups of rows** For example, you can create a result set in which each row contains the city and state name of a city containing several authors, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="f77fa-124">結果の SQL ステートメントは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="f77fa-124">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
    HAVING COUNT(*) > 1  
  
    ```  
  
     <span data-ttu-id="f77fa-125">行グループに選択条件を適用する方法については、「[グループの条件を指定する方法 (Visual Database Tools)](specify-conditions-for-groups-visual-database-tools.md)」と「[同一クエリ内で HAVING 句および WHERE 句を使用する (Visual Database Tools)](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f77fa-125">For details about applying selection criteria on groups of rows, see [Specify Conditions for Groups &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) and [Use HAVING and WHERE Clauses in the Same Query &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f77fa-126">参照</span><span class="sxs-lookup"><span data-stu-id="f77fa-126">See Also</span></span>  
 <span data-ttu-id="f77fa-127">[Visual Database Tools &#40;検索条件を指定し&#41;](specify-search-criteria-visual-database-tools.md) </span><span class="sxs-lookup"><span data-stu-id="f77fa-127">[Specify Search Criteria &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span></span>  
 [<span data-ttu-id="f77fa-128">クエリおよびビューのデザインの操作方法に関するトピック (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="f77fa-128">Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;</span></span>](design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
  
