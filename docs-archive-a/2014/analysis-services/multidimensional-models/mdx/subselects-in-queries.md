---
title: クエリ内のサブセレクト |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 9e361798-688e-4b11-9eef-31fc793e8ba4
author: minewiskan
ms.author: owend
ms.openlocfilehash: 41471645e3443d59294f980eba35fbf9074d7728
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87737033"
---
# <a name="subselects-in-queries"></a><span data-ttu-id="d865c-102">クエリのサブセレクト</span><span class="sxs-lookup"><span data-stu-id="d865c-102">Subselects in Queries</span></span>
  <span data-ttu-id="d865c-103">サブセレクト式とは、入れ子になった SELECT 式です。この式は、外側にある外部の SELECT が評価されているキューブ空間を制限するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="d865c-103">Subselect expressions are nested SELECT expressions that are used to restrict the space of the cube from where the outer external SELECT is being evaluated.</span></span> <span data-ttu-id="d865c-104">サブセレクトにより、すべての計算が評価される新しい空間を定義できます。</span><span class="sxs-lookup"><span data-stu-id="d865c-104">Subselects allow you to define a new space over which all calculations are evaluated.</span></span>  
  
## <a name="subselects-by-example"></a><span data-ttu-id="d865c-105">サブセレクトの例</span><span class="sxs-lookup"><span data-stu-id="d865c-105">Subselects by example</span></span>  
 <span data-ttu-id="d865c-106">表示させたい結果を生成するために、サブセレクトがどのように機能するかを示す例を見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="d865c-106">Let's begin with an example of how subselects can help to produce the results we want to show.</span></span> <span data-ttu-id="d865c-107">上位 10 製品の数年間の販売動向を示す表を生成するように要求されたとします。</span><span class="sxs-lookup"><span data-stu-id="d865c-107">Assume that you are requested to produce a table that shows the sales behavior, over years, for the top 10 products.</span></span>  
  
 <span data-ttu-id="d865c-108">結果は以下の表のようになります。</span><span class="sxs-lookup"><span data-stu-id="d865c-108">The result should look like the following table:</span></span>  
  
|||||  
|-|-|-|-|  
||<span data-ttu-id="d865c-109">Sum of Years</span><span class="sxs-lookup"><span data-stu-id="d865c-109">Sum of Years</span></span>|<span data-ttu-id="d865c-110">Year 1</span><span class="sxs-lookup"><span data-stu-id="d865c-110">Year 1</span></span>|<span data-ttu-id="d865c-111">...</span><span class="sxs-lookup"><span data-stu-id="d865c-111">...</span></span>|  
|<span data-ttu-id="d865c-112">Sum of Top 10 Products</span><span class="sxs-lookup"><span data-stu-id="d865c-112">Sum of Top 10 Products</span></span>||||  
|<span data-ttu-id="d865c-113">Product A</span><span class="sxs-lookup"><span data-stu-id="d865c-113">Product A</span></span>||||  
|<span data-ttu-id="d865c-114">...</span><span class="sxs-lookup"><span data-stu-id="d865c-114">...</span></span>||||  
  
 <span data-ttu-id="d865c-115">上記のようなことを実行するために、次の MDX 式を記述します。</span><span class="sxs-lookup"><span data-stu-id="d865c-115">To do something like the above one could write the following MDX expression:</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , TOPCOUNT( [Product].[Product].MEMBERS  
               , 10  
               , [Measures].[Sales Amount]  
               ) ON 1  
  FROM [Adventure Works]  
```  
  
 <span data-ttu-id="d865c-116">次の結果を返します。</span><span class="sxs-lookup"><span data-stu-id="d865c-116">That returns the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-117">All Periods</span><span class="sxs-lookup"><span data-stu-id="d865c-117">All Periods</span></span>|<span data-ttu-id="d865c-118">CY 2005</span><span class="sxs-lookup"><span data-stu-id="d865c-118">CY 2005</span></span>|<span data-ttu-id="d865c-119">CY 2006</span><span class="sxs-lookup"><span data-stu-id="d865c-119">CY 20062</span></span>|<span data-ttu-id="d865c-120">CY 2007</span><span class="sxs-lookup"><span data-stu-id="d865c-120">CY 2007</span></span>|<span data-ttu-id="d865c-121">CY 2008</span><span class="sxs-lookup"><span data-stu-id="d865c-121">CY 2008</span></span>|  
|<span data-ttu-id="d865c-122">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-122">All Products</span></span>|<span data-ttu-id="d865c-123">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-123">$80,450,596.98</span></span>|<span data-ttu-id="d865c-124">$8,065,435.31</span><span class="sxs-lookup"><span data-stu-id="d865c-124">$8,065,435.31</span></span>|<span data-ttu-id="d865c-125">$24,144,429.65</span><span class="sxs-lookup"><span data-stu-id="d865c-125">$24,144,429.65</span></span>|<span data-ttu-id="d865c-126">$32,202,669.43</span><span class="sxs-lookup"><span data-stu-id="d865c-126">$32,202,669.43</span></span>|<span data-ttu-id="d865c-127">$16,038,062.60</span><span class="sxs-lookup"><span data-stu-id="d865c-127">$16,038,062.60</span></span>|  
|<span data-ttu-id="d865c-128">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-128">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-129">$1,634,647.94</span><span class="sxs-lookup"><span data-stu-id="d865c-129">$1,634,647.94</span></span>|<span data-ttu-id="d865c-130">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-130">(null)</span></span>|<span data-ttu-id="d865c-131">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-131">(null)</span></span>|<span data-ttu-id="d865c-132">$894,207.97</span><span class="sxs-lookup"><span data-stu-id="d865c-132">$894,207.97</span></span>|<span data-ttu-id="d865c-133">$740,439.97</span><span class="sxs-lookup"><span data-stu-id="d865c-133">$740,439.97</span></span>|  
|<span data-ttu-id="d865c-134">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-134">Mountain-200 Black, 42</span></span>|<span data-ttu-id="d865c-135">$1,285,524.65</span><span class="sxs-lookup"><span data-stu-id="d865c-135">$1,285,524.65</span></span>|<span data-ttu-id="d865c-136">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-136">(null)</span></span>|<span data-ttu-id="d865c-137">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-137">(null)</span></span>|<span data-ttu-id="d865c-138">$722,137.65</span><span class="sxs-lookup"><span data-stu-id="d865c-138">$722,137.65</span></span>|<span data-ttu-id="d865c-139">$563,387.00</span><span class="sxs-lookup"><span data-stu-id="d865c-139">$563,387.00</span></span>|  
|<span data-ttu-id="d865c-140">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-140">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="d865c-141">$1,181,945.82</span><span class="sxs-lookup"><span data-stu-id="d865c-141">$1,181,945.82</span></span>|<span data-ttu-id="d865c-142">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-142">(null)</span></span>|<span data-ttu-id="d865c-143">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-143">(null)</span></span>|<span data-ttu-id="d865c-144">$634,600.78</span><span class="sxs-lookup"><span data-stu-id="d865c-144">$634,600.78</span></span>|<span data-ttu-id="d865c-145">$547,345.03</span><span class="sxs-lookup"><span data-stu-id="d865c-145">$547,345.03</span></span>|  
|<span data-ttu-id="d865c-146">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-146">Mountain-200 Black, 46</span></span>|<span data-ttu-id="d865c-147">$995,927.43</span><span class="sxs-lookup"><span data-stu-id="d865c-147">$995,927.43</span></span>|<span data-ttu-id="d865c-148">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-148">(null)</span></span>|<span data-ttu-id="d865c-149">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-149">(null)</span></span>|<span data-ttu-id="d865c-150">$514,995.76</span><span class="sxs-lookup"><span data-stu-id="d865c-150">$514,995.76</span></span>|<span data-ttu-id="d865c-151">$480,931.68</span><span class="sxs-lookup"><span data-stu-id="d865c-151">$480,931.68</span></span>|  
|<span data-ttu-id="d865c-152">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-152">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="d865c-153">$1,005,111.77</span><span class="sxs-lookup"><span data-stu-id="d865c-153">$1,005,111.77</span></span>|<span data-ttu-id="d865c-154">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-154">(null)</span></span>|<span data-ttu-id="d865c-155">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-155">(null)</span></span>|<span data-ttu-id="d865c-156">$529,543.29</span><span class="sxs-lookup"><span data-stu-id="d865c-156">$529,543.29</span></span>|<span data-ttu-id="d865c-157">$475,568.49</span><span class="sxs-lookup"><span data-stu-id="d865c-157">$475,568.49</span></span>|  
|<span data-ttu-id="d865c-158">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-158">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="d865c-159">$975,932.56</span><span class="sxs-lookup"><span data-stu-id="d865c-159">$975,932.56</span></span>|<span data-ttu-id="d865c-160">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-160">(null)</span></span>|<span data-ttu-id="d865c-161">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-161">(null)</span></span>|<span data-ttu-id="d865c-162">$526,759.30</span><span class="sxs-lookup"><span data-stu-id="d865c-162">$526,759.30</span></span>|<span data-ttu-id="d865c-163">$449,173.26</span><span class="sxs-lookup"><span data-stu-id="d865c-163">$449,173.26</span></span>|  
|<span data-ttu-id="d865c-164">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="d865c-164">Road-150 Red, 56</span></span>|<span data-ttu-id="d865c-165">$792,228.98</span><span class="sxs-lookup"><span data-stu-id="d865c-165">$792,228.98</span></span>|<span data-ttu-id="d865c-166">$382,159.24</span><span class="sxs-lookup"><span data-stu-id="d865c-166">$382,159.24</span></span>|<span data-ttu-id="d865c-167">$410,069.74</span><span class="sxs-lookup"><span data-stu-id="d865c-167">$410,069.74</span></span>|<span data-ttu-id="d865c-168">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-168">(null)</span></span>|<span data-ttu-id="d865c-169">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-169">(null)</span></span>|  
|<span data-ttu-id="d865c-170">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-170">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-171">$1,471,078.72</span><span class="sxs-lookup"><span data-stu-id="d865c-171">$1,471,078.72</span></span>|<span data-ttu-id="d865c-172">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-172">(null)</span></span>|<span data-ttu-id="d865c-173">$789,958.49</span><span class="sxs-lookup"><span data-stu-id="d865c-173">$789,958.49</span></span>|<span data-ttu-id="d865c-174">$681,120.23</span><span class="sxs-lookup"><span data-stu-id="d865c-174">$681,120.23</span></span>|<span data-ttu-id="d865c-175">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-175">(null)</span></span>|  
|<span data-ttu-id="d865c-176">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="d865c-176">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="d865c-177">$1,380,253.88</span><span class="sxs-lookup"><span data-stu-id="d865c-177">$1,380,253.88</span></span>|<span data-ttu-id="d865c-178">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-178">(null)</span></span>|<span data-ttu-id="d865c-179">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-179">(null)</span></span>|<span data-ttu-id="d865c-180">$744,988.37</span><span class="sxs-lookup"><span data-stu-id="d865c-180">$744,988.37</span></span>|<span data-ttu-id="d865c-181">$635,265.50</span><span class="sxs-lookup"><span data-stu-id="d865c-181">$635,265.50</span></span>|  
  
 <span data-ttu-id="d865c-182">これは必要としているものに非常に似ていますが、クエリが 10 製品ではなく 9 製品を返した点と、All Products の合計が、返された上位 9 製品ではなくすべての製品の合計を反映している点が異なります (この例の場合)。</span><span class="sxs-lookup"><span data-stu-id="d865c-182">Which is very close to what we are looking for; except that the query returned 9 not 10 products and the All Products total reflects the sum of all products not the sum of the returned Top 9 (in this case).</span></span> <span data-ttu-id="d865c-183">この問題を解決するための別の例を、次の MDX クエリに示します。</span><span class="sxs-lookup"><span data-stu-id="d865c-183">Another attempt to solve the problem is presented in the following MDX query:</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , TOPCOUNT( [Product].[Product].CHILDREN, 10, [Measures].[Sales Amount]) ON 1  
  FROM [Adventure Works]  
```  
  
 <span data-ttu-id="d865c-184">次の結果を返します。</span><span class="sxs-lookup"><span data-stu-id="d865c-184">That returns the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-185">All Periods</span><span class="sxs-lookup"><span data-stu-id="d865c-185">All Periods</span></span>|<span data-ttu-id="d865c-186">CY 2005</span><span class="sxs-lookup"><span data-stu-id="d865c-186">CY 2005</span></span>|<span data-ttu-id="d865c-187">CY 2006</span><span class="sxs-lookup"><span data-stu-id="d865c-187">CY 2006</span></span>|<span data-ttu-id="d865c-188">CY 2007</span><span class="sxs-lookup"><span data-stu-id="d865c-188">CY 2007</span></span>|<span data-ttu-id="d865c-189">CY 2008</span><span class="sxs-lookup"><span data-stu-id="d865c-189">CY 2008</span></span>|  
|<span data-ttu-id="d865c-190">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-190">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-191">$1,634,647.94</span><span class="sxs-lookup"><span data-stu-id="d865c-191">$1,634,647.94</span></span>|<span data-ttu-id="d865c-192">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-192">(null)</span></span>|<span data-ttu-id="d865c-193">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-193">(null)</span></span>|<span data-ttu-id="d865c-194">$894,207.97</span><span class="sxs-lookup"><span data-stu-id="d865c-194">$894,207.97</span></span>|<span data-ttu-id="d865c-195">$740,439.97</span><span class="sxs-lookup"><span data-stu-id="d865c-195">$740,439.97</span></span>|  
|<span data-ttu-id="d865c-196">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-196">Mountain-200 Black, 42</span></span>|<span data-ttu-id="d865c-197">$1,285,524.65</span><span class="sxs-lookup"><span data-stu-id="d865c-197">$1,285,524.65</span></span>|<span data-ttu-id="d865c-198">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-198">(null)</span></span>|<span data-ttu-id="d865c-199">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-199">(null)</span></span>|<span data-ttu-id="d865c-200">$722,137.65</span><span class="sxs-lookup"><span data-stu-id="d865c-200">$722,137.65</span></span>|<span data-ttu-id="d865c-201">$563,387.00</span><span class="sxs-lookup"><span data-stu-id="d865c-201">$563,387.00</span></span>|  
|<span data-ttu-id="d865c-202">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-202">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="d865c-203">$1,181,945.82</span><span class="sxs-lookup"><span data-stu-id="d865c-203">$1,181,945.82</span></span>|<span data-ttu-id="d865c-204">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-204">(null)</span></span>|<span data-ttu-id="d865c-205">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-205">(null)</span></span>|<span data-ttu-id="d865c-206">$634,600.78</span><span class="sxs-lookup"><span data-stu-id="d865c-206">$634,600.78</span></span>|<span data-ttu-id="d865c-207">$547,345.03</span><span class="sxs-lookup"><span data-stu-id="d865c-207">$547,345.03</span></span>|  
|<span data-ttu-id="d865c-208">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-208">Mountain-200 Black, 46</span></span>|<span data-ttu-id="d865c-209">$995,927.43</span><span class="sxs-lookup"><span data-stu-id="d865c-209">$995,927.43</span></span>|<span data-ttu-id="d865c-210">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-210">(null)</span></span>|<span data-ttu-id="d865c-211">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-211">(null)</span></span>|<span data-ttu-id="d865c-212">$514,995.76</span><span class="sxs-lookup"><span data-stu-id="d865c-212">$514,995.76</span></span>|<span data-ttu-id="d865c-213">$480,931.68</span><span class="sxs-lookup"><span data-stu-id="d865c-213">$480,931.68</span></span>|  
|<span data-ttu-id="d865c-214">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-214">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="d865c-215">$1,005,111.77</span><span class="sxs-lookup"><span data-stu-id="d865c-215">$1,005,111.77</span></span>|<span data-ttu-id="d865c-216">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-216">(null)</span></span>|<span data-ttu-id="d865c-217">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-217">(null)</span></span>|<span data-ttu-id="d865c-218">$529,543.29</span><span class="sxs-lookup"><span data-stu-id="d865c-218">$529,543.29</span></span>|<span data-ttu-id="d865c-219">$475,568.49</span><span class="sxs-lookup"><span data-stu-id="d865c-219">$475,568.49</span></span>|  
|<span data-ttu-id="d865c-220">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-220">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="d865c-221">$975,932.56</span><span class="sxs-lookup"><span data-stu-id="d865c-221">$975,932.56</span></span>|<span data-ttu-id="d865c-222">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-222">(null)</span></span>|<span data-ttu-id="d865c-223">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-223">(null)</span></span>|<span data-ttu-id="d865c-224">$526,759.30</span><span class="sxs-lookup"><span data-stu-id="d865c-224">$526,759.30</span></span>|<span data-ttu-id="d865c-225">$449,173.26</span><span class="sxs-lookup"><span data-stu-id="d865c-225">$449,173.26</span></span>|  
|<span data-ttu-id="d865c-226">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="d865c-226">Road-150 Red, 56</span></span>|<span data-ttu-id="d865c-227">$792,228.98</span><span class="sxs-lookup"><span data-stu-id="d865c-227">$792,228.98</span></span>|<span data-ttu-id="d865c-228">$382,159.24</span><span class="sxs-lookup"><span data-stu-id="d865c-228">$382,159.24</span></span>|<span data-ttu-id="d865c-229">$410,069.74</span><span class="sxs-lookup"><span data-stu-id="d865c-229">$410,069.74</span></span>|<span data-ttu-id="d865c-230">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-230">(null)</span></span>|<span data-ttu-id="d865c-231">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-231">(null)</span></span>|  
|<span data-ttu-id="d865c-232">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-232">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-233">$1,471,078.72</span><span class="sxs-lookup"><span data-stu-id="d865c-233">$1,471,078.72</span></span>|<span data-ttu-id="d865c-234">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-234">(null)</span></span>|<span data-ttu-id="d865c-235">$789,958.49</span><span class="sxs-lookup"><span data-stu-id="d865c-235">$789,958.49</span></span>|<span data-ttu-id="d865c-236">$681,120.23</span><span class="sxs-lookup"><span data-stu-id="d865c-236">$681,120.23</span></span>|<span data-ttu-id="d865c-237">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-237">(null)</span></span>|  
|<span data-ttu-id="d865c-238">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="d865c-238">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="d865c-239">$1,380,253.88</span><span class="sxs-lookup"><span data-stu-id="d865c-239">$1,380,253.88</span></span>|<span data-ttu-id="d865c-240">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-240">(null)</span></span>|<span data-ttu-id="d865c-241">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-241">(null)</span></span>|<span data-ttu-id="d865c-242">$744,988.37</span><span class="sxs-lookup"><span data-stu-id="d865c-242">$744,988.37</span></span>|<span data-ttu-id="d865c-243">$635,265.50</span><span class="sxs-lookup"><span data-stu-id="d865c-243">$635,265.50</span></span>|  
|<span data-ttu-id="d865c-244">Road-150 Red, 62</span><span class="sxs-lookup"><span data-stu-id="d865c-244">Road-150 Red, 62</span></span>|<span data-ttu-id="d865c-245">$566,797.97</span><span class="sxs-lookup"><span data-stu-id="d865c-245">$566,797.97</span></span>|<span data-ttu-id="d865c-246">$234,018.86</span><span class="sxs-lookup"><span data-stu-id="d865c-246">$234,018.86</span></span>|<span data-ttu-id="d865c-247">$332,779.11</span><span class="sxs-lookup"><span data-stu-id="d865c-247">$332,779.11</span></span>|<span data-ttu-id="d865c-248">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-248">(null)</span></span>|<span data-ttu-id="d865c-249">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-249">(null)</span></span>|  
  
 <span data-ttu-id="d865c-250">これは、製品の合計のみが欠落しているので、求める結果に非常に近い形です。</span><span class="sxs-lookup"><span data-stu-id="d865c-250">That was very close to the desired result because it only missed the sum of the products.</span></span> <span data-ttu-id="d865c-251">この時点で、欠落している行を追加するように上記の MDX 式に手を加えることができますが、この作業は複雑になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d865c-251">At this point one can start tweaking the above MDX expression to add the missing line; however, that task could prove to be a cumbersome one.</span></span>  
  
 <span data-ttu-id="d865c-252">この問題を解決するために、MDX 式が評価されるキューブ空間の再定義という観点から別の方法を検討してみましょう。</span><span class="sxs-lookup"><span data-stu-id="d865c-252">Another approach to solve the problem, would be to start thinking in terms of redefining the cube space over which the MDX expression is resolved.</span></span> <span data-ttu-id="d865c-253">'新しい' キューブに上位 10 製品のデータのみを含めたら、どうなるでしょうか。</span><span class="sxs-lookup"><span data-stu-id="d865c-253">What if the 'new' cube contains only data from the Top 10 products?</span></span> <span data-ttu-id="d865c-254">このようなキューブにすると、上位 10 製品のみに適応するすべてのメンバーが含まれるようになり、単純なクエリでニーズを満たすようになります。</span><span class="sxs-lookup"><span data-stu-id="d865c-254">That cube then will have the All member adjusted to the Top 10 products only and now a simple query would resolve our needs.</span></span>  
  
 <span data-ttu-id="d865c-255">次の MDX 式は、サブセレクト ステートメントを使用して上位 10 製品のキューブ空間を再定義し、目的の結果を生成します。</span><span class="sxs-lookup"><span data-stu-id="d865c-255">The following MDX expression uses a subselect statement to redefine the cube space to the Top 10 products and produce the desired results:</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN  
                       , 10  
                       , [Measures].[Sales Amount]  
                       ) ON 0  
          FROM [Adventure Works]  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="d865c-256">上の式の結果は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="d865c-256">The above expression returns the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-257">All Periods</span><span class="sxs-lookup"><span data-stu-id="d865c-257">All Periods</span></span>|<span data-ttu-id="d865c-258">CY 2005</span><span class="sxs-lookup"><span data-stu-id="d865c-258">CY 2005</span></span>|<span data-ttu-id="d865c-259">CY 2006</span><span class="sxs-lookup"><span data-stu-id="d865c-259">CY 2006</span></span>|<span data-ttu-id="d865c-260">CY 2007</span><span class="sxs-lookup"><span data-stu-id="d865c-260">CY 2007</span></span>|<span data-ttu-id="d865c-261">CY 2008</span><span class="sxs-lookup"><span data-stu-id="d865c-261">CY 2008</span></span>|  
|<span data-ttu-id="d865c-262">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-262">All Products</span></span>|<span data-ttu-id="d865c-263">$19,997,183.30</span><span class="sxs-lookup"><span data-stu-id="d865c-263">$19,997,183.30</span></span>|<span data-ttu-id="d865c-264">$1,696,815.63</span><span class="sxs-lookup"><span data-stu-id="d865c-264">$1,696,815.63</span></span>|<span data-ttu-id="d865c-265">$2,816,611.28</span><span class="sxs-lookup"><span data-stu-id="d865c-265">$2,816,611.28</span></span>|<span data-ttu-id="d865c-266">$7,930,797.72</span><span class="sxs-lookup"><span data-stu-id="d865c-266">$7,930,797.72</span></span>|<span data-ttu-id="d865c-267">$7,552,958.66</span><span class="sxs-lookup"><span data-stu-id="d865c-267">$7,552,958.66</span></span>|  
|<span data-ttu-id="d865c-268">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-268">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="d865c-269">$2,160,981.60</span><span class="sxs-lookup"><span data-stu-id="d865c-269">$2,160,981.60</span></span>|<span data-ttu-id="d865c-270">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-270">(null)</span></span>|<span data-ttu-id="d865c-271">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-271">(null)</span></span>|<span data-ttu-id="d865c-272">$1,024,359.10</span><span class="sxs-lookup"><span data-stu-id="d865c-272">$1,024,359.10</span></span>|<span data-ttu-id="d865c-273">$1,136,622.49</span><span class="sxs-lookup"><span data-stu-id="d865c-273">$1,136,622.49</span></span>|  
|<span data-ttu-id="d865c-274">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-274">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="d865c-275">$1,914,547.85</span><span class="sxs-lookup"><span data-stu-id="d865c-275">$1,914,547.85</span></span>|<span data-ttu-id="d865c-276">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-276">(null)</span></span>|<span data-ttu-id="d865c-277">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-277">(null)</span></span>|<span data-ttu-id="d865c-278">$903,061.68</span><span class="sxs-lookup"><span data-stu-id="d865c-278">$903,061.68</span></span>|<span data-ttu-id="d865c-279">$1,011,486.18</span><span class="sxs-lookup"><span data-stu-id="d865c-279">$1,011,486.18</span></span>|  
|<span data-ttu-id="d865c-280">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-280">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="d865c-281">$1,906,248.55</span><span class="sxs-lookup"><span data-stu-id="d865c-281">$1,906,248.55</span></span>|<span data-ttu-id="d865c-282">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-282">(null)</span></span>|<span data-ttu-id="d865c-283">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-283">(null)</span></span>|<span data-ttu-id="d865c-284">$877,077.79</span><span class="sxs-lookup"><span data-stu-id="d865c-284">$877,077.79</span></span>|<span data-ttu-id="d865c-285">$1,029,170.76</span><span class="sxs-lookup"><span data-stu-id="d865c-285">$1,029,170.76</span></span>|  
|<span data-ttu-id="d865c-286">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-286">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-287">$1,811,229.02</span><span class="sxs-lookup"><span data-stu-id="d865c-287">$1,811,229.02</span></span>|<span data-ttu-id="d865c-288">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-288">(null)</span></span>|<span data-ttu-id="d865c-289">$896,511.60</span><span class="sxs-lookup"><span data-stu-id="d865c-289">$896,511.60</span></span>|<span data-ttu-id="d865c-290">$914,717.43</span><span class="sxs-lookup"><span data-stu-id="d865c-290">$914,717.43</span></span>|<span data-ttu-id="d865c-291">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-291">(null)</span></span>|  
|<span data-ttu-id="d865c-292">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-292">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-293">$2,589,363.78</span><span class="sxs-lookup"><span data-stu-id="d865c-293">$2,589,363.78</span></span>|<span data-ttu-id="d865c-294">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-294">(null)</span></span>|<span data-ttu-id="d865c-295">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-295">(null)</span></span>|<span data-ttu-id="d865c-296">$1,261,406.37</span><span class="sxs-lookup"><span data-stu-id="d865c-296">$1,261,406.37</span></span>|<span data-ttu-id="d865c-297">$1,327,957.41</span><span class="sxs-lookup"><span data-stu-id="d865c-297">$1,327,957.41</span></span>|  
|<span data-ttu-id="d865c-298">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-298">Mountain-200 Black, 42</span></span>|<span data-ttu-id="d865c-299">$2,265,485.38</span><span class="sxs-lookup"><span data-stu-id="d865c-299">$2,265,485.38</span></span>|<span data-ttu-id="d865c-300">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-300">(null)</span></span>|<span data-ttu-id="d865c-301">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-301">(null)</span></span>|<span data-ttu-id="d865c-302">$1,126,055.89</span><span class="sxs-lookup"><span data-stu-id="d865c-302">$1,126,055.89</span></span>|<span data-ttu-id="d865c-303">$1,139,429.49</span><span class="sxs-lookup"><span data-stu-id="d865c-303">$1,139,429.49</span></span>|  
|<span data-ttu-id="d865c-304">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-304">Mountain-200 Black, 46</span></span>|<span data-ttu-id="d865c-305">$1,957,528.24</span><span class="sxs-lookup"><span data-stu-id="d865c-305">$1,957,528.24</span></span>|<span data-ttu-id="d865c-306">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-306">(null)</span></span>|<span data-ttu-id="d865c-307">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-307">(null)</span></span>|<span data-ttu-id="d865c-308">$946,453.88</span><span class="sxs-lookup"><span data-stu-id="d865c-308">$946,453.88</span></span>|<span data-ttu-id="d865c-309">$1,011,074.37</span><span class="sxs-lookup"><span data-stu-id="d865c-309">$1,011,074.37</span></span>|  
|<span data-ttu-id="d865c-310">Road-150 Red, 62</span><span class="sxs-lookup"><span data-stu-id="d865c-310">Road-150 Red, 62</span></span>|<span data-ttu-id="d865c-311">$1,769,096.69</span><span class="sxs-lookup"><span data-stu-id="d865c-311">$1,769,096.69</span></span>|<span data-ttu-id="d865c-312">$828,011.68</span><span class="sxs-lookup"><span data-stu-id="d865c-312">$828,011.68</span></span>|<span data-ttu-id="d865c-313">$941,085.01</span><span class="sxs-lookup"><span data-stu-id="d865c-313">$941,085.01</span></span>|<span data-ttu-id="d865c-314">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-314">(null)</span></span>|<span data-ttu-id="d865c-315">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-315">(null)</span></span>|  
|<span data-ttu-id="d865c-316">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="d865c-316">Road-150 Red, 56</span></span>|<span data-ttu-id="d865c-317">$1,847,818.63</span><span class="sxs-lookup"><span data-stu-id="d865c-317">$1,847,818.63</span></span>|<span data-ttu-id="d865c-318">$868,803.96</span><span class="sxs-lookup"><span data-stu-id="d865c-318">$868,803.96</span></span>|<span data-ttu-id="d865c-319">$979,014.67</span><span class="sxs-lookup"><span data-stu-id="d865c-319">$979,014.67</span></span>|<span data-ttu-id="d865c-320">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-320">(null)</span></span>|<span data-ttu-id="d865c-321">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-321">(null)</span></span>|  
|<span data-ttu-id="d865c-322">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="d865c-322">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="d865c-323">$1,774,883.56</span><span class="sxs-lookup"><span data-stu-id="d865c-323">$1,774,883.56</span></span>|<span data-ttu-id="d865c-324">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-324">(null)</span></span>|<span data-ttu-id="d865c-325">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-325">(null)</span></span>|<span data-ttu-id="d865c-326">$877,665.59</span><span class="sxs-lookup"><span data-stu-id="d865c-326">$877,665.59</span></span>|<span data-ttu-id="d865c-327">$897,217.96</span><span class="sxs-lookup"><span data-stu-id="d865c-327">$897,217.96</span></span>|  
  
 <span data-ttu-id="d865c-328">上記の結果は求めているものと一致します。</span><span class="sxs-lookup"><span data-stu-id="d865c-328">The results above are exactly what we were looking for.</span></span>  
  
 <span data-ttu-id="d865c-329">サブセレクトによってどのようなことが行われたかを詳細に見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="d865c-329">Let's review what exactly did the subselect do for us.</span></span> <span data-ttu-id="d865c-330">サブセレクトは、製品からのすべてのディメンションをそのまま含む新しいキューブを返しました。ただし、製品ディメンションでは、目的の上位 10 製品に一致するようにすべてのメンバーにフィルターを適用しました。</span><span class="sxs-lookup"><span data-stu-id="d865c-330">The subselect returned for us a new cube that contained all other dimensions from product as they are; but, in the product dimension it filtered all members to match the top 10 products that we were interested in.</span></span> <span data-ttu-id="d865c-331">これは、上位 10 製品という条件に一致しないすべてのデータを削除し、キューブを再構築した場合と同様な状況です。</span><span class="sxs-lookup"><span data-stu-id="d865c-331">It was as if we had removed all data that did not meet the Top 10 criteria and had rebuilt the cube.</span></span> <span data-ttu-id="d865c-332">この例を理解するためも重要なもう一つの概念は、上位 10 製品がキューブ内の他のすべてのディメンションのすべてのメンバーに対して計算されたということです。サブセレクトで他のフィルター制限が課せられなかったため、最初の SELECT は true になります。</span><span class="sxs-lookup"><span data-stu-id="d865c-332">The other important concept to understand in this example is the fact that the Top 10 products were calculated over the All member of all the other dimensions in the cube; the former is true because no other filtering restrictions were imposed in the subselect.</span></span>  
  
 <span data-ttu-id="d865c-333">サブセレクトは、必要に応じて複雑にできます。次の例は、上の例と似ていますが、Sales Territory ディメンションで France にフィルターを、および Sales Channel ディメンションで Internet にフィルターを適用した表を生成する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-333">Subselects can be as complex as one would like; the following example will illustrate how to produce a similar table as the mentioned above but filtered on France on the Sales Territory dimension and on Internet for the Sales Channel dimension.</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN  
                       , 10  
                       , [Measures].[Sales Amount]  
                       ) ON 0  
             , [Sales Territory].[Sales Territory].[Region].[France] on 1  
             ,  [Sales Channel].[Sales Channel].[Internet] on 2  
          FROM [Adventure Works]  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="d865c-334">結果は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="d865c-334">Produced the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-335">All Periods</span><span class="sxs-lookup"><span data-stu-id="d865c-335">All Periods</span></span>|<span data-ttu-id="d865c-336">CY 2005</span><span class="sxs-lookup"><span data-stu-id="d865c-336">CY 2005</span></span>|<span data-ttu-id="d865c-337">CY 2006</span><span class="sxs-lookup"><span data-stu-id="d865c-337">CY 2006</span></span>|<span data-ttu-id="d865c-338">CY 2007</span><span class="sxs-lookup"><span data-stu-id="d865c-338">CY 2007</span></span>|<span data-ttu-id="d865c-339">CY 2008</span><span class="sxs-lookup"><span data-stu-id="d865c-339">CY 2008</span></span>|  
|<span data-ttu-id="d865c-340">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-340">All Products</span></span>|<span data-ttu-id="d865c-341">$748,682.49</span><span class="sxs-lookup"><span data-stu-id="d865c-341">$748,682.49</span></span>|<span data-ttu-id="d865c-342">$32,204.43</span><span class="sxs-lookup"><span data-stu-id="d865c-342">$32,204.43</span></span>|<span data-ttu-id="d865c-343">$73,125.18</span><span class="sxs-lookup"><span data-stu-id="d865c-343">$73,125.18</span></span>|<span data-ttu-id="d865c-344">$269,506.56</span><span class="sxs-lookup"><span data-stu-id="d865c-344">$269,506.56</span></span>|<span data-ttu-id="d865c-345">$373,846.32</span><span class="sxs-lookup"><span data-stu-id="d865c-345">$373,846.32</span></span>|  
|<span data-ttu-id="d865c-346">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-346">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="d865c-347">$90,479.61</span><span class="sxs-lookup"><span data-stu-id="d865c-347">$90,479.61</span></span>|<span data-ttu-id="d865c-348">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-348">(null)</span></span>|<span data-ttu-id="d865c-349">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-349">(null)</span></span>|<span data-ttu-id="d865c-350">$41,759.82</span><span class="sxs-lookup"><span data-stu-id="d865c-350">$41,759.82</span></span>|<span data-ttu-id="d865c-351">$48,719.79</span><span class="sxs-lookup"><span data-stu-id="d865c-351">$48,719.79</span></span>|  
|<span data-ttu-id="d865c-352">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-352">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="d865c-353">$97,439.58</span><span class="sxs-lookup"><span data-stu-id="d865c-353">$97,439.58</span></span>|<span data-ttu-id="d865c-354">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-354">(null)</span></span>|<span data-ttu-id="d865c-355">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-355">(null)</span></span>|<span data-ttu-id="d865c-356">$39,439.83</span><span class="sxs-lookup"><span data-stu-id="d865c-356">$39,439.83</span></span>|<span data-ttu-id="d865c-357">$57,999.75</span><span class="sxs-lookup"><span data-stu-id="d865c-357">$57,999.75</span></span>|  
|<span data-ttu-id="d865c-358">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-358">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="d865c-359">$102,079.56</span><span class="sxs-lookup"><span data-stu-id="d865c-359">$102,079.56</span></span>|<span data-ttu-id="d865c-360">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-360">(null)</span></span>|<span data-ttu-id="d865c-361">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-361">(null)</span></span>|<span data-ttu-id="d865c-362">$27,839.88</span><span class="sxs-lookup"><span data-stu-id="d865c-362">$27,839.88</span></span>|<span data-ttu-id="d865c-363">$74,239.68</span><span class="sxs-lookup"><span data-stu-id="d865c-363">$74,239.68</span></span>|  
|<span data-ttu-id="d865c-364">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-364">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-365">$26,638.28</span><span class="sxs-lookup"><span data-stu-id="d865c-365">$26,638.28</span></span>|<span data-ttu-id="d865c-366">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-366">(null)</span></span>|<span data-ttu-id="d865c-367">$12,294.59</span><span class="sxs-lookup"><span data-stu-id="d865c-367">$12,294.59</span></span>|<span data-ttu-id="d865c-368">$14,343.69</span><span class="sxs-lookup"><span data-stu-id="d865c-368">$14,343.69</span></span>|<span data-ttu-id="d865c-369">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-369">(null)</span></span>|  
|<span data-ttu-id="d865c-370">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-370">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-371">$96,389.58</span><span class="sxs-lookup"><span data-stu-id="d865c-371">$96,389.58</span></span>|<span data-ttu-id="d865c-372">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-372">(null)</span></span>|<span data-ttu-id="d865c-373">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-373">(null)</span></span>|<span data-ttu-id="d865c-374">$41,309.82</span><span class="sxs-lookup"><span data-stu-id="d865c-374">$41,309.82</span></span>|<span data-ttu-id="d865c-375">$55,079.76</span><span class="sxs-lookup"><span data-stu-id="d865c-375">$55,079.76</span></span>|  
|<span data-ttu-id="d865c-376">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-376">Mountain-200 Black, 42</span></span>|<span data-ttu-id="d865c-377">$80,324.65</span><span class="sxs-lookup"><span data-stu-id="d865c-377">$80,324.65</span></span>|<span data-ttu-id="d865c-378">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-378">(null)</span></span>|<span data-ttu-id="d865c-379">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-379">(null)</span></span>|<span data-ttu-id="d865c-380">$43,604.81</span><span class="sxs-lookup"><span data-stu-id="d865c-380">$43,604.81</span></span>|<span data-ttu-id="d865c-381">$36,719.84</span><span class="sxs-lookup"><span data-stu-id="d865c-381">$36,719.84</span></span>|  
|<span data-ttu-id="d865c-382">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-382">Mountain-200 Black, 46</span></span>|<span data-ttu-id="d865c-383">$107,864.53</span><span class="sxs-lookup"><span data-stu-id="d865c-383">$107,864.53</span></span>|<span data-ttu-id="d865c-384">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-384">(null)</span></span>|<span data-ttu-id="d865c-385">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-385">(null)</span></span>|<span data-ttu-id="d865c-386">$45,899.80</span><span class="sxs-lookup"><span data-stu-id="d865c-386">$45,899.80</span></span>|<span data-ttu-id="d865c-387">$61,964.73</span><span class="sxs-lookup"><span data-stu-id="d865c-387">$61,964.73</span></span>|  
|<span data-ttu-id="d865c-388">Road-150 Red, 62</span><span class="sxs-lookup"><span data-stu-id="d865c-388">Road-150 Red, 62</span></span>|<span data-ttu-id="d865c-389">$46,517.51</span><span class="sxs-lookup"><span data-stu-id="d865c-389">$46,517.51</span></span>|<span data-ttu-id="d865c-390">$14,313.08</span><span class="sxs-lookup"><span data-stu-id="d865c-390">$14,313.08</span></span>|<span data-ttu-id="d865c-391">$32,204.43</span><span class="sxs-lookup"><span data-stu-id="d865c-391">$32,204.43</span></span>|<span data-ttu-id="d865c-392">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-392">(null)</span></span>|<span data-ttu-id="d865c-393">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-393">(null)</span></span>|  
|<span data-ttu-id="d865c-394">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="d865c-394">Road-150 Red, 56</span></span>|<span data-ttu-id="d865c-395">$46,517.51</span><span class="sxs-lookup"><span data-stu-id="d865c-395">$46,517.51</span></span>|<span data-ttu-id="d865c-396">$17,891.35</span><span class="sxs-lookup"><span data-stu-id="d865c-396">$17,891.35</span></span>|<span data-ttu-id="d865c-397">$28,626.16</span><span class="sxs-lookup"><span data-stu-id="d865c-397">$28,626.16</span></span>|<span data-ttu-id="d865c-398">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-398">(null)</span></span>|<span data-ttu-id="d865c-399">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-399">(null)</span></span>|  
|<span data-ttu-id="d865c-400">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="d865c-400">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="d865c-401">$54,431.68</span><span class="sxs-lookup"><span data-stu-id="d865c-401">$54,431.68</span></span>|<span data-ttu-id="d865c-402">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-402">(null)</span></span>|<span data-ttu-id="d865c-403">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-403">(null)</span></span>|<span data-ttu-id="d865c-404">$15,308.91</span><span class="sxs-lookup"><span data-stu-id="d865c-404">$15,308.91</span></span>|<span data-ttu-id="d865c-405">$39,122.77</span><span class="sxs-lookup"><span data-stu-id="d865c-405">$39,122.77</span></span>|  
  
 <span data-ttu-id="d865c-406">上記の結果は、インターネット チャネル経由でフランスで販売された上位 10 製品を示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-406">The above results are the Top 10 products sold in France through the Internet channel.</span></span>  
  
## <a name="subselect-statement"></a><span data-ttu-id="d865c-407">サブセレクト ステートメント</span><span class="sxs-lookup"><span data-stu-id="d865c-407">Subselect statement</span></span>  
 <span data-ttu-id="d865c-408">サブセレクトの BNF は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="d865c-408">The BNF for the Subselect is:</span></span>  
  
```  
[WITH [<calc-clause> ...]]  
SELECT [<axis-spec> [, <axis-spec> ...]]  
FROM [<identifier> | (< sub-select-statement >)]  
[WHERE <slicer>]  
[[CELL] PROPERTIES <cellprop> [, <cellprop> ...]]  
  
< sub-select-statement > :=  
   SELECT [<axis-spec> [, <axis-spec> ...]]  
   FROM [<identifier> | (< sub-select-statement >)]  
   [WHERE <slicer>]  
  
```  
  
 <span data-ttu-id="d865c-409">サブセレクトは、外部選択が評価されるキューブ空間に、軸仕様およびスライサー仕様がフィルターを適用する、もう 1 つの Select ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="d865c-409">The subselect is another Select statement where the axis specifications and the slicer specification filter the space of the cube over which the outer select is evaluated.</span></span>  
  
 <span data-ttu-id="d865c-410">メンバーが軸またはスライサー句で指定される場合、そのメンバーはその先祖および子孫と共にサブセレクトのサブキューブ空間に取り込まれます。軸句またはスライサー句で指定されていないすべての兄弟メンバーおよびその子孫は、フィルターによってサブ空間から除外されます。</span><span class="sxs-lookup"><span data-stu-id="d865c-410">When a member is specified in one of the axis or slicer clause then that member with its ascendants and descendants are included in the sub cube space for the subselect; all non mentioned sibling members, in the axis or slicer clause, and their descendants are filtered from the subspace.</span></span> <span data-ttu-id="d865c-411">このように、外部選択の空間は、前に説明した先祖および子孫と共に、軸句またはスライサー句の既存のメンバーに制限されています。</span><span class="sxs-lookup"><span data-stu-id="d865c-411">This way, the space of the outer select has been limited to the existing members in the axis clause or slicer clause, with their ascendants and descendants as mentioned before.</span></span>  
  
 <span data-ttu-id="d865c-412">軸またはスライサー句で指定されていないすべてのディメンションのすべてのメンバーは Select の空間に属するため、これらのディメンションのすべてのメンバーのすべての子孫も、サブセレクト空間の一部になります。</span><span class="sxs-lookup"><span data-stu-id="d865c-412">Because the All member of all non mentioned dimensions in axis or slicer clauses belongs to the space of the select; then, all descendants to the All member on those dimensions are, also, part of the subselect space.</span></span>  
  
 <span data-ttu-id="d865c-413">サブキューブ空間のすべてのディメンションのすべてのメンバーは、新しい空間の制限の影響を反映するように再評価されます。</span><span class="sxs-lookup"><span data-stu-id="d865c-413">The All member, in all dimensions, in the subcube space, is re-evaluated to reflect the impact of the constrains of the new space.</span></span>  
  
 <span data-ttu-id="d865c-414">次の例は、上で説明したことを示したコードです。最初の MDX 式は、キューブ内のフィルターが適用されていない値の表示を支援し、2 番目の MDX 式は、サブセレクト句のフィルターの影響を示します。</span><span class="sxs-lookup"><span data-stu-id="d865c-414">The following example will show what has been said above; the first MDX expression helps to display the unfiltered values in the cube, the second MDX illustrates the effect of filtering in the Subselect clause:</span></span>  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,  {[Measures].[Internet Sales Amount], [Measures].[Reseller Sales Amount]} ON 0  
  FROM [Adventure Works]  
```  
  
 <span data-ttu-id="d865c-415">次の値を返します。</span><span class="sxs-lookup"><span data-stu-id="d865c-415">Returns the following values:</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="d865c-416">Internet Sales Amount</span><span class="sxs-lookup"><span data-stu-id="d865c-416">Internet Sales Amount</span></span>|<span data-ttu-id="d865c-417">Reseller Sales Amount</span><span class="sxs-lookup"><span data-stu-id="d865c-417">Reseller Sales Amount</span></span>|  
|<span data-ttu-id="d865c-418">All Customers</span><span class="sxs-lookup"><span data-stu-id="d865c-418">All Customers</span></span>|<span data-ttu-id="d865c-419">$29,358,677.22</span><span class="sxs-lookup"><span data-stu-id="d865c-419">$29,358,677.22</span></span>|<span data-ttu-id="d865c-420">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-420">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-421">United States</span><span class="sxs-lookup"><span data-stu-id="d865c-421">United States</span></span>|<span data-ttu-id="d865c-422">$9,389,789.51</span><span class="sxs-lookup"><span data-stu-id="d865c-422">$9,389,789.51</span></span>|<span data-ttu-id="d865c-423">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-423">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-424">オレゴン</span><span class="sxs-lookup"><span data-stu-id="d865c-424">Oregon</span></span>|<span data-ttu-id="d865c-425">$1,170,991.54</span><span class="sxs-lookup"><span data-stu-id="d865c-425">$1,170,991.54</span></span>|<span data-ttu-id="d865c-426">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-426">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-427">Portland</span><span class="sxs-lookup"><span data-stu-id="d865c-427">Portland</span></span>|<span data-ttu-id="d865c-428">$110,649.54</span><span class="sxs-lookup"><span data-stu-id="d865c-428">$110,649.54</span></span>|<span data-ttu-id="d865c-429">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-429">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-430">ワシントン</span><span class="sxs-lookup"><span data-stu-id="d865c-430">Washington</span></span>|<span data-ttu-id="d865c-431">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-431">$2,467,248.34</span></span>|<span data-ttu-id="d865c-432">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-432">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-433">Seattle</span><span class="sxs-lookup"><span data-stu-id="d865c-433">Seattle</span></span>|<span data-ttu-id="d865c-434">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="d865c-434">$75,164.86</span></span>|<span data-ttu-id="d865c-435">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-435">$80,450,596.98</span></span>|  
  
 <span data-ttu-id="d865c-436">上記の例では Seattle は Washington の子であり、Portland は Oregon の子であり、Oregon および Washington は United States の子であり、United States は [Customer Geography].[All Customers] の子です。</span><span class="sxs-lookup"><span data-stu-id="d865c-436">In the above example Seattle is a child of Washington, Portland is a child of Oregon, Oregon and Washington are children of United States and United States is a child of [Customer Geography].[All Customers].</span></span> <span data-ttu-id="d865c-437">この例で示したすべてのメンバーには、親の集計値に影響を与える、他の兄弟が存在します。たとえば、Spokane、Tacoma、および Everett は、Seattle の兄弟都市であり、すべて Washington Internet Sales Amount に影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="d865c-437">All of the shown members in this example have other siblings that contribute to the parent aggregate value; i.e. Spokane, Tacoma and Everett are sibling cities of Seattle and they all contribute to Washington Internet Sales Amount.</span></span> <span data-ttu-id="d865c-438">Reseller Sales Amount 値は Customer Geography 属性から独立しています。このため、All 値が結果に表示されます。</span><span class="sxs-lookup"><span data-stu-id="d865c-438">Reseller Sales Amount value is independent of Customer Geography attribute; hence the All value is displayed in the results.</span></span> <span data-ttu-id="d865c-439">次の MDX 式は、サブセレクト句に影響を与えるフィルターを示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-439">The next MDX expression illustrates the filtering effect of the subselect clause:</span></span>  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,  {[Measures].[Internet Sales Amount], [Measures].[Reseller Sales Amount]} ON 0  
  FROM ( SELECT [Customer].[State-Province].&[WA]&[US] ON 0  
           FROM [Adventure Works]  
        )  
```  
  
 <span data-ttu-id="d865c-440">次の値を返します。</span><span class="sxs-lookup"><span data-stu-id="d865c-440">Returns the following values:</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="d865c-441">Internet Sales Amount</span><span class="sxs-lookup"><span data-stu-id="d865c-441">Internet Sales Amount</span></span>|<span data-ttu-id="d865c-442">Reseller Sales Amount</span><span class="sxs-lookup"><span data-stu-id="d865c-442">Reseller Sales Amount</span></span>|  
|<span data-ttu-id="d865c-443">All Customers</span><span class="sxs-lookup"><span data-stu-id="d865c-443">All Customers</span></span>|<span data-ttu-id="d865c-444">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-444">$2,467,248.34</span></span>|<span data-ttu-id="d865c-445">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-445">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-446">United States</span><span class="sxs-lookup"><span data-stu-id="d865c-446">United States</span></span>|<span data-ttu-id="d865c-447">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-447">$2,467,248.34</span></span>|<span data-ttu-id="d865c-448">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-448">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-449">ワシントン</span><span class="sxs-lookup"><span data-stu-id="d865c-449">Washington</span></span>|<span data-ttu-id="d865c-450">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-450">$2,467,248.34</span></span>|<span data-ttu-id="d865c-451">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-451">$80,450,596.98</span></span>|  
|<span data-ttu-id="d865c-452">Seattle</span><span class="sxs-lookup"><span data-stu-id="d865c-452">Seattle</span></span>|<span data-ttu-id="d865c-453">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="d865c-453">$75,164.86</span></span>|<span data-ttu-id="d865c-454">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="d865c-454">$80,450,596.98</span></span>|  
  
 <span data-ttu-id="d865c-455">上記の結果は、Washington State の先祖および子孫のみが、外側の SELECT ステートメントが評価されたサブ空間の一部であることを示しています。Washington が指定されたのに対し、Oregon およびすべての他の兄弟州はサブセレクトで指定されなかったため、Oregon および Portland はサブキューブから削除されています。</span><span class="sxs-lookup"><span data-stu-id="d865c-455">The results above show that only ascendants and descendants of Washington State are part of the subspace where the outer select statement was evaluated; Oregon and Portland have been removed from the subcube because Oregon and all the other sibling states were not mentioned in the subselect when Washington was mentioned.</span></span>  
  
 <span data-ttu-id="d865c-456">すべてのメンバーは、Washington のフィルターを反映するように調整されました。[Customer Geography] ディメンションだけではなく、[Customer Geography] の影響を受ける他のすべてのディメンションで調整されました。</span><span class="sxs-lookup"><span data-stu-id="d865c-456">The All member was adjusted to reflect the filtering on Washington; not only was adjusted in the [Customer Geography] dimension but in all other dimensions that crossed with [Customer Geography].</span></span> <span data-ttu-id="d865c-457">[Customer Geography] の影響を受けないすべてのディメンションは、変更されずにそのままサブキューブに残っています。</span><span class="sxs-lookup"><span data-stu-id="d865c-457">All dimensions that do not cross with [Customer Geography] remain in the subcube unaltered.</span></span>  
  
 <span data-ttu-id="d865c-458">次の 2 つの MDX ステートメントは、他のディメンションのすべてのメンバーが、サブセレクトのフィルター適用の影響を受けるように調整される例を示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-458">The following two MDX statements illustrate how the All member in other dimensions is adjusted to meet the filtering effect of the subselect.</span></span> <span data-ttu-id="d865c-459">最初のクエリは変更されない結果を表示し、2 番目のクエリはフィルター適用の影響を示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-459">The first query displays the unaltered results and the second shows the impact of the filtering:</span></span>  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,   [Product].[Product Line].MEMBERS ON 0  
  FROM [Adventure Works]  
 WHERE [Measures].[Internet Sales Amount]  
```  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-460">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-460">All Products</span></span>|<span data-ttu-id="d865c-461">Accessory</span><span class="sxs-lookup"><span data-stu-id="d865c-461">Accessory</span></span>|<span data-ttu-id="d865c-462">コンポーネント</span><span class="sxs-lookup"><span data-stu-id="d865c-462">Components</span></span>|<span data-ttu-id="d865c-463">Mountain</span><span class="sxs-lookup"><span data-stu-id="d865c-463">Mountain</span></span>|<span data-ttu-id="d865c-464">道路</span><span class="sxs-lookup"><span data-stu-id="d865c-464">Road</span></span>|<span data-ttu-id="d865c-465">Touring</span><span class="sxs-lookup"><span data-stu-id="d865c-465">Touring</span></span>|  
|<span data-ttu-id="d865c-466">All Customers</span><span class="sxs-lookup"><span data-stu-id="d865c-466">All Customers</span></span>|<span data-ttu-id="d865c-467">$29,358,677.22</span><span class="sxs-lookup"><span data-stu-id="d865c-467">$29,358,677.22</span></span>|<span data-ttu-id="d865c-468">$604,053.30</span><span class="sxs-lookup"><span data-stu-id="d865c-468">$604,053.30</span></span>|<span data-ttu-id="d865c-469">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-469">(null)</span></span>|<span data-ttu-id="d865c-470">$10,251,183.52</span><span class="sxs-lookup"><span data-stu-id="d865c-470">$10,251,183.52</span></span>|<span data-ttu-id="d865c-471">$14,624,108.58</span><span class="sxs-lookup"><span data-stu-id="d865c-471">$14,624,108.58</span></span>|<span data-ttu-id="d865c-472">$3,879,331.82</span><span class="sxs-lookup"><span data-stu-id="d865c-472">$3,879,331.82</span></span>|  
|<span data-ttu-id="d865c-473">United States</span><span class="sxs-lookup"><span data-stu-id="d865c-473">United States</span></span>|<span data-ttu-id="d865c-474">$9,389,789.51</span><span class="sxs-lookup"><span data-stu-id="d865c-474">$9,389,789.51</span></span>|<span data-ttu-id="d865c-475">$217,168.79</span><span class="sxs-lookup"><span data-stu-id="d865c-475">$217,168.79</span></span>|<span data-ttu-id="d865c-476">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-476">(null)</span></span>|<span data-ttu-id="d865c-477">$3,547,956.78</span><span class="sxs-lookup"><span data-stu-id="d865c-477">$3,547,956.78</span></span>|<span data-ttu-id="d865c-478">$4,322,438.41</span><span class="sxs-lookup"><span data-stu-id="d865c-478">$4,322,438.41</span></span>|<span data-ttu-id="d865c-479">$1,302,225.54</span><span class="sxs-lookup"><span data-stu-id="d865c-479">$1,302,225.54</span></span>|  
|<span data-ttu-id="d865c-480">オレゴン</span><span class="sxs-lookup"><span data-stu-id="d865c-480">Oregon</span></span>|<span data-ttu-id="d865c-481">$1,170,991.54</span><span class="sxs-lookup"><span data-stu-id="d865c-481">$1,170,991.54</span></span>|<span data-ttu-id="d865c-482">$30,513.17</span><span class="sxs-lookup"><span data-stu-id="d865c-482">$30,513.17</span></span>|<span data-ttu-id="d865c-483">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-483">(null)</span></span>|<span data-ttu-id="d865c-484">$443,607.98</span><span class="sxs-lookup"><span data-stu-id="d865c-484">$443,607.98</span></span>|<span data-ttu-id="d865c-485">$565,372.10</span><span class="sxs-lookup"><span data-stu-id="d865c-485">$565,372.10</span></span>|<span data-ttu-id="d865c-486">$131,498.29</span><span class="sxs-lookup"><span data-stu-id="d865c-486">$131,498.29</span></span>|  
|<span data-ttu-id="d865c-487">Portland</span><span class="sxs-lookup"><span data-stu-id="d865c-487">Portland</span></span>|<span data-ttu-id="d865c-488">$110,649.54</span><span class="sxs-lookup"><span data-stu-id="d865c-488">$110,649.54</span></span>|<span data-ttu-id="d865c-489">$2,834.17</span><span class="sxs-lookup"><span data-stu-id="d865c-489">$2,834.17</span></span>|<span data-ttu-id="d865c-490">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-490">(null)</span></span>|<span data-ttu-id="d865c-491">$47,099.91</span><span class="sxs-lookup"><span data-stu-id="d865c-491">$47,099.91</span></span>|<span data-ttu-id="d865c-492">$53,917.17</span><span class="sxs-lookup"><span data-stu-id="d865c-492">$53,917.17</span></span>|<span data-ttu-id="d865c-493">$6,798.29</span><span class="sxs-lookup"><span data-stu-id="d865c-493">$6,798.29</span></span>|  
|<span data-ttu-id="d865c-494">ワシントン</span><span class="sxs-lookup"><span data-stu-id="d865c-494">Washington</span></span>|<span data-ttu-id="d865c-495">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-495">$2,467,248.34</span></span>|<span data-ttu-id="d865c-496">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="d865c-496">$62,662.92</span></span>|<span data-ttu-id="d865c-497">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-497">(null)</span></span>|<span data-ttu-id="d865c-498">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="d865c-498">$945,219.38</span></span>|<span data-ttu-id="d865c-499">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="d865c-499">$1,155,880.07</span></span>|<span data-ttu-id="d865c-500">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="d865c-500">$303,485.97</span></span>|  
|<span data-ttu-id="d865c-501">Seattle</span><span class="sxs-lookup"><span data-stu-id="d865c-501">Seattle</span></span>|<span data-ttu-id="d865c-502">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="d865c-502">$75,164.86</span></span>|<span data-ttu-id="d865c-503">$2,695.74</span><span class="sxs-lookup"><span data-stu-id="d865c-503">$2,695.74</span></span>|<span data-ttu-id="d865c-504">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-504">(null)</span></span>|<span data-ttu-id="d865c-505">$19,914.53</span><span class="sxs-lookup"><span data-stu-id="d865c-505">$19,914.53</span></span>|<span data-ttu-id="d865c-506">$44,820.06</span><span class="sxs-lookup"><span data-stu-id="d865c-506">$44,820.06</span></span>|<span data-ttu-id="d865c-507">$7,734.54</span><span class="sxs-lookup"><span data-stu-id="d865c-507">$7,734.54</span></span>|  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,   [Product].[Product Line].MEMBERS ON 0  
  FROM ( SELECT [Customer].[State-Province].&[WA]&[US] ON 0  
           FROM [Adventure Works]  
        )  
 WHERE [Measures].[Internet Sales Amount]  
```  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-508">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-508">All Products</span></span>|<span data-ttu-id="d865c-509">Accessory</span><span class="sxs-lookup"><span data-stu-id="d865c-509">Accessory</span></span>|<span data-ttu-id="d865c-510">コンポーネント</span><span class="sxs-lookup"><span data-stu-id="d865c-510">Components</span></span>|<span data-ttu-id="d865c-511">Mountain</span><span class="sxs-lookup"><span data-stu-id="d865c-511">Mountain</span></span>|<span data-ttu-id="d865c-512">道路</span><span class="sxs-lookup"><span data-stu-id="d865c-512">Road</span></span>|<span data-ttu-id="d865c-513">Touring</span><span class="sxs-lookup"><span data-stu-id="d865c-513">Touring</span></span>|  
|<span data-ttu-id="d865c-514">All Customers</span><span class="sxs-lookup"><span data-stu-id="d865c-514">All Customers</span></span>|<span data-ttu-id="d865c-515">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-515">$2,467,248.34</span></span>|<span data-ttu-id="d865c-516">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="d865c-516">$62,662.92</span></span>|<span data-ttu-id="d865c-517">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-517">(null)</span></span>|<span data-ttu-id="d865c-518">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="d865c-518">$945,219.38</span></span>|<span data-ttu-id="d865c-519">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="d865c-519">$1,155,880.07</span></span>|<span data-ttu-id="d865c-520">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="d865c-520">$303,485.97</span></span>|  
|<span data-ttu-id="d865c-521">United States</span><span class="sxs-lookup"><span data-stu-id="d865c-521">United States</span></span>|<span data-ttu-id="d865c-522">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-522">$2,467,248.34</span></span>|<span data-ttu-id="d865c-523">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="d865c-523">$62,662.92</span></span>|<span data-ttu-id="d865c-524">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-524">(null)</span></span>|<span data-ttu-id="d865c-525">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="d865c-525">$945,219.38</span></span>|<span data-ttu-id="d865c-526">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="d865c-526">$1,155,880.07</span></span>|<span data-ttu-id="d865c-527">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="d865c-527">$303,485.97</span></span>|  
|<span data-ttu-id="d865c-528">ワシントン</span><span class="sxs-lookup"><span data-stu-id="d865c-528">Washington</span></span>|<span data-ttu-id="d865c-529">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="d865c-529">$2,467,248.34</span></span>|<span data-ttu-id="d865c-530">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="d865c-530">$62,662.92</span></span>|<span data-ttu-id="d865c-531">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-531">(null)</span></span>|<span data-ttu-id="d865c-532">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="d865c-532">$945,219.38</span></span>|<span data-ttu-id="d865c-533">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="d865c-533">$1,155,880.07</span></span>|<span data-ttu-id="d865c-534">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="d865c-534">$303,485.97</span></span>|  
|<span data-ttu-id="d865c-535">Seattle</span><span class="sxs-lookup"><span data-stu-id="d865c-535">Seattle</span></span>|<span data-ttu-id="d865c-536">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="d865c-536">$75,164.86</span></span>|<span data-ttu-id="d865c-537">$2,695.74</span><span class="sxs-lookup"><span data-stu-id="d865c-537">$2,695.74</span></span>|<span data-ttu-id="d865c-538">(null)</span><span class="sxs-lookup"><span data-stu-id="d865c-538">(null)</span></span>|<span data-ttu-id="d865c-539">$19,914.53</span><span class="sxs-lookup"><span data-stu-id="d865c-539">$19,914.53</span></span>|<span data-ttu-id="d865c-540">$44,820.06</span><span class="sxs-lookup"><span data-stu-id="d865c-540">$44,820.06</span></span>|<span data-ttu-id="d865c-541">$7,734.54</span><span class="sxs-lookup"><span data-stu-id="d865c-541">$7,734.54</span></span>|  
  
 <span data-ttu-id="d865c-542">上記の結果は、All Products 値が、期待どおりに Washington State の値のみに調整されたことを示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-542">The above results show that All Products values have been adjusted to only values from Washington State, as expected.</span></span>  
  
 <span data-ttu-id="d865c-543">サブセレクトを入れ子にできる深さに制限はありません。ただし、使用可能なメモリの制限は受けます。</span><span class="sxs-lookup"><span data-stu-id="d865c-543">Subselects can be nested with no limit to how deep you can nest subselects, except available memory.</span></span> <span data-ttu-id="d865c-544">最も内側のサブセレクトは、フィルターが適用され次の外側の SELECT に渡される開始サブ空間を定義します。</span><span class="sxs-lookup"><span data-stu-id="d865c-544">The inner most subselect defines the starting subspace over which filtering is applied and passed onto the next outer select.</span></span> <span data-ttu-id="d865c-545">考慮する必要がある重要な点は、入れ子は相互的な操作でなく、入れ子が設定される順序により、異なる結果が生成される可能性があるということです。</span><span class="sxs-lookup"><span data-stu-id="d865c-545">An important thing to notice is the fact that nesting is not a commutative operation; so the order in which the nesting is set my produce different results.</span></span> <span data-ttu-id="d865c-546">次の例は、入れ子の順序の選択による違いを示しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-546">The following examples should show the difference when choosing a nesting order.</span></span>  
  
```  
SELECT [Sales Territory].[Sales Territory Region].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN, 5, [Measures].[Sales Amount]) ON 0  
          FROM (SELECT TOPCOUNT( [Sales Territory].[Sales Territory Region].CHILDREN, 5, [Measures].[Sales Amount]) on 0  
                  FROM [Adventure Works]  
               )  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="d865c-547">結果は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="d865c-547">Returned the following results.</span></span>  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-548">All Sales Territories</span><span class="sxs-lookup"><span data-stu-id="d865c-548">All Sales Territories</span></span>|<span data-ttu-id="d865c-549">オーストラリア</span><span class="sxs-lookup"><span data-stu-id="d865c-549">Australia</span></span>|<span data-ttu-id="d865c-550">Canada</span><span class="sxs-lookup"><span data-stu-id="d865c-550">Canada</span></span>|<span data-ttu-id="d865c-551">Central</span><span class="sxs-lookup"><span data-stu-id="d865c-551">Central</span></span>|<span data-ttu-id="d865c-552">Northwest</span><span class="sxs-lookup"><span data-stu-id="d865c-552">Northwest</span></span>|<span data-ttu-id="d865c-553">Southwest</span><span class="sxs-lookup"><span data-stu-id="d865c-553">Southwest</span></span>|  
|<span data-ttu-id="d865c-554">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-554">All Products</span></span>|<span data-ttu-id="d865c-555">$7,591,495.49</span><span class="sxs-lookup"><span data-stu-id="d865c-555">$7,591,495.49</span></span>|<span data-ttu-id="d865c-556">$1,281,059.99</span><span class="sxs-lookup"><span data-stu-id="d865c-556">$1,281,059.99</span></span>|<span data-ttu-id="d865c-557">$1,547,298.12</span><span class="sxs-lookup"><span data-stu-id="d865c-557">$1,547,298.12</span></span>|<span data-ttu-id="d865c-558">$600,205.79</span><span class="sxs-lookup"><span data-stu-id="d865c-558">$600,205.79</span></span>|<span data-ttu-id="d865c-559">$1,924,763.50</span><span class="sxs-lookup"><span data-stu-id="d865c-559">$1,924,763.50</span></span>|<span data-ttu-id="d865c-560">$2,238,168.08</span><span class="sxs-lookup"><span data-stu-id="d865c-560">$2,238,168.08</span></span>|  
|<span data-ttu-id="d865c-561">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-561">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="d865c-562">$1,449,576.15</span><span class="sxs-lookup"><span data-stu-id="d865c-562">$1,449,576.15</span></span>|<span data-ttu-id="d865c-563">$248,702.93</span><span class="sxs-lookup"><span data-stu-id="d865c-563">$248,702.93</span></span>|<span data-ttu-id="d865c-564">$275,052.45</span><span class="sxs-lookup"><span data-stu-id="d865c-564">$275,052.45</span></span>|<span data-ttu-id="d865c-565">$141,103.65</span><span class="sxs-lookup"><span data-stu-id="d865c-565">$141,103.65</span></span>|<span data-ttu-id="d865c-566">$349,487.01</span><span class="sxs-lookup"><span data-stu-id="d865c-566">$349,487.01</span></span>|<span data-ttu-id="d865c-567">$435,230.12</span><span class="sxs-lookup"><span data-stu-id="d865c-567">$435,230.12</span></span>|  
|<span data-ttu-id="d865c-568">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-568">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-569">$1,722,896.50</span><span class="sxs-lookup"><span data-stu-id="d865c-569">$1,722,896.50</span></span>|<span data-ttu-id="d865c-570">$218,024.05</span><span class="sxs-lookup"><span data-stu-id="d865c-570">$218,024.05</span></span>|<span data-ttu-id="d865c-571">$418,726.43</span><span class="sxs-lookup"><span data-stu-id="d865c-571">$418,726.43</span></span>|<span data-ttu-id="d865c-572">$123,929.46</span><span class="sxs-lookup"><span data-stu-id="d865c-572">$123,929.46</span></span>|<span data-ttu-id="d865c-573">$486,694.63</span><span class="sxs-lookup"><span data-stu-id="d865c-573">$486,694.63</span></span>|<span data-ttu-id="d865c-574">$475,521.93</span><span class="sxs-lookup"><span data-stu-id="d865c-574">$475,521.93</span></span>|  
|<span data-ttu-id="d865c-575">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-575">Mountain-200 Black, 42</span></span>|<span data-ttu-id="d865c-576">$1,573,655.14</span><span class="sxs-lookup"><span data-stu-id="d865c-576">$1,573,655.14</span></span>|<span data-ttu-id="d865c-577">$239,137.96</span><span class="sxs-lookup"><span data-stu-id="d865c-577">$239,137.96</span></span>|<span data-ttu-id="d865c-578">$319,921.61</span><span class="sxs-lookup"><span data-stu-id="d865c-578">$319,921.61</span></span>|<span data-ttu-id="d865c-579">$130,102.75</span><span class="sxs-lookup"><span data-stu-id="d865c-579">$130,102.75</span></span>|<span data-ttu-id="d865c-580">$420,445.84</span><span class="sxs-lookup"><span data-stu-id="d865c-580">$420,445.84</span></span>|<span data-ttu-id="d865c-581">$464,046.98</span><span class="sxs-lookup"><span data-stu-id="d865c-581">$464,046.98</span></span>|  
|<span data-ttu-id="d865c-582">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-582">Mountain-200 Black, 46</span></span>|<span data-ttu-id="d865c-583">$1,420,500.58</span><span class="sxs-lookup"><span data-stu-id="d865c-583">$1,420,500.58</span></span>|<span data-ttu-id="d865c-584">$192,320.16</span><span class="sxs-lookup"><span data-stu-id="d865c-584">$192,320.16</span></span>|<span data-ttu-id="d865c-585">$230,875.99</span><span class="sxs-lookup"><span data-stu-id="d865c-585">$230,875.99</span></span>|<span data-ttu-id="d865c-586">$117,044.49</span><span class="sxs-lookup"><span data-stu-id="d865c-586">$117,044.49</span></span>|<span data-ttu-id="d865c-587">$424,813.66</span><span class="sxs-lookup"><span data-stu-id="d865c-587">$424,813.66</span></span>|<span data-ttu-id="d865c-588">$455,446.27</span><span class="sxs-lookup"><span data-stu-id="d865c-588">$455,446.27</span></span>|  
|<span data-ttu-id="d865c-589">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="d865c-589">Road-150 Red, 56</span></span>|<span data-ttu-id="d865c-590">$1,424,867.11</span><span class="sxs-lookup"><span data-stu-id="d865c-590">$1,424,867.11</span></span>|<span data-ttu-id="d865c-591">$382,874.89</span><span class="sxs-lookup"><span data-stu-id="d865c-591">$382,874.89</span></span>|<span data-ttu-id="d865c-592">$302,721.64</span><span class="sxs-lookup"><span data-stu-id="d865c-592">$302,721.64</span></span>|<span data-ttu-id="d865c-593">$88,025.44</span><span class="sxs-lookup"><span data-stu-id="d865c-593">$88,025.44</span></span>|<span data-ttu-id="d865c-594">$243,322.36</span><span class="sxs-lookup"><span data-stu-id="d865c-594">$243,322.36</span></span>|<span data-ttu-id="d865c-595">$407,922.78</span><span class="sxs-lookup"><span data-stu-id="d865c-595">$407,922.78</span></span>|  
  
```  
SELECT [Sales Territory].[Sales Territory Region].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Sales Territory].[Sales Territory Region].CHILDREN, 5, [Measures].[Sales Amount]) ON 0  
          FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN, 5, [Measures].[Sales Amount]) on 0  
                  FROM [Adventure Works]  
               )  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="d865c-596">結果は、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="d865c-596">Returned the following results.</span></span>  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="d865c-597">All Sales Territories</span><span class="sxs-lookup"><span data-stu-id="d865c-597">All Sales Territories</span></span>|<span data-ttu-id="d865c-598">オーストラリア</span><span class="sxs-lookup"><span data-stu-id="d865c-598">Australia</span></span>|<span data-ttu-id="d865c-599">Canada</span><span class="sxs-lookup"><span data-stu-id="d865c-599">Canada</span></span>|<span data-ttu-id="d865c-600">Northwest</span><span class="sxs-lookup"><span data-stu-id="d865c-600">Northwest</span></span>|<span data-ttu-id="d865c-601">Southwest</span><span class="sxs-lookup"><span data-stu-id="d865c-601">Southwest</span></span>|<span data-ttu-id="d865c-602">イギリス</span><span class="sxs-lookup"><span data-stu-id="d865c-602">United Kingdom</span></span>|  
|<span data-ttu-id="d865c-603">All Products</span><span class="sxs-lookup"><span data-stu-id="d865c-603">All Products</span></span>|<span data-ttu-id="d865c-604">$7,938,218.56</span><span class="sxs-lookup"><span data-stu-id="d865c-604">$7,938,218.56</span></span>|<span data-ttu-id="d865c-605">$1,096,312.24</span><span class="sxs-lookup"><span data-stu-id="d865c-605">$1,096,312.24</span></span>|<span data-ttu-id="d865c-606">$1,474,255.49</span><span class="sxs-lookup"><span data-stu-id="d865c-606">$1,474,255.49</span></span>|<span data-ttu-id="d865c-607">$2,042,674.72</span><span class="sxs-lookup"><span data-stu-id="d865c-607">$2,042,674.72</span></span>|<span data-ttu-id="d865c-608">$2,238,099.55</span><span class="sxs-lookup"><span data-stu-id="d865c-608">$2,238,099.55</span></span>|<span data-ttu-id="d865c-609">$1,086,876.56</span><span class="sxs-lookup"><span data-stu-id="d865c-609">$1,086,876.56</span></span>|  
|<span data-ttu-id="d865c-610">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-610">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="d865c-611">$1,520,958.53</span><span class="sxs-lookup"><span data-stu-id="d865c-611">$1,520,958.53</span></span>|<span data-ttu-id="d865c-612">$248,702.93</span><span class="sxs-lookup"><span data-stu-id="d865c-612">$248,702.93</span></span>|<span data-ttu-id="d865c-613">$275,052.45</span><span class="sxs-lookup"><span data-stu-id="d865c-613">$275,052.45</span></span>|<span data-ttu-id="d865c-614">$349,487.01</span><span class="sxs-lookup"><span data-stu-id="d865c-614">$349,487.01</span></span>|<span data-ttu-id="d865c-615">$435,230.12</span><span class="sxs-lookup"><span data-stu-id="d865c-615">$435,230.12</span></span>|<span data-ttu-id="d865c-616">$212,486.03</span><span class="sxs-lookup"><span data-stu-id="d865c-616">$212,486.03</span></span>|  
|<span data-ttu-id="d865c-617">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-617">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="d865c-618">$1,392,237.14</span><span class="sxs-lookup"><span data-stu-id="d865c-618">$1,392,237.14</span></span>|<span data-ttu-id="d865c-619">$198,127.15</span><span class="sxs-lookup"><span data-stu-id="d865c-619">$198,127.15</span></span>|<span data-ttu-id="d865c-620">$229,679.01</span><span class="sxs-lookup"><span data-stu-id="d865c-620">$229,679.01</span></span>|<span data-ttu-id="d865c-621">$361,233.58</span><span class="sxs-lookup"><span data-stu-id="d865c-621">$361,233.58</span></span>|<span data-ttu-id="d865c-622">$407,854.24</span><span class="sxs-lookup"><span data-stu-id="d865c-622">$407,854.24</span></span>|<span data-ttu-id="d865c-623">$195,343.16</span><span class="sxs-lookup"><span data-stu-id="d865c-623">$195,343.16</span></span>|  
|<span data-ttu-id="d865c-624">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="d865c-624">Mountain-200 Black, 38</span></span>|<span data-ttu-id="d865c-625">$1,861,703.23</span><span class="sxs-lookup"><span data-stu-id="d865c-625">$1,861,703.23</span></span>|<span data-ttu-id="d865c-626">$218,024.05</span><span class="sxs-lookup"><span data-stu-id="d865c-626">$218,024.05</span></span>|<span data-ttu-id="d865c-627">$418,726.43</span><span class="sxs-lookup"><span data-stu-id="d865c-627">$418,726.43</span></span>|<span data-ttu-id="d865c-628">$486,694.63</span><span class="sxs-lookup"><span data-stu-id="d865c-628">$486,694.63</span></span>|<span data-ttu-id="d865c-629">$475,521.93</span><span class="sxs-lookup"><span data-stu-id="d865c-629">$475,521.93</span></span>|<span data-ttu-id="d865c-630">$262,736.19</span><span class="sxs-lookup"><span data-stu-id="d865c-630">$262,736.19</span></span>|  
|<span data-ttu-id="d865c-631">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="d865c-631">Mountain-200 Black, 42</span></span>|<span data-ttu-id="d865c-632">$1,702,427.25</span><span class="sxs-lookup"><span data-stu-id="d865c-632">$1,702,427.25</span></span>|<span data-ttu-id="d865c-633">$239,137.96</span><span class="sxs-lookup"><span data-stu-id="d865c-633">$239,137.96</span></span>|<span data-ttu-id="d865c-634">$319,921.61</span><span class="sxs-lookup"><span data-stu-id="d865c-634">$319,921.61</span></span>|<span data-ttu-id="d865c-635">$420,445.84</span><span class="sxs-lookup"><span data-stu-id="d865c-635">$420,445.84</span></span>|<span data-ttu-id="d865c-636">$464,046.98</span><span class="sxs-lookup"><span data-stu-id="d865c-636">$464,046.98</span></span>|<span data-ttu-id="d865c-637">$258,874.87</span><span class="sxs-lookup"><span data-stu-id="d865c-637">$258,874.87</span></span>|  
|<span data-ttu-id="d865c-638">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="d865c-638">Mountain-200 Black, 46</span></span>|<span data-ttu-id="d865c-639">$1,460,892.41</span><span class="sxs-lookup"><span data-stu-id="d865c-639">$1,460,892.41</span></span>|<span data-ttu-id="d865c-640">$192,320.16</span><span class="sxs-lookup"><span data-stu-id="d865c-640">$192,320.16</span></span>|<span data-ttu-id="d865c-641">$230,875.99</span><span class="sxs-lookup"><span data-stu-id="d865c-641">$230,875.99</span></span>|<span data-ttu-id="d865c-642">$424,813.66</span><span class="sxs-lookup"><span data-stu-id="d865c-642">$424,813.66</span></span>|<span data-ttu-id="d865c-643">$455,446.27</span><span class="sxs-lookup"><span data-stu-id="d865c-643">$455,446.27</span></span>|<span data-ttu-id="d865c-644">$157,436.31</span><span class="sxs-lookup"><span data-stu-id="d865c-644">$157,436.31</span></span>|  
  
 <span data-ttu-id="d865c-645">両方のセットの結果には、違いがあることがわかります。</span><span class="sxs-lookup"><span data-stu-id="d865c-645">As you can see there are differences in the results between both sets.</span></span> <span data-ttu-id="d865c-646">最初のクエリは、上位 5 販売地域の最も販売された製品は何かという質問に対する結果を返し、2 番目のクエリは、上位 5 販売製品が最も販売された場所はどこかという質問に対する結果を返しています。</span><span class="sxs-lookup"><span data-stu-id="d865c-646">The first query answered the question of which are the best selling products in the top 5 selling regions, the second query answered the question of where are the largest sales of the top 5 selling products.</span></span>  
  
### <a name="remarks"></a><span data-ttu-id="d865c-647">解説</span><span class="sxs-lookup"><span data-stu-id="d865c-647">Remarks</span></span>  
 <span data-ttu-id="d865c-648">サブセレクトには、次の制限事項と制約事項があります。</span><span class="sxs-lookup"><span data-stu-id="d865c-648">Subselects have the following restrictions and limitations:</span></span>  
  
-   <span data-ttu-id="d865c-649">WHERE 句はサブ空間に対してフィルターを適用しません。</span><span class="sxs-lookup"><span data-stu-id="d865c-649">The WHERE clause does not filter the subspace.</span></span>  
  
-   <span data-ttu-id="d865c-650">WHERE 句は、サブキューブの既定メンバーのみを変更します。</span><span class="sxs-lookup"><span data-stu-id="d865c-650">The WHERE clause changes the default member in the sub cube only.</span></span>  
  
-   <span data-ttu-id="d865c-651">NON EMPTY 句は軸句では使用できません。代わりに [NonEmpty &#40;MDX&#41;](/sql/mdx/nonempty-mdx) 関数式を使用します。</span><span class="sxs-lookup"><span data-stu-id="d865c-651">The NON EMPTY clause is not allowed in an axis clause; use a [NonEmpty &#40;MDX&#41;](/sql/mdx/nonempty-mdx) function expression instead.</span></span>  
  
-   <span data-ttu-id="d865c-652">HAVING 句は軸句では使用できません。代わりに [Filter &#40;MDX&#41;](/sql/mdx/filter-mdx) 関数式を使用します。</span><span class="sxs-lookup"><span data-stu-id="d865c-652">The HAVING clause is not allowed in an axis clause; use a [Filter &#40;MDX&#41;](/sql/mdx/filter-mdx) function expression instead.</span></span>  
  
-   <span data-ttu-id="d865c-653">既定では、計算されるメンバーはサブセレクトでは許可されません。ただし、 `SubQueries` <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A> `DBPROP_MSMD_SUBQUERIES` [サポートされている xmla プロパティ &#40;xmla&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/propertylist-element-supported-xmla-properties)の接続文字列プロパティに値を割り当てることによって、セッションごとにこの制限を変更できます。</span><span class="sxs-lookup"><span data-stu-id="d865c-653">By default calculated members are not allowed in subselects; however, this restriction can be changed, in a per session basis, by assigning a value to the `SubQueries` connection string property in <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A> or `DBPROP_MSMD_SUBQUERIES` property in [Supported XMLA Properties &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/propertylist-element-supported-xmla-properties).</span></span> <span data-ttu-id="d865c-654">またはの値に応じて計算されるメンバーの動作の詳細については、「サブ[セレクトとサブキューブで計算されるメンバー](calculated-members-in-subselects-and-subcubes.md) 」を参照してください `SubQueries` `DBPROP_MSMD_SUBQUERIES` 。</span><span class="sxs-lookup"><span data-stu-id="d865c-654">See [Calculated Members in Subselects and Subcubes](calculated-members-in-subselects-and-subcubes.md) for a detailed explanation of the behavior of calculated members depending on the values of `SubQueries` or `DBPROP_MSMD_SUBQUERIES`.</span></span>  
  
  
