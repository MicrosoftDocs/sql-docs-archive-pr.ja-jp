---
title: Analysis Services でのパーティションのマージ (SSAS-多次元) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- partitions [Analysis Services], merging
- merging partitions [Analysis Services]
ms.assetid: b3857b9b-de43-4911-989d-d14da0196f89
author: minewiskan
ms.author: owend
ms.openlocfilehash: 42820a202c4da58e21dfd55756b7bb03522ea879
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87740567"
---
# <a name="merge-partitions-in-analysis-services-ssas---multidimensional"></a><span data-ttu-id="9dfcf-102">Analysis Services でのパーティションのマージ (SSAS - 多次元)</span><span class="sxs-lookup"><span data-stu-id="9dfcf-102">Merge Partitions in Analysis Services (SSAS - Multidimensional)</span></span>
  <span data-ttu-id="9dfcf-103">既存の [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] データベース内のパーティションをマージして、同じメジャー グループの複数のパーティションからファクト データを統合することができます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-103">You can merge partitions in an existing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database to consolidate fact data from multiple partitions of the same measure group.</span></span>  
  
 [<span data-ttu-id="9dfcf-104">一般的なシナリオ</span><span class="sxs-lookup"><span data-stu-id="9dfcf-104">Common scenarios</span></span>](#bkmk_Scenario)  
  
 [<span data-ttu-id="9dfcf-105">必要条件</span><span class="sxs-lookup"><span data-stu-id="9dfcf-105">Requirements</span></span>](#bkmk_prereq)  
  
 [<span data-ttu-id="9dfcf-106">パーティションのマージ後にパーティション ソースを更新</span><span class="sxs-lookup"><span data-stu-id="9dfcf-106">Update the Partition Source after merging partitions</span></span>](#bkmk_Where)  
  
 [<span data-ttu-id="9dfcf-107">ファクト テーブルまたは名前付きクエリによって分割されたパーティションに関する注意事項</span><span class="sxs-lookup"><span data-stu-id="9dfcf-107">Special considerations for partitions segmented by fact table or named query</span></span>](#bkmk_fact)  
  
 [<span data-ttu-id="9dfcf-108">SSMS を使用してパーティションをマージする方法</span><span class="sxs-lookup"><span data-stu-id="9dfcf-108">How to merge partitions using SSMS</span></span>](#bkmk_partitionSSMS)  
  
 [<span data-ttu-id="9dfcf-109">XMLA を使用してパーティションをマージする方法</span><span class="sxs-lookup"><span data-stu-id="9dfcf-109">How to merge partitions using XMLA</span></span>](#bkmk_partitionsXMLA)  
  
##  <a name="common-scenarios"></a><a name="bkmk_Scenario"></a><span data-ttu-id="9dfcf-110">一般的なシナリオ</span><span class="sxs-lookup"><span data-stu-id="9dfcf-110">Common scenarios</span></span>  
 <span data-ttu-id="9dfcf-111">最も一般的なパーティション構成では、時間ディメンション全体にわたってデータが分割されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-111">The single most common configuration for partition use involves the separation of data across the dimension of time.</span></span> <span data-ttu-id="9dfcf-112">各パーティションに関連付けられている時間の粒度は、そのプロジェクト固有のビジネス要件によって異なります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-112">The granularity of time associated with each partition varies depending on the business requirements specific to the project.</span></span> <span data-ttu-id="9dfcf-113">たとえば、データを年で分割し、そのうち最も新しい年を月で分割して、さらにアクティブな月に対して別のパーティションを作成する場合があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-113">For example, segmentation might be by years, with the most recent year divided by months, plus a separate partition for the active month.</span></span> <span data-ttu-id="9dfcf-114">このアクティブな月のパーティションは、定期的に新しいデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-114">The active month partition regularly takes on new data.</span></span>  
  
 <span data-ttu-id="9dfcf-115">アクティブな月が終了すると、そのパーティションは現在までのパーティション内の月にマージされ、処理が続行されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-115">When the active month is completed, that partition is merged back into the months in the year-to-date partition and the process continues.</span></span> <span data-ttu-id="9dfcf-116">年末には、新しい年のパーティションが作成されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-116">At the end of the year, a whole new year partition has been formed.</span></span>  
  
 <span data-ttu-id="9dfcf-117">このシナリオが示すように、パーティションのマージは、定期的に実行される日常的なタスクとなり、履歴データを統合および整理するための革新的な方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-117">As this scenario demonstrates, merging partitions can become a routine task performed on a regular basis, providing a progressive approach for consolidating and organizing historical data.</span></span>  
  
##  <a name="requirements"></a><a name="bkmk_prereq"></a> <span data-ttu-id="9dfcf-118">必要条件</span><span class="sxs-lookup"><span data-stu-id="9dfcf-118">Requirements</span></span>  
 <span data-ttu-id="9dfcf-119">パーティションをマージできるのは、次の条件をすべて満たしている場合に限ります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-119">Partitions can be merged only if they meet all of the following criteria:</span></span>  
  
-   <span data-ttu-id="9dfcf-120">同じメジャー グループであること</span><span class="sxs-lookup"><span data-stu-id="9dfcf-120">They have the same measure group.</span></span>  
  
-   <span data-ttu-id="9dfcf-121">同じ構造であること</span><span class="sxs-lookup"><span data-stu-id="9dfcf-121">They have the same structure.</span></span>  
  
-   <span data-ttu-id="9dfcf-122">処理済みの状態であること</span><span class="sxs-lookup"><span data-stu-id="9dfcf-122">They must be in a processed state.</span></span>  
  
-   <span data-ttu-id="9dfcf-123">同じストレージ モードであること</span><span class="sxs-lookup"><span data-stu-id="9dfcf-123">They have the same storage modes.</span></span>  
  
-   <span data-ttu-id="9dfcf-124">同じ集計デザインを含むこと</span><span class="sxs-lookup"><span data-stu-id="9dfcf-124">They contain identical aggregation designs.</span></span>  
  
-   <span data-ttu-id="9dfcf-125">同じ文字列ストアの互換性レベルを共有していること (パーティション分割された個別のカウント メジャー グループにのみ適用されます)</span><span class="sxs-lookup"><span data-stu-id="9dfcf-125">They share the same string store compatibility level (applies to partitioned distinct count measure groups only).</span></span>  
  
 <span data-ttu-id="9dfcf-126">マージ先のパーティションが空の場合 (つまり、集計デザインがあっても集計が含まれていない場合)、マージによってマージ元のパーティションの集計が削除されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-126">If the target partition is empty (that is, it has an aggregation design but no aggregations), merge will drop the aggregations for the source partitions.</span></span> <span data-ttu-id="9dfcf-127">集計を作成するには、パーティションで "インデックスの処理"、"完全処理"、または "既定の処理" を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-127">You must run Process Index, Process Full, or Process Default on the partition to build the aggregations.</span></span>  
  
 <span data-ttu-id="9dfcf-128">リモート パーティションは、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]の同一のリモート インスタンスで定義された他のリモート パーティションとだけマージできます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-128">Remote partitions can be merged only with other remote partitions that are defined with the same remote instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9dfcf-129">ローカル パーティションとリモート パーティションを組み合わせて使用している場合は、別の方法として、結合したデータを含む新しいパーティションを作成し、今後使用しないパーティションを削除する方法もあります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-129">If you are using a combination of local and remote partitions, an alternative approach is to create new partitions that include the combined data, deleting the partitions you no longer use.</span></span>  
  
 <span data-ttu-id="9dfcf-130">将来のマージに備えたパーティションを作成するには、パーティション ウィザードでパーティションを作成するときに、キューブ内の別のパーティションから集計デザインを選択してコピーします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-130">To create a partition that is a candidate for future merging, when you create the partition in the Partition Wizard, you can choose to copy the aggregation design from another of the cube's partitions.</span></span> <span data-ttu-id="9dfcf-131">これによって、これらのパーティションは同じ集計デザインを持つようになります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-131">This ensures that these partitions have the same aggregation design.</span></span> <span data-ttu-id="9dfcf-132">これらのパーティションがマージされると、ソース パーティションの集計はターゲット パーティションの集計に結合されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-132">When they are merged, the aggregations of the source partition are combined with the aggregations in the target partition.</span></span>  
  
##  <a name="update-the-partition-source-after-merging-partitions"></a><a name="bkmk_Where"></a><span data-ttu-id="9dfcf-133">パーティションのマージ後にパーティションソースを更新する</span><span class="sxs-lookup"><span data-stu-id="9dfcf-133">Update the Partition Source after merging partitions</span></span>  
 <span data-ttu-id="9dfcf-134">パーティションは、データの処理に使用する SQL クエリの WHERE 句などのクエリ、またはパーティションにデータを提供するテーブルや名前付きクエリによって分割されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-134">Partitions are segmented by query, such as the WHERE clause of a SQL query used to process the data, or by a table or named query that provides data to the partition.</span></span> <span data-ttu-id="9dfcf-135">パーティションの `Source` プロパティは、パーティションがクエリまたはテーブルにバインドされているかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-135">The `Source` property on the partition indicates whether the partition is bound to a query or a table.</span></span>  
  
 <span data-ttu-id="9dfcf-136">パーティションをマージすると、パーティションの内容は統合されますが、`Source` プロパティはパーティションの追加のスコープを反映するように更新されません。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-136">When you merge partitions, the contents of the partitions are consolidated, but the `Source` property is not updated to reflect the additional scope of the partition.</span></span> <span data-ttu-id="9dfcf-137">つまり、その後、元の `Source` を保持するパーティションを再処理すると、そのパーティションから不適切なデータを取得することになります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-137">This means if you subsequently reprocess a partition that retains its original `Source`, you will get incorrect data from that partition.</span></span> <span data-ttu-id="9dfcf-138">パーティションは、誤って親レベルのデータを集計します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-138">The partition will erroneously aggregate data at the parent level.</span></span> <span data-ttu-id="9dfcf-139">次の例では、この動作を示します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-139">The following example illustrates this behavior.</span></span>  
  
 <span data-ttu-id="9dfcf-140">**問題を**</span><span class="sxs-lookup"><span data-stu-id="9dfcf-140">**The Problem**</span></span>  
  
 <span data-ttu-id="9dfcf-141">3 種類の清涼飲料水商品についての情報を含むキューブがあるとします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-141">Suppose you have a cube containing information about three soft drink products.</span></span> <span data-ttu-id="9dfcf-142">このキューブには、同一のファクト テーブルを使用する 3 つのパーティションがあります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-142">It has three partitions that use the same fact table.</span></span> <span data-ttu-id="9dfcf-143">これらのパーティションは商品ごとに分割されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-143">These partitions are segmented by product.</span></span> <span data-ttu-id="9dfcf-144">パーティション 1 には ColaFull、パーティション 2 には ColaDecaf、パーティション 3 には ColaDiet のデータがそれぞれ含まれます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-144">Partition 1 contains data about [ColaFull], Partition 2 contains data about [ColaDecaf], and Partition 3 contains data about [ColaDiet].</span></span> <span data-ttu-id="9dfcf-145">ここで、パーティション 3 がパーティション 2 にマージされる場合、マージ後のパーティション (パーティション 2) 内のデータとキューブ データは共に正確です。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-145">If Partition 3 is merged into Partition 2, the data in the resulting partition (Partition 2) is correct and the cube data is accurate.</span></span> <span data-ttu-id="9dfcf-146">ただし、パーティション 2 が処理されると、その内容は商品レベルのメンバーの親によって決定されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-146">However, when Partition 2 is processed, its content may be determined by the parent of the members at the product level.</span></span> <span data-ttu-id="9dfcf-147">この親 [SoftDrinks] には、パーティション 1 の製品の [ColaFull] も含まれます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-147">This parent, [SoftDrinks], also includes [ColaFull], the product in Partition 1.</span></span> <span data-ttu-id="9dfcf-148">パーティション 2 を処理すると、このパーティションに [ColaFull] を含むすべての清涼飲料水のデータが読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-148">Processing Partition 2 loads the partition with data for all soft drinks, including [ColaFull].</span></span> <span data-ttu-id="9dfcf-149">この結果、キューブには ColaFull のデータが重複して含まれ、エンド ユーザーに不正なデータが返されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-149">The cube then contains duplicate data for [ColaFull] and returns incorrect data to end users.</span></span>  
  
 <span data-ttu-id="9dfcf-150">**ソリューション**</span><span class="sxs-lookup"><span data-stu-id="9dfcf-150">**The Solution**</span></span>  
  
 <span data-ttu-id="9dfcf-151">この問題を解決するには、WHERE 句または名前付きクエリを調整するか、基になるファクト テーブルから手動でデータをマージするかによって `Source` プロパティを更新し、パーティションのスコープを拡張した状況でその後の処理が正確になるようにします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-151">The solution is to update the `Source` property, adjusting either the WHERE clause or named query, or manually merging data from the underlying fact tables, to ensure that subsequent processing is accurate given the expanded scope of the partition.</span></span>  
  
 <span data-ttu-id="9dfcf-152">この例では、パーティション 3 をパーティション 2 にマージした後で、マージ後のパーティション 2 で ("Product" = 'ColaDecaf' OR "Product" = 'ColaDiet') のようなフィルターを作成できます。これにより、ColaDecaf と ColaDiet のデータのみをファクト テーブルから取得し、ColaFull のデータは除外するように指定できます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-152">In this example, after merging Partition 3 into Partition 2, you can provide a filter such as ("Product" = 'ColaDecaf' OR "Product" = 'ColaDiet') in the resulting Partition 2 to specify that only data about [ColaDecaf] and [ColaDiet] be extracted from the fact table, and the data pertaining to [ColaFull] be excluded.</span></span> <span data-ttu-id="9dfcf-153">または、パーティション 2 とパーティション 3 の作成時にフィルターを指定することもできます。これらのフィルターはマージ処理で結合されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-153">Alternatively, you can specify filters for Partition 2 and Partition 3 when they are created, and these filters will be combined during the merger process.</span></span> <span data-ttu-id="9dfcf-154">いずれの場合も、パーティションを処理した後にキューブに重複データが含まれることはなくなります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-154">In either case, after the partition is processed the cube does not contain duplicate data.</span></span>  
  
 <span data-ttu-id="9dfcf-155">**結論**</span><span class="sxs-lookup"><span data-stu-id="9dfcf-155">**The Conclusion**</span></span>  
  
 <span data-ttu-id="9dfcf-156">パーティションをマージした後は、必ず `Source` をチェックして、マージされたデータに対してフィルターが正しいことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-156">After you merge partitions, always check the `Source` to verify the filter is correct for the merged data.</span></span> <span data-ttu-id="9dfcf-157">Q1、Q2、および Q3 の履歴データが含まれたパーティションから始めて、これから Q4 をマージする場合、Q4 が含まれるようにフィルターを調整する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-157">If you started with a partition that included historical data for Q1, Q2, and Q3, and you now merge Q4, you must adjust the filter to include Q4.</span></span> <span data-ttu-id="9dfcf-158">そうしないと、その後のパーティションの処理で誤った結果が生成されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-158">Otherwise, subsequent processing of the partition will yield erroneous results.</span></span> <span data-ttu-id="9dfcf-159">Q4 にとって正しくなくなります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-159">It will not be correct for Q4.</span></span>  
  
##  <a name="special-considerations-for-partitions-segmented-by-fact-table-or-named-query"></a><a name="bkmk_fact"></a><span data-ttu-id="9dfcf-160">ファクトテーブルまたは名前付きクエリによって分割されるパーティションに関する特別な考慮事項</span><span class="sxs-lookup"><span data-stu-id="9dfcf-160">Special considerations for partitions segmented by fact table or named query</span></span>  
 <span data-ttu-id="9dfcf-161">パーティションは、クエリのほか、テーブルまたは名前付きクエリでも分割できます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-161">In addition to queries, partitions can also be segmented by table or named query.</span></span> <span data-ttu-id="9dfcf-162">マージ元のパーティションとマージ先のパーティションがデータ ソースまたはデータ ソース ビューで同じファクト テーブルを使用している場合、`Source` プロパティは、パーティションのマージ後に有効になります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-162">If the source partition and target partition use the same fact table in a data source or data source view, the `Source` property is valid after merging partitions.</span></span> <span data-ttu-id="9dfcf-163">このプロパティでは、結果パーティションに適したファクト テーブル データが指定されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-163">It specifies the fact table data that is appropriate to the resulting partition.</span></span> <span data-ttu-id="9dfcf-164">結果パーティションに必要なファクトはファクト テーブル内に存在するので、`Source` プロパティを変更する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-164">Because the facts that are required for the resulting partition are present in the fact table, no modification to the `Source` property is necessary.</span></span>  
  
 <span data-ttu-id="9dfcf-165">複数のファクト テーブルまたは名前付きクエリのデータを使用するパーティションでは、追加の作業が必要です。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-165">Partitions using data from multiple fact tables or named queries require additional work.</span></span> <span data-ttu-id="9dfcf-166">マージ元パーティションのファクト テーブルのファクトは、マージ先パーティションのファクト テーブルに手動でマージする必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-166">You must manually merge the facts from the fact table of the source partition into the fact table of the target partition.</span></span>  
  
 <span data-ttu-id="9dfcf-167">または、マージされたパーティションのソースを、2 つの別個のファクト テーブルの内容を返す名前付きクエリに変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-167">Alternatively, you can change the source for the merged partition to a named query that returns the contents of two separate fact tables.</span></span> <span data-ttu-id="9dfcf-168">この操作を行わないと、ファクト テーブルに含まれる情報が完全になりません。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-168">If this manual step is not performed, the fact table does not contain complete information.</span></span>  
  
 <span data-ttu-id="9dfcf-169">同様の理由で、名前付きクエリから分割されたデータを取得するパーティションを更新する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-169">For the same reason, partitions obtaining segmented data from named queries also require updating.</span></span> <span data-ttu-id="9dfcf-170">結合されたパーティションには、以前に別の名前付きクエリから取得した、結合された結果セットを返す名前付きクエリが必要になります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-170">The combined partition must now have a named query that returns the combined result set that was previously obtained from the separate named queries.</span></span>  
  
## <a name="partition-storage-considerations-molap"></a><span data-ttu-id="9dfcf-171">パーティション ストレージの注意事項: MOLAP</span><span class="sxs-lookup"><span data-stu-id="9dfcf-171">Partition storage considerations: MOLAP</span></span>  
 <span data-ttu-id="9dfcf-172">MOLAP パーティションをマージすると、パーティションの多次元構造に格納されているファクトもマージされます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-172">When MOLAP partitions are merged, the facts stored in the multidimensional structures of the partitions are also merged.</span></span> <span data-ttu-id="9dfcf-173">これにより、内部的に完全で矛盾のないパーティションが作成されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-173">This results in an internally complete and consistent partition.</span></span> <span data-ttu-id="9dfcf-174">ただし、MOLAP パーティションに格納されるファクトは、ファクト テーブル内のファクトのコピーです。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-174">However, the facts stored in MOLAP partitions are copies of facts in the fact table.</span></span> <span data-ttu-id="9dfcf-175">パーティションに対して処理が行われると、多次元構造内のファクトは削除され (完全と更新のみ)、パーティションのデータ ソースとフィルターの指定に従って、ファクト テーブルからデータがコピーされます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-175">When the partition is subsequently processed, the facts in the multidimensional structure are deleted (only for full and refresh) and data is copied from the fact table as specified by the data source and filter for the partition.</span></span> <span data-ttu-id="9dfcf-176">マージ元パーティションで使用されるファクト テーブルがマージ先パーティションのものと異なる場合、マージ元パーティションのファクト テーブルをマージ先パーティションのファクト テーブルに手動でマージして、結果パーティションが処理されるときにデータの完全なセットを利用できるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-176">If the source partition uses a different fact table from the target partition, the fact table of the source partition must be manually merged with the fact table of the target partition to ensure that a complete set of data is available when the resulting partition is processed.</span></span> <span data-ttu-id="9dfcf-177">これは、2 つのパーティションが、それぞれ異なる名前付きクエリに基づいている場合にも適用されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-177">This applies as well if the two partitions were based on different named queries.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9dfcf-178">マージされた MOLAP パーティションに不完全なファクト テーブルが含まれている場合、パーティションには内部的にマージされたファクト テーブル データのコピーが含まれているので、そのパーティションが処理されるまでは正常に動作します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-178">A merged MOLAP partition with an incomplete fact table contains an internally merged copy of fact table data and operates correctly until it is processed.</span></span>  
  
## <a name="partition-storage-considerations-holap-and-rolap-partitions"></a><span data-ttu-id="9dfcf-179">パーティション ストレージの注意事項: HOLAP パーティションと ROLAP パーティション</span><span class="sxs-lookup"><span data-stu-id="9dfcf-179">Partition storage considerations: HOLAP and ROLAP Partitions</span></span>  
 <span data-ttu-id="9dfcf-180">複数のファクト テーブルを持つ HOLAP パーティションや ROLAP パーティションをマージする場合、ファクト テーブルは自動的にマージされません。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-180">When HOLAP or ROLAP partitions that have different fact tables are merged, the fact tables are not automatically merged.</span></span> <span data-ttu-id="9dfcf-181">ファクト テーブルを手動でマージしない場合、結果パーティションではマージ先パーティションに関連付けられたファクト テーブルのみを利用できます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-181">Unless the fact tables are manually merged, only the fact table associated with the target partition is available to the resulting partition.</span></span> <span data-ttu-id="9dfcf-182">マージ元パーティションに関連付けられたファクトは、結果パーティションのドリル ダウンでは利用できません。また、パーティションが処理されると、集計処理では、利用できないテーブルのデータを集約しなくなります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-182">Facts associated with the source partition are not available for drilldown in the resulting partition, and when the partition is processed, aggregations do not summarize data from the unavailable table.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9dfcf-183">マージされた HOLAP パーティションや ROLAP パーティションが不完全なファクト テーブルを持っていると、そこに含まれる集計は正確ですが、ファクトは不完全になります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-183">A merged HOLAP or ROLAP partition with an incomplete fact table contains accurate aggregations, but incomplete facts.</span></span> <span data-ttu-id="9dfcf-184">欠落したファクトを参照するクエリは、不正確なデータを返します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-184">Queries that refer to missing facts return incorrect data.</span></span> <span data-ttu-id="9dfcf-185">パーティションが処理されると、集計は利用可能なファクトからのみ計算されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-185">When the partition is processed, aggregations are computed only from available facts.</span></span>  
  
 <span data-ttu-id="9dfcf-186">利用できないテーブル内のファクトにドリル ダウンしたり、利用できないテーブルのファクトを必要とするクエリを実行しない限り、利用できないファクトの欠落に気が付かない場合があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-186">The absence of unavailable facts might not be noticed unless a user attempts to drill down to a fact in the unavailable table or executes a query that requires a fact from the unavailable table.</span></span> <span data-ttu-id="9dfcf-187">集計はマージ処理の間に結合されるので、結果が集計のみに基づくクエリでは正確なデータが返されますが、それ以外のクエリでは不正確なデータが返される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-187">Because aggregations are combined during the merge process, queries whose results are based only on aggregations return accurate data, whereas other queries may return inaccurate data.</span></span> <span data-ttu-id="9dfcf-188">結果パーティションが処理された後でも、特に利用できないファクト テーブルによるデータ欠落が、結合されたデータに占める割合が小さい場合は、気が付かないことがあります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-188">Even after the resulting partition is processed, the missing data from the unavailable fact table may not be noticed, especially if it represents only a small portion of the combined data.</span></span>  
  
 <span data-ttu-id="9dfcf-189">ファクト テーブルは、パーティションのマージの前または後にマージできます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-189">Fact tables can be merged before or after merging the partitions.</span></span> <span data-ttu-id="9dfcf-190">ただし、両方のマージ処理が完了しないと、集計ではその基になるファクトが正確に表されません。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-190">However, the aggregations will not accurately represent the underlying facts until both operations have been completed.</span></span> <span data-ttu-id="9dfcf-191">複数のファクト テーブルにアクセスする HOLAP パーティションや ROLAP パーティションの場合は、これらのパーティションを含むキューブに接続しているユーザーがいない間にマージを行うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-191">It is recommended that you merge HOLAP or ROLAP partitions that access different fact tables when users are not connected to the cube that contains these partitions.</span></span>  
  
##  <a name="how-to-merge-partitions-using-ssms"></a><a name="bkmk_partitionSSMS"></a><span data-ttu-id="9dfcf-192">SSMS を使用してパーティションをマージする方法</span><span class="sxs-lookup"><span data-stu-id="9dfcf-192">How to merge partitions using SSMS</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9dfcf-193">パーティションをマージする前に、まず、データのフィルター情報 (多くの場合は、SQL クエリに基づくフィルターの WHERE 句) をコピーしてください。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-193">Before merging partitions, first copy the data filter information (often, the WHERE clause for filters based on SQL queries).</span></span> <span data-ttu-id="9dfcf-194">その後、マージが完了したら、蓄積されたファクト データを含むパーティションのパーティション ソース プロパティを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-194">Later, after the merge is completed, you should update the Partition Source property of the partition containing the accumulated fact data.</span></span>  
  
1.  <span data-ttu-id="9dfcf-195">オブジェクト エクスプローラーで、マージするパーティションが含まれているキューブの **[メジャー グループ]** ノードを展開し、 **[パーティション]** を展開して、マージ操作の対象となるパーティションを右クリックします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-195">In Object Explorer, expand the **Measure Groups** node of the cube containing the partitions that you want to merge, expand **Partitions**, right-click the partition that is the target or destination of the merge operation.</span></span> <span data-ttu-id="9dfcf-196">たとえば、年間のファクト データを格納するパーティションに四半期のファクト データを移動する場合は、年間のファクト データが含まれているパーティションを選択します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-196">For example, if you are moving quarterly fact data to a partition that stores annual fact data, select the partition that contains the annual fact data.</span></span>  
  
2.  <span data-ttu-id="9dfcf-197">[パーティションの**マージ**] をクリックして、[**パーティション \<partition name> のマージ**] ダイアログボックスを開きます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-197">Click **Merge Partitions** to open the **Merge Partition \<partition name>** dialog box.</span></span>  
  
3.  <span data-ttu-id="9dfcf-198">**[基になるパーティション]** で、対象パーティションとマージする、基になる各パーティションの横のチェック ボックスをオンにし、 **[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-198">Under **Source Partitions**, select the check box next to each source partition that you want to merge with the target partition, and click **OK**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9dfcf-199">基になるパーティションは、対象パーティションにマージされた直後に削除されます。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-199">Source partitions are immediately deleted after the source is merged into the target partition.</span></span> <span data-ttu-id="9dfcf-200">マージが完了したら、[パーティション] フォルダーを更新してその内容を更新します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-200">Refresh the Partitions folder to update its contents after the merge is completed.</span></span>  
  
4.  <span data-ttu-id="9dfcf-201">蓄積したデータが含まれるパーティションを右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-201">Right-click the partition containing the accumulated data and select **Properties**.</span></span>  
  
5.  <span data-ttu-id="9dfcf-202">プロパティを開き、 `Source` マージしたパーティションデータが含まれるように where 句を変更します。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-202">Open the `Source` property and modify the WHERE clause so that it includes the partition data you just merged.</span></span> <span data-ttu-id="9dfcf-203">`Source`プロパティが自動的に更新されないことを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-203">Recall that the `Source` property is not updated automatically.</span></span> <span data-ttu-id="9dfcf-204">を最初に更新せずに再処理した場合 `Source` 、予想されるデータの一部が取得されない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-204">If you reprocess without first updating the `Source`, you might not get all of the expected data.</span></span>  
  
##  <a name="how-to-merge-partitions-using-xmla"></a><a name="bkmk_partitionsXMLA"></a> <span data-ttu-id="9dfcf-205">XMLA を使用してパーティションをマージする方法</span><span class="sxs-lookup"><span data-stu-id="9dfcf-205">How to merge partitions using XMLA</span></span>  
 <span data-ttu-id="9dfcf-206">詳細については、「[パーティションのマージ &#40;XMLA&#41;](../multidimensional-models-scripting-language-assl-xmla/merging-partitions-xmla.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9dfcf-206">See this topic for information, [Merging Partitions &#40;XMLA&#41;](../multidimensional-models-scripting-language-assl-xmla/merging-partitions-xmla.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9dfcf-207">参照</span><span class="sxs-lookup"><span data-stu-id="9dfcf-207">See Also</span></span>  
 <span data-ttu-id="9dfcf-208">[Analysis Services オブジェクトの処理](processing-analysis-services-objects.md) </span><span class="sxs-lookup"><span data-stu-id="9dfcf-208">[Processing Analysis Services Objects](processing-analysis-services-objects.md) </span></span>  
 <span data-ttu-id="9dfcf-209">[パーティション &#40;Analysis Services-多次元データ&#41;](../multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md) </span><span class="sxs-lookup"><span data-stu-id="9dfcf-209">[Partitions &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md) </span></span>  
 <span data-ttu-id="9dfcf-210">[ローカルパーティション &#40;Analysis Services の作成と管理&#41;](create-and-manage-a-local-partition-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="9dfcf-210">[Create and Manage a Local Partition &#40;Analysis Services&#41;](create-and-manage-a-local-partition-analysis-services.md) </span></span>  
 <span data-ttu-id="9dfcf-211">[リモートパーティション &#40;Analysis Services の作成と管理&#41;](create-and-manage-a-remote-partition-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="9dfcf-211">[Create and Manage a Remote Partition &#40;Analysis Services&#41;](create-and-manage-a-remote-partition-analysis-services.md) </span></span>  
 <span data-ttu-id="9dfcf-212">[パーティションの書き戻しの設定](set-partition-writeback.md) </span><span class="sxs-lookup"><span data-stu-id="9dfcf-212">[Set Partition Writeback](set-partition-writeback.md) </span></span>  
 <span data-ttu-id="9dfcf-213">[書き込み許可パーティション](../multidimensional-models-olap-logical-cube-objects/partitions-write-enabled-partitions.md) </span><span class="sxs-lookup"><span data-stu-id="9dfcf-213">[Write-Enabled Partitions](../multidimensional-models-olap-logical-cube-objects/partitions-write-enabled-partitions.md) </span></span>  
 [<span data-ttu-id="9dfcf-214">ディメンションおよびパーティションの文字列ストレージの構成</span><span class="sxs-lookup"><span data-stu-id="9dfcf-214">Configure String Storage for Dimensions and Partitions</span></span>](configure-string-storage-for-dimensions-and-partitions.md)  
  
  
