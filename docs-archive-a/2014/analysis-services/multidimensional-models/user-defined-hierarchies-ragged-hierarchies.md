---
title: 不規則階層 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ragged hierarchies [Analysis Services]
ms.assetid: e40a5788-7ede-4b0f-93ab-46ca33d0cace
author: minewiskan
ms.author: owend
ms.openlocfilehash: 02cbb24b7ae80facf0ddbb1495fccc8f848df377
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87740530"
---
# <a name="ragged-hierarchies"></a><span data-ttu-id="ad3bc-102">不規則階層</span><span class="sxs-lookup"><span data-stu-id="ad3bc-102">Ragged Hierarchies</span></span>
  <span data-ttu-id="ad3bc-103">不規則階層はユーザー定義の階層で、不均一な数のレベルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-103">A ragged hierarchy is a user-defined hierarchy that has an uneven number of levels.</span></span> <span data-ttu-id="ad3bc-104">一般的な例として、部門の管理者と管理者以外のメンバーの両方が直属の部下として上級管理者に属している組織図や、国 - 地域 - 市から構成される地理的な階層 (ワシントン D.C.、バチカン、ニューデリーなど、親となる州や省などを持たない市がいくつかあります) などを挙げることができます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-104">Common examples include an organizational chart where a high-level manager has both departmental managers and non-managers as direct reports, or geographic hierarchies composed of Country-Region-City, where some cities lack a parent State or Province, such as Washington D.C., Vatican City, or New Delhi.</span></span>  
  
 <span data-ttu-id="ad3bc-105">ディメンション内のほとんどの階層では、各レベルの上にあるメンバーの数は、同じレベルにある他のメンバーでも同じ数になります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-105">For most hierarchies in a dimension, each level has the same number of members above it as any other member at the same level.</span></span> <span data-ttu-id="ad3bc-106">このような場合と異なり、不規則階層では、少なくとも 1 つのメンバーの論理上の親メンバーが、そのメンバーのすぐ上のレベルにありません。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-106">A ragged hierarchy is different in that the logical parent of at least one member is not in the level immediately above the member.</span></span> <span data-ttu-id="ad3bc-107">この場合、階層は異なるドリル ダウン パスのさまざまなレベルに至ります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-107">When this occurs, the hierarchy descends to different levels for different drilldown paths.</span></span> <span data-ttu-id="ad3bc-108">クライアント アプリケーションでは、これによりドリルダウン パスが不必要に複雑になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-108">In a client application, this can make drilldown paths unnecessarily complicated.</span></span>  
  
 <span data-ttu-id="ad3bc-109">クライアント アプリケーションによって、不規則階層の処理方法は異なります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-109">Client applications vary in how well they handle a ragged hierarchy.</span></span> <span data-ttu-id="ad3bc-110">モデル内に不規則階層がある場合は、必要な表示動作が実現されるように、追加の作業を行う準備をしてください。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-110">If ragged hierarchies exist in your model, be prepared to do a little extra work to get the rendering behavior you expect.</span></span>  
  
 <span data-ttu-id="ad3bc-111">まず、クライアント アプリケーションを調べて、ドリル ダウン パスの処理方法を確認します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-111">As a first step, check the client application to see how it handles the drilldown path.</span></span> <span data-ttu-id="ad3bc-112">たとえば、Excel では、不足値のプレースホルダーとして親の名前が繰り返されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-112">For example, Excel repeats the parent names as placeholders for missing values.</span></span> <span data-ttu-id="ad3bc-113">この動作を確認するには、Adventure Works 多次元モデルの Sales Territory ディメンションを使用してピボットテーブルを構築します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-113">To see this behavior yourself, build a PivotTable using the Sales Territory dimension in the Adventure Works multidimensional model.</span></span> <span data-ttu-id="ad3bc-114">ピボットテーブルでは、Sales Territory 属性として "グループ"、"国"、"地域" を設定します。地域の値が欠落している場合、国がプレースホルダーとして使用されることを確認します。この場合は、地域の上の親 (国名) が繰り返し使用されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-114">In a PivotTable having the Sales Territory attributes Group, Country, and Region, you will see that countries missing a region value will get a placeholder, in this case a repeat of the parent above it (Country name).</span></span> <span data-ttu-id="ad3bc-115">この動作は、Excel 内で固定されている MDX Compatibility=1 接続文字列プロパティから派生します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-115">This behavior derives from the MDX Compatibility=1 connection string property that is fixed within Excel.</span></span> <span data-ttu-id="ad3bc-116">必要としているドリル ダウンの動作をクライアントが実現しない場合は、それらの動作のいくつかを変更するように、モデルのプロパティを設定することができます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-116">If the client does not naturally provide the drill-down behaviors you are looking for, you can set properties in the model to change at least some of those behaviors.</span></span>  
  
 <span data-ttu-id="ad3bc-117">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-117">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="ad3bc-118">不規則階層でのドリルダウンナビゲーションを変更する方法</span><span class="sxs-lookup"><span data-stu-id="ad3bc-118">Approaches for modifying drilldown navigation in a ragged hierarchy</span></span>](#bkmk_approach)  
  
-   [<span data-ttu-id="ad3bc-119">HideMemberIf を設定して標準階層のメンバーを非表示にする</span><span class="sxs-lookup"><span data-stu-id="ad3bc-119">Set HideMemberIf to hide members in a regular hierarchy</span></span>](#bkmk_Hide)  
  
-   [<span data-ttu-id="ad3bc-120">MDX の互換性を設定してクライアント アプリケーションでのプレースホルダーの表示方法を指定する</span><span class="sxs-lookup"><span data-stu-id="ad3bc-120">Set MDX Compatibility to determine how placeholders are represented in client applications</span></span>](#bkmk_Mdx)  
  
##  <a name="approaches-for-modifying-drilldown-navigation-in-a-ragged-hierarchy"></a><a name="bkmk_approach"></a> <span data-ttu-id="ad3bc-121">不規則階層でのドリル ダウン ナビゲーションを変更する方法</span><span class="sxs-lookup"><span data-stu-id="ad3bc-121">Approaches for modifying drilldown navigation in a ragged hierarchy</span></span>  
 <span data-ttu-id="ad3bc-122">ドリル ダウン ナビゲーションが予期した値を返さない場合や使いにくい場合、不規則階層の存在が問題になります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-122">The presence of a ragged hierarchy becomes a problem when drilldown navigation does not return expected values or is perceived as awkward to use.</span></span> <span data-ttu-id="ad3bc-123">不規則階層が原因となるナビゲーションの問題を解決するには、次の点を検討してください。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-123">To fix navigation problems that result from ragged hierarchies, consider these options:</span></span>  
  
-   <span data-ttu-id="ad3bc-124">標準階層を使用します。ただし、各レベルの `HideMemberIf` プロパティを設定し、ユーザーに対して欠落しているレベルを表示するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-124">Use a regular hierarchy but set the `HideMemberIf` property on each level to specify whether a missing level is visualized to the user.</span></span> <span data-ttu-id="ad3bc-125">`HideMemberIf` を設定するとき、接続文字列で `MDXCompatibility` も設定し、既定のナビゲーション動作をオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-125">When setting `HideMemberIf`, you should also set `MDXCompatibility` on the connection string to override default navigation behaviors.</span></span> <span data-ttu-id="ad3bc-126">これらのプロパティの設定手順をこのトピックで説明します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-126">Instructions for setting these properties are in this topic.</span></span>  
  
-   <span data-ttu-id="ad3bc-127">レベル メンバーを明示的に管理する親子階層を作成します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-127">Create a parent-child hierarchy that explicitly manages the level members.</span></span> <span data-ttu-id="ad3bc-128">この技法の図解については、「 [Ragged Hierarchy in SSAS (blog post)](http://dwbi1.wordpress.com/2011/03/30/ragged-hierarchy-in-ssas/)」(SSAS での不規則階層 (ブログ投稿)) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-128">For an illustration of the technique, see [Ragged Hierarchy in SSAS (blog post)](http://dwbi1.wordpress.com/2011/03/30/ragged-hierarchy-in-ssas/).</span></span> <span data-ttu-id="ad3bc-129">オンラインブックの詳細については、「[親子階層](parent-child-dimension.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-129">For more information in Books Online, see [Parent-Child Hierarchy](parent-child-dimension.md).</span></span> <span data-ttu-id="ad3bc-130">親子階層を作成する際の問題点は、ディメンションごとに 1 つの階層があるので、中間レベルのメンバーを集計する場合のパフォーマンスが一般的に低下することです。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-130">Downsides to creating a parent-child hierarchy are that you can only have one per dimension, and you typically incur a performance penalty when calculating aggregations for intermediate members.</span></span>  
  
 <span data-ttu-id="ad3bc-131">ディメンションに複数の不規則階層が含まれている場合は、第 1 の方法である、`HideMemberIf` の設定を使用してください。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-131">If your dimension contains more than one ragged hierarchy, you should use the first approach, setting `HideMemberIf`.</span></span> <span data-ttu-id="ad3bc-132">不規則階層の操作について実践的な経験がある BI 開発者であれば、さらに、物理データ テーブルへの追加の変更を提案したり、レベルごとの個別のテーブルを作成したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-132">BI Developers with practical experience in working with ragged hierarchies go further in advocating for additional changes in the physical data tables, creating separate tables for each level.</span></span> <span data-ttu-id="ad3bc-133">この手法の詳細について[は、「Martin を使用した SSAS 財務キューブ-パート 1a-不規則階層 (ブログ)](http://martinmason.wordpress.com/2012/03/03/the-ssas-financial-cubepart-1aragged-hierarchies-cont/) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-133">See [Martin Mason's the SSAS Financial Cube-Part 1a-Ragged Hierarchies (blog)](http://martinmason.wordpress.com/2012/03/03/the-ssas-financial-cubepart-1aragged-hierarchies-cont/) for details about this technique.</span></span>  
  
##  <a name="set-hidememberif-to-hide-members-in-a-regular-hierarchy"></a><a name="bkmk_Hide"></a> <span data-ttu-id="ad3bc-134">HideMemberIf を設定して標準階層のメンバーを非表示にする</span><span class="sxs-lookup"><span data-stu-id="ad3bc-134">Set HideMemberIf to hide members in a regular hierarchy</span></span>  
 <span data-ttu-id="ad3bc-135">不規則なディメンションのテーブルでは、論理的に欠落しているメンバーはさまざまな方法で表されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-135">In a ragged dimension's table, the logically missing members can be represented in different ways.</span></span> <span data-ttu-id="ad3bc-136">テーブルのセルに NULL または空の文字列を含めたり、親と同じ値を含めてプレースホルダーとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-136">The table cells can contain nulls or empty strings, or they can contain the same value as their parent to serve as a placeholder.</span></span> <span data-ttu-id="ad3bc-137">プレースホルダーの表示は、子メンバーのプレースホルダーのステータス、`HideMemberIf` プロパティ、クライアント アプリケーションの `MDX Compatibility` 接続文字列プロパティによって決まります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-137">The representation of placeholders is determined by the placeholder status of child members, as determined by the `HideMemberIf` property, and the `MDX Compatibility` connection string property for the client application.</span></span>  
  
 <span data-ttu-id="ad3bc-138">不規則階層の表示をサポートしているクライアント アプリケーションの場合、これらのプロパティを使用して、論理的に欠落しているメンバーを非表示にできます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-138">For client applications that support the display of ragged hierarchies, you can use these properties to hide logically missing members.</span></span>  
  
1.  <span data-ttu-id="ad3bc-139">SSDT で、ディメンションをダブルクリックし、ディメンション デザイナーでそのディメンションを開きます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-139">In SSDT, double-click a dimension to open it in Dimension Designer.</span></span> <span data-ttu-id="ad3bc-140">最初のタブである [ディメンション構造] の [階層] ペインには、属性階層が表示されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-140">The first tab, Dimension Structure, shows attribute hierarchies in the Hierarchies pane.</span></span>  
  
2.  <span data-ttu-id="ad3bc-141">階層内のメンバーを右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-141">Right-click a member within the hierarchy and select **Properties**.</span></span> <span data-ttu-id="ad3bc-142">`HideMemberIf` を、次に説明する値のいずれかに設定します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-142">Set `HideMemberIf` to one of the values described below.</span></span>  
  
    |<span data-ttu-id="ad3bc-143">HideMemberIf の設定値</span><span class="sxs-lookup"><span data-stu-id="ad3bc-143">HideMemberIf Setting</span></span>|<span data-ttu-id="ad3bc-144">[説明]</span><span class="sxs-lookup"><span data-stu-id="ad3bc-144">Description</span></span>|  
    |--------------------------|-----------------|  
    |`Never`|<span data-ttu-id="ad3bc-145">レベル メンバーがすべて表示されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-145">Level members are never hidden.</span></span> <span data-ttu-id="ad3bc-146">これが既定値です。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-146">This is the default value.</span></span>|  
    |<span data-ttu-id="ad3bc-147">**OnlyChildWithNoName**</span><span class="sxs-lookup"><span data-stu-id="ad3bc-147">**OnlyChildWithNoName**</span></span>|<span data-ttu-id="ad3bc-148">レベル メンバーは、その親の唯一の子で、その名前が null または空の文字列である場合、表示されません。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-148">A level member is hidden when it is the only child of its parent and its name is null or an empty string.</span></span>|  
    |<span data-ttu-id="ad3bc-149">**OnlyChildWithParentName**</span><span class="sxs-lookup"><span data-stu-id="ad3bc-149">**OnlyChildWithParentName**</span></span>|<span data-ttu-id="ad3bc-150">レベル メンバーは、その親の唯一の子で、その名前がその親の名前と同じである場合、表示されません。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-150">A level member is hidden when it is the only child of its parent and its name is the same as the name of its parent.</span></span>|  
    |<span data-ttu-id="ad3bc-151">**NoName**</span><span class="sxs-lookup"><span data-stu-id="ad3bc-151">**NoName**</span></span>|<span data-ttu-id="ad3bc-152">レベル メンバーは、その名前が空の場合、表示されません。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-152">A level member is hidden when its name is empty.</span></span>|  
    |<span data-ttu-id="ad3bc-153">**ParentName**</span><span class="sxs-lookup"><span data-stu-id="ad3bc-153">**ParentName**</span></span>|<span data-ttu-id="ad3bc-154">レベル メンバーは、名前がその親の名前と同じである場合、表示されません。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-154">A level member is hidden when its name is identical to that of its parent.</span></span>|  
  
##  <a name="set-mdx-compatibility-to-determine-how-placeholders-are-represented-in-client-applications"></a><a name="bkmk_Mdx"></a><span data-ttu-id="ad3bc-155">クライアントアプリケーションでのプレースホルダーの表示方法を決定するための MDX 互換性の設定</span><span class="sxs-lookup"><span data-stu-id="ad3bc-155">Set MDX Compatibility to determine how placeholders are represented in client applications</span></span>  
 <span data-ttu-id="ad3bc-156">階層レベルで `HideMemberIf` を設定したら、クライアント アプリケーションから送信される接続文字列の `MDX Compatibility` プロパティも設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-156">After setting `HideMemberIf` on a hierarchy level, you should also set the `MDX Compatibility` property in the connection string sent from the client application.</span></span> <span data-ttu-id="ad3bc-157">`MDX Compatibility` の設定によって、`HideMemberIf` が使用されるかどうかが決まります。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-157">The `MDX Compatibility` setting determines whether the `HideMemberIf` is used.</span></span>  
  
|<span data-ttu-id="ad3bc-158">MDX Compatibility の設定</span><span class="sxs-lookup"><span data-stu-id="ad3bc-158">MDX Compatibility Setting</span></span>|<span data-ttu-id="ad3bc-159">説明</span><span class="sxs-lookup"><span data-stu-id="ad3bc-159">Description</span></span>|<span data-ttu-id="ad3bc-160">使用法</span><span class="sxs-lookup"><span data-stu-id="ad3bc-160">Usage</span></span>|  
|-------------------------------|-----------------|-----------|  
|<span data-ttu-id="ad3bc-161">**1**</span><span class="sxs-lookup"><span data-stu-id="ad3bc-161">**1**</span></span>|<span data-ttu-id="ad3bc-162">プレースホルダーの値を表示します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-162">Show a placeholder value.</span></span>|<span data-ttu-id="ad3bc-163">この値は、Excel、SSDT、SSMS で既定で使用される値です。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-163">This is the default used by Excel, SSDT, and SSMS.</span></span> <span data-ttu-id="ad3bc-164">この値は、サーバーに対して、不規則階層で空のレベルがドリル ダウンされた場合にプレースホルダーの値を返すように指示します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-164">It instructs the server to return placeholder values when drilling down empty levels in a ragged hierarchy.</span></span> <span data-ttu-id="ad3bc-165">プレースホルダーの値をクリックすると、ドリル ダウンを継続して、子 (リーフ) ノードを取得できます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-165">If you click the placeholder value, you can continue down to get to the child (leaf) nodes.</span></span><br /><br /> <span data-ttu-id="ad3bc-166">Excel には Analysis Services に接続する際に使用される接続文字列があり、この接続文字列では、新しく接続を行うたびに `MDX Compatibility` が必ず 1 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-166">Excel owns the connection string used to connect to Analysis Services, and it always sets `MDX Compatibility` to 1 on each new connection.</span></span> <span data-ttu-id="ad3bc-167">この動作は、旧バージョンとの互換性のために保持されています。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-167">This behavior preserves backward compatibility.</span></span>|  
|<span data-ttu-id="ad3bc-168">**2**</span><span class="sxs-lookup"><span data-stu-id="ad3bc-168">**2**</span></span>|<span data-ttu-id="ad3bc-169">プレースホルダーの値 (null 値または親レベルの複製) を非表示にします。ただし、関連する値を持つ他のレベルとノードは表示します。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-169">Hide a placeholder value (either a null value or a duplicate of the parent level), but show other levels and nodes having relevant values.</span></span>|<span data-ttu-id="ad3bc-170">不規則階層では、通常、`MDX Compatibility`=2 が優先される設定として示されます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-170">`MDX Compatibility`=2 is typically viewed as the preferred setting in terms of ragged hierarchies.</span></span> <span data-ttu-id="ad3bc-171">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] レポートと一部のサードパーティのクライアント アプリケーションでは、この設定を保存できます。</span><span class="sxs-lookup"><span data-stu-id="ad3bc-171">A [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report and some third-party client applications can persist this setting.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ad3bc-172">参照</span><span class="sxs-lookup"><span data-stu-id="ad3bc-172">See Also</span></span>  
 <span data-ttu-id="ad3bc-173">[ユーザー定義階層の作成](user-defined-hierarchies-create.md) </span><span class="sxs-lookup"><span data-stu-id="ad3bc-173">[Create User-Defined Hierarchies](user-defined-hierarchies-create.md) </span></span>  
 <span data-ttu-id="ad3bc-174">[ユーザー階層](../multidimensional-models-olap-logical-dimension-objects/user-hierarchies.md) </span><span class="sxs-lookup"><span data-stu-id="ad3bc-174">[User Hierarchies](../multidimensional-models-olap-logical-dimension-objects/user-hierarchies.md) </span></span>  
 <span data-ttu-id="ad3bc-175">[親子階層](parent-child-dimension.md) </span><span class="sxs-lookup"><span data-stu-id="ad3bc-175">[Parent-Child Hierarchy](parent-child-dimension.md) </span></span>  
 [<span data-ttu-id="ad3bc-176">接続文字列プロパティ &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="ad3bc-176">Connection String Properties &#40;Analysis Services&#41;</span></span>](https://docs.microsoft.com/analysis-services/instances/connection-string-properties-analysis-services)  
  
  
