---
title: Analysis Services Development のクライアントアーキテクチャの要件 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- local mining models [Analysis Services]
- Analysis Services, architecture
- providers [Analysis Services]
- data pumps [Analysis Services]
- client architecture [Analysis Services]
- local cubes [Analysis Services]
ms.assetid: 03a8eb6b-159f-4a0a-afbe-06a2424b6090
author: minewiskan
ms.author: owend
ms.openlocfilehash: d1dae97cc76eb09ce0ac4ef9d61d571a6d10c1bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643555"
---
# <a name="client-architecture-requirements-for-analysis-services-development"></a><span data-ttu-id="e7187-102">Analysis Services 開発に関するクライアント アーキテクチャの要件</span><span class="sxs-lookup"><span data-stu-id="e7187-102">Client Architecture Requirements for Analysis Services Development</span></span>
  [!INCLUDE[msCoName](../../../includes/msconame-md.md)]<span data-ttu-id="e7187-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] は、シンクライアントアーキテクチャをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="e7187-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] supports a thin-client architecture.</span></span> <span data-ttu-id="e7187-104">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]計算エンジンは完全にサーバーベースであるため、すべてのクエリがサーバー上で解決されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-104">The [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] calculation engine is entirely server-based, so all queries are resolved on the server.</span></span> <span data-ttu-id="e7187-105">つまり、クエリごとにクライアントとサーバー間での単一ラウンド トリップが必要です。この結果、クエリの複雑さが増すにつれてパフォーマンスが変化します。</span><span class="sxs-lookup"><span data-stu-id="e7187-105">As a result, only a single round trip between the client and the server is required for each query, resulting in scalable performance as queries increase in complexity.</span></span>

 <span data-ttu-id="e7187-106">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] のネイティブ プロトコルは、XML for Analysis (XMLA) です。</span><span class="sxs-lookup"><span data-stu-id="e7187-106">The native protocol for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] is XML for Analysis (XML/A).</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="e7187-107">では、クライアント アプリケーション用のデータ アクセス インターフェイスがいくつか用意されていますが、これらのすべてのコンポーネントは XML for Analysis を使用して [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] のインスタンスと通信を行います。</span><span class="sxs-lookup"><span data-stu-id="e7187-107">provides several data access interfaces for client applications, but all of these components communicate with an instance of [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] using XML for Analysis.</span></span>

 <span data-ttu-id="e7187-108">異なるプログラミング言語をサポートするため、[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] ではいくつかの異なるプロバイダーが用意されています。</span><span class="sxs-lookup"><span data-stu-id="e7187-108">Several different providers are provided with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] to support different programming languages.</span></span> <span data-ttu-id="e7187-109">プロバイダーは、インターネット インフォメーション サービス (IIS) を通じて TCP/IP または HTTP で SOAP パケットの XML for Analysis を送受信することによって [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] サーバーと通信します。</span><span class="sxs-lookup"><span data-stu-id="e7187-109">A provider communicates with an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server by sending and receiving XML for Analysis in SOAP packets over TCP/IP or over HTTP through Internet Information Services (IIS).</span></span> <span data-ttu-id="e7187-110">IIS によってインスタンス化された、データ ポンプと呼ばれる COM オブジェクトを使用する HTTP 接続は、[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] データのパイプとして機能します。</span><span class="sxs-lookup"><span data-stu-id="e7187-110">An HTTP connection uses a COM object instantiated by IIS, called a data pump, which acts as a conduit for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="e7187-111">データ ポンプでは、HTTP ストリーム内に含まれる、基になるデータはまったく検証されません。また、基になるデータ構造はデータ ライブラリ内にあるコードではまったく使用できません。</span><span class="sxs-lookup"><span data-stu-id="e7187-111">The data pump does not examine the underlying data contained in the HTTP stream in any way, nor are any of the underlying data structures available to any of the code in the data library itself.</span></span>

 <span data-ttu-id="e7187-112">![Analysis Services の論理クライアント アーキテクチャ](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Analysis Services の論理クライアント アーキテクチャ")</span><span class="sxs-lookup"><span data-stu-id="e7187-112">![Logical client architecture for Analysis Services](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Logical client architecture for Analysis Services")</span></span>

 <span data-ttu-id="e7187-113">Win32 クライアント アプリケーションから [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] サーバーへの接続には、OLE DB for OLAP インターフェイスまたは Microsoft Visual Basic&#xAE; などのコンポーネント オブジェクト モデル (COM) オートメーション言語用の Microsoft&#xAE; ActiveX&#xAE; データ オブジェクト (ADO) オブジェクト モデルを使用できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-113">Win32 client applications can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using OLE DB for OLAP interfaces or the Microsoft® ActiveX® Data Objects (ADO) object model for Component Object Model (COM) automation languages, such as Microsoft Visual Basic®.</span></span> <span data-ttu-id="e7187-114">.NET 言語で記述されたアプリケーションでは、ADOMD.NET を使用して [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] サーバーに接続できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-114">Applications coded with .NET languages can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using ADOMD.NET.</span></span>

 <span data-ttu-id="e7187-115">既存のアプリケーションは、[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] プロバイダーのいずれかを使用するだけで、変更しなくても [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] と通信できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-115">Existing applications can communicate with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without modification simply by using one of the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] providers.</span></span>

|<span data-ttu-id="e7187-116">プログラミング言語</span><span class="sxs-lookup"><span data-stu-id="e7187-116">Programming Language</span></span>|<span data-ttu-id="e7187-117">データ アクセス インターフェイス</span><span class="sxs-lookup"><span data-stu-id="e7187-117">Data Access Interface</span></span>|
|--------------------------|---------------------------|
|<span data-ttu-id="e7187-118">C++</span><span class="sxs-lookup"><span data-stu-id="e7187-118">C++</span></span>|<span data-ttu-id="e7187-119">OLE DB for OLAP (OLE DB for OLAP)</span><span class="sxs-lookup"><span data-stu-id="e7187-119">OLE DB for OLAP</span></span>|
|<span data-ttu-id="e7187-120">Visual Basic 6</span><span class="sxs-lookup"><span data-stu-id="e7187-120">Visual Basic 6</span></span>|<span data-ttu-id="e7187-121">ADO MD (ADO MD)</span><span class="sxs-lookup"><span data-stu-id="e7187-121">ADO MD</span></span>|
|<span data-ttu-id="e7187-122">.NET 言語</span><span class="sxs-lookup"><span data-stu-id="e7187-122">.NET languages</span></span>|<span data-ttu-id="e7187-123">ADO MD.NET</span><span class="sxs-lookup"><span data-stu-id="e7187-123">ADO MD.NET</span></span>|
|<span data-ttu-id="e7187-124">SOAP をサポートするすべての言語</span><span class="sxs-lookup"><span data-stu-id="e7187-124">Any language that supports SOAP</span></span>|<span data-ttu-id="e7187-125">XML for Analysis (XML for Analysis)</span><span class="sxs-lookup"><span data-stu-id="e7187-125">XML for Analysis</span></span>|

 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="e7187-126">には、小規模な組織と大規模な組織の両方の配置に対応できる完全にスケーラブルな中間層を使用した Web アーキテクチャが装備されています。</span><span class="sxs-lookup"><span data-stu-id="e7187-126">has a Web architecture with a fully scalable middle tier for deployment by both small and large organizations.</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="e7187-127">には、Web サービスへの広範な中間層のサポートが用意されています。</span><span class="sxs-lookup"><span data-stu-id="e7187-127">provides broad middle tier support for Web services.</span></span> <span data-ttu-id="e7187-128">ASP アプリケーションは OLE DB for OLAP および ADO MD によって、ASP.NET アプリケーションは ADOMD.NET によってサポートされています。</span><span class="sxs-lookup"><span data-stu-id="e7187-128">ASP applications are supported by OLE DB for OLAP and ADO MD, ASP.NET applications are supported by ADOMD.NET.</span></span> <span data-ttu-id="e7187-129">次の図のように、中間層は、多数の同時ユーザーに対応できるスケーラブルな層です。</span><span class="sxs-lookup"><span data-stu-id="e7187-129">The middle tier, illustrated in the following figure, is scalable to many concurrent users.</span></span>

 <span data-ttu-id="e7187-130">![中間層アーキテクチャの論理図](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "中間層アーキテクチャの論理図")</span><span class="sxs-lookup"><span data-stu-id="e7187-130">![Logical diagram for middle-tier architecture](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "Logical diagram for middle-tier architecture")</span></span>

 <span data-ttu-id="e7187-131">クライアントおよび中間層アプリケーションは、いずれも、プロバイダーを使用せずに直接 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] と通信できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-131">Both client and middle tier applications can communicate directly with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without using a provider.</span></span> <span data-ttu-id="e7187-132">クライアントおよび中間層アプリケーションによっては、TCP/IP、HTTP、または HTTPS を使用して SOAP パケットで XML for Analysis を送信する場合もあります。</span><span class="sxs-lookup"><span data-stu-id="e7187-132">Client and middle tier applications may send XML for Analysis in SOAP packets over TCP/IP, HTTP, or HTTPS.</span></span> <span data-ttu-id="e7187-133">また、クライアントは SOAP をサポートする任意の言語を使用して記述されている場合もあります。</span><span class="sxs-lookup"><span data-stu-id="e7187-133">The client may be coded using any language that supports SOAP.</span></span> <span data-ttu-id="e7187-134">この場合、通信の管理には、TCP/IP を使用したサーバーへの直接接続が記述されている場合でも、HTTP を介したインターネット インフォメーション サービス (IIS) を使用する方法が最も管理が簡単です。</span><span class="sxs-lookup"><span data-stu-id="e7187-134">Communication in this case is most easily managed by Internet Information Services (IIS) using HTTP, although a direct connection to the server using TCP/IP may also be coded.</span></span> <span data-ttu-id="e7187-135">これが [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] に最適のシン クライアント ソリューションです。</span><span class="sxs-lookup"><span data-stu-id="e7187-135">This is the thinnest possible client solution for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span></span>

## <a name="analysis-services-in-tabular-or-sharepoint-mode"></a><span data-ttu-id="e7187-136">テーブル モードまたは SharePoint モードの Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e7187-136">Analysis Services in Tabular or SharePoint Mode</span></span>
 <span data-ttu-id="e7187-137">では [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 、表形式データベースの場合は xVelocity メモリ内分析エンジン (VertiPaq) モード、 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] SharePoint サイトにパブリッシュされたブックの場合はサーバーを起動できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-137">In [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], the server can be started in xVelocity in-memory analytics engine (VertiPaq) mode for tabular databases and for [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbooks that have been published to a SharePoint site.</span></span>

 [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] <span data-ttu-id="e7187-138">および [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] は、それぞれ SharePoint モードまたは表形式モードを使用するインメモリ データベースの作成とクエリがサポートされる、ただ 1 つのクライアント環境です。</span><span class="sxs-lookup"><span data-stu-id="e7187-138">and [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] are the only client environments that are supported for creating and querying in-memory databases that use SharePoint or Tabular mode, respectively.</span></span> <span data-ttu-id="e7187-139">Excel およびツールを使用して作成した埋め込み PowerPivot データベースは、excel ブック内に格納され、 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] excel .xlsx ファイルの一部として保存されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-139">The embedded PowerPivot database that you create by using the Excel and [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] tools is contained within the Excel workbook, and is saved as part of the Excel .xlsx file.</span></span>

 <span data-ttu-id="e7187-140">ただし、キューブ データをブックにインポートすると、従来のキューブに格納されたデータを [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] ブックで使用できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-140">However, a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook can use data that is stored in a traditional cube if you import the cube data into the workbook.</span></span> <span data-ttu-id="e7187-141">また、SharePoint サイトにパブリッシュされている場合、別の [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] ブックからデータをインポートすることもできます。</span><span class="sxs-lookup"><span data-stu-id="e7187-141">You can also import data from another [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook if it has been published to a SharePoint site.</span></span>

> [!NOTE]
>  <span data-ttu-id="e7187-142">[!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] ブックのデータ ソースとしてキューブを使用する場合、キューブから取得するデータは、MDX クエリとして定義されます。ただし、データはフラット化スナップショットとしてインポートされます。</span><span class="sxs-lookup"><span data-stu-id="e7187-142">When you use a cube as a data source for a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook, the data that you get from the cube is defined as an MDX query; however, the data is imported as a flattened snapshot.</span></span> <span data-ttu-id="e7187-143">キューブのデータは、対話的に操作したり、更新したりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="e7187-143">You cannot interactively work with the data or refresh the data from the cube.</span></span>

### <a name="interfaces-for-powerpivot-client"></a><span data-ttu-id="e7187-144">PowerPivot Client インターフェイス</span><span class="sxs-lookup"><span data-stu-id="e7187-144">Interfaces for PowerPivot Client</span></span>
 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]<span data-ttu-id="e7187-145">Analysis Services に対して確立されたインターフェイスと言語 (AMO および ADOMD.NET、MDX および XMLA) を使用して、ブック内の xVelocity メモリ内分析エンジン (VertiPaq) ストレージエンジンと対話します。</span><span class="sxs-lookup"><span data-stu-id="e7187-145">interacts with the xVelocity in-memory analytics engine (VertiPaq) storage engine within the workbook by using the established interfaces and languages for Analysis Services: AMO and ADOMD.NET, and MDX and XMLA.</span></span> <span data-ttu-id="e7187-146">アドイン内では、メジャーは、Excel、Data Analysis Expressions (DAX) と同様の数式言語を使用して定義されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-146">Within the add-in, measures are defined by using a formula language similar to Excel, Data Analysis Expressions (DAX).</span></span> <span data-ttu-id="e7187-147">DAX の式は、インプロセス サーバーに送信される XMLA メッセージ内に埋め込まれます。</span><span class="sxs-lookup"><span data-stu-id="e7187-147">DAX expressions are embedded within the XMLA messages that are sent to the in-process server.</span></span>

### <a name="providers"></a><span data-ttu-id="e7187-148">プロバイダー</span><span class="sxs-lookup"><span data-stu-id="e7187-148">Providers</span></span>
 <span data-ttu-id="e7187-149">と Excel の間の通信で [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] は、MSOLAP OLEDB プロバイダー (バージョン 11.0) が使用されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-149">Communications between [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] and Excel use the MSOLAP OLEDB provider (version 11.0).</span></span> <span data-ttu-id="e7187-150">MSOLAP プロバイダー内には、4 つの異なるモジュールまたはトランスポートがあり、クライアントとサーバー間のメッセージの送信に使用できます。</span><span class="sxs-lookup"><span data-stu-id="e7187-150">Within the MSOLAP provider, there are four different modules, or transports, that can be used for sending messages between the client and server.</span></span>

 <span data-ttu-id="e7187-151">**TCP/IP**通常のクライアント/サーバー接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-151">**TCP/IP** Used for normal client-server connections.</span></span>

 <span data-ttu-id="e7187-152">**HTTP**SSAS データポンプサービスを介した HTTP 接続、または SharePoint PowerPivot Web サービス (WS) コンポーネントの呼び出しによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-152">**HTTP** Used for HTTP connections via the SSAS data pump service, or by a call to the SharePoint PowerPivot Web Service (WS) component.</span></span>

 <span data-ttu-id="e7187-153">**INPROC**インプロセスエンジンへの接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="e7187-153">**INPROC** Used for connections to the in-process engine.</span></span>

 <span data-ttu-id="e7187-154">**チャネル**SharePoint ファーム内の PowerPivot System サービスとの通信のために予約されています。</span><span class="sxs-lookup"><span data-stu-id="e7187-154">**CHANNEL** Reserved for communications with the PowerPivot System Service in the SharePoint farm.</span></span>

## <a name="see-also"></a><span data-ttu-id="e7187-155">参照</span><span class="sxs-lookup"><span data-stu-id="e7187-155">See Also</span></span>
 [<span data-ttu-id="e7187-156">OLAP エンジンのサーバー コンポーネント</span><span class="sxs-lookup"><span data-stu-id="e7187-156">OLAP Engine Server Components</span></span>](olap-engine-server-components.md)


