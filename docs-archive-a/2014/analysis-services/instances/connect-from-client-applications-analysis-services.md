---
title: クライアントアプリケーションからの接続 (Analysis Services) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b1e0f1d4-0b87-4ad3-8172-f746fe2f16a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: cb93d3a44345d750070a3dda60f82693fd61500b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714789"
---
# <a name="connect-from-client-applications-analysis-services"></a><span data-ttu-id="fb33a-102">クライアント アプリケーションからの接続 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="fb33a-102">Connect from client applications (Analysis Services)</span></span>
  <span data-ttu-id="fb33a-103">Analysis Services を初めて使用する場合は、このトピックの情報を参照し、一般的なツールとアプリケーションを使用して [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] の既存のインスタンスに接続します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-103">If you are new to Analysis Services, use the information in this topic to connect to an existing instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] using common tools and applications.</span></span> <span data-ttu-id="fb33a-104">このトピックでは、テスト目的で異なるユーザー ID を使用して接続する方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-104">This topic also explains how to connect under different user identities for testing purposes.</span></span>  
  
-   [<span data-ttu-id="fb33a-105">SQL Server Management Studio を使用した接続 (SSMS)</span><span class="sxs-lookup"><span data-stu-id="fb33a-105">Connect using SQL Server Management Studio (SSMS)</span></span>](#bkmk_SSMS)  
  
-   [<span data-ttu-id="fb33a-106">Excel による接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-106">Connect using Excel</span></span>](#bkmk_excel)  
  
-   [<span data-ttu-id="fb33a-107">SQL Server Data Tools による接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-107">Connect using SQL Server Data Tools</span></span>](#bkmk_SSDT)  
  
-   [<span data-ttu-id="fb33a-108">テスト接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-108">Test connections</span></span>](#bkmk_tshoot)  
  
 <span data-ttu-id="fb33a-109">接続文字列のリファレンス ドキュメントは個別に用意されています。</span><span class="sxs-lookup"><span data-stu-id="fb33a-109">Connection string reference documentation is provided separately.</span></span> <span data-ttu-id="fb33a-110">詳細については、「[接続文字列プロパティ &#40;Analysis Services&#41;](connection-string-properties-analysis-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-110">For more information, see [Connection String Properties &#40;Analysis Services&#41;](connection-string-properties-analysis-services.md).</span></span>  
  
 <span data-ttu-id="fb33a-111">接続に成功するためには、ポート構成が有効であることと、適切なユーザー権限があることが必要です。</span><span class="sxs-lookup"><span data-stu-id="fb33a-111">Successful connections depend on a valid port configuration and appropriate user permissions.</span></span> <span data-ttu-id="fb33a-112">それぞれの要件の詳細については、次のリンクをクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-112">Click the following links to learn more about each requirement.</span></span>  
  
-   [<span data-ttu-id="fb33a-113">Analysis Services のアクセスを許可するための Windows ファイアウォールの構成</span><span class="sxs-lookup"><span data-stu-id="fb33a-113">Configure the Windows Firewall to Allow Analysis Services Access</span></span>](configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [<span data-ttu-id="fb33a-114">オブジェクトと操作へのアクセスの承認 &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="fb33a-114">Authorizing access to objects and operations &#40;Analysis Services&#41;</span></span>](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)  
  
##  <a name="connect-using-sql-server-management-studio-ssms"></a><a name="bkmk_SSMS"></a> <span data-ttu-id="fb33a-115">SQL Server Management Studio (SSMS) による接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-115">Connect using SQL Server Management Studio (SSMS)</span></span>  
 <span data-ttu-id="fb33a-116">サーバー インスタンスとデータベースを対話操作で管理するには、SSMS で Analysis Services に接続します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-116">Connect to Analysis Services in SSMS to manage server instances and databases interactively.</span></span> <span data-ttu-id="fb33a-117">また、XMLA クエリや MDX クエリを実行して、管理タスクの実行またはデータの取得を行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-117">You can also run XMLA or MDX queries to perform administrative tasks or retrieve data.</span></span> <span data-ttu-id="fb33a-118">クエリの送信時にのみデータベースを読み込むツールやアプリケーションとは異なり、SSMS では、ユーザーがサーバーに接続すると、すべてのデータベースが読み込まれます (データベースを表示する権限がユーザーにある場合)。</span><span class="sxs-lookup"><span data-stu-id="fb33a-118">In contrast with other tools and applications that only load databases when a query is sent, SSMS loads all databases when you connect to the server, assuming you have permission to view the database.</span></span> <span data-ttu-id="fb33a-119">これは、サーバー上に多数のテーブル データベースがある場合、SSMS を使用して接続するとすべてのデータベースがシステム メモリに読み込まれることを表します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-119">This means that if you have numerous tabular databases on the server, all are loaded into system memory when you connect using SSMS.</span></span>  
  
 <span data-ttu-id="fb33a-120">特定のユーザー ID で SSMS を実行し、そのユーザーとして Analysis Services に接続することで、権限をテストできます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-120">You can test permissions by running SSMS under a specific user identity and then connect to Analysis Services as that user.</span></span>  
  
 <span data-ttu-id="fb33a-121">Shift キーを押したまま **[SQL Server Management Studio]** を右クリックして、 **[別のユーザーとして実行]** オプションにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="fb33a-121">Hold-down the Shift key and right-click the **SQL Server Management Studio** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="fb33a-122">[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]を起動します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-122">Start [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="fb33a-123">**[サーバーへの接続]** ダイアログ ボックスで、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サーバーの種類を選択します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-123">In the **Connect to Server** dialog box, select the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server type.</span></span>  
  
2.  <span data-ttu-id="fb33a-124">[ログイン] タブで、サーバーを実行しているコンピューターの名前を入力することによりサーバー名を指定します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-124">In the Login tab, enter the server name by typing the name of the computer on which the server is running.</span></span> <span data-ttu-id="fb33a-125">ネットワーク名または完全修飾ドメイン名を使用してサーバーを指定できます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-125">You can specify the server using its network name or a fully-qualified domain name.</span></span>  
  
     <span data-ttu-id="fb33a-126">名前付きインスタンスの場合は、servername\instancename の形式でサーバー名を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-126">For a named instance, the server name must be specified in this format: servername\instance name.</span></span> <span data-ttu-id="fb33a-127">たとえば、サーバーのネットワーク名が ADV-SRV062 で、Finance という名前付きインスタンスとして Analysis Services がインストールされている場合、「ADV-SRV062\Finance」と入力します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-127">An example of this naming convention might be ADV-SRV062\Finance for a server that has a network name of ADV-SRV062, where Analysis Services was installed as a named instance entitled Finance.</span></span>  
  
     <span data-ttu-id="fb33a-128">フェールオーバー クラスター内に配置したサーバーの場合は、SSAS クラスターのネットワーク名を使用して接続します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-128">For servers deployed in a failover cluster, connect using the network name of the SSAS cluster.</span></span> <span data-ttu-id="fb33a-129">この名前は、SQL Server のセットアップ時に、 **[SQL Server のネットワーク名]** として指定されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-129">This name is specified during SQL Server setup, as **SQL Server Network Name**.</span></span> <span data-ttu-id="fb33a-130">Windows Server フェールオーバー クラスター (WSFC) に、名前付きインスタンスとして SSAS をインストールした場合、接続時にインスタンス名を追加することはできません。</span><span class="sxs-lookup"><span data-stu-id="fb33a-130">Note that if you installed SSAS as a named instance onto a Windows Server Failover Cluster (WSFC), you never add the instance name on the connection.</span></span> <span data-ttu-id="fb33a-131">これは SSAS 独自の処理です。これとは対照的に、クラスター化されたリレーショナル データベース エンジンの名前付きインスタンスには、インスタンス名が含まれています。</span><span class="sxs-lookup"><span data-stu-id="fb33a-131">This practice is unique to SSAS; in contrast, a named instance of a clustered relational database engine does include the instance name.</span></span> <span data-ttu-id="fb33a-132">たとえば、SSAS とデータベース エンジンの両方を名前付きインスタンス (Contoso-Accounting) として、SQL-CLU という SQL Server のネットワーク名を使用してインストールした場合、"SQL-CLU" を使って SSAS に接続し、"SQL-CLU\Contoso-Accounting" というデータベース エンジンに接続することになります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-132">For example, if you installed both SSAS and the database engine as named instance (Contoso-Accounting) with a SQL Server Network Name of SQL-CLU, you would connect to SSAS using "SQL-CLU" and to the database engine as "SQL-CLU\Contoso-Accounting".</span></span> <span data-ttu-id="fb33a-133">詳細と例については、「 [SQL Server Analysis Services をクラスター化する方法](https://go.microsoft.com/fwlink/p/?LinkId=396548) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-133">See [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) for more information and examples.</span></span>  
  
     <span data-ttu-id="fb33a-134">ネットワーク負荷分散クラスター内に配置したサーバーの場合は、NLB の仮想サーバー名を使用して接続します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-134">For servers deployed in a network load balanced cluster, connect using the virtual server name of the NLB.</span></span>  
  
3.  <span data-ttu-id="fb33a-135">認証方式は常に Windows 認証です。また、ユーザー ID として使用するユーザーは常に、Management Studio を介して接続する Windows ユーザーです。</span><span class="sxs-lookup"><span data-stu-id="fb33a-135">Authentication is always Windows authentication, and the user identity is always the Windows user who is connecting via Management Studio.</span></span>  
  
     <span data-ttu-id="fb33a-136">接続に成功するためには、サーバー (またはサーバー上のデータベース) にアクセスするための権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="fb33a-136">In order for the connection to succeed, you must have permission to access the server or a database on the server.</span></span> <span data-ttu-id="fb33a-137">Management Studio で実行するほとんどのタスクには管理権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="fb33a-137">Most tasks that you want to perform in Management Studio require administrative permissions.</span></span> <span data-ttu-id="fb33a-138">接続に使用するアカウントがサーバー管理者ロールのメンバーであることを確認します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-138">Ensure that the account you are connecting with is a member of the Server Administrator role.</span></span> <span data-ttu-id="fb33a-139">詳細については、「 [Analysis Services&#41;&#40;サーバー管理者のアクセス許可を付与](grant-server-admin-rights-to-an-analysis-services-instance.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-139">For more information, see [Grant Server Administrator Permissions &#40;Analysis Services&#41;](grant-server-admin-rights-to-an-analysis-services-instance.md).</span></span>  
  
4.  <span data-ttu-id="fb33a-140">**[接続プロパティ]** をクリックして、特定のデータベースを指定、タイムアウト値を設定、または暗号化のオプションを設定します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-140">Click **Connection Properties** to specify a particular database, set timeout values, or encryption options.</span></span> <span data-ttu-id="fb33a-141">省略可能な接続情報としては、現在の接続にしか使用されない接続プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-141">Optional connection information includes connection properties used for the current connection only.</span></span>  
  
5.  <span data-ttu-id="fb33a-142">**[追加の接続パラメーター]** タブをクリックして、[サーバーへの接続] ダイアログ ボックスに用意されていない接続プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-142">Click **Additional Connection Parameters** tab to set connection properties not available in the Connect to Server dialog box.</span></span> <span data-ttu-id="fb33a-143">たとえば、テキスト ボックスに `Roles=Reader` を入力する場合があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-143">For example, you might type `Roles=Reader` in the text box.</span></span>  
  
     <span data-ttu-id="fb33a-144">より限られた権限のロールで接続すると、そのロールが有効なときにデータベースの動作をテストすることができます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-144">Connecting through a role with less permission lets you test database behaviors when that role is in effect.</span></span>  
  
    ```  
    Provider=MSOLAP; Data Source=SERVERNAME; Initial Catalog=AdventureWorks2012; Roles=READER  
    ```  
  
##  <a name="connect-using-excel"></a><a name="bkmk_excel"></a><span data-ttu-id="fb33a-145">Excel を使用した接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-145">Connect using Excel</span></span>  
 <span data-ttu-id="fb33a-146">ビジネス データを分析するために Microsoft Excel を使用することがよくあります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-146">Microsoft Excel is often used for analyzing business data.</span></span> <span data-ttu-id="fb33a-147">Office で Excel をインストールすると、ネットワーク サーバー上のデータをいつでもすぐに利用できるように、Analysis Services OLE DB プロバイダー (MSOLAP.dll)、ADOMD.NET、およびその他のデータ プロバイダーがインストールされます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-147">As part of an Excel installation, Office installs the Analysis Services OLE DB provider (MSOLAP DLL), ADOMD.NET, and other data providers so that you can more readily use the data on your network servers.</span></span> <span data-ttu-id="fb33a-148">新しいバージョンの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] を以前のバージョンの Excel と共に使用するときは、場合によっては、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]に接続する各ワークステーションに新しいデータ プロバイダーをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-148">If you are using a newer version of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] with an older version of Excel, you most likely need to install newer data providers on each workstation that connects to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="fb33a-149">詳細については、「 [Analysis Services 接続に使用するデータ プロバイダー](data-providers-used-for-analysis-services-connections.md) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-149">See [Data providers used for Analysis Services connections](data-providers-used-for-analysis-services-connections.md) for more information.</span></span>  
  
 <span data-ttu-id="fb33a-150">Analysis Services キューブまたはテーブル モデル データベースに対する接続をセットアップすると、接続情報が、将来の使用に備えて .odc ファイルに保存されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-150">When you set up a connection to an Analysis Services cube or tabular model database, Excel saves the connection information in .odc file for future use.</span></span> <span data-ttu-id="fb33a-151">接続は、現在の Windows ユーザーのセキュリティ コンテキストで確立されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-151">The connection is made in security context of the current Windows user.</span></span> <span data-ttu-id="fb33a-152">接続が成功するためには、このユーザー アカウントに、データベースの読み取り権限が与えられている必要があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-152">The user account must have read permissions on the database in order for the connection to succeed.</span></span>  
  
 <span data-ttu-id="fb33a-153">Excel ブックで [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] データを使用するとき、その接続は、クエリ要求の間保持されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-153">When using [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data in an Excel workbook, connections are held for the duration of a query request.</span></span> <span data-ttu-id="fb33a-154">このため、Excel からクエリ ワークロードを監視する際に、各セッションに対して多くの接続が確認される場合があります。これらの接続が保持されるのは短期間です。</span><span class="sxs-lookup"><span data-stu-id="fb33a-154">This is why you are likely to see lots of connections for each session, held for very short periods of time, when monitoring a query workload from Excel.</span></span>  
  
 <span data-ttu-id="fb33a-155">特定のユーザー ID で Excel を起動することにより、権限をテストできます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-155">You can test permissions by starting Excel under a specific user identity.</span></span>  
  
 <span data-ttu-id="fb33a-156">Shift キーを押したまま **[Excel]** を右クリックして、 **[別のユーザーとして実行]** オプションにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="fb33a-156">Hold-down the Shift key and right-click the **Excel** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="fb33a-157">Excel の [データ] タブで、 **[その他のデータ ソース]** をクリックし、 **[Analysis Services]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="fb33a-157">On the Data tab in Excel, click **From Other Sources**, and then click **From Analysis Services**.</span></span> <span data-ttu-id="fb33a-158">サーバー名を入力し、クエリを実行するキューブまたはパースペクティブを選択します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-158">Enter the server name, and then select a cube or perspective to query.</span></span>  
  
     <span data-ttu-id="fb33a-159">負荷分散クラスター内に配置するサーバーの場合は、クラスターに割り当てた仮想サーバー名を使用します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-159">For servers deployed in a load-balanced cluster, use the virtual server name assigned to the cluster.</span></span>  
  
2.  <span data-ttu-id="fb33a-160">Excel での接続を設定するときに、データ接続ウィザードの最後のページで、Excel Services の認証設定を指定できます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-160">When setting up a connection in Excel, on the last page of the Data Connection Wizard, you can specify authentication settings for Excel Services.</span></span> <span data-ttu-id="fb33a-161">Excel Services が存在する SharePoint サーバーにブックをアップロードするときには、これらの設定を使用してブックのプロパティが設定されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-161">These settings are used to set properties on the workbook should you upload it to a SharePoint server that has Excel Services.</span></span> <span data-ttu-id="fb33a-162">この設定は、データ更新操作で使用されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-162">The settings are used in data refresh operations.</span></span> <span data-ttu-id="fb33a-163">オプションとしては、 **[Windows 認証]**、 **[Secure Store Service]** (SSS)、 **[なし]** があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-163">Options include **Windows Authentication**, **Secure Store Service** (SSS), and **None**.</span></span>  
  
     <span data-ttu-id="fb33a-164">**[なし]** を選択することは避けてください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-164">Avoid using **None**.</span></span> <span data-ttu-id="fb33a-165">Analysis Services では、接続先のサーバーが HTTP アクセス用に構成されていないと、ユーザー名とパスワードを接続文字列に指定できません。</span><span class="sxs-lookup"><span data-stu-id="fb33a-165">Analysis Services does not let you specify a user name and password on the connection string unless you are connecting to a server that has been configured for HTTP access.</span></span> <span data-ttu-id="fb33a-166">同様に、Analysis Services データベースに対するユーザー アクセス権を持った一連の Windows ユーザーの資格情報に SSS ターゲット アプリケーション ID がマップされていることがわかっている場合を除き、SSS は使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-166">Similarly, do not use SSS unless you already know that the SSS target application ID is mapped to a set of Windows user credentials that have user access to the Analysis Services databases.</span></span> <span data-ttu-id="fb33a-167">既定のオプションは Windows 認証であり、Excel から Analysis Services に接続するほとんどのシナリオに最適な選択肢です。</span><span class="sxs-lookup"><span data-stu-id="fb33a-167">For most scenarios, using the default option of Windows authentication is the best choice for an Analysis Services connection from Excel.</span></span>  
  
 <span data-ttu-id="fb33a-168">詳細については、「 [SQL Server Analysis Services のデータに接続する、または SQL Server Analysis Services のデータをインポートする](https://go.microsoft.com/fwlink/?linkID=215150)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-168">For more information, see [Connect to or import data from SQL Server Analysis Services](https://go.microsoft.com/fwlink/?linkID=215150).</span></span>  
  
##  <a name="connect-using-sql-server-data-tools"></a><a name="bkmk_SSDT"></a><span data-ttu-id="fb33a-169">SQL Server Data Tools を使用した接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-169">Connect using SQL Server Data Tools</span></span>  
 <span data-ttu-id="fb33a-170">SQL Server Data Tools は、Analysis Services モデル、Reporting Services レポート、SSIS パッケージを含む BI ソリューションを構築するために使用します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-170">SQL Server Data Tools is used for building BI solutions, including Analysis Services models, Reporting Services reports, and SSIS packages.</span></span> <span data-ttu-id="fb33a-171">レポートまたはパッケージを構築する際に、Analysis Services への接続を指定する必要が生じる場合があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-171">When building reports or packages, you might need to specify a connection to Analysis Services.</span></span>  
  
 <span data-ttu-id="fb33a-172">次のリンク先では、レポート サーバー プロジェクトまたは Integration Services プロジェクトから Analysis Services に接続する方法を説明しています。</span><span class="sxs-lookup"><span data-stu-id="fb33a-172">The following links explain how to connect to Analysis Services from a Report Server project or an Integration Services project:</span></span>  
  
-   [<span data-ttu-id="fb33a-173">MDX のための Analysis Services の接続の種類 (SSRS)</span><span class="sxs-lookup"><span data-stu-id="fb33a-173">Analysis Services Connection Type for MDX &#40;SSRS&#41;</span></span>](../../reporting-services/report-data/analysis-services-connection-type-for-mdx-ssrs.md)  
  
-   [<span data-ttu-id="fb33a-174">Analysis Services 接続マネージャー</span><span class="sxs-lookup"><span data-stu-id="fb33a-174">Analysis Services Connection Manager</span></span>](../../integration-services/connection-manager/analysis-services-connection-manager.md)  
  
> [!NOTE]  
>  <span data-ttu-id="fb33a-175">SQL Server Data Tools を使用して既存の Analysis Services プロジェクトで作業する場合、ローカル プロジェクトまたはバージョン管理されたプロジェクトを使用してオフラインで接続したり、オンライン モードで接続して、データベースの実行中に Analysis Services オブジェクトを更新することができます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-175">When using SQL Server Data Tools to work on an existing Analysis Services project, remember that you can connect offline using a local or version controlled project, or connect in online mode to update Analysis Services objects while the database is running.</span></span> <span data-ttu-id="fb33a-176">詳細については、「 [Analysis Services データベースへのオンライン モードでの接続](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-176">For more information, see [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md).</span></span> <span data-ttu-id="fb33a-177">[!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] からの接続はプロジェクト モードで行う方が一般的です。この場合は、明示的にプロジェクトを配置したときにのみ、変更がデータベースに反映されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-177">More commonly, connections from [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] are in project mode, where changes are deployed to the database only when you explicitly deploy the project.</span></span>  
  
##  <a name="test-connections"></a><a name="bkmk_tshoot"></a><span data-ttu-id="fb33a-178">テスト接続</span><span class="sxs-lookup"><span data-stu-id="fb33a-178">Test connections</span></span>  
 <span data-ttu-id="fb33a-179">SQL Server Profiler を使用すると、Analysis Services への接続を監視することができます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-179">You can use SQL Server Profiler to monitor connections to Analysis Services.</span></span> <span data-ttu-id="fb33a-180">Audit Login イベントおよび Audit Logout イベントは、接続の証拠を示します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-180">The Audit Login and Audit Logout events provide evidence of a connection.</span></span> <span data-ttu-id="fb33a-181">ID 列は、接続が確立されたセキュリティ コンテキストを示します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-181">The identity column indicates the security context under which the connection is made.</span></span>  
  
1.  <span data-ttu-id="fb33a-182">Analysis Services インスタンスで **SQL Server Profiler** を開始し、新しいトレースを開始します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-182">Start **SQL Server Profiler** on the Analysis Services instance and then start a new trace.</span></span>  
  
2.  <span data-ttu-id="fb33a-183">[イベントの選択] で、[Security Audit] セクションの [`Audit Login`] および [`Audit Logout`] のチェック ボックスがオンになっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-183">In Events Selection, verify that `Audit Login` and `Audit Logout` are checked in the Security Audit section.</span></span>  
  
3.  <span data-ttu-id="fb33a-184">リモート クライアント コンピューターから、アプリケーション サービス (SharePoint、Reporting Services など) を介して Analysis Services に接続します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-184">Connect to Analysis Services via an application service (such as SharePoint or Reporting Services) from a remote client computer.</span></span> <span data-ttu-id="fb33a-185">Audit Login イベントに、Analysis Services に接続しているユーザーの ID が表示されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-185">The Audit Login event will show the identity of the user connecting to Analysis Services.</span></span>  
  
 <span data-ttu-id="fb33a-186">接続エラーがトレースされると、多くの場合、不完全なサーバー構成や無効なサーバー構成であることがわかります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-186">Connection errors are often traced to an incomplete or invalid server configuration.</span></span> <span data-ttu-id="fb33a-187">必ずサーバー構成を最初に確認します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-187">Always check server configuration first:</span></span>  
  
-   <span data-ttu-id="fb33a-188">リモート コンピューターから ping を実行して、サーバーがリモート接続を許可することを確認します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-188">Ping the server from a remote computer to ensure it allows remote connections.</span></span>  
  
-   <span data-ttu-id="fb33a-189">**サーバー上のファイアウォール ルールでは、同じドメインのクライアントからの着信接続が許可されます。**</span><span class="sxs-lookup"><span data-stu-id="fb33a-189">**Firewall rules on the server allow inbound connections from clients in the same domain**</span></span>  
  
     <span data-ttu-id="fb33a-190">PowerPivot for SharePoint を除き、リモート サーバーに対するすべての接続は、ファイアウォールの構成 (Analysis Services がリッスンしているポートへのアクセスを許可) を必要とします。</span><span class="sxs-lookup"><span data-stu-id="fb33a-190">With the exception of PowerPivot for SharePoint, all connections to a remote server require that you have configured the firewall to allow access to the port that Analysis Services is listening on.</span></span> <span data-ttu-id="fb33a-191">接続エラーが発生した場合は、ポートにアクセスできるかどうかと、適切なデータベースに対しユーザー権限が付与されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-191">If you are getting connection errors, verify that the port is accessible and that user permissions are granted to the appropriate databases.</span></span>  
  
     <span data-ttu-id="fb33a-192">テストするには、リモート コンピューターで Excel または SSMS を使用し、Analysis Services インスタンスが使用する IP アドレスとポートを指定します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-192">To test, use Excel or SSMS to on a remote computer, specifying the IP address and port used by the Analysis Services instance.</span></span> <span data-ttu-id="fb33a-193">接続できる場合は、ファイアウォール ルールがインスタンスに対して有効であり、インスタンスはリモート接続を許可します。</span><span class="sxs-lookup"><span data-stu-id="fb33a-193">If you can connection, the firewall rules are valid for the instance and the instance allows remote connections.</span></span>  
  
     <span data-ttu-id="fb33a-194">また、TCP/IP を接続プロトコルに使用する場合、Analysis Services では、クライアント接続が同じドメインまたは信頼されたドメインからのものであることが必要です。</span><span class="sxs-lookup"><span data-stu-id="fb33a-194">Also, when using TCP/IP for the connection protocol, remember that Analysis Services requires client connections originate from the same domain or a trusted domain.</span></span> <span data-ttu-id="fb33a-195">接続がセキュリティの境界をまたがっている場合は、HTTP アクセスを構成する必要性が最も高くなります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-195">If connections flow across security boundaries, you will most likely need to configure HTTP access.</span></span> <span data-ttu-id="fb33a-196">詳細については、「 [インターネット インフォメーション サービス &#40;IIS&#41; 8.0 上の Analysis Services への HTTP アクセスの構成](configure-http-access-to-analysis-services-on-iis-8-0.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fb33a-196">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
-   <span data-ttu-id="fb33a-197">一部のツールで接続できるが他のツールでは接続できないということはないでしょうか。</span><span class="sxs-lookup"><span data-stu-id="fb33a-197">Can you connect using some tools but not others?</span></span> <span data-ttu-id="fb33a-198">間違ったバージョンのクライアント ライブラリが問題である可能性があります。</span><span class="sxs-lookup"><span data-stu-id="fb33a-198">The problem might be the wrong version of a client library.</span></span> <span data-ttu-id="fb33a-199">クライアント ライブラリは、SQL Server Feature Pack のダウンロード ページから入手きます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-199">You can get client libraries from the SQL Server Feature Pack download page.</span></span>  
  
 <span data-ttu-id="fb33a-200">接続エラーの解決に役立つリソースは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="fb33a-200">Resources that can help you resolve connection failures include the following:</span></span>  
  
 <span data-ttu-id="fb33a-201">「[SQL Server 2005 Analysis Services の接続シナリオにおける一般的な接続の問題の解決](https://technet.microsoft.com/library/cc917670.aspx)」</span><span class="sxs-lookup"><span data-stu-id="fb33a-201">[Resolving Common Connectivity Issues in SQL Server 2005 Analysis Services Connectivity Scenarios](https://technet.microsoft.com/library/cc917670.aspx).</span></span> <span data-ttu-id="fb33a-202">このドキュメントは数年前のものですが、記載されている情報と手法はそのまま適用されます。</span><span class="sxs-lookup"><span data-stu-id="fb33a-202">This document is a few years old, but the information and methodologies still apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fb33a-203">参照</span><span class="sxs-lookup"><span data-stu-id="fb33a-203">See Also</span></span>  
 <span data-ttu-id="fb33a-204">[Analysis Services への接続](connect-to-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="fb33a-204">[Connect to Analysis Services](connect-to-analysis-services.md) </span></span>  
 <span data-ttu-id="fb33a-205">[Analysis Services によってサポートされる認証方法](authentication-methodologies-supported-by-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="fb33a-205">[Authentication methodologies supported by Analysis Services](authentication-methodologies-supported-by-analysis-services.md) </span></span>  
 <span data-ttu-id="fb33a-206">[SSAS の &#40;の権限借用表形式&#41;](../tabular-models/impersonation-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="fb33a-206">[Impersonation &#40;SSAS Tabular&#41;](../tabular-models/impersonation-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="fb33a-207">データ ソースの作成 &#40;SSAS 多次元&#41;</span><span class="sxs-lookup"><span data-stu-id="fb33a-207">Create a Data Source &#40;SSAS Multidimensional&#41;</span></span>](../multidimensional-models/create-a-data-source-ssas-multidimensional.md)  
  
  
