---
title: Analysis Services アクセスを許可するように Windows ファイアウォールを構成する |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ports [Analysis Services]
- Windows Firewall [Analysis Services]
- firewall systems [Analysis Services]
ms.assetid: 7673acc5-75f0-4703-9ce2-87425ea39d49
author: minewiskan
ms.author: owend
ms.openlocfilehash: f7d63b392148bf10a6b121dd4d201b7a7c61e0c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714790"
---
# <a name="configure-the-windows-firewall-to-allow-analysis-services-access"></a><span data-ttu-id="022ad-102">Analysis Services のアクセスを許可するための Windows ファイアウォールの構成</span><span class="sxs-lookup"><span data-stu-id="022ad-102">Configure the Windows Firewall to Allow Analysis Services Access</span></span>
  <span data-ttu-id="022ad-103">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] や [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] をネットワーク上で利用できるようにするための重要な最初の手順は、ファイアウォールのポートのブロックを解除する必要があるかどうかを判断することです。</span><span class="sxs-lookup"><span data-stu-id="022ad-103">An essential first step in making [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] available on the network is to determine whether you need to unblock ports in a firewall.</span></span> <span data-ttu-id="022ad-104">ほとんどのインストールでは、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]への接続を許可する受信ファイアウォール ルールを少なくとも 1 つ作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-104">Most installations will require that you create at least one in-bound firewall rule that allows connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="022ad-105">ファイアウォールの構成要件は、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]のインストール方法によって異なります。</span><span class="sxs-lookup"><span data-stu-id="022ad-105">Firewall configuration requirements vary depending on how you installed [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="022ad-106">既定のインスタンスをインストールした場合や、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] フェールオーバー クラスターを作成した場合は、TCP ポート 2383 を開きます。</span><span class="sxs-lookup"><span data-stu-id="022ad-106">Open TCP port 2383 when installing a default instance or creating an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster.</span></span>  
  
-   <span data-ttu-id="022ad-107">名前付きインスタンスをインストールした場合は、TCP ポート 2382 を開きます。</span><span class="sxs-lookup"><span data-stu-id="022ad-107">Open TCP port 2382 when installing a named instance.</span></span> <span data-ttu-id="022ad-108">名前付きインスタンスは、動的なポート割り当てを使用します。</span><span class="sxs-lookup"><span data-stu-id="022ad-108">Named instances use dynamic port assignments.</span></span> <span data-ttu-id="022ad-109">Analysis Services の検出サービスとして、SQL Server Browser サービスは TCP ポート 2382 をリッスンし、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]によって現在使用されているポートに対して接続要求をリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="022ad-109">As the discovery service for Analysis Services, SQL Server Browser service listens on TCP port 2382 and redirects the connection request to the port currently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="022ad-110">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] を SharePoint モードでインストールし、 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013 をサポートしている場合は、TCP ポート 2382 を開きます。</span><span class="sxs-lookup"><span data-stu-id="022ad-110">Open TCP port 2382 when installing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode to support [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span></span> <span data-ttu-id="022ad-111">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013 では、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスは SharePoint の外部に位置します。</span><span class="sxs-lookup"><span data-stu-id="022ad-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance is external to SharePoint.</span></span> <span data-ttu-id="022ad-112">SharePoint Web アプリケーションから発信され、ネットワーク接続を経由して名前付きの 'PowerPivot' インスタンスに至る着信要求では、開かれたポートが必要になります。</span><span class="sxs-lookup"><span data-stu-id="022ad-112">Inbound requests to the named 'PowerPivot' instance originate from SharePoint web applications over a network connection, requiring an open port.</span></span> <span data-ttu-id="022ad-113">他の名前付き [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスと同様に、TCP 2382 で SQL Server Browser サービスに対して [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]へのアクセスを許可する受信ルールを作成します。</span><span class="sxs-lookup"><span data-stu-id="022ad-113">As with other [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, create an inbound rule for SQL Server Browser service on TCP 2382 to allow access to [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="022ad-114">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010 の場合は、Windows ファイアウォールでポートを開けないでください。</span><span class="sxs-lookup"><span data-stu-id="022ad-114">For [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, do not open ports in Windows Firewall.</span></span> <span data-ttu-id="022ad-115">このサービスは SharePoint アドインとして、SharePoint を対象として構成されたポートを使用し、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスへのローカル接続のみを作成します。このインスタンスは、 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] データ モデルの読み込みとそのモデルに対するクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="022ad-115">As an add-in to SharePoint, the service uses ports configured for SharePoint and makes only local connections to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance that loads and queries [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models.</span></span>  
  
-   <span data-ttu-id="022ad-116">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]Azure Virtual Machines で実行されているインスタンスの場合は、サーバーアクセスを構成するための代替手順を使用します。</span><span class="sxs-lookup"><span data-stu-id="022ad-116">For [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances running on Azure Virtual Machines, use alternate instructions for configuring server access.</span></span> <span data-ttu-id="022ad-117">「 [Azure Virtual Machines でのビジネスインテリジェンスの SQL Server」を](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx)参照してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-117">See [SQL Server Business Intelligence in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span></span>  
  
 <span data-ttu-id="022ad-118">の既定のインスタンスは [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] TCP ポート2383でリッスンしますが、別の固定ポートでリッスンするようにサーバーを構成し、次の形式でサーバーに接続することができます。 \<servername> \<portnumber></span><span class="sxs-lookup"><span data-stu-id="022ad-118">Although the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383, you can configure the server to listen on a different fixed port, connecting to the server in this format: \<servername>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="022ad-119">1 つの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスで使用できるのは、1 つの TCP ポートのみです。</span><span class="sxs-lookup"><span data-stu-id="022ad-119">Only one TCP port can be used by an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="022ad-120">複数のネットワーク カードまたは複数の IP アドレスを使用しているコンピューターでは、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] は、そのコンピューターに割り当てられているすべての IP アドレス、または別名を付けられているすべての IP アドレスに対応する 1 つの TCP ポートをリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-120">On computers having multiple network cards or multiple IP addresses, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on one TCP port for all IP addresses assigned or aliased to the computer.</span></span> <span data-ttu-id="022ad-121">特定のマルチポート要件がある場合は、HTTP アクセス用に [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] を構成することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-121">If you have specific multi-port requirements, consider configuring [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] for HTTP access.</span></span> <span data-ttu-id="022ad-122">そうすれば、どのポートを選択しても、複数の HTTP エンドポイントを設定できます。</span><span class="sxs-lookup"><span data-stu-id="022ad-122">You can then set up multiple HTTP endpoints on whatever ports you choose.</span></span> <span data-ttu-id="022ad-123">「[インターネット インフォメーション サービス (IIS) 8.0 上の Analysis Services への HTTP アクセスの構成](configure-http-access-to-analysis-services-on-iis-8-0.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-123">See [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="022ad-124">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="022ad-124">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="022ad-125">Analysis Services で使用されるポートとファイアウォールの設定</span><span class="sxs-lookup"><span data-stu-id="022ad-125">Check port and firewall settings for Analysis Services</span></span>](#bkmk_checkport)  
  
-   [<span data-ttu-id="022ad-126">Analysis Services の既定のインスタンスに対する Windows ファイアウォールの構成</span><span class="sxs-lookup"><span data-stu-id="022ad-126">Configure Windows Firewall for a default instance of Analysis Services</span></span>](#bkmk_default)  
  
-   [<span data-ttu-id="022ad-127">Analysis Services の名前付きインスタンスに対する Windows ファイアウォール アクセスの構成</span><span class="sxs-lookup"><span data-stu-id="022ad-127">Configure Windows Firewall access for a named instance of Analysis Services</span></span>](#bkmk_named)  
  
-   [<span data-ttu-id="022ad-128">Analysis Services クラスターのポートの構成</span><span class="sxs-lookup"><span data-stu-id="022ad-128">Port configuration for an Analysis Services cluster</span></span>](#bkmk_cluster)  
  
-   [<span data-ttu-id="022ad-129">PowerPivot for SharePoint のポートの構成</span><span class="sxs-lookup"><span data-stu-id="022ad-129">Port configuration for PowerPivot for SharePoint</span></span>](#bkmk_powerpivot)  
  
-   [<span data-ttu-id="022ad-130">Analysis Services の既定のインスタンスまたは名前付きインスタンスに対する固定ポートの使用</span><span class="sxs-lookup"><span data-stu-id="022ad-130">Use a fixed port for a default or named instance of Analysis Services</span></span>](#bkmk_fixed)  
  
 <span data-ttu-id="022ad-131">Windows ファイアウォールの既定の設定の詳細と、データベース エンジン、Analysis Services、Reporting Services、および Integration Services に影響する TCP ポートの説明については、「 [SQL Server のアクセスを許可するための Windows ファイアウォールの構成](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="022ad-131">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the Database Engine, Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span>  
  
##  <a name="check-port-and-firewall-settings-for-analysis-services"></a><a name="bkmk_checkport"></a><span data-ttu-id="022ad-132">Analysis Services のポートとファイアウォールの設定を確認する</span><span class="sxs-lookup"><span data-stu-id="022ad-132">Check port and firewall settings for Analysis Services</span></span>  
 <span data-ttu-id="022ad-133">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]でサポートされる Microsoft Windows オペレーティング システムの場合、既定で Windows ファイアウォールが有効になっており、リモート接続はブロックされます。</span><span class="sxs-lookup"><span data-stu-id="022ad-133">On the Microsoft Windows operating systems that are supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall is on by default and is blocking remote connections.</span></span> <span data-ttu-id="022ad-134">Analysis Services への着信要求を許可するために、ファイアウォール内でポートを手動で開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-134">You must manually open a port in the firewall to allow inbound requests to Analysis Services.</span></span> <span data-ttu-id="022ad-135">SQL Server セットアップでは、この手順が自動的に実行されません。</span><span class="sxs-lookup"><span data-stu-id="022ad-135">SQL Server Setup does not perform this step for you.</span></span>  
  
 <span data-ttu-id="022ad-136">ポートの設定は、msmdsrv.ini ファイルと、SQL Server Management Studio の Analysis Services インスタンスの [全般プロパティ] ページで指定します。</span><span class="sxs-lookup"><span data-stu-id="022ad-136">Port settings are specified in the msmdsrv.ini file and in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span> <span data-ttu-id="022ad-137">`Port` が正の整数に設定されている場合、Analysis Services は固定ポートでリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-137">If `Port` is set to a positive integer, the service is listening on a fixed port.</span></span> <span data-ttu-id="022ad-138">`Port` が 0 に設定されている場合、Analysis Services が既定のインスタンスであればポート 2383 でリッスンし、名前付きインスタンスであれば動的に割り当てられたポートでリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-138">If `Port` is set to 0, the service is listening on port 2383 if it is the default instance or on a dynamically assigned port if it is a named instance.</span></span>  
  
 <span data-ttu-id="022ad-139">動的なポート割り当ては、名前付きインスタンスでのみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-139">Dynamic port assignments are only used by named instances.</span></span> <span data-ttu-id="022ad-140">`MSOLAP$InstanceName` サービスによって、使用されるポートが起動時に決定されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-140">The `MSOLAP$InstanceName` service determines which port to use when it starts up.</span></span> <span data-ttu-id="022ad-141">名前付きインスタンスによって使用されている実際のポート番号は、次の方法で調べることができます。</span><span class="sxs-lookup"><span data-stu-id="022ad-141">You can determine the actual port number in use by a named instance by doing the following:</span></span>  
  
-   <span data-ttu-id="022ad-142">タスクマネージャーを起動し、[**サービス**] をクリックしての PID を取得し `MSOLAP$InstanceName` ます。</span><span class="sxs-lookup"><span data-stu-id="022ad-142">Start Task Manager and then click **Services** to get the PID of the `MSOLAP$InstanceName`.</span></span>  
  
-   <span data-ttu-id="022ad-143">コマンド ラインから「`netstat -ao -p TCP`」を実行し、その PID に対応する TCP ポート情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="022ad-143">Run `netstat -ao -p TCP` from the command line to view the TCP port information for that PID.</span></span>  
  
-   <span data-ttu-id="022ad-144">SQL Server Management Studio を使用してポートを確認し、次の形式で Analysis Services サーバーに接続し \<IPAddress> ます。 \<portnumber></span><span class="sxs-lookup"><span data-stu-id="022ad-144">Verify the port by using SQL Server Management Studio and connect to an Analysis Services server in this format: \<IPAddress>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="022ad-145">アプリケーションが特定のポートをリッスンしていても、ファイアウォールによってアクセスがブロックされていれば、接続は失敗します。</span><span class="sxs-lookup"><span data-stu-id="022ad-145">Although an application might be listening on a specific port, connections will not succeed if a firewall is blocking access.</span></span> <span data-ttu-id="022ad-146">Analysis Services の名前付きインスタンスに接続するには、msmdsrv.exe へのアクセスのブロックを解除するか、ファイアウォール内でリッスンしている固定ポートへのアクセスのブロックを解除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-146">In order for connections to reach a named Analysis Services instance, you must unblock access to either msmdsrv.exe or the fixed port on which it is listening in the firewall.</span></span> <span data-ttu-id="022ad-147">以降のセクションで、その手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="022ad-147">The remaining sections in this topic provide instructions for doing so.</span></span>  
  
 <span data-ttu-id="022ad-148">Analysis Services に対するファイアウォール設定が既に定義されているかどうかを確認するには、コントロール パネルの [セキュリティが強化された Windows ファイアウォール] を使用します。</span><span class="sxs-lookup"><span data-stu-id="022ad-148">To check whether firewall settings are already defined for Analysis Services, use Windows Firewall with Advanced Security in Control Panel.</span></span> <span data-ttu-id="022ad-149">[監視] フォルダーの [ファイアウォール] ページに、ローカル サーバーに対して定義されている規則がすべて表示されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-149">The Firewall page in the Monitoring folder shows a complete list of the rules defined for the local server.</span></span>  
  
 <span data-ttu-id="022ad-150">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]では、すべてのファイアウォール ルールを手動で定義する必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-150">Note that for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], all firewall rules must be manually defined.</span></span> <span data-ttu-id="022ad-151">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] および SQL Server Browser ではポート 2382 および 2383 が予約されていますが、SQL Server セットアップ プログラムでも、その他の構成ツールでも、ポートまたはプログラム実行可能ファイルへのアクセスを許可するファイアウォールの規則は自動的に定義されません。</span><span class="sxs-lookup"><span data-stu-id="022ad-151">Although [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reserve ports 2382 and 2383, neither the SQL Server setup program nor any of the configuration tools define firewall rules that allow access to either the ports or the program executable files.</span></span>  
  
##  <a name="configure-windows-firewall-for-a-default-instance-of-analysis-services"></a><a name="bkmk_default"></a><span data-ttu-id="022ad-152">Analysis Services の既定のインスタンス用に Windows ファイアウォールを構成する</span><span class="sxs-lookup"><span data-stu-id="022ad-152">Configure Windows Firewall for a default instance of Analysis Services</span></span>  
 <span data-ttu-id="022ad-153">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] の既定のインスタンスは TCP ポート 2383 でリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-153">The default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383.</span></span> <span data-ttu-id="022ad-154">既定のインスタンスがインストールされている場合にこのポートを使用するには、Windows ファイアウォールで TCP ポート 2383 への受信アクセスを解除し、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]の既定のインスタンスへのリモート アクセスを有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-154">If you installed the default instance and want to use this port, you only need to unblock inbound access to TCP port 2383 in Windows Firewall to enable remote access to the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="022ad-155">既定のインスタンスがインストールされているときに、固定ポートでリッスンするようにサービスを構成する場合は、このトピックの「 [Analysis Services の既定のインスタンスまたは名前付きインスタンスに対する固定ポートの使用](#bkmk_fixed) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-155">If you installed the default instance but want to configure the service to listen on a fixed port, see [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic.</span></span>  
  
 <span data-ttu-id="022ad-156">このサービスが既定のインスタンス (MSSQLServerOLAPService) として動作しているかどうか確認するには、SQL Server 構成マネージャーでサービスの名前を確認します。</span><span class="sxs-lookup"><span data-stu-id="022ad-156">To verify whether the service is running as the default instance (MSSQLServerOLAPService), check the service name in SQL Server Configuration Manager.</span></span> <span data-ttu-id="022ad-157">Analysis Services の既定のインスタンスは、常に **[SQL Server Analysis Services (MSSQLSERVER)]** という名前で表示されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-157">A default instance of Analysis Services is always listed as **SQL Server Analysis Services (MSSQLSERVER)**.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="022ad-158">Windows オペレーティング システムの種類によっては、Windows ファイアウォールを構成する別のツールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="022ad-158">Different Windows operating systems provide alternative tools for configuring Windows Firewall.</span></span> <span data-ttu-id="022ad-159">ほとんどのツールでは、特定のポートとプログラム実行可能ファイルのどちらを開くかを選択できます。</span><span class="sxs-lookup"><span data-stu-id="022ad-159">Most of these tools let you choose between opening a specific port or program executable.</span></span> <span data-ttu-id="022ad-160">プログラム実行可能ファイルを指定する必要がなければ、ポートを指定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="022ad-160">Unless you have a reason for specifying the program executable, we recommend that you specify the port.</span></span>  
  
 <span data-ttu-id="022ad-161">受信の規則を指定するときには、後で探しやすいような名前を付けてください (たとえば、 **SQL Server Analysis Services (TCP-in) 2383**など)。</span><span class="sxs-lookup"><span data-stu-id="022ad-161">When specifying an inbound rule, be sure to adopt a naming convention that allows you to easily find the rules later (for example, **SQL Server Analysis Services (TCP-in) 2383**).</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="022ad-162">セキュリティが強化された Windows ファイアウォール</span><span class="sxs-lookup"><span data-stu-id="022ad-162">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="022ad-163">Windows 7 または Windows Vista の場合、コントロール パネルの **[システムとセキュリティ]** をクリックした後、 **[Windows ファイアウォール]**、 **[詳細設定]** の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-163">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="022ad-164">Windows Server 2008 または 2008 R2 の場合、管理ツールを開き、 **[セキュリティが強化された Windows ファイアウォール]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-164">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="022ad-165">Windows Server 2012 では、アプリケーション ページを開き、「 **Windows ファイアウォール**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="022ad-165">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="022ad-166">**[受信の規則]** を右クリックし、 **[新しい規則]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-166">Right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="022ad-167">[ルールの種類] で、[] をクリックし、[ `Port` **次へ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-167">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="022ad-168">[プロトコルおよびポート] で、[ **TCP** ] を選択し、[ `2383` **特定のローカルポート**] を入力します。</span><span class="sxs-lookup"><span data-stu-id="022ad-168">In Protocol and Ports, select **TCP** and then type `2383` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="022ad-169">[操作] で、 **[接続を許可する]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-169">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="022ad-170">[プロファイル] で、規則を適用しないネットワークの場所のチェック ボックスをオフにした後、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-170">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="022ad-171">[名前] に、この規則のわかりやすい名前 (など) を入力 `SQL Server Analysis Services (tcp-in) 2383` し、[**完了**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-171">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services (tcp-in) 2383`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="022ad-172">リモート接続が有効になっているかどうかを検証するには、SQL Server Management Studio または Excel を異なるコンピューター上で開き、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] [サーバー名] **に表示されているサーバーのネットワーク名を指定して**に接続します。</span><span class="sxs-lookup"><span data-stu-id="022ad-172">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] by specifying the network name of the server in **Server name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="022ad-173">他のユーザーは、アクセス許可が与えられるまでこのサーバーにはアクセスできません。</span><span class="sxs-lookup"><span data-stu-id="022ad-173">Other users will not have access to this server until you grant permissions.</span></span> <span data-ttu-id="022ad-174">詳細については、「[オブジェクトと操作へのアクセスの承認 (Analysis Services)](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-174">For more information, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="022ad-175">Netsh AdvFirewall 構文</span><span class="sxs-lookup"><span data-stu-id="022ad-175">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="022ad-176">次のコマンドを実行すると、TCP ポート 2383 での受信要求を許可する受信の規則が作成されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-176">The following command creates an inbound rule that allows incoming requests on TCP port 2383.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services inbound on TCP 2383" dir=in action=allow protocol=TCP localport=2383 profile=domain  
    ```  
  
##  <a name="configure-windows-firewall-access-for-a-named-instance-of-analysis-services"></a><a name="bkmk_named"></a><span data-ttu-id="022ad-177">Analysis Services の名前付きインスタンスに対する Windows ファイアウォールアクセスを構成する</span><span class="sxs-lookup"><span data-stu-id="022ad-177">Configure Windows Firewall access for a named instance of Analysis Services</span></span>  
 <span data-ttu-id="022ad-178">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] の名前付きインスタンスは、指定した固定ポートまたは動的に割り当てられたポートをリッスンできます。動的に割り当てられたポートでは、SQL Server Browser サービスによって接続時現在のサービスの接続情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-178">Named instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can either listen on a fixed port or on a dynamically assigned port, where SQL Server Browser service provides the connection information that is current for the service at the time of the connection.</span></span>  
  
 <span data-ttu-id="022ad-179">SQL Server Browser サービスは TCP ポート 2382 でリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-179">SQL Server Browser service listens on TCP port 2382.</span></span> <span data-ttu-id="022ad-180">UDP は使用されません。</span><span class="sxs-lookup"><span data-stu-id="022ad-180">UDP is not used.</span></span> <span data-ttu-id="022ad-181">TCP は、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]で使用される唯一の転送プロトコルです。</span><span class="sxs-lookup"><span data-stu-id="022ad-181">TCP is the only transmission protocol used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="022ad-182">次のアプローチのいずれかを使用して、Analysis Services の名前付きインスタンスへのリモート アクセスを有効にします。</span><span class="sxs-lookup"><span data-stu-id="022ad-182">Choose one of the following approaches to enable remote access to a named instance of Analysis Services:</span></span>  
  
-   <span data-ttu-id="022ad-183">動的なポート割り当ておよび SQL Server Browser サービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="022ad-183">Use dynamic port assignments and SQL Server Browser service.</span></span> <span data-ttu-id="022ad-184">SQL Server Browser サービスが使用するポートのブロックを Windows ファイアウォールで解除します。</span><span class="sxs-lookup"><span data-stu-id="022ad-184">Unblock the port used by SQL Server Browser service in Windows Firewall.</span></span> <span data-ttu-id="022ad-185"><instancename という形式でサーバーに接続し \<servername> \\ \> ます。</span><span class="sxs-lookup"><span data-stu-id="022ad-185">Connect to the server in this format: \<servername>\\<instancename\>.</span></span>  
  
-   <span data-ttu-id="022ad-186">固定ポートおよび SQL Server Browser サービスの両方を連携して使用します。</span><span class="sxs-lookup"><span data-stu-id="022ad-186">Use a fixed port and SQL Server Browser service together.</span></span> <span data-ttu-id="022ad-187">この方法では、<instancename という形式を使用して接続できます。 \<servername> \\ \> ただし、動的なポート割り当て方法と同じですが、この場合、サーバーは固定ポートでリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-187">This approach lets you connect using this format: \<servername>\\<instancename\>, identical to the dynamic port assignment approach, except that in this case the server listens on a fixed port.</span></span> <span data-ttu-id="022ad-188">このシナリオでは、SQL Server Browser Service は、固定ポートでリッスンしている Analysis Services のインスタンスに名前解決を提供します。</span><span class="sxs-lookup"><span data-stu-id="022ad-188">In this scenario, SQL Server Browser Service provides name resolution to the Analysis Services instance listening on the fixed port.</span></span> <span data-ttu-id="022ad-189">このアプローチを使用するには、サーバーを固定ポートでリッスンするように構成し、そのポートへのアクセスのブロックを解除して、SQL Server Browser サービスが使用するポートへのアクセスのブロックを解除します。</span><span class="sxs-lookup"><span data-stu-id="022ad-189">To use this approach, configure the server to listen on a fixed port, unblock access to that port, and unblock access to the port used by SQL Server Browser service.</span></span>  
  
 <span data-ttu-id="022ad-190">SQL Server Browser サービスは、名前付きインスタンスでのみ使用されます。既定のインスタンスで使用されることはありません。</span><span class="sxs-lookup"><span data-stu-id="022ad-190">SQL Server Browser service is only used with named instances, never with the default instance.</span></span> <span data-ttu-id="022ad-191">サービスは、SQL Server の任意の機能が名前付きインスタンスとしてインストールされるときに、自動的にインストールされ有効になります。</span><span class="sxs-lookup"><span data-stu-id="022ad-191">The service is automatically installed and enabled whenever you install any SQL Server feature as a named instance.</span></span> <span data-ttu-id="022ad-192">SQL Server Browser サービスが必要なアプローチを選択する場合、サービスが使用するサーバーで有効になっていることと起動されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-192">If you choose an approach that requires SQL Server Browser service, be sure it remains enabled and started on your server.</span></span>  
  
 <span data-ttu-id="022ad-193">SQL Server Browser サービスが使用できない場合は、ドメイン名の解決をスキップし、接続文字列内で固定ポートを割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-193">If you cannot use SQL Server Browser service, you must assign a fixed port in the connection string, bypassing domain name resolution.</span></span> <span data-ttu-id="022ad-194">SQL Server Browser サービスを使用しない場合は、すべてのクライアント接続に接続文字列 (AW-SRV01:54321 など) にあるポート番号が含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-194">Without SQL Server Browser service, all client connections must include the port number on the connection string (for example, AW-SRV01:54321).</span></span>  
  
 <span data-ttu-id="022ad-195">**オプション 1: 動的なポート割り当てを使用し、SQL Server Browser サービスへのアクセスのブロックを解除する**</span><span class="sxs-lookup"><span data-stu-id="022ad-195">**Option 1: Use dynamic port assignments and unblock access to SQL Server Browser service**</span></span>  
  
 <span data-ttu-id="022ad-196">Analysis Services の名前付きインスタンスに対する動的なポート割り当ては、サービスの起動時に、`MSOLAP$InstanceName` によって決定されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-196">Dynamic port assignments for named instances of Analysis Services are established by the `MSOLAP$InstanceName` when the service starts.</span></span> <span data-ttu-id="022ad-197">既定で、使用可能なポートのうち最も小さい番号のポートが要求され、サービスが再起動されるたびに異なるポート番号が使用されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-197">By default, the service claims the first available port number that it finds, using a different port number each time the service is restarted.</span></span>  
  
 <span data-ttu-id="022ad-198">インスタンス名の解決は、SQL Server Browser サービスによって処理されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-198">Instance name resolution is handled by the SQL Server browser service.</span></span> <span data-ttu-id="022ad-199">名前付きインスタンスのある動的ポートの割り当てを使用している場合には、必ず、SQL Server Browser サービスの TCP ポート 2382 のブロックを解除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-199">Unblocking TCP port 2382 for SQL Server Browser service is always required if you are using dynamic port assignments with a named instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="022ad-200">SQL Server Browser サービスは、データベース エンジンに対応する UDP ポート 1434 と、Analysis Services に対応する TCP ポート 2382 をリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-200">SQL Server Browser service listens on both UDP port 1434 and TCP port 2382 for the Database Engine and Analysis Services, respectively.</span></span> <span data-ttu-id="022ad-201">SQL Server Browser サービス用に UDP ポート 1434 のブロックを既に解除している場合でも、Analysis Services 用に TCP ポート 2382 のブロックを解除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-201">Even if you already unblocked UDP port 1434 for the SQL Server Browser service, you must still unblock TCP port 2382 for Analysis Services.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="022ad-202">セキュリティが強化された Windows ファイアウォール</span><span class="sxs-lookup"><span data-stu-id="022ad-202">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="022ad-203">Windows 7 または Windows Vista の場合、コントロール パネルの **[システムとセキュリティ]** をクリックした後、 **[Windows ファイアウォール]**、 **[詳細設定]** の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-203">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="022ad-204">Windows Server 2008 または 2008 R2 の場合、管理ツールを開き、 **[セキュリティが強化された Windows ファイアウォール]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-204">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="022ad-205">Windows Server 2012 では、アプリケーション ページを開き、「 **Windows ファイアウォール**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="022ad-205">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="022ad-206">SQL Server Browser サービスへのアクセスのブロックを解除するには、 **[受信の規則]** を右クリックし、 **[新しい規則]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-206">To unblock access to SQL Server Browser service, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="022ad-207">[ルールの種類] で、[] をクリックし、[ `Port` **次へ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-207">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="022ad-208">[プロトコルおよびポート] で、[ **TCP** ] を選択し、[ `2382` **特定のローカルポート**] を入力します。</span><span class="sxs-lookup"><span data-stu-id="022ad-208">In Protocol and Ports, select **TCP** and then type `2382` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="022ad-209">[操作] で、 **[接続を許可する]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-209">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="022ad-210">[プロファイル] で、規則を適用しないネットワークの場所のチェック ボックスをオフにした後、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-210">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="022ad-211">[名前] に、この規則のわかりやすい名前 (など) を入力 `SQL Server Browser Service (tcp-in) 2382` し、[**完了**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-211">In Name, type a descriptive name for this rule (for example, `SQL Server Browser Service (tcp-in) 2382`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="022ad-212">リモート接続が有効になっていることを確認するには、別のコンピューターで SQL Server Management Studio または Excel を開き、サーバーのネットワーク名とインスタンス名を<instancename という形式で指定して、Analysis Services に接続します \<servername> \\ \> 。</span><span class="sxs-lookup"><span data-stu-id="022ad-212">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the instance name in this format: \<servername>\\<instancename\>.</span></span> <span data-ttu-id="022ad-213">たとえば、名前付きインスタンス **Finance** のある **AW-SRV01**という名前の付けられたサーバーでは、サーバー名は **AW-SRV01\Finance**となります。</span><span class="sxs-lookup"><span data-stu-id="022ad-213">For example, on a server named **AW-SRV01** with a named instance of **Finance**, the server name is **AW-SRV01\Finance**.</span></span>  
  
 <span data-ttu-id="022ad-214">**オプション 2: 名前付きインスタンスに固定ポートを使用する**</span><span class="sxs-lookup"><span data-stu-id="022ad-214">**Option 2: Use a fixed port for a named instance**</span></span>  
  
 <span data-ttu-id="022ad-215">または、固定ポートを割り当てた後で、そのポートへのアクセスのブロックを解除します。</span><span class="sxs-lookup"><span data-stu-id="022ad-215">Alternatively, you can assign a fixed port, and then unblock access to that port.</span></span> <span data-ttu-id="022ad-216">このアプローチには、プログラムの実行ファイルへのアクセスを許可するよりも監査を実行しやすいというメリットがあります。</span><span class="sxs-lookup"><span data-stu-id="022ad-216">This approach offers better auditing capability than if you allowed access to the program executable.</span></span> <span data-ttu-id="022ad-217">このため、Analysis Services の任意のインスタンスにアクセスする方法としては、固定ポートを使用するアプローチをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="022ad-217">For this reason, using a fixed port is the recommended approach for accessing any Analysis Services instance.</span></span>  
  
 <span data-ttu-id="022ad-218">固定ポートを割り当てるには、このトピックの「 [Analysis Services の既定のインスタンスまたは名前付きインスタンスに対する固定ポートの使用](#bkmk_fixed) 」で説明する手順を実行してから、このセクションに戻ってポートのブロックを解除します。</span><span class="sxs-lookup"><span data-stu-id="022ad-218">To assign a fixed port, follow the instructions in [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic, then return to this section to unblock the port.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="022ad-219">セキュリティが強化された Windows ファイアウォール</span><span class="sxs-lookup"><span data-stu-id="022ad-219">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="022ad-220">Windows 7 または Windows Vista の場合、コントロール パネルの **[システムとセキュリティ]** をクリックした後、 **[Windows ファイアウォール]**、 **[詳細設定]** の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-220">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="022ad-221">Windows Server 2008 または 2008 R2 の場合、管理ツールを開き、 **[セキュリティが強化された Windows ファイアウォール]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-221">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="022ad-222">Windows Server 2012 では、アプリケーション ページを開き、「 **Windows ファイアウォール**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="022ad-222">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="022ad-223">Analysis Services へのアクセスのブロックを解除するには、 **[受信の規則]** を右クリックし、 **[新しい規則]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-223">To unblock access to Analysis Services, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="022ad-224">[ルールの種類] で、[] をクリックし、[ `Port` **次へ**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-224">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="022ad-225">[プロトコルおよびポート] で、 **[TCP]** をクリックし、 **[特定のローカル ポート]** に固定ポートの番号を入力します。</span><span class="sxs-lookup"><span data-stu-id="022ad-225">In Protocol and Ports, select **TCP** and then type the fixed port in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="022ad-226">[操作] で、 **[接続を許可する]** をクリックし、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-226">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="022ad-227">[プロファイル] で、規則を適用しないネットワークの場所のチェック ボックスをオフにした後、 **[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-227">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="022ad-228">[名前] に、この規則のわかりやすい名前 (など) を入力 `SQL Server Analysis Services on port 54321` し、[**完了**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="022ad-228">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services on port 54321`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="022ad-229">リモート接続が有効になっていることを確認するには、別のコンピューターで SQL Server Management Studio または Excel を開き、サーバーのネットワーク名とポート番号を次の形式で指定して、Analysis Services に接続し \<servername> ます。 \<portnumber></span><span class="sxs-lookup"><span data-stu-id="022ad-229">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the port number in this format: \<servername>:\<portnumber>.</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="022ad-230">Netsh AdvFirewall 構文</span><span class="sxs-lookup"><span data-stu-id="022ad-230">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="022ad-231">次のコマンドにより、SQL Server Browser サービス用の TCP 2382 のブロックを解除する受信の規則と、Analysis Services インスタンス用に指定された固定ポートのブロックを解除する受信の規則が作成されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-231">The following commands create inbound rules that unblock TCP 2382 for SQL Server Browser service and unblock the fixed port that you specified for the Analysis Services instance.</span></span> <span data-ttu-id="022ad-232">これらのうちのいずれかを実行すると Analysis Services の名前付きインスタンスにアクセスできるようにできます。</span><span class="sxs-lookup"><span data-stu-id="022ad-232">You can run either one to allow access to a named Analysis Services instance.</span></span>  
  
     <span data-ttu-id="022ad-233">このサンプル コマンドの場合、ポート 54321 が固定ポートです。</span><span class="sxs-lookup"><span data-stu-id="022ad-233">In this sample command, port 54321 is the fixed port.</span></span> <span data-ttu-id="022ad-234">実際のシステムで使用する場合、このポートを実際のポート番号に置き換えてください。</span><span class="sxs-lookup"><span data-stu-id="022ad-234">Be sure to replace it with the actual port in use on your system.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services (tcp-in) on 54321" dir=in action=allow protocol=TCP localport=54321 profile=domain  
    ```  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Browser Services inbound on TCP 2382" dir=in action=allow protocol=TCP localport=2382 profile=domain  
    ```  
  
##  <a name="use-a-fixed-port-for-a-default-or-named-instance-of-analysis-services"></a><a name="bkmk_fixed"></a><span data-ttu-id="022ad-235">の既定のインスタンスまたは名前付きインスタンスに固定ポートを使用 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="022ad-235">Use a fixed port for a default or named instance of Analysis Services</span></span>  
 <span data-ttu-id="022ad-236">ここでは、固定ポートをリッスンするように Analysis Services を構成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="022ad-236">This section explains how to configure Analysis Services to listen on a fixed port.</span></span> <span data-ttu-id="022ad-237">Analysis Services を名前付きインスタンスとしてインストールしている場合、一般的に固定ポートが使用されます。ただし、ビジネス要件またはセキュリティ要件によって既定でないポート割り当てを使用するように指定されている場合、このアプローチを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="022ad-237">Using a fixed port is common if you installed Analysis Services as a named instance, but you can also use this approach if business or security requirements specify that you use non-default port assignments.</span></span>  
  
 <span data-ttu-id="022ad-238">固定ポートを使用すると、サーバー名にポート番号を付加する必要があるため、既定のインスタンス用の接続構文が変わることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-238">Note that using a fixed port will alter the connection syntax for the default instance by requiring you to append the port number to the server name.</span></span> <span data-ttu-id="022ad-239">たとえば、SQL Server Management Studio で、ポート 54321 をリッスンしている Analysis Services のローカルな既定のインスタンスに接続するには、Management Studio の [サーバーへの接続] ダイアログ ボックスにサーバー名として「localhost:54321」と入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-239">For example, connecting to a local, default Analysis Services instance listening on port 54321 in SQL Server Management Studio would require that you type localhost:54321 as the server name in the Connect to Server dialog box in Management Studio.</span></span>  
  
 <span data-ttu-id="022ad-240">名前付きインスタンスを使用している場合は、固定ポートを割り当てて、サーバー名の指定方法を変更することはできません (具体的には、を使用して、 \<servername\instancename> 固定ポートでリッスンしている名前付きインスタンスに接続できます)。</span><span class="sxs-lookup"><span data-stu-id="022ad-240">If you are using a named instance, you can assign a fixed port with no changes to how you specify the server name (specifically, you can use \<servername\instancename> to connect to a named instance listening on a fixed port).</span></span> <span data-ttu-id="022ad-241">このアプローチは、SQL Server Browser サービスが実行されており、サービスがリッスンしているポートのブロックが解除されている場合のみに使用できます。</span><span class="sxs-lookup"><span data-stu-id="022ad-241">This works only if SQL Server Browser service is running and you unblocked the port on which it is listening.</span></span> <span data-ttu-id="022ad-242">SQL Server Browser サービスは、に基づいて固定ポートへのリダイレクトを提供 \<servername\instancename> します。</span><span class="sxs-lookup"><span data-stu-id="022ad-242">SQL Server Browser service will provide redirection to the fixed port based on \<servername\instancename>.</span></span> <span data-ttu-id="022ad-243">SQL Server Browser サービスと、固定ポートをリッスンする Analysis Services の名前付きインスタンスの両方に対してポートを開いている限り、SQL Server Browser サービスによって名前付きインスタンスへの接続が解決されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-243">As long as you open ports for both SQL Server Browser service and the named instance of Analysis Services listening on the fixed port, SQL Server Browser service will resolve the connection to a named instance.</span></span>  
  
1.  <span data-ttu-id="022ad-244">使用可能な TCP/IP ポートから、使用するポートを決定します。</span><span class="sxs-lookup"><span data-stu-id="022ad-244">Determine an available TCP/IP port to use.</span></span>  
  
     <span data-ttu-id="022ad-245">使用が禁止されている予約済みポートと登録済みポートの一覧については、IANA の「 [Port Numbers](https://go.microsoft.com/fwlink/?LinkID=198469)」 (ポート番号) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-245">To view a list of reserved and registered ports that you should avoid using, see [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span></span> <span data-ttu-id="022ad-246">システムで既に使用されているポートを確認するには、コマンド プロンプト ウィンドウを開き、「`netstat -a -p TCP`」と入力すると、システム内で開かれている TCP ポートの一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-246">To view a list of ports that are already in use on your system, open a command prompt window and type `netstat -a -p TCP` to display a list of the TCP ports that are open on the system.</span></span>  
  
2.  <span data-ttu-id="022ad-247">使用するポートを決定した後、msmdsrv.ini ファイルまたは SQL Server Management Studio の Analysis Services インスタンスの [全般プロパティ] ページで、`Port` 構成設定を編集して、ポートを指定します。</span><span class="sxs-lookup"><span data-stu-id="022ad-247">After you determine which port to use, specify the port by either editing the `Port` configuration setting in the msmdsrv.ini file or in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span>  
  
3.  <span data-ttu-id="022ad-248">サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="022ad-248">Restart the service.</span></span>  
  
4.  <span data-ttu-id="022ad-249">Windows ファイアウォールを構成して、指定した TCP ポートのブロックを解除します。</span><span class="sxs-lookup"><span data-stu-id="022ad-249">Configure Windows Firewall to unblock the TCP port you specified.</span></span> <span data-ttu-id="022ad-250">名前付きインスタンスに固定ポートを使用する場合は、そのインスタンスに指定した TCP ポートと、SQL Server Browser サービスで使用される TCP ポート 2382 の両方のブロックを解除します。</span><span class="sxs-lookup"><span data-stu-id="022ad-250">Or, if you are using a fixed port for a named instance, unblock both the TCP port you specified for that instance and TCP port 2382 for SQL Server Browser service.</span></span>  
  
5.  <span data-ttu-id="022ad-251">接続を検証します。それには、Management Studio を使用してローカルで接続した後、別のコンピューターのクライアント アプリケーションからリモートで接続します。</span><span class="sxs-lookup"><span data-stu-id="022ad-251">Verify by connecting locally (in Management Studio) and then remotely from a client application on another computer.</span></span> <span data-ttu-id="022ad-252">Management Studio を使用するには、という形式でサーバー名を指定して、Analysis Services の既定のインスタンスに \<servername> 接続します \<portnumber> 。</span><span class="sxs-lookup"><span data-stu-id="022ad-252">To use Management Studio, connect to an Analysis Services default instance by specifying a server name in this format: \<servername>:\<portnumber>.</span></span> <span data-ttu-id="022ad-253">名前付きインスタンスの場合は、サーバー名を<instancename として指定し \<servername> \\ \> ます。</span><span class="sxs-lookup"><span data-stu-id="022ad-253">For a named instance, specify the server name as \<servername>\\<instancename\>.</span></span>  
  
##  <a name="port-configuration-for-an-analysis-services-cluster"></a><a name="bkmk_cluster"></a><span data-ttu-id="022ad-254">Analysis Services クラスターのポート構成</span><span class="sxs-lookup"><span data-stu-id="022ad-254">Port configuration for an Analysis Services cluster</span></span>  
 <span data-ttu-id="022ad-255">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] フェールオーバー クラスターは、既定のインスタンスまたは名前付きインスタンスとしてインストールされているかどうかにかかわらず、常に TCP ポート 2383 でリッスンします。</span><span class="sxs-lookup"><span data-stu-id="022ad-255">An [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster always listens on TCP port 2383, regardless of whether you installed it as a default instance or named instance.</span></span> <span data-ttu-id="022ad-256">動的なポート割り当ては、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] では使用されません (Windows フェールオーバー クラスターにインストールされている場合)。</span><span class="sxs-lookup"><span data-stu-id="022ad-256">Dynamic port assignments are not used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] when it is installed on a Windows failover cluster.</span></span> <span data-ttu-id="022ad-257">クラスターで [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] を実行しているすべてノードの TCP 2383 を開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-257">Be sure to open TCP 2383 on every node running [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the cluster.</span></span> <span data-ttu-id="022ad-258">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]のクラスター化の詳細については、「 [SQL Server Analysis Services をクラスター化する方法](https://go.microsoft.com/fwlink/p/?LinkId=396548)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="022ad-258">For more information about clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span></span>  
  
##  <a name="port-configuration-for-powerpivot-for-sharepoint"></a><a name="bkmk_powerpivot"></a><span data-ttu-id="022ad-259">PowerPivot for SharePoint のポート構成</span><span class="sxs-lookup"><span data-stu-id="022ad-259">Port configuration for PowerPivot for SharePoint</span></span>  
 <span data-ttu-id="022ad-260">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] に対応するサーバー アーキテクチャは、使用する SharePoint のバージョンによって大きく異なります。</span><span class="sxs-lookup"><span data-stu-id="022ad-260">Server architecture for [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is fundamentally different depending on which version of SharePoint you are using.</span></span>  
  
 <span data-ttu-id="022ad-261">**SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="022ad-261">**SharePoint 2013**</span></span>  
  
 <span data-ttu-id="022ad-262">SharePoint 2013 では、Excel Services が Power Pivot データ モデルに対する要求をリダイレクトし、ついでその要求は、SharePoint 環境外にある [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="022ad-262">In SharePoint 2013, Excel Services redirects requests for Power Pivot data models, which are subsequently loaded on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance outside of the SharePoint environment.</span></span> <span data-ttu-id="022ad-263">接続は一般的なパターンに従い、ローカル コンピューター上にある Analysis Services クライアント ライブラリが、同じネットワーク上にあるリモートの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスに接続要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="022ad-263">Connections follow the typical pattern, where an Analysis Services client library on a local computer sends a connection request to a remote [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in the same network.</span></span>  
  
 <span data-ttu-id="022ad-264">[!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] によって [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] が必ず名前付きインスタンスとしてインストールされるため、SQL Server Browser サービスと動的ポートの割り当てを想定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="022ad-264">Because [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] always installs [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] as a named instance, you should assume SQL Server Browser service and dynamic port assignments.</span></span> <span data-ttu-id="022ad-265">既に説明したように、SQL Server Browser サービスは、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] の名前付きインスタンス宛てに送信される接続要求を TCP ポート 2382 でリッスンし、その要求を現在のポートにリダイレクトします。</span><span class="sxs-lookup"><span data-stu-id="022ad-265">As noted earlier, SQL Server Browser service listens on TCP port 2382 for connection requests sent to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, redirecting the request to the current port.</span></span>  
  
 <span data-ttu-id="022ad-266">SharePoint 2013 内の Excel Services が、固定ポートを使用した接続構文をサポートしないことに注意して、SQL Server Browser サービスがアクセス可能になるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="022ad-266">Note that Excel Services in SharePoint 2013 does not support the fixed port connection syntax, so make sure SQL Server Browser service is accessible.</span></span>  
  
 <span data-ttu-id="022ad-267">**SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="022ad-267">**SharePoint 2010**</span></span>  
  
 <span data-ttu-id="022ad-268">SharePoint 2010 を使用している場合は、Windows ファイアウォールのポートを開く必要はありません。</span><span class="sxs-lookup"><span data-stu-id="022ad-268">If you are using SharePoint 2010, you do not need to open ports in Windows Firewall.</span></span> <span data-ttu-id="022ad-269">SharePoint は、自らが必要としているポートを開き、また PowerPivot for SharePoint のようなアドインは SharePoint 環境内で動作します。</span><span class="sxs-lookup"><span data-stu-id="022ad-269">SharePoint opens the ports that it requires, and add-ins such as PowerPivot for SharePoint operate within the SharePoint environment.</span></span> <span data-ttu-id="022ad-270">PowerPivot for SharePoint 2010 のインストールでは、PowerPivot System サービスによって、同じコンピューターにインストールされているローカルの SQL Server Analysis Services (PowerPivot) サービス インスタンスが排他的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="022ad-270">In a PowerPivot for SharePoint 2010 installation, the PowerPivot System Service has exclusive use of the local SQL Server Analysis Services (PowerPivot) service instance that is installed with it on the same computer.</span></span> <span data-ttu-id="022ad-271">ローカルの Analysis Services エンジン サービスへのアクセスには、ネットワーク接続ではなくローカル接続が使用されます。このサービスは、SharePoint サーバー上の PowerPivot データの読み込み、クエリ、および処理を行います。</span><span class="sxs-lookup"><span data-stu-id="022ad-271">It uses local connections, not network connections, to access the local Analysis Services engine service that loads, queries, and processes PowerPivot data on the SharePoint server.</span></span> <span data-ttu-id="022ad-272">クライアントアプリケーションから PowerPivot データを要求するには、SharePoint セットアップによって開かれたポートを介して要求がルーティングされます (具体的には、SharePoint-80、SharePoint サーバーの全体管理 v4、SharePoint Web サービス、および SPUserCodeV4 へのアクセスを許可するために、受信の規則が定義されています)。</span><span class="sxs-lookup"><span data-stu-id="022ad-272">To request PowerPivot data from client applications, requests are routed through ports that are opened by SharePoint Setup (specifically, inbound rules are defined to allow access to SharePoint - 80, SharePoint Central Administration v4, SharePoint Web Services, and SPUserCodeV4).</span></span> <span data-ttu-id="022ad-273">PowerPivot Web サービスは SharePoint ファーム内で実行されるため、SharePoint ファーム内の PowerPivot データへのリモート アクセスには SharePoint のファイアウォール規則で十分です。</span><span class="sxs-lookup"><span data-stu-id="022ad-273">Because PowerPivot web services run within a SharePoint farm, the SharePoint firewall rules are sufficient for remote access to PowerPivot data in a SharePoint farm.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="022ad-274">参照</span><span class="sxs-lookup"><span data-stu-id="022ad-274">See Also</span></span>  
 <span data-ttu-id="022ad-275">[SQL Server Browser サービス &#40;データベースエンジンおよび SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="022ad-275">[SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span></span>  
 <span data-ttu-id="022ad-276">[データベース エンジン、SQL Server エージェント、SQL Server Browser サービスの開始、停止、一時停止、再開、および再起動](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span><span class="sxs-lookup"><span data-stu-id="022ad-276">[Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span></span>  
 [<span data-ttu-id="022ad-277">データベース エンジン アクセスを有効にするための Windows ファイアウォールを構成する</span><span class="sxs-lookup"><span data-stu-id="022ad-277">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
  
