---
title: ブックのアップグレードと定期データ更新 (SharePoint 2013) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: a49c4af4-e243-4926-be97-74da1f9d54eb
author: minewiskan
ms.author: owend
ms.openlocfilehash: 185fe0864bc4c1cdda9a63fa97a17319d65dc87d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713594"
---
# <a name="upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013"></a><span data-ttu-id="f3f6a-102">ブックのアップグレードと定期データ更新 (SharePoint 2013)</span><span class="sxs-lookup"><span data-stu-id="f3f6a-102">Upgrade Workbooks and Scheduled Data Refresh (SharePoint 2013)</span></span>
  <span data-ttu-id="f3f6a-103">このトピックでは、以前の PowerPivot 環境で作成されたブックのユーザー エクスペリエンスについて、およびこのリリースで導入された新機能を利用できるよう、PowerPivot ブックをアップグレードする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-103">This topic explains the user experience of workbooks created in previous PowerPivot environments and how to upgrade PowerPivot workbooks so that you can take advantage of new features introduced in this release.</span></span> <span data-ttu-id="f3f6a-104">新機能の詳細については、「 [PowerPivot の新](https://go.microsoft.com/fwlink/?LinkID=203917)機能」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-104">To learn more about new features, see [What's New in PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="f3f6a-105">サーバーで自動的にアップグレードされるブックのアップグレードをロールバックすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-105">You cannot rollback upgrade for workbooks that are upgraded automatically on the server.</span></span> <span data-ttu-id="f3f6a-106">ブックのアップグレードが完了すると、アップグレードされた状態のままになります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-106">Once a workbook is upgraded, it remains upgraded.</span></span> <span data-ttu-id="f3f6a-107">以前のバージョンを使用するには、以前のブックを SharePoint に再パブリッシュするか、以前のバージョンを復元するか、ブックを再利用します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-107">To use a previous version, you can republish the previous workbook to SharePoint, restore a previous version, or recycle the workbook.</span></span> <span data-ttu-id="f3f6a-108">SharePoint でのドキュメントの復元または再利用の詳細については、「 [ごみ箱とバージョン管理を使用したコンテンツ保護を計画する](https://go.microsoft.com/fwlink/?LinkId=238669)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-108">For more information about restoring or recycling a document in SharePoint, see [Plan to protect content by using recycle bins and versioning](https://go.microsoft.com/fwlink/?LinkId=238669).</span></span>  
  
 <span data-ttu-id="f3f6a-109">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-109">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="f3f6a-110">ブックのアップグレードの概要</span><span class="sxs-lookup"><span data-stu-id="f3f6a-110">Overview of Upgrading Workbooks</span></span>](#bkmk_overview)  
  
-   [<span data-ttu-id="f3f6a-111">2008 R2 ブックから SQL Server 2012 Service Pack 1 (SP1) ブックへのアップグレード</span><span class="sxs-lookup"><span data-stu-id="f3f6a-111">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>](#bkmk_to_2012sp1_from_2008r2)  
  
-   [<span data-ttu-id="f3f6a-112">SQL Server 2012 の PowerPivot for Excel アドインで作成したブックから Office 2013 ブックへのアップグレード</span><span class="sxs-lookup"><span data-stu-id="f3f6a-112">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>](#bkmk_to_2012sp1_from_2012)  
  
-   [<span data-ttu-id="f3f6a-113">SQL Server 2008 R2 の PowerPivot for Excel アドインで作成したブックから SQL Server 2012 ブックへのアップグレード</span><span class="sxs-lookup"><span data-stu-id="f3f6a-113">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>](#bkmk_to_2012_from_2008R2)  
  
-   [<span data-ttu-id="f3f6a-114">新しいサーバーでの複数バージョンのブックの実行</span><span class="sxs-lookup"><span data-stu-id="f3f6a-114">Running Multiple Workbook Versions on a Newer Server</span></span>](#bkmk_runold)  
  
##  <a name="overview-of-upgrading-workbooks"></a><a name="bkmk_overview"></a><span data-ttu-id="f3f6a-115">ブックのアップグレードの概要</span><span class="sxs-lookup"><span data-stu-id="f3f6a-115">Overview of Upgrading Workbooks</span></span>  
 <span data-ttu-id="f3f6a-116">PowerPivot ブックは、PowerPivot データが埋め込まれた Excel ブックです。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-116">A PowerPivot workbook is an Excel workbook that contains embedded PowerPivot data.</span></span> <span data-ttu-id="f3f6a-117">ブックのアップグレードには、次の 2 つの利点があります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-117">Upgrading a workbook has two benefits:</span></span>  
  
-   <span data-ttu-id="f3f6a-118">[!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)]の新機能を使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-118">Use new features in [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span></span>  
  
-   <span data-ttu-id="f3f6a-119">SharePoint モードの [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services サーバーで実行されるブックの定期データ更新を有効にできます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-119">Enables scheduled data refresh for workbooks that run with a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services server in SharePoint mode.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="f3f6a-120">アップグレードしたブックはロールバックできないため、以前のバージョンの [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)]や [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)]でそのブックを使用することがある場合は、必ずコピーを作成しておいてください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-120">You cannot rollback an upgraded workbook, so be sure to make a copy of the file if you want to use it in the previous version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], or on a previous version of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="f3f6a-121">次の表に、ブックが作成された環境に基づく PowerPivot ブックのサポートおよび動作を示します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-121">The following table lists the support and behavior of PowerPivot workbooks based on the environment  in which the workbook was created.</span></span> <span data-ttu-id="f3f6a-122">この表では、一般的なユーザー エクスペリエンス、特定の環境にブックをアップグレードするときにサポートされるアップグレード オプション、およびアップグレードしていないブックの定期データ更新の動作について説明しています。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-122">The behavior described includes the general user experience, the supported upgrade options to upgrade the workbook to the particular environment, and the behavior of scheduled data refresh of a workbook that has not yet been upgraded.</span></span>  
  
### <a name="workbook-behavior-and-upgrade-options"></a><span data-ttu-id="f3f6a-123">ブックの動作とアップグレード オプション</span><span class="sxs-lookup"><span data-stu-id="f3f6a-123">Workbook Behavior and Upgrade Options</span></span>  
  
|<span data-ttu-id="f3f6a-124">作成</span><span class="sxs-lookup"><span data-stu-id="f3f6a-124">Created In</span></span>|\<|<span data-ttu-id="f3f6a-125">サポートおよび動作</span><span class="sxs-lookup"><span data-stu-id="f3f6a-125">Support and Behavior</span></span>|>|  
|----------------|--------|--------------------------|--------|  
||<span data-ttu-id="f3f6a-126">**SQL Server 2008 R2 の PowerPivot for SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-126">**2008 R2 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="f3f6a-127">**SQL Server 2012 の PowerPivot for SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-127">**2012 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="f3f6a-128">**SQL Server 2012 SP1 の PowerPivot for SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-128">**2012 SP1 PowerPivot for SharePoint 2013**</span></span>|  
|<span data-ttu-id="f3f6a-129">**2008 R2 PowerPivot for Excel 2010**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-129">**2008 R2 PowerPivot for Excel 2010**</span></span>|<span data-ttu-id="f3f6a-130">すべての機能</span><span class="sxs-lookup"><span data-stu-id="f3f6a-130">All Features</span></span>|<span data-ttu-id="f3f6a-131">**エクスペリエンス:** ユーザーはブラウザーでブックを操作し、他のソリューションのデータ ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-131">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="f3f6a-132">**アップグレード:** SharePoint ファームの PowerPivot System サービスで自動アップグレードが有効になっている場合、ドキュメント ライブラリのブックが自動アップグレードされます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-132">**Upgrade:** Workbooks will auto upgrade in the document library if Auto Upgrade is enabled for the PowerPivot system Service in the SharePoint farm,</span></span><br /><br /> <span data-ttu-id="f3f6a-133">**定期データ更新:** サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-133">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="f3f6a-134">ブックをアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-134">Workbook needs to be upgraded.</span></span>|<span data-ttu-id="f3f6a-135">**エクスペリエンス:** ユーザーはブックを操作し、他のソリューションのデータ ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-135">**Experience:** Users can interact with the workbook and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="f3f6a-136">**アップグレード:** 自動アップグレードは使用できません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-136">**Upgrade:** Auto upgrade is not available.</span></span> <span data-ttu-id="f3f6a-137">SQL Server 2008 R2 ブックを、2012 バージョンまたは Office 2013 バージョンに手動でアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-137">Users must manually upgrade their 2008 R2 workbooks to the 2012 version or to the office 2013 version.</span></span><br /><br /> <span data-ttu-id="f3f6a-138">**定期データ更新:** サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-138">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="f3f6a-139">ブックをアップグレードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-139">Workbook needs to be upgraded.</span></span>|  
|<span data-ttu-id="f3f6a-140">**2012 PowerPivot for Excel**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-140">**2012 PowerPivot for Excel**</span></span>|<span data-ttu-id="f3f6a-141">サポートされていません</span><span class="sxs-lookup"><span data-stu-id="f3f6a-141">Not supported</span></span>|<span data-ttu-id="f3f6a-142">すべての機能</span><span class="sxs-lookup"><span data-stu-id="f3f6a-142">All Features</span></span>|<span data-ttu-id="f3f6a-143">**エクスペリエンス:** ユーザーはブラウザーでブックを操作し、他のソリューションのデータ ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-143">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span> <span data-ttu-id="f3f6a-144">定期データ更新を使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-144">Schedule data refresh is available.</span></span><br /><br /> <span data-ttu-id="f3f6a-145">**アップグレード:** 自動アップグレードはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-145">**Upgrade:** Auto upgrade is not supported.</span></span> <span data-ttu-id="f3f6a-146">手動でブックを Office 2013 バージョンにアップグレードできます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-146">Users can manually upgrade their workbooks to the Office 2013 version.</span></span><br /><br /> <span data-ttu-id="f3f6a-147">**定期データ更新:** サポートされています。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-147">**Schedule data refresh:** supported.</span></span>|  
|<span data-ttu-id="f3f6a-148">**Excel 2013**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-148">**Excel 2013**</span></span>|<span data-ttu-id="f3f6a-149">サポートされていません</span><span class="sxs-lookup"><span data-stu-id="f3f6a-149">Not supported</span></span>|<span data-ttu-id="f3f6a-150">サポートされていません</span><span class="sxs-lookup"><span data-stu-id="f3f6a-150">Not supported</span></span>|<span data-ttu-id="f3f6a-151">すべての機能</span><span class="sxs-lookup"><span data-stu-id="f3f6a-151">All Features</span></span>|  
  
##  <a name="upgrade-to-sql-server-2012-service-pack-1-sp1-workbooks-from-2008-r2-workbooks"></a><a name="bkmk_to_2012sp1_from_2008r2"></a> <span data-ttu-id="f3f6a-152">SQL Server 2008 R2 ブックから SQL Server 2012 Service Pack 1 (SP1) ブックへのアップグレード</span><span class="sxs-lookup"><span data-stu-id="f3f6a-152">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>  
 <span data-ttu-id="f3f6a-153">ここでは、SQL Server 2008 R2 の PowerPivot for Excel 2010 ブックから、SQL Server 2012 SP1 の PowerPivot for Excel 2013 ブックへアップグレードする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-153">This section describes upgrading to SQL Server 2012 SP1 PowerPivot for Excel 2013 workbooks from SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="f3f6a-154">**動作変更:** SQL Server 2008 R2 の PowerPivot ブックを SQL Server 2012 SP1 の PowerPivot for SharePoint 2013 で使用するときに、ブックは自動的にはアップグレードされません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-154">**Behavior Change:** SQL Server 2008 R2 PowerPivot workbooks will not be automatically upgraded  when they are used in SQL Server 2012 SP1 PowerPivot for SharePoint 2013.</span></span> <span data-ttu-id="f3f6a-155">そのため、SQL Server 2008 R2 の PowerPivot ブックの定期データ更新は機能しません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-155">Therefore, scheduled data refreshes will not work for SQL Server 2008 R2 PowerPivot workbooks</span></span>  
  
 <span data-ttu-id="f3f6a-156">2008 R2 ブックは、PowerPivot for SharePoint 2013 で開きますが、定期データ更新は機能しません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-156">2008 R2 workbooks will open in PowerPivot for SharePoint 2013, however scheduled data refreshes will not work.</span></span> <span data-ttu-id="f3f6a-157">更新履歴を確認すると、次のようなエラー メッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-157">If you review the refresh history you will see an error message similar to the following:</span></span>  
  
 <span data-ttu-id="f3f6a-158">"ブックにサポートされていない PowerPivot モデルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-158">"The workbook contains an unsupported PowerPivot model.</span></span> <span data-ttu-id="f3f6a-159">ブックの PowerPivot モデルは、SQL Server 2008 R2 PowerPivot for Excel 2010 形式です。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-159">The PowerPivot model in the workbook is in the SQL Server 2008 R2 PowerPivot for Excel 2010 format.</span></span> <span data-ttu-id="f3f6a-160">サポートされている PowerPivot モデルは、</span><span class="sxs-lookup"><span data-stu-id="f3f6a-160">Supported PowerPivot models are the following:</span></span>  
  
-   <span data-ttu-id="f3f6a-161">SQL Server 2012 PowerPivot for Excel 2010</span><span class="sxs-lookup"><span data-stu-id="f3f6a-161">SQL Server 2012 PowerPivot for Excel 2010.</span></span>  
  
-   <span data-ttu-id="f3f6a-162">または SQL Server 2012 PowerPivot for Excel 2013 です。」</span><span class="sxs-lookup"><span data-stu-id="f3f6a-162">SQL Server 2012 PowerPivot for Excel 2013.</span></span>  
  
 <span data-ttu-id="f3f6a-163">**ブックをアップグレードする方法:** 定期データ更新は、ブックを 2012 ブックにアップグレードするまで機能しません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-163">**How to upgrade a workbook:** The Scheduled data refresh will not work until you upgrade the workbook to a 2012 workbook.</span></span> <span data-ttu-id="f3f6a-164">ブックとブックに含まれるモデルをアップグレードするには、次のいずれかの手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-164">To upgrade the workbook and model it contains, complete one of the following:</span></span>  
  
-   <span data-ttu-id="f3f6a-165">SQL Server 2012 PowerPivot for Excel アドインがインストールされた Microsoft Excel 2010 でブックをダウンロードして開きます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-165">Download and open the workbook in Microsoft Excel 2010 with the SQL Server 2012 PowerPivot for Excel add-in installed.</span></span>  
  
     <span data-ttu-id="f3f6a-166">PowerPivot ウィンドウを開き、PowerPivot モデルをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-166">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="f3f6a-167">ブックを保存して、SharePoint に再発行します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-167">Then save the workbook and republish it to SharePoint.</span></span>  
  
-   <span data-ttu-id="f3f6a-168">Microsoft Excel 2013 でブックをダウンロードして開きます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-168">Download and open the workbook in Microsoft Excel 2013.</span></span>  
  
     <span data-ttu-id="f3f6a-169">PowerPivot ウィンドウを開き、PowerPivot モデルをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-169">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="f3f6a-170">ブックを保存して、SharePoint サーバーに再発行します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-170">Then save the workbook and republish it to the SharePoint server.</span></span>  
  
 <span data-ttu-id="f3f6a-171">Analysis Services 機能の変更点の詳細については、「 [SQL Server 2014 の Analysis Services 機能に対する動作の変更](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-171">For more information on Changes to Analysis Services features, see [Behavior Changes to Analysis Services Features in SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)</span></span>  
  
 <span data-ttu-id="f3f6a-172">更新履歴の詳細については、「[データ更新履歴の表示 &#40;PowerPivot for SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-172">For more information on refresh history, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>  
  
##  <a name="upgrade-to-office-2013-workbooks-from-versions-created-by-using-the-2012-powerpivot-add-in-for-excel"></a><a name="bkmk_to_2012sp1_from_2012"></a><span data-ttu-id="f3f6a-173">Excel 用の 2012 PowerPivot アドインを使用して作成されたバージョンから Office 2013 ブックにアップグレードする</span><span class="sxs-lookup"><span data-stu-id="f3f6a-173">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>  
 <span data-ttu-id="f3f6a-174">このセクションで**は、** SQL Server 2012 Powerpivot for excel 2010 ブック**から**SQL Server 2012 SP1 PowerPivot In excel 2013 にアップグレードする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-174">This section describes Upgrading **to** SQL Server 2012 SP1 PowerPivot in Excel 2013 **from** SQL Server 2012 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="f3f6a-175">ブックをアップグレードすると、以前のバージョンのブックで定期データ更新を試みると発生する、次のエラーが解決されます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-175">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="f3f6a-176">"以前のバージョンの PowerPivot で作成されたブックの更新操作は使用できません。"</span><span class="sxs-lookup"><span data-stu-id="f3f6a-176">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="f3f6a-177">**ブックをアップグレードする方法**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-177">**How to upgrade a workbook**</span></span>  
  
1.  <span data-ttu-id="f3f6a-178">各ブックを Microsoft Excel 2013 で開き、手動でアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-178">Upgrade each workbook manually by opening it in Microsoft Excel 2013.</span></span>  
  
2.  <span data-ttu-id="f3f6a-179">ブックとそれに含まれるモデルをアップグレードするには、Microsoft Excel 2013 でブックをダウンロードして開きます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-179">To upgrade the workbook and model it contains, download and open the workbook in Microsoft Excel 2013.</span></span>  
  
3.  <span data-ttu-id="f3f6a-180">PowerPivot ウィンドウを開き、PowerPivot モデルをアップグレードします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-180">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
4.  <span data-ttu-id="f3f6a-181">ブックを保存して、SharePoint 2013 サーバーに再発行します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-181">Then save the workbook and republish it to the SharePoint 2013 server.</span></span>  
  
##  <a name="upgrade-to-sql-server-2012-workbooks-from-versions-created-by-using-the-2008-r2-powerpivot-add-in-for-excel-2010"></a><a name="bkmk_to_2012_from_2008R2"></a><span data-ttu-id="f3f6a-182">Excel 2010 用 2008 R2 PowerPivot アドインを使用して作成されたバージョンから SQL Server 2012 ブックにアップグレードする</span><span class="sxs-lookup"><span data-stu-id="f3f6a-182">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>  
 <span data-ttu-id="f3f6a-183">このセクションでは **、** SQL Server 2008 R2 Powerpivot for excel 2010 ブックから SQL Server 2012 Powerpivot for excel 2010 へ**の**アップグレードについて説明します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-183">This section describes Upgrading **to** SQL Server 2012 PowerPivot for Excel 2010 **from** SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="f3f6a-184">ブックをアップグレードすると、以前のバージョンのブックで定期データ更新を試みると発生する、次のエラーが解決されます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-184">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="f3f6a-185">"以前のバージョンの PowerPivot で作成されたブックの更新操作は使用できません。"</span><span class="sxs-lookup"><span data-stu-id="f3f6a-185">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="f3f6a-186">**ブックをアップグレードする方法**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-186">**How to upgrade a workbook**</span></span>  
  
 <span data-ttu-id="f3f6a-187">アップグレードには 2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-187">There are two ways to upgrade:</span></span>  
  
1.  <span data-ttu-id="f3f6a-188">[!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] バージョンの PowerPivot for Excel がインストールされているコンピューターの Excel でブックを開いて各ブックを手動でアップグレードし、サーバーにブックを再発行します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-188">Upgrade each workbook manually by opening it in Excel on a computer that has the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of PowerPivot for Excel, and then republish it to the server.</span></span> <span data-ttu-id="f3f6a-189">新しいバージョンのアドインでブックを開くと、内部でいくつかの処理が行われます。具体的には、ブックのデータ接続文字列でデータ プロバイダーが MSOLAP.5 に更新され、メタデータが更新され、新しい実装に対応するためにリレーションシップが再作成されます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-189">When you open the workbook in the newer version of the add-in, the following internal operations occur: the data provider in the workbook data connection string is updated to MSOLAP.5, metadata is updated, and relationships are recreated to conform to a newer implementation.</span></span>  
  
2.  <span data-ttu-id="f3f6a-190">もう 1 つの方法では、SharePoint 管理者が SharePoint ファームの PowerPivot System サービスの自動アップグレード機能を有効にして、定期データ更新が実行されると [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot ブックが自動的にアップグレードされるようにできます (定期データ更新用に構成されているブックのみがアップグレードされます)。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-190">Alternatively, a SharePoint Administrator  can enable the auto-upgrade feature for the PowerPivot System Service in a SharePoint farm to  automatically upgrade a [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot workbook when schedule data refresh runs (only workbooks that are configured for scheduled data refresh are upgraded).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="f3f6a-191">自動アップグレードは、サーバー構成機能です。特定のブック、ライブラリ、またはサイト コレクションについては有効または無効にできません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-191">Automatic upgrade is a server configuration feature; you cannot enable or disable it for specific workbooks, libraries, or site collections.</span></span>  
  
 <span data-ttu-id="f3f6a-192">**データ更新中に自動アップグレードを構成する方法**</span><span class="sxs-lookup"><span data-stu-id="f3f6a-192">**How to configure automatic upgrade during data refresh**</span></span>  
  
 <span data-ttu-id="f3f6a-193">自動アップグレードを使用するには、PowerPivot 構成ツールで **[PowerPivot ブックを自動的にアップグレードして、サーバーからのデータ更新を有効にする]** チェック ボックスをオンにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-193">To use automatic upgrade, you must select the **Automatically upgrade PowerPivot workbooks to enable data refresh from the server** checkbox in the PowerPivot Configuration Tool.</span></span> <span data-ttu-id="f3f6a-194">ツールでこのチェック ボックスがあるのは、 **[PowerPivot System サービスのアップグレード]** ページおよび新しいインストールを構成している場合の **[PowerPivot サービス アプリケーションの作成]** ページです。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-194">Within the tool, the checkbox is on the **Upgrade PowerPivot System Service** page, and on the **Create PowerPivot Service Application** page if you are configuring a new installation.</span></span>  
  
 <span data-ttu-id="f3f6a-195">次のコマンドレットを実行して、自動アップグレードが有効かどうかを確認できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-195">You can run the following cmdlet to verify whether automatic upgrade is enabled:</span></span>  
  
```  
PS C:\Windows\system32> Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="f3f6a-196">Get-PowerPivotSystemService からの出力は、プロパティとそれに対応する値のリストです。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-196">The output from Get-PowerPivotSystemService is a list of properties and corresponding values.</span></span> <span data-ttu-id="f3f6a-197">プロパティ リストの `WorkbookUpgradeOnDataRefresh` を確認してください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-197">You should see `WorkbookUpgradeOnDataRefresh` in the property list.</span></span> <span data-ttu-id="f3f6a-198">自動アップグレードが有効になっている場合、値は **true** に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-198">It will be set to **true** if automatic upgrade is enabled.</span></span> <span data-ttu-id="f3f6a-199">**false**の場合は、次の手順を続行し、ブックの自動アップグレードを有効にします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-199">If it is **false**, continue to the next step, enabling automatic workbook upgrade.</span></span>  
  
 <span data-ttu-id="f3f6a-200">ブックの自動アップグレードを有効にするには、次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-200">To enable automatic workbook upgrade, run the following command:</span></span>  
  
```  
PS C:\Windows\system32> Set-PowerPivotSystemService -WorkbookUpgradeOnDataRefresh:$true -Confirm:$false  
```  
  
 <span data-ttu-id="f3f6a-201">アップグレードした後のブックは、定期データ更新および PowerPivot for Excel アドインの新機能を使用できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-201">After you upgrade the workbook, you can use scheduled data refresh and new features in the PowerPivot for Excel add-in.</span></span>  
  
##  <a name="running-multiple-workbook-versions-on-a-newer-server"></a><a name="bkmk_runold"></a><span data-ttu-id="f3f6a-202">新しいサーバーでの複数のブックバージョンの実行</span><span class="sxs-lookup"><span data-stu-id="f3f6a-202">Running Multiple Workbook Versions on a Newer Server</span></span>  
 <span data-ttu-id="f3f6a-203">[!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] の [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)]インスタンスでは、古いバージョンと新しいバージョンの PowerPivot ブックを同時に実行できます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-203">You can run older and newer versions of PowerPivot workbooks side by side on a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] instance of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="f3f6a-204">サーバーをインストールした方法によっては、1 つのサーバー上で古いブックと新しいブックにアクセスする前に、以前のバージョンの Analysis Services OLE DB プロバイダーのインストールが必要になる場合があります。 \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="f3f6a-204">Depending on how you installed the server, **you might need** to install a previous version of the Analysis Services OLE DB provider before you can access older and newer workbooks on the same server.</span></span>  
  
 <span data-ttu-id="f3f6a-205">以前の [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] SQL Server インスタンスでの新しいバージョンのブックの発行はできません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-205">Note that Publishing newer version workbooks on previous SQL Server instances of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] is not supported.</span></span> <span data-ttu-id="f3f6a-206">[!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] のインスタンスでは、 [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] の [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)]バージョンで作成したブックは読み込まれません。SQL Server 2012 のインスタンスでは、Excel で PowerPivot の [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] バージョンを使用して作成した高度なデータ モデルが含まれる Office 2013 ブックは読み込まれません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-206">A [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] instance will not load a workbook that you created in the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], and a SQL Server 2012 instance will not load Office 2013 workbooks with advanced data models that you created using the [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] version of PowerPivot in Excel.</span></span>  
  
###  <a name="how-to-check-for-msolap-data-provider-information-in-a-powerpivot-workbook"></a><a name="bkmk_msolapxslx"></a><span data-ttu-id="f3f6a-207">PowerPivot ブックで MSOLAP Data Provider 情報を確認する方法</span><span class="sxs-lookup"><span data-stu-id="f3f6a-207">How to Check for MSOLAP Data Provider Information in a PowerPivot Workbook</span></span>  
 <span data-ttu-id="f3f6a-208">PowerPivot ブックで使用される OLE DB プロバイダーを確認するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-208">Use the following instructions to check which OLE DB provider is used in a PowerPivot workbook.</span></span> <span data-ttu-id="f3f6a-209">データの接続情報を確認するために [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] アドインをインストールする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-209">Checking the data connection information does not require the [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] add-in to be installed.</span></span>  
  
1.  <span data-ttu-id="f3f6a-210">Excel で、[データ] タブの **[接続]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-210">In Excel, on the Data tab, click **Connections**.</span></span> <span data-ttu-id="f3f6a-211">**[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-211">Click **Properties**.</span></span>  
  
2.  <span data-ttu-id="f3f6a-212">**[定義]** タブの接続文字列の先頭にプロバイダーのバージョンが表示されます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-212">On the **Definition** tab, the provider version appears at the beginning of the connection string.</span></span>  
  
     <span data-ttu-id="f3f6a-213">**Provider=MSOLAP.5** は、ブックが [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]であることを示しています。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-213">**Provider=MSOLAP.5** indicates the workbook is [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
     <span data-ttu-id="f3f6a-214">**Provider=MSOLAP.4** は [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)]を示しています。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-214">**Provider=MSOLAP.4** indicates [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span>  
  
     <span data-ttu-id="f3f6a-215">**Data Source = $Embedded $** は、ブックが埋め込みデータベースを使用する PowerPivot ブックであることを示します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-215">**Data Source=$Embedded$** indicates that the workbook is a PowerPivot workbook, using an embedded database.</span></span>  
  
###  <a name="how-to-check-for-the-current-version-of-the-msolap-data-provider-on-a-local-computer"></a><a name="bkmk_msolappc"></a><span data-ttu-id="f3f6a-216">ローカルコンピューター上の MSOLAP Data Provider の現在のバージョンを確認する方法</span><span class="sxs-lookup"><span data-stu-id="f3f6a-216">How to Check for the Current Version of the MSOLAP Data Provider on a Local Computer</span></span>  
 <span data-ttu-id="f3f6a-217">PowerPivot ブックを実行するサーバーまたはワークステーションで最新バージョンの OLE DB プロバイダーを確認するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-217">Use the following instructions to check which OLE DB provider is the current version on the server or workstation that runs PowerPivot workbooks.</span></span> <span data-ttu-id="f3f6a-218">最新バージョンを確認しておくと、アップグレード後のデータ接続エラーのトラブルシューティングに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-218">Knowing the current version can help you troubleshoot data connection errors after upgrading.</span></span>  
  
1.  <span data-ttu-id="f3f6a-219">レジストリ エディターで、HKEY_CLASSES_ROOT に移動します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-219">In the Registry Editor, go to HKEY_CLASSES_ROOT</span></span>  
  
2.  <span data-ttu-id="f3f6a-220">MSOLAP まで下方向へスクロールします。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-220">Scroll down to MSOLAP.</span></span> <span data-ttu-id="f3f6a-221">システムにインストールされている OLAP プロバイダーの中に MSOLAP.5 が含まれていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-221">Verify that MSOLAP.5 is listed among the OLAP providers installed on the system.</span></span> <span data-ttu-id="f3f6a-222">MSOLAP | CurVer が MSOLAP.5 に設定されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f3f6a-222">Verify that MSOLAP | CurVer is set to MSOLAP.5</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f3f6a-223">参照</span><span class="sxs-lookup"><span data-stu-id="f3f6a-223">See Also</span></span>  
 <span data-ttu-id="f3f6a-224">[PowerPivot から SharePoint への移行2013](migrate-power-pivot-to-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="f3f6a-224">[Migrate PowerPivot to SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span></span>  
 <span data-ttu-id="f3f6a-225">[PowerPivot for SharePoint のアップグレード](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="f3f6a-225">[Upgrade PowerPivot for SharePoint](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span></span>  
 <span data-ttu-id="f3f6a-226">[Analysis Services とビジネスインテリジェンスの新機能](../../what-s-new-in-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="f3f6a-226">[What's New in Analysis Services and Business Intelligence](../../what-s-new-in-analysis-services.md) </span></span>  
 [<span data-ttu-id="f3f6a-227">データ更新履歴の表示 &#40;PowerPivot for SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="f3f6a-227">View Data Refresh History &#40;PowerPivot for SharePoint&#41;</span></span>](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)  
  
  
