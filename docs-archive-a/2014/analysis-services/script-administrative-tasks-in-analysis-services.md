---
title: Analysis Services | で管理タスクをスクリプト化するMicrosoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- automatic Analysis Services administration
- administering Analysis Services
ms.assetid: 106415df-81ff-4ec3-b2e1-ca66324f4cab
author: minewiskan
ms.author: owend
ms.openlocfilehash: 660f0d52d4057a9bdb9e2a0af0ed268d64a7747a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633368"
---
# <a name="script-administrative-tasks-in-analysis-services"></a><span data-ttu-id="dc1f7-102">Analysis Services の管理タスクのスクリプト作成</span><span class="sxs-lookup"><span data-stu-id="dc1f7-102">Script Administrative Tasks in Analysis Services</span></span>
  <span data-ttu-id="dc1f7-103">SQL Server エージェントで手動、またはスケジュールして実行できるスクリプトを記述または生成することで、 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 管理タスクを自動化できます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-103">You can automate [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] administrative tasks by writing or generating scripts that can be executed manually or scheduled through SQL Server Agent.</span></span> <span data-ttu-id="dc1f7-104">次の表は、使用可能なスクリプト作成オプションについてまとめ、詳細情報へのリンクを提供します。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-104">The following table summarizes the scripting options available to you and provides links to more information.</span></span>  
  
 <span data-ttu-id="dc1f7-105">以下に示したすべての手法は、ファイルに保存でき、独立した操作として実行できるスクリプトをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-105">All of the methodologies listed below support scripts that can be saved to a file and executed as an independent operation.</span></span> <span data-ttu-id="dc1f7-106">テーブル モデルおよび PowerPivot ブックで使用する Data Analysis Expression (DAX) 言語は、条件を満たしていないため、以下の表には含まれていません。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-106">Because the Data Analysis Expression (DAX) language used for tabular models and PowerPivot workbooks does not meet the criteria, it is not included in the following list.</span></span>  
  
|<span data-ttu-id="dc1f7-107">手法</span><span class="sxs-lookup"><span data-stu-id="dc1f7-107">Methodology</span></span>|<span data-ttu-id="dc1f7-108">ファイル形式</span><span class="sxs-lookup"><span data-stu-id="dc1f7-108">File format</span></span>|<span data-ttu-id="dc1f7-109">説明</span><span class="sxs-lookup"><span data-stu-id="dc1f7-109">Description</span></span>|<span data-ttu-id="dc1f7-110">リンク</span><span class="sxs-lookup"><span data-stu-id="dc1f7-110">Links</span></span>|  
|-----------------|-----------------|-----------------|-----------|  
|<span data-ttu-id="dc1f7-111">PowerShell</span><span class="sxs-lookup"><span data-stu-id="dc1f7-111">PowerShell</span></span>|<span data-ttu-id="dc1f7-112">.ps1</span><span class="sxs-lookup"><span data-stu-id="dc1f7-112">.ps1</span></span>|<span data-ttu-id="dc1f7-113">Analysis Services は、SQL Server PowerShell のスクリプト環境を、新しいプロバイダーを通じてサポートします。このプロバイダーは、コマンド ラインからのオブジェクトのナビゲーションと、バックアップ、復元、処理、ロール管理などの管理タスク用の新しいコマンドレットからのオブジェクトのナビゲーションを追加します。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-113">Analysis Services supports the SQL Server PowerShell scripting environment through a new provider that adds object navigation from the command line, as well as new cmdlets for administrative tasks such as backup, restore, processing, and role management.</span></span><br /><br /> <span data-ttu-id="dc1f7-114">さらに、SQL Server PowerPivot (SQLPS) プロバイダーには、汎用コマンドレット、`Invoke-ASCmd` も含まれ、XMLA、MDX、または、DMX スクリプトを PowerShell セッション内で実行することができます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-114">Additionally, the SQL Server PowerPivot (SQLPS) provider includes a general purpose cmdlet, `Invoke-ASCmd`, which lets you run XMLA, MDX, or DMX script files from within a PowerShell session.</span></span><br /><br /> <span data-ttu-id="dc1f7-115">Analysis Services の PowerShell スクリプトは、多次元モデルとテーブル モデルの両方でサポートされますが、SharePoint からアクセスする PowerPivot ブックではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-115">Analysis Services PowerShell scripting is supported for both multidimensional and tabular models, but not for PowerPivot workbooks accessed from SharePoint.</span></span>|[<span data-ttu-id="dc1f7-116">Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="dc1f7-116">Analysis Services PowerShell</span></span>](analysis-services-powershell.md)<br /><br /> [<span data-ttu-id="dc1f7-117">Windows PowerShell のサバイバル ガイド</span><span class="sxs-lookup"><span data-stu-id="dc1f7-117">Windows PowerShell Survival Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=233747)|  
|<span data-ttu-id="dc1f7-118">ASSL または XMLA スクリプト</span><span class="sxs-lookup"><span data-stu-id="dc1f7-118">ASSL or XMLA Script</span></span>|<span data-ttu-id="dc1f7-119">.xmla</span><span class="sxs-lookup"><span data-stu-id="dc1f7-119">.xmla</span></span>|<span data-ttu-id="dc1f7-120">Analysis Services スクリプト言語 (ASSL) は、テーブル モデルまたは多次元モデルで実行される Analysis Services 上のオブジェクトと操作のデータ アクセスを提供する XMLA の拡張機能です。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-120">Analysis Services Scripting Language (ASSL) is an extension to XMLA that provides data access to objects and operations on an Analysis Services instance that runs in tabular or multidimensional mode.</span></span> <span data-ttu-id="dc1f7-121">ASSL には、XML 形式での Analysis Services オブジェクトと操作の完全な式を有効化するデータ定義とコマンド言語のサポートが含まれます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-121">ASSL includes data definition and command language support, enabling the complete expression of Analysis Services objects and operations in an XML format.</span></span> <span data-ttu-id="dc1f7-122">ASSL で提供されるオブジェクトとコマンドを使用するスクリプトは、.xmla ファイルとして保存されます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-122">Scripts that use the objects and commands provided by ASSL are saved as .xmla files.</span></span> <span data-ttu-id="dc1f7-123">Analysis Services のコンテキスト内では、ASSL を XMLA スクリプトとして参照するのが一般的です。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-123">Within the context of Analysis Services, it is common practice to refer to ASSL as XMLA script.</span></span> <span data-ttu-id="dc1f7-124">以下の要件が含まれる場合、この方法を選択してください。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-124">Choose this approach when your requirements include the following:</span></span><br /><br /> <span data-ttu-id="dc1f7-125">スクリプトがサーバー上に直接オブジェクトを作成する、またはデータ定義と操作の両方のタスクを実行する (たとえば、データベースの再作成と処理)。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-125">Your script creates objects directly on a server, or performs both data definition and operational tasks (for example, recreating and processing database).</span></span><br /><br /> <span data-ttu-id="dc1f7-126">複数のツールとテクノロジでスクリプトの再利用を最大限行うことが必要</span><span class="sxs-lookup"><span data-stu-id="dc1f7-126">You require maximum script reuse across multiple tools and technologies.</span></span> <span data-ttu-id="dc1f7-127">SSIS パッケージまたは PowerShell スクリプトで参照される SQL Server エージェントで XMLA スクリプトは、Analysis Services コマンド タスクに追加できます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-127">XMLA scripts can be added to Analysis Services command tasks in SQL Server Agent, referenced in SSIS packages, or referenced in PowerShell script.</span></span><br /><br /> <span data-ttu-id="dc1f7-128">スクリプトは自動的に実行する必要がある。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-128">The script must run unattended.</span></span> <span data-ttu-id="dc1f7-129">SQL Server エージェントを使用して、XMLA スクリプトまたは XMLA を含む SSIS パッケージを含むジョブをスケジュールできます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-129">You can use SQL Server Agent to schedule a job that contains XMLA script or an SSIS package that contains XMLA.</span></span><br /><br /> <span data-ttu-id="dc1f7-130">XMLA を使用するアプリケーション要件がある。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-130">You have application requirements for using XMLA.</span></span> <span data-ttu-id="dc1f7-131">XMLA は、マネージド コード環境を必要としないインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-131">XMLA is an interface that does not require a managed code environment.</span></span> <span data-ttu-id="dc1f7-132">.NET Framework を使用しないアプリケーションで XMLA スクリプトを実行することができます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-132">You can execute XMLA script in an application that does not use the .NET Framework.</span></span>|[<span data-ttu-id="dc1f7-133">Management Studio での Analysis Services スクリプトの作成</span><span class="sxs-lookup"><span data-stu-id="dc1f7-133">Create Analysis Services Scripts in Management Studio</span></span>](instances/create-analysis-services-scripts-in-management-studio.md)<br /><br /> [<span data-ttu-id="dc1f7-134">SQL Server Management Studio での Analysis Services テンプレートの使用</span><span class="sxs-lookup"><span data-stu-id="dc1f7-134">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="dc1f7-135">SQL Server エージェントで SSAS 管理タスクのスケジュール設定を行う</span><span class="sxs-lookup"><span data-stu-id="dc1f7-135">Schedule SSAS Administrative Tasks with SQL Server Agent</span></span>](instances/schedule-ssas-administrative-tasks-with-sql-server-agent.md)<br /><br /> [<span data-ttu-id="dc1f7-136">Analysis Services スクリプト言語 (ASSL) での開発</span><span class="sxs-lookup"><span data-stu-id="dc1f7-136">Developing with Analysis Services Scripting Language &#40;ASSL&#41;</span></span>](multidimensional-models/scripting-language-assl/developing-with-analysis-services-scripting-language-assl.md)<br /><br /> [<span data-ttu-id="dc1f7-137">Invoke-ASCmd コマンドレット</span><span class="sxs-lookup"><span data-stu-id="dc1f7-137">Invoke-ASCmd cmdlet</span></span>](/powershell/module/sqlserver/invoke-ascmd)|  
|||<span data-ttu-id="dc1f7-138">XMLA スクリプトを作成するには、Management Studio でスクリプト ジェネレーターを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-138">To create XMLA script, you can use the script generator in Management Studio.</span></span> <span data-ttu-id="dc1f7-139">オブジェクト レベルでは、オブジェクトを右クリックして、オブジェクトを作成、変更、または削除するスクリプトを生成します。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-139">At the object level, right-click an object to generate script that creates, alters, or deletes an object.</span></span> <span data-ttu-id="dc1f7-140">コマンド レベルでは、バックアップや復元の処理、集計のデザイン、その他のコマンドなどに対して、ダイアログ ボックスでスクリプト機能を使用してスクリプトを生成することができます。ダイアログ ボックスでは、スクリプトの出力先を新しいウィンドウ、ファイル、またはクリップボードのオプションから選択できます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-140">At the command level, such as for processing, backup or restore, aggregation design, or another command, you can generate script using the Script feature in the dialog box, choosing options that place the script in a new window, file, or clipboard.</span></span> <span data-ttu-id="dc1f7-141">また、テキスト エディターまたはコード エディターで、XMLA スクリプトを手動で作成したり、テンプレート エクスプ ローラーで、テンプレートを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-141">You can also write XMLA script manually in a text or code editor, or use a template in Template Explorer.</span></span> <span data-ttu-id="dc1f7-142">スクリプトを実行するには、次のいずれかの方法を実行します。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-142">To run the script, use one of these approaches:</span></span><br /><br /> <span data-ttu-id="dc1f7-143">Management Studio を使用して、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] インスタンスでオブジェクトを直接作成または変更する。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-143">Use Management Studio to directly create or modify objects on an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] instance.</span></span><br /><br /> <span data-ttu-id="dc1f7-144">SQL Server エージェントを使用して、Analysis Services コマンドのタスクを含むジョブをスケジュールする。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-144">Use SQL Server Agent to schedule a job that includes an Analysis Services command task.</span></span><br /><br /> <span data-ttu-id="dc1f7-145">Invoke ASCmd コマンドレットを使用して、PowerShell セッションでスクリプトを実行する。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-145">Use the Invoke-ASCmd cmdlet to run the script in a PowerShell session.</span></span>||  
|<span data-ttu-id="dc1f7-146">MDX Script</span><span class="sxs-lookup"><span data-stu-id="dc1f7-146">MDX Script</span></span>|<span data-ttu-id="dc1f7-147">.mdx</span><span class="sxs-lookup"><span data-stu-id="dc1f7-147">.mdx</span></span>|<span data-ttu-id="dc1f7-148">多次元式 (MDX) 言語は、分析データ ソースに対する業界標準クエリ言語で、XMLA 仕様の一部でもあります。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-148">Multidimensional Expression (MDX) language is an industry standard query language for analytical data sources that is also part of the XMLA specification.</span></span><br /><br /> <span data-ttu-id="dc1f7-149">データまたはシステム情報をクエリするスタンドアロンの MDX スクリプト ファイルを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-149">You can create a standalone MDX script file that queries data or system information.</span></span> <span data-ttu-id="dc1f7-150">たとえば、ローカル サーバーの操作やサーバーの正常性に関する情報を公開する動的管理ビュー (DMV) は、MDX の Select ステートメントを介してアクセスします。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-150">For example, Dynamic Management Views (DMV) that expose information about local server operations and server health are accessed via the MDX Select statement.</span></span><br /><br /> <span data-ttu-id="dc1f7-151">MDX スクリプトは、多次元モードとテーブル モードの両方のサーバーで実行されます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-151">MDX script will run on both multidimensional and tabular mode servers.</span></span> <span data-ttu-id="dc1f7-152">SQL Server Management Studio、または `Invoke-ASCmd` を使用して PowerShell セッションから対話的にスクリプトを実行することができます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-152">You can run the script interactively from SQL Server Management Studio, or from a PowerShell session using `Invoke-ASCmd`.</span></span>|[<span data-ttu-id="dc1f7-153">MDX スクリプティングの基礎 &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="dc1f7-153">MDX Scripting Fundamentals &#40;Analysis Services&#41;</span></span>](multidimensional-models/mdx/mdx-scripting-fundamentals-analysis-services.md)<br /><br /> [<span data-ttu-id="dc1f7-154">動的管理ビュー (DMV) を使用した Analysis Services の監視</span><span class="sxs-lookup"><span data-stu-id="dc1f7-154">Use Dynamic Management Views &#40;DMVs&#41; to Monitor Analysis Services</span></span>](instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md)<br /><br /> [<span data-ttu-id="dc1f7-155">SQL Server Management Studio での Analysis Services テンプレートの使用</span><span class="sxs-lookup"><span data-stu-id="dc1f7-155">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)|  
|<span data-ttu-id="dc1f7-156">DMX Script</span><span class="sxs-lookup"><span data-stu-id="dc1f7-156">DMX Script</span></span>|<span data-ttu-id="dc1f7-157">.dmx</span><span class="sxs-lookup"><span data-stu-id="dc1f7-157">.dmx</span></span>|<span data-ttu-id="dc1f7-158">データ マイニング拡張機能 (DMX) は、データ マイニング モデルに対するデータ定義、データ操作、およびデータ クエリ言語です。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-158">Data Mining Extensions (DMX) is a data definition, data manipulation, and data query language for data mining models.</span></span> <span data-ttu-id="dc1f7-159">最初に、テンプレートを使用できます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-159">You can use a template as a way to get started.</span></span>|[<span data-ttu-id="dc1f7-160">SQL Server Management Studio で DMX クエリを作成する</span><span class="sxs-lookup"><span data-stu-id="dc1f7-160">Create a DMX Query in SQL Server Management Studio</span></span>](data-mining/create-a-dmx-query-in-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="dc1f7-161">SQL Server Management Studio での Analysis Services テンプレートの使用</span><span class="sxs-lookup"><span data-stu-id="dc1f7-161">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)|  
|[!INCLUDE[ssIS](../includes/ssis-md.md)] <span data-ttu-id="dc1f7-162">パッケージ</span><span class="sxs-lookup"><span data-stu-id="dc1f7-162">packages</span></span>|<span data-ttu-id="dc1f7-163">.dtsx</span><span class="sxs-lookup"><span data-stu-id="dc1f7-163">.dtsx</span></span>|[!INCLUDE[ssIS](../includes/ssis-md.md)] <span data-ttu-id="dc1f7-164">は、データ マイニング モデルを含む、Analysis Services オブジェクトを作成、変更、削除、および処理するタスクとデータ フローを提供します。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-164">provides tasks and data flows that create, modify, delete, and process Analysis Services objects, including data mining models.</span></span> <span data-ttu-id="dc1f7-165">SQL Server エージェントを使用して、パッケージの実行をスケジュールできます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-165">You can schedule a package to run using SQL Server Agent.</span></span>|[<span data-ttu-id="dc1f7-166">Analysis Services DDL 実行タスク</span><span class="sxs-lookup"><span data-stu-id="dc1f7-166">Analysis Services Execute DDL Task</span></span>](../integration-services/control-flow/analysis-services-execute-ddl-task.md)<br /><br /> [<span data-ttu-id="dc1f7-167">Analysis Services 処理タスク</span><span class="sxs-lookup"><span data-stu-id="dc1f7-167">Analysis Services Processing Task</span></span>](../integration-services/control-flow/analysis-services-processing-task.md)<br /><br /> [<span data-ttu-id="dc1f7-168">データ マイニング クエリ タスク</span><span class="sxs-lookup"><span data-stu-id="dc1f7-168">Data Mining Query Task</span></span>](../integration-services/control-flow/data-mining-query-task.md)<br /><br /> [<span data-ttu-id="dc1f7-169">データマイニングモデルトレーニング変換先</span><span class="sxs-lookup"><span data-stu-id="dc1f7-169">Data Mining Model Training Destination</span></span>](../integration-services/data-flow/data-mining-model-training-destination.md)<br /><br /> [<span data-ttu-id="dc1f7-170">ディメンション処理変換先</span><span class="sxs-lookup"><span data-stu-id="dc1f7-170">Dimension Processing Destination</span></span>](../integration-services/data-flow/dimension-processing-destination.md)<br /><br /> [<span data-ttu-id="dc1f7-171">パーティション処理変換先</span><span class="sxs-lookup"><span data-stu-id="dc1f7-171">Partition Processing Destination</span></span>](../integration-services/data-flow/partition-processing-destination.md)|  
|<span data-ttu-id="dc1f7-172">分析管理オブジェクト (Analysis Management Objects)</span><span class="sxs-lookup"><span data-stu-id="dc1f7-172">Analysis Management Objects</span></span>||<span data-ttu-id="dc1f7-173">分析管理オブジェクト (AMO) は、管理操作を自動化するカスタム アプリケーションを開発するために、プログラマが使用できる管理インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-173">Analysis Management Objects (AMO) is managed interface that programmers can use to develop custom applications that automate administrative operations.</span></span> <span data-ttu-id="dc1f7-174">AMO を使用して、指定した XMLA、MDX または DMX スクリプトを実行するカスタム アプリケーションを開発することができます。</span><span class="sxs-lookup"><span data-stu-id="dc1f7-174">Using AMO, you can develop a custom application that runs XMLA, MDX, or DMX scripts that you provide.</span></span>|[<span data-ttu-id="dc1f7-175">AMO を使用した管理タスクのプログラミング</span><span class="sxs-lookup"><span data-stu-id="dc1f7-175">Programming Administrative Tasks with AMO</span></span>](https://docs.microsoft.com/bi-reference/amo/programming-administrative-tasks-with-amo)|  
  
## <a name="see-also"></a><span data-ttu-id="dc1f7-176">参照</span><span class="sxs-lookup"><span data-stu-id="dc1f7-176">See Also</span></span>  
 <span data-ttu-id="dc1f7-177">[Analysis Services スクリプト言語 &#40;ASSL&#41; リファレンス](https://docs.microsoft.com/bi-reference/assl/analysis-services-scripting-language-assl-for-xmla) </span><span class="sxs-lookup"><span data-stu-id="dc1f7-177">[Analysis Services Scripting Language &#40;ASSL&#41; Reference](https://docs.microsoft.com/bi-reference/assl/analysis-services-scripting-language-assl-for-xmla) </span></span>  
 <span data-ttu-id="dc1f7-178">[分析管理オブジェクト &#40;AMO&#41;を使用した開発](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) </span><span class="sxs-lookup"><span data-stu-id="dc1f7-178">[Developing with Analysis Management Objects &#40;AMO&#41;](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) </span></span>  
 [<span data-ttu-id="dc1f7-179">多次元モデルのオブジェクト処理</span><span class="sxs-lookup"><span data-stu-id="dc1f7-179">Multidimensional Model Object Processing</span></span>](multidimensional-models/processing-a-multidimensional-model-analysis-services.md)  
  
  
