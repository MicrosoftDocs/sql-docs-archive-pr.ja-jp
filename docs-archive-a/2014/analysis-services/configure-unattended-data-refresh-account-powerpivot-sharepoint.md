---
title: PowerPivot 自動データ更新アカウントの構成 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 81401eac-c619-4fad-ad3e-599e7a6f8493
author: minewiskan
ms.author: owend
ms.openlocfilehash: d6f53d7272dc48ed55ffb175e0ace3e97263946c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633489"
---
# <a name="configure-the-powerpivot-unattended-data-refresh-account-powerpivot-for-sharepoint"></a><span data-ttu-id="90cc7-102">PowerPivot 自動データ更新アカウントの構成 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="90cc7-102">Configure the PowerPivot Unattended Data Refresh Account (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="90cc7-103">PowerPivot 自動データ更新アカウントは、SharePoint ファームで PowerPivot データ更新ジョブを実行するために指定されたアカウントです。</span><span class="sxs-lookup"><span data-stu-id="90cc7-103">The PowerPivot unattended data refresh account is a designated account for running PowerPivot data refresh jobs in a SharePoint farm.</span></span> <span data-ttu-id="90cc7-104">構成すると、データ更新スケジュールページの [**管理者によって構成されたデータ更新アカウントを使用**する] オプションが有効になります (以下を参照)。</span><span class="sxs-lookup"><span data-stu-id="90cc7-104">By configuring it, you enable the **Use the data refresh account configured by the administrator** option in a data refresh schedule page (see below).</span></span> <span data-ttu-id="90cc7-105">データ更新をスケジュールするブックの作成者は、データ更新ジョブの実行に PowerPivot 自動データ更新アカウントを使用したい場合に、このオプションを選択できます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-105">Workbook authors who schedule data refresh can choose this option if they want to use the PowerPivot unattended data refresh account to run a data refresh job.</span></span> <span data-ttu-id="90cc7-106">データ更新スケジュールの資格情報オプションを表示する方法の詳細については、「[データ更新のスケジュール &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-106">For more information about how to view the Credentials options in a data refresh schedule, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
 <span data-ttu-id="90cc7-107">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="90cc7-107">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>  
  
 <span data-ttu-id="90cc7-108">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="90cc7-108">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="90cc7-109">サーバーを構成するときに選択したオプションによっては、自動データ更新アカウントが既に作成されている場合もあります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-109">Depending on which options you selected when configuring the server, the unattended data refresh account might already be created.</span></span> <span data-ttu-id="90cc7-110">既定の構成では、最初に自動データ更新アカウントの ID がファーム アカウントに設定されます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-110">In a default configuration, the identity of the unattended data refresh account is initially set to the farm account.</span></span> <span data-ttu-id="90cc7-111">別のユーザーとして実行するようにアカウントを変更すると、配置のセキュリティを強化できます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-111">You can improve the security of your deployment by changing the account to run as a different user.</span></span> <span data-ttu-id="90cc7-112">アカウントを変更するには、次の手順に従います。[既存の PowerPivot 自動データ更新アカウントによって使用される資格情報を更新](#bkmk_editUA)します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-112">Follow these instructions to change the account: [Update the credentials used by an existing PowerPivot unattended data refresh account](#bkmk_editUA).</span></span>  
  
 <span data-ttu-id="90cc7-113">その他のすべてのインストール シナリオでは、次の手順に従ってアカウントを手動で構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-113">For all other installation scenarios, you must configure this account manually using the instructions below.</span></span>  
  
 <span data-ttu-id="90cc7-114">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="90cc7-114">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="90cc7-115">必須コンポーネント</span><span class="sxs-lookup"><span data-stu-id="90cc7-115">Prerequisites</span></span>](#bkmk_prereq)  
  
 [<span data-ttu-id="90cc7-116">手順 1: 対象アプリケーションを作成して資格情報を設定する</span><span class="sxs-lookup"><span data-stu-id="90cc7-116">Step 1: Create a target application and set the credentials</span></span>](#bkmk_create)  
  
 [<span data-ttu-id="90cc7-117">手順 2: PowerPivot サーバー構成ページで自動アカウントを指定する</span><span class="sxs-lookup"><span data-stu-id="90cc7-117">Step 2: Specify the unattended account in PowerPivot server configuration pages</span></span>](#bkmk_specifyUA)  
  
 [<span data-ttu-id="90cc7-118">手順 3: アカウントに投稿権限を付与する</span><span class="sxs-lookup"><span data-stu-id="90cc7-118">Step 3: Grant contribute permissions to the account</span></span>](#bkmk_grant)  
  
 [<span data-ttu-id="90cc7-119">手順 4: データの更新時に外部データ ソースにアクセスするための読み取り権限を付与する</span><span class="sxs-lookup"><span data-stu-id="90cc7-119">Step 4: Grant read permissions to access external data sources used in data refresh</span></span>](#bkmk_dbread)  
  
 [<span data-ttu-id="90cc7-120">手順 5: データ更新構成ページでアカウントを使用できるかどうかを確認する</span><span class="sxs-lookup"><span data-stu-id="90cc7-120">Step 5: Verify account availability in data refresh configuration pages</span></span>](#bkmk_verify)  
  
 [<span data-ttu-id="90cc7-121">PowerPivot 自動データ更新アカウントを使用する</span><span class="sxs-lookup"><span data-stu-id="90cc7-121">Using the PowerPivot Unattended Data Refresh Account</span></span>](#bkmk_use)  
  
 [<span data-ttu-id="90cc7-122">既存の PowerPivot 自動データ更新アカウントで使用する資格情報の更新</span><span class="sxs-lookup"><span data-stu-id="90cc7-122">Update the credentials used by an existing PowerPivot unattended data refresh account</span></span>](#bkmk_editUA)  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="90cc7-123">前提条件</span><span class="sxs-lookup"><span data-stu-id="90cc7-123">Prerequisites</span></span>  
 <span data-ttu-id="90cc7-124">Secure Store Service を有効にして構成し、マスター キーを生成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-124">Secure Store Service must be enabled and configured, and a master key must be generated.</span></span> <span data-ttu-id="90cc7-125">その方法については、「 [SharePoint 2010 での PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-125">For instructions on how to do this, see [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span></span>  
  
 <span data-ttu-id="90cc7-126">PowerPivot 自動データ更新アカウントとして使用する Windows ドメイン ユーザー アカウントを事前に決めておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-126">You must decide in advance which Windows domain user account to use as the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="90cc7-127">ここでは、使用方法を確認できるように、PowerPivot 自動データ更新アカウント専用に作成されたアカウントを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-127">This should be an account that is created specifically for this purpose so that you can monitor how it is used.</span></span>  
  
 <span data-ttu-id="90cc7-128">PowerPivot System サービスのアプリケーション ID を把握しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-128">You must know the application identity of the PowerPivot System Service.</span></span> <span data-ttu-id="90cc7-129">このサービスアカウントには、手順1でターゲットアプリケーションを作成するときに自動データ更新アカウントに対する**フルコントロール**アクセス許可を付与します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-129">You will give this service account **Full Control** permissions over the unattended data refresh account when you create the target application for it in step 1.</span></span> <span data-ttu-id="90cc7-130">これらの権限により、PowerPivot System サービスは、データ更新中に自動データ更新アカウントの資格情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-130">These permissions allow the PowerPivot System Service to retrieve the credentials of the unattended data refresh account during data refresh.</span></span> <span data-ttu-id="90cc7-131">必要なサービスアカウント情報を取得するには、サーバーの全体管理の [**サービスアカウントの構成**] ページを開き、PowerPivot サービスアプリケーションによって使用されるサービスアプリケーションプールを選択します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-131">To get the required service account information, open the **Configure service accounts** page in Central Administration and select the service application pool used by the PowerPivot service application.</span></span> <span data-ttu-id="90cc7-132">既定では、これは**サービスアプリケーションプール-SharePoint Web サービスシステム**です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-132">By default, this is the **Service Application Pool - SharePoint Web Services System**.</span></span>  
  
## <a name="configure-the-unattended-powerpivot-data-refresh-account"></a><span data-ttu-id="90cc7-133">自動 PowerPivot データ更新アカウントの構成</span><span class="sxs-lookup"><span data-stu-id="90cc7-133">Configure the unattended PowerPivot data refresh account</span></span>  
 <span data-ttu-id="90cc7-134">PowerPivot サービス アプリケーションごとに構成できる PowerPivot 自動データ更新アカウントは 1 つだけです。</span><span class="sxs-lookup"><span data-stu-id="90cc7-134">You can configure only one PowerPivot unattended data refresh account for each PowerPivot service application.</span></span> <span data-ttu-id="90cc7-135">アカウント情報はターゲット アプリケーションの Secure Store Service に保存され、定義済みの Windows ドメイン ユーザー アカウントに設定されます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-135">Account information is stored in Secure Store Service in a target application that is set to a predefined Windows domain user account.</span></span> <span data-ttu-id="90cc7-136">ターゲット アプリケーションが作成されたら、PowerPivot サービス アプリケーションの構成ページで、そのアプリケーションを PowerPivot データ更新アカウントとして指定できます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-136">Once the target application is created, you can specify it as the PowerPivot data refresh account in the configuration pages of a PowerPivot service application.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="90cc7-137">データ更新を自動データ更新アカウントで実行すると、自動データ更新に使用した Windows ユーザー アカウントに対して、使用状況レポートとデータ更新履歴が記録されます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-137">When data refresh is performed under the unattended data refresh account, usage reporting and data refresh history is recorded against the Windows user account used for unattended data refresh.</span></span> <span data-ttu-id="90cc7-138">データ更新を要求しているユーザーやスケジュールを所有しているユーザーについて、より正確な記録が必要になる場合は、データ更新を実行する場合に他のいずれかのオプションを検討してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-138">If you require a more accurate record of the individuals who are requesting data refresh or who own schedules, consider one of the other options for running data refresh.</span></span> <span data-ttu-id="90cc7-139">つまり、ユーザーに各自の資格情報を指定させるか (既定)、データ更新用にすべての Windows 資格情報を保存するための追加のターゲット アプリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-139">Namely, having users specify their own credentials (this is the default), or creating additional target applications for storing any Windows credentials that you want to use for data refresh purposes.</span></span> <span data-ttu-id="90cc7-140">詳細については、「[PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-140">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
 <span data-ttu-id="90cc7-141">自動データ更新アカウントの作成には、次の 5 つの段階があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-141">There are five parts to creating the unattended data refresh account.</span></span>  
  
-   <span data-ttu-id="90cc7-142">Secure Store Service でアカウントのターゲット アプリケーションを作成し、資格情報を指定する。</span><span class="sxs-lookup"><span data-stu-id="90cc7-142">Create a target application in Secure Store Service for the account and specify the credentials.</span></span>  
  
-   <span data-ttu-id="90cc7-143">PowerPivot サーバー構成ページで自動データ更新アカウント用のターゲット アプリケーション ID を指定する。</span><span class="sxs-lookup"><span data-stu-id="90cc7-143">Specify the target application ID for the unattended data refresh account in the PowerPivot server configuration page.</span></span>  
  
-   <span data-ttu-id="90cc7-144">アカウントに投稿権限を付与する。</span><span class="sxs-lookup"><span data-stu-id="90cc7-144">Grant Contribute permissions to the account.</span></span>  
  
-   <span data-ttu-id="90cc7-145">データ更新中に外部データ ソースにアクセスするための読み取り権限をアカウントに付与する。</span><span class="sxs-lookup"><span data-stu-id="90cc7-145">Grant the account read permissions to access external data sources during data refresh.</span></span>  
  
-   <span data-ttu-id="90cc7-146">[データ更新の管理] スケジュール ページで、パブリッシュされた PowerPivot ブックのアカウントが使用できることを確認する。</span><span class="sxs-lookup"><span data-stu-id="90cc7-146">Verify the account is available in the Manage Data Refresh schedule page for a published PowerPivot workbook.</span></span>  
  
###  <a name="step-1-create-a-target-application-and-set-the-credentials"></a><a name="bkmk_create"></a><span data-ttu-id="90cc7-147">手順 1: ターゲットアプリケーションを作成し、資格情報を設定する</span><span class="sxs-lookup"><span data-stu-id="90cc7-147">Step 1: Create a target application and set the credentials</span></span>  
  
1.  <span data-ttu-id="90cc7-148">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-148">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="90cc7-149">[ **Secure Store Service**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-149">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="90cc7-150">[ターゲットアプリケーションの管理] で、[**新規**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-150">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="90cc7-151">[ターゲットアプリケーション ID] に、「 **PowerPivotDataRefresh**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-151">In Target application ID, type **PowerPivotDataRefresh**.</span></span>  
  
5.  <span data-ttu-id="90cc7-152">[表示名] に「 **PowerPivot データ更新**」と入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-152">In Display Name, type **PowerPivot Data Refresh**.</span></span>  
  
6.  <span data-ttu-id="90cc7-153">[連絡先の電子メール] に、自分の電子メール アドレスを入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-153">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="90cc7-154">[ターゲットアプリケーションの種類] で、[**個人**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-154">In Target Application Type, select **Individual**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="90cc7-155">PowerPivot サービス アプリケーションだけが PowerPivot 自動データ更新アカウントの資格情報を要求するため、このシナリオでは [個人] アカウントの種類を指定するのが適切です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-155">Specifying an Individual account type is correct for this scenario because only the PowerPivot service application will request the credentials of the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="90cc7-156">実際には、サービス アプリケーションは自動データ更新アカウントの唯一のユーザーであるため、[個人] アカウントの種類がこのターゲット アプリケーションに対して最適な選択肢になります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-156">In practice, the service application is the sole user of the unattended data refresh account, making the Individual account type the best choice for this target application.</span></span>  
  
8.  <span data-ttu-id="90cc7-157">[対象アプリケーションのページ URL] はスキップします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-157">Skip Target Application Page URL.</span></span> <span data-ttu-id="90cc7-158">PowerPivot データ更新では使用されません。</span><span class="sxs-lookup"><span data-stu-id="90cc7-158">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="90cc7-159">**[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-159">Click **Next**.</span></span>  
  
10. <span data-ttu-id="90cc7-160">[ **Secure Store のターゲットアプリケーションの資格情報フィールドの指定**] ページで、既定値をそのまま使用します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-160">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values.</span></span> <span data-ttu-id="90cc7-161">フィールドの名前と種類は、Windows ユーザー名と Windows パスワードにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-161">Field names and types should be Windows User Name and Windows Password</span></span>  
  
11. <span data-ttu-id="90cc7-162">**[次へ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-162">Click **Next**.</span></span>  
  
12. <span data-ttu-id="90cc7-163">[ターゲット アプリケーションの管理者] で、PowerPivot サービス アプリケーションのアプリケーション プール ID を指定します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-163">In Target Application Administrators, specify the application pool identity of the PowerPivot service application.</span></span> <span data-ttu-id="90cc7-164">サービスには、実行時に自動データ更新アカウント情報を取得できるように、**フルコントロール**のアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-164">The service requires **Full Control** permissions so that it can retrieve unattended data refresh account information at run time.</span></span> <span data-ttu-id="90cc7-165">さらに、アプリケーション設定に対する管理アクセス権を必要とする他の SharePoint ユーザーの Windows ドメイン ユーザー アカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-165">In addition, specify the Windows domain user accounts of any other SharePoint user who should have administrative access to the application settings.</span></span>  
  
13. <span data-ttu-id="90cc7-166">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-166">Click **OK**.</span></span>  
  
14. <span data-ttu-id="90cc7-167">先ほど作成したターゲットアプリケーションを選択し、下矢印をクリックして、[**資格情報の設定**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-167">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
15. <span data-ttu-id="90cc7-168">[**資格情報の所有者**] に、資格情報を更新するアクセス許可を付与する Windows ドメインユーザーアカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-168">In **Credential Owners**, type a Windows domain user account that you want to have permissions to update the credentials.</span></span> <span data-ttu-id="90cc7-169">資格情報は、データの新規アクションに使用されます。資格情報の**所有者**には、資格情報を変更するためのアクセス許可があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-169">The credentials are used for data fresh actions and the **Credential Owners** have permissions to modify the credentials.</span></span>  
  
16. <span data-ttu-id="90cc7-170">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-170">Click **OK**.</span></span>  
  
###  <a name="step-2-specify-the-unattended-account-in-powerpivot-server-configuration-pages"></a><a name="bkmk_specifyUA"></a><span data-ttu-id="90cc7-171">手順 2: PowerPivot サーバー構成ページで自動アカウントを指定する</span><span class="sxs-lookup"><span data-stu-id="90cc7-171">Step 2: Specify the unattended account in PowerPivot server configuration pages</span></span>  
  
1.  <span data-ttu-id="90cc7-172">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-172">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="90cc7-173">PowerPivot サービス アプリケーションを探します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-173">Find the PowerPivot Service application.</span></span> <span data-ttu-id="90cc7-174">サービス アプリケーションは、型で識別できます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-174">You can identify a service application by its type.</span></span> <span data-ttu-id="90cc7-175">PowerPivot サービス アプリケーションの型は、 **[PowerPivot サービス アプリケーション]** です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-175">A PowerPivot service application type is **PowerPivot Service Application**.</span></span>  
  
3.  <span data-ttu-id="90cc7-176">PowerPivot サービス アプリケーションの名前をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-176">Click the PowerPivot service application name.</span></span> <span data-ttu-id="90cc7-177">PowerPivot 管理ダッシュボードが表示されるまで待ちます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-177">Wait for the PowerPivot Management Dashboard to appear.</span></span>  
  
4.  <span data-ttu-id="90cc7-178">[アクション] の右上隅にある [**サービスアプリケーション設定の構成**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-178">In Actions, in the top right corner, click **Configure service application settings**.</span></span>  
  
5.  <span data-ttu-id="90cc7-179">[データ更新] の [PowerPivot 自動データ更新アカウント] で、前の手順で作成したターゲットアプリケーション ID **PowerPivotDataRefresh**を入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-179">In Data Refresh, in PowerPivot Unattended Data Refresh Account, type the target application ID you created in a previous step: **PowerPivotDataRefresh**.</span></span>  
  
6.  <span data-ttu-id="90cc7-180">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-180">Click **OK**.</span></span>  
  
###  <a name="step-3-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a><span data-ttu-id="90cc7-181">手順 3: アカウントに投稿権限を付与する</span><span class="sxs-lookup"><span data-stu-id="90cc7-181">Step 3: Grant contribute permissions to the account</span></span>  
 <span data-ttu-id="90cc7-182">PowerPivot 自動データ更新アカウントを使用する前に、使用する任意の PowerPivot ブックに対する投稿権限をこのアカウントに割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-182">Before you can use the PowerPivot unattended data refresh account, it must be assigned Contribute permissions on any PowerPivot workbook for which it is used.</span></span> <span data-ttu-id="90cc7-183">この権限レベルは、ライブラリからブックを開き、データの更新後に再度ライブラリに保存するために必要です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-183">This permission level is necessary to open the workbook from a library and then save it back to the library after the data is refreshed.</span></span>  
  
 <span data-ttu-id="90cc7-184">権限の割り当ては、サイト コレクションの管理者が実行する手順です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-184">Assigning permissions is a step that is performed by the site collection administrator.</span></span> <span data-ttu-id="90cc7-185">SharePoint の権限は、ルート サイト コレクションで割り当てるか、ルート サイト コレクションより下位の任意のレベル (個々のドキュメントやアイテムを含む) で割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-185">SharePoint permissions can be assigned at the root site collection or at any level below that, including on individual documents and items.</span></span> <span data-ttu-id="90cc7-186">権限の設定方法は、権限をどのくらい細かく設定する必要があるかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-186">How you set permissions will vary depending on how granular you need them to be.</span></span> <span data-ttu-id="90cc7-187">次の手順は、権限を付与する方法の一例を示しています。</span><span class="sxs-lookup"><span data-stu-id="90cc7-187">The following steps show you one approach for granting permissions.</span></span>  
  
1.  <span data-ttu-id="90cc7-188">SharePoint サイトで、[サイトの操作] の [**サイトの権限**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-188">On a SharePoint site, in Site Actions, click **Site Permissions**.</span></span>  
  
2.  <span data-ttu-id="90cc7-189">**[アクセス許可の付与]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-189">Click **Grant Permissions**.</span></span>  
  
3.  <span data-ttu-id="90cc7-190">[ユーザーの選択] に、PowerPivot 自動データ更新アカウントとして指定した Windows ドメイン ユーザー アカウントの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-190">In Select users, type the name of the Windows domain user account that you designated as the PowerPivot unattended account.</span></span> <span data-ttu-id="90cc7-191">これは、Secure Store Service でターゲット アプリケーションに指定した Windows ドメイン ユーザー アカウントの名前です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-191">This is the name of the Windows domain user account that you specified in target application in Secure Store Service.</span></span>  
  
4.  <span data-ttu-id="90cc7-192">[アクセス許可の付与] で、[**ユーザーにアクセス許可を直接付与**する] を選択します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-192">In Grant Permissions, select **Grant users permission directly**.</span></span>  
  
5.  <span data-ttu-id="90cc7-193">[**投稿**] を選択し、[ **OK**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-193">Select **Contribute**, and then click **OK**.</span></span>  
  
###  <a name="step-4-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a><span data-ttu-id="90cc7-194">手順 4: データ更新で使用される外部データソースにアクセスするための読み取り権限を付与する</span><span class="sxs-lookup"><span data-stu-id="90cc7-194">Step 4: Grant read permissions to access external data sources used in data refresh</span></span>  
 <span data-ttu-id="90cc7-195">データを PowerPivot ブックにインポートする場合、通常、外部データへの接続は、信頼関係接続か、(現在のユーザーの ID を使用してデータ ソースに接続する) 権限を借用した接続に基づきます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-195">When importing data into a PowerPivot workbook, connections to external data are often based on trusted connections or impersonated connections that use the identity of the current user to connect to the data source.</span></span> <span data-ttu-id="90cc7-196">これらの種類の接続は、現在のユーザーがインポートする対象のデータに対する読み取り権限を持つ場合にのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="90cc7-196">These types of connections work only when the current user has permission to read the data that he or she is importing.</span></span>  
  
 <span data-ttu-id="90cc7-197">データ更新シナリオでは、データをインポートするために使用された接続文字列が、データを更新するために再利用されます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-197">In a data refresh scenario, the same connection string that was used to import data is now reused to refresh the data.</span></span> <span data-ttu-id="90cc7-198">接続文字列が現在のユーザーを想定している (たとえば、Integrated_Security=SSPI を含む文字列) 場合、PowerPivot System サービスは、PowerPivot 自動データ更新アカウントのユーザー ID を現在のユーザーとして渡します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-198">If the connection string assumes the current user (for example, a string that includes Integrated_Security=SSPI), then the PowerPivot System Service will pass the user identity of the PowerPivot unattended data refresh account as the current user.</span></span> <span data-ttu-id="90cc7-199">この接続は、外部データ ソースに対する読み取り権限が PowerPivot 自動データ更新アカウントに付与されている場合にのみ成功します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-199">This connection will only succeed if the PowerPivot unattended data refresh account has read permissions on the external data source.</span></span>  
  
 <span data-ttu-id="90cc7-200">このため、自動アカウントで実行されるすべてのデータ更新操作で使用されるすべての外部データ ソースに対する読み取り専用権限を、PowerPivot 自動データ更新アカウントに付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-200">For this reason, you must grant the PowerPivot unattended data refresh account read-only permissions on all of the external data sources that are used in any data refresh operation that runs under the unattended account.</span></span>  
  
 <span data-ttu-id="90cc7-201">組織で使用しているデータ ソースの管理者であれば、ログインを作成し、必要な権限を付与することができます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-201">If you are an administrator of the data sources used in your organization, you can create a login and assign the necessary permissions.</span></span> <span data-ttu-id="90cc7-202">管理者でない場合は、データの所有者に対してアカウント情報を連絡する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-202">Otherwise, you must contact the data owners and provide the account information.</span></span> <span data-ttu-id="90cc7-203">PowerPivot 自動データ更新アカウントにマップされる Windows ドメイン ユーザー アカウントを必ず指定してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-203">Be sure to specify the Windows domain user account that maps to the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="90cc7-204">これは、このトピックの「(手順 1): ターゲットアプリケーションを作成し、資格情報を設定する」で指定したアカウントです。</span><span class="sxs-lookup"><span data-stu-id="90cc7-204">This is the account you specified in "(Step 1): Create a target application and set the credentials" in this topic.</span></span>  
  
###  <a name="step-5-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a><span data-ttu-id="90cc7-205">手順 5: データ更新構成ページでアカウントの可用性を確認する</span><span class="sxs-lookup"><span data-stu-id="90cc7-205">Step 5: Verify account availability in data refresh configuration pages</span></span>  
  
1.  <span data-ttu-id="90cc7-206">PowerPivot データが含まれているパブリッシュ済みのブックのデータ更新構成ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-206">Open a data refresh configuration page for a published workbook that contains PowerPivot data.</span></span> <span data-ttu-id="90cc7-207">ページを開く方法については、「 [PowerPivot for SharePoint&#41;&#40;データ更新をスケジュールする](schedule-a-data-refresh-powerpivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-207">For instructions on how to open the page, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="90cc7-208">[データ更新の構成] ページで、[**管理者によって構成されたデータ更新アカウントを使用**する] オプションが有効になっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-208">Verify that the **Use the data refresh account configured by the administrator** option is enabled in the data refresh configuration page.</span></span>  
  
3.  <span data-ttu-id="90cc7-209">[**直ちに更新**する] チェックボックスをオンにし、[ **OK**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-209">Select the **Also refresh as soon as possible** checkbox, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="90cc7-210">ブックが格納されているライブラリで、ブックを選択し、右側に表示される下矢印をクリックして、[ **PowerPivot データ更新の管理**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-210">In the library that contains the workbook, select the workbook, click the down arrow that appears to right, and then select **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="90cc7-211">データ更新ジョブが返すデータ量が多い場合は、数分待つことが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-211">You might need to wait several minutes if the data refresh job is returning a large amount of data.</span></span>  
  
 <span data-ttu-id="90cc7-212">エラーが発生した場合は、[データ更新の履歴] ページで [**スケジュールの構成**] をクリックして、別の資格情報を試すことができます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-212">If an error occurs, you can click **Configure schedule** in the data refresh history page to try different credentials.</span></span> <span data-ttu-id="90cc7-213">元のブックのデータ ソース接続情報を調べて、データ更新時に使用される接続文字列を表示することが必要な場合もあります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-213">You might also need to inspect the data source connection information in the original workbook to view the connection string that is used during data refresh.</span></span> <span data-ttu-id="90cc7-214">接続文字列は、問題のトラブルシューティングに使用できるサーバーの場所とデータベースに関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-214">The connection string will provide information about the server location and database that you can use to troubleshoot the problem.</span></span>  
  
 <span data-ttu-id="90cc7-215">トラブルシューティングの詳細については、TechNet Wiki の「 [PowerPivot データ更新のトラブルシューティング](https://go.microsoft.com/fwlink/p/?LinkID=223279)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-215">For more information about troubleshooting, see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/p/?LinkID=223279) on the TechNet Wiki.</span></span>  
  
##  <a name="using-the-powerpivot-unattended-data-refresh-account"></a><a name="bkmk_use"></a><span data-ttu-id="90cc7-216">PowerPivot 自動データ更新アカウントの使用</span><span class="sxs-lookup"><span data-stu-id="90cc7-216">Using the PowerPivot Unattended Data Refresh Account</span></span>  
 <span data-ttu-id="90cc7-217">PowerPivot データ更新スケジュール ページの 3 つの資格情報オプションのうち、自動データ更新アカウントに対応するのは最初のオプションだけです。</span><span class="sxs-lookup"><span data-stu-id="90cc7-217">Of the three credential options in PowerPivot data refresh scheduling page, only the first one corresponds to the unattended data refresh account.</span></span> <span data-ttu-id="90cc7-218">データ更新スケジュールを設定する場合は、必ずこのオプションを選択してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-218">Be sure to select this option when setting up the data refresh schedule.</span></span>  
  
 <span data-ttu-id="90cc7-219">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="90cc7-219">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>  
  
 <span data-ttu-id="90cc7-220">PowerPivot 自動データ更新アカウントへのアクセスには第 3 の資格情報オプション (ターゲット アプリケーション ID の入力を必要とするオプション) を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-220">Do not use the third credential option (the one that requires you to enter the target application ID) to access the PowerPivot unattended data refresh account.</span></span> <span data-ttu-id="90cc7-221">このオプションで実行される追加の権限借用チェックにより、このオプションを PowerPivot 自動データ更新アカウント (または、[個人] アカウントの種類に基づくターゲット アプリケーション) と共に使用しようとすると検証エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-221">There is an additional impersonation check that is performed with that option that will result in a validation error if you try to use it with the PowerPivot unattended data refresh account (or any target application that is based on the Individual account type).</span></span> <span data-ttu-id="90cc7-222">3番目のオプションの使用方法の詳細については、「 [PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="90cc7-222">For more information about how to use the third option, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="update-the-credentials-used-by-an-existing-powerpivot-unattended-data-refresh-account"></a><a name="bkmk_editUA"></a><span data-ttu-id="90cc7-223">既存の PowerPivot 自動データ更新アカウントで使用される資格情報を更新する</span><span class="sxs-lookup"><span data-stu-id="90cc7-223">Update the credentials used by an existing PowerPivot unattended data refresh account</span></span>  
 <span data-ttu-id="90cc7-224">セットアップまたは管理者によって自動データ更新アカウントが既に構成されている場合は、資格情報が保存されているターゲット アプリケーションを編集することで、ユーザー名またはパスワードを更新できます。</span><span class="sxs-lookup"><span data-stu-id="90cc7-224">If the unattended data refresh account is already configured through setup or by an administrator, you can update the user name or password by editing the target application that stores the credentials.</span></span> <span data-ttu-id="90cc7-225">以前に PowerPivot 自動データ更新アカウントに関連付けられていた元の Windows ID は、Secure Store Service で資格情報を編集するときに表示されません。</span><span class="sxs-lookup"><span data-stu-id="90cc7-225">Note that the original Windows identity that was previously associated with PowerPivot unattended data refresh account will not be visible when you edit the credentials in Secure Store Service.</span></span> <span data-ttu-id="90cc7-226">期限切れのパスワードを更新するか、別のアカウントを指定するかにかかわらず、常に Secure Store Service でそのターゲット アプリケーションのユーザー名とパスワードの両方を再入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-226">Whether you are updating an expired password or specifying different account, you must always re-type both the user name and password for that target application in Secure Store Service.</span></span>  
  
1.  <span data-ttu-id="90cc7-227">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-227">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="90cc7-228">[ **Secure Store Service**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-228">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="90cc7-229">**PowerPivotDataRefresh**の横にあるチェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-229">Select the checkbox next to **PowerPivotDataRefresh**.</span></span>  
  
4.  <span data-ttu-id="90cc7-230">[資格情報] で、[**設定**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-230">In Credentials, click **Set**.</span></span>  
  
5.  <span data-ttu-id="90cc7-231">[**資格情報の所有者**] に、資格情報を更新するアクセス許可を付与する Windows ドメインユーザーアカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-231">In **Credential Owners**, type a Windows domain user account that you want to have permissions to update the credentials.</span></span> <span data-ttu-id="90cc7-232">資格情報は、データの新規アクションに使用されます。資格情報の**所有者**には、資格情報を変更するためのアクセス許可があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-232">The credentials are used for data fresh actions and the **Credential Owners** have permissions to modify the credentials.</span></span>  
  
6.  <span data-ttu-id="90cc7-233">[ユーザー名] に、自動データ更新資格情報の一部となる Windows ドメイン ユーザー アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-233">In User Name, type the Windows domain user account that will be part of the unattended data refresh credentials.</span></span>  
  
7.  <span data-ttu-id="90cc7-234">[パスワード] に、アカウントのパスワードを入力し、確認のためもう一度パスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-234">In Password, type the password for the account, and then re-type it to confirm the password.</span></span>  
  
8.  <span data-ttu-id="90cc7-235">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="90cc7-235">Click **OK**.</span></span>  
  
 <span data-ttu-id="90cc7-236">パスワードだけでなく、アカウントのユーザー名も変更する場合、通常は外部データ ソースに対する読み取り権限や PowerPivot ブックを更新するための SharePoint 権限の付与などの追加の構成手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="90cc7-236">If you are changing not just the password, but the account user name as well, you will most likely need to perform additional configuration steps, such as granting read permissions to external data sources and SharePoint permissions to update the PowerPivot workbook.</span></span> <span data-ttu-id="90cc7-237">手順については、「PowerPivot 自動データ更新アカウントの構成:[手順 3: アカウントに投稿のアクセス許可を付与](#bkmk_grant)する」の手順に進み、残りのすべての手順を続行します。その後、アカウントが正しく構成されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="90cc7-237">For instructions, go to this step in PowerPivot unattended data refresh account configuration: [Step 3: Grant contribute permissions to the account](#bkmk_grant), and then continue with all remaining steps, concluding with verification that the account is configured correctly.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="90cc7-238">参照</span><span class="sxs-lookup"><span data-stu-id="90cc7-238">See Also</span></span>  
 <span data-ttu-id="90cc7-239">[SharePoint 2010 での PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="90cc7-239">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="90cc7-240">[データ更新 &#40;PowerPivot for SharePoint をスケジュールする&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="90cc7-240">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="90cc7-241">PowerPivot のデータ更新</span><span class="sxs-lookup"><span data-stu-id="90cc7-241">PowerPivot Data Refresh</span></span>](power-pivot-sharepoint/power-pivot-data-refresh.md)  
  
  
