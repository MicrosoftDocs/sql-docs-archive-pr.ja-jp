---
title: 計算 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738977"
---
# <a name="calculations"></a><span data-ttu-id="5efb4-102">計算</span><span class="sxs-lookup"><span data-stu-id="5efb4-102">Calculations</span></span>
  <span data-ttu-id="5efb4-103">計算は、のキューブで計算されるメンバー、名前付きセット、またはスコープ割り当てを定義するために使用される多次元式 (MDX) 式またはスクリプトです [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="5efb4-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="5efb4-104">計算により、キューブのデータによって定義されるオブジェクトではなく、キューブの他の部分、他のキューブ、さらには [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] データベースの外部にある情報を参照できる式によって定義されるオブジェクトを追加できます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="5efb4-105">計算により、キューブの機能を拡張し、ビジネス インテリジェンス アプリケーションの柔軟性と能力を向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="5efb4-106">スクリプト計算の詳細については、「 [Microsoft SQL Server 2005 での MDX スクリプトの概要](https://go.microsoft.com/fwlink/?LinkId=81892)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5efb4-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="5efb4-107">MDX クエリおよび計算に関連するパフォーマンスの問題の詳細については、「 [SQL Server 2005 Analysis Services パフォーマンスガイド](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5efb4-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="5efb4-108">計算されるメンバー</span><span class="sxs-lookup"><span data-stu-id="5efb4-108">Calculated Members</span></span>  
 <span data-ttu-id="5efb4-109">計算されるメンバーとは、値が実行時に計算されるメンバーのことです。その計算には、計算されるメンバーの定義時に指定した多次元式 (MDX) が使用されます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="5efb4-110">計算されるメンバーは、ビジネス インテリジェンス アプリケーションで他のメンバーと同様に使用できます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="5efb4-111">キューブに保存されるのは定義のみであるため、計算されるメンバーによってキューブのサイズが大きくなることはありません。値はクエリへの応答時にメモリ内で計算されます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="5efb4-112">計算されるメンバーは、メジャー ディメンションを含むすべてのディメンションで定義できます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="5efb4-113">メジャー ディメンションに作成された計算されるメンバーは、計算されるメジャーと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="5efb4-114">通常、計算されるメンバーはキューブの既存のデータに基づいていますが、データに算術演算子、数値、および関数を組み合わせて複雑な式を作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="5efb4-115">また、LookupCube などの MDX 関数を使用し、[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] データベースにある他のキューブのデータにアクセスすることも可能です。</span><span class="sxs-lookup"><span data-stu-id="5efb4-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="5efb4-116">には標準化された Visual Studio 関数ライブラリが含まれているため、ストアド プロシージャを使用して、現在の [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] データベース以外のソースからデータを取得することができます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-116">includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="5efb4-117">ストアドプロシージャの詳細については、「[ストアドプロシージャの定義](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5efb4-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="5efb4-118">たとえば、船会社の経営陣が積載量に対するコストに基づいて、利益の上がる貨物の種類を特定する場合を考えてみます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="5efb4-119">経営陣が使用する Shipments キューブには、ディメンションとして Cargo、Fleet、および Time が含まれ、メジャーとして Price_to_Ship、Cost_to_Ship、および Volume_in_Cubic_Meters が含まれています。ただし、収益性に関するメジャーは含まれていません。</span><span class="sxs-lookup"><span data-stu-id="5efb4-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="5efb4-120">この場合、計算されるメンバーを Profit_per_Cubic_Meter という名前のメジャーとしてキューブに作成できます。その値を計算するには、次のように、式の中で既存のメジャーを組み合わせます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="5efb4-121">計算されるメンバーを作成した後、Shipments キューブを参照すると、Profit_per_Cubic_Meter が他のメジャーと共に表示されます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="5efb4-122">計算されるメンバーを作成するには、キューブデザイナーの [**計算**] タブを使用します。</span><span class="sxs-lookup"><span data-stu-id="5efb4-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="5efb4-123">詳細については、「[計算されるメンバーの作成](../multidimensional-models/create-calculated-members.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5efb4-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="5efb4-124">名前付きセット</span><span class="sxs-lookup"><span data-stu-id="5efb4-124">Named Sets</span></span>  
 <span data-ttu-id="5efb4-125">名前付きセットとは、セットを返す CREATE SET MDX ステートメント式であり、</span><span class="sxs-lookup"><span data-stu-id="5efb4-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="5efb4-126">MDX 式は、のキューブの定義の一部として保存され [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="5efb4-127">名前付きセットは、多次元式 (MDX) クエリで再使用するために作成されます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="5efb4-128">名前付きセットを使用すると、ビジネス ユーザーは、クエリを簡素化し、複雑で頻繁に使用されるセット式にセット式ではなくセット名を使用できます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="5efb4-129">**関連トピック:** [名前付きセットの作成](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="5efb4-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="5efb4-130">スクリプト コマンド</span><span class="sxs-lookup"><span data-stu-id="5efb4-130">Script Commands</span></span>  
 <span data-ttu-id="5efb4-131">スクリプト コマンドは、キューブの定義の一部として含まれる MDX スクリプトです。</span><span class="sxs-lookup"><span data-stu-id="5efb4-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="5efb4-132">スクリプト コマンドを使用すると、キューブの一部のみに対する計算のスコープ割り当てなど、MDX でサポートされるほとんどすべてのアクションをキューブで実行できます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="5efb4-133">では [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 、MDX スクリプトをキューブ全体に適用することも、スクリプトの実行を通じて特定の時点でキューブの特定のセクションに適用することもできます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="5efb4-134">既定のスクリプト コマンドである CALCULATE ステートメントを実行すると、既定の範囲に基づいて、キューブのセルに集計データが設定されます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="5efb4-135">既定の範囲はキューブ全体ですが、サブキューブと呼ばれる制限された範囲を定義して、特定のキューブ領域にのみ MDX スクリプトを適用することもできます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="5efb4-136">SCOPE ステートメントは、範囲が終了するか、再定義されるまで、計算スクリプト内の後続の MDX 式およびステートメントのすべての範囲を定義します。</span><span class="sxs-lookup"><span data-stu-id="5efb4-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="5efb4-137">THIS ステートメントを使用すると、MDX 式を現在の範囲に適用できます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="5efb4-138">BACK_COLOR ステートメントを使用すると、現在の範囲内のセルの背景色を指定して、デバッグに役立てることができます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="5efb4-139">たとえば、スクリプト コマンドを使用すると、以前の期間の売上の重み付け値を基にして、期間と販売区域全体を対象に、販売ノルマを従業員に割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="5efb4-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5efb4-140">参照</span><span class="sxs-lookup"><span data-stu-id="5efb4-140">See Also</span></span>  
 [<span data-ttu-id="5efb4-141">多次元モデルの計算</span><span class="sxs-lookup"><span data-stu-id="5efb4-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
