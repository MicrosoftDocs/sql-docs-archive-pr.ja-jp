---
title: SharePoint 2010 を使用した PowerPivot データ更新 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01874bf521055d1441b695a238d09440021d2718
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87720366"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a><span data-ttu-id="ff9dc-102">SharePoint 2010 での PowerPivot データ更新</span><span class="sxs-lookup"><span data-stu-id="ff9dc-102">PowerPivot Data Refresh with SharePoint 2010</span></span>
  [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] <span data-ttu-id="ff9dc-103">のデータ更新は、外部データ ソースにクエリを実行して、コンテンツ ライブラリに保存されている Excel 2010 ブック内の埋め込み [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] データを更新する、スケジュールされたサーバー側の操作です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-103">t data refresh is a scheduled server-side operation that queries external data sources to update embedded [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data in an Excel 2010 workbook that is stored in a content library.</span></span>

 <span data-ttu-id="ff9dc-104">データ更新は [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint に組み込まれている機能ですが、これを使用するには、SharePoint 2010 ファーム内で特定のサービスおよびタイマー ジョブを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-104">Data refresh is a built-in feature of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint, but using it requires that you run specific services and timer jobs in your SharePoint 2010 farm.</span></span> <span data-ttu-id="ff9dc-105">データ更新を成功させるには、データ プロバイダーのインストールやデータベース権限の確認など、追加の管理手順が必要になることもよくあります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-105">Additional administrative steps, such as installing data providers and checking database permissions, are often required for data refresh to succeed.</span></span>

 <span data-ttu-id="ff9dc-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="ff9dc-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>

> [!NOTE]
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="ff9dc-107">および SharePoint Server 2013 の Excel Services では、 [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] データ モデルのデータ更新に新しいアーキテクチャを使用しています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-107">and SharePoint Server 2013 Excel Services use a different architecture for data refresh of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data models.</span></span> <span data-ttu-id="ff9dc-108">新しいアーキテクチャでは、PowerPivot データ モデルを読み込むための主要なコンポーネントとして Excel Services が使用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-108">The new architecture utilizes Excel Services as the primary component to load PowerPivot data models.</span></span> <span data-ttu-id="ff9dc-109">以前に使用されていたデータ更新のアーキテクチャでは、データ モデルを読み込むために、SharePoint モードで PowerPivot System サービスおよび [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] を実行しているサーバーが使用されていました。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-109">The previous data refresh architecture used relied on a server running PowerPivot System Service and [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] in SharePoint mode to load data models.</span></span> <span data-ttu-id="ff9dc-110">詳細については、「 [SharePoint 2013 での PowerPivot データ更新](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-110">For more information, see [PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span></span>

 <span data-ttu-id="ff9dc-111">**このトピックの内容:**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-111">**In this topic:**</span></span>

 [<span data-ttu-id="ff9dc-112">手順 1: Secure Store Service を有効にし、マスターキーを生成する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-112">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>](#bkmk_services)

 [<span data-ttu-id="ff9dc-113">手順 2: サポートしない資格情報オプションの無効化</span><span class="sxs-lookup"><span data-stu-id="ff9dc-113">Step 2: Turn off credential options that you do not want to support</span></span>](#bkmk_creds)

 [<span data-ttu-id="ff9dc-114">手順 3: データ更新で使用される資格情報を保存する対象アプリケーションの作成</span><span class="sxs-lookup"><span data-stu-id="ff9dc-114">Step 3: Create target applications to store credentials used in data refresh</span></span>](#bkmk_stored)

 [<span data-ttu-id="ff9dc-115">手順 4: スケーラブルなデータ更新用のサーバーの構成</span><span class="sxs-lookup"><span data-stu-id="ff9dc-115">Step 4: Configure the server for scalable data refresh</span></span>](#bkmk_scale)

 [<span data-ttu-id="ff9dc-116">手順 5: PowerPivot データのインポートに使用されたデータ プロバイダーのインストール</span><span class="sxs-lookup"><span data-stu-id="ff9dc-116">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>](#bkmk_installdp)

 [<span data-ttu-id="ff9dc-117">手順 6: スケジュールの作成および外部データ ソースへのアクセスのための権限の付与</span><span class="sxs-lookup"><span data-stu-id="ff9dc-117">Step 6: Grant permissions to create schedules and access external data sources</span></span>](#bkmk_accounts)

 [<span data-ttu-id="ff9dc-118">手順 7: データ更新のためのブック アップグレードの有効化</span><span class="sxs-lookup"><span data-stu-id="ff9dc-118">Step 7: Enable workbook upgrade for data refresh</span></span>](#bkmk_upgradewrkbk)

 [<span data-ttu-id="ff9dc-119">手順 8: データ更新の構成の確認</span><span class="sxs-lookup"><span data-stu-id="ff9dc-119">Step 8: Verify data refresh configuration</span></span>](#bkmk_verify)

 [<span data-ttu-id="ff9dc-120">データ更新用の構成設定変更</span><span class="sxs-lookup"><span data-stu-id="ff9dc-120">Modify Configuration Settings for Data Refresh</span></span>](#bkmk_config)

 [<span data-ttu-id="ff9dc-121">PowerPivot データ更新タイマージョブの再スケジュール</span><span class="sxs-lookup"><span data-stu-id="ff9dc-121">Reschedule the PowerPivot Data Refresh timer job</span></span>](#configTimerJob)

 [<span data-ttu-id="ff9dc-122">データ更新タイマー ジョブの無効化</span><span class="sxs-lookup"><span data-stu-id="ff9dc-122">Disable the Data Refresh Timer Job</span></span>](#bkmk_disableDR)

 <span data-ttu-id="ff9dc-123">サーバー環境と権限が構成されていることを確認したら、データ更新を使用できる状態になります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-123">After you ensure that the server environment and permissions are configured, data refresh is ready to use.</span></span> <span data-ttu-id="ff9dc-124">SharePoint ユーザーがデータ更新を使用するには、データ更新の実行頻度を指定したスケジュールを PowerPivot ブックに対して作成します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-124">To use data refresh, a SharePoint user creates a schedule on a PowerPivot workbook that specifies how often data refresh occurs.</span></span> <span data-ttu-id="ff9dc-125">スケジュールの作成は一般的に、ファイルを SharePoint にパブリッシュしたユーザーである、ブックの所有者または作成者が行います。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-125">Creating the schedule is typically done by the workbook owner or author who published the file to SharePoint.</span></span> <span data-ttu-id="ff9dc-126">このユーザーが、自分が所有するブックのデータ更新スケジュールを作成し、管理します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-126">This person creates and manages the data refresh schedules for the workbooks that he or she owns.</span></span> <span data-ttu-id="ff9dc-127">詳細については、「 [&#40;PowerPivot for SharePoint&#41;のデータ更新をスケジュールする](schedule-a-data-refresh-powerpivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-127">For more information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>

##  <a name="step-1-enable-secure-store-service-and-generate-a-master-key"></a><a name="bkmk_services"></a><span data-ttu-id="ff9dc-128">手順 1: Secure Store Service を有効にし、マスターキーを生成する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-128">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>
 <span data-ttu-id="ff9dc-129">PowerPivot のデータ更新は、Secure Store Service に依存して、データ更新ジョブの実行および保存された資格情報を使用する外部データ ソースへの接続に使用する資格情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-129">PowerPivot data refresh depends on Secure Store Service to provide credentials used to run data refresh jobs and to connect to external data sources that use stored credentials.</span></span>

 <span data-ttu-id="ff9dc-130">[新しいサーバー] オプションを使用して PowerPivot for SharePoint をインストールした場合は、Secure Store Service が構成されています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-130">If you installed PowerPivot for SharePoint using the New Server option, the Secure Store Service is configured for you.</span></span> <span data-ttu-id="ff9dc-131">その他のすべてのインストール シナリオに対しては、サービス アプリケーションを作成して構成し、Secure Store Service 用のマスター暗号化キーを生成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-131">For all other installation scenarios, you must create and configure a service application and generate a master encryption key for Secure Store Service.</span></span>

> [!NOTE]
>  <span data-ttu-id="ff9dc-132">Secure Store Service を構成したり Secure Store Service の管理を別のユーザーに委任したりするには、ファームの管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-132">You must be a farm administrator to configure Secure Store Service or delegate Secure Store Service administration to another user.</span></span> <span data-ttu-id="ff9dc-133">サービス アプリケーションを有効にした後に設定を構成または変更するには、サービス アプリケーションの管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-133">You must be a service application administrator to configure or modify settings after it is enabled.</span></span>

1.  <span data-ttu-id="ff9dc-134">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-134">In Central Administration, in Application Management, click **Manage service applications**.</span></span>

2.  <span data-ttu-id="ff9dc-135">[サービスアプリケーション] リボンの [作成] で、[**新規**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-135">In the Service Applications ribbon, in Create, click **New**.</span></span>

3.  <span data-ttu-id="ff9dc-136">[ **Secure Store Service**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-136">Select **Secure Store Service**.</span></span>

4.  <span data-ttu-id="ff9dc-137">[ **Secure Store アプリケーションの作成**] ページで、アプリケーションの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-137">In the **Create Secure Store Application** page, enter a name for the application.</span></span>

5.  <span data-ttu-id="ff9dc-138">[**データベース**] で、このサービスアプリケーションのデータベースをホストする SQL Server インスタンスを指定します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-138">In **Database**, specify the SQL Server instance that will host the database for this service application.</span></span> <span data-ttu-id="ff9dc-139">既定値は、ファーム構成データベースをホストする SQL Server データベース エンジン インスタンスです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-139">The default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span>

6.  <span data-ttu-id="ff9dc-140">[**データベース名**] に、サービスアプリケーションデータベースの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-140">In **Database Name**, enter the name of the service application database.</span></span> <span data-ttu-id="ff9dc-141">既定値は Secure_Store_Service_DB_ \<guid> です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-141">The default value is Secure_Store_Service_DB_\<guid>.</span></span> <span data-ttu-id="ff9dc-142">既定の名前は、既定のサービス アプリケーション名に対応しています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-142">The default name corresponds to the default name of the service application.</span></span> <span data-ttu-id="ff9dc-143">独自のサービス アプリケーション名を入力した場合は、サービス アプリケーションとデータベースを一緒に管理できるように、データベース名に対しても同様の命名規則を使用してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-143">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>

7.  <span data-ttu-id="ff9dc-144">**[データベース認証]** の既定値は、"Windows 認証" です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-144">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="ff9dc-145">"SQL 認証" を選択する場合は、SharePoint 管理者ガイドを参照して、ファームでその認証の種類を使用する方法を確認してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-145">If you choose SQL Authentication, refer to the SharePoint administrator guide for guidance on how to use the authentication type in your farm.</span></span>

8.  <span data-ttu-id="ff9dc-146">[アプリケーションプール] で、[**新しいアプリケーションプールの作成**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-146">In Application Pool, select **Create new application pool.**</span></span> <span data-ttu-id="ff9dc-147">他のサーバー管理者がアプリケーション プールの使用方法を理解できるように、わかりやすい名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-147">Specify a descriptive name that will help other server administrators identify how the application pool is used.</span></span>

9. <span data-ttu-id="ff9dc-148">アプリケーション プールのセキュリティ アカウントを選択します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-148">Select a security account for the application pool.</span></span> <span data-ttu-id="ff9dc-149">ドメイン ユーザー アカウントを使用するマネージド アカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-149">Specify a managed account to use a domain user account.</span></span>

10. <span data-ttu-id="ff9dc-150">残りの既定値をそのまま使用し、[OK] をクリックし**ます。**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-150">Accept the remaining default values, and then click **OK.**</span></span> <span data-ttu-id="ff9dc-151">作成したサービス アプリケーションが、他のマネージド サービスと共にファームのサービス アプリケーションの一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-151">The service application will appear alongside other managed services in the farm's service application list.</span></span>

11. <span data-ttu-id="ff9dc-152">一覧で、Secure Store Service アプリケーションをクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-152">Click the Secure Store Service application from the list.</span></span>

12. <span data-ttu-id="ff9dc-153">[サービスアプリケーション] リボンで、[**管理**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-153">In the Service Applications ribbon, click **Manage**.</span></span>

13. <span data-ttu-id="ff9dc-154">[キー管理] で、[**新しいキーの生成**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-154">In Key Management, click **Generate New Key**.</span></span>

14. <span data-ttu-id="ff9dc-155">パス フレーズを入力し、そのパス フレーズを確認します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-155">Enter and then confirm a pass phrase.</span></span> <span data-ttu-id="ff9dc-156">パス フレーズは、Secure Store 共有サービス アプリケーションを追加するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-156">The pass phrase will be used to add additional secure store shared service applications.</span></span>

15. <span data-ttu-id="ff9dc-157">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-157">Click **OK**.</span></span>

 <span data-ttu-id="ff9dc-158">トラブルシューティングの目的に役立つ Store Service 操作の監査ログを使用可能にするには、事前にこの監査ログを有効にしておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-158">Audit logging of Store Service operations, which is useful for troubleshooting purposes, must be enabled before it is available.</span></span> <span data-ttu-id="ff9dc-159">ログ記録を有効にする方法の詳細については、「 [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-159">For more information about how to enable logging, see [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span></span>

##  <a name="step-2-turn-off-credential-options-that-you-do-not-want-to-support"></a><a name="bkmk_creds"></a><span data-ttu-id="ff9dc-160">手順 2: サポートしない資格情報オプションを無効にする</span><span class="sxs-lookup"><span data-stu-id="ff9dc-160">Step 2: Turn off credential options that you do not want to support</span></span>
 <span data-ttu-id="ff9dc-161">PowerPivot データ更新には、データ更新スケジュールに 3 つの資格情報オプションが用意されています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-161">PowerPivot data refresh provides three credential options in a data refresh schedule.</span></span> <span data-ttu-id="ff9dc-162">ブックの所有者がデータ更新をスケジュールする際には、これらのオプションの 1 つを選択して、データ更新ジョブの実行に使用するアカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-162">When a workbook owner schedules data refresh, he or she chooses one of these options, thereby determining the account under which the data refresh job runs.</span></span> <span data-ttu-id="ff9dc-163">管理者は、スケジュールの所有者がどの資格情報オプションを使用できるかを決定できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-163">As an administrator, you can determine which credential options are available to schedule owners.</span></span>

 <span data-ttu-id="ff9dc-164">データ更新が動作するためには、少なくとも 1 つのオプションが使用可能になっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-164">You must have at least one option that is available in order for data refresh to work.</span></span>

 <span data-ttu-id="ff9dc-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="ff9dc-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="ff9dc-166">オプション 1 [**管理者によって構成されたデータ更新アカウントを使用する**] は、[スケジュールの定義] ページに常に表示されますが、自動データ更新アカウントを構成した場合にのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-166">Option 1, **Use the data refresh account configured by the administrator**, always appears on the schedule definition page, but only works if you configure the unattended data refresh account.</span></span> <span data-ttu-id="ff9dc-167">アカウントの作成方法の詳細については、「 [PowerPivot 自動データ更新アカウントの構成 &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-167">For more information on how to create the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="ff9dc-168">オプション 2 [**次の windows 資格情報を使用して接続**する] は常にページに表示されますが、[サービスアプリケーションの構成] ページで [**ユーザーがカスタム windows 資格情報を入力できるよう**にする] オプションを有効にした場合にのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-168">Option 2, **Connect using the following windows credentials**, always appears on the page, but only works when you enable the **Allow users to enter custom Windows credentials** option in the service application configuration page.</span></span> <span data-ttu-id="ff9dc-169">このオプションは既定で有効になりますが、これを使用するデメリットがメリットよりも大きい場合は無効にできます (下記を参照)。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-169">This option is enabled by default, but you can disable it if the disadvantages of using it outweigh the advantages (see below).</span></span>

 <span data-ttu-id="ff9dc-170">オプション3では、 **Secure Store Service に保存されている資格情報を使用して接続**します。このページには常に表示されますが、スケジュール所有者が有効な対象アプリケーションを提供する場合にのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-170">Option 3, **Connect using the credentials saved in Secure Store Service**, always appears on the page, but only works when a schedule owner provides a valid target application.</span></span> <span data-ttu-id="ff9dc-171">管理者は、あらかじめこれらの対象アプリケーションを作成してから、データ更新スケジュールを作成するユーザーにアプリケーション名を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-171">An administrator must create these target applications in advance and then provide the application name to those who create the data refresh schedules.</span></span> <span data-ttu-id="ff9dc-172">データ更新操作の対象アプリケーションを作成する方法の詳細については、「 [PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-172">For more information on how to create a target application for data refresh operations, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="ff9dc-173">**資格情報オプション2、[次の Windows ユーザー資格情報を使用して接続する] を構成する**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-173">**Configuring credential option 2, "Connect using the following Windows user credentials"**</span></span>

 <span data-ttu-id="ff9dc-174">PowerPivot サービス アプリケーションには、スケジュール所有者がデータ更新ジョブの実行用の任意の Windows ユーザー名およびパスワードを入力できる資格情報オプションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-174">PowerPivot service application includes a credential option that allows schedule owners to enter an arbitrary Windows user name and password for running a data refresh job.</span></span> <span data-ttu-id="ff9dc-175">これは、スケジュール定義ページの第 2 の資格情報オプションです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-175">This is the second credential option in the schedule definition page:</span></span>

 <span data-ttu-id="ff9dc-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="ff9dc-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span></span>

 <span data-ttu-id="ff9dc-177">この資格情報オプションは、既定で有効になります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-177">This credential option is enabled by default.</span></span> <span data-ttu-id="ff9dc-178">この資格情報オプションが有効になっている場合、PowerPivot System サービスでは Secure Store Service に対象アプリケーションが生成され、スケジュール所有者が入力したユーザー名とパスワードが保存されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-178">When this credential option is enabled, PowerPivot System Service will generate a target application in Secure Store Service to store the user name and password entered by the schedule owner.</span></span> <span data-ttu-id="ff9dc-179">生成された対象アプリケーションは、PowerPivotDataRefresh_ という名前付け規則を使用して作成され \<guid> ます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-179">A generated target application is created using this naming convention: PowerPivotDataRefresh_\<guid>.</span></span> <span data-ttu-id="ff9dc-180">Windows 資格情報のセットごとに 1 つの対象アプリケーションが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-180">One target application is created for each set of Windows credentials.</span></span> <span data-ttu-id="ff9dc-181">PowerPivot System サービスによって所有されている対象アプリケーションが既に存在し、スケジュールを定義するユーザーが入力したユーザー名とパスワードを保存する場合、PowerPivot System サービスでは新しい対象アプリケーションを作成する代わりにその対象アプリケーションが使用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-181">If a target application already exists that is owned by the PowerPivot System Service and stores the username and password entered by the person defining the schedule, PowerPivot System Service will use that target application rather than create a new one.</span></span>

 <span data-ttu-id="ff9dc-182">この資格情報オプションを使用する主な利点は、使いやすく簡単であることです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-182">The primary advantage of using this credential option is ease of use and simplicity.</span></span> <span data-ttu-id="ff9dc-183">対象アプリケーションが自動的に作成されるため、高度な作業は最小限です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-183">Advance work is minimal because target applications are created for you.</span></span> <span data-ttu-id="ff9dc-184">また、スケジュール所有者 (多くの場合、ブックを作成したユーザー) の資格情報で更新を実行すると、下流の権限要件が簡略化されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-184">Also, running data refresh under the credentials of the schedule owner (who is most likely the person who created the workbook) simplifies permission requirements downstream.</span></span> <span data-ttu-id="ff9dc-185">ほとんどの場合、このユーザーは対象データベースに対する権限を既に持っています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-185">Most likely, this user already has permissions on the target database.</span></span> <span data-ttu-id="ff9dc-186">データ更新がこのユーザーの Windows ユーザー id で実行されると、"現在のユーザー" を指定しているすべてのデータ接続が自動的に動作します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-186">When data refresh runs under this person's Windows user identity, any data connections that specify 'current user' will work automatically.</span></span>

 <span data-ttu-id="ff9dc-187">欠点は、管理機能が制限されていることです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-187">The disadvantage is limited management capability.</span></span> <span data-ttu-id="ff9dc-188">対象アプリケーションは自動的に作成されますが、アカウント情報が変更されたときに自動的な削除や更新は行われません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-188">Although target applications are created automatically, they are not deleted automatically or updated as account information changes.</span></span> <span data-ttu-id="ff9dc-189">パスワード有効期限ポリシーが原因で、これらの対象アプリケーションが古くなることがあります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-189">Password expiration policies might cause these target applications to become out of date.</span></span> <span data-ttu-id="ff9dc-190">期限切れの資格情報を使用するデータ更新ジョブの開始は失敗します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-190">Data refresh jobs that use expired credentials will start to fail.</span></span> <span data-ttu-id="ff9dc-191">この状況が発生した場合、スケジュール所有者は、データ更新スケジュールの現在のユーザー名およびパスワード値を提供することで資格情報を更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-191">When this occurs, schedule owners will need to update their credentials by providing current user name and password values in a data refresh schedule.</span></span> <span data-ttu-id="ff9dc-192">その時点で新しい対象アプリケーションが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-192">A new target application will be created at that point.</span></span> <span data-ttu-id="ff9dc-193">ユーザーは時間の経過と共にデータ更新スケジュールの資格情報を追加および改訂するため、自動生成された対象アプリケーションがシステムに多数存在することがあります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-193">Over time, as users add and revise credential information in their data refresh schedules, you might find that you have a large number of auto-generated target applications on your system.</span></span>

 <span data-ttu-id="ff9dc-194">現在、これらの対象アプリケーションがアクティブか非アクティブかを判断する方法はなく、特定の対象アプリケーションを使用するデータ更新スケジュールをトレースする方法もありません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-194">Currently, there is no way to determine which of these target applications are active or inactive, nor is there a way to trace a specific target application back to the data refresh schedules that use it.</span></span> <span data-ttu-id="ff9dc-195">一般に、対象アプリケーションを削除すると既存のデータ更新スケジュールが破損する可能性があるため、対象アプリケーションは残しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-195">In general, you should leave the target applications alone, as deleting them might break existing data refresh schedules.</span></span> <span data-ttu-id="ff9dc-196">まだ使用されている対象アプリケーションを削除すると、ブックの [データ更新の履歴] ページに "ターゲットアプリケーションが見つかりません" というメッセージが表示され、データ更新が失敗します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-196">Deleting a target application that is still in use will cause data refresh to fail with the message, "Target application not found", appearing in the data refresh history page of the workbook.</span></span>

 <span data-ttu-id="ff9dc-197">この資格情報オプションを無効にすることを選択した場合は、PowerPivot データ更新用に生成されたすべての対象アプリケーションを安全に削除できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-197">Should you choose to disable this credential option, you can safely delete all of the target applications that were generated for PowerPivot data refresh.</span></span>

 <span data-ttu-id="ff9dc-198">**データ更新スケジュールでの任意の Windows 資格情報の使用の無効化**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-198">**Disabling the use of arbitrary Windows credentials in data refresh schedules**</span></span>

1.  <span data-ttu-id="ff9dc-199">サーバーの全体管理で、[アプリケーション管理] の [**サービスアプリケーションの管理**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-199">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="ff9dc-200">PowerPivot サービス アプリケーションの名前をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-200">Click the PowerPivot service application name.</span></span> <span data-ttu-id="ff9dc-201">PowerPivot 管理ダッシュボードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-201">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="ff9dc-202">[アクション] で [**サービスアプリケーションの設定の構成**] をクリックして、[PowerPivot サービスアプリケーションの設定] ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-202">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="ff9dc-203">[データ更新] セクションで、[**ユーザーがカスタムの Windows 資格情報を入力できるように**する] チェックボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-203">In the Data Refresh section, clear the **Allow users to enter custom Windows credentials** checkbox.</span></span>

     <span data-ttu-id="ff9dc-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span><span class="sxs-lookup"><span data-stu-id="ff9dc-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span></span>

##  <a name="step-3-create-target-applications-to-store-credentials-used-in-data-refresh"></a><a name="bkmk_stored"></a><span data-ttu-id="ff9dc-205">手順 3: データ更新で使用される資格情報を格納する対象アプリケーションを作成する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-205">Step 3: Create target applications to store credentials used in data refresh</span></span>
 <span data-ttu-id="ff9dc-206">Secure Store Service が構成されると、SharePoint 管理者は、保存された資格情報をデータ更新に使用できるようにする対象アプリケーションを作成できます。この資格情報には、PowerPivot 自動データ更新アカウントや、ジョブの実行または外部データ ソースへの接続に使用されるその他のアカウントが含まれます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-206">Once Secure Store Service is configured, SharePoint administrators can create target applications to make stored credentials available for data refresh purposes, including the PowerPivot unattended data refresh account or any other account that is used to either run the job or connect to external data sources.</span></span>

 <span data-ttu-id="ff9dc-207">前のセクションで説明したように、特定の資格情報オプションを使用可能にするには対象アプリケーションを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-207">Recall from the previous section that you need to create target applications in order for certain credential options to be usable.</span></span> <span data-ttu-id="ff9dc-208">具体的には、PowerPivot 自動データ更新アカウント用の対象アプリケーションに加えて、データ更新操作で使用する追加の保存された資格情報を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-208">Specifically, you must create target applications for the PowerPivot unattended data refresh account, plus any additional stored credentials that you expect would be used in data refresh operations.</span></span>

 <span data-ttu-id="ff9dc-209">保存された資格情報を含む対象アプリケーションを作成する方法の詳細については、「powerpivot[自動データ更新アカウントの構成 &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)および[Powerpivot データ &#40;更新用の保存された資格情報の構成」 PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-209">For more information about how to create target applications that contain stored credentials, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) and [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

##  <a name="step-4-configure-the-server-for-scalable-data-refresh"></a><a name="bkmk_scale"></a><span data-ttu-id="ff9dc-210">手順 4: スケーラブルなデータ更新用にサーバーを構成する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-210">Step 4: Configure the server for scalable data refresh</span></span>
 <span data-ttu-id="ff9dc-211">既定では、PowerPivot for SharePoint の各インストールで、オンデマンド クエリとスケジュールされたデータ更新の両方がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-211">By default, each PowerPivot for SharePoint installation supports both on-demand queries and scheduled data refresh.</span></span>

 <span data-ttu-id="ff9dc-212">インストールごとに、Analysis Services サーバー インスタンスがクエリとスケジュールされたデータ更新の両方をサポートするか、特定の種類の操作専用であるかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-212">For each installation, you can specify whether the Analysis Services server instance supports both query and scheduled data refresh, or is dedicated to a specific type of operation.</span></span> <span data-ttu-id="ff9dc-213">ファームに PowerPivot for SharePoint が複数インストールされている場合に、ジョブが遅延または失敗していることがわかったときには、サーバーをデータ更新操作専用にすることを検討できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-213">If you have multiple installations of PowerPivot for SharePoint in your farm, you might consider dedicating a server for just data refresh operations if you find that jobs are delayed or failing.</span></span>

 <span data-ttu-id="ff9dc-214">また、基になるハードウェアでサポートされている場合は、並列に実行するデータ更新ジョブの数を増やすことができます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-214">Additionally, if the underlying hardware supports it, you can increase the number of data refresh jobs that run in parallel.</span></span> <span data-ttu-id="ff9dc-215">既定では、並列に実行できるジョブの数はシステム メモリに基づいて計算されますが、ワークロードをサポートする追加の CPU 容量がある場合はこの数を増やすことができます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-215">By default, the number of jobs that can run in parallel is calculated based on system memory, but you can increase that number if you have additional CPU capacity to support the workload.</span></span>

 <span data-ttu-id="ff9dc-216">詳細については、「[専用データ更新の構成」または「クエリ専用処理の &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-216">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span>

##  <a name="step-5-install-data-providers-used-to-import-powerpivot-data"></a><a name="bkmk_installdp"></a><span data-ttu-id="ff9dc-217">手順 5: PowerPivot データをインポートするために使用するデータプロバイダーをインストールする</span><span class="sxs-lookup"><span data-stu-id="ff9dc-217">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>
 <span data-ttu-id="ff9dc-218">データ更新操作は、基本的には元のデータを取得したインポート操作の繰り返しです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-218">A data refresh operation is essentially a repeat of an import operation that retrieved the original data.</span></span> <span data-ttu-id="ff9dc-219">つまり、PowerPivot クライアント アプリケーションでデータのインポートに使用されたデータ プロバイダーを、PowerPivot サーバーにもインストールする必要があるということです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-219">This means that the same data providers used to import the data in the PowerPivot client application must also be installed on the PowerPivot server.</span></span>

 <span data-ttu-id="ff9dc-220">Windows サーバーにデータ プロバイダーをインストールするには、ローカル管理者である必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-220">You must be a local administrator to install data providers on a Windows server.</span></span> <span data-ttu-id="ff9dc-221">追加のドライバーをインストールする場合は、必ず PowerPivot for SharePoint がインストールされている SharePoint ファーム内の各コンピューターにインストールします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-221">If you install additional drivers, be sure to install them on each computer in the SharePoint farm that has an installation of PowerPivot for SharePoint.</span></span> <span data-ttu-id="ff9dc-222">ファームに複数の PowerPivot サーバーがある場合は、それぞれのサーバーにプロバイダーをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-222">If you have multiple PowerPivot servers in the farm, you must install the providers on each one.</span></span>

 <span data-ttu-id="ff9dc-223">SharePoint サーバーは 64 ビット アプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-223">Remember that SharePoint servers are 64-bit applications.</span></span> <span data-ttu-id="ff9dc-224">データ更新操作をサポートするには、使用しているデータ プロバイダーの 64 ビット バージョンをインストールしてください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-224">Be sure to install the 64-bit version of the data providers you are using to support data refresh operations.</span></span>

##  <a name="step-6-grant-permissions-to-create-schedules-and-access-external-data-sources"></a><a name="bkmk_accounts"></a><span data-ttu-id="ff9dc-225">手順 6: スケジュールを作成し、外部データソースにアクセスするためのアクセス許可を付与する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-225">Step 6: Grant permissions to create schedules and access external data sources</span></span>
 <span data-ttu-id="ff9dc-226">ブックに対するデータ更新をスケジュールするには、ブックの所有者または作成者が **投稿** 権限を持っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-226">Workbook owners or authors must have **Contribute** permission to schedule data refresh on a workbook.</span></span> <span data-ttu-id="ff9dc-227">この権限レベルでは、ブックの [データ更新の構成] ページを開いて編集し、データの更新に使用する資格情報とスケジュール情報を指定できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-227">Given this permission level, he or she can open and edit the workbook's data refresh configuration page to specify the credentials and schedule information used to refresh the data.</span></span>

 <span data-ttu-id="ff9dc-228">SharePoint 権限に加えて、外部データ ソースに対するデータベース権限を確認して、データ更新中に使用されるアカウントにデータへの十分なアクセス権があることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-228">In addition to SharePoint permissions, database permissions on external data sources must also be reviewed to ensure that accounts used during data refresh have sufficient access rights to the data.</span></span> <span data-ttu-id="ff9dc-229">付与する必要のある権限は、ブック内の接続文字列およびデータ更新ジョブの実行に使用しているユーザー ID によって異なるため、権限要件を判断するには自身を慎重に評価する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-229">Determining permission requirements will require careful evaluation on your part because the permissions that you need to grant will vary depending on the connection string in the workbook and the user identity under which the data refresh job is running.</span></span>

 <span data-ttu-id="ff9dc-230">**PowerPivot ブック内の既存の接続文字列が PowerPivot データ更新操作に関係する理由**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-230">**Why existing connection strings in a PowerPivot workbook matter to PowerPivot data refresh operations**</span></span>

 <span data-ttu-id="ff9dc-231">データ更新の実行時に、サーバーはデータが最初にインポートされたときに作成された接続文字列を使用して外部データ ソースに接続要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-231">When data refresh runs, the server sends a connection request to the external data source using the connection string that was created when the data was originally imported.</span></span> <span data-ttu-id="ff9dc-232">その接続文字列で指定されたサーバーの場所、データベース名、および認証パラメーターは、同じデータ ソースにアクセスするためにデータ更新時に再利用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-232">The server location, database name, and authentication parameters specified in that connection string are now reused during data refresh to access the same data sources.</span></span> <span data-ttu-id="ff9dc-233">接続文字列とその全体的な構造は、データ更新の目的では変更できません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-233">The connection string and its overall construction cannot be modified for data refresh purposes.</span></span> <span data-ttu-id="ff9dc-234">データ更新時にはそのまま再利用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-234">It is simply reused as-is during data refresh.</span></span> <span data-ttu-id="ff9dc-235">Windows 以外の認証を使用してデータ ソースに接続する場合は、接続文字列のユーザー名とパスワードをオーバーライドできることがあります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-235">In some cases, if you are using non-Windows authentication to connect to a data source, you can override the user name and password in the connection string.</span></span> <span data-ttu-id="ff9dc-236">この詳細については、このトピックで説明します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-236">More detail about this is provided further on in this topic.</span></span>

 <span data-ttu-id="ff9dc-237">ほとんどのブックでは、接続の既定の認証オプションで信頼関係接続または Windows 統合セキュリティが使用されるため、結果として接続文字列には `SSPI=IntegratedSecurity` または `SSPI=TrustedConnection` が含まれます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-237">For most workbooks, the default authentication option on the connection is to use trusted connections or Windows integrated security, resulting in connection strings that include `SSPI=IntegratedSecurity` or `SSPI=TrustedConnection`.</span></span> <span data-ttu-id="ff9dc-238">データ更新中にこの接続文字列を使用すると、データ更新ジョブの実行に使用されるアカウントが "現在のユーザー" になります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-238">When this connection string is used during data refresh, the account used to run the data refresh job becomes the 'current user'.</span></span> <span data-ttu-id="ff9dc-239">そのため、このアカウントには、信頼関係接続を介してアクセスされる外部データ ソースに対する読み取り権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-239">As such, this account needs read permissions on any external data source that is accessed via a trusted connection.</span></span>

 <span data-ttu-id="ff9dc-240">**PowerPivot 自動データ更新アカウントを有効にしたか**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-240">**Did you enable the PowerPivot unattended data refresh account?**</span></span>

 <span data-ttu-id="ff9dc-241">有効にした場合は、データ更新中にアクセスされるデータ ソースに対する読み取り権限をそのアカウントに付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-241">If yes, then you should grant that account read permissions on data sources that are accessed during data refresh.</span></span> <span data-ttu-id="ff9dc-242">このアカウントが読み取り権限を必要とする理由は、既定の認証オプションを使用するブックで、データ更新中に自動アカウントが "現在のユーザー" になるためです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-242">The reason why this account needs read permissions is because in a workbook that uses the default authentication options, the unattended account will be the 'current user' during data refresh.</span></span> <span data-ttu-id="ff9dc-243">スケジュール所有者が接続文字列で資格情報をオーバーライドしない限り、このアカウントには、組織でアクティブに使用されている任意の数のデータ ソースに対する読み取り権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-243">Unless the schedule owner overrides the credentials in the connection string, this account will need read permissions on any number of data sources that are actively used in your organization.</span></span>

 <span data-ttu-id="ff9dc-244">**資格情報オプション 2 (スケジュール所有者に Windows ユーザー名とパスワードの入力を許可する) を使用しているか**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-244">**Are you using credential option 2: allowing the schedule owner to enter a Windows user name and password?**</span></span>

 <span data-ttu-id="ff9dc-245">通常、PowerPivot ブックを作成するユーザーは、最初にデータを既にインポートしているため、十分な権限を既に持っています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-245">Typically, users who create PowerPivot workbooks already have sufficient permissions because he or she already imported the data in the first place.</span></span> <span data-ttu-id="ff9dc-246">その後これらのユーザーが自身の Windows ユーザー ID で実行するようにデータ更新を構成した場合、データベースに対する権限を既に持っている Windows ユーザー アカウントがデータ更新中のデータの取得に使用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-246">If these users subsequently configure data refresh to run under their own Windows user identity, their Windows user account, which already has rights on the database, will be used to retrieve data during data refresh.</span></span> <span data-ttu-id="ff9dc-247">既存の権限で十分です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-247">Existing permissions should be sufficient.</span></span>

 <span data-ttu-id="ff9dc-248">**資格情報オプション 3: (Secure Store Service 対象アプリケーションを使用してデータ更新ジョブの実行用のユーザー ID を提供する) を使用しているか**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-248">**Are you using credential option 3: using a Secure Store Service target application to provide a user identity for running data refresh jobs?**</span></span>

 <span data-ttu-id="ff9dc-249">データ更新ジョブの実行に使用するアカウントには、PowerPivot 自動データ更新アカウントについて説明したのと同じ理由で読み取り権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-249">Any account used to run a data refresh job needs read permissions, for the same reasons as those described for the PowerPivot unattended data refresh account.</span></span>

 <span data-ttu-id="ff9dc-250">**接続文字列を確認して、データ更新中に使用する資格情報をオーバーライドできるかどうかを判断する方法**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-250">**How to check connection strings to determine whether you can override credentials used during data refresh**</span></span>

 <span data-ttu-id="ff9dc-251">前に述べたように、接続で Windows 以外の認証 (SQL Server 認証など) を使用している場合は、データ更新ジョブのレベルで別のユーザー名とパスワードに置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-251">As previously noted, you can substitute a different user name and password at the data refresh job level if the connection is using non-Windows authentication (for example, SQL Server authentication).</span></span> <span data-ttu-id="ff9dc-252">Windows 以外の資格情報は、UserID および Password パラメーターを使用して接続文字列で渡されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-252">Non-Windows credentials are passed on the connection string using the User ID and Password parameters.</span></span> <span data-ttu-id="ff9dc-253">これらのパラメーターを含む接続文字列がブックに含まれている場合は、オプションでデータ ソースからのデータの更新に別のユーザー名とパスワードを指定できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-253">If your workbook contains a connection string with these parameters, you can optionally specify a different user name and password for refreshing data from that data source.</span></span>

 <span data-ttu-id="ff9dc-254">次の手順では、ユーザー名とパスワードのオーバーライドを受け入れる接続文字列があるかどうかを確認する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-254">The following steps explain how to determine whether you have a connection string that accepts user name and password overrides.</span></span>

1.  <span data-ttu-id="ff9dc-255">Excel でブックを開きます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-255">Open the workbook in Excel.</span></span>

2.  <span data-ttu-id="ff9dc-256">PowerPivot ウィンドウを開きます (Excel の PowerPivot リボンで [PowerPivot ウィンドウ] をクリックします)。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-256">Open the PowerPivot window (in Excel, on the PowerPivot ribbon, click PowerPivot Window).</span></span>

3.  <span data-ttu-id="ff9dc-257">[**デザイン**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-257">Click **Design**.</span></span>

4.  <span data-ttu-id="ff9dc-258">[**既存の接続**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-258">Click **Existing Connections**.</span></span>

     <span data-ttu-id="ff9dc-259">ブックで使用されているすべての接続が [ **PowerPivot データ接続**] の下に一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-259">All of the connections used in the workbook are listed under **PowerPivot Data Connections**.</span></span>

5.  <span data-ttu-id="ff9dc-260">接続を選択し、[**編集**] をクリックして、[**詳細設定**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-260">Select the connection and click **Edit**, and then click **Advanced**.</span></span> <span data-ttu-id="ff9dc-261">接続文字列はページの下部にあります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-261">The connection string is at the bottom of the page.</span></span>

 <span data-ttu-id="ff9dc-262">接続文字列に**Integrated Security = SSPI**が表示されている場合は、接続文字列の資格情報を上書きすることはできません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-262">If you see **Integrated Security=SSPI** in the connection string, you cannot override the credentials in the connection string.</span></span> <span data-ttu-id="ff9dc-263">接続では常に現在のユーザーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-263">The connection will always use the current user.</span></span> <span data-ttu-id="ff9dc-264">指定した資格情報は無視されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-264">Any credentials that you provide are ignored.</span></span>

 <span data-ttu-id="ff9dc-265">\*\*Persist Security Info = False、Password = \* \* \* \* \* \* \* \* \* \* \* 、UserID = \<userlogin> \*\*の場合は、資格情報の上書きを受け入れる接続文字列があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-265">If you see **Persist Security Info=False, Password=\*\*\*\*\*\*\*\*\*\*\*, UserID=\<userlogin>**,then you have a connection string that will accept credential overrides.</span></span> <span data-ttu-id="ff9dc-266">接続文字列に表示される資格情報 (UserID や Password など) は、Windows 資格情報ではなく、対象のデータ ソースに対して有効なデータベース ログインまたはその他のサインイン アカウントです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-266">Credentials that appear in a connection string (such as UserID and Password) are not Windows credentials, but rather database logins or other sign-in accounts that are valid for the target data source.</span></span>

 <span data-ttu-id="ff9dc-267">**接続文字列の資格情報をオーバーライドする方法**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-267">**How to override credentials in the connection string**</span></span>

 <span data-ttu-id="ff9dc-268">資格情報のオーバーライドは、データ更新スケジュールでデータ ソース資格情報を指定することで行います。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-268">Overriding credentials is done by specifying data source credentials in the data refresh schedule.</span></span> <span data-ttu-id="ff9dc-269">管理者は、外部データへのアクセスに使用する資格情報をマップする対象アプリケーションを Secure Store Service で提供できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-269">As an administrator, you can provide a target application in Secure Store Service that maps the credentials used to access external data.</span></span> <span data-ttu-id="ff9dc-270">これにより、スケジュール所有者は、定義するデータ更新スケジュールに対象アプリケーション ID を入力することができます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-270">The schedule owner can then enter the target application ID in the data refresh schedule that he or she defines.</span></span> <span data-ttu-id="ff9dc-271">この対象アプリケーションの作成の詳細については、「 [PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-271">For more information about creating this target application, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="ff9dc-272">または、スケジュール所有者は、データ更新中にデータ ソースへの接続に使用される資格情報のセットを入力できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-272">Alternatively, the schedule owner can type in the set of credentials that are used to connect to data sources during data refresh.</span></span> <span data-ttu-id="ff9dc-273">次の図に、スケジュール定義ページのこのデータ ソース オプションを示します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-273">The following illustration shows this data source option in the schedule definition page.</span></span>

 <span data-ttu-id="ff9dc-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span><span class="sxs-lookup"><span data-stu-id="ff9dc-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span></span>

 <span data-ttu-id="ff9dc-275">**データ アクセス要件の識別**</span><span class="sxs-lookup"><span data-stu-id="ff9dc-275">**Identifying data access requirements**</span></span>

 <span data-ttu-id="ff9dc-276">前のセクションに示したように、多くの場合、データ更新の実行と外部データ ソースへの接続に使用されるアカウントは 1 つの同じアカウントです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-276">As noted in previous sections, the account used to run data refresh and connect to external data sources is often one and the same.</span></span> <span data-ttu-id="ff9dc-277">そのため、外部データ ソースへのアクセスに使用されるアカウントは、データ更新スケジュール ページのこの部分のオプション セットによって決定されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-277">As such, the account used to access external data sources is determined by the options set in this part of the data refresh schedule page.</span></span> <span data-ttu-id="ff9dc-278">これは、PowerPivot 自動データ更新アカウント、個々のユーザーの Windows アカウント、または定義済み対象アプリケーションに保存されているアカウントの場合があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-278">This might be the PowerPivot unattended data refresh account, the Windows account of an individual user, or the account that is stored in a predefined target application.</span></span>

 <span data-ttu-id="ff9dc-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="ff9dc-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="ff9dc-280">データ更新の実行に使用されるアカウントが、データのインポートに使用されるアカウントと異なる場合 (たとえば、資格情報オプション 1 による PowerPivot 自動データ更新アカウント、または資格情報オプション 3 による保存された資格情報の他のセット)、そのアカウント用に新しいデータベース ログインを作成し、外部データ ソースに対する読み取り権限を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-280">In cases where the account used to run data refresh is different from the account used to import data (for example, the PowerPivot unattended data refresh account via credential option one, or some other set of stored credentials via credential option three), you will need to create a new database login for that account and grant it read permissions on the external data sources.</span></span>

 <span data-ttu-id="ff9dc-281">どのアカウントにデータ アクセスが必要かを理解した後で、PowerPivot ブックで最も頻繁に使用されるデータ ソースに対する権限のチェックを開始できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-281">Once you understand which accounts require data access, you can begin to check permissions on the data sources that are most often used in PowerPivot workbooks.</span></span> <span data-ttu-id="ff9dc-282">アクティブに使用されている任意のデータ ウェアハウスまたはレポート データベースから開始しますが、最もアクティブな PowerPivot ユーザーからの入力も要求して、そのユーザーが使用しているデータ ソースを調べます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-282">Start with any data warehouses or reporting databases that are actively used, but also solicit input from your most active PowerPivot users to find out which data sources they are using.</span></span> <span data-ttu-id="ff9dc-283">データ ソースの一覧を入手したら、各データ ソースのチェックを開始して、権限が正しく設定されていることを確認できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-283">Once you have a list of data sources, you can begin checking each one to ensure that permissions are set correctly.</span></span>

##  <a name="step-7-enable-workbook-upgrade-for-data-refresh"></a><a name="bkmk_upgradewrkbk"></a><span data-ttu-id="ff9dc-284">手順 7: データ更新のためにブックのアップグレードを有効にする</span><span class="sxs-lookup"><span data-stu-id="ff9dc-284">Step 7: Enable workbook upgrade for data refresh</span></span>
 <span data-ttu-id="ff9dc-285">既定では、[!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] バージョンの PowerPivot for Excel を使用して作成されたブックに対して、[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] バージョンの PowerPivot for SharePoint 上で定期データ更新を構成することはできません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-285">By default, workbooks that were created using the [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel cannot be configured for scheduled data refresh on a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version of PowerPivot for SharePoint.</span></span> <span data-ttu-id="ff9dc-286">SharePoint 環境で新しいバージョンと古いバージョンの PowerPivot ブックをホストしている場合は、[!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] ブックをアップグレードしてからでなければ、サーバーでの自動データ更新をスケジュールすることはできません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-286">If you host newer and older versions of PowerPivot workbooks in your SharePoint environment, you must upgrade any [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] workbooks first before they can be scheduled for automatic data refresh on the server.</span></span>

##  <a name="step-8-verify-data-refresh-configuration"></a><a name="bkmk_verify"></a><span data-ttu-id="ff9dc-287">手順 8: データ更新の構成を確認する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-287">Step 8: Verify data refresh configuration</span></span>
 <span data-ttu-id="ff9dc-288">データ更新を確認するには、SharePoint サイトにパブリッシュされる PowerPivot ブックが必要です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-288">To verify data refresh, you must have a PowerPivot workbook that is published to a SharePoint site.</span></span> <span data-ttu-id="ff9dc-289">ブックに対する投稿権限と、データ更新スケジュールに含まれているデータ ソースへのアクセス権が必要です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-289">You must have Contribute permissions on the workbook and permissions to access any data sources that are included in the data refresh schedule.</span></span>

 <span data-ttu-id="ff9dc-290">スケジュールを作成するときに、[直**ちに更新**する] チェックボックスをオンにして、データ更新をすぐに実行します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-290">When you create the schedule, select the **Also refresh as soon as possible** checkbox to run data refresh immediately.</span></span> <span data-ttu-id="ff9dc-291">その後、そのブックのデータ更新履歴ページをチェックして、正常に実行されたことを確認します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-291">You can then check the data refresh history page of that workbook to verify that it ran successfully.</span></span> <span data-ttu-id="ff9dc-292">PowerPivot データ更新タイマー ジョブは 1 分おきに実行されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-292">Recall that the PowerPivot Data Refresh timer job runs every minute.</span></span> <span data-ttu-id="ff9dc-293">データ更新に成功したことを確認するには、それ以上の時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-293">It will take at least that long to get confirmation that data refresh succeeded.</span></span>

 <span data-ttu-id="ff9dc-294">サポートを計画しているすべての資格情報オプションを試してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-294">Be sure to try all of the credential options you plan to support.</span></span> <span data-ttu-id="ff9dc-295">たとえば、PowerPivot 自動データ更新アカウントを構成した場合は、そのオプションを使用して、データ更新が成功することを確認します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-295">For example, if you configured the PowerPivot unattended data refresh account, verify that data refresh succeeds using that option.</span></span> <span data-ttu-id="ff9dc-296">ステータス情報のスケジュール設定と表示の詳細については、「 [PowerPivot for SharePoint&#41;&#40;データ更新のスケジュール設定](schedule-a-data-refresh-powerpivot-for-sharepoint.md)」および「 [PowerPivot for SharePoint&#41;のデータ更新の &#40;履歴の表示](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-296">For more information about scheduling and viewing status information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) and [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="ff9dc-297">データ更新が失敗した場合は、TechNet wiki の「 [PowerPivot データ更新のトラブルシューティング](https://go.microsoft.com/fwlink/?LinkID=223279)」ページで解決策を確認してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-297">If data refresh fails, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>

##  <a name="modify-configuration-settings-for-data-refresh"></a><a name="bkmk_config"></a><span data-ttu-id="ff9dc-298">データ更新の構成設定を変更する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-298">Modify Configuration Settings for Data Refresh</span></span>
 <span data-ttu-id="ff9dc-299">各 PowerPivot サービス アプリケーションには、データ更新操作に影響する構成設定が備えられています。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-299">Each PowerPivot service application has configuration settings that affect data refresh operations.</span></span> <span data-ttu-id="ff9dc-300">ここでは、これらの設定を変更する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-300">This section explains how to modify those settings.</span></span>

###  <a name="set-business-hours-to-determine-off-hours-processing"></a><a name="procIntervals"></a><span data-ttu-id="ff9dc-301">"営業時間" を設定して、時間外の処理を決定します</span><span class="sxs-lookup"><span data-stu-id="ff9dc-301">Set 'Business Hours' to determine off-hours processing</span></span>
 <span data-ttu-id="ff9dc-302">データ更新操作をスケジュールする SharePoint ユーザーは、"営業時間後" の最も早い時刻を開始時刻として指定することができます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-302">SharePoint users who schedule data refresh operations can specify an earliest start time of "After business hours".</span></span> <span data-ttu-id="ff9dc-303">これは、営業時間内に蓄積されたビジネス トランザクション データを取得する場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-303">This may be useful if they want to retrieve business transaction data that accumulated during the business day.</span></span> <span data-ttu-id="ff9dc-304">ファームの管理者は、組織の営業時間を最もよく定義する時間の範囲を指定できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-304">As a farm administrator, you can specify the range of hours that best defines a business day for your organization.</span></span> <span data-ttu-id="ff9dc-305">営業時間を 04:00 ～ 20:00 と定義した場合、"営業時間後" の開始時刻に基づくデータ更新処理は 20:01 に開始されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-305">If you define the business day to be from 04:00 to 20:00, then data refresh processing that is based on an "After business hours" start time will begin at 20:01.</span></span>

 <span data-ttu-id="ff9dc-306">営業時間外に実行されるデータ更新要求は、受信された順にキューに追加されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-306">Data refresh requests that run during off-hours are added to the queue in the order in which the request is received.</span></span> <span data-ttu-id="ff9dc-307">個々の要求は、サーバー リソースが使用可能になると処理されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-307">Individual requests will be processed as server resources become available.</span></span>

1.  <span data-ttu-id="ff9dc-308">サーバーの全体管理で、[アプリケーション管理] の [**サービスアプリケーションの管理**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-308">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="ff9dc-309">PowerPivot サービス アプリケーションの名前をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-309">Click the PowerPivot service application name.</span></span> <span data-ttu-id="ff9dc-310">PowerPivot 管理ダッシュボードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-310">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="ff9dc-311">[アクション] で [**サービスアプリケーションの設定の構成**] をクリックして、[PowerPivot サービスアプリケーションの設定] ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-311">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="ff9dc-312">[データ更新] セクションの [営業時間] に、営業時間後の処理期間を定義する開始時刻と終了時刻を入力します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-312">In the Data Refresh section, in Business Hours, enter a start time and end time that defines the after business hours processing period.</span></span>

     <span data-ttu-id="ff9dc-313">営業時間外の処理期間を定義しない場合は、[開始時刻] と [終了時刻] の両方に同じ値を入力します (両方に「12:00」と入力するなど)。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-313">If you do not want an off-hours processing period defined, you can enter the same value for both Start Time and End Time (for example, 12:00 for both times).</span></span> <span data-ttu-id="ff9dc-314">ただし、その場合も、SharePoint サイトのスケジュール定義のページには [営業時間後] がオプションとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-314">However, be aware that the schedule definition pages on the SharePoint sites will still have "After business hours" as an option.</span></span> <span data-ttu-id="ff9dc-315">営業時間外の処理期間が定義されていないファームでユーザーがそのオプションを選択すると、ジョブを開始できないためにデータ更新エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-315">Users who select that option on a farm that has no off-hour processing range defined for it will eventually get data refresh errors as processing jobs fail to start.</span></span>

5.  <span data-ttu-id="ff9dc-316">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-316">Click **OK**.</span></span>

###  <a name="limit-how-long-data-refresh-history-is-retained"></a><a name="usagehist"></a><span data-ttu-id="ff9dc-317">データ更新履歴を保持する期間を制限する</span><span class="sxs-lookup"><span data-stu-id="ff9dc-317">Limit how long data refresh history is retained</span></span>
 <span data-ttu-id="ff9dc-318">データ更新の履歴とは、データ更新操作に対して生成された成功と失敗のメッセージの長期間にわたる詳細な記録です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-318">Data refresh history is a detailed record of the success and failure messages that are generated for data refresh operations over time.</span></span> <span data-ttu-id="ff9dc-319">履歴情報は、ファームの使用状況データ収集システムによって収集および管理されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-319">History information is gathered and managed through the usage data collection system in the farm.</span></span> <span data-ttu-id="ff9dc-320">そのため、使用状況データの履歴に対して設定した制限がデータ更新の履歴にも適用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-320">As such, limits that you set on usage data history also apply to data refresh history.</span></span> <span data-ttu-id="ff9dc-321">使用状況のレポートには PowerPivot システム全体から収集されたデータが含まれるため、データ更新の履歴のデータ保有期間と、収集および格納される他のすべての使用状況データのデータ保有期間の両方が、1 つの履歴設定を使用して制御されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-321">Because the usage activity reports pull together data from across the PowerPivot system, a single history setting is used to control data retention for both data refresh history and all other usage data that is collected and stored.</span></span>

1.  <span data-ttu-id="ff9dc-322">サーバーの全体管理で、[アプリケーション管理] の [**サービスアプリケーションの管理**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-322">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="ff9dc-323">PowerPivot サービス アプリケーションの名前をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-323">Click the PowerPivot service application name.</span></span> <span data-ttu-id="ff9dc-324">PowerPivot 管理ダッシュボードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-324">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="ff9dc-325">[アクション] で [**サービスアプリケーションの設定の構成**] をクリックして、[PowerPivot サービスアプリケーションの設定] ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-325">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="ff9dc-326">[使用状況データ収集] セクションの [使用状況データの履歴] で、各ブックのデータ更新操作の記録を保持する日数を入力します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-326">In the Usage Data Collection section, in Usage Data History, type the number of days for which you want to keep a record of data refresh activity for each workbook.</span></span>

     <span data-ttu-id="ff9dc-327">既定値は 365 日です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-327">The default is 365 days.</span></span> <span data-ttu-id="ff9dc-328">最小値は 1 日であり、最大値は 5000 日です。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-328">The minimum value is 1 day and the maximum is 5000 days.</span></span> <span data-ttu-id="ff9dc-329">0 を指定すると保有期間が制限されず、データが削除されません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-329">0 specifies an unlimited retention period; data is never deleted.</span></span> <span data-ttu-id="ff9dc-330">履歴をオフにするための設定はありません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-330">Note that there is no setting for turning off history.</span></span>

5.  <span data-ttu-id="ff9dc-331">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-331">Click **OK**.</span></span>

 <span data-ttu-id="ff9dc-332">履歴情報は、データ更新の履歴があるブックで [データ更新の管理] オプションを選択すると使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-332">History information is made available to SharePoint users when they choose the Manage Data Refresh option on a workbook that has a data refresh history.</span></span> <span data-ttu-id="ff9dc-333">この情報は、ファームの管理者が PowerPivot サービスの操作を管理するために使用する PowerPivot 管理ダッシュボードでも使用されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-333">This information is also used in the PowerPivot Management Dashboard used by farm administrators to manage PowerPivot service operations.</span></span> <span data-ttu-id="ff9dc-334">詳細については、「[データ更新の履歴の表示 &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-334">For more information, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="ff9dc-335">履歴データが長期間にわたって物理的に格納される場所は、PowerPivot サービス アプリケーションの PowerPivot サービス アプリケーション データベースです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-335">Long-term physical storage of history data is in the PowerPivot service application database for the PowerPivot service application.</span></span> <span data-ttu-id="ff9dc-336">使用状況データを収集および格納する方法の詳細については、「 [PowerPivot 使用状況データ収集](power-pivot-sharepoint/power-pivot-usage-data-collection.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-336">For more information about how usage data is collected and stored, see [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span></span>

##  <a name="reschedule-the-powerpivot-data-refresh-timer-job"></a><a name="configTimerJob"></a><span data-ttu-id="ff9dc-337">PowerPivot データ更新タイマージョブの再スケジュール</span><span class="sxs-lookup"><span data-stu-id="ff9dc-337">Reschedule the PowerPivot Data Refresh timer job</span></span>
 <span data-ttu-id="ff9dc-338">スケジュールされたデータ更新は、PowerPivot サービス アプリケーション データベースのスケジュール情報を 1 分ごとにスキャンする PowerPivot データ更新タイマー ジョブによってトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-338">Scheduled data refresh is triggered by a PowerPivot Data Refresh timer job that scans schedule information in the PowerPivot service application database at one minute intervals.</span></span> <span data-ttu-id="ff9dc-339">データ更新の開始がスケジュールされていた場合、タイマー ジョブは、使用可能な PowerPivot サーバーの処理キューに要求を追加します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-339">When data refresh is scheduled to begin, the timer job adds the request to a processing queue on an available PowerPivot server.</span></span>

 <span data-ttu-id="ff9dc-340">パフォーマンス チューニングの一環として、このスキャンの間隔を長くできます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-340">You can increase the length of time between scans as a performance tuning technique.</span></span> <span data-ttu-id="ff9dc-341">また、トラブルシューティングの際にタイマー ジョブを無効にして、データ更新操作を一時的に停止することもできます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-341">You can also disable the timer job to temporarily stop data refresh operations while you troubleshoot problems.</span></span>

 <span data-ttu-id="ff9dc-342">既定の設定は 1 分です。これより低い値を指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-342">The default setting is one minute, which is the lowest value you can specify.</span></span> <span data-ttu-id="ff9dc-343">この値を使用すると、1 日の任意の時刻に実行されるスケジュールの結果を最も予測しやすくなるため、この値を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-343">This value is recommended because it provides the most predictable outcome for schedules that run at arbitrary times throughout the day.</span></span> <span data-ttu-id="ff9dc-344">たとえば、データ更新を午後 4 時 15 分にスケジュールした場合、タイマー ジョブがスケジュールを 1 分ごとにスキャンしていれば、スケジュールされたデータ更新要求が 4 時 15 分に検出され、その後数分以内に処理が実行されます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-344">For example, if a user schedules data refresh for 4:15 PM, and the timer job scans for schedules every minute, the scheduled data refresh request will be detected at 4:15 and processing will occur within a few minutes of 4:15.</span></span>

 <span data-ttu-id="ff9dc-345">スキャンの間隔を長くして、ごくたまにしかスキャンが行われないようにすると (1 日に 1 回、午前 0 時にスキャンが行われるようにするなど)、その間隔の間に実行するようにスケジュールされたすべてのデータ更新操作が一度に処理キューへ追加されます。この場合、サーバーに対する負荷が大きくなり、他のアプリケーション用のシステム リソースが不足する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-345">If you raise the scan interval so that it runs very infrequently (for example, once a day at midnight), all of the data refresh operations that were scheduled to run during that interval are added to the processing queue all at once, potentially overwhelming the server and starving other applications of system resources.</span></span> <span data-ttu-id="ff9dc-346">スケジュールされていた更新数によっては、データ更新操作の処理キューが長くなりすぎて、完了できないジョブが生じる場合もあります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-346">Depending on the number of scheduled refreshes, the processing queue for data refresh operations might build up to such an extent that not all jobs will be able to complete.</span></span> <span data-ttu-id="ff9dc-347">その状態で次の処理間隔に入り、キューの末尾にあるデータ更新要求が削除される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-347">Data refresh requests at the end of the queue might be dropped if they run into the next processing interval.</span></span>

 <span data-ttu-id="ff9dc-348">使用するハードウェアがサポートしている場合は、追加のプロセッサでより多くのデータ更新ジョブが並列実行されるように指定すると、この問題を緩和できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-348">If your hardware supports it, you can mitigate this problem by specifying additional processors to run more data refresh jobs in parallel.</span></span> <span data-ttu-id="ff9dc-349">詳細については、「[専用データ更新の構成」または「クエリ専用処理の &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-349">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span> <span data-ttu-id="ff9dc-350">データ更新要求が検出され、キューに追加され、処理される方法の詳細については、「 [PowerPivot データ更新](power-pivot-sharepoint/power-pivot-data-refresh.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-350">For more information about how data refresh requests are discovered, added to a queue, and processed, see [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span></span>

1.  <span data-ttu-id="ff9dc-351">サーバーの全体管理で **[監視]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-351">In Central Administration, click **Monitoring**.</span></span>

2.  <span data-ttu-id="ff9dc-352">[**ジョブ定義の確認**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-352">Click **Review Job Definitions**.</span></span>

3.  <span data-ttu-id="ff9dc-353">**PowerPivot データ更新タイマージョブ**を選択します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-353">Select the **PowerPivot Data Refresh Timer Job**.</span></span>

4.  <span data-ttu-id="ff9dc-354">スケジュールの頻度を変更して、タイマー ジョブがデータ更新スケジュールの情報をスキャンする頻度を変更します。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-354">Modify the schedule frequency to change how often the timer job scans for data refresh schedule information.</span></span>

##  <a name="disable-the-data-refresh-timer-job"></a><a name="bkmk_disableDR"></a><span data-ttu-id="ff9dc-355">データ更新タイマージョブを無効にする</span><span class="sxs-lookup"><span data-stu-id="ff9dc-355">Disable the Data Refresh Timer Job</span></span>
 <span data-ttu-id="ff9dc-356">PowerPivot データ更新タイマー ジョブは、ファーム内のすべての PowerPivot サーバー インスタンスに対して有効または無効になるファーム レベルのタイマー ジョブです。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-356">The PowerPivot data refresh timer job is a farm-level timer job that is either enabled or disabled for all PowerPivot server instances in the farm.</span></span> <span data-ttu-id="ff9dc-357">これは、特定の Web アプリケーションや PowerPivot サービス アプリケーションには関連付けられていません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-357">It is not tied to a specific Web application or PowerPivot service application.</span></span> <span data-ttu-id="ff9dc-358">PowerPivot データ更新タイマー ジョブを一部のサーバーで無効にして、ファーム内の他のサーバーでデータ更新処理が行われるようにすることはできません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-358">You cannot disable it on some servers to force data refresh processing to other servers in the farm.</span></span>

 <span data-ttu-id="ff9dc-359">PowerPivot データ更新タイマー ジョブを無効にすると、既にキューに入れられていた要求は処理されますが、再びジョブを有効にするまで新しい要求は追加されません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-359">If you disable the PowerPivot data refresh timer job, requests that were already in the queue will be processed, but no new requests will be added until you re-enable the job.</span></span> <span data-ttu-id="ff9dc-360">過去にスケジュールされていた要求は処理されません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-360">Requests that were scheduled to occur in the past are not processed.</span></span>

 <span data-ttu-id="ff9dc-361">タイマー ジョブを無効にしても、アプリケーション ページで使用できる機能には影響はありません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-361">Disabling the timer job has no effect on feature availability in application pages.</span></span> <span data-ttu-id="ff9dc-362">Web アプリケーションのデータ更新機能を削除したり非表示にしたりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-362">There is no way to remove or hide the data refresh feature in web applications.</span></span> <span data-ttu-id="ff9dc-363">タイマー ジョブが永続的に無効になっていても、投稿権限以上の権限を持つユーザーはデータ更新操作の新しいスケジュールを作成できます。</span><span class="sxs-lookup"><span data-stu-id="ff9dc-363">Users who have Contribute permissions or above will still be able to create new schedules for data refresh operations, even if the timer job is permanently disabled.</span></span>

## <a name="see-also"></a><span data-ttu-id="ff9dc-364">参照</span><span class="sxs-lookup"><span data-stu-id="ff9dc-364">See Also</span></span>
 <span data-ttu-id="ff9dc-365">[データ更新 &#40;のスケジュール&#41;PowerPivot for SharePoint](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [専用のデータ更新またはクエリ専用処理の構成 &#40;PowerPivot for SharePoint](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)&#41;[powerpivot 自動データ更新アカウントの](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)構成 &#40;PowerPivot for SharePoint&#41;[Powerpivot データ更新用の保存された資格情報の構成](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)&#40;PowerPivot for SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="ff9dc-365">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)</span></span>


