---
title: パーティションと DirectQuery モード (SSAS テーブル) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 5f179ba9-6efb-46ae-90e5-945bbfddb719
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5957ed919f15a5c7f39c3c78133786ae6687a2d2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643484"
---
# <a name="partitions-and-directquery-mode-ssas-tabular"></a><span data-ttu-id="12eef-102">パーティションと DirectQuery モード (SSAS テーブル)</span><span class="sxs-lookup"><span data-stu-id="12eef-102">Partitions and DirectQuery Mode (SSAS Tabular)</span></span>
  <span data-ttu-id="12eef-103">ここでは、DirectQuery モデルでのパーティションの使用方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="12eef-103">This section explains how partitions are used in DirectQuery models.</span></span> <span data-ttu-id="12eef-104">テーブル モデルでのパーティションに関する一般的な情報については、「 [パーティション (SSAS テーブル)](partitions-ssas-tabular.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="12eef-104">For more general information about partitions in tabular models, see [Partitions &#40;SSAS Tabular&#41;](partitions-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="12eef-105">使用されるパーティションを変更する方法、またはパーティションに関する情報を表示する方法については、「 [SSAS テーブル&#41;&#40;DirectQuery パーティションを変更](../change-the-directquery-partition-ssas-tabular.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="12eef-105">For instructions on how to change the partition that is used, or view information about the partition, see [Change the DirectQuery Partition &#40;SSAS Tabular&#41;](../change-the-directquery-partition-ssas-tabular.md).</span></span>  
  
## <a name="using-partitions-in-directquery-mode"></a><span data-ttu-id="12eef-106">DirectQuery モードでのパーティションの使用</span><span class="sxs-lookup"><span data-stu-id="12eef-106">Using Partitions in DirectQuery Mode</span></span>  
 <span data-ttu-id="12eef-107">テーブルごとに、DirectQuery データ ソースとして使用する 1 つのパーティションを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eef-107">For each table, you must specify a single partition to use as the DirectQuery data source.</span></span>  <span data-ttu-id="12eef-108">複数のパーティションがある場合は、モデルを切り替えて DirectQuery モードを有効にすると、テーブル内に作成された最初のパーティションに DirectQuery パーティションのフラグが既定で設定されます。</span><span class="sxs-lookup"><span data-stu-id="12eef-108">If there are multiple partitions, when you switch the model to enable DirectQuery mode, by default the first partition that was created in the table is flagged as the DirectQuery partition.</span></span> <span data-ttu-id="12eef-109">この設定は、後で [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]のパーティション マネージャーを使用して変更できます。</span><span class="sxs-lookup"><span data-stu-id="12eef-109">You can change this later by using the Partition Manager in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>  
  
 <span data-ttu-id="12eef-110">DirectQuery モードで 1 つのパーティションのみ許可するのはなぜでしょうか。</span><span class="sxs-lookup"><span data-stu-id="12eef-110">Why allow only a single partition in DirectQuery mode?</span></span>  
  
 <span data-ttu-id="12eef-111">テーブル モデルでは、OLAP モデルの場合と同様に、テーブルのパーティションが SQL クエリによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="12eef-111">In tabular models (as in OLAP models), the partitions of a table are defined by SQL queries.</span></span> <span data-ttu-id="12eef-112">パーティションの定義を作成する開発者は、パーティションが重ならないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eef-112">The developer who creates the partition definition is responsible for ensuring that partitions do not overlap.</span></span> <span data-ttu-id="12eef-113">Analysis Services では、レコードが 1 つのパーティションに属しているか、複数のパーティションに属しているかはチェックされません。</span><span class="sxs-lookup"><span data-stu-id="12eef-113">Analysis Services does not check whether records belong in one or multiple partitions.</span></span>  
  
 <span data-ttu-id="12eef-114">キャッシュされたテーブル モデル内のパーティションは同じように動作します。</span><span class="sxs-lookup"><span data-stu-id="12eef-114">Partitions in a cached tabular model behave the same way.</span></span> <span data-ttu-id="12eef-115">インメモリ モデルを使用する場合は、キャッシュがアクセスされるときに、DAX 数式がパーティションごとに評価され、結果が結合されます。</span><span class="sxs-lookup"><span data-stu-id="12eef-115">If you are using an in-memory model, while the cache is being accessed, DAX formulas are evaluated for each partition, and the results are combined.</span></span> <span data-ttu-id="12eef-116">一方、テーブル モデルが DirectQuery モードを使用する場合は、複数のパーティションを評価して結果を結合し、リレーショナル データ ストアに送信する SQL ステートメントに変換することは不可能です。</span><span class="sxs-lookup"><span data-stu-id="12eef-116">However, when a tabular model uses DirectQuery mode, it would be impossible to evaluate multiple partitions, combine the results, and convert that into a SQL statement for sending to the relational data store.</span></span> <span data-ttu-id="12eef-117">この操作を行うと、パフォーマンスが許容できないほど低下し、集計される結果が不正確になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="12eef-117">Doing so could lead to unacceptable loss of performance, as well as potential inaccuracies as the results are aggregated.</span></span>  
  
 <span data-ttu-id="12eef-118">したがって、DirectQuery モードで応答されたクエリに対して、サーバーは DirectQuery アクセスのプライマリ パーティションとしてマークされた単一のパーティション ( *DirectQuery パーティション*) を使用します。</span><span class="sxs-lookup"><span data-stu-id="12eef-118">Therefore, for queries answered in DirectQuery mode, the server uses a single partition that has been marked as the primary partition for DirectQuery access, called the *DirectQuery partition*.</span></span>  <span data-ttu-id="12eef-119">このパーティションの定義で指定された SQL クエリは、DirectQuery モードでのクエリの応答に使用できるデータの完全なセットを定義します。</span><span class="sxs-lookup"><span data-stu-id="12eef-119">The SQL query specified in the definition of this partition defines the complete set of data that can be used to answer queries in DirectQuery mode.</span></span>  
  
 <span data-ttu-id="12eef-120">パーティションを明示的に定義していない場合、エンジンは単純にリレーショナル データ ソース全体に SQL クエリを発行し、DAX 数式で指定されたセットベース操作を実行してクエリ結果を返します。</span><span class="sxs-lookup"><span data-stu-id="12eef-120">If you do not explicitly define a partition, the engine simply issues a SQL query to the entire relational data source, performs any set-based operations dictated by the DAX formula, and returns the query results.</span></span>  
  
 <span data-ttu-id="12eef-121">テーブルに複数のパーティションがあり、1 つのパーティションを DirectQuery パーティションとして選択した場合、既定では他のすべてのパーティションはメモリ内でのみ使用されるように自動的にマークされます。</span><span class="sxs-lookup"><span data-stu-id="12eef-121">If you have multiple partitions in a table, and select one partition as the DirectQuery partition, by default all other partitions are marked as being for in-memory use only.</span></span>  
  
## <a name="partitions-in-cached-models-and-in-directquery-models"></a><span data-ttu-id="12eef-122">キャッシュ モデルと DirectQuery モデルのパーティション</span><span class="sxs-lookup"><span data-stu-id="12eef-122">Partitions in Cached Models and in DirectQuery Models</span></span>  
 <span data-ttu-id="12eef-123">DirectQuery パーティションを構成するときは、パーティションの処理オプションを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eef-123">When you configure a DirectQuery partition, you must specify processing options for the partition.</span></span>  
  
 <span data-ttu-id="12eef-124">DirectQuery パーティションには 2 つの処理オプションがあります。</span><span class="sxs-lookup"><span data-stu-id="12eef-124">There are two processing options for the DirectQuery partition.</span></span> <span data-ttu-id="12eef-125">このプロパティを設定するには、 **の** [パーティション マネージャー] [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]または [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]を使用して、 **[処理オプション]** プロパティを選択します。</span><span class="sxs-lookup"><span data-stu-id="12eef-125">To set this property, use the **Partition Manager** in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], or [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and select the **Processing Option** property.</span></span> <span data-ttu-id="12eef-126">次の表にこのプロパティの値を示し、接続文字列の [DirectQueryUsage] プロパティと組み合わせた場合の各値の影響について説明します。</span><span class="sxs-lookup"><span data-stu-id="12eef-126">The following table lists the values of this property, and describes the effects of each value when combined with the DirectQueryUsage property on the connection string:</span></span>  
  
|<span data-ttu-id="12eef-127">**Directqueryusage**プロパティ</span><span class="sxs-lookup"><span data-stu-id="12eef-127">**DirectQueryUsage** property</span></span>|<span data-ttu-id="12eef-128">**[処理オプション]** プロパティ</span><span class="sxs-lookup"><span data-stu-id="12eef-128">**Processing Option** property</span></span>|<span data-ttu-id="12eef-129">Notes</span><span class="sxs-lookup"><span data-stu-id="12eef-129">Notes</span></span>|  
|-----------------------------------|------------------------------------|-----------|  
|<span data-ttu-id="12eef-130">DirectQuery</span><span class="sxs-lookup"><span data-stu-id="12eef-130">DirectQuery</span></span>|<span data-ttu-id="12eef-131">[このパーティションを処理しない]</span><span class="sxs-lookup"><span data-stu-id="12eef-131">Never process this partition</span></span>|<span data-ttu-id="12eef-132">モデルが DirectQuery のみを使用している場合、処理は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="12eef-132">When the model is using DirectQuery only, processing is never necessary.</span></span><br /><br /> <span data-ttu-id="12eef-133">ハイブリッド モデルでは、DirectQuery パーティションが処理されないように構成できます。</span><span class="sxs-lookup"><span data-stu-id="12eef-133">In hybrid models, you can configure the DirectQuery partition to never be processed.</span></span> <span data-ttu-id="12eef-134">たとえば、非常に大きなデータ セットを操作する場合に、キャッシュに結果のすべてを追加する必要がなければ、DirectQuery パーティションにテーブル内の他のパーティションに対する結果の和集合を含めて、和集合を処理しないことを指定できます。</span><span class="sxs-lookup"><span data-stu-id="12eef-134">For example, if you are operating over a very large data set and do not want the full results added to the cache, you can specify that the DirectQuery partition include the union of results for all other partitions in the table, and then never process the union.</span></span> <span data-ttu-id="12eef-135">リレーショナル ソースに対するクエリは影響を受けず、キャッシュ データに対するクエリは他のパーティションからのデータを結合します。</span><span class="sxs-lookup"><span data-stu-id="12eef-135">Queries that go to the relational source will not be affected, and queries against cached data will combine data from the other partitions</span></span>|  
|<span data-ttu-id="12eef-136">InMemory (DirectQuery あり)</span><span class="sxs-lookup"><span data-stu-id="12eef-136">InMemory With DirectQuery</span></span>|<span data-ttu-id="12eef-137">[パーティションを処理できる]</span><span class="sxs-lookup"><span data-stu-id="12eef-137">Allow partition to be processed</span></span>|<span data-ttu-id="12eef-138">モデルがハイブリッド モードを使用している場合は、メモリ内に対するクエリと DirectQuery データ ソースに対するクエリで同じパーティションを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eef-138">If the model is using hybrid mode, you should use the same partition for queries against the in-memory and queries against the DirectQuery data source.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="12eef-139">参照</span><span class="sxs-lookup"><span data-stu-id="12eef-139">See Also</span></span>  
 [<span data-ttu-id="12eef-140">パーティション (SSAS テーブル)</span><span class="sxs-lookup"><span data-stu-id="12eef-140">Partitions &#40;SSAS Tabular&#41;</span></span>](partitions-ssas-tabular.md)  
  
  
