---
title: テーブルモデルデータアクセス |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 6ae74a8b-0025-450d-94a5-4e601831d420
author: minewiskan
ms.author: owend
ms.openlocfilehash: e9d7c336c549513ff6bd7cc3a2b409ec8776e581
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738809"
---
# <a name="tabular-model-data-access"></a><span data-ttu-id="8504d-102">テーブル モデル データ アクセス</span><span class="sxs-lookup"><span data-stu-id="8504d-102">Tabular Model Data Access</span></span>
  <span data-ttu-id="8504d-103">Analysis Services のテーブル モデル データベースは、多次元モデルからデータまたはメタデータを取得するときとほぼ同じクライアント、インターフェイス、および言語でアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="8504d-103">Tabular model databases in Analysis Services can be accessed by most of the same clients, interfaces, and languages that you use to retrieve data or metadata from a multidimensional model.</span></span> <span data-ttu-id="8504d-104">詳細については、「[Multidimensional Model Data Access (Analysis Services - Multidimensional Data)](../multidimensional-models/mdx/multidimensional-model-data-access-analysis-services-multidimensional-data.md)」(多次元モデルのデータ アクセス (Analysis Services - 多次元データ)) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-104">For more information, see [Multidimensional Model Data Access &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models/mdx/multidimensional-model-data-access-analysis-services-multidimensional-data.md).</span></span>  
  
 <span data-ttu-id="8504d-105">このトピックでは、テーブル モデルを操作するクライアント、クエリ言語、およびプログラム インターフェイスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8504d-105">This topic describes the clients, query languages, and programmatic interfaces that work with tabular models.</span></span>  
  
## <a name="clients"></a><span data-ttu-id="8504d-106">クライアント</span><span class="sxs-lookup"><span data-stu-id="8504d-106">Clients</span></span>  
 <span data-ttu-id="8504d-107">次の Microsoft 製クライアント アプリケーションでは、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] のテーブル モデル データベースに対するネイティブ接続がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="8504d-107">The following Microsoft client applications support native connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model databases.</span></span>  
  
### <a name="excel"></a><span data-ttu-id="8504d-108">Excel</span><span class="sxs-lookup"><span data-stu-id="8504d-108">Excel</span></span>  
 <span data-ttu-id="8504d-109">テーブル モデルのデータベースには Excel から接続できます。Excel にあるデータの視覚エフェクトと分析機能を使用してデータを操作することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-109">You can connect to tabular model databases from Excel, using the data visualization and analysis capabilities in Excel to work with your data.</span></span> <span data-ttu-id="8504d-110">データにアクセスするには、Analysis Services のデータ接続を定義し、表形式サーバー モードで動作するサーバーを指定してから、使用するデータベースを選択します。</span><span class="sxs-lookup"><span data-stu-id="8504d-110">To access the data, you define an Analysis Services data connection, specify a server that runs in tabular server mode, and then choose the database you want to use.</span></span> <span data-ttu-id="8504d-111">詳細については、「 [SQL Server Analysis Services のデータに接続する、または SQL Server Analysis Services のデータをインポートする](https://go.microsoft.com/fwlink/?linkID=215150)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-111">For more information, see [Connect to or import data from SQL Server Analysis Services](https://go.microsoft.com/fwlink/?linkID=215150).</span></span>  
  
 <span data-ttu-id="8504d-112">また、 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]でテーブル モデルを参照する用途にも Excel は適しています。</span><span class="sxs-lookup"><span data-stu-id="8504d-112">Excel is also the recommended application for browsing tabular models in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="8504d-113">このツールには、 **[Excel で分析]** というオプションがあります。このオプションを選択すると、新しい Excel インスタンスが起動して Excel ブックが作成され、そのブックからモデル ワークスペース データベースへのデータ接続が開きます。</span><span class="sxs-lookup"><span data-stu-id="8504d-113">The tool includes an **Analyze in Excel** option that starts a new instance of Excel, creates an Excel workbook, and opens a data connection from the workbook to the model workspace database.</span></span> <span data-ttu-id="8504d-114">Excel でテーブル モデル データを参照する際は、モデルに対するクエリが、Excel PivotTable クライアントを使用して実行される点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-114">When browsing tabular model data in Excel, be aware that Excel issues queries against the model using the Excel PivotTable client.</span></span> <span data-ttu-id="8504d-115">したがって、Excel ブック内の操作は、DAX クエリではなく、MDX クエリとしてワークスペース データベースに送信されます。</span><span class="sxs-lookup"><span data-stu-id="8504d-115">Accordingly, operations within the Excel workbook result in MDX queries being sent to the workspace database, not DAX queries.</span></span> <span data-ttu-id="8504d-116">SQL Profiler などの監視ツールを使用してクエリを監視したとき、プロファイラー トレースに表示されるのは DAX ではなく MDX です。</span><span class="sxs-lookup"><span data-stu-id="8504d-116">If you are using SQL Profiler or another monitoring tool to monitor queries, you can expect to see MDX and not DAX in the profiler trace.</span></span> <span data-ttu-id="8504d-117">"Excel で分析" 機能の詳細については、「[Excel で分析 (SSAS テーブル)](analyze-in-excel-ssas-tabular.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-117">For more information about the Analyze in Excel feature, see [Analyze in Excel &#40;SSAS Tabular&#41;](analyze-in-excel-ssas-tabular.md).</span></span>  
  
### <a name="power-view"></a><span data-ttu-id="8504d-118">Power View</span><span class="sxs-lookup"><span data-stu-id="8504d-118">Power View</span></span>  
 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] <span data-ttu-id="8504d-119">は、Reporting Services のレポート クライアント アプリケーションであり、SharePoint 2010 環境で動作します。</span><span class="sxs-lookup"><span data-stu-id="8504d-119">is a Reporting Services reporting client application that runs in a SharePoint 2010 environment.</span></span> <span data-ttu-id="8504d-120">データ探索、クエリ デザイン、プレゼンテーション レイアウトが、アドホック レポート環境に統合されています。</span><span class="sxs-lookup"><span data-stu-id="8504d-120">It combines data exploration, query design, and presentation layout into an integrated ad-hoc reporting experience.</span></span> [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] <span data-ttu-id="8504d-121">は、テーブル モデルをデータ ソースとして使用することができます。そのモデルが、テーブル モードで動作する Analysis Services のインスタンスにホストされているか、DirectQuery モードを使用してリレーショナル データ ストアから取得されるかは関係ありません。</span><span class="sxs-lookup"><span data-stu-id="8504d-121">can use tabular models as data sources, regardless of whether the model is hosted on an instance of Analysis Services running in tabular mode, or retrieved from a relational data store by using DirectQuery mode.</span></span> <span data-ttu-id="8504d-122">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)]でテーブル モデルに接続するには、サーバーの場所とデータベース名を格納する接続ファイルを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8504d-122">To connect to a tabular model in [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)], you must create a connection file that contains the server location and database name.</span></span> <span data-ttu-id="8504d-123">Reporting Services の共有データ ソースまたは BI Semantic Model の接続ファイルは SharePoint で作成することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-123">You can create a Reporting Services shared data source or a BI semantic model connection file in SharePoint.</span></span> <span data-ttu-id="8504d-124">BI セマンティックモデル接続の詳細については、「 [POWERPIVOT Bi セマンティックモデル接続 &#40; ](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md)」を参照してください&#41;。</span><span class="sxs-lookup"><span data-stu-id="8504d-124">For more information about BI semantic model connections, see [PowerPivot BI Semantic Model Connection &#40;.bism&#41;](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md).</span></span>  
  
 <span data-ttu-id="8504d-125">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] クライアントは特定のモデルの構造を判断する際、指定されたデータ ソースに要求を送信し、データ ソースからスキーマを取得します。このスキーマを使用することで、データ ソースとしてのモデルに対するクエリを作成し、そのデータを基に処理を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-125">The [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] client determines the structure of the specified model by sending a request to the specified data source, which returns a schema that can be used by the client to create queries against the model as a data source and perform operations based on the data.</span></span> <span data-ttu-id="8504d-126">以後、データのフィルター処理、計算や集計、関連付けられたデータの表示など、 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] ユーザー インターフェイスで実行される操作はクライアントによって制御され、プログラムから操作することはできません。</span><span class="sxs-lookup"><span data-stu-id="8504d-126">Subsequent operations in the [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] user interface to filter data, perform calculations or aggregations, and display associated data are controlled by the client and cannot be programmatically manipulated.</span></span>  
  
 <span data-ttu-id="8504d-127">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] クライアントからモデルへと送信されるクエリは DAX ステートメントとして発行され、モデルにトレースを設定することによって監視できます。</span><span class="sxs-lookup"><span data-stu-id="8504d-127">The queries that are sent by the [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] client to the model are issued as DAX statements, which you can monitor by setting a trace on the model.</span></span>  <span data-ttu-id="8504d-128">クライアントは、概念スキーマ定義言語 (CSDL) に従って提示される初期スキーマ定義をサーバーに要求しますが、その際にも、サーバーに要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="8504d-128">The client also issues a request to the server for the initial schema definition, which is presented according to the Conceptual Schema Definition Language (CSDL).</span></span> <span data-ttu-id="8504d-129">詳細については、「 [ビジネス インテリジェンス向けの CSDL 注釈 (CSDLBI)](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)</span><span class="sxs-lookup"><span data-stu-id="8504d-129">For more information, see [CSDL Annotations for Business Intelligence &#40;CSDLBI&#41;](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)</span></span>  
  
### <a name="sql-server-management-studio"></a><span data-ttu-id="8504d-130">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="8504d-130">SQL Server Management Studio</span></span>  
 <span data-ttu-id="8504d-131">[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] を使用して、テーブル モデルをホストするインスタンスの管理や、テーブル モデル内のメタデータおよびデータに対するクエリを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-131">You can use [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] to manage instances that host tabular models, and to query the metadata and data in them.</span></span> <span data-ttu-id="8504d-132">モデルやモデル内のオブジェクトの処理、パーティションの作成と管理、さらには、データ アクセスを管理するためのセキュリティの設定を行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="8504d-132">You can process models or the objects in a model, create and manage partitions, and set security that can be used for managing data access.</span></span> <span data-ttu-id="8504d-133">詳細については、次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-133">For more information, see the following topics:</span></span>  
  
-   [<span data-ttu-id="8504d-134">Analysis Services インスタンスのサーバー モードの決定</span><span class="sxs-lookup"><span data-stu-id="8504d-134">Determine the Server Mode of an Analysis Services Instance</span></span>](../instances/determine-the-server-mode-of-an-analysis-services-instance.md)  
  
-   [<span data-ttu-id="8504d-135">Analysis Services への接続</span><span class="sxs-lookup"><span data-stu-id="8504d-135">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
-   [<span data-ttu-id="8504d-136">Analysis Services インスタンスの監視</span><span class="sxs-lookup"><span data-stu-id="8504d-136">Monitor an Analysis Services Instance</span></span>](../instances/monitor-an-analysis-services-instance.md)  
  
 <span data-ttu-id="8504d-137">[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] では、MDX と XMLA の両方のクエリ ウィンドウを使用して、テーブル モデル データベースからデータやメタデータを取得することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-137">You can use both the MDX and XMLA query windows in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] to retrieve data and metadata from a tabular model database.</span></span> <span data-ttu-id="8504d-138">ただし、次の制限事項に注意してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-138">However, note the following restrictions:</span></span>  
  
-   <span data-ttu-id="8504d-139">DirectQuery モードで配置されているモデルに対しては、MDX および DMX を使用したステートメントはサポートされません。したがって、DirectQuery モードのテーブル モデルに対するクエリを作成する必要がある場合は、 **[XMLA クエリ]** ウィンドウを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8504d-139">Statements using MDX and DMX are not supported for models that have been deployed in DirectQuery mode; therefore, if you need to create a query against a tabular model in DirectQuery mode, you should use an **XMLA Query** window instead.</span></span>  
  
-   <span data-ttu-id="8504d-140">**[クエリ]** ウィンドウを開いた後で、[XMLA クエリ] ウィンドウのデータベース コンテキストを変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="8504d-140">You cannot change the database context of the XMLA Query window after you have opened the **Query** window.</span></span> <span data-ttu-id="8504d-141">したがって、異なるデータベースまたは異なるインスタンスにクエリを送信する必要がある場合は、 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] を使用してデータベースまたはインスタンスを開き、そのコンテキスト内で新しい **[XMLA クエリ]** ウィンドウを開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="8504d-141">Therefore, if you need to send a query to a different database or to a different instance, you must open that database or instance using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and open a new **XMLA Query** window within that context.</span></span>  
  
 <span data-ttu-id="8504d-142">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] テーブル モデルに対するトレースは、多次元ソリューションと同様に作成することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-142">You can create traces against an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model as you would on a multidimensional solution.</span></span> <span data-ttu-id="8504d-143">このリリースの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] には、メモリ使用量やクエリ操作、処理中の操作、ファイルの使用状況を追跡するための新しいイベントが数多く用意されています。</span><span class="sxs-lookup"><span data-stu-id="8504d-143">In this release, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] provides many new events that can be used to track memory usage, query and processing operations, and file usage.</span></span> <span data-ttu-id="8504d-144">詳細については、「 [Analysis Services トレース イベント](https://docs.microsoft.com/bi-reference/trace-events/analysis-services-trace-events)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-144">For more information, see [Analysis Services Trace Events](https://docs.microsoft.com/bi-reference/trace-events/analysis-services-trace-events).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="8504d-145">テーブル モデル データベースにトレースを設定した場合、DMX クエリとして分類されたイベントの存在に気付くことがあります。</span><span class="sxs-lookup"><span data-stu-id="8504d-145">If you put a trace on a tabular model database, you might see some events that are categorized as DMX queries.</span></span> <span data-ttu-id="8504d-146">しかし、テーブル モデル データでは、データ マイニングはサポートされません。データベースに対して実行する DMX クエリは、モデルのメタデータに対する SELECT ステートメントに限られます。</span><span class="sxs-lookup"><span data-stu-id="8504d-146">However, data mining is not supported on tabular model data, and the DMX queries executed on the database are limited to SELECT statements on the model metadata.</span></span> <span data-ttu-id="8504d-147">イベントが DMX として分類されるのは、単に同じパーサー フレームワークが MDX に使用されているためです。</span><span class="sxs-lookup"><span data-stu-id="8504d-147">The events are categorized as DMX only because the same parser framework is used for MDX.</span></span>  
  
## <a name="query-languages"></a><span data-ttu-id="8504d-148">クエリ言語</span><span class="sxs-lookup"><span data-stu-id="8504d-148">Query Languages</span></span>  
 <span data-ttu-id="8504d-149">Analysis Services テーブル モデルは、多次元モデルへのアクセス用とほぼ同じクエリ言語をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8504d-149">Analysis Services tabular models support most of the same query languages that are provided for access to multidimensional models.</span></span> <span data-ttu-id="8504d-150">ただし、DirectQuery モードで配置されたテーブル モデルは例外です。この場合、データは、Analysis Services データ ストアからではなく、SQL Server データ ソースから直接取得されます。</span><span class="sxs-lookup"><span data-stu-id="8504d-150">The exception is tabular models that have been deployed in DirectQuery mode, which do not retrieve data from an Analysis Services data store, but retrieve data directly from a SQL Server data source.</span></span> <span data-ttu-id="8504d-151">これらのモデルは MDX を使用してクエリすることはできません。DAX 式から Transact-SQL ステートメントへの変換をサポートするクライアントを使用する必要があります ( [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] クライアントなど)。</span><span class="sxs-lookup"><span data-stu-id="8504d-151">You cannot query these models using MDX, but must use a client that supports conversion of DAX expressions to Transact-SQL statements, such as the [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] client.</span></span>  
  
### <a name="dax"></a><span data-ttu-id="8504d-152">DAX</span><span class="sxs-lookup"><span data-stu-id="8504d-152">DAX</span></span>  
 <span data-ttu-id="8504d-153">DAX は、あらゆる種類のテーブル モデルで、式や数式を作成する際に使用できます。モデルが SharePoint 上に PowerPivot 対応 Excel ブックとして格納されているか、Analysis Services のインスタンス上に格納されているかは関係ありません。</span><span class="sxs-lookup"><span data-stu-id="8504d-153">You can use DAX for creating expressions and formulas in all kinds of tabular models, regardless of whether the model is stored on SharePoint as a PowerPivot-enabled Excel workbook, or on an instance of Analysis Services.</span></span>  
  
 <span data-ttu-id="8504d-154">また、XMLA EXECUTE コマンド ステートメントのコンテキスト内で DAX 式を使用し、DirectQuery モードで配置されているテーブル モデルにクエリを送信することもできます。</span><span class="sxs-lookup"><span data-stu-id="8504d-154">Additionally, you can use DAX expressions within the context of an XMLA EXECUTE command statement to send queries to a tabular model that has been deployed in DirectQuery mode.</span></span>  
  
 <span data-ttu-id="8504d-155">DAX を使用したテーブルモデルに対するクエリの例については、[DAX クエリ構文リファレンス] (/dax/dax-syntax-reference) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-155">For examples of queries on a tabular model using DAX, see [DAX Query Syntax Reference](/dax/dax-syntax-reference</span></span>
  
### <a name="mdx"></a><span data-ttu-id="8504d-156">MDX</span><span class="sxs-lookup"><span data-stu-id="8504d-156">MDX</span></span>  
 <span data-ttu-id="8504d-157">メモリ内キャッシュを優先クエリ方式とするテーブル モデル (DirectQuery モードで配置されていないモデル) に対しては、MDX を使用してクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="8504d-157">You can use MDX to create queries against tabular models that use the in-memory cache as the preferred query method (that is, models that have not been deployed in DirectQuery mode).</span></span> <span data-ttu-id="8504d-158">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] などのクライアントでは、集計を実行する場合もモデルをデータ ソースとしてクエリする場合も DAX が使用されますが、MDX に慣れている方は、MDX の方が簡単にサンプル クエリを作成できる場合があります。「 [MDX 内でのメジャーの作成](../multidimensional-models/mdx/mdx-building-measures.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-158">Although clients such as [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] use DAX both for creating aggregations and for querying the model as a data source, if you are familiar with MDX it can be a shortcut to create sample queries in MDX, see [Building Measures in MDX](../multidimensional-models/mdx/mdx-building-measures.md).</span></span>  
  
### <a name="csdl"></a><span data-ttu-id="8504d-159">CSDL</span><span class="sxs-lookup"><span data-stu-id="8504d-159">CSDL</span></span>  
 <span data-ttu-id="8504d-160">概念スキーマ定義言語そのものはクエリ言語ではありませんが、モデルやモデルのメタデータに関する情報を取得することはできます。後でその情報を使用して、レポートを作成したり、モデルに対するクエリを作成したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-160">The Conceptual Schema Definition Language is not a query language, per se, but it can be used to retrieve information about the model and model metadata, that can later be used to create reports or create queries against the model.</span></span>  
  
 <span data-ttu-id="8504d-161">テーブル モデルで CSDL を使用する方法については、「 [ビジネス インテリジェンス向けの CSDL 注釈 (CSDLBI)](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)」(多次元モデルのデータ アクセス (Analysis Services - 多次元データ)) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-161">For information about how CSDL is used in tabular models, see [CSDL Annotations for Business Intelligence &#40;CSDLBI&#41;](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi).</span></span>  
  
## <a name="programmatic-interfaces"></a><span data-ttu-id="8504d-162">プログラミング インターフェイス</span><span class="sxs-lookup"><span data-stu-id="8504d-162">Programmatic Interfaces</span></span>  
 <span data-ttu-id="8504d-163">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] テーブル モデルを操作する際の要となるインターフェイスには、スキーマ行セットと XMLA のほか、 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] および [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]に備わっているクエリ クライアントとクエリ ツールがあります。</span><span class="sxs-lookup"><span data-stu-id="8504d-163">The principal interfaces that are used for interacting with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular models are the schema rowsets, XMLA, and the query clients and query tools provided by [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)].</span></span>  
  
### <a name="data-and-metadata"></a><span data-ttu-id="8504d-164">データとメタデータ</span><span class="sxs-lookup"><span data-stu-id="8504d-164">Data and Metadata</span></span>  
 <span data-ttu-id="8504d-165">マネージド アプリケーションでは、ADOMD.NET を使用して、テーブル モデルからデータおよびメタデータを取得できます。</span><span class="sxs-lookup"><span data-stu-id="8504d-165">You can retrieve data and metadata from tabular models in managed applications using ADOMD.NET.</span></span> <span data-ttu-id="8504d-166">テーブル モデルでオブジェクトを作成したり変更したりするアプリケーションの例については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-166">For examples of applications that create and modify objects in a tabular model, see the following resources:</span></span>  
  
-   <span data-ttu-id="8504d-167">Codeplex のテーブル モデル AMO サンプル</span><span class="sxs-lookup"><span data-stu-id="8504d-167">Tabular Model AMO Sample on Codeplex</span></span>  
  
-   [<span data-ttu-id="8504d-168">動的管理ビュー (DMV) を使用した Analysis Services の監視</span><span class="sxs-lookup"><span data-stu-id="8504d-168">Use Dynamic Management Views &#40;DMVs&#41; to Monitor Analysis Services</span></span>](../instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md)  
  
 <span data-ttu-id="8504d-169">アンマネージ クライアント アプリケーションでは Analysis Services 9.0 OLE DB プロバイダーを使用して、テーブル モデルに対する OLE DB アクセスをサポートできます。</span><span class="sxs-lookup"><span data-stu-id="8504d-169">You can use the Analysis Services 9.0 OLE DB provider in unmanaged client applications to support OLE DB access to tabular models.</span></span> <span data-ttu-id="8504d-170">テーブル モデル アクセスを有効にするには、最新バージョンの Analysis Services OLE DB プロバイダーが必要です。</span><span class="sxs-lookup"><span data-stu-id="8504d-170">An updated version of the Analysis Services OLE DB provider is required to enable tabular model access.</span></span> <span data-ttu-id="8504d-171">テーブル モデルで使用するプロバイダーの詳細については、「 [SharePoint サーバーへの Analysis Services OLE DB プロバイダーのインストール](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-171">For more information about providers used with tabular models, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) .</span></span>  
  
 <span data-ttu-id="8504d-172">XML ベース形式のデータを Analysis Services インスタンスから直接取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="8504d-172">You can also retrieve data directly from an Analysis Services instance in an XML-based format.</span></span> <span data-ttu-id="8504d-173">テーブル モデルのスキーマは DISCOVER_CSDL_METADATA 行セットを使用して取得できます。また、EXECUTE コマンドまたは DISCOVER コマンドを既存の ASSL 要素、オブジェクト、またはプロパティと組み合わせて使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="8504d-173">You can retrieve the schema of the tabular model by using the DISCOVER_CSDL_METADATA rowset, or you can use an EXECUTE or DISCOVER command with existing ASSL elements, objects, or properties.</span></span> <span data-ttu-id="8504d-174">詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-174">For more information, see the following resources:</span></span>  
  
-   [<span data-ttu-id="8504d-175">ビジネス インテリジェンス向けの CSDL 注釈 (CSDLBI)</span><span class="sxs-lookup"><span data-stu-id="8504d-175">CSDL Annotations for Business Intelligence &#40;CSDLBI&#41;</span></span>](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)  
  
### <a name="manipulate-analysis-services-objects"></a><span data-ttu-id="8504d-176">Analysis Services オブジェクトの操作</span><span class="sxs-lookup"><span data-stu-id="8504d-176">Manipulate Analysis Services Objects</span></span>  
 <span data-ttu-id="8504d-177">テーブル モデルとそこに含まれるオブジェクト (テーブル、列、パースペクティブ、メジャー、パーティションなど) の作成、変更、削除、処理は、XMLA コマンドまたは AMO を使用して行うことができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-177">You can create, modify, delete, and process tabular models and objects in them, including tables, columns, perspectives, measures, and partitions, using XMLA commands, or by using AMO.</span></span> <span data-ttu-id="8504d-178">AMO と XMLA は、テーブル モデルで使用される追加のプロパティをサポートするために更新され、レポートとモデリングの機能が強化されています。</span><span class="sxs-lookup"><span data-stu-id="8504d-178">Both AMO and XMLA have been updated to support additional properties that are used in tabular models for enhanced reporting and modeling.</span></span>  
  
 <span data-ttu-id="8504d-179">AMO および XMLA を使用してテーブル オブジェクトをスクリプト化する例については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-179">For examples of how tabular objects can be scripted using AMO and XMLA, see the following resources:</span></span>  
  
-   <span data-ttu-id="8504d-180">Codeplex のテーブル モデル AMO サンプル</span><span class="sxs-lookup"><span data-stu-id="8504d-180">Tabular Model AMO Sample on Codeplex</span></span>  
  
-   <span data-ttu-id="8504d-181">CodePlex の AdventureWorks サンプル</span><span class="sxs-lookup"><span data-stu-id="8504d-181">AdventureWorks Samples on CodePlex</span></span>  
  
 <span data-ttu-id="8504d-182">PowerShell を使用して、Analysis Services のインスタンスを管理、監視できるほか、テーブル モデル アクセスに必要なセキュリティを形成、監視することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-182">You can use PowerShell to manage and monitor instances of Analysis Services, as well as for creating and monitoring security used for tabular model access.</span></span> <span data-ttu-id="8504d-183">詳細については、「 [Analysis Services PowerShell](../analysis-services-powershell.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-183">For more information, see [Analysis Services PowerShell](../analysis-services-powershell.md).</span></span>  
  
### <a name="schema-rowsets"></a><span data-ttu-id="8504d-184">スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-184">Schema Rowsets</span></span>  
 <span data-ttu-id="8504d-185">クライアント アプリケーションは、スキーマ行セットを使用してテーブル モデルのメタデータを分析し、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サーバーからサポート情報および監視情報を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="8504d-185">Client applications can use the schema rowsets to examine the metadata of tabular models and to retrieve support and monitoring information from the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server.</span></span> <span data-ttu-id="8504d-186">このリリースの SQL Server では、テーブル モデルに関連した機能をサポートし、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]全体の監視とパフォーマンス分析を強化するために、新しいスキーマ行セットが追加され、既存のスキーマ行セットが拡張されています。</span><span class="sxs-lookup"><span data-stu-id="8504d-186">In this release of SQL Server new schema rowsets have been added and existing schema rowsets extended to support features related to tabular models and to enhance monitoring and performance analysis across [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   [<span data-ttu-id="8504d-187">DISCOVER_CALC_DEPENDENCY 行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-187">DISCOVER_CALC_DEPENDENCY Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-calc-dependency-rowset)  
  
     <span data-ttu-id="8504d-188">テーブル モデルの列と参照における依存関係を追跡するための新しいスキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-188">New schema rowset for tracking dependencies among the columns and references in a tabular model</span></span>  
  
-   [<span data-ttu-id="8504d-189">DISCOVER_CSDL_METADATA 行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-189">DISCOVER_CSDL_METADATA Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-csdl-metadata-rowset)  
  
     <span data-ttu-id="8504d-190">テーブル モデルの CSDL 表現を取得するための新しいスキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-190">New schema rowset for obtaining the CSDL representation of a tabular model</span></span>  
  
-   [<span data-ttu-id="8504d-191">DISCOVER_XEVENT_TRACE_DEFINITION 行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-191">DISCOVER_XEVENT_TRACE_DEFINITION Rowset</span></span>](../dev-guide/discover-xevent-trace-definition-rowset.md)  
  
     <span data-ttu-id="8504d-192">SQL Server 拡張イベントを監視するための新しいスキーマ行セット。</span><span class="sxs-lookup"><span data-stu-id="8504d-192">New schema rowset for monitoring SQL Server Extended Events.</span></span> <span data-ttu-id="8504d-193">詳細については、「 [SQL Server 拡張イベント &#40;xevent&#41; を使用して Analysis Services を監視する](../instances/monitor-analysis-services-with-sql-server-extended-events.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-193">For more information, see [Use SQL Server Extended Events &#40;XEvents&#41; to Monitor Analysis Services](../instances/monitor-analysis-services-with-sql-server-extended-events.md).</span></span>  
  
-   [<span data-ttu-id="8504d-194">DISCOVER_TRACES 行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-194">DISCOVER_TRACES Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-traces-rowset)  
  
     <span data-ttu-id="8504d-195">新しい `Type` 列を使用すると、トレースをカテゴリ別にフィルター選択できます。</span><span class="sxs-lookup"><span data-stu-id="8504d-195">New `Type` column lets you filter traces by category.</span></span> <span data-ttu-id="8504d-196">詳細については、「[再生用のプロファイラー トレースの作成 (Analysis Services)](../instances/create-profiler-traces-for-replay-analysis-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-196">For more information, see [Create Profiler Traces for Replay &#40;Analysis Services&#41;](../instances/create-profiler-traces-for-replay-analysis-services.md).</span></span>  
  
-   [<span data-ttu-id="8504d-197">MDSCHEMA_HIERARCHIES 行セット</span><span class="sxs-lookup"><span data-stu-id="8504d-197">MDSCHEMA_HIERARCHIES Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/ole-db-olap/mdschema-hierarchies-rowset)  
  
     <span data-ttu-id="8504d-198">新しい `STRUCTURE_TYPE` 列挙体は、テーブル モデルで作成されたユーザー定義階層の識別をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8504d-198">New `STRUCTURE_TYPE` enumeration supports identification of user-defined hierarchies created in tabular models.</span></span> <span data-ttu-id="8504d-199">詳細については、「[階層 (SSAS テーブル)](hierarchies-ssas-tabular.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8504d-199">For more information, see [Hierarchies &#40;SSAS Tabular&#41;](hierarchies-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="8504d-200">このリリースでは、データ マイニング スキーマ行セットの OLE DB に対する更新はありません。</span><span class="sxs-lookup"><span data-stu-id="8504d-200">There are no updates to the OLE DB for Data Mining schema rowsets in this release.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="8504d-201">DirectQuery モードで配置されているデータベースでは MDX クエリや DMX クエリは使用できません。したがって、DirectQuery モデルに対し、スキーマ行セットを使用してクエリを実行する必要がある場合は、関連する DMV ではなく、XMLA を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8504d-201">You cannot use MDX or DMX queries in a database that has been deployed in DirectQuery mode; therefore, if you need to execute a query against a DirectQuery model using the schema rowsets, you should use XMLA, and not the associated DMV.</span></span> <span data-ttu-id="8504d-202">SELECT \* from $system.DBSCHEMA_CATALOGS (または DISCOVER_TRACES) など、サーバー全体の結果を返す DMV の場合、キャッシュ モードで配置されたデータベースの内容のクエリを実行できます。</span><span class="sxs-lookup"><span data-stu-id="8504d-202">For DMVs that return results for the server as a whole, such as SELECT \* from $system.DBSCHEMA_CATALOGS or DISCOVER_TRACES, you can execute the query in the content of a database that is deployed in a cached mode.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8504d-203">参照</span><span class="sxs-lookup"><span data-stu-id="8504d-203">See Also</span></span>  
 <span data-ttu-id="8504d-204">[SSAS&#41;&#40;テーブルモデルデータベースへの接続](connect-to-a-tabular-model-database-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="8504d-204">[Connect to a Tabular Model Database &#40;SSAS&#41;](connect-to-a-tabular-model-database-ssas.md) </span></span>  
 <span data-ttu-id="8504d-205">[PowerPivot データアクセス](../power-pivot-sharepoint/power-pivot-data-access.md) </span><span class="sxs-lookup"><span data-stu-id="8504d-205">[PowerPivot Data Access](../power-pivot-sharepoint/power-pivot-data-access.md) </span></span>  
 [<span data-ttu-id="8504d-206">Analysis Services への接続</span><span class="sxs-lookup"><span data-stu-id="8504d-206">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
  
