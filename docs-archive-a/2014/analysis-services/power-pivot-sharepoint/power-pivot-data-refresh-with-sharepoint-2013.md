---
title: SharePoint 2013 を使用した PowerPivot データ更新 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87641294"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="dafa8-102">SharePoint 2013 での PowerPivot データ更新</span><span class="sxs-lookup"><span data-stu-id="dafa8-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="dafa8-103">SharePoint 2013 でのデータモデルの更新の設計では、 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 主要なコンポーネントとして Excel Services を使用して、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] sharepoint モードで実行されているのインスタンス上のデータモデルを読み込んで更新します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="dafa8-104">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サーバーは、SharePoint ファームの外部で実行されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="dafa8-105">以前に使用されていたデータ更新のアーキテクチャは、PowerPivot System サービスのみを使用して、SharePoint モードの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスでデータ モデルを読み込んで更新していました。</span><span class="sxs-lookup"><span data-stu-id="dafa8-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="dafa8-106">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスは、PowerPivot アプリケーション サーバーでローカルに実行されていました。</span><span class="sxs-lookup"><span data-stu-id="dafa8-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="dafa8-107">新しいアーキテクチャには、ドキュメント ライブラリのブック アイテムのメタデータとしてスケジュール情報を管理する新しい方法も導入されています。</span><span class="sxs-lookup"><span data-stu-id="dafa8-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="dafa8-108">SharePoint 2013 の Excel Services のアーキテクチャでは、 **対話型のデータ更新** と **定期データ更新**の両方がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="dafa8-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="dafa8-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="dafa8-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="dafa8-110">**このトピックの内容:**</span><span class="sxs-lookup"><span data-stu-id="dafa8-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="dafa8-111">対話型のデータ更新</span><span class="sxs-lookup"><span data-stu-id="dafa8-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="dafa8-112">ブックのデータ接続と対話型のデータ更新による Windows 認証</span><span class="sxs-lookup"><span data-stu-id="dafa8-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="dafa8-113">定期データ更新</span><span class="sxs-lookup"><span data-stu-id="dafa8-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="dafa8-114">SharePoint 2013 の定期データ更新のアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="dafa8-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="dafa8-115">認証に関するその他の注意点</span><span class="sxs-lookup"><span data-stu-id="dafa8-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="dafa8-116">その他の情報</span><span class="sxs-lookup"><span data-stu-id="dafa8-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="dafa8-117">バックグラウンド</span><span class="sxs-lookup"><span data-stu-id="dafa8-117">Background</span></span>  
 <span data-ttu-id="dafa8-118">SharePoint Server 2013 Excel Services では、Excel 2013 ブックのデータ更新を管理し、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] sharepoint モードで実行されているサーバーでデータモデル処理をトリガーし [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="dafa8-119">Excel 2010 ブックの場合、Excel Services はブックおよびデータ モデルの読み込みと保存も管理します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="dafa8-120">ただし、Excel Services は PowerPivot System サービスを使用して処理コマンドをデータ モデルに送信します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="dafa8-121">次の表は、データ更新の処理コマンドを送信するコンポーネントをブックのバージョンごとにまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="dafa8-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="dafa8-122">想定した環境は、SharePoint モードで実行されている [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 分析サーバーを使用するように構成された SharePoint 2013 ファームです。</span><span class="sxs-lookup"><span data-stu-id="dafa8-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="dafa8-123">Excel 2013 ブック</span><span class="sxs-lookup"><span data-stu-id="dafa8-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="dafa8-124">Excel 2010 ブック</span><span class="sxs-lookup"><span data-stu-id="dafa8-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="dafa8-125">データ更新をトリガーする</span><span class="sxs-lookup"><span data-stu-id="dafa8-125">Trigger Data Refresh</span></span>|<span data-ttu-id="dafa8-126">**対話操作:** 認証済みユーザー</span><span class="sxs-lookup"><span data-stu-id="dafa8-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="dafa8-127">**スケジュール操作:** PowerPivot System サービス</span><span class="sxs-lookup"><span data-stu-id="dafa8-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="dafa8-128">PowerPivot System サービス</span><span class="sxs-lookup"><span data-stu-id="dafa8-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="dafa8-129">コンテンツ データベースからブックを読み込む</span><span class="sxs-lookup"><span data-stu-id="dafa8-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="dafa8-130">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="dafa8-131">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="dafa8-132">Analysis Services インスタンスでデータ モデルを読み込む</span><span class="sxs-lookup"><span data-stu-id="dafa8-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="dafa8-133">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="dafa8-134">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="dafa8-135">Analysis Services インスタンスに処理コマンドを送信する</span><span class="sxs-lookup"><span data-stu-id="dafa8-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="dafa8-136">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="dafa8-137">PowerPivot System サービス</span><span class="sxs-lookup"><span data-stu-id="dafa8-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="dafa8-138">ブック データを更新する</span><span class="sxs-lookup"><span data-stu-id="dafa8-138">Update Workbook Data</span></span>|<span data-ttu-id="dafa8-139">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="dafa8-140">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="dafa8-141">コンテンツ データベースにブックとデータ モデルを保存する</span><span class="sxs-lookup"><span data-stu-id="dafa8-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="dafa8-142">**対話操作:** なし</span><span class="sxs-lookup"><span data-stu-id="dafa8-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="dafa8-143">**スケジュール操作:** SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="dafa8-144">SharePoint 2013 の Excel Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="dafa8-145">次の表は、SharePoint モードで実行されている [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 分析サーバーを使用するように構成された SharePoint 2013 ファームでサポートされている更新機能をまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="dafa8-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="dafa8-146">ブックの作成環境</span><span class="sxs-lookup"><span data-stu-id="dafa8-146">Workbook created in</span></span>|<span data-ttu-id="dafa8-147">スケジュールされたデータ更新</span><span class="sxs-lookup"><span data-stu-id="dafa8-147">Scheduled data refresh</span></span>|<span data-ttu-id="dafa8-148">対話型の更新</span><span class="sxs-lookup"><span data-stu-id="dafa8-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="dafa8-149">2008 R2 PowerPivot for Excel</span><span class="sxs-lookup"><span data-stu-id="dafa8-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="dafa8-150">サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-150">Not supported.</span></span> <span data-ttu-id="dafa8-151">ブックをアップグレードする **( \* )**</span><span class="sxs-lookup"><span data-stu-id="dafa8-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="dafa8-152">サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-152">Not supported.</span></span> <span data-ttu-id="dafa8-153">ブックをアップグレードする **( \* )**</span><span class="sxs-lookup"><span data-stu-id="dafa8-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="dafa8-154">2012 PowerPivot for Excel</span><span class="sxs-lookup"><span data-stu-id="dafa8-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="dafa8-155">サポートされています</span><span class="sxs-lookup"><span data-stu-id="dafa8-155">Supported</span></span>|<span data-ttu-id="dafa8-156">サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-156">Not supported.</span></span> <span data-ttu-id="dafa8-157">ブックをアップグレードする **( \* )**</span><span class="sxs-lookup"><span data-stu-id="dafa8-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="dafa8-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="dafa8-158">Excel 2013</span></span>|<span data-ttu-id="dafa8-159">サポートされています</span><span class="sxs-lookup"><span data-stu-id="dafa8-159">Supported</span></span>|<span data-ttu-id="dafa8-160">サポートされています</span><span class="sxs-lookup"><span data-stu-id="dafa8-160">Supported</span></span>|  
  
 <span data-ttu-id="dafa8-161">**( \* )** ブックのアップグレードの詳細については、「 [SharePoint 2013&#41;&#40;ブックのアップグレードと定期データ更新](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="dafa8-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="dafa8-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="dafa8-163">SharePoint Server 2013 の Excel Services で、対話型または手動のデータ更新は、元のデータ ソースから取得したデータを使用してデータ モデルを更新できます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="dafa8-164">対話型のデータ更新は、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サーバーに登録して Excel Services アプリケーションを構成すると使用できるようになり、SharePoint モードで実行されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="dafa8-165">詳細については、「 [Excel Services のデータ モデルの設定を管理する (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="dafa8-166">対話型のデータ更新は、Excel 2013 で作成されたブックでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="dafa8-167">Excel 2010 ブックを更新しようとすると、"PowerPivot の操作に失敗しました。ブックは古いバージョンの Excel で作成されており、ファイルがアップグレードされるまで PowerPivot を更新できません" というエラーメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="dafa8-168">ブックのアップグレードの詳細については、「[ブックのアップグレードと定期データ更新 (SharePoint 2013)](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="dafa8-169">**対話型の更新の要点**</span><span class="sxs-lookup"><span data-stu-id="dafa8-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="dafa8-170">対話型のデータ更新では、現在のユーザー セッションにあるデータのみが更新されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="dafa8-171">データは、SharePoint コンテンツ データベースにある元のブック アイテムには自動的に保存されません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="dafa8-172">**資格情報:** 対話型のデータ更新では、データ ソースに接続する場合、現在ログインしているユーザーの ID を資格情報として使用するか、または保存された資格情報を使用できます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="dafa8-173">使用される資格情報は、外部データ ソースへのブックの接続用に定義された Excel Services の認証設定によって異なります。</span><span class="sxs-lookup"><span data-stu-id="dafa8-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="dafa8-174">**サポートされているブック:**  Excel 2013 で作成されたブック。</span><span class="sxs-lookup"><span data-stu-id="dafa8-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="dafa8-175">**データを更新するには**</span><span class="sxs-lookup"><span data-stu-id="dafa8-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="dafa8-176">手順に沿った図を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="dafa8-177">SharePoint ドキュメント ライブラリで、PowerPivot ブックをブラウザーで開きます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="dafa8-178">ブラウザー ウィンドウで **[データ]** メニューをクリックしたら、 **[選択した接続の更新]** または **[すべての接続の更新]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="dafa8-179">Excel Services が PowerPivot データベースを読み込んで処理し、そのクエリを実行して、Excel ブックのキャッシュを更新します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="dafa8-180">**注:** 更新されたブックは、元のドキュメント ライブラリには自動的に保存されません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="dafa8-181">![対話型のデータ更新](../media/as-interactive-datarefresh-sharepoint2013.gif "対話型のデータ更新")</span><span class="sxs-lookup"><span data-stu-id="dafa8-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="dafa8-182">ブックのデータ接続と対話型のデータ更新による Windows 認証</span><span class="sxs-lookup"><span data-stu-id="dafa8-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="dafa8-183">Excel Services は、ユーザー アカウントを借用するようサーバーに指示するプロセス コマンドを Analysis Services サーバーに送信します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="dafa8-184">Analysis Services サービス アカウントで、ユーザーの権限借用委任プロセスを実行するのに十分なシステム権限を取得するには、ローカル サーバーに **[オペレーティング システムの一部として機能]** 権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="dafa8-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="dafa8-185">また、Analysis Services サーバーでは、ユーザーの資格情報をデータ ソースに委任できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="dafa8-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="dafa8-186">クエリの結果は Excel Services に送信されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="dafa8-187">一般的なユーザーエクスペリエンス: 顧客が PowerPivot モデルを含む Excel 2013 ブックで [すべての接続を更新] を選択すると、次のようなエラーメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="dafa8-188">**外部データの更新に失敗しました:** ブックのデータ モデルでの作業中にエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="dafa8-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="dafa8-189">もう一度やり直してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-189">Please try again.</span></span> <span data-ttu-id="dafa8-190">このブックの 1 つ以上のデータ接続を更新できません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="dafa8-191">使用しているデータ プロバイダーによっては、ULS ログに次のようなメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="dafa8-192">**SQL Native Client の場合**</span><span class="sxs-lookup"><span data-stu-id="dafa8-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="dafa8-193">外部接続の作成またはクエリの実行を行うことができませんでした。</span><span class="sxs-lookup"><span data-stu-id="dafa8-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="dafa8-194">プロバイダー メッセージ: ID '20102481-39c8-4d21-bf63-68f583ad22bb' を参照するアウト オブ ライン オブジェクト 'DataSource' は指定されていますが、使用されていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="dafa8-195">OLE DB または ODBC エラー: SQL Server への接続の確立中に、ネットワーク関連のエラーまたはインスタンス固有のエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="dafa8-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="dafa8-196">サーバーが見つからないか、アクセスできません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-196">Server is not found or not accessible.</span></span> <span data-ttu-id="dafa8-197">インスタンス名が正しいことと、SQL Server がリモート接続を許可するように構成されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="dafa8-198">詳細については、SQL Server オンライン ブックを参照してください。; 08001; SSL プロバイダー: 要求されたセキュリティ パッケージがありません ; 08001; クライアントの接続が確立できません; 08001; クライアントでは暗号化をサポートしていません。; 08001。</span><span class="sxs-lookup"><span data-stu-id="dafa8-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="dafa8-199">, ConnectionName: ThisWorkbookDataModel、ブック: book1.xlsx。</span><span class="sxs-lookup"><span data-stu-id="dafa8-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="dafa8-200">**Microsoft OLE DB Provider for SQL Server の場合**</span><span class="sxs-lookup"><span data-stu-id="dafa8-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="dafa8-201">外部接続の作成またはクエリの実行を行うことができませんでした。</span><span class="sxs-lookup"><span data-stu-id="dafa8-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="dafa8-202">プロバイダー メッセージ: ID '6e711bfa-b62f-4879-a177-c5dd61d9c242' を参照するアウト オブ ライン オブジェクト 'DataSource' は指定されていますが、使用されていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="dafa8-203">OLE DB または ODBC エラー。</span><span class="sxs-lookup"><span data-stu-id="dafa8-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="dafa8-204">、ConnectionName: ThisWorkbookDataModel、ブック: OLEDB Provider.xlsx。</span><span class="sxs-lookup"><span data-stu-id="dafa8-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="dafa8-205">**.NET Framework Data Provider for SQL Server の場合**</span><span class="sxs-lookup"><span data-stu-id="dafa8-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="dafa8-206">外部接続の作成またはクエリの実行を行うことができませんでした。</span><span class="sxs-lookup"><span data-stu-id="dafa8-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="dafa8-207">プロバイダー メッセージ: ID 'f5fb916c-3eac-4d07-a542-531524c0d44a' を参照するアウト オブ ライン オブジェクト 'DataSource' は指定されていますが、使用されていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="dafa8-208">高レベル リレーショナル エンジンでエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="dafa8-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="dafa8-209">IDbConnection マネージド インターフェイスの使用中に、次の例外が発生しました: ファイルまたはアセンブリ 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'、またはその依存関係の 1 つが読み込めませんでした。</span><span class="sxs-lookup"><span data-stu-id="dafa8-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="dafa8-210">必要な偽装レベルが指定されなかったか、または指定された偽装レベルが無効です。</span><span class="sxs-lookup"><span data-stu-id="dafa8-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="dafa8-211">(HRESULT からの例外: 0x80070542)。</span><span class="sxs-lookup"><span data-stu-id="dafa8-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="dafa8-212">、ConnectionName: ThisWorkbookDataModel、ブック: NETProvider.xlsx。</span><span class="sxs-lookup"><span data-stu-id="dafa8-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="dafa8-213">**構成手順の概要** ローカル サーバーで **[オペレーティング システムの一部として機能]** 権限を構成するには</span><span class="sxs-lookup"><span data-stu-id="dafa8-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="dafa8-214">SharePoint モードで実行されている Analysis Services サーバーで、**[オペレーティング システムの一部として機能]** 権限に Analysis Services のサービス アカウントを追加します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="dafa8-215">"" を実行します。 `secpol.msc`</span><span class="sxs-lookup"><span data-stu-id="dafa8-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="dafa8-216">**[ローカル セキュリティ ポリシー]**、 **[ローカル ポリシー]**、 **[ユーザー権利の割り当て]** の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="dafa8-217">サービス アカウントを追加します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="dafa8-218">Excel Services を再開し、Analysis Services サーバーを再起動します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="dafa8-219">Excel Services サービス アカウントまたは Claims to Windows Token Service (C2WTS) から Analysis Services インスタンスへの委任は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="dafa8-220">したがって、Excel Services または C2WTS から PowerPivot AS サービスへの KCD の構成は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="dafa8-221">バックエンド データ ソースが [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスと同じサーバーにある場合、Kerberos 制約付き委任は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="dafa8-222">ただし、 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サービス アカウントには、オペレーティング システムの一部として機能する権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="dafa8-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="dafa8-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="dafa8-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="dafa8-224">詳細については、「[オペレーティングシステムの一部としての動作](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="dafa8-225">定期データ更新</span><span class="sxs-lookup"><span data-stu-id="dafa8-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="dafa8-226">**定期データ更新の要点**</span><span class="sxs-lookup"><span data-stu-id="dafa8-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="dafa8-227">SharePoint アドイン用の PowerPivot の配置が必要です。</span><span class="sxs-lookup"><span data-stu-id="dafa8-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="dafa8-228">詳細については、「 [SharePoint 2013&#41;&#40;PowerPivot for SharePoint アドインをインストールまたはアンインストールする](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="dafa8-229">ユーザーはブックの更新スケジュールを構成します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="dafa8-230">予定の時間になると、PowerPivot System サービスから Excel Services に対し次の要求が送信されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="dafa8-231">PowerPivot データベースを読み込んで処理する。</span><span class="sxs-lookup"><span data-stu-id="dafa8-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="dafa8-232">ブックを更新する。</span><span class="sxs-lookup"><span data-stu-id="dafa8-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="dafa8-233">元のコンテンツ データベースにブックを保存する。</span><span class="sxs-lookup"><span data-stu-id="dafa8-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="dafa8-234">**資格情報:** 保存された資格情報を使用します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="dafa8-235">現在のユーザーの ID は使用しません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="dafa8-236">**サポートされているブック:**[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]Excel 2010 用 PowerPivot アドインまたは excel 2013 を使用して作成されたブック。</span><span class="sxs-lookup"><span data-stu-id="dafa8-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="dafa8-237">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot アドインを使用して Excel 2010 で作成されたブックはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="dafa8-238">[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot 以上の形式でブックをアップグレードしてください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="dafa8-239">ブックのアップグレードの詳細については、「[ブックのアップグレードと定期データ更新 (SharePoint 2013)](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="dafa8-240">**[データ更新の管理]** ページを表示するには</span><span class="sxs-lookup"><span data-stu-id="dafa8-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="dafa8-241">手順に沿った図を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="dafa8-242">SharePoint ドキュメントライブラリで、PowerPivot ブックの [**開く] メニュー** (**...**) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="dafa8-243">2 番目の **[開くメニュー]** をクリックし、 **[PowerPivot データ更新の管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="dafa8-244">**[データ更新の管理]** ページで **[有効化]** をクリックし、更新のスケジュールを構成します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="dafa8-245">指定の時間になると、PowerPivot System サービスから Excel Services に次の要求が送信されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="dafa8-246">PowerPivot データ モデルを読み込んで処理する。</span><span class="sxs-lookup"><span data-stu-id="dafa8-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="dafa8-247">ブックを更新する。</span><span class="sxs-lookup"><span data-stu-id="dafa8-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="dafa8-248">元のコンテンツ データベースにブックを保存する。</span><span class="sxs-lookup"><span data-stu-id="dafa8-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="dafa8-249">![[データ更新の管理] コンテキスト メニュー](../media/as-manage-datarefresh-sharepoint2013.gif "[データ更新の管理] コンテキスト メニュー")</span><span class="sxs-lookup"><span data-stu-id="dafa8-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="dafa8-250">SharePoint online からのブックの更新については、「 [Sharepoint online からの埋め込み PowerPivot モデルを使用した Excel ブックの更新」 (ホワイトペーパー) ()](https://technet.microsoft.com/library/jj992650.aspx)を参照してください https://technet.microsoft.com/library/jj992650.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="dafa8-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="dafa8-251">SharePoint 2013 でのスケジュールされたデータ更新のアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="dafa8-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="dafa8-252">次の図は、SharePoint 2013 および SQL Server 2012 SP1 のデータ更新のアーキテクチャをまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="dafa8-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="dafa8-253">![SQL Server 2012 SP1 データ更新のアーキテクチャ](../media/as-scheduled-data-refresh2012sp1-architecture.gif "SQL Server 2012 SP1 データ更新のアーキテクチャ")</span><span class="sxs-lookup"><span data-stu-id="dafa8-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="dafa8-254">説明</span><span class="sxs-lookup"><span data-stu-id="dafa8-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="dafa8-255">**(1)**</span><span class="sxs-lookup"><span data-stu-id="dafa8-255">**(1)**</span></span>|<span data-ttu-id="dafa8-256">Analysis Services エンジン</span><span class="sxs-lookup"><span data-stu-id="dafa8-256">Analysis Services Engine</span></span>|<span data-ttu-id="dafa8-257">SharePoint モードで実行されている [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サーバーでデータ モデル処理をトリガーします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="dafa8-258">サーバーは SharePoint ファームの外部で実行されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="dafa8-259">**3**</span><span class="sxs-lookup"><span data-stu-id="dafa8-259">**(2)**</span></span>|<span data-ttu-id="dafa8-260">ユーザー インターフェイス</span><span class="sxs-lookup"><span data-stu-id="dafa8-260">User Interface</span></span>|<span data-ttu-id="dafa8-261">ユーザー インターフェイスは 2 ページで構成されています。</span><span class="sxs-lookup"><span data-stu-id="dafa8-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="dafa8-262">スケジュールを定義するページと、更新履歴を表示するページです。</span><span class="sxs-lookup"><span data-stu-id="dafa8-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="dafa8-263">これらのページでは PowerPivot サービス アプリケーション データベースに直接アクセスしませんが、PowerPivot System サービスを使用してデータベースにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="dafa8-264">**番**</span><span class="sxs-lookup"><span data-stu-id="dafa8-264">**(3)**</span></span>|<span data-ttu-id="dafa8-265">PowerPivot System サービス</span><span class="sxs-lookup"><span data-stu-id="dafa8-265">PowerPivot System Service</span></span>|<span data-ttu-id="dafa8-266">サービスは、SharePoint アドイン用の PowerPivot の配置時にインストールされます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="dafa8-267">サービスは次の目的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="dafa8-268">このサービスは、Excel 2013 ブックのデータ更新の Excel Services API を呼び出す更新スケジュール エンジンをホストします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="dafa8-269">Excel 2010 ブックの場合、サービスはデータ モデル処理を直接実行しますが、データ モデルの読み込みとブックの更新には Excel Services を引き続き使用します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="dafa8-270">このサービスには、システム サービスと通信するコンポーネントのメソッド (ユーザー インターフェイスのページなど) が用意されています。</span><span class="sxs-lookup"><span data-stu-id="dafa8-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="dafa8-271">PowerPivot Web サービスを経由して受信するブックへの外部アクセス要求をデータ ソースとして管理します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="dafa8-272">タイマー ジョブと構成ページの定期データ更新要求の管理。</span><span class="sxs-lookup"><span data-stu-id="dafa8-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="dafa8-273">サービスは、サービス アプリケーション データベースの内外でのデータの読み取り要求と、Excel Services を使用したデータ更新のトリガーの要求を管理します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="dafa8-274">使用状況の処理と関連するタイマー ジョブ。</span><span class="sxs-lookup"><span data-stu-id="dafa8-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="dafa8-275">**4/4**</span><span class="sxs-lookup"><span data-stu-id="dafa8-275">**(4)**</span></span>|<span data-ttu-id="dafa8-276">Excel Calculation Services</span><span class="sxs-lookup"><span data-stu-id="dafa8-276">Excel Calculation Services</span></span>|<span data-ttu-id="dafa8-277">データ モデルの読み込みを管理します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="dafa8-278">**5/5**</span><span class="sxs-lookup"><span data-stu-id="dafa8-278">**(5)**</span></span>|<span data-ttu-id="dafa8-279">Secure Store Service</span><span class="sxs-lookup"><span data-stu-id="dafa8-279">Secure Store Service</span></span>|<span data-ttu-id="dafa8-280">ブックの認証設定が、認証された**ユーザーのアカウントを使用**するように構成されているか、 **None**の場合、データ更新には、Secure STORE のターゲットアプリケーション ID に格納されている資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="dafa8-281">詳細については、このトピックの「 [認証に関するその他の注意点](#datarefresh_additional_authentication) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="dafa8-282">**4/6**</span><span class="sxs-lookup"><span data-stu-id="dafa8-282">**(6)**</span></span>|<span data-ttu-id="dafa8-283">PowerPivot データ更新タイマー ジョブ</span><span class="sxs-lookup"><span data-stu-id="dafa8-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="dafa8-284">PowerPivot System サービスに対し、データ モデルを更新する場合は Excel Services に接続するように指示します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="dafa8-285">には、SharePoint モードの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] サーバーがデータ ソースにアクセスできるように、適切なデータ プロバイダーとクライアント ライブラリが必要になります。</span><span class="sxs-lookup"><span data-stu-id="dafa8-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="dafa8-286">現在、PowerPivot System サービスでは PowerPivot モデルの読み込みと保存を行わないため、アプリケーション サーバーでのモデルのキャッシュに関する設定のほとんどは SharePoint 2013 ファームに適用されません。</span><span class="sxs-lookup"><span data-stu-id="dafa8-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="dafa8-287">データ更新ログ データ</span><span class="sxs-lookup"><span data-stu-id="dafa8-287">Data refresh log data</span></span>  
 <span data-ttu-id="dafa8-288">**使用状況データ:** PowerPivot 管理ダッシュボードにデータ更新の使用状況データを表示できます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="dafa8-289">使用状況データを表示するには、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="dafa8-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="dafa8-290">SharePoint サーバーの全体管理の **[アプリケーションの全般設定]** グループで **[PowerPivot 管理ダッシュボード]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="dafa8-291">ダッシュボードの下部にある [**データ更新-最近の利用状況**] と [**データ更新-最近のエラー**] を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="dafa8-292">使用状況データの詳細と使用状況データを有効にする方法については、「 [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="dafa8-293">**診断ログ データ:** データ更新に関連する SharePoint の診断ログ データを表示できます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="dafa8-294">まず、SharePoint サーバー全体管理の **[監視]** ページで、 **[PowerPivot サービス]** の診断ログの構成を確認します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="dafa8-295">ログ記録する "重要度が最も低いイベント" のログ記録のレベルを上げることが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="dafa8-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="dafa8-296">たとえば、値を一時的に **[詳細]** に設定して、データ更新操作を再実行します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="dafa8-297">ログ エントリには次のものがあります。</span><span class="sxs-lookup"><span data-stu-id="dafa8-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="dafa8-298">**[PowerPivot サービス]** の **[エリア]**。</span><span class="sxs-lookup"><span data-stu-id="dafa8-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="dafa8-299">**[データ更新]** のカテゴリ。</span><span class="sxs-lookup"><span data-stu-id="dafa8-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="dafa8-300">**[診断ログの構成]** を確認します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="dafa8-301">詳細については、「 [SharePoint ログファイルと診断ログの構成と表示 &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="dafa8-302">認証に関するその他の考慮事項</span><span class="sxs-lookup"><span data-stu-id="dafa8-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="dafa8-303">Excel 2013 の **[Excel Services の認証設定]** ダイアログ ボックスの設定によって、Excel Services および [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] がデータ更新に使用する Windows ID が決まります。</span><span class="sxs-lookup"><span data-stu-id="dafa8-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="dafa8-304">**認証されたユーザーのアカウントを使用する**: Excel Services は、現在ログインしているユーザーの id でデータ更新を実行します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="dafa8-305">**[保存されたアカウントを使用する]:** SharePoint の Secure Store Service アプリケーションの ID が必要です。この ID を Excel Services で使用して、データ更新認証を認証するためのユーザー名とパスワードを取得します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="dafa8-306">**注:** Excel Services の **無人サービス アカウント** が使用されます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="dafa8-307">サービス アカウントは、Secure Store プロキシに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="dafa8-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="dafa8-308">**[外部データ]** セクションの **[Excel Services アプリケーションの設定]** ページの設定を構成します。</span><span class="sxs-lookup"><span data-stu-id="dafa8-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="dafa8-309">認証の設定のダイアログを開くには</span><span class="sxs-lookup"><span data-stu-id="dafa8-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="dafa8-310">Excel 2013 の **[データ]** タブをクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="dafa8-311">リボンで **[接続]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="dafa8-312">**[ブックの接続]** ダイアログで、接続を選択して **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="dafa8-313">[**接続プロパティ**] ダイアログボックスで、[**定義**] をクリックし、[**認証の設定.** ..] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="dafa8-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="dafa8-314">![[Excel Services の認証設定]](../media/as-authentication-settings-4-ecs-in-excel2013.gif "[Excel Services の認証設定]")</span><span class="sxs-lookup"><span data-stu-id="dafa8-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="dafa8-315">データ更新認証と資格情報の利用状況の詳細については、ブログ記事「 [SharePoint 2013 での PowerPivot データの更新](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dafa8-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="dafa8-316">その他の情報</span><span class="sxs-lookup"><span data-stu-id="dafa8-316">More Information</span></span>  
 <span data-ttu-id="dafa8-317">[PowerPivot データ更新のトラブルシューティング](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx)。</span><span class="sxs-lookup"><span data-stu-id="dafa8-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="dafa8-318">[SharePoint 2013 の Excel Services](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/)。</span><span class="sxs-lookup"><span data-stu-id="dafa8-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="dafa8-319">参照</span><span class="sxs-lookup"><span data-stu-id="dafa8-319">See Also</span></span>  
 <span data-ttu-id="dafa8-320">[SharePoint 2013&#41;&#40;のブックのアップグレードと定期データ更新](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="dafa8-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="dafa8-321">PowerPivot for SharePoint 2013 のインストール</span><span class="sxs-lookup"><span data-stu-id="dafa8-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
