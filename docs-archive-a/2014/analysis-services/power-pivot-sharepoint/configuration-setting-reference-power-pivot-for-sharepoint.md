---
title: 構成設定のリファレンス (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 3b57dd3f-7820-4ba8-b233-01dc68908273
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01a1c0d4c5273dccb6ba7057d1cd5c26a6f8890c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713593"
---
# <a name="configuration-setting-reference-powerpivot-for-sharepoint"></a><span data-ttu-id="4b891-102">構成設定のリファレンス (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="4b891-102">Configuration Setting Reference (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="4b891-103">ここでは、SharePoint ファームの PowerPivot サービス アプリケーションで使用される構成設定に関するリファレンス ドキュメントを提供します。</span><span class="sxs-lookup"><span data-stu-id="4b891-103">This topic provides reference documentation for configuration settings used by PowerPivot service applications in a SharePoint farm.</span></span> <span data-ttu-id="4b891-104">PowerShell スクリプトを使用してサーバーを構成している場合や、特定の設定に関する情報を必要としている場合は、このトピックの詳細な説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b891-104">If you are using PowerShell script to configure a server, or if you want to look up information for a specific setting, the information in this topic provides detailed descriptions.</span></span>  
  
 <span data-ttu-id="4b891-105">構成設定は、PowerPivot サービス アプリケーションごとに設定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-105">Configuration settings are set for each PowerPivot service application.</span></span> <span data-ttu-id="4b891-106">ファーム内で、同じ物理サービス インスタンスの独立した複数の論理インスタンスを構成する手段として、複数のサービス アプリケーションを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4b891-106">Within a farm, you can create multiple service applications as a way to configure independent logical instances of the same physical service instance.</span></span> <span data-ttu-id="4b891-107">構成設定は、構成するサービス アプリケーションごとに作成される PowerPivot アプリケーション データベースに格納されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-107">Configuration settings are stored in the PowerPivot application database created for each service application that you configure.</span></span>  
  
 <span data-ttu-id="4b891-108">構成設定を変更した場合、その変更は直ちに処理され、それ以降の要求や接続に使用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-108">If you change configuration settings, the changes are picked up immediately and used for subsequent requests and connections.</span></span> <span data-ttu-id="4b891-109">進行中の操作には、その操作が開始されたときに有効であった設定が適用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-109">Operations that are in progress are governed by the settings that were in effect when the operation began.</span></span>  
  
 <span data-ttu-id="4b891-110">構成に関する特定の領域については、次のリンクをクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="4b891-110">Click the following links to read about specific configuration areas:</span></span>  
  
 [<span data-ttu-id="4b891-111">データ読み込みのタイムアウト</span><span class="sxs-lookup"><span data-stu-id="4b891-111">Data Load Timeout</span></span>](#LoadingData)  
  
 [<span data-ttu-id="4b891-112">接続プール</span><span class="sxs-lookup"><span data-stu-id="4b891-112">Connection Pools</span></span>](#ConnectionPool)  
  
 [<span data-ttu-id="4b891-113">負荷分散</span><span class="sxs-lookup"><span data-stu-id="4b891-113">Load Balancing</span></span>](#AllocationScheme)  
  
 [<span data-ttu-id="4b891-114">データ更新</span><span class="sxs-lookup"><span data-stu-id="4b891-114">Data Refresh</span></span>](#DataRefresh)  
  
 [<span data-ttu-id="4b891-115">使用状況データ収集</span><span class="sxs-lookup"><span data-stu-id="4b891-115">Usage Data Collection</span></span>](#UsageData)  
  
 <span data-ttu-id="4b891-116">PowerPivot サービスアプリケーションを作成する方法については、「[サーバーの全体管理での Powerpivot サービスアプリケーションの作成と構成](create-and-configure-power-pivot-service-application-in-ca.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b891-116">For instructions on how to create a PowerPivot service application, see [Create and Configure a PowerPivot Service Application in Central Administration](create-and-configure-power-pivot-service-application-in-ca.md).</span></span>  
  
##  <a name="data-load-timeout"></a><a name="LoadingData"></a><span data-ttu-id="4b891-117">データ読み込みのタイムアウト</span><span class="sxs-lookup"><span data-stu-id="4b891-117">Data Load Timeout</span></span>  
 <span data-ttu-id="4b891-118">PowerPivot データは、ファームの Analysis Services サーバー インスタンスによって取得され、読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="4b891-118">PowerPivot data is retrieved and loaded by Analysis Services server instances in the farm.</span></span> <span data-ttu-id="4b891-119">いつどのようにデータに最後にアクセスしたかに応じて、コンテンツ ライブラリか、ローカル ファイル キャッシュから、データが読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="4b891-119">Depending on how and when the data was last accessed, it will either be loaded from a content library or from a local file cache.</span></span> <span data-ttu-id="4b891-120">データは、クエリ要求または処理要求を受け取るたびにメモリに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="4b891-120">Data is loaded into memory whenever a query or processing request is received.</span></span> <span data-ttu-id="4b891-121">サーバー全体の可用性を最大にするために、割り当てられた時間内にデータの読み込み要求を完了できない場合はその要求を停止するようにサーバーに指示するタイムアウト値を設定できます。</span><span class="sxs-lookup"><span data-stu-id="4b891-121">To maximize overall server availability, you can set a timeout value that instructs the server to stop a load data request if it cannot be completed within the allotted time.</span></span>  
  
|<span data-ttu-id="4b891-122">名前</span><span class="sxs-lookup"><span data-stu-id="4b891-122">Name</span></span>|<span data-ttu-id="4b891-123">Default</span><span class="sxs-lookup"><span data-stu-id="4b891-123">Default</span></span>|<span data-ttu-id="4b891-124">有効な値</span><span class="sxs-lookup"><span data-stu-id="4b891-124">Valid Values</span></span>|<span data-ttu-id="4b891-125">説明</span><span class="sxs-lookup"><span data-stu-id="4b891-125">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="4b891-126">データ読み込みのタイムアウト</span><span class="sxs-lookup"><span data-stu-id="4b891-126">Data Load Timeout</span></span>|<span data-ttu-id="4b891-127">1800 (秒)</span><span class="sxs-lookup"><span data-stu-id="4b891-127">1800 (in seconds)</span></span>|<span data-ttu-id="4b891-128">1 ～ 3600</span><span class="sxs-lookup"><span data-stu-id="4b891-128">1 to 3600</span></span>|<span data-ttu-id="4b891-129">PowerPivot サービス アプリケーションが特定の Analysis Services サーバー インスタンスからの応答を待機する時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-129">Specifies the amount of time a PowerPivot service application will wait for a response from a specific Analysis Services server instance.</span></span><br /><br /> <span data-ttu-id="4b891-130">既定では、サービス アプリケーションは、特定の要求の転送先となったエンジン サービス インスタンスからのデータ ペイロードを 30 分間待機します。</span><span class="sxs-lookup"><span data-stu-id="4b891-130">By default, the service application will wait 30 minutes for a data payload from the Engine service instance to which it forwarded a specific request.</span></span><br /><br /> <span data-ttu-id="4b891-131">この時間内に PowerPivot データ ソースを読み込むことができない場合、そのスレッドは停止され、新しいスレッドが開始されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-131">If the PowerPivot data source cannot be loaded within this period of time, the thread will be stopped and a new one will be started.</span></span>|  
  
##  <a name="connection-pools"></a><a name="ConnectionPool"></a><span data-ttu-id="4b891-132">接続プール</span><span class="sxs-lookup"><span data-stu-id="4b891-132">Connection Pools</span></span>  
 <span data-ttu-id="4b891-133">PowerPivot サービス アプリケーションでは、接続を再利用できるように、接続プールを作成して管理します。</span><span class="sxs-lookup"><span data-stu-id="4b891-133">The PowerPivot service application creates and manages connection pools to enable connection reuse.</span></span> <span data-ttu-id="4b891-134">2 種類の接続プールがあり、1 つは読み取り専用データに対するデータ接続用で、もう 1 つはサーバー接続用です。</span><span class="sxs-lookup"><span data-stu-id="4b891-134">There are two types of connection pools: one for data connections to read-only data, and a second for server connections.</span></span>  
  
 <span data-ttu-id="4b891-135">データ接続プールには、PowerPivot データ ソースのキャッシュされた接続が格納されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-135">Data connection pools contain cached connections for PowerPivot data source.</span></span> <span data-ttu-id="4b891-136">各接続プールは、データベースが読み込まれたときに設定されたコンテキストに基づきます。</span><span class="sxs-lookup"><span data-stu-id="4b891-136">Each connection pool is based on the context that was set when the database was loaded.</span></span> <span data-ttu-id="4b891-137">このコンテキストには、物理サービス インスタンスの ID、データベース ID、およびデータを要求している SharePoint ユーザーの ID が含まれます。</span><span class="sxs-lookup"><span data-stu-id="4b891-137">This context includes the identity of the physical service instance, the database ID, and the identity of the SharePoint user who is requesting data.</span></span> <span data-ttu-id="4b891-138">組み合わせごとに個別の接続プールが作成されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-138">A separate connection pool is created for each combination.</span></span> <span data-ttu-id="4b891-139">たとえば、同じサーバー上で実行されている同じデータベースの異なるユーザーからの要求では、異なるプールの接続が使用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-139">For example, requests from different users of the same database running on the same server will consume connections from different pools.</span></span>  
  
 <span data-ttu-id="4b891-140">接続プールの目的は、同じ SharePoint ユーザーによる同じ Analysis Services データベースに対する読み取り専用の要求には、キャッシュされた接続を使用することです。</span><span class="sxs-lookup"><span data-stu-id="4b891-140">The purpose of a connection pool is to use cached connections for read-only requests for the same Analysis Services database by the same SharePoint user.</span></span> <span data-ttu-id="4b891-141">PowerPivot サービス インスタンスは、データがメモリに読み込まれるサーバーです。</span><span class="sxs-lookup"><span data-stu-id="4b891-141">The PowerPivot service instance is the server that has the data loaded in memory.</span></span> <span data-ttu-id="4b891-142">データベース ID は、データ モデルのインメモリ データ構造体の内部識別子です (モデルは [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] キューブ データベースとしてインスタンス化されます)。</span><span class="sxs-lookup"><span data-stu-id="4b891-142">The database ID is an internal identifier for the in-memory data structures of the data model (a model is instantiated as an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] cube database).</span></span> <span data-ttu-id="4b891-143">この識別子にはバージョン情報が暗黙的に組み込まれます。</span><span class="sxs-lookup"><span data-stu-id="4b891-143">Version information is implicitly incorporated in the identifier.</span></span>  
  
 <span data-ttu-id="4b891-144">サーバー接続プールには、PowerPivot サービス アプリケーション インスタンスから Analysis Services サーバー インスタンスへのキャッシュされた接続が格納されます。この接続では、サービス アプリケーションは Analysis Services サーバーに対する [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] Sysadmin 権限を使用して接続しています。</span><span class="sxs-lookup"><span data-stu-id="4b891-144">Server connection pools contain cached connections from a PowerPivot service application instance to an Analysis Services server instance, where the service application is connecting with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] Sysadmin permissions on the Analysis Services server.</span></span> <span data-ttu-id="4b891-145">これらの接続は、データベースの読み込み要求の発行やシステムの状態の監視に使用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-145">These connections are used to issue a load database request and monitor system health.</span></span>  
  
 <span data-ttu-id="4b891-146">それぞれの種類の接続プールには、接続の管理上、システム メモリを最適に使用するために設定できる上限があります。</span><span class="sxs-lookup"><span data-stu-id="4b891-146">Each type of connection pool has upper limits that you can set to ensure best use of system memory for connection management.</span></span>  
  
|<span data-ttu-id="4b891-147">名前</span><span class="sxs-lookup"><span data-stu-id="4b891-147">Name</span></span>|<span data-ttu-id="4b891-148">Default</span><span class="sxs-lookup"><span data-stu-id="4b891-148">Default</span></span>|<span data-ttu-id="4b891-149">有効な値</span><span class="sxs-lookup"><span data-stu-id="4b891-149">Valid Values</span></span>|<span data-ttu-id="4b891-150">説明</span><span class="sxs-lookup"><span data-stu-id="4b891-150">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="4b891-151">接続プールのタイムアウト</span><span class="sxs-lookup"><span data-stu-id="4b891-151">Connection Pool Timeout</span></span>|<span data-ttu-id="4b891-152">1800 (秒)</span><span class="sxs-lookup"><span data-stu-id="4b891-152">1800 (in seconds)</span></span>|<span data-ttu-id="4b891-153">1 ～ 3600</span><span class="sxs-lookup"><span data-stu-id="4b891-153">1 to 3600.</span></span>|<span data-ttu-id="4b891-154">この設定はデータ接続プールに適用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-154">This setting applies to data connection pools.</span></span><br /><br /> <span data-ttu-id="4b891-155">接続プールでアイドル状態の接続が削除されるまでの時間を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-155">It specifies how much time an idle connection can remain in a connection pool before it is removed.</span></span><br /><br /> <span data-ttu-id="4b891-156">既定では、接続は非アクティブな状態が 5 分を超えるとサービス アプリケーションによって削除されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-156">By default, the service application will remove a connection if it is inactive for more than five minutes.</span></span>|  
|<span data-ttu-id="4b891-157">ユーザー接続プールの最大サイズ</span><span class="sxs-lookup"><span data-stu-id="4b891-157">Maximum User Connection Pool Size</span></span>|<span data-ttu-id="4b891-158">1000</span><span class="sxs-lookup"><span data-stu-id="4b891-158">1000</span></span>|<span data-ttu-id="4b891-159">-1、0、または 1 ～ 10000</span><span class="sxs-lookup"><span data-stu-id="4b891-159">-1, 0, or 1 to 10000.</span></span><br /><br /> <span data-ttu-id="4b891-160">-1 を指定した場合、アイドル状態の接続数に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="4b891-160">-1 specifies an unlimited number of idle connections.</span></span><br /><br /> <span data-ttu-id="4b891-161">0 を指定した場合、アイドル状態の接続は一切保持されません。</span><span class="sxs-lookup"><span data-stu-id="4b891-161">0 means no idle connections are kept.</span></span> <span data-ttu-id="4b891-162">PowerPivot データ ソースへの新しい接続を毎回作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4b891-162">New connections to a PowerPivot data source must be created each time.</span></span>|<span data-ttu-id="4b891-163">この設定は、特定の PowerPivot サービス アプリケーション インスタンスに対して作成されたすべてのデータ接続プールにおけるアイドル状態の接続数に適用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-163">This setting applies to the number of idle connections in all data connection pools created for a specific PowerPivot service application instance.</span></span><br /><br /> <span data-ttu-id="4b891-164">SharePoint ユーザー、PowerPivot データ、およびサービス インスタンスの一意の組み合わせに対して、個別の接続プールが作成されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-164">Individual connection pools are created for unique combinations of a SharePoint user, PowerPivot data, and service instance.</span></span> <span data-ttu-id="4b891-165">さまざまな PowerPivot データ ソースに多数のユーザーがアクセスする場合、接続プールのサイズを大きくすると、サーバーのパフォーマンスが向上することがあります。</span><span class="sxs-lookup"><span data-stu-id="4b891-165">If you have many users accessing a variety of PowerPivot data sources, server performance might benefit from an increase in connection pool size.</span></span><br /><br /> <span data-ttu-id="4b891-166">PowerPivot サービス インスタンスへのアイドル状態の接続数が 100 を超えると、新たなアイドル状態の接続はプールに返されずに切断されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-166">If there are more than 100 idle connections to a PowerPivot service instance, newly idle connections are disconnected rather than returned to the pool.</span></span>|  
|<span data-ttu-id="4b891-167">管理接続プールの最大サイズ</span><span class="sxs-lookup"><span data-stu-id="4b891-167">Maximum Administrative Connection Pool Size</span></span>|<span data-ttu-id="4b891-168">200</span><span class="sxs-lookup"><span data-stu-id="4b891-168">200</span></span>|<span data-ttu-id="4b891-169">-1、0、または 1 ～ 10000</span><span class="sxs-lookup"><span data-stu-id="4b891-169">-1, 0, or 1 to 10000.</span></span><br /><br /> <span data-ttu-id="4b891-170">-1 を指定した場合、アイドル状態の接続数に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="4b891-170">-1 specifies an unlimited number of idle connections.</span></span>|<span data-ttu-id="4b891-171">Analysis Services サーバー インスタンスへの PowerPivot サービス アプリケーション接続に対して作成されたすべての管理接続プールにおけるアイドル状態のサーバー接続の最大数。</span><span class="sxs-lookup"><span data-stu-id="4b891-171">The maximum number of idle server connections in all administrative connection pools created for PowerPivot service application connections to an Analysis Services server instance.</span></span> <span data-ttu-id="4b891-172">サーバー接続は、データベースを読み込む場合や SharePoint データベースに変更を保存する場合の要求に使用されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-172">Server connections are used for requests to load databases and to save changes back to the SharePoint database.</span></span>|  
  
##  <a name="load-balancing"></a><a name="AllocationScheme"></a><span data-ttu-id="4b891-173">負荷分散</span><span class="sxs-lookup"><span data-stu-id="4b891-173">Load Balancing</span></span>  
 <span data-ttu-id="4b891-174">PowerPivot サービスが実行する機能の 1 つは、使用可能な PowerPivot サービス インスタンスのうち、どこに Analysis Services データを読み込むかを決定することです。</span><span class="sxs-lookup"><span data-stu-id="4b891-174">One of the functions that the PowerPivot service performs is to determine where Analysis Services data will be loaded among the available PowerPivot service instances.</span></span> <span data-ttu-id="4b891-175">`AllocationMethod` の設定は、どのサービス インスタンスが選択されるかに対する条件を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-175">The `AllocationMethod` setting specifies the criteria against which a service instance is selected.</span></span>  
  
|<span data-ttu-id="4b891-176">名前</span><span class="sxs-lookup"><span data-stu-id="4b891-176">Name</span></span>|<span data-ttu-id="4b891-177">Default</span><span class="sxs-lookup"><span data-stu-id="4b891-177">Default</span></span>|<span data-ttu-id="4b891-178">有効な値</span><span class="sxs-lookup"><span data-stu-id="4b891-178">Valid Values</span></span>|<span data-ttu-id="4b891-179">説明</span><span class="sxs-lookup"><span data-stu-id="4b891-179">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="4b891-180">割り当て方法</span><span class="sxs-lookup"><span data-stu-id="4b891-180">Allocation Method</span></span>|<span data-ttu-id="4b891-181">RoundRobin</span><span class="sxs-lookup"><span data-stu-id="4b891-181">RoundRobin</span></span>|<span data-ttu-id="4b891-182">ラウンド ロビン</span><span class="sxs-lookup"><span data-stu-id="4b891-182">Round Robin</span></span><br /><br /> <span data-ttu-id="4b891-183">ヘルス ベース</span><span class="sxs-lookup"><span data-stu-id="4b891-183">Health Based</span></span>|<span data-ttu-id="4b891-184">2 つ以上の Analysis Services サーバー インスタンス間で読み込み要求を割り当てる方式。</span><span class="sxs-lookup"><span data-stu-id="4b891-184">A scheme for allocating load requests among two or more Analysis Services server instances.</span></span><br /><br /> <span data-ttu-id="4b891-185">既定では、PowerPivot サービスはサーバーの状態に応じて要求を振り替えます。</span><span class="sxs-lookup"><span data-stu-id="4b891-185">By default, the PowerPivot service will alternate requests based on server health.</span></span> <span data-ttu-id="4b891-186">ヘルス ベースでは、使用可能なメモリおよび CPU 使用率に基づいて、使用できるシステム リソースが最も多いサーバーに要求が割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="4b891-186">Health based allocates requests to the server that has the most system resources available based on available memory and CPU utilization.</span></span><br /><br /> <span data-ttu-id="4b891-187">ラウンド ロビンでは、現在の読み込みの状態やサーバーの状態に関係なく、使用可能なサーバーに順番に要求が割り振られます。</span><span class="sxs-lookup"><span data-stu-id="4b891-187">Round robin rotates requests amongst the available servers in sequential order, regardless of current load or server health.</span></span>|  
  
##  <a name="data-refresh"></a><a name="DataRefresh"></a> <span data-ttu-id="4b891-188">データ更新</span><span class="sxs-lookup"><span data-stu-id="4b891-188">Data Refresh</span></span>  
 <span data-ttu-id="4b891-189">組織の通常の営業時間を定義する時間の範囲を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-189">Specify the range of hours that defines a normal or typical business day for your organization.</span></span> <span data-ttu-id="4b891-190">これらの構成設定は、データ更新操作で営業時間後のデータ処理を行うタイミングを決定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-190">These configuration settings determine when after-hours data processing occurs for data refresh operations.</span></span> <span data-ttu-id="4b891-191">営業時間後の処理は、営業時間の終了時刻に開始できます。</span><span class="sxs-lookup"><span data-stu-id="4b891-191">After-hours processing can begin at the end time of the business day.</span></span> <span data-ttu-id="4b891-192">営業時間後の処理は、通常の営業時間中に生成されたトランザクション データによる PowerPivot データ ソースの更新を必要とするドキュメント所有者に対するスケジュール オプションです。</span><span class="sxs-lookup"><span data-stu-id="4b891-192">After-hours processing is a schedule option for document owners who want to refresh a PowerPivot data source with transactional data that was generated during normal business hours.</span></span>  
  
|<span data-ttu-id="4b891-193">名前</span><span class="sxs-lookup"><span data-stu-id="4b891-193">Name</span></span>|<span data-ttu-id="4b891-194">Default</span><span class="sxs-lookup"><span data-stu-id="4b891-194">Default</span></span>|<span data-ttu-id="4b891-195">有効な値</span><span class="sxs-lookup"><span data-stu-id="4b891-195">Valid values</span></span>|<span data-ttu-id="4b891-196">説明</span><span class="sxs-lookup"><span data-stu-id="4b891-196">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="4b891-197">開始時刻</span><span class="sxs-lookup"><span data-stu-id="4b891-197">Start time</span></span>|<span data-ttu-id="4b891-198">午前 04 時 00 分</span><span class="sxs-lookup"><span data-stu-id="4b891-198">04:00 a.m.</span></span>|<span data-ttu-id="4b891-199">有効な範囲は、1 ～ 12 時の範囲の有効な整数です。</span><span class="sxs-lookup"><span data-stu-id="4b891-199">1 to 12 hours, where the value is a valid integer within that range.</span></span><br /><br /> <span data-ttu-id="4b891-200">型は Time です。</span><span class="sxs-lookup"><span data-stu-id="4b891-200">Type is Time.</span></span>|<span data-ttu-id="4b891-201">営業時間の範囲の下限を設定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-201">Sets the lower limit of a business hour range.</span></span>|  
|<span data-ttu-id="4b891-202">終了時刻</span><span class="sxs-lookup"><span data-stu-id="4b891-202">End time</span></span>|<span data-ttu-id="4b891-203">午後 08 時 00 分</span><span class="sxs-lookup"><span data-stu-id="4b891-203">08:00 p.m.</span></span>|<span data-ttu-id="4b891-204">有効な範囲は、1 ～ 12 時の範囲の有効な整数です。</span><span class="sxs-lookup"><span data-stu-id="4b891-204">1 to 12 hours, where the value is a valid integer within that range.</span></span><br /><br /> <span data-ttu-id="4b891-205">型は Time です。</span><span class="sxs-lookup"><span data-stu-id="4b891-205">Type is Time.</span></span>|<span data-ttu-id="4b891-206">営業時間の範囲の上限を設定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-206">Sets the upper limit of a business hour range.</span></span>|  
|<span data-ttu-id="4b891-207">PowerPivot 自動データ更新アカウント</span><span class="sxs-lookup"><span data-stu-id="4b891-207">PowerPivot Unattended Data Refresh Account</span></span>|<span data-ttu-id="4b891-208">なし</span><span class="sxs-lookup"><span data-stu-id="4b891-208">None</span></span>|<span data-ttu-id="4b891-209">対象アプリケーション ID</span><span class="sxs-lookup"><span data-stu-id="4b891-209">A target application ID</span></span>|<span data-ttu-id="4b891-210">このアカウントは、スケジュールの所有者に代わってデータ更新ジョブを実行するために使用します。</span><span class="sxs-lookup"><span data-stu-id="4b891-210">This account is used to run data refresh jobs on behalf of a schedule owner.</span></span><br /><br /> <span data-ttu-id="4b891-211">自動データ更新アカウントをサービス アプリケーションの構成ページで参照するには、あらかじめ定義しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="4b891-211">The unattended data refresh account must be defined in advance before it can be referenced in the service application configuration page.</span></span> <span data-ttu-id="4b891-212">詳細については、「 [PowerPivot 自動データ更新アカウントの構成 &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b891-212">For more information, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>|  
|<span data-ttu-id="4b891-213">ユーザーによるカスタムの Windows 資格情報の入力を許可する</span><span class="sxs-lookup"><span data-stu-id="4b891-213">Allow users to enter custom Windows credentials</span></span>|<span data-ttu-id="4b891-214">Enabled</span><span class="sxs-lookup"><span data-stu-id="4b891-214">Enabled</span></span>|<span data-ttu-id="4b891-215">Boolean</span><span class="sxs-lookup"><span data-stu-id="4b891-215">Boolean</span></span>|<span data-ttu-id="4b891-216">スケジュールの所有者が Windows ユーザー アカウントとパスワードを指定してデータ更新ジョブを実行できるようにするオプションを定期データ更新の構成ページに表示するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-216">Determines whether the scheduled data refresh configuration page shows an option that allows a schedule owner to specify Windows user account and password to run a data refresh job.</span></span><br /><br /> <span data-ttu-id="4b891-217">このオプションを使用するには、Secure Store Service を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="4b891-217">Secure Store Service must be enabled in order for this option to work.</span></span> <span data-ttu-id="4b891-218">詳細については、「[PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b891-218">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>|  
|<span data-ttu-id="4b891-219">処理履歴の最大の長さ</span><span class="sxs-lookup"><span data-stu-id="4b891-219">Maximum Processing History Length</span></span>|<span data-ttu-id="4b891-220">365</span><span class="sxs-lookup"><span data-stu-id="4b891-220">365</span></span>|<span data-ttu-id="4b891-221">1 ～ 5000 日</span><span class="sxs-lookup"><span data-stu-id="4b891-221">1 to 5000 days</span></span>|<span data-ttu-id="4b891-222">データ更新履歴を PowerPivot サービス アプリケーション データベースに保持しておく期間を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-222">Determines how long data refresh history is retained in the PowerPivot service application database.</span></span> <span data-ttu-id="4b891-223">詳細については、「 [PowerPivot Usage Data Collection](power-pivot-usage-data-collection.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b891-223">For more information, see [PowerPivot Usage Data Collection](power-pivot-usage-data-collection.md).</span></span>|  
  
##  <a name="usage-data-collection"></a><a name="UsageData"></a><span data-ttu-id="4b891-224">使用状況データ収集</span><span class="sxs-lookup"><span data-stu-id="4b891-224">Usage Data Collection</span></span>  
 <span data-ttu-id="4b891-225">PowerPivot 管理ダッシュボードに表示される使用状況レポートは、PowerPivot 対応のブックの使用方法に関する重要な情報を提供できます。</span><span class="sxs-lookup"><span data-stu-id="4b891-225">Usage reports that appear in the PowerPivot Management Dashboard can provide important information about how PowerPivot-enabled workbooks are used.</span></span> <span data-ttu-id="4b891-226">次の構成設定は、使用状況レポートに示される PowerPivot サーバー イベントの使用状況データ収集の各側面を制御します。</span><span class="sxs-lookup"><span data-stu-id="4b891-226">The following configuration settings control aspects of usage data collection for PowerPivot server events that are subsequently presented in usage or activity reports.</span></span>  
  
|<span data-ttu-id="4b891-227">名前</span><span class="sxs-lookup"><span data-stu-id="4b891-227">Name</span></span>|<span data-ttu-id="4b891-228">Default</span><span class="sxs-lookup"><span data-stu-id="4b891-228">Default</span></span>|<span data-ttu-id="4b891-229">有効な値</span><span class="sxs-lookup"><span data-stu-id="4b891-229">Valid values</span></span>|<span data-ttu-id="4b891-230">説明</span><span class="sxs-lookup"><span data-stu-id="4b891-230">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="4b891-231">クエリをレポートする間隔</span><span class="sxs-lookup"><span data-stu-id="4b891-231">Query Reporting Interval</span></span>|<span data-ttu-id="4b891-232">300 (秒)</span><span class="sxs-lookup"><span data-stu-id="4b891-232">300 (in seconds)</span></span>|<span data-ttu-id="4b891-233">1 ～ n 秒 (n は任意の有効な整数)。</span><span class="sxs-lookup"><span data-stu-id="4b891-233">1 to n seconds, where n is any valid integer.</span></span>|<span data-ttu-id="4b891-234">使用状況データ収集によってファームのデータ転送容量が過度に消費されないようにするため、接続ごとにクエリ統計情報が収集され、単一のイベントとしてレポートされます。</span><span class="sxs-lookup"><span data-stu-id="4b891-234">To ensure that usage data collection does not consume too much of the data transfer capacity of the farm, query statistics are collected on each connection and reported as a single event.</span></span> <span data-ttu-id="4b891-235">[クエリをレポートする間隔] は、イベントがレポートされる頻度を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-235">The Query Reporting Interval determines how often an event is reported.</span></span> <span data-ttu-id="4b891-236">既定では、クエリ統計情報は 5 分おきにレポートされます。</span><span class="sxs-lookup"><span data-stu-id="4b891-236">By default, query statistics are reported every 5 minutes.</span></span><br /><br /> <span data-ttu-id="4b891-237">接続は要求が送信されるとすぐに閉じられるので、1 人のユーザーが 1 つの PowerPivot データ ソースにアクセスする場合でも、非常に多数の接続が生成されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-237">Because connections are immediately closed as soon as a request is sent, the system generates a very large number of connections for even a single user accessing a single PowerPivot data source.</span></span> <span data-ttu-id="4b891-238">このため、接続が一度作成された後は、同じデータに対する同じユーザーがその接続を再利用できるように、ユーザーと PowerPivot データ ソースの組み合わせごとに接続プールが作成されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-238">For this reason, connection pools are created for each user and PowerPivot data source combination so that once a connection is created it can be reused by the same user for the same data.</span></span> <span data-ttu-id="4b891-239">定期的に、この構成設定で指定した間隔で、PowerPivot サービス アプリケーションによって接続プールの接続ごとに使用状況データがレポートされます。</span><span class="sxs-lookup"><span data-stu-id="4b891-239">Periodically, at intervals specified through this configuration setting, the PowerPivot service application reports the usage data for each connection in the connection pool.</span></span><br /><br /> <span data-ttu-id="4b891-240">このレポート間隔の値を大きくすると、ログに記録されるイベントが少なくなります。</span><span class="sxs-lookup"><span data-stu-id="4b891-240">Increasing the time-to-report value will cause fewer events to be logged.</span></span> <span data-ttu-id="4b891-241">ただし、値を大きくしすぎると、サーバーが再起動した場合や接続が閉じられた場合に、イベント データが失われることがあります。</span><span class="sxs-lookup"><span data-stu-id="4b891-241">However, if you set it too high, you risk losing event data if the server restarts or a connection is closed.</span></span><br /><br /> <span data-ttu-id="4b891-242">この値を小さくすると、頻度が高くなることでログに記録されるイベントが多くなり、SharePoint の使用状況データベースのデータ コレクション システムに追加される PowerPivot 関連の使用状況データが増加します。</span><span class="sxs-lookup"><span data-stu-id="4b891-242">Lowering the value will cause more events to be logged with greater frequency, adding more PowerPivot-related usage data to the data collection system in the SharePoint usage database.</span></span><br /><br /> <span data-ttu-id="4b891-243">通常は、特定の問題 (PowerPivot 使用状況データが原因で使用状況データベースが急激に大きくなっている場合など) を解決しようとしている場合を除き、この構成設定は変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="4b891-243">Generally, do not change this configuration setting unless you are trying to resolve a specific problem (for example, if the usage database is growing too quickly as a result of PowerPivot usage data).</span></span>|  
|<span data-ttu-id="4b891-244">使用状況データ履歴</span><span class="sxs-lookup"><span data-stu-id="4b891-244">Usage Data History</span></span>|<span data-ttu-id="4b891-245">365 (日)</span><span class="sxs-lookup"><span data-stu-id="4b891-245">365 (in days)</span></span>|<span data-ttu-id="4b891-246">0、または 1 ～ n 日 (n は任意の有効な整数)。</span><span class="sxs-lookup"><span data-stu-id="4b891-246">0, or 1 to n days, where n is any valid integer.</span></span><br /><br /> <span data-ttu-id="4b891-247">0 を指定した場合、履歴は常に保持され、削除されません。</span><span class="sxs-lookup"><span data-stu-id="4b891-247">0 means that history is always retained and never deleted.</span></span>|<span data-ttu-id="4b891-248">既定では、使用状況データは、PowerPivot サービス アプリケーション データベースに 1 年間保存されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-248">By default, usage data is kept for one year in the PowerPivot service application database.</span></span> <span data-ttu-id="4b891-249">1 年を経過したレコードはデータベースから削除されます。</span><span class="sxs-lookup"><span data-stu-id="4b891-249">Records that are older than one year are dropped from the database.</span></span><br /><br /> <span data-ttu-id="4b891-250">期限切れの履歴データのチェックは、Microsoft SharePoint Foundation の使用状況データ処理ジョブが実行されるときに、毎日行われます。</span><span class="sxs-lookup"><span data-stu-id="4b891-250">A check for expired historical data occurs daily, when the Microsoft SharePoint Foundation Usage Data Processing job runs.</span></span> <span data-ttu-id="4b891-251">このタイマー ジョブは、この設定を読み取り、PowerPivot サービス アプリケーション データベース内にある期限切れの履歴に対してデータ削除コマンドを起動します。</span><span class="sxs-lookup"><span data-stu-id="4b891-251">The timer job will read this setting and trigger a data deletion command for expired history in the PowerPivot service application database.</span></span>|  
|<span data-ttu-id="4b891-252">[簡易応答の上限]</span><span class="sxs-lookup"><span data-stu-id="4b891-252">Trivial Response Upper Limit</span></span>|<span data-ttu-id="4b891-253">500 (ミリ秒単位)</span><span class="sxs-lookup"><span data-stu-id="4b891-253">500 (in milliseconds)</span></span>|<span data-ttu-id="4b891-254">1 ～ n ミリ秒 (n は任意の有効な整数)。</span><span class="sxs-lookup"><span data-stu-id="4b891-254">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="4b891-255">既定では、簡易要求のしきい値は 0.5 秒です。</span><span class="sxs-lookup"><span data-stu-id="4b891-255">By default, the threshold for trivial requests is half a second.</span></span><br /><br /> <span data-ttu-id="4b891-256">簡易要求としては、サーバーの ping、メタデータに対する要求、セッションの開始があります。</span><span class="sxs-lookup"><span data-stu-id="4b891-256">Trivial requests include server pings, requests for metadata, and starting sessions.</span></span>|  
|<span data-ttu-id="4b891-257">迅速な応答の上限</span><span class="sxs-lookup"><span data-stu-id="4b891-257">Quick Response Upper Limit</span></span>|<span data-ttu-id="4b891-258">1000 (ミリ秒単位)</span><span class="sxs-lookup"><span data-stu-id="4b891-258">1000 (in milliseconds)</span></span>|<span data-ttu-id="4b891-259">1 ～ n ミリ秒 (n は任意の有効な整数)。</span><span class="sxs-lookup"><span data-stu-id="4b891-259">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="4b891-260">既定では、迅速な要求のしきい値は 1 秒です。</span><span class="sxs-lookup"><span data-stu-id="4b891-260">By default, the threshold for quick requests is one second.</span></span><br /><br /> <span data-ttu-id="4b891-261">迅速な要求は、非常に小さいデータセットを持つ要求、または多数のメンバー セットにまたがるメタデータに対する要求です。</span><span class="sxs-lookup"><span data-stu-id="4b891-261">Quick requests are those that have an extremely small dataset, or requests for metadata that span large member sets.</span></span>|  
|<span data-ttu-id="4b891-262">[想定される応答の上限]</span><span class="sxs-lookup"><span data-stu-id="4b891-262">Expected Response Upper Limit</span></span>|<span data-ttu-id="4b891-263">3000 (ミリ秒単位)</span><span class="sxs-lookup"><span data-stu-id="4b891-263">3000 (in milliseconds)</span></span>|<span data-ttu-id="4b891-264">1 ～ n ミリ秒 (n は任意の有効な整数)。</span><span class="sxs-lookup"><span data-stu-id="4b891-264">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="4b891-265">既定では、想定される要求のしきい値は 3 秒です。</span><span class="sxs-lookup"><span data-stu-id="4b891-265">By default, the threshold for expected requests is three seconds.</span></span><br /><br /> <span data-ttu-id="4b891-266">このしきい値は想定されるクエリ時間の上限を設定します。</span><span class="sxs-lookup"><span data-stu-id="4b891-266">This threshold sets the upper limit of an expected query time.</span></span>|  
|<span data-ttu-id="4b891-267">長い応答の上限</span><span class="sxs-lookup"><span data-stu-id="4b891-267">Long Response Upper Limit</span></span>|<span data-ttu-id="4b891-268">10,000 (ミリ秒)</span><span class="sxs-lookup"><span data-stu-id="4b891-268">10000 (in milliseconds)</span></span>|<span data-ttu-id="4b891-269">1 ～ n ミリ秒 (n は任意の有効な整数)。</span><span class="sxs-lookup"><span data-stu-id="4b891-269">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="4b891-270">既定では、長い要求のしきい値は 10 秒です。</span><span class="sxs-lookup"><span data-stu-id="4b891-270">By default, the threshold for long requests is ten seconds.</span></span><br /><br /> <span data-ttu-id="4b891-271">長い要求は、想定よりも長い時間実行されるが許容範囲内である要求です。</span><span class="sxs-lookup"><span data-stu-id="4b891-271">These are requests that run longer than expected, but still fall within an acceptable range.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4b891-272">参照</span><span class="sxs-lookup"><span data-stu-id="4b891-272">See Also</span></span>  
 <span data-ttu-id="4b891-273">[サーバーの全体管理での PowerPivot サービスアプリケーションの作成と構成](create-and-configure-power-pivot-service-application-in-ca.md) </span><span class="sxs-lookup"><span data-stu-id="4b891-273">[Create and Configure a PowerPivot Service Application in Central Administration](create-and-configure-power-pivot-service-application-in-ca.md) </span></span>  
 <span data-ttu-id="4b891-274">[SharePoint 2010 での PowerPivot データ更新](../powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="4b891-274">[PowerPivot Data Refresh with SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="4b891-275">[&#40;PowerPivot for SharePoint の使用状況データ収集の構成](configure-usage-data-collection-for-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="4b891-275">[Configure Usage Data Collection for &#40;PowerPivot for SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md) </span></span>  
 <span data-ttu-id="4b891-276">[PowerPivot サービスアカウントの構成](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="4b891-276">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 [<span data-ttu-id="4b891-277">PowerPivot 管理ダッシュボードと使用状況データ</span><span class="sxs-lookup"><span data-stu-id="4b891-277">PowerPivot Management Dashboard and Usage Data</span></span>](power-pivot-management-dashboard-and-usage-data.md)  
  
  
