---
title: サーバーの全体管理で PowerPivot サービスアプリケーションを作成および構成する |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b2e5693e-4af3-453f-83f3-07481ab1ac6a
author: minewiskan
ms.author: owend
ms.openlocfilehash: 8becac1ecce25b6798dc727a00a3f5b0afed572c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713590"
---
# <a name="create-and-configure-a-powerpivot-service-application-in-central-administration"></a><span data-ttu-id="d6818-102">サーバーの全体管理での PowerPivot サービス アプリケーションの作成および構成</span><span class="sxs-lookup"><span data-stu-id="d6818-102">Create and Configure a PowerPivot Service Application in Central Administration</span></span>
  <span data-ttu-id="d6818-103">PowerPivot サービス アプリケーションは、PowerPivot System サービスの共有サービス インスタンスです。</span><span class="sxs-lookup"><span data-stu-id="d6818-103">A PowerPivot service application is a shared service instance of the PowerPivot System Service.</span></span> <span data-ttu-id="d6818-104">各サービス アプリケーションは、固有のアプリケーション ID、構成設定、プロパティ、および内部データ ストレージを備えています。</span><span class="sxs-lookup"><span data-stu-id="d6818-104">Each service application has its own application identity, configuration settings, properties, and internal data storage.</span></span>  
  
 <span data-ttu-id="d6818-105">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="d6818-105">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="d6818-106">新しい PowerPivot サービス アプリケーションを作成するかどうかの決定</span><span class="sxs-lookup"><span data-stu-id="d6818-106">Determine whether to create a new PowerPivot Service Application</span></span>](#determine)  
  
 [<span data-ttu-id="d6818-107">PowerPivot サービスアプリケーションの作成</span><span class="sxs-lookup"><span data-stu-id="d6818-107">Create a PowerPivot Service Application</span></span>](#CreateApp)  
  
 [<span data-ttu-id="d6818-108">PowerPivot サービス アプリケーションの構成</span><span class="sxs-lookup"><span data-stu-id="d6818-108">Configure the PowerPivot Service Application</span></span>](#ConfigApp)  
  
 [<span data-ttu-id="d6818-109">PowerPivot サービス アプリケーションの Web アプリケーションへの割り当て</span><span class="sxs-lookup"><span data-stu-id="d6818-109">Assign a PowerPivot Service Application to a Web Application</span></span>](#AssignGSA)  
  
 [<span data-ttu-id="d6818-110">サービスアプリケーションのプロパティの編集</span><span class="sxs-lookup"><span data-stu-id="d6818-110">Edit Service Application Properties</span></span>](#EditGSA)  
  
##  <a name="determine-whether-to-create-a-new-powerpivot-service-application"></a><a name="determine"></a><span data-ttu-id="d6818-111">新しい PowerPivot サービスアプリケーションを作成するかどうかを判断する</span><span class="sxs-lookup"><span data-stu-id="d6818-111">Determine whether to create a new PowerPivot Service Application</span></span>  
 <span data-ttu-id="d6818-112">PowerPivot for SharePoint のインストールでは、ファーム内に少なくとも 1 つの PowerPivot サービス アプリケーションが必要になります。</span><span class="sxs-lookup"><span data-stu-id="d6818-112">A PowerPivot for SharePoint installation must have at least one PowerPivot service application in the farm.</span></span> <span data-ttu-id="d6818-113">PowerPivot 構成ツールを使用してサーバーを構成した場合は、サービス アプリケーションが自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-113">A service application is created automatically if you used the PowerPivot Configuration Tool to configure the server.</span></span> <span data-ttu-id="d6818-114">そうでない場合は、サーバーの全体管理で PowerPivot サービス アプリケーションを手動で作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-114">Otherwise, you must create a PowerPivot service application manually in Central Administration.</span></span>  
  
 <span data-ttu-id="d6818-115">サービス アプリケーションを作成すると、サービスが使用可能になり、サービス アプリケーション データベースが生成されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-115">Creating a service application makes the service available and generates the service application database.</span></span> <span data-ttu-id="d6818-116">また、サービス アプリケーションの作成時に選択したオプションによっては、既定のサービス接続のグループに PowerPivot サービス接続が追加されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-116">Depending on options you select when creating the service application, a PowerPivot service connection is added to the default service connection group.</span></span> <span data-ttu-id="d6818-117">これにより、既定のサービス接続のグループにサブスクライブしているすべての SharePoint Web アプリケーションが、自動的かつ直ちに PowerPivot サービス アプリケーションにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="d6818-117">All SharePoint Web applications that subscribe to the default service connection group will get immediate access to the PowerPivot service application automatically.</span></span>  
  
 <span data-ttu-id="d6818-118">複数の PowerPivot サービス アプリケーションを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="d6818-118">You can create multiple PowerPivot service applications.</span></span> <span data-ttu-id="d6818-119">ほとんどの配置シナリオでは 1 つで十分ですが、次のようなビジネスの要件がある場合は、追加の PowerPivot サービス アプリケーションを作成することを検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-119">Although one service application is sufficient for most deployment scenarios, you might consider creating an additional PowerPivot service application if your business requirements include the following:</span></span>  
  
-   <span data-ttu-id="d6818-120">アプリケーションごとに異なる自動 PowerPivot データ更新アカウントを使用する場合。</span><span class="sxs-lookup"><span data-stu-id="d6818-120">Using a different unattended PowerPivot data refresh account for each application.</span></span>  
  
-   <span data-ttu-id="d6818-121">異なるタイムアウト、使用状況履歴、およびクエリ応答レポートのしきい値を使用する場合。</span><span class="sxs-lookup"><span data-stu-id="d6818-121">Using different timeouts, usage history, and thresholds for query response reporting.</span></span>  
  
-   <span data-ttu-id="d6818-122">サービスの管理を別のユーザーに委任する場合。</span><span class="sxs-lookup"><span data-stu-id="d6818-122">Delegating service administration to different people.</span></span> <span data-ttu-id="d6818-123">管理者は、自分が管理しているアプリケーションについてのみ、データ更新の履歴や使用状況データなどのプロパティを表示できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-123">An administrator will see data refresh history, usage data, and other properties only for the application he or she is administering.</span></span> <span data-ttu-id="d6818-124">SharePoint Web アプリケーションを分離する必要がある場合 (顧客ごとの SharePoint Web アプリケーションのデータの分離を保証するホスティング サービスを提供している場合など) は、別の PowerPivot サービス アプリケーションを作成して、各サービス管理者に自分が管理しているアプリケーションの構成設定とプロパティしか表示されないようにすることで、分離の要件を満たすことができます。</span><span class="sxs-lookup"><span data-stu-id="d6818-124">If you are required to isolate SharePoint web applications (for example, if your company is a hosting service that must guarantee data isolation for the SharePoint Web applications that belong to different customers), creating separate PowerPivot service applications can help meet isolation requirements by ensuring each service administrator sees only the configuration settings and properties for the application he or she manages.</span></span>  
  
 <span data-ttu-id="d6818-125">追加のサービス アプリケーションを作成する場合は、サービスの関連付けの管理に関する新たな要件として、</span><span class="sxs-lookup"><span data-stu-id="d6818-125">Creating additional service application introduces new requirements for managing service associations.</span></span> <span data-ttu-id="d6818-126">サービス アプリケーションを追加するたびにカスタム サービス関連付けリストを作成して使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-126">Namely, it will require that you create and use custom service association lists for each additional service application that you create.</span></span>  
  
 <span data-ttu-id="d6818-127">追加の PowerPivot サービス アプリケーションを作成する理由が特にない場合は、ファーム内のすべての Web アプリケーションに対して 1 つのサービス アプリケーションを使用してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-127">If you do not have a specific reason for creating additional PowerPivot service application, you should use a single service application for all of the Web applications in the farm.</span></span>  
  
##  <a name="create-a-powerpivot-service-application"></a><a name="CreateApp"></a><span data-ttu-id="d6818-128">PowerPivot サービスアプリケーションの作成</span><span class="sxs-lookup"><span data-stu-id="d6818-128">Create a PowerPivot Service Application</span></span>  
  
1.  <span data-ttu-id="d6818-129">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-129">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="d6818-130">**[サービス アプリケーション]** リボンで、 **[新規作成]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-130">In the **Service Applications** ribbon, click **New**.</span></span>  
  
3.  <span data-ttu-id="d6818-131">[ **PowerPivot サービスアプリケーションの SQL Server**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="d6818-131">Select **SQL Server PowerPivot Service Application**.</span></span> <span data-ttu-id="d6818-132">この項目が一覧に表示されない場合は、PowerPivot for SharePoint がインストールされていないか、正しく構成されていません。</span><span class="sxs-lookup"><span data-stu-id="d6818-132">If it does not appear in the list, PowerPivot for SharePoint is not installed or configured correctly.</span></span>  
  
4.  <span data-ttu-id="d6818-133">[**新しい PowerPivot サービスアプリケーションの作成**] ページで、アプリケーションの名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="d6818-133">In the **Create New PowerPivot Service Application** page, enter a name for the application.</span></span> <span data-ttu-id="d6818-134">既定値は Remove-powerpivotserviceapplication \<number> です。</span><span class="sxs-lookup"><span data-stu-id="d6818-134">The default is PowerPivotServiceApplication\<number>.</span></span> <span data-ttu-id="d6818-135">複数の PowerPivot サービス アプリケーションを作成する場合は、それぞれの用途を明確に示す名前を付けると他の管理者にわかりやすくなります。</span><span class="sxs-lookup"><span data-stu-id="d6818-135">If you are creating multiple PowerPivot service applications, a descriptive name will help other administrators understand how the application is used.</span></span>  
  
5.  <span data-ttu-id="d6818-136">[アプリケーション プール] で、このアプリケーションのための新しいアプリケーション プールを作成し (推奨)、</span><span class="sxs-lookup"><span data-stu-id="d6818-136">In Application Pool, create a new application pool for the application (recommended).</span></span> <span data-ttu-id="d6818-137">そのアプリケーション プールの管理アカウントを選択または作成します。</span><span class="sxs-lookup"><span data-stu-id="d6818-137">Select or create a managed account for the application pool.</span></span> <span data-ttu-id="d6818-138">必ずドメイン ユーザー アカウントを指定してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-138">Be sure to specify a domain user account.</span></span> <span data-ttu-id="d6818-139">ドメイン ユーザー アカウントにより、パスワードやアカウント情報をまとめて更新できる SharePoint の管理アカウント機能を使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="d6818-139">A domain user account enables the use of SharePoint's managed account feature, which lets you update passwords and account information in one place.</span></span> <span data-ttu-id="d6818-140">ドメイン アカウントは、配置をスケールアウトして、同じ ID で実行されるサービス インスタンスを追加する場合にも必要です。</span><span class="sxs-lookup"><span data-stu-id="d6818-140">Domain accounts are also required if you plan to scale out the deployment to include additional service instances that will run under the same identity.</span></span>  
  
6.  <span data-ttu-id="d6818-141">**[データベース サーバー]** の既定値は、ファーム構成データベースをホストする SQL Server データベース エンジン インスタンスです。</span><span class="sxs-lookup"><span data-stu-id="d6818-141">In **Database Server**, the default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span> <span data-ttu-id="d6818-142">このサーバーを使用することも、別の SQL Server を選択することもできます。</span><span class="sxs-lookup"><span data-stu-id="d6818-142">You can use this server or choose a different SQL Server.</span></span>  
  
7.  <span data-ttu-id="d6818-143">[**データベース名**] の既定値は PowerPivotServiceApplication1_ \<guid> です。</span><span class="sxs-lookup"><span data-stu-id="d6818-143">In **Database Name**, the default value is PowerPivotServiceApplication1_\<guid>.</span></span> <span data-ttu-id="d6818-144">各 PowerPivot サービス アプリケーションに固有のデータベースを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-144">You must create a unique database for each PowerPivot service application.</span></span> <span data-ttu-id="d6818-145">既定のデータベース名は、既定のサービス アプリケーション名に対応しています。</span><span class="sxs-lookup"><span data-stu-id="d6818-145">The default database name corresponds to the default name of the service application.</span></span> <span data-ttu-id="d6818-146">独自のサービス アプリケーション名を入力した場合は、サービス アプリケーションとデータベースを一緒に管理できるように、データベース名に対しても同様の命名規則を使用してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-146">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>  
  
8.  <span data-ttu-id="d6818-147">**[データベース認証]** の既定値は、"Windows 認証" です。</span><span class="sxs-lookup"><span data-stu-id="d6818-147">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="d6818-148">**[SQL 認証]** を選択する場合は、SharePoint 管理者ガイドを参照して、SharePoint 配置でその認証の種類を使用するためのベスト プラクティスを確認してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-148">If you choose **SQL Authentication**, refer to the SharePoint administrator guide for best practices on how to use this authentication type in a SharePoint deployment.</span></span>  
  
9. <span data-ttu-id="d6818-149">必要に応じて、[**この PowerPivot サービスアプリケーションのプロキシをファームの既定のプロキシグループに追加する**] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="d6818-149">Optionally, select the checkbox for **Add the proxy for this PowerPivot Service Application to the farm's default proxy group.**</span></span> <span data-ttu-id="d6818-150">のチェック ボックスをオンにします。これにより、このサービス アプリケーション接続が既定のサービス接続のグループに追加されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-150">This adds the service application connection to the default service connection group.</span></span>  
  
     <span data-ttu-id="d6818-151">最初の PowerPivot サービス アプリケーションを作成する場合は、このチェック ボックスをオンにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-151">You must select this checkbox if you are creating your first PowerPivot service application.</span></span> <span data-ttu-id="d6818-152">PowerPivot 管理ダッシュボードが正しく機能するには、既定の接続グループに PowerPivot サービス アプリケーションが 1 つ存在している必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-152">There must be one PowerPivot service application in the default connection group in order for PowerPivot Management Dashboard to work properly.</span></span>  
  
     <span data-ttu-id="d6818-153">既定の接続グループに既に PowerPivot サービス アプリケーションが存在している場合は、それ以上追加しないでください。</span><span class="sxs-lookup"><span data-stu-id="d6818-153">Do not add the PowerPivot service application to the default connection group if one already exists.</span></span> <span data-ttu-id="d6818-154">同じ型のサービス アプリケーションのエントリを複数追加する構成はサポートされていないため、エラーが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-154">Adding multiple entries of the same service application type is not a supported configuration and might cause errors.</span></span> <span data-ttu-id="d6818-155">追加のサービス アプリケーションを作成する場合は、既定の接続グループには含めずに、カスタム リストに追加してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-155">If you are creating additional service applications, leave them out of the default connection group and add them to custom lists instead.</span></span>  
  
     <span data-ttu-id="d6818-156">サービスの関連付けの詳細については、「[サーバーの全体管理で PowerPivot サービスアプリケーションを SharePoint Web アプリケーションに接続する](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-156">For more information about service associations, see [Connect a PowerPivot Service Application to a SharePoint Web Application in Central Administration](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md).</span></span>  
  
10. <span data-ttu-id="d6818-157">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-157">Click **OK.**</span></span> <span data-ttu-id="d6818-158">作成したサービスが、他のマネージド サービスと共にファームのサービス アプリケーションの一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-158">The service will appear alongside other managed services in the farm's service application list.</span></span>  
  
##  <a name="configure-powerpivot-service-application"></a><a name="ConfigApp"></a><span data-ttu-id="d6818-159">PowerPivot サービスアプリケーションの構成</span><span class="sxs-lookup"><span data-stu-id="d6818-159">Configure PowerPivot Service Application</span></span>  
 <span data-ttu-id="d6818-160">PowerPivot サービス アプリケーションは、既定の構成を使用して作成されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-160">A PowerPivot service application is created using a default configuration.</span></span> <span data-ttu-id="d6818-161">既定の設定は、ほとんどのシナリオで推奨されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-161">The default settings are recommended for most scenarios.</span></span> <span data-ttu-id="d6818-162">既定の設定を変更するのは、応答の遅延や接続の切断などの問題が発生した場合や、PowerPivot サービスの構成を特定の SharePoint Web アプリケーションに対して変更する場合だけにしてください。</span><span class="sxs-lookup"><span data-stu-id="d6818-162">Change them only if you encounter slow response time or dropped connections, or if you are varying PowerPivot service configuration for specific SharePoint Web applications.</span></span>  
  
1.  <span data-ttu-id="d6818-163">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-163">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
     <span data-ttu-id="d6818-164">サービス アプリケーションの一覧に、先ほど作成したサービス アプリケーションの名前が表示されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-164">In the list of service applications, you should see the service application you just created and named.</span></span> <span data-ttu-id="d6818-165">既定の名前は、 **"PowerPivotServiceApplication1"** です。</span><span class="sxs-lookup"><span data-stu-id="d6818-165">The default is **PowerPivotServiceApplication1**.</span></span>  
  
2.  <span data-ttu-id="d6818-166">PowerPivot サービス アプリケーションをクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-166">Click the PowerPivot service application.</span></span> <span data-ttu-id="d6818-167">PowerPivot 管理ダッシュボードが開きます。</span><span class="sxs-lookup"><span data-stu-id="d6818-167">This opens the PowerPivot Management Dashboard.</span></span>  
  
3.  <span data-ttu-id="d6818-168">ダッシュボードの右上隅にある **[アクション]** ボックスの一覧で、 **[サービス アプリケーションの設定の構成]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-168">In the **Actions** list on the top right corner of the dashboard, click **Configure service application settings**.</span></span>  
  
4.  <span data-ttu-id="d6818-169">[**データベースの読み込みタイムアウト**] で、値を増減させて、データの読み込み要求を転送した SQL Server Analysis Services (powerpivot) インスタンスからの応答を powerpivot サービスが待機する時間を変更します。</span><span class="sxs-lookup"><span data-stu-id="d6818-169">In **Database Load Timeout**, increase or decrease the value to change how long the PowerPivot service waits for a response from the SQL Server Analysis Services (PowerPivot) instance to which it forwarded a load data request.</span></span> <span data-ttu-id="d6818-170">データセットが非常に大きい場合はネットワークでの移動に時間がかかるため、PowerPivot サービス インスタンスが Excel ブックを取得して、PowerPivot データをクエリ処理のために Analysis Services インスタンスに移動するのに十分な時間を設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-170">Because very large datasets take time to move over the wire, you must allow sufficient time for the PowerPivot service instance to retrieve the Excel workbook and move the PowerPivot data to an Analysis Services instance for query processing.</span></span> <span data-ttu-id="d6818-171">PowerPivot データは一般に大きいため、既定値は 30 分に設定されています。</span><span class="sxs-lookup"><span data-stu-id="d6818-171">Because PowerPivot data can be unusually large, the default value is 30 minutes.</span></span>  
  
5.  <span data-ttu-id="d6818-172">**[接続プールのタイムアウト]** の値を増減させて、アイドル状態のデータ接続を開いたままにする時間 (分) を変更します。</span><span class="sxs-lookup"><span data-stu-id="d6818-172">In **Connection Pool Timeout**, increase or decrease the value to change how many minutes an idle data connection will remain open.</span></span> <span data-ttu-id="d6818-173">既定値は 30 分です。</span><span class="sxs-lookup"><span data-stu-id="d6818-173">The default value is 30 minutes.</span></span> <span data-ttu-id="d6818-174">この期間に、同じ SharePoint ユーザーから同じ PowerPivot データに対する読み取り専用の要求が送られた場合、PowerPivot サービスはアイドル状態のデータ接続を再利用します。</span><span class="sxs-lookup"><span data-stu-id="d6818-174">During this period, the PowerPivot service will reuse an idle data connection for read-only requests from the same SharePoint user for the same PowerPivot data.</span></span> <span data-ttu-id="d6818-175">指定した期間にそのデータに対する要求がそれ以上受信されなかった場合は、接続がプールから削除されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-175">If no further requests are received for that data during the period specified, the connection is removed from the pool.</span></span> <span data-ttu-id="d6818-176">有効値は 1 ～ 3600 秒です。</span><span class="sxs-lookup"><span data-stu-id="d6818-176">Valid values are 1 to 3600 seconds.</span></span> <span data-ttu-id="d6818-177">接続プールの詳細については、「[構成設定のリファレンス &#40;PowerPivot for SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-177">For more information about connection pools, see [Configuration Setting Reference &#40;PowerPivot for SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md).</span></span>  
  
6.  <span data-ttu-id="d6818-178">[**ユーザー接続プールの最大サイズ**] で、値を増減させて、各 SharePoint ユーザー、powerpivot データセット、およびバージョンの組み合わせについて、powerpivot サービスが個々の接続プールに作成するアイドル接続の最大数を変更します。</span><span class="sxs-lookup"><span data-stu-id="d6818-178">In **Maximum User Connection Pool Size**, increase or decrease the value to change the maximum number of idle connections the PowerPivot service will create in individual connection pools for each SharePoint user, PowerPivot dataset, and version combinations.</span></span>  
  
     <span data-ttu-id="d6818-179">既定値は 1000 です。</span><span class="sxs-lookup"><span data-stu-id="d6818-179">The default value is 1000 idle connections.</span></span> <span data-ttu-id="d6818-180">有効値は、-1 (無制限)、0 (ユーザー接続プールを無効にする)、または 1 ～ 10000 です。</span><span class="sxs-lookup"><span data-stu-id="d6818-180">Valid values are -1 (unlimited), 0 (disables user connection pooling), or 1 to 10000.</span></span>  
  
     <span data-ttu-id="d6818-181">これらの接続プールを使用すると、同じユーザーによる同じ読み取り専用データに対する継続的な接続を、サービスでより効率的にサポートできます。</span><span class="sxs-lookup"><span data-stu-id="d6818-181">These connection pools enable the service to more efficiently support ongoing connections to the same read-only data by the same user.</span></span> <span data-ttu-id="d6818-182">接続プールを無効にすると、すべての接続が新しく作成されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-182">If you disable connection pooling, every connection will be created anew.</span></span>  
  
     <span data-ttu-id="d6818-183">接続プール サイズの制限を変更しても (値を 0 に設定した場合も)、接続が切断されることはありません。</span><span class="sxs-lookup"><span data-stu-id="d6818-183">Note that changing the limit on connection pool size, including setting it to 0, will not result in dropped connections.</span></span> <span data-ttu-id="d6818-184">接続プールは、データに接続するときの待ち時間を短縮するためのものです。</span><span class="sxs-lookup"><span data-stu-id="d6818-184">Connection pools exist to reduce wait times when connecting to data.</span></span> <span data-ttu-id="d6818-185">PowerPivot サービスでは、接続プールの設定に基づいて接続が拒否されることはありません。</span><span class="sxs-lookup"><span data-stu-id="d6818-185">The PowerPivot service will never deny a connection based on connection pool settings.</span></span>  
  
7.  <span data-ttu-id="d6818-186">[**管理接続プールの最大サイズ**] で値を増減させて、PowerPivot サービス接続用に作成された接続プール内の開いている接続の数を Analysis Services に変更します。</span><span class="sxs-lookup"><span data-stu-id="d6818-186">In **Maximum Administrative Connection Pool Size**, increase or decrease the value to change the number of open connections in a connection pool created for a PowerPivot service connection to Analysis Services.</span></span> <span data-ttu-id="d6818-187">各 PowerPivot サービス インスタンスは、同じコンピューターで Analysis Services インスタンスに対する独立した管理接続を開きます。</span><span class="sxs-lookup"><span data-stu-id="d6818-187">Each PowerPivot service instance opens a separate administrative connection to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="d6818-188">PowerPivot サービスは、独立したプールを作成して、アイドル状態の接続がないかどうかの確認やサーバーの状態の監視のために管理接続を再利用します。</span><span class="sxs-lookup"><span data-stu-id="d6818-188">PowerPivot service creates a separate pool to reuse administrative connections for the purpose of checking for idle connections and monitoring server health.</span></span> <span data-ttu-id="d6818-189">接続数の既定値は 200 です。</span><span class="sxs-lookup"><span data-stu-id="d6818-189">The default value is 200 connections.</span></span> <span data-ttu-id="d6818-190">有効値は、-1 (無制限)、0 (管理接続プールを無効にする)、または 1 ～ 10000 です。</span><span class="sxs-lookup"><span data-stu-id="d6818-190">Valid values are -1 (unlimited), 0 (disables administrative connection pooling), or 1 to 10000.</span></span> <span data-ttu-id="d6818-191">0 を選択すると、すべての接続が新しく作成されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-191">If you select 0, every connection will be created anew.</span></span>  
  
8.  <span data-ttu-id="d6818-192">[**割り当て方法**] では、初期要求の負荷を分散するために、PowerPivot System サービスが特定の PowerPivot サービスアプリケーションを選択するために使用する負荷分散スキーマを指定できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-192">In **Allocation Method**, you can specify the load balancing schema that the PowerPivot System Service uses to select a specific PowerPivot service application for load balancing an initial request.</span></span> <span data-ttu-id="d6818-193">既定値は **[ヘルス ベース]** で、使用可能なメモリとプロセッサ使用率によって評価されるサーバーの状態に基づいて要求を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="d6818-193">The default is **Health Based**, which allocates requests based on server state, as measured by available memory and processor utilization.</span></span> <span data-ttu-id="d6818-194">また、 **[ラウンド ロビン]** を選択すると、サーバーがビジー状態かアイドル状態かに関係なく、要求を同じ順序でサーバーに割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="d6818-194">Alternatively, you can choose **Round Robin** to allocate requests to servers in the same repeating order, regardless of whether a server is busy or idle.</span></span>  
  
9. <span data-ttu-id="d6818-195">[データ更新] の **[営業時間]** では、営業時間を定義する時間の範囲を指定できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-195">In Data Refresh, in **Business Hours**, you can specify a range of hours that defines a business day.</span></span> <span data-ttu-id="d6818-196">データ更新スケジュールを営業時間後に実行すると、通常の営業時間中に生成されたトランザクション データを取得できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-196">Data refresh schedules can run after the close of a business day to pick up transactional data that was generated during normal business hours.</span></span>  
  
10. <span data-ttu-id="d6818-197">[ **Powerpivot 自動データ更新アカウント**] で、powerpivot データ更新ジョブを実行するための定義済みのアカウントを格納する、定義済みの Secure Store Service 対象アプリケーションを指定できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-197">In **PowerPivot Unattended Data Refresh Account**, you can specify a predefined Secure Store Service target application that stores a predefined account for running PowerPivot data refresh jobs.</span></span> <span data-ttu-id="d6818-198">ID ではなく、必ず対象アプリケーション名を指定してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-198">Be sure to specify the target application name, and not the ID.</span></span> <span data-ttu-id="d6818-199">自動データ更新の対象アプリケーションは、SQL Server セットアップで [新しいサーバー] オプションを使用して PowerPivot for SharePoint をインストールした場合は自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-199">The target application for unattended data refresh is created automatically if you used the New Server option in SQL Server Setup to install PowerPivot for SharePoint.</span></span> <span data-ttu-id="d6818-200">それ以外の場合は、対象アプリケーションを手動で作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-200">Otherwise, you must create the target application manually.</span></span> <span data-ttu-id="d6818-201">アカウントの構成方法については、「 [PowerPivot 自動データ更新アカウントの構成 &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-201">For instructions on how to configure the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
11. <span data-ttu-id="d6818-202">**[ユーザーによるカスタムの Windows 資格情報の入力を許可する]** チェック ボックスをオンまたはオフにして、スケジュールの所有者が任意の Windows 資格情報を入力してデータ更新スケジュールを実行できるようにするかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="d6818-202">In **Allow users to enter custom Windows credentials**, you can select or clear the checkbox to specify whether schedule owners can enter arbitrary Windows credentials to run a data refresh schedule.</span></span> <span data-ttu-id="d6818-203">このチェック ボックスをオンにすると、保存された資格情報のセットごとに対象アプリケーションが PowerPivot サービス アプリケーションによって作成および管理されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-203">If you select this checkbox, PowerPivot service application will create and manage a target application each set of stored credentials.</span></span> <span data-ttu-id="d6818-204">詳細については、「[PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-204">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
12. <span data-ttu-id="d6818-205">**[処理履歴の最大の長さ]** では、データ更新処理の履歴レコードを保持する期間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-205">In **Maximum Processing History Length**, you can specify how long to retain a historical record of data refresh processing.</span></span> <span data-ttu-id="d6818-206">この情報は、データ更新を使用するブックごとに保持されるデータ更新の履歴ページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-206">This information appears in data refresh history pages that are kept for each workbook that uses data refresh.</span></span> <span data-ttu-id="d6818-207">PowerPivot 管理ダッシュボードにも表示されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-207">It also appears in the PowerPivot Management Dashboard.</span></span>  
  
13. <span data-ttu-id="d6818-208">[使用状況データ収集] の **[クエリをレポートする間隔]** で、クエリ統計を報告する間隔を指定します。</span><span class="sxs-lookup"><span data-stu-id="d6818-208">In Usage Data Collection, in **Query Reporting Interval**, specify an interval of time for reporting query statistics.</span></span> <span data-ttu-id="d6818-209">クエリ統計は、サーバー間の通信を最小限に抑えるために単一のイベントとして報告されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-209">Query statistics are reported as a single event to minimize server-to-server communication.</span></span>  
  
14. <span data-ttu-id="d6818-210">[使用状況データの履歴] で、使用状況データの履歴レコードを保持する期間を指定します。</span><span class="sxs-lookup"><span data-stu-id="d6818-210">In Usage Data History, specify how long to keep a historical record of usage data.</span></span> <span data-ttu-id="d6818-211">使用状況情報は PowerPivot 管理ダッシュボードに表示されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-211">Usage information appears in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="d6818-212">指定した使用状況データ履歴の値が小さすぎると、レポートの効果が下がります。</span><span class="sxs-lookup"><span data-stu-id="d6818-212">The reports will be less effective if you specify too low a value for usage data history.</span></span>  
  
15. <span data-ttu-id="d6818-213">[使用状況データ収集] の各クエリ応答のしきい値で、カテゴリとカテゴリの境界を決定する上限を指定します。</span><span class="sxs-lookup"><span data-stu-id="d6818-213">In Usage Data Collection, in each query response threshold, specify an upper limit that determines where one category stops and another begins.</span></span> <span data-ttu-id="d6818-214">これらのカテゴリによって、クエリの動作の評価基準が設定されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-214">These categories establish a baseline against which query behavior is measured.</span></span> <span data-ttu-id="d6818-215">また、これらのカテゴリを使用して、システムのクエリ応答時間の傾向を監視できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-215">You can use these categories to monitor trends in query response times for your system.</span></span> <span data-ttu-id="d6818-216">この情報は PowerPivot 管理ダッシュボードに表示されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-216">This information appears in the PowerPivot Management Dashboard.</span></span>  
  
16. <span data-ttu-id="d6818-217">**[OK]** をクリックして変更を保存します。</span><span class="sxs-lookup"><span data-stu-id="d6818-217">Click **OK** to save your changes.</span></span>  
  
     <span data-ttu-id="d6818-218">読み込みのタイムアウトや割り当て方法の変更は、新たに受信した要求に対してのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-218">Changes to the load timeout or allocation method are only applied to new incoming requests.</span></span> <span data-ttu-id="d6818-219">既に進行中の要求に対しては、要求の受信時に有効だった値が適用されます。</span><span class="sxs-lookup"><span data-stu-id="d6818-219">Requests that are already in progress are subject to the values that were in effect when the request was received.</span></span>  
  
##  <a name="assign-a-powerpivot-service-application-to-a-web-application"></a><a name="AssignGSA"></a><span data-ttu-id="d6818-220">Web アプリケーションへの PowerPivot サービスアプリケーションの割り当て</span><span class="sxs-lookup"><span data-stu-id="d6818-220">Assign a PowerPivot Service Application to a Web Application</span></span>  
 <span data-ttu-id="d6818-221">PowerPivot サービス アプリケーションの構成が完了したら、Web アプリケーションに関連するサービス アプリケーションの接続リストに追加することによって、サービス アプリケーションを Web アプリケーションに割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="d6818-221">After you configure a PowerPivot service application, you can assign it to a Web application by adding it to the service application connection list for that Web application.</span></span> <span data-ttu-id="d6818-222">これには、2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-222">There are two ways to do this:</span></span>  
  
-   <span data-ttu-id="d6818-223">"既定" \*\*\*\* の接続グループに追加します。</span><span class="sxs-lookup"><span data-stu-id="d6818-223">Add it to the **Default** connection group.</span></span> <span data-ttu-id="d6818-224">*既定の接続グループ* とは、そのグループを参照する任意の Web アプリケーションで使用できるサービス アプリケーション接続のコレクションです。</span><span class="sxs-lookup"><span data-stu-id="d6818-224">The *default connection group* is a collection of service application connections that are available to any Web application that references it.</span></span> <span data-ttu-id="d6818-225">このリストに PowerPivot サービス アプリケーションを 1 つ追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d6818-225">You must add a PowerPivot service application to this list.</span></span>  
  
-   <span data-ttu-id="d6818-226">特定の Web アプリケーションの "カスタム" \*\*\*\* 接続リストを作成します。</span><span class="sxs-lookup"><span data-stu-id="d6818-226">Create a **Custom** connection list for a specific Web application.</span></span> <span data-ttu-id="d6818-227">複数の PowerPivot サービス アプリケーションを作成した場合は、カスタム リストで選択することによって、使用するサービス アプリケーションを選択できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-227">If you created multiple PowerPivot service applications, you can choose which one to use by selecting it in a custom list.</span></span>  
  
 <span data-ttu-id="d6818-228">既定の接続グループに同じ型のサービス アプリケーションを複数含めることもできますが、</span><span class="sxs-lookup"><span data-stu-id="d6818-228">The default connection group will accept more than one service application of the same type.</span></span> <span data-ttu-id="d6818-229">このリストに複数の PowerPivot サービス アプリケーションを追加する構成はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="d6818-229">Be aware, however, that adding more than one PowerPivot service applications to this list is not a supported configuration.</span></span>  
  
1.  <span data-ttu-id="d6818-230">サーバーの全体管理で、 **[アプリケーション構成の管理]** の **[Web アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-230">In Central Administration, in **Application Management**, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="d6818-231">接続を割り当てるアプリケーションを選択します ("SharePoint -80" など)。</span><span class="sxs-lookup"><span data-stu-id="d6818-231">Select the application for which you want to assign a connection (for example, SharePoint -80).</span></span>  
  
3.  <span data-ttu-id="d6818-232">**[サービス接続]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-232">Click **Service Connections**.</span></span>  
  
4.  <span data-ttu-id="d6818-233">**[次の関連付けのグループを編集する]** で、 **[既定]** または **[カスタム]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="d6818-233">In **Edit the following group of associations**, select **default** or **[custom]**.</span></span>  
  
5.  <span data-ttu-id="d6818-234">**[カスタム]** を選択した場合は、使用する各サービス アプリケーション接続の横のチェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="d6818-234">For **[custom]**, select the checkbox next to each service application connection you want to use.</span></span> <span data-ttu-id="d6818-235">複数の PowerPivot サービスアプリケーション (Type がに設定されている) がある場合は `PowerPivot Service Application Proxy` 、必ず1つを選択してください。</span><span class="sxs-lookup"><span data-stu-id="d6818-235">If you have multiple PowerPivot service applications (indicated by Type set to `PowerPivot Service Application Proxy`), be sure to choose just one.</span></span>  
  
6.  <span data-ttu-id="d6818-236">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-236">Click **OK**.</span></span>  
  
##  <a name="edit-service-application-properties"></a><a name="EditGSA"></a> <span data-ttu-id="d6818-237">サービス アプリケーションのプロパティの編集</span><span class="sxs-lookup"><span data-stu-id="d6818-237">Edit Service Application Properties</span></span>  
 <span data-ttu-id="d6818-238">サービス アプリケーションの名前、アプリケーション プール、データベース設定、およびサービスの関連付けを指定するプロパティ ページを再び開くには、次の手順に従ってください。</span><span class="sxs-lookup"><span data-stu-id="d6818-238">Use the following instructions to re-open the property page that specifies the service application name, application pool, database settings, and service associations.</span></span>  
  
1.  <span data-ttu-id="d6818-239">サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-239">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="d6818-240">PowerPivot サービス アプリケーションを選択します (クリックはしないでください)。</span><span class="sxs-lookup"><span data-stu-id="d6818-240">Select, but do not click, the PowerPivot service application.</span></span> <span data-ttu-id="d6818-241">型の名前をクリックすると行全体を選択できます。</span><span class="sxs-lookup"><span data-stu-id="d6818-241">You can click the type name to select the entire row.</span></span>  
  
3.  <span data-ttu-id="d6818-242">リボンの **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="d6818-242">Click **Properties** on the ribbon.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d6818-243">参照</span><span class="sxs-lookup"><span data-stu-id="d6818-243">See Also</span></span>  
 [<span data-ttu-id="d6818-244">サーバーの全体管理での PowerPivot サーバーの管理と構成</span><span class="sxs-lookup"><span data-stu-id="d6818-244">PowerPivot Server Administration and Configuration in Central Administration</span></span>](power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
