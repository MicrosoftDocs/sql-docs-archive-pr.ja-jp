---
title: 'ブック内のデータ接続に関するデータを更新できません。 再試行するか、システム管理者に問い合わせてください。 次の接続を更新できませんでした: PowerPivot Data |Microsoft Docs'
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9c25c2597bbc7aa16fb8b66d4ffddbf0df14515e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736936"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a><span data-ttu-id="783f0-104">ブック内のデータ接続に関するデータを更新できません。</span><span class="sxs-lookup"><span data-stu-id="783f0-104">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="783f0-105">再試行するか、システム管理者に問い合わせてください。</span><span class="sxs-lookup"><span data-stu-id="783f0-105">Try again or contact your system administrator.</span></span> <span data-ttu-id="783f0-106">次の接続の更新に失敗しました:PowerPivot データ</span><span class="sxs-lookup"><span data-stu-id="783f0-106">The following connections failed to refresh: PowerPivot Data</span></span>
  <span data-ttu-id="783f0-107">PowerPivot データを含む Excel ブックで、Excel Services は、PowerPivot サーバーに送信した接続要求が失敗した場合にこのエラーを返します。</span><span class="sxs-lookup"><span data-stu-id="783f0-107">For Excel workbooks that contain PowerPivot data, Excel Services returns this error if it submits a connection request to a PowerPivot server and the request fails.</span></span>  
  
## <a name="details"></a><span data-ttu-id="783f0-108">詳細</span><span class="sxs-lookup"><span data-stu-id="783f0-108">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="783f0-109">適用対象:</span><span class="sxs-lookup"><span data-stu-id="783f0-109">Applies to:</span></span>|<span data-ttu-id="783f0-110">PowerPivot for SharePoint のインストール</span><span class="sxs-lookup"><span data-stu-id="783f0-110">PowerPivot for SharePoint installation</span></span>|  
|<span data-ttu-id="783f0-111">製品バージョン</span><span class="sxs-lookup"><span data-stu-id="783f0-111">Product Version</span></span>|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="783f0-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="783f0-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span></span>|  
|<span data-ttu-id="783f0-113">原因</span><span class="sxs-lookup"><span data-stu-id="783f0-113">Cause</span></span>|<span data-ttu-id="783f0-114">次を参照してください。</span><span class="sxs-lookup"><span data-stu-id="783f0-114">See below.</span></span>|  
|<span data-ttu-id="783f0-115">メッセージ テキスト</span><span class="sxs-lookup"><span data-stu-id="783f0-115">Message Text</span></span>|<span data-ttu-id="783f0-116">ブック内のデータ接続に関するデータを更新できません。</span><span class="sxs-lookup"><span data-stu-id="783f0-116">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="783f0-117">再試行するか、システム管理者に問い合わせてください。</span><span class="sxs-lookup"><span data-stu-id="783f0-117">Try again or contact your system administrator.</span></span> <span data-ttu-id="783f0-118">次の接続の更新に失敗しました:PowerPivot データ</span><span class="sxs-lookup"><span data-stu-id="783f0-118">The following connections failed to refresh: PowerPivot Data</span></span>|  
  
## <a name="explanation-and-resolution"></a><span data-ttu-id="783f0-119">説明および解決方法</span><span class="sxs-lookup"><span data-stu-id="783f0-119">Explanation and Resolution</span></span>  
 <span data-ttu-id="783f0-120">Excel Services が PowerPivot データに接続できないか、PowerPivot データを読み込むことができません。</span><span class="sxs-lookup"><span data-stu-id="783f0-120">Excel Services cannot connect to or load the PowerPivot data.</span></span> <span data-ttu-id="783f0-121">このエラーは、次のような状況で発生します。</span><span class="sxs-lookup"><span data-stu-id="783f0-121">Conditions that cause this error to occur include the following:</span></span>  
  
 <span data-ttu-id="783f0-122">**シナリオ 1: サービスが開始されていない**</span><span class="sxs-lookup"><span data-stu-id="783f0-122">**Scenario 1: Service is not started**</span></span>  
  
 <span data-ttu-id="783f0-123">SQL Server Analysis Services (PowerPivot) インスタンスが開始されていません。</span><span class="sxs-lookup"><span data-stu-id="783f0-123">The SQL Server Analysis Services (PowerPivot) instance is not started.</span></span> <span data-ttu-id="783f0-124">パスワードの期限が切れると、サービスの実行が停止します。</span><span class="sxs-lookup"><span data-stu-id="783f0-124">An expired password will cause the service to stop running.</span></span> <span data-ttu-id="783f0-125">パスワードの変更の詳細については、「 [PowerPivot サービスアカウントの構成](configure-power-pivot-service-accounts.md)」および「 [PowerPivot for SharePoint サーバーの開始または停止](start-or-stop-a-power-pivot-for-sharepoint-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="783f0-125">For more information about changing the password, see [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) and [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span></span>  
  
 <span data-ttu-id="783f0-126">**シナリオ 2a: サーバー上で以前バージョンのブックを開こうとしている**</span><span class="sxs-lookup"><span data-stu-id="783f0-126">**Scenario 2a: Opening an earlier version workbook n the server**</span></span>  
  
 <span data-ttu-id="783f0-127">開こうとしているブックが、SQL Server 2008 R2 バージョンの PowerPivot for Excel で作成された可能性があります。</span><span class="sxs-lookup"><span data-stu-id="783f0-127">The workbook you are attempting to open might have been created in the SQL Server 2008 R2 version of PowerPivot for Excel.</span></span> <span data-ttu-id="783f0-128">ほとんどの場合、データ接続文字列で指定された Analysis Services データ プロバイダーは、要求を処理しているコンピューター上に存在しません。</span><span class="sxs-lookup"><span data-stu-id="783f0-128">Most likely, the Analysis Services data provider that is specified in the data connection string is not present on the computer that is handling the request.</span></span>  
  
 <span data-ttu-id="783f0-129">このような場合は、ULS ログに "ブック ' ' の ' PowerPivot データ ' の更新に失敗しました" というメッセージが表示され、 \<URL to workbook> その後に "接続を取得できません" というメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="783f0-129">If this is the case, you will find this message in the ULS log: "Refresh failed for 'PowerPivot Data' in the workbook '\<URL to workbook>'", followed by "Unable to get a connection".</span></span>  
  
 <span data-ttu-id="783f0-130">ブックのバージョンを決定するには、Excel で開き、接続文字列にどのデータ プロバイダーが指定されているか確認します。</span><span class="sxs-lookup"><span data-stu-id="783f0-130">To determine the version of the workbook, open it in Excel and check which data provider is specified in the connection string.</span></span> <span data-ttu-id="783f0-131">SQL Server 2008 R2 ブックは、MSOLAP.4 をデータ プロバイダーとして使用します。</span><span class="sxs-lookup"><span data-stu-id="783f0-131">A SQL Server 2008 R2 workbook uses MSOLAP.4 as its data provider.</span></span>  
  
 <span data-ttu-id="783f0-132">この問題を回避するために、ブックをアップグレードすることができます。</span><span class="sxs-lookup"><span data-stu-id="783f0-132">To work around this issue, you can upgrade the workbook.</span></span> <span data-ttu-id="783f0-133">または、以下の方法で PowerPivot for SharePoint または Excel Services を実行している物理コンピューター上の SQL Server 2008 R2 バージョンの Analysis Services からクライアント ライブラリをインストールすることができます。</span><span class="sxs-lookup"><span data-stu-id="783f0-133">Alternatively, you can install client libraries from the SQL Server 2008 R2 version of Analysis Services on the physical computers running PowerPivot for SharePoint or Excel Services:</span></span>  
  
 [<span data-ttu-id="783f0-134">SharePoint サーバーへの Analysis Services OLE DB プロバイダーのインストール</span><span class="sxs-lookup"><span data-stu-id="783f0-134">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 <span data-ttu-id="783f0-135">**シナリオ 2b: 間違ったバージョンのクライアント ライブラリがインストールされたアプリケーション サーバーで Excel Services が実行されている**</span><span class="sxs-lookup"><span data-stu-id="783f0-135">**Scenario 2b: Excel Services is running on an application server that has the wrong version of the client libraries**</span></span>  
  
 <span data-ttu-id="783f0-136">既定では、SharePoint Server 2010 は、SQL Server 2008 バージョンの Analysis Services OLE DB プロバイダーを Excel Services を実行するアプリケーション サーバーにインストールします。</span><span class="sxs-lookup"><span data-stu-id="783f0-136">By default, SharePoint Server 2010 installs the SQL Server 2008 version of the Analysis Services OLE DB provider on application servers that run Excel Services.</span></span> <span data-ttu-id="783f0-137">PowerPivot データ アクセスをサポートするファームでは、Excel Services や PowerPivot for SharePoint など、PowerPivot データを要求するアプリケーションを実行するすべての物理サーバーは、最新バージョンのデータ プロバイダーを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="783f0-137">In a farm that supports PowerPivot data access, all physical servers running applications that request PowerPivot data, such as Excel Services and PowerPivot for SharePoint, must use a later version of the data provider.</span></span>  
  
 <span data-ttu-id="783f0-138">PowerPivot for SharePoint を実行するサーバーは、更新された OLE DB データ プロバイダーを自動的に取得します。</span><span class="sxs-lookup"><span data-stu-id="783f0-138">Servers that run PowerPivot for SharePoint get the updated OLE DB data provider automatically.</span></span> <span data-ttu-id="783f0-139">同じコンピューター上の PowerPivot for SharePoint を使用しない、スタンドアロン インスタンスの Excel Services など、その他のサーバーは、新しいクライアント ライブラリを使用するために、更新プログラムを適用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="783f0-139">Other servers, such as those running a standalone instance Excel Services without PowerPivot for SharePoint on the same computer, must be patched to use the newer client libraries.</span></span> <span data-ttu-id="783f0-140">「 [SharePoint サーバーへの Analysis Services OLE DB プロバイダーのインストール](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="783f0-140">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>  
  
 <span data-ttu-id="783f0-141">**シナリオ 3: ドメイン コントローラーを使用できない**</span><span class="sxs-lookup"><span data-stu-id="783f0-141">**Scenario 3: Domain controller is unavailable**</span></span>  
  
 <span data-ttu-id="783f0-142">ユーザー ID の検証にドメイン コントローラーを使用できないことが原因である場合があります。</span><span class="sxs-lookup"><span data-stu-id="783f0-142">The cause might be that a domain controller is not available to validate the user identity.</span></span> <span data-ttu-id="783f0-143">Windows トークン サービスに対するクレームにより各接続で SharePoint ユーザーを認証するには、ドメイン コントローラーが必要です。</span><span class="sxs-lookup"><span data-stu-id="783f0-143">A domain controller is required by the Claims to Windows Token Service to authenticate the SharePoint user on each connection.</span></span> <span data-ttu-id="783f0-144">Windows トークン サービスに対するクレームでは、キャッシュされた資格情報は使用されません。</span><span class="sxs-lookup"><span data-stu-id="783f0-144">The Claims to Windows Token Service does not use cached credentials.</span></span> <span data-ttu-id="783f0-145">接続ごとにユーザー ID が検証されます。</span><span class="sxs-lookup"><span data-stu-id="783f0-145">It validates the user identity for each connection.</span></span>  
  
 <span data-ttu-id="783f0-146">SharePoint ログ ファイルを表示して、このエラーの原因を確認できます。</span><span class="sxs-lookup"><span data-stu-id="783f0-146">You can confirm the cause of this error by viewing the SharePoint log file.</span></span> <span data-ttu-id="783f0-147">SharePoint ログに、"IClaimsIdentity から WindowsIdentity を取得できませんでした" というメッセージがある場合、ユーザー ID を認証できなかったことを示します。</span><span class="sxs-lookup"><span data-stu-id="783f0-147">If the SharePoint logs include the message "Failed to get WindowsIdentity from IClaimsIdentity", the user identity could not be authenticated.</span></span>  
  
 <span data-ttu-id="783f0-148">この問題を回避するには、PowerPivot サーバーと同じドメインにコンピューターを所属させるか、ローカル コンピューターにドメイン コントローラーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="783f0-148">To work around this problem, join the computer to the same domain as the PowerPivot server, or install a domain controller on your local computer.</span></span> <span data-ttu-id="783f0-149">2 番目の解決策として、ドメイン コントローラーのインストールを行う場合は、すべてのサービスとユーザーのローカル ドメイン アカウントを作成することが必要になります。</span><span class="sxs-lookup"><span data-stu-id="783f0-149">The second solution, installing the domain controller, will require you to create local domain accounts for all services and users.</span></span> <span data-ttu-id="783f0-150">それには、サービス アカウントを構成して、定義したアカウントの SharePoint 権限を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="783f0-150">You will need to configure service accounts and SharePoint permissions for the accounts you define.</span></span>  
  
 <span data-ttu-id="783f0-151">PowerPivot for SharePoint をオフライン状態で使用することを目的とする場合は、コンピューターにドメイン コントローラーをインストールすると便利です。</span><span class="sxs-lookup"><span data-stu-id="783f0-151">Installing a domain controller on your computer is useful if your objective is to use PowerPivot for SharePoint in an offline state.</span></span> <span data-ttu-id="783f0-152">PowerPivot をオフラインで使用する方法の詳細については、「」のブログ記事「PowerPivot サーバーをネットワークから切断する」を参照してください [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241) 。</span><span class="sxs-lookup"><span data-stu-id="783f0-152">For detailed instructions on how to use PowerPivot offline, see the blog entry for "Taking your PowerPivot server off the network" on [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241).</span></span>  
  
 <span data-ttu-id="783f0-153">**シナリオ 4: 不安定なサーバー**</span><span class="sxs-lookup"><span data-stu-id="783f0-153">**Scenario 4: Unstable server**</span></span>  
  
 <span data-ttu-id="783f0-154">1 つ以上のサービスが一貫性のない状態にある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="783f0-154">One or more services might be in an inconsistent state.</span></span> <span data-ttu-id="783f0-155">IISRESET を実行すると問題が解決することがあります。</span><span class="sxs-lookup"><span data-stu-id="783f0-155">In some cases, running IISRESET will resolve the problem.</span></span>  
  
  
