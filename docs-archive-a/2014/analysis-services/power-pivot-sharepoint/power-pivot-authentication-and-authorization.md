---
title: PowerPivot の認証と承認 |Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 48230cc0-4037-4f99-8360-dadf4bc169bd
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cf777960b24d9c65c7e7f7d9651eeb48e0fe42b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87712550"
---
# <a name="powerpivot-authentication-and-authorization"></a><span data-ttu-id="5fa89-102">PowerPivot の認証および承認</span><span class="sxs-lookup"><span data-stu-id="5fa89-102">PowerPivot Authentication and Authorization</span></span>
  <span data-ttu-id="5fa89-103">SharePoint 2010 ファーム内で実行される PowerPivot for SharePoint の配置では、SharePoint サーバーによって提供される認証サブシステムと承認モデルを使用します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-103">A PowerPivot for SharePoint deployment that runs within a SharePoint 2010 farm uses the authentication subsystem and authorization model provided by SharePoint servers.</span></span> <span data-ttu-id="5fa89-104">PowerPivot 関連のすべてのコンテンツは SharePoint コンテンツ データベースに格納され、PowerPivot 関連のすべての操作はファーム内の PowerPivot 共有サービスによって実行されるので、SharePoint のセキュリティ インフラストラクチャは PowerPivot のコンテンツや操作にまで及ぶことになります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-104">SharePoint security infrastructure extends to PowerPivot content and operations because all PowerPivot-related content is stored in SharePoint content databases and all PowerPivot-related operations are performed by PowerPivot shared services in the farm.</span></span> <span data-ttu-id="5fa89-105">PowerPivot データが含まれているブックを要求するユーザーは、Windows ユーザー ID に基づく SharePoint ユーザー ID を使用して認証されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-105">Users who request a workbook that contains PowerPivot data are authenticated using a SharePoint user identity that is based on their Windows user identity.</span></span> <span data-ttu-id="5fa89-106">この要求が許可されるか拒否されるかは、ブックに対する表示権限によって決まります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-106">View permissions on the workbook determine whether the request is granted or denied.</span></span>  
  
 <span data-ttu-id="5fa89-107">セルフサービス型のデータ分析には Excel Services との統合が必要となるため、PowerPivot サーバーをセキュリティで保護する場合、Excel Services のセキュリティについても理解している必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-107">Because integration with Excel Services is required for self-service data analytics, securing a PowerPivot server requires that you also understand Excel Services security.</span></span> <span data-ttu-id="5fa89-108">PowerPivot データへのデータ接続があるピボットテーブルに対してユーザーがクエリを実行すると、データ接続要求が Excel Services からファームの PowerPivot サーバーに転送され、データが読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-108">When a user queries a PivotTable that has a data connection to PowerPivot data, Excel Services forwards a data connection request to a PowerPivot server in the farm to load the data.</span></span> <span data-ttu-id="5fa89-109">サーバー間のこの連携では、両方のサーバーのセキュリティ設定を構成する方法を理解している必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-109">This interaction between the servers requires that you understand how to configure security settings for both servers.</span></span>  
  
 <span data-ttu-id="5fa89-110">このトピックの特定のセクションを参照するには、次のリンクをクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-110">Click the following links to read specific sections in this topic:</span></span>  
  
 [<span data-ttu-id="5fa89-111">クラシック モード サインインを使用した Windows 認証の要件</span><span class="sxs-lookup"><span data-stu-id="5fa89-111">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>](power-pivot-authentication-and-authorization.md#bkmk_auth)  
  
 [<span data-ttu-id="5fa89-112">ユーザーの承認を必要とする PowerPivot の操作</span><span class="sxs-lookup"><span data-stu-id="5fa89-112">PowerPivot Operations Requiring User Authorization</span></span>](#UserConnections)  
  
 [<span data-ttu-id="5fa89-113">PowerPivot データ アクセスに対する SharePoint 権限</span><span class="sxs-lookup"><span data-stu-id="5fa89-113">SharePoint Permissions for PowerPivot Data Access</span></span>](#Permissions)  
  
 [<span data-ttu-id="5fa89-114">Excel Services での PowerPivot ブックのセキュリティに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="5fa89-114">Excel Services security considerations for PowerPivot workbooks</span></span>](#excel)  
  
##  <a name="windows-authentication-using-classic-mode-sign-in-requirement"></a><a name="bkmk_auth"></a><span data-ttu-id="5fa89-115">クラシックモードのサインイン要件を使用した Windows 認証</span><span class="sxs-lookup"><span data-stu-id="5fa89-115">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>  
 <span data-ttu-id="5fa89-116">PowerPivot for SharePoint では、SharePoint で使用できる認証オプションを縮小したオプション セットがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="5fa89-116">PowerPivot for SharePoint supports a reduced set of the authentication options that are available in SharePoint.</span></span> <span data-ttu-id="5fa89-117">使用可能な認証オプションのうち、PowerPivot for SharePoint の配置では Windows 認証のみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-117">Of the available authentication options, only Windows authentication is supported for a PowerPivot for SharePoint deployment.</span></span> <span data-ttu-id="5fa89-118">さらに、サインインに使用する Web アプリケーションでクラシック モードが構成されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-118">In addition, the web application through which sign-in occurs must be configured for classic mode.</span></span>  
  
 <span data-ttu-id="5fa89-119">Windows 認証が必要なのは、PowerPivot for SharePoint の配置の Analysis Services データ エンジンで Windows 認証のみがサポートされているためです。</span><span class="sxs-lookup"><span data-stu-id="5fa89-119">Windows authentication is required because the Analysis Services data engine in a PowerPivot for SharePoint deployment supports only Windows authentication.</span></span> <span data-ttu-id="5fa89-120">Excel Services は、MSOLAP OLE DB プロバイダーを介して、NTLM または Kerberos プロトコルによって認証された Windows ユーザー ID を使用して、Analysis Services への接続を確立します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-120">Excel Services establishes connections to Analysis Services via the MSOLAP OLE DB provider using a Windows user identity that was authenticated via NTLM or the Kerberos protocol.</span></span>  
  
 <span data-ttu-id="5fa89-121">2 番目の要件である、Web アプリケーションでのクラシック モードの認証は、PowerPivot Web サービスを確実に運用できるようにするために必要です。</span><span class="sxs-lookup"><span data-stu-id="5fa89-121">The second requirement, classic mode authentication on the web application, is required to ensure the operability of the PowerPivot web service.</span></span> <span data-ttu-id="5fa89-122">Web サービスは、Web フロント エンドで実行されるコンポーネントで、ファーム内の PowerPivot for SharePoint サーバーへの HTTP リダイレクトを可能にします。</span><span class="sxs-lookup"><span data-stu-id="5fa89-122">The web service is a component that runs on a Web front-end and provides HTTP redirection to a PowerPivot for SharePoint server in the farm.</span></span> <span data-ttu-id="5fa89-123">Web サービスは、サービス間の通信の要求に対応しますが、ファーム内の PowerPivot 共有サービスに自らがルーティングするデータ接続要求には対応しません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-123">While the web service is claims aware for service-to-service communications, it is not claims aware for the data connection requests that it routes to a PowerPivot shared service in the farm.</span></span> <span data-ttu-id="5fa89-124">PowerPivot データを読み込む要求は、Windows ID を使用した IIS からの認証接続でのみサポートされます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-124">Requests to load PowerPivot data are only supported for authenticated connections that come from IIS using a Windows identity.</span></span> <span data-ttu-id="5fa89-125">Web アプリケーションでクラシック モードでサインインすることにより、PowerPivot Web サービスからファーム内の PowerPivot 共有サービスに接続することができます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-125">Classic mode sign-in on the web application is what enables a successful connection from the PowerPivot web service to PowerPivot shared services in the farm.</span></span>  
  
 <span data-ttu-id="5fa89-126">より一般的なデータ アクセスのシナリオ (PowerPivot データを、そのデータを表示する同じ Excel ブックから抽出する場合) にはクラシック モードのサインインは必要ありませんが、他の認証プロバイダーを使用するように構成された SharePoint Web アプリケーションでは、PowerPivot for SharePoint を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-126">Although classic mode sign-in is not required for the more common data access scenario (where PowerPivot data is extracted from the same Excel workbook that renders it) do not attempt to use PowerPivot for SharePoint with SharePoint web applications that are configured to use other authentication providers.</span></span> <span data-ttu-id="5fa89-127">使用した場合、外部データ ソースとして PowerPivot ブックにユーザーが接続しようとすると、必ず接続エラーになります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-127">Doing so will result in a connection failure whenever users try to connect to PowerPivot workbooks as an external data source.</span></span>  
  
 <span data-ttu-id="5fa89-128">クラシック モードのサインインを使用しないと、PowerPivot Web サービスによって処理される次の種類の要求は失敗します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-128">Without classic mode sign-in, the following types of requests that are handled by PowerPivot Web service will fail:</span></span>  
  
-   <span data-ttu-id="5fa89-129">PowerPivot データに対するファーム外からの要求 (たとえば、データ ソースが PowerPivot ブックへの SharePoint URL であるレポートをレポート デザイナーまたはレポート ビルダーで作成する場合)</span><span class="sxs-lookup"><span data-stu-id="5fa89-129">Any request for PowerPivot data that originates from outside the farm (for example, creating a report in Report Designer or Report Builder, where the data source is a SharePoint URL to a PowerPivot workbook)</span></span>  
  
-   <span data-ttu-id="5fa89-130">PowerPivot ブックを外部データ ソースとして使用するファーム内のクライアント アプリケーションまたはレポートからの要求 (たとえば、PowerPivot データを格納する 2 番目に公開された Excel ブックをデータ ソースとして使用し、Excel デスクトップ アプリケーションでブックを作成する場合)</span><span class="sxs-lookup"><span data-stu-id="5fa89-130">In-farm requests from a client application or report that uses the PowerPivot workbook as an external data source (for example, creating a workbook in the Excel desktop application, using as your data source a second published Excel workbook containing PowerPivot data)</span></span>  
  
### <a name="how-to-check-the-authentication-provider-for-your-application"></a><span data-ttu-id="5fa89-131">アプリケーションの認証プロバイダーを確認する方法</span><span class="sxs-lookup"><span data-stu-id="5fa89-131">How to check the authentication provider for your application</span></span>  
 <span data-ttu-id="5fa89-132">新しい Web アプリケーションを作成する場合は、[新しい Web アプリケーションの作成] ページで **[クラシック モード認証]** オプションを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-132">When creating new web applications, be sure to select the **Classic mode authentication** option in the Create New Web Application page.</span></span>  
  
 <span data-ttu-id="5fa89-133">既存の Web アプリケーションの場合は、次の手順に従って、Windows 認証を使用するように Web アプリケーションが構成されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-133">For existing web applications, use the following instructions to verify the web application is configured to use Windows authentication.</span></span>  
  
1.  <span data-ttu-id="5fa89-134">サーバーの全体管理で、[アプリケーション管理] の [ **web アプリケーションの管理**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5fa89-134">In Central Administration, in Application Management, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="5fa89-135">Web アプリケーションを選択します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-135">Select the web application.</span></span>  
  
3.  <span data-ttu-id="5fa89-136">**[認証プロバイダー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="5fa89-136">Click **Authentication Providers**.</span></span>  
  
4.  <span data-ttu-id="5fa89-137">各ゾーンに 1 つのプロバイダーがあり、既定のゾーンが Windows に設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-137">Verify that you have one provider for each zone, and the Default zone is set to Windows.</span></span>  
  
##  <a name="powerpivot-operations-requiring-user-authorization"></a><a name="UserConnections"></a><span data-ttu-id="5fa89-138">ユーザー承認を必要とする PowerPivot 操作</span><span class="sxs-lookup"><span data-stu-id="5fa89-138">PowerPivot Operations Requiring User Authorization</span></span>  
 <span data-ttu-id="5fa89-139">SharePoint の承認は、PowerPivot クエリおよび PowerPivot データ処理に対するすべてのレベルのアクセスに排他的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-139">SharePoint authorization is used exclusively for all levels of access to PowerPivot query and data processing.</span></span>  
  
 <span data-ttu-id="5fa89-140">Analysis Services のロールベースの承認モデルはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-140">The Analysis Services role-based authorization model is not supported.</span></span> <span data-ttu-id="5fa89-141">セル、行、テーブル レベルの PowerPivot データのロールベースの承認はありません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-141">There is no role-based authorization for PowerPivot data at the cell, row, or table level.</span></span> <span data-ttu-id="5fa89-142">ブックのさまざまな部分をセキュリティで保護することによって、ブック内にある機密データへのアクセスを特定のユーザーについて許可したり、拒否したりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-142">You cannot secure different parts of the workbook to grant or deny access to sensitive data within it for specific users.</span></span> <span data-ttu-id="5fa89-143">SharePoint ライブラリの Excel ブックに対する表示権限を持つユーザーは、埋め込まれた PowerPivot データをすべて使用できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-143">Embedded PowerPivot data is wholly available to users who have View permissions on the Excel workbook in a SharePoint library.</span></span>  
  
 <span data-ttu-id="5fa89-144">PowerPivot for SharePoint は、次の場合に SharePoint のユーザーの権限を借用します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-144">PowerPivot for SharePoint will impersonate a SharePoint user in the following cases:</span></span>  
  
-   <span data-ttu-id="5fa89-145">PowerPivot データベースへのデータ接続があるピボットテーブルまたはピボットグラフへのクエリ。PowerPivot サービス アプリケーションは、データを処理する PowerPivot 共有サービス インスタンスに対して、ユーザーに代わって接続を確立します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-145">Queries to PivotTables or PivotCharts that have data connections to a PowerPivot database, where a PowerPivot service application establishes connections on behalf of a user to a specific PowerPivot shared service instance that processes the data.</span></span>  
  
-   <span data-ttu-id="5fa89-146">キャッシュまたはライブラリからの PowerPivot データの読み込み (それ以外の方法ではデータを利用できない場合)。</span><span class="sxs-lookup"><span data-stu-id="5fa89-146">Loading PowerPivot data from cache or a library if the data is not otherwise available.</span></span> <span data-ttu-id="5fa89-147">システムにまだ読み込まれていない PowerPivot データに対してデータ接続要求が行われた場合、[!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] インスタンスでは、SharePoint ユーザー ID を使用して、データ ソースをコンテンツ ライブラリから取得し、メモリに読み込みます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-147">If a data connection request is made for PowerPivot data that is not already loaded in the system, the [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] instance will use the identity of the SharePoint user to retrieve the data source from a content library and load it into memory.</span></span>  
  
-   <span data-ttu-id="5fa89-148">データ ソースの更新されたコピーをコンテンツ ライブラリのブックに保存するデータ更新操作。</span><span class="sxs-lookup"><span data-stu-id="5fa89-148">Data refresh operations that save an updated copy of the data source to the workbook in a content library.</span></span> <span data-ttu-id="5fa89-149">この場合、実際のログオン操作は、Secure Store Service の対象アプリケーションから取得したユーザー名とパスワードを使用して実行されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-149">In this case, an actual log on operation is performed using the user name and password that is retrieved from a target application in Secure Store Service.</span></span> <span data-ttu-id="5fa89-150">資格情報には、PowerPivot 自動データ更新アカウント、またはデータ更新スケジュールの作成時に一緒に保存された資格情報を使用できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-150">Credentials can be the PowerPivot unattended data refresh account, or credentials that were stored with the data refresh schedule when it was created.</span></span> <span data-ttu-id="5fa89-151">詳細については、「 [Powerpivot データ更新用に格納されている資格情報を構成する &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) 」および「 [Powerpivot 自動データ更新アカウント &#40;PowerPivot for SharePoint&#41;を構成](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-151">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="sharepoint-permissions-for-powerpivot-data-access"></a><a name="Permissions"></a><span data-ttu-id="5fa89-152">PowerPivot データアクセスに対する SharePoint 権限</span><span class="sxs-lookup"><span data-stu-id="5fa89-152">SharePoint Permissions for PowerPivot Data Access</span></span>  
 <span data-ttu-id="5fa89-153">PowerPivot ブックのパブリッシュ、管理、およびセキュリティでの保護は、SharePoint 統合を通じてのみサポートされます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-153">Publishing, managing, and securing a PowerPivot workbook is supported solely through SharePoint integration.</span></span> <span data-ttu-id="5fa89-154">SharePoint サーバーは、データへの正当なアクセスを確保する認証サブシステムと承認サブシステムを提供します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-154">SharePoint servers provide authentication and authorization subsystems that ensure legitimate access to data.</span></span> <span data-ttu-id="5fa89-155">SharePoint ファーム外に PowerPivot ブックを安全に配置するシナリオはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-155">There are no supported scenarios for securely deploying a PowerPivot workbook outside of a SharePoint farm.</span></span>  
  
 <span data-ttu-id="5fa89-156">サーバー上では、PowerPivot データへの表示権限以上のユーザー アクセスは、読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="5fa89-156">User access to PowerPivot data is read-only on the server through View permissions or higher.</span></span> <span data-ttu-id="5fa89-157">投稿権限では、ファイルを追加および編集できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-157">Contribute permissions allow for adding and editing the file.</span></span> <span data-ttu-id="5fa89-158">PowerPivot データを変更するには、PowerPivot for Excel がインストールされている Excel デスクトップ アプリケーションにブックをダウンロードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-158">Changes to PowerPivot data require that you download the workbook to an Excel desktop application that has PowerPivot for Excel installed.</span></span> <span data-ttu-id="5fa89-159">ファイルに対する投稿権限があるかどうかにより、ユーザーがファイルをローカル コンピューターにダウンロードして、変更内容を再び SharePoint に保存することができるかどうかが決まります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-159">Contribute permissions on the file will determine whether the user can download the file locally and then save changes back to SharePoint.</span></span>  
  
 <span data-ttu-id="5fa89-160">つまり、投稿および表示のみのレベルの権限によって、PowerPivot データへのユーザー アクセスに対する有効な権限セットが定義されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-160">As such, Contribute and View Only levels of permission define the effective set of permissions for user access to PowerPivot data.</span></span> <span data-ttu-id="5fa89-161">その他の権限レベルは、その権限レベルに投稿および表示のみと同じ権限がある場合にその範囲内で機能します (たとえば、読み取り権限には表示のみ権限が含まれるので、読み取りに割り当てられているユーザーは表示のみと同じアクセス レベルを持ちます)。</span><span class="sxs-lookup"><span data-stu-id="5fa89-161">Other permission levels work to the extent that they have the same permissions as Contribute and View Only (For example, because Read includes View Only permissions, a user who is assigned to Read will have same level of access as View Only).</span></span>  
  
 <span data-ttu-id="5fa89-162">次の表に、PowerPivot データやサーバー操作へのアクセスを決定する権限レベルを要約します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-162">The following table summarizes the permission levels that determine access to PowerPivot data and server operations:</span></span>  
  
|<span data-ttu-id="5fa89-163">権限レベル</span><span class="sxs-lookup"><span data-stu-id="5fa89-163">Permission level</span></span>|<span data-ttu-id="5fa89-164">許可されるタスク</span><span class="sxs-lookup"><span data-stu-id="5fa89-164">Allows these tasks</span></span>|  
|----------------------|------------------------|  
|<span data-ttu-id="5fa89-165">ファームまたはサービス管理者</span><span class="sxs-lookup"><span data-stu-id="5fa89-165">Farm or service administrator</span></span>|<span data-ttu-id="5fa89-166">サービスおよびアプリケーションをインストール、有効化、および構成します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-166">Install, enable, and configure services and applications.</span></span><br /><br /> <span data-ttu-id="5fa89-167">PowerPivot 管理ダッシュボードを使用し、管理レポートを表示します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-167">Use PowerPivot Management Dashboard and view administrative reports.</span></span>|  
|<span data-ttu-id="5fa89-168">フル コントロール</span><span class="sxs-lookup"><span data-stu-id="5fa89-168">Full control</span></span>|<span data-ttu-id="5fa89-169">サイト コレクション レベルで PowerPivot 機能統合をアクティブ化します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-169">Activate PowerPivot feature integration at the site collection level.</span></span><br /><br /> <span data-ttu-id="5fa89-170">PowerPivot ギャラリー ライブラリを作成します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-170">Create a PowerPivot Gallery library.</span></span><br /><br /> <span data-ttu-id="5fa89-171">データ フィード ライブラリを作成します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-171">Create a data feed library.</span></span>|  
|<span data-ttu-id="5fa89-172">投稿</span><span class="sxs-lookup"><span data-stu-id="5fa89-172">Contribute</span></span>|<span data-ttu-id="5fa89-173">PowerPivot ブックを追加、編集、削除、およびダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="5fa89-173">Add, edit, delete, and download PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="5fa89-174">データ更新を構成します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-174">Configure data refresh.</span></span><br /><br /> <span data-ttu-id="5fa89-175">SharePoint サイトで PowerPivot ブックに基づいて新しいブックやレポートを作成します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-175">Create new workbooks and reports based on PowerPivot workbooks on a SharePoint site.</span></span><br /><br /> <span data-ttu-id="5fa89-176">データ フィード ライブラリにデータ サービス ドキュメントを作成します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-176">Create data service documents in a data feed library</span></span>|  
|<span data-ttu-id="5fa89-177">Read</span><span class="sxs-lookup"><span data-stu-id="5fa89-177">Read</span></span>|<span data-ttu-id="5fa89-178">PowerPivot ブックに外部データソースとしてアクセスします。この場合、ブックの URL は接続ダイアログボックス (たとえば、Excel のデータ接続ウィザード) で明示的に入力されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-178">Access PowerPivot workbooks as an external data source, where the workbook URL is explicitly entered in a connection dialog box (for example, in Excel's Data Connection Wizard).</span></span>|  
|<span data-ttu-id="5fa89-179">表示のみ</span><span class="sxs-lookup"><span data-stu-id="5fa89-179">View Only</span></span>|<span data-ttu-id="5fa89-180">PowerPivot ブックを表示します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-180">View PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="5fa89-181">データ更新履歴を表示します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-181">View data refresh history.</span></span><br /><br /> <span data-ttu-id="5fa89-182">ローカル ブックを SharePoint サイト上の PowerPivot ブックに接続し、そのデータの用途を変更します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-182">Connect a local workbook to a PowerPivot workbook on a SharePoint site, to repurpose its data in other ways.</span></span><br /><br /> <span data-ttu-id="5fa89-183">ブックのスナップショットをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="5fa89-183">Download a snapshot of the workbook.</span></span> <span data-ttu-id="5fa89-184">スナップショットは、スライサー、フィルター、式、またはデータ接続を含まない、データの静的なコピーです。</span><span class="sxs-lookup"><span data-stu-id="5fa89-184">The snapshot is a static copy of the data, without slicers, filters, formulas, or data connections.</span></span> <span data-ttu-id="5fa89-185">スナップショットの内容は、ブラウザー ウィンドウからのセル値のコピーに似ています。</span><span class="sxs-lookup"><span data-stu-id="5fa89-185">The contents of the snapshot are similar to copying cell values from the browser window.</span></span>|  
  
##  <a name="excel-services-security-considerations-for-powerpivot-workbooks"></a><a name="excel"></a><span data-ttu-id="5fa89-186">Excel Services での PowerPivot ブックのセキュリティに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="5fa89-186">Excel Services security considerations for PowerPivot workbooks</span></span>  
 <span data-ttu-id="5fa89-187">PowerPivot のサーバー側クエリ処理は、Excel サービスと密接に結び付いています。</span><span class="sxs-lookup"><span data-stu-id="5fa89-187">PowerPivot server-side query processing is tightly coupled with Excel services.</span></span> <span data-ttu-id="5fa89-188">製品の統合は、ドキュメント レベルで開始されます。PowerPivot ブックは、PowerPivot データを含んでいるか、参照している Excel ブック (.xlsx) ファイルです。</span><span class="sxs-lookup"><span data-stu-id="5fa89-188">Product integration begins at the document level, in that PowerPivot workbooks are Excel workbook (.xlsx) files that either contain or reference PowerPivot data.</span></span> <span data-ttu-id="5fa89-189">PowerPivot ブック用の個別のファイル拡張子はありません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-189">There is no separate file extension for a PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="5fa89-190">PowerPivot ブックを SharePoint サイトで開くと、Excel Services は PowerPivot の埋め込みデータ接続文字列を読み取り、要求をローカルの SQL Server Analysis Services OLE DB プロバイダーに転送します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-190">When a PowerPivot workbook is opened on a SharePoint site, Excel Services reads the embedded PowerPivot data connection string and forwards the request to the local SQL Server Analysis Services OLE DB provider.</span></span> <span data-ttu-id="5fa89-191">プロバイダーは、この接続情報をファーム内の PowerPivot サーバーに渡します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-191">The provider then passes the connection information to a PowerPivot server in the farm.</span></span> <span data-ttu-id="5fa89-192">要求が 2 つのサーバー間でシームレスに流れるには、PowerPivot for SharePoint により要求される設定を使用するように Excel Services を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-192">In order for requests to flow seamlessly between the two servers, Excel Services must be configured to use settings that are required by PowerPivot for SharePoint.</span></span>  
  
 <span data-ttu-id="5fa89-193">Excel Services では、セキュリティ関連の構成設定は信頼できる場所、信頼できるデータ プロバイダー、および信頼できるデータ接続ライブラリで指定します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-193">In Excel Services, security-related configuration settings are specified on trusted locations, trusted data providers, and trusted data connection libraries.</span></span> <span data-ttu-id="5fa89-194">次の表に、PowerPivot データ アクセスを有効化または拡張する設定の説明を示します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-194">The following table describes the settings that enable or enhance PowerPivot data access.</span></span> <span data-ttu-id="5fa89-195">ここに記載されていない設定は、PowerPivot サーバー接続には影響しません。</span><span class="sxs-lookup"><span data-stu-id="5fa89-195">If a setting is not listed here, it has no effect on PowerPivot server connections.</span></span> <span data-ttu-id="5fa89-196">これらの設定を指定する手順については、「[初期構成 &#40;PowerPivot for SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md)」の「Excel Services の有効化」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-196">For instructions on how to specify these settings step by step, see the section "Enable Excel Services" in [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5fa89-197">ほとんどのセキュリティ関連の設定は、信頼できる場所に適用されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-197">Most security-related settings apply to trusted locations.</span></span> <span data-ttu-id="5fa89-198">既定値を保持するか、サイトごとに異なる値を使用する場合は、PowerPivot データを含むサイト用に信頼できる場所を追加作成し、そのサイトにのみ以下の設定を構成できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-198">If you want to preserve default values or use different values for different sites, you can create an additional trusted location for sites that contain PowerPivot data, and then configure the following settings for just that site.</span></span> <span data-ttu-id="5fa89-199">詳細については、「 [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-199">For more information, see [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span></span>  
  
|<span data-ttu-id="5fa89-200">領域</span><span class="sxs-lookup"><span data-stu-id="5fa89-200">Area</span></span>|<span data-ttu-id="5fa89-201">設定</span><span class="sxs-lookup"><span data-stu-id="5fa89-201">Setting</span></span>|<span data-ttu-id="5fa89-202">説明</span><span class="sxs-lookup"><span data-stu-id="5fa89-202">Description</span></span>|  
|----------|-------------|-----------------|  
|<span data-ttu-id="5fa89-203">Web アプリケーション</span><span class="sxs-lookup"><span data-stu-id="5fa89-203">Web application</span></span>|<span data-ttu-id="5fa89-204">Windows 認証プロバイダー</span><span class="sxs-lookup"><span data-stu-id="5fa89-204">Windows authentication provider</span></span>|<span data-ttu-id="5fa89-205">PowerPivot は、Excel Services から取得した要求トークンを Windows ユーザー ID に変換します。</span><span class="sxs-lookup"><span data-stu-id="5fa89-205">PowerPivot converts a claims token that it gets from Excel Services to a Windows user identity.</span></span> <span data-ttu-id="5fa89-206">Excel Services をリソースとして使用する Web アプリケーションは、Windows 認証プロバイダーを使用するように構成されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-206">Any web application that uses Excel Services as a resource must be configured to use the Windows authentication provider.</span></span>|  
|<span data-ttu-id="5fa89-207">信頼できる場所</span><span class="sxs-lookup"><span data-stu-id="5fa89-207">Trusted location</span></span>|<span data-ttu-id="5fa89-208">場所の種類</span><span class="sxs-lookup"><span data-stu-id="5fa89-208">Location Type</span></span>|<span data-ttu-id="5fa89-209">この値は、 **[Microsoft SharePoint Foundation]** に設定されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-209">This value must be set to **Microsoft SharePoint Foundation**.</span></span> <span data-ttu-id="5fa89-210">PowerPivot サーバーは、.xlsx ファイルのコピーを取得して、それをファーム内の Analysis Services サーバーに読み込みます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-210">PowerPivot servers retrieve a copy of the .xlsx file and load it on an Analysis Services server in the farm.</span></span> <span data-ttu-id="5fa89-211">このサーバーはコンテンツ ライブラリから .xlsx ファイルのみを取得できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-211">The server can only retrieve .xlsx files from a content library.</span></span>|  
||<span data-ttu-id="5fa89-212">外部データの許可</span><span class="sxs-lookup"><span data-stu-id="5fa89-212">Allow External Data</span></span>|<span data-ttu-id="5fa89-213">この値は、 **[信頼できるデータ接続ライブラリと、埋め込まれている接続]** に設定されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-213">This value must be set to **Trusted data connection libraries and embedded**.</span></span> <span data-ttu-id="5fa89-214">PowerPivot データ接続は、ブックに埋め込まれています。</span><span class="sxs-lookup"><span data-stu-id="5fa89-214">PowerPivot data connections are embedded in the workbook.</span></span> <span data-ttu-id="5fa89-215">埋め込み接続を禁止した場合、ユーザーは、ピボットテーブル キャッシュは表示できますが、PowerPivot データを操作することはできなくなります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-215">If you disallow embedded connections, users can view the PivotTable cache, but they will not be able to interact with the PowerPivot data.</span></span>|  
||<span data-ttu-id="5fa89-216">更新時の警告</span><span class="sxs-lookup"><span data-stu-id="5fa89-216">Warn on Refresh</span></span>|<span data-ttu-id="5fa89-217">PowerPivot ギャラリーを使用してブックやレポートを格納している場合は、この値を無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-217">This value should be disabled if you are using PowerPivot Gallery to store workbooks and reports.</span></span> <span data-ttu-id="5fa89-218">PowerPivot ギャラリーには、[開くときに更新する] と [更新時の警告] の両方がオフになっているときに最適に動作するドキュメント プレビュー機能が含まれています。</span><span class="sxs-lookup"><span data-stu-id="5fa89-218">PowerPivot Gallery includes a document preview feature that works best if both refresh on open and Warn on Refresh are turned off.</span></span>|  
|<span data-ttu-id="5fa89-219">信頼できるデータ プロバイダー</span><span class="sxs-lookup"><span data-stu-id="5fa89-219">Trusted data providers</span></span>|<span data-ttu-id="5fa89-220">MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="5fa89-220">MSOLAP.4</span></span><br /><br /> <span data-ttu-id="5fa89-221">MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="5fa89-221">MSOLAP.5</span></span>|<span data-ttu-id="5fa89-222">既定では MSOLAP.4 が含まれますが、PowerPivot データ アクセスでは、MSOLAP.4 プロバイダーが SQL Server 2008 R2 バージョンである必要があります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-222">MSOLAP.4 is included by default, but PowerPivot data access requires that the MSOLAP.4 provider be the SQL Server 2008 R2 version.</span></span><br /><br /> <span data-ttu-id="5fa89-223">MSOLAP.5 は、PowerPivot for SharePoint の [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] バージョンと共にインストールされます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-223">MSOLAP.5 is installed with the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of PowerPivot for SharePoint.</span></span><br /><br /> <span data-ttu-id="5fa89-224">これらのプロバイダーは、信頼できるデータ プロバイダー一覧から削除しないでください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-224">Do not remove these providers from the trusted data provider list.</span></span> <span data-ttu-id="5fa89-225">場合によっては、ファーム内の別の SharePoint サーバーにもこのプロバイダーの追加のコピーをインストールすることが必要になることもあります。</span><span class="sxs-lookup"><span data-stu-id="5fa89-225">In some cases, you might need to install additional copies of this provider on other SharePoint servers in your farm.</span></span> <span data-ttu-id="5fa89-226">「 [SharePoint サーバーへの Analysis Services OLE DB プロバイダーのインストール](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-226">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>|  
|<span data-ttu-id="5fa89-227">信頼できるデータ接続ライブラリ</span><span class="sxs-lookup"><span data-stu-id="5fa89-227">Trusted data connection libraries</span></span>|<span data-ttu-id="5fa89-228">省略可能。</span><span class="sxs-lookup"><span data-stu-id="5fa89-228">Optional.</span></span>|<span data-ttu-id="5fa89-229">PowerPivot ブックでは、Office データ接続 (.odc) ファイルを使用できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-229">You can use Office Data Connection (.odc) files in PowerPivot workbooks.</span></span> <span data-ttu-id="5fa89-230">.odc ファイルを使用してローカル PowerPivot ブックに接続情報を提供する場合、同じ .odc ファイルをこのライブラリに追加できます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-230">If you use .odc files to provide connection information to local PowerPivot workbooks, you can add the same .odc files to this library.</span></span>|  
|<span data-ttu-id="5fa89-231">ユーザー定義関数アセンブリ</span><span class="sxs-lookup"><span data-stu-id="5fa89-231">User defined function assembly</span></span>|<span data-ttu-id="5fa89-232">該当なし。</span><span class="sxs-lookup"><span data-stu-id="5fa89-232">Not applicable.</span></span>|<span data-ttu-id="5fa89-233">PowerPivot for SharePoint では、Excel Services 用にビルドおよび配置するユーザー定義関数アセンブリは無視されます。</span><span class="sxs-lookup"><span data-stu-id="5fa89-233">PowerPivot for SharePoint ignores user-defined function assemblies that you build deploy for Excel Services.</span></span> <span data-ttu-id="5fa89-234">特定の動作についてユーザー定義アセンブリに依存する場合、作成したユーザー定義関数は PowerPivot クエリ処理では使用されないことに留意してください。</span><span class="sxs-lookup"><span data-stu-id="5fa89-234">If you rely on user-defined assemblies for a specific behavior, be aware that PowerPivot query processing will not use the user-defined functions you created.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="5fa89-235">参照</span><span class="sxs-lookup"><span data-stu-id="5fa89-235">See Also</span></span>  
 <span data-ttu-id="5fa89-236">[PowerPivot サービスアカウントの構成](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="5fa89-236">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 <span data-ttu-id="5fa89-237">[PowerPivot 自動データ更新アカウント &#40;PowerPivot for SharePoint を構成し&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="5fa89-237">[Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span></span>  
 <span data-ttu-id="5fa89-238">[サーバーの全体管理での PowerPivot サイト用の信頼できる場所の作成](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span><span class="sxs-lookup"><span data-stu-id="5fa89-238">[Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span></span>  
 [<span data-ttu-id="5fa89-239">PowerPivot のセキュリティアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="5fa89-239">PowerPivot Security Architecture</span></span>](https://go.microsoft.com/fwlink/?linkID=220970)  
  
  
