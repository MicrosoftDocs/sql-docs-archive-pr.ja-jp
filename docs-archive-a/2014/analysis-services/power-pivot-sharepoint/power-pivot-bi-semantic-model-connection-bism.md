---
title: PowerPivot BI セマンティックモデル接続 (. bism) |Microsoft Docs
ms.custom: ''
ms.date: 04/19/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 08828eec-4f8c-4f34-a145-e442f7b7031d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 14a30128986a5ba23cb093be771c036c94fa25ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87644174"
---
# <a name="powerpivot-bi-semantic-model-connection-bism"></a><span data-ttu-id="27c95-102">PowerPivot BI セマンティック モデル接続 (.bism)</span><span class="sxs-lookup"><span data-stu-id="27c95-102">PowerPivot BI Semantic Model Connection (.bism)</span></span>
  <span data-ttu-id="27c95-103">BI セマンティック モデル接続 (.bism) は、Excel または [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] レポートを [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] テーブル モデル データベースまたは多次元モードの [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスに接続する、移植可能な接続です。</span><span class="sxs-lookup"><span data-stu-id="27c95-103">A BI semantic model connection (.bism) is a portable connection that connects Excel or [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports to an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model database or an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in multidimensional mode.</span></span> <span data-ttu-id="27c95-104">Office データ接続 (.odc) ファイルに精通している場合は、.bism 接続ファイルの定義方法と使用方法が類似していることがわかります。</span><span class="sxs-lookup"><span data-stu-id="27c95-104">If you are familiar with office data connection (.odc) files, you will notice a similarity in how a .bism connection file is defined and used.</span></span>  
  
 <span data-ttu-id="27c95-105">BI セマンティック モデル接続は、SharePoint 経由で作成およびアクセスされます。</span><span class="sxs-lookup"><span data-stu-id="27c95-105">A BI semantic model connection is created and accessed via SharePoint.</span></span> <span data-ttu-id="27c95-106">BI セマンティック モデル接続を作成すると、ライブラリの BI セマンティック モデル接続でサイド リンク バー コマンドが有効になります。</span><span class="sxs-lookup"><span data-stu-id="27c95-106">Creating BI semantic model connections enables quick launch commands on a BI semantic model connection in a library.</span></span> <span data-ttu-id="27c95-107">サイド リンク バー コマンドは、新しい Excel ブックまたは接続ファイルを編集するためのオプションを開きます。</span><span class="sxs-lookup"><span data-stu-id="27c95-107">Quick launch commands open a new Excel workbook or options for editing the connection file.</span></span> <span data-ttu-id="27c95-108">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] がインストールされている場合は、 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] レポートを作成するコマンドも表示されます。</span><span class="sxs-lookup"><span data-stu-id="27c95-108">If [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] is installed, you will also see a command to create a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report.</span></span>  
  
 <span data-ttu-id="27c95-109">![BISM サイド リンク バー コマンドのスクリーンショット](../media/ssas-bism-quicklaunch.gif "BISM サイド リンク バー コマンドのスクリーンショット")</span><span class="sxs-lookup"><span data-stu-id="27c95-109">![Screenshot of BISM quick launch command](../media/ssas-bism-quicklaunch.gif "Screenshot of BISM quick launch command")</span></span>  
  
##  <a name="supported-databases"></a><a name="bkmk_prereq"></a><span data-ttu-id="27c95-110">サポートされるデータベース</span><span class="sxs-lookup"><span data-stu-id="27c95-110">Supported databases</span></span>  
 <span data-ttu-id="27c95-111">BI セマンティック モデル接続は、テーブル モデル データを参照します。</span><span class="sxs-lookup"><span data-stu-id="27c95-111">A BI semantic model connection points to tabular model data.</span></span> <span data-ttu-id="27c95-112">このデータには、次の 3 つのソースがあります。</span><span class="sxs-lookup"><span data-stu-id="27c95-112">There are three sources for this data:</span></span>  
  
-   <span data-ttu-id="27c95-113">表形式サーバー モードのスタンドアロン Analysis Services インスタンスで実行されている表形式モデル データベース。</span><span class="sxs-lookup"><span data-stu-id="27c95-113">A tabular model database running on a standalone Analysis Services instance in tabular server mode.</span></span> <span data-ttu-id="27c95-114">スタンドアロン Analysis Services インスタンスは、ファーム外部に配置されます。</span><span class="sxs-lookup"><span data-stu-id="27c95-114">A deployment of a standalone Analysis Services instance is external to the farm.</span></span> <span data-ttu-id="27c95-115">ファーム外部のデータ ソースにアクセスするには、追加の権限が必要です。追加の権限については、「 [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="27c95-115">Accessing data sources off the farm requires additional permissions, which you can read about in this topic: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
-   <span data-ttu-id="27c95-116">SharePoint に保存された PowerPivot ブック。</span><span class="sxs-lookup"><span data-stu-id="27c95-116">PowerPivot workbooks saved to SharePoint.</span></span> <span data-ttu-id="27c95-117">Excel ブックに埋め込まれた PowerPivot データベースが、スタンドアロン Analysis Services 表形式モード サーバーで実行される表形式モデル データベースに相当します。</span><span class="sxs-lookup"><span data-stu-id="27c95-117">Embedded PowerPivot databases inside Excel workbooks are equivalent to tabular model databases that run on a standalone Analysis Services tabular mode server.</span></span> <span data-ttu-id="27c95-118">既に PowerPivot for Excel と PowerPivot for SharePoint を使用している場合は、SharePoint ライブラリ内の PowerPivot ブックを参照する BI セマンティック モデル接続を定義し、既存の PowerPivot データを使用して [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] レポートを作成できます。</span><span class="sxs-lookup"><span data-stu-id="27c95-118">If you already use PowerPivot for Excel and PowerPivot for SharePoint, you can define a BI semantic model connection that points to PowerPivot workbooks in a SharePoint library and build [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports using existing PowerPivot data.</span></span>  <span data-ttu-id="27c95-119">SQL Server 2008 R2 または [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] バージョンの PowerPivot for Excel で作成されたブックを使用できます。</span><span class="sxs-lookup"><span data-stu-id="27c95-119">You can use workbooks created in either SQL Server 2008 R2 or [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] versions of PowerPivot for Excel.</span></span>  
  
-   <span data-ttu-id="27c95-120">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンス上の多次元データ モデル。</span><span class="sxs-lookup"><span data-stu-id="27c95-120">A multidimensional data model on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="27c95-121">データ ソースの比較については、コミュニティ コンテンツ「 [SQL Server 2012 BI セマンティック モデル (BISM) について)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="27c95-121">For a comparison of the data sources, see the community  content [Understanding the SQL Server 2012 BI Semantic Model (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).</span></span>  
  
## <a name="understanding-the-connection-sequence-for-bi-semantic-connections"></a><span data-ttu-id="27c95-122">BI セマンティック接続の接続シーケンスについて</span><span class="sxs-lookup"><span data-stu-id="27c95-122">Understanding the Connection Sequence for BI Semantic Connections</span></span>  
 <span data-ttu-id="27c95-123">このセクションでは、さまざまなクライアント アプリケーション (Excel デスクトップ アプリケーション、SharePoint の Power View レポート クライアントなど) と SharePoint ファーム内または外のテーブル モデル データベースとの接続動作について説明します。</span><span class="sxs-lookup"><span data-stu-id="27c95-123">This section explains the connection behavior between various client applications, such as the Excel desktop application or the Power View reporting client on SharePoint, and a tabular model database inside or outside the SharePoint farm.</span></span>  
  
 <span data-ttu-id="27c95-124">テーブル モデル データベースへのすべての接続は、データを要求しているユーザーの資格情報を使用して作成されます。</span><span class="sxs-lookup"><span data-stu-id="27c95-124">All connections to a tabular model database are made using the credentials of the user who is requesting the data.</span></span> <span data-ttu-id="27c95-125">ただし、その接続のしくみは、接続がファーム内接続、シングルホップ接続、ダブルホップ接続のいずれであるかと、Kerberos が有効かどうかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="27c95-125">However, the mechanics of that connection will vary depending on whether the connection is an in-farm connection, a single or double-hop connection, and whether Kerberos is enabled.</span></span> <span data-ttu-id="27c95-126">SharePoint とバックエンド データ ソースとの認証接続の詳細については、「 [ダブルホップ認証: NTLM では失敗し、Kerberos では成功する理由](https://go.microsoft.com/fwlink/?LinkId=237137)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="27c95-126">For more information about authenticated connections between SharePoint and backend data sources, see [Double-hop authentication: Why NTLM fails and Kerberos works](https://go.microsoft.com/fwlink/?LinkId=237137).</span></span>  
  
 <span data-ttu-id="27c95-127">**Excel からネットワーク上の表形式データへの接続**</span><span class="sxs-lookup"><span data-stu-id="27c95-127">**Connecting from Excel to tabular data on a network**</span></span>  
  
 <span data-ttu-id="27c95-128">Excel ユーザーがデータ ソースとして BI セマンティック モデル接続を指定すると、.bism ファイル内の接続情報がクライアント アプリケーションにダウンロードされ、そのアプリケーションが Analysis Services 上のテーブル モデル データベースに独自の直接要求を発行します。</span><span class="sxs-lookup"><span data-stu-id="27c95-128">When an Excel user specifies a BI semantic model connection as a data source, the connection information inside the .bism file is downloaded to the client application, which then issues its own direct request to the tabular model database on Analysis Services.</span></span> <span data-ttu-id="27c95-129">.bism 接続にアクセスするには、Excel ユーザーは .bism 接続ファイルに対する読み取り権限を持つ SharePoint ユーザーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="27c95-129">To access the .bism connection, the Excel user must be a SharePoint user with read permissions on the .bism connection file.</span></span> <span data-ttu-id="27c95-130">接続情報がダウンロードされると、その後のすべての接続は SharePoint をバイパスし、Excel からバックエンド テーブル モデル データベースに直接送られるようになります。</span><span class="sxs-lookup"><span data-stu-id="27c95-130">Once the connection information is downloaded, all subsequent connections bypass SharePoint, flowing directly from Excel to the backend tabular model database.</span></span>  
  
 <span data-ttu-id="27c95-131">次の図は、この接続シーケンスを示しています。</span><span class="sxs-lookup"><span data-stu-id="27c95-131">The following illustration shows this connection sequence.</span></span> <span data-ttu-id="27c95-132">.bism 接続の要求で始まり、クライアントに接続情報がダウンロードされて、最後にデータベースへのシングルホップ接続が行われます。</span><span class="sxs-lookup"><span data-stu-id="27c95-132">It starts with a request for the .bism connection, followed by the download of connection information to the client, and finally the single-hop connection to the database.</span></span> <span data-ttu-id="27c95-133">接続は、Analysis Services データベースに対する読み取り権限を持つ Excel ユーザーの Windows 資格情報を使用して作成されます。</span><span class="sxs-lookup"><span data-stu-id="27c95-133">The connection is made using the Windows credentials of the Excel user, who has read permissions on the Analysis Services database.</span></span> <span data-ttu-id="27c95-134">シングルホップであるため、Kerberos が有効になっていても、このシナリオでは必要とされません。</span><span class="sxs-lookup"><span data-stu-id="27c95-134">It is a single hop, so even if Kerberos is enabled, it is not required for this scenario.</span></span>  
  
 <span data-ttu-id="27c95-135">![Excel からテーブル モデル データベースへの接続](../media/ssas-powerpivotbismconnection-1.gif "Excel からテーブル モデル データベースへの接続")</span><span class="sxs-lookup"><span data-stu-id="27c95-135">![Connections from Excel to tabular model database](../media/ssas-powerpivotbismconnection-1.gif "Connections from Excel to tabular model database")</span></span>  
  
 <span data-ttu-id="27c95-136">**Power View からネットワーク上の表形式データへの接続**</span><span class="sxs-lookup"><span data-stu-id="27c95-136">**Connecting from Power View to tabular data on a network**</span></span>  
  
 <span data-ttu-id="27c95-137">SharePoint ユーザーがドキュメント ライブラリ内の BI セマンティック接続をクリックすると、Power View (インストールされている場合) が直ちに起動され、テーブル モデル データベースへの接続を開きます。</span><span class="sxs-lookup"><span data-stu-id="27c95-137">When a SharePoint user clicks on a BI semantic connection in a document library, Power View (if it is installed), starts immediately and opens a connection to the tabular model database.</span></span>  
  
 <span data-ttu-id="27c95-138">Power View とテーブル モデル データベースとの接続は、ダブルホップ認証シーケンスに従って行われ、ユーザーの ID はクライアントから SharePoint に送られてから、SharePoint からファーム外で実行されるバックエンド Analysis Services テーブル モデル データベースに送られます。</span><span class="sxs-lookup"><span data-stu-id="27c95-138">Connections between Power View and a tabular model database follow a double-hop authentication sequence where the user identity is flowed from the client to SharePoint, and then from SharePoint to a back-end Analysis Services tabular model database that runs outside of the farm.</span></span> <span data-ttu-id="27c95-139">接続要求を処理する ADOMD.NET クライアント ライブラリは常に、最初の試行で Kerberos を利用しようとします。</span><span class="sxs-lookup"><span data-stu-id="27c95-139">The ADOMD.NET client library that handles the connection request always tries Kerberos on the first attempt.</span></span> <span data-ttu-id="27c95-140">Kerberos が構成されていると、テーブル モデル データベースへの接続に対してユーザー ID の権限が借用され、接続は成功します。</span><span class="sxs-lookup"><span data-stu-id="27c95-140">If Kerberos is configured, the user identity is impersonated on the connection to the tabular model database, and the connection succeeds.</span></span>  
  
 <span data-ttu-id="27c95-141">Kerberos が構成されておらず、要求が失敗した場合は、Reporting Services が 2 度目の試行を行います。</span><span class="sxs-lookup"><span data-stu-id="27c95-141">If Kerberos is not configured and the request fails, Reporting Services makes a second attempt.</span></span> <span data-ttu-id="27c95-142">このシナリオでは、クライアント ライブラリが Reporting Services のサービス ID と NTLM 認証を使用して、Analysis Services に接続します。</span><span class="sxs-lookup"><span data-stu-id="27c95-142">Under this scenario, the client library connects to Analysis Services using the Reporting Services service identity and NTLM authentication.</span></span> <span data-ttu-id="27c95-143">Power View ユーザーの ID は、`effectiveusername` パラメーターを使用して、接続文字列で渡されます。</span><span class="sxs-lookup"><span data-stu-id="27c95-143">The identity of the Power View user is passed on the connection string using the `effectiveusername` parameter.</span></span>  
  
 <span data-ttu-id="27c95-144">Analysis Services インスタンス上のシステム管理者ロールのメンバーだけが、`effectiveusername` パラメーターを使用して接続を作成し、サーバー インスタンスの他のユーザーの権限を借用する権限を持っています。</span><span class="sxs-lookup"><span data-stu-id="27c95-144">Only a member of the system administrator role on the Analysis Services instance has permission to make a connection using the `effectiveusername` parameter and impersonate another user on the server instance.</span></span> <span data-ttu-id="27c95-145">そのため、Reporting Services 共有サービスの実行アカウントは、Analysis Services インスタンスに対する管理権限を持っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="27c95-145">For this reason, the execution account of the Reporting Services shared service must have administrative rights on the Analysis Services instance.</span></span>  <span data-ttu-id="27c95-146">サービス アカウントに管理権限を付与する手順は、このトピックの「 [テーブル モデル データベースへの BI セマンティック モデル接続の作成](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)」に示されています。</span><span class="sxs-lookup"><span data-stu-id="27c95-146">Instructions for granting administrative permissions to the service account is provided in this topic, [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
 <span data-ttu-id="27c95-147">次の図は、各接続に同じ Windows ユーザー ID を使用する接続シーケンスを示しています。</span><span class="sxs-lookup"><span data-stu-id="27c95-147">The following illustration shows a connection sequence that uses the same Windows user identity for each connection.</span></span> <span data-ttu-id="27c95-148">Analysis Services への最後の接続では、Reporting Services サービス アプリケーション ID で接続が作成され、`effectiveusername` を使用して Windows ユーザー ID が渡されています。</span><span class="sxs-lookup"><span data-stu-id="27c95-148">On the last connection to Analysis Services, the connection is made by the Reporting Services service application identity, passing the Windows user identity using `effectiveusername`.</span></span>  
  
 <span data-ttu-id="27c95-149">![テーブル データベースに対する借用の接続](../media/ssas-powerpivotbismconnection-2.gif "テーブル データベースに対する借用の接続")</span><span class="sxs-lookup"><span data-stu-id="27c95-149">![Imersonated connection to tabular db](../media/ssas-powerpivotbismconnection-2.gif "Imersonated connection to tabular db")</span></span>  
  
 <span data-ttu-id="27c95-150">**Power View から SharePoint の PowerPivot データへの接続**</span><span class="sxs-lookup"><span data-stu-id="27c95-150">**Connecting from Power View to PowerPivot data in SharePoint**</span></span>  
  
 <span data-ttu-id="27c95-151">SharePoint ユーザーが、同じファーム内の PowerPivot ブックに解決される BI セマンティック接続をクリックすると、SharePoint 環境のコンテキスト内で接続が行われます。</span><span class="sxs-lookup"><span data-stu-id="27c95-151">When a SharePoint user clicks on a BI semantic connection that resolves to a PowerPivot workbook in the same farm, the connections occur within the context of the SharePoint environment.</span></span> <span data-ttu-id="27c95-152">PowerPivot サービス アプリケーションは、接続要求を処理し、同じコンピューター上の Analysis Services インスタンスに転送します。</span><span class="sxs-lookup"><span data-stu-id="27c95-152">A PowerPivot service application handles the connection request, which it forwards to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="27c95-153">Analysis Services インスタンスは、ブックから PowerPivot データを抽出して読み込みます。</span><span class="sxs-lookup"><span data-stu-id="27c95-153">The Analysis Services instance extracts the PowerPivot data from the workbook and loads it.</span></span> <span data-ttu-id="27c95-154">その後のすべての接続は、ファーム内の PowerPivot サービス アプリケーションによって管理されます。</span><span class="sxs-lookup"><span data-stu-id="27c95-154">All subsequent connections are managed by PowerPivot service applications in the farm.</span></span>  
  
 <span data-ttu-id="27c95-155">このシナリオでは、すべての接続が同じファーム内で行われるため、Kerberos または制約付き委任は必要とされません。</span><span class="sxs-lookup"><span data-stu-id="27c95-155">In this scenario, all connections occur within the same farm, so there is no requirement for Kerberos or constrained delegation.</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_rel"></a> <span data-ttu-id="27c95-156">関連タスク</span><span class="sxs-lookup"><span data-stu-id="27c95-156">Related Tasks</span></span>  
 [<span data-ttu-id="27c95-157">BI セマンティックモデル接続のコンテンツタイプをライブラリ &#40;PowerPivot for SharePoint に追加&#41;</span><span class="sxs-lookup"><span data-stu-id="27c95-157">Add a BI Semantic Model Connection Content Type to a Library &#40;PowerPivot for SharePoint&#41;</span></span>](add-bi-semantic-model-connection-content-type-to-library.md)  
  
 [<span data-ttu-id="27c95-158">PowerPivot ブックへの BI セマンティック モデル接続の作成</span><span class="sxs-lookup"><span data-stu-id="27c95-158">Create a BI Semantic Model Connection to a PowerPivot Workbook</span></span>](create-a-bi-semantic-model-connection-to-a-power-pivot-workbook.md)  
  
 [<span data-ttu-id="27c95-159">テーブル モデル データベースへの BI セマンティック モデル接続の作成</span><span class="sxs-lookup"><span data-stu-id="27c95-159">Create a BI Semantic Model Connection to a Tabular Model Database</span></span>](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)  
  
 [<span data-ttu-id="27c95-160">Excel または Reporting Services での BI セマンティック モデル接続の使用</span><span class="sxs-lookup"><span data-stu-id="27c95-160">Use a BI Semantic Model Connection in Excel or Reporting Services</span></span>](use-a-bi-semantic-model-connection-in-excel-or-reporting-services.md)  
  
## <a name="see-also"></a><span data-ttu-id="27c95-161">参照</span><span class="sxs-lookup"><span data-stu-id="27c95-161">See Also</span></span>  
 <span data-ttu-id="27c95-162">[Analysis Services インスタンスのサーバーモードの決定](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span><span class="sxs-lookup"><span data-stu-id="27c95-162">[Determine the Server Mode of an Analysis Services Instance](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span></span>  
 [<span data-ttu-id="27c95-163">Analysis Services への接続</span><span class="sxs-lookup"><span data-stu-id="27c95-163">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
  
