---
title: 拡張された日付/時刻型に対する一括コピーの変更 (OLE DB および ODBC) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC, bulk copy operations
- bulk copy [ODBC], changes for date/time improvements
ms.assetid: c29e0f5e-9b3c-42b3-9856-755f4510832f
author: rothja
ms.author: jroth
ms.openlocfilehash: cbb9a03a5ef7a85be279d5b3a210fa24af61622f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87640905"
---
# <a name="bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc"></a><span data-ttu-id="4f403-102">機能強化された日付型と時刻型向けの一括コピーの変更 (OLE DB および ODBC)</span><span class="sxs-lookup"><span data-stu-id="4f403-102">Bulk Copy Changes for Enhanced Date and Time Types (OLE DB and ODBC)</span></span>
  <span data-ttu-id="4f403-103">このトピックでは、一括コピー機能をサポートするための日付と時刻の機能強化について説明します。</span><span class="sxs-lookup"><span data-stu-id="4f403-103">This topic describes the date/time enhancements to support bulk copy functionality.</span></span> <span data-ttu-id="4f403-104">このトピックの情報は、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client の OLE DB と ODBC の両方に当てはまります。</span><span class="sxs-lookup"><span data-stu-id="4f403-104">The information in this topic is valid for both OLE DB and ODBC in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
## <a name="format-files"></a><span data-ttu-id="4f403-105">フォーマット ファイル</span><span class="sxs-lookup"><span data-stu-id="4f403-105">Format Files</span></span>  
 <span data-ttu-id="4f403-106">フォーマット ファイルを対話形式で作成する場合に、日付型と時刻型の指定に使用する入力、および対応するホスト ファイル データ型名を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="4f403-106">When building format files interactively, the following table describes the input used to specify date/time types and the corresponding host-file data type names.</span></span>  
  
|<span data-ttu-id="4f403-107">ファイル ストレージ型</span><span class="sxs-lookup"><span data-stu-id="4f403-107">File storage type</span></span>|<span data-ttu-id="4f403-108">ホスト ファイル データ型</span><span class="sxs-lookup"><span data-stu-id="4f403-108">Host file data type</span></span>|<span data-ttu-id="4f403-109">プロンプトに対する応答: "フィールドのファイルストレージ型を入力 <field_name> [ \<default> ]:"</span><span class="sxs-lookup"><span data-stu-id="4f403-109">Response to the prompt: "Enter the file storage type of field <field_name> [\<default>]:"</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="4f403-110">Datetime</span><span class="sxs-lookup"><span data-stu-id="4f403-110">Datetime</span></span>|<span data-ttu-id="4f403-111">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="4f403-111">SQLDATETIME</span></span>|<span data-ttu-id="4f403-112">d</span><span class="sxs-lookup"><span data-stu-id="4f403-112">d</span></span>|  
|<span data-ttu-id="4f403-113">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="4f403-113">Smalldatetime</span></span>|<span data-ttu-id="4f403-114">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="4f403-114">SQLDATETIM4</span></span>|<span data-ttu-id="4f403-115">D</span><span class="sxs-lookup"><span data-stu-id="4f403-115">D</span></span>|  
|<span data-ttu-id="4f403-116">Date</span><span class="sxs-lookup"><span data-stu-id="4f403-116">Date</span></span>|<span data-ttu-id="4f403-117">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="4f403-117">SQLDATE</span></span>|<span data-ttu-id="4f403-118">de</span><span class="sxs-lookup"><span data-stu-id="4f403-118">de</span></span>|  
|<span data-ttu-id="4f403-119">Time</span><span class="sxs-lookup"><span data-stu-id="4f403-119">Time</span></span>|<span data-ttu-id="4f403-120">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="4f403-120">SQLTIME</span></span>|<span data-ttu-id="4f403-121">te</span><span class="sxs-lookup"><span data-stu-id="4f403-121">te</span></span>|  
|<span data-ttu-id="4f403-122">Datetime2</span><span class="sxs-lookup"><span data-stu-id="4f403-122">Datetime2</span></span>|<span data-ttu-id="4f403-123">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="4f403-123">SQLDATETIME2</span></span>|<span data-ttu-id="4f403-124">d2</span><span class="sxs-lookup"><span data-stu-id="4f403-124">d2</span></span>|  
|<span data-ttu-id="4f403-125">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="4f403-125">Datetimeoffset</span></span>|<span data-ttu-id="4f403-126">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="4f403-126">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="4f403-127">do</span><span class="sxs-lookup"><span data-stu-id="4f403-127">do</span></span>|  
  
 <span data-ttu-id="4f403-128">XML フォーマット ファイルの XSD への追加内容を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4f403-128">The XML format file XSD will have the following additions:</span></span>  
  
```  
<xs:complexType name="SQLDATETIME2">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATETIMEOFFSET">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATE">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLTIME">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
```  
  
## <a name="character-data-files"></a><span data-ttu-id="4f403-129">文字データ ファイル</span><span class="sxs-lookup"><span data-stu-id="4f403-129">Character Data Files</span></span>  
 <span data-ttu-id="4f403-130">文字データファイルでは、日付と時刻の値は、「odbc の日付と時刻の機能強化のための[データ型のサポート](data-type-support-for-odbc-date-and-time-improvements.md)」の「データ形式: 文字列とリテラル」セクションで説明されているように、または OLE DB の[OLE DB の日付と時刻の機能強化に関するデータ型のサポート](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md)について説明しています。</span><span class="sxs-lookup"><span data-stu-id="4f403-130">In character data files, date and time values are represented as described in the "Data Formats: Strings and Literals" section of [Data Type Support for ODBC Date and Time Improvements](data-type-support-for-odbc-date-and-time-improvements.md) for ODBC, or of [Data Type Support for OLE DB Date and Time Improvements](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md) for OLE DB.</span></span>  
  
 <span data-ttu-id="4f403-131">Native data ファイルでは、4つの新しい型の日付と時刻の値は、小数点以下桁数が7の TDS 表現として表現されます (これは、でサポートされている最大値で、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bcp データファイルにはこれらの列の小数点以下桁数が格納されていないため)。</span><span class="sxs-lookup"><span data-stu-id="4f403-131">In native data fles, date and time values for the four new types are represented as their TDS representations with a scale of 7 (because this is the maximum supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and bcp data files do not store the scale of these columns).</span></span> <span data-ttu-id="4f403-132">既存の `datetime` `smalldatetime` 型、型、または表形式のデータストリーム (TDS) 表現のストレージに変更はありません。</span><span class="sxs-lookup"><span data-stu-id="4f403-132">There is no change to the storage of the existing `datetime` and `smalldatetime` type or their tabular data stream (TDS) representations.</span></span>  
  
 <span data-ttu-id="4f403-133">OLE DB の場合、さまざまなストレージ型のストレージ サイズは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="4f403-133">The storage sizes for the different storage types are as follows for OLE DB:</span></span>  
  
|<span data-ttu-id="4f403-134">ファイル ストレージ型</span><span class="sxs-lookup"><span data-stu-id="4f403-134">File storage type</span></span>|<span data-ttu-id="4f403-135">ストレージ サイズ (バイト単位)</span><span class="sxs-lookup"><span data-stu-id="4f403-135">Storage size in bytes</span></span>|  
|-----------------------|---------------------------|  
|<span data-ttu-id="4f403-136">DATETIME</span><span class="sxs-lookup"><span data-stu-id="4f403-136">datetime</span></span>|<span data-ttu-id="4f403-137">8</span><span class="sxs-lookup"><span data-stu-id="4f403-137">8</span></span>|  
|<span data-ttu-id="4f403-138">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="4f403-138">smalldatetime</span></span>|<span data-ttu-id="4f403-139">4</span><span class="sxs-lookup"><span data-stu-id="4f403-139">4</span></span>|  
|<span data-ttu-id="4f403-140">date</span><span class="sxs-lookup"><span data-stu-id="4f403-140">date</span></span>|<span data-ttu-id="4f403-141">3</span><span class="sxs-lookup"><span data-stu-id="4f403-141">3</span></span>|  
|<span data-ttu-id="4f403-142">time</span><span class="sxs-lookup"><span data-stu-id="4f403-142">time</span></span>|<span data-ttu-id="4f403-143">6</span><span class="sxs-lookup"><span data-stu-id="4f403-143">6</span></span>|  
|<span data-ttu-id="4f403-144">datetime2</span><span class="sxs-lookup"><span data-stu-id="4f403-144">datetime2</span></span>|<span data-ttu-id="4f403-145">9</span><span class="sxs-lookup"><span data-stu-id="4f403-145">9</span></span>|  
|<span data-ttu-id="4f403-146">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="4f403-146">datetimeoffset</span></span>|<span data-ttu-id="4f403-147">11</span><span class="sxs-lookup"><span data-stu-id="4f403-147">11</span></span>|  
  
 <span data-ttu-id="4f403-148">ODBC の場合、サイズは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="4f403-148">The sizes are as follows for ODBC.</span></span> <span data-ttu-id="4f403-149">BCP.exe を実行すると有効桁数は常にサーバーから取得されるので、フォーマット ファイルにもデータ ファイルにも、有効桁数を格納する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="4f403-149">Note that it is not necessary to store precision in either format or data files, because BCP.exe will always retrieve precision from the server.</span></span>  
  
|<span data-ttu-id="4f403-150">ファイル ストレージ型</span><span class="sxs-lookup"><span data-stu-id="4f403-150">File storage type</span></span>|<span data-ttu-id="4f403-151">ストレージ サイズ (バイト単位)</span><span class="sxs-lookup"><span data-stu-id="4f403-151">Storage size in bytes</span></span>|<span data-ttu-id="4f403-152">ストレージ形式</span><span class="sxs-lookup"><span data-stu-id="4f403-152">Storage format</span></span>|  
|-----------------------|---------------------------|--------------------|  
|<span data-ttu-id="4f403-153">datetime (d)</span><span class="sxs-lookup"><span data-stu-id="4f403-153">datetime (d)</span></span>|<span data-ttu-id="4f403-154">8</span><span class="sxs-lookup"><span data-stu-id="4f403-154">8</span></span>|<span data-ttu-id="4f403-155">TDS (TDS)</span><span class="sxs-lookup"><span data-stu-id="4f403-155">TDS</span></span>|  
|<span data-ttu-id="4f403-156">smalldatetime (D)</span><span class="sxs-lookup"><span data-stu-id="4f403-156">smalldatetime (D)</span></span>|<span data-ttu-id="4f403-157">4</span><span class="sxs-lookup"><span data-stu-id="4f403-157">4</span></span>|<span data-ttu-id="4f403-158">TDS (TDS)</span><span class="sxs-lookup"><span data-stu-id="4f403-158">TDS</span></span>|  
|<span data-ttu-id="4f403-159">date (de)</span><span class="sxs-lookup"><span data-stu-id="4f403-159">date (de)</span></span>|<span data-ttu-id="4f403-160">3</span><span class="sxs-lookup"><span data-stu-id="4f403-160">3</span></span>|<span data-ttu-id="4f403-161">TDS (TDS)</span><span class="sxs-lookup"><span data-stu-id="4f403-161">TDS</span></span>|  
|<span data-ttu-id="4f403-162">time (te)</span><span class="sxs-lookup"><span data-stu-id="4f403-162">time (te)</span></span>|<span data-ttu-id="4f403-163">6</span><span class="sxs-lookup"><span data-stu-id="4f403-163">6</span></span>|<span data-ttu-id="4f403-164">TDS (TDS)</span><span class="sxs-lookup"><span data-stu-id="4f403-164">TDS</span></span>|  
|<span data-ttu-id="4f403-165">datetime2 (d2)</span><span class="sxs-lookup"><span data-stu-id="4f403-165">datetime2 (d2)</span></span>|<span data-ttu-id="4f403-166">9</span><span class="sxs-lookup"><span data-stu-id="4f403-166">9</span></span>|<span data-ttu-id="4f403-167">TDS (TDS)</span><span class="sxs-lookup"><span data-stu-id="4f403-167">TDS</span></span>|  
|<span data-ttu-id="4f403-168">datetimeoffset (do)</span><span class="sxs-lookup"><span data-stu-id="4f403-168">datetimeoffset (do)</span></span>|<span data-ttu-id="4f403-169">11</span><span class="sxs-lookup"><span data-stu-id="4f403-169">11</span></span>|<span data-ttu-id="4f403-170">TDS (TDS)</span><span class="sxs-lookup"><span data-stu-id="4f403-170">TDS</span></span>|  
  
## <a name="bcp-types-in-sqlnclih"></a><span data-ttu-id="4f403-171">sqlncli.h 内の BCP 型</span><span class="sxs-lookup"><span data-stu-id="4f403-171">BCP Types in sqlncli.h</span></span>  
 <span data-ttu-id="4f403-172">sqlncli.h では、ODBC の BCP API 拡張機能で使用する次の型が定義されています。</span><span class="sxs-lookup"><span data-stu-id="4f403-172">The following types are defined in sqlncli.h to be used with the BCP API extensions to ODBC.</span></span> <span data-ttu-id="4f403-173">これらの型は OLE DB で IBCPSession::BCPColFmt の *eUserDataType* パラメーターと共に渡されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-173">These types are passed with the *eUserDataType* parameter of IBCPSession::BCPColFmt in OLE DB.</span></span>  
  
|<span data-ttu-id="4f403-174">ファイル ストレージ型</span><span class="sxs-lookup"><span data-stu-id="4f403-174">File storage type</span></span>|<span data-ttu-id="4f403-175">ホスト ファイル データ型</span><span class="sxs-lookup"><span data-stu-id="4f403-175">Host file data type</span></span>|<span data-ttu-id="4f403-176">IBCPSession:: BCPColFmt と共に使用するには、sqlncli に「」と入力します。</span><span class="sxs-lookup"><span data-stu-id="4f403-176">Type in sqlncli.h for use with IBCPSession::BCPColFmt</span></span>|<span data-ttu-id="4f403-177">値</span><span class="sxs-lookup"><span data-stu-id="4f403-177">Value</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------|-----------|  
|<span data-ttu-id="4f403-178">Datetime</span><span class="sxs-lookup"><span data-stu-id="4f403-178">Datetime</span></span>|<span data-ttu-id="4f403-179">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="4f403-179">SQLDATETIME</span></span>|<span data-ttu-id="4f403-180">BCP_TYPE_SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="4f403-180">BCP_TYPE_SQLDATETIME</span></span>|<span data-ttu-id="4f403-181">0x3d</span><span class="sxs-lookup"><span data-stu-id="4f403-181">0x3d</span></span>|  
|<span data-ttu-id="4f403-182">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="4f403-182">Smalldatetime</span></span>|<span data-ttu-id="4f403-183">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="4f403-183">SQLDATETIM4</span></span>|<span data-ttu-id="4f403-184">BCP_TYPE_SQLDATETIME4</span><span class="sxs-lookup"><span data-stu-id="4f403-184">BCP_TYPE_SQLDATETIME4</span></span>|<span data-ttu-id="4f403-185">0x3a</span><span class="sxs-lookup"><span data-stu-id="4f403-185">0x3a</span></span>|  
|<span data-ttu-id="4f403-186">Date</span><span class="sxs-lookup"><span data-stu-id="4f403-186">Date</span></span>|<span data-ttu-id="4f403-187">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="4f403-187">SQLDATE</span></span>|<span data-ttu-id="4f403-188">BCP_TYPE_SQLDATE</span><span class="sxs-lookup"><span data-stu-id="4f403-188">BCP_TYPE_SQLDATE</span></span>|<span data-ttu-id="4f403-189">0x28</span><span class="sxs-lookup"><span data-stu-id="4f403-189">0x28</span></span>|  
|<span data-ttu-id="4f403-190">Time</span><span class="sxs-lookup"><span data-stu-id="4f403-190">Time</span></span>|<span data-ttu-id="4f403-191">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="4f403-191">SQLTIME</span></span>|<span data-ttu-id="4f403-192">BCP_TYPE_SQLTIME</span><span class="sxs-lookup"><span data-stu-id="4f403-192">BCP_TYPE_SQLTIME</span></span>|<span data-ttu-id="4f403-193">0x29</span><span class="sxs-lookup"><span data-stu-id="4f403-193">0x29</span></span>|  
|<span data-ttu-id="4f403-194">Datetime2</span><span class="sxs-lookup"><span data-stu-id="4f403-194">Datetime2</span></span>|<span data-ttu-id="4f403-195">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="4f403-195">SQLDATETIME2</span></span>|<span data-ttu-id="4f403-196">BCP_TYPE_SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="4f403-196">BCP_TYPE_SQLDATETIME2</span></span>|<span data-ttu-id="4f403-197">0x2a</span><span class="sxs-lookup"><span data-stu-id="4f403-197">0x2a</span></span>|  
|<span data-ttu-id="4f403-198">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="4f403-198">Datetimeoffset</span></span>|<span data-ttu-id="4f403-199">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="4f403-199">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="4f403-200">BCP_TYPE_SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="4f403-200">BCP_TYPE_SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="4f403-201">0x2b</span><span class="sxs-lookup"><span data-stu-id="4f403-201">0x2b</span></span>|  
  
## <a name="bcp-data-type-conversions"></a><span data-ttu-id="4f403-202">BCP データ型変換</span><span class="sxs-lookup"><span data-stu-id="4f403-202">BCP Data Type Conversions</span></span>  
 <span data-ttu-id="4f403-203">次の表に、変換情報を示します。</span><span class="sxs-lookup"><span data-stu-id="4f403-203">The following tables provide conversion information.</span></span>  
  
 <span data-ttu-id="4f403-204">**OLE DB に関するメモ** 次の変換は、IBCPSession によって実行されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-204">**OLE DB Note** The following conversions are performed by IBCPSession.</span></span> <span data-ttu-id="4f403-205">IRowsetFastLoad では、「[クライアントからサーバーへの変換](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md)」に定義されているとおり、OLE DB 変換が使用されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-205">IRowsetFastLoad uses OLE DB conversions as defined in [Conversions Performed from Client to Server](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md).</span></span> <span data-ttu-id="4f403-206">次に示すクライアントでの変換が実行されると、datetime 値は 1/300 秒単位に丸められ、smalldatetime 値の秒は 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-206">Note that datetime values are rounded to 1/300th of a second and smalldatetime values have seconds set to zero after client conversions described below have been performed.</span></span> <span data-ttu-id="4f403-207">datetime の丸め処理は、時間と分に適用されますが、日付には適用されません。</span><span class="sxs-lookup"><span data-stu-id="4f403-207">Datetime rounding propagates through hours and minutes, but not the date.</span></span>  
  
|<span data-ttu-id="4f403-208">To --></span><span class="sxs-lookup"><span data-stu-id="4f403-208">To --></span></span><br /><br /> <span data-ttu-id="4f403-209">ソース</span><span class="sxs-lookup"><span data-stu-id="4f403-209">From</span></span>|<span data-ttu-id="4f403-210">date</span><span class="sxs-lookup"><span data-stu-id="4f403-210">date</span></span>|<span data-ttu-id="4f403-211">time</span><span class="sxs-lookup"><span data-stu-id="4f403-211">time</span></span>|<span data-ttu-id="4f403-212">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="4f403-212">smalldatetime</span></span>|<span data-ttu-id="4f403-213">DATETIME</span><span class="sxs-lookup"><span data-stu-id="4f403-213">datetime</span></span>|<span data-ttu-id="4f403-214">datetime2</span><span class="sxs-lookup"><span data-stu-id="4f403-214">datetime2</span></span>|<span data-ttu-id="4f403-215">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="4f403-215">datetimeoffset</span></span>|<span data-ttu-id="4f403-216">char</span><span class="sxs-lookup"><span data-stu-id="4f403-216">char</span></span>|<span data-ttu-id="4f403-217">wchar</span><span class="sxs-lookup"><span data-stu-id="4f403-217">wchar</span></span>|  
|------------------------|----------|----------|-------------------|--------------|---------------|--------------------|----------|-----------|  
|<span data-ttu-id="4f403-218">Date</span><span class="sxs-lookup"><span data-stu-id="4f403-218">Date</span></span>|<span data-ttu-id="4f403-219">1</span><span class="sxs-lookup"><span data-stu-id="4f403-219">1</span></span>|-|<span data-ttu-id="4f403-220">1、6</span><span class="sxs-lookup"><span data-stu-id="4f403-220">1,6</span></span>|<span data-ttu-id="4f403-221">1、6</span><span class="sxs-lookup"><span data-stu-id="4f403-221">1,6</span></span>|<span data-ttu-id="4f403-222">1、6</span><span class="sxs-lookup"><span data-stu-id="4f403-222">1,6</span></span>|<span data-ttu-id="4f403-223">1、5、6</span><span class="sxs-lookup"><span data-stu-id="4f403-223">1,5,6</span></span>|<span data-ttu-id="4f403-224">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-224">1,3</span></span>|<span data-ttu-id="4f403-225">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-225">1,3</span></span>|  
|<span data-ttu-id="4f403-226">Time</span><span class="sxs-lookup"><span data-stu-id="4f403-226">Time</span></span>|<span data-ttu-id="4f403-227">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-227">N/A</span></span>|<span data-ttu-id="4f403-228">1、10</span><span class="sxs-lookup"><span data-stu-id="4f403-228">1,10</span></span>|<span data-ttu-id="4f403-229">1、7、10</span><span class="sxs-lookup"><span data-stu-id="4f403-229">1,7,10</span></span>|<span data-ttu-id="4f403-230">1、7、10</span><span class="sxs-lookup"><span data-stu-id="4f403-230">1,7,10</span></span>|<span data-ttu-id="4f403-231">1、7、10</span><span class="sxs-lookup"><span data-stu-id="4f403-231">1,7,10</span></span>|<span data-ttu-id="4f403-232">1、5、7、10</span><span class="sxs-lookup"><span data-stu-id="4f403-232">1,5,7,10</span></span>|<span data-ttu-id="4f403-233">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-233">1,3</span></span>|<span data-ttu-id="4f403-234">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-234">1,3</span></span>|  
|<span data-ttu-id="4f403-235">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="4f403-235">Smalldatetime</span></span>|<span data-ttu-id="4f403-236">1、2</span><span class="sxs-lookup"><span data-stu-id="4f403-236">1,2</span></span>|<span data-ttu-id="4f403-237">1、4、10</span><span class="sxs-lookup"><span data-stu-id="4f403-237">1,4,10</span></span>|<span data-ttu-id="4f403-238">1</span><span class="sxs-lookup"><span data-stu-id="4f403-238">1</span></span>|<span data-ttu-id="4f403-239">1</span><span class="sxs-lookup"><span data-stu-id="4f403-239">1</span></span>|<span data-ttu-id="4f403-240">1、10</span><span class="sxs-lookup"><span data-stu-id="4f403-240">1,10</span></span>|<span data-ttu-id="4f403-241">1、5、10</span><span class="sxs-lookup"><span data-stu-id="4f403-241">1,5,10</span></span>|<span data-ttu-id="4f403-242">1、11</span><span class="sxs-lookup"><span data-stu-id="4f403-242">1,11</span></span>|<span data-ttu-id="4f403-243">1、11</span><span class="sxs-lookup"><span data-stu-id="4f403-243">1,11</span></span>|  
|<span data-ttu-id="4f403-244">Datetime</span><span class="sxs-lookup"><span data-stu-id="4f403-244">Datetime</span></span>|<span data-ttu-id="4f403-245">1、2</span><span class="sxs-lookup"><span data-stu-id="4f403-245">1,2</span></span>|<span data-ttu-id="4f403-246">1、4、10</span><span class="sxs-lookup"><span data-stu-id="4f403-246">1,4,10</span></span>|<span data-ttu-id="4f403-247">1、12</span><span class="sxs-lookup"><span data-stu-id="4f403-247">1,12</span></span>|<span data-ttu-id="4f403-248">1</span><span class="sxs-lookup"><span data-stu-id="4f403-248">1</span></span>|<span data-ttu-id="4f403-249">1、10</span><span class="sxs-lookup"><span data-stu-id="4f403-249">1,10</span></span>|<span data-ttu-id="4f403-250">1、5、10</span><span class="sxs-lookup"><span data-stu-id="4f403-250">1,5,10</span></span>|<span data-ttu-id="4f403-251">1、11</span><span class="sxs-lookup"><span data-stu-id="4f403-251">1,11</span></span>|<span data-ttu-id="4f403-252">1、11</span><span class="sxs-lookup"><span data-stu-id="4f403-252">1,11</span></span>|  
|<span data-ttu-id="4f403-253">Datetime2</span><span class="sxs-lookup"><span data-stu-id="4f403-253">Datetime2</span></span>|<span data-ttu-id="4f403-254">1、2</span><span class="sxs-lookup"><span data-stu-id="4f403-254">1,2</span></span>|<span data-ttu-id="4f403-255">1、4、10</span><span class="sxs-lookup"><span data-stu-id="4f403-255">1,4,10</span></span>|<span data-ttu-id="4f403-256">1、10 (ODBC) 1、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-256">1,10 (ODBC)1,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-257">1、10</span><span class="sxs-lookup"><span data-stu-id="4f403-257">1,10</span></span>|<span data-ttu-id="4f403-258">1、10</span><span class="sxs-lookup"><span data-stu-id="4f403-258">1,10</span></span>|<span data-ttu-id="4f403-259">1、5、10</span><span class="sxs-lookup"><span data-stu-id="4f403-259">1,5,10</span></span>|<span data-ttu-id="4f403-260">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-260">1,3</span></span>|<span data-ttu-id="4f403-261">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-261">1,3</span></span>|  
|<span data-ttu-id="4f403-262">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="4f403-262">Datetimeoffset</span></span>|<span data-ttu-id="4f403-263">1、2、8</span><span class="sxs-lookup"><span data-stu-id="4f403-263">1,2,8</span></span>|<span data-ttu-id="4f403-264">1、4、8、10</span><span class="sxs-lookup"><span data-stu-id="4f403-264">1,4,8,10</span></span>|<span data-ttu-id="4f403-265">1、8、10</span><span class="sxs-lookup"><span data-stu-id="4f403-265">1,8,10</span></span>|<span data-ttu-id="4f403-266">1、8、10</span><span class="sxs-lookup"><span data-stu-id="4f403-266">1,8,10</span></span>|<span data-ttu-id="4f403-267">1、8、10</span><span class="sxs-lookup"><span data-stu-id="4f403-267">1,8,10</span></span>|<span data-ttu-id="4f403-268">1、10</span><span class="sxs-lookup"><span data-stu-id="4f403-268">1,10</span></span>|<span data-ttu-id="4f403-269">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-269">1,3</span></span>|<span data-ttu-id="4f403-270">1、3</span><span class="sxs-lookup"><span data-stu-id="4f403-270">1,3</span></span>|  
|<span data-ttu-id="4f403-271">Char/wchar (date)</span><span class="sxs-lookup"><span data-stu-id="4f403-271">Char/wchar (date)</span></span>|<span data-ttu-id="4f403-272">9</span><span class="sxs-lookup"><span data-stu-id="4f403-272">9</span></span>|-|<span data-ttu-id="4f403-273">9、6 (ODBC) 9、6、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-273">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-274">9、6 (ODBC) 9、6、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-274">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-275">9、6</span><span class="sxs-lookup"><span data-stu-id="4f403-275">9,6</span></span>|<span data-ttu-id="4f403-276">9、5、6</span><span class="sxs-lookup"><span data-stu-id="4f403-276">9,5,6</span></span>|<span data-ttu-id="4f403-277">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-277">N/A</span></span>|<span data-ttu-id="4f403-278">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-278">N/A</span></span>|  
|<span data-ttu-id="4f403-279">Char/wchar (time)</span><span class="sxs-lookup"><span data-stu-id="4f403-279">Char/wchar (time)</span></span>|-|<span data-ttu-id="4f403-280">9、10</span><span class="sxs-lookup"><span data-stu-id="4f403-280">9,10</span></span>|<span data-ttu-id="4f403-281">9、7、10 (ODBC) 9、7、10、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-281">9,7,10 (ODBC)9,7,10,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-282">9、7、10 (ODBC) 9、7、10、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-282">9,7,10 (ODBC)9,7,10, 12 (OLE DB)</span></span>|<span data-ttu-id="4f403-283">9、7、10</span><span class="sxs-lookup"><span data-stu-id="4f403-283">9,7,10</span></span>|<span data-ttu-id="4f403-284">9、5、7、10</span><span class="sxs-lookup"><span data-stu-id="4f403-284">9,5,7,10</span></span>|<span data-ttu-id="4f403-285">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-285">N/A</span></span>|<span data-ttu-id="4f403-286">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-286">N/A</span></span>|  
|<span data-ttu-id="4f403-287">Char/wchar (datetime)</span><span class="sxs-lookup"><span data-stu-id="4f403-287">Char/wchar (datetime)</span></span>|<span data-ttu-id="4f403-288">9、2</span><span class="sxs-lookup"><span data-stu-id="4f403-288">9,2</span></span>|<span data-ttu-id="4f403-289">9、4、10</span><span class="sxs-lookup"><span data-stu-id="4f403-289">9,4,10</span></span>|<span data-ttu-id="4f403-290">9、10 (ODBC) 9、10、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-290">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-291">9、10 (ODBC) 9、10、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-291">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-292">9、10</span><span class="sxs-lookup"><span data-stu-id="4f403-292">9,10</span></span>|<span data-ttu-id="4f403-293">9、5、10</span><span class="sxs-lookup"><span data-stu-id="4f403-293">9,5,10</span></span>|<span data-ttu-id="4f403-294">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-294">N/A</span></span>|<span data-ttu-id="4f403-295">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-295">N/A</span></span>|  
|<span data-ttu-id="4f403-296">Char/wchar (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="4f403-296">Char/wchar (datetimeoffset)</span></span>|<span data-ttu-id="4f403-297">9、2、8</span><span class="sxs-lookup"><span data-stu-id="4f403-297">9,2,8</span></span>|<span data-ttu-id="4f403-298">9、4、8、10</span><span class="sxs-lookup"><span data-stu-id="4f403-298">9,4,8,10</span></span>|<span data-ttu-id="4f403-299">9、8、10 (ODBC) 9、8、10、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-299">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-300">9、8、10 (ODBC) 9、8、10、12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="4f403-300">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="4f403-301">9、8、10</span><span class="sxs-lookup"><span data-stu-id="4f403-301">9,8,10</span></span>|<span data-ttu-id="4f403-302">9、10</span><span class="sxs-lookup"><span data-stu-id="4f403-302">9,10</span></span>|<span data-ttu-id="4f403-303">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-303">N/A</span></span>|<span data-ttu-id="4f403-304">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-304">N/A</span></span>|  
  
#### <a name="key-to-symbols"></a><span data-ttu-id="4f403-305">記号の説明</span><span class="sxs-lookup"><span data-stu-id="4f403-305">Key to Symbols</span></span>  
  
|<span data-ttu-id="4f403-306">Symbol</span><span class="sxs-lookup"><span data-stu-id="4f403-306">Symbol</span></span>|<span data-ttu-id="4f403-307">意味</span><span class="sxs-lookup"><span data-stu-id="4f403-307">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="4f403-308">変換はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="4f403-308">No conversion is supported.</span></span><br /><br /> <span data-ttu-id="4f403-309">"データ型の属性に関する制限に違反しました" というメッセージで SQLSTATE 07006 の ODBC 診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-309">An ODBC diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="4f403-310">1</span><span class="sxs-lookup"><span data-stu-id="4f403-310">1</span></span>|<span data-ttu-id="4f403-311">指定したデータが無効な場合、"datetime 形式が無効です" というメッセージで SQLSTATE 22007 の ODBC 診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-311">If the data supplied is not valid, an ODBC  diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span> <span data-ttu-id="4f403-312">datetimeoffset 値の場合は、UTC への変換が必要なくても、時刻部分は UTC への変換後の範囲内に収まっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="4f403-312">For datetimeoffset values, the time portion must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="4f403-313">TDS とサーバーは datetimeoffset 値の時刻を常に UTC 用に正規化するためです。</span><span class="sxs-lookup"><span data-stu-id="4f403-313">This is because TDS and the server always normalize the time in datetimeoffset values for UTC.</span></span> <span data-ttu-id="4f403-314">したがって、クライアントは、時刻部分が、UTC への変換後にサポートされる範囲内に収まっていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4f403-314">So the client must check that time components are within the range supported after conversion to UTC.</span></span>|  
|<span data-ttu-id="4f403-315">2</span><span class="sxs-lookup"><span data-stu-id="4f403-315">2</span></span>|<span data-ttu-id="4f403-316">時刻部分は無視されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-316">The time component is ignored.</span></span>|  
|<span data-ttu-id="4f403-317">3</span><span class="sxs-lookup"><span data-stu-id="4f403-317">3</span></span>|<span data-ttu-id="4f403-318">ODBC の場合、データ損失を伴う切り捨てが発生すると、"文字列データの右側が切り捨てられました" というメッセージで SQLSTATE 22001 の診断レコードが生成されます。秒の小数部の桁数 (小数点以下桁数) は、次の表に従って変換先の列のサイズによって決まります。</span><span class="sxs-lookup"><span data-stu-id="4f403-318">For ODBC, If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and message 'String data, right truncated' The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="4f403-319">テーブルの範囲よりサイズが大きい列の場合、7 桁と見なされます。</span><span class="sxs-lookup"><span data-stu-id="4f403-319">For column sizes larger than the range in the table, a scale of 7 is implied.</span></span> <span data-ttu-id="4f403-320">この変換では、最大9桁の小数点以下桁数 (ODBC で許容される最大値) を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4f403-320">This conversion should allow for up to nine fractional second digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="4f403-321">**種類:** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="4f403-321">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="4f403-322">**暗黙の小数点以下桁数 0** 8</span><span class="sxs-lookup"><span data-stu-id="4f403-322">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="4f403-323">**暗黙の位取り 1.. 7** 10、16</span><span class="sxs-lookup"><span data-stu-id="4f403-323">**Implied scale 1..7** 10,16</span></span><br /><br /> <br /><br /> <span data-ttu-id="4f403-324">**種類:** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="4f403-324">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="4f403-325">**暗黙の小数点以下桁数 0:** 19</span><span class="sxs-lookup"><span data-stu-id="4f403-325">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="4f403-326">**暗黙の小数点以下桁数 1.. 7:** 21.. 27</span><span class="sxs-lookup"><span data-stu-id="4f403-326">**Implied scale 1..7:** 21..27</span></span><br /><br /> <br /><br /> <span data-ttu-id="4f403-327">**型:** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="4f403-327">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="4f403-328">**暗黙の小数点以下桁数 0:** 26</span><span class="sxs-lookup"><span data-stu-id="4f403-328">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="4f403-329">**暗黙の小数点以下桁数 1.. 7:** 28.. 34</span><span class="sxs-lookup"><span data-stu-id="4f403-329">**Implied scale 1..7:** 28..34</span></span><br /><br /> <span data-ttu-id="4f403-330">OLE DB の場合は、データの損失を伴う切り捨てが行われると、エラーが通知されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-330">For OLE DB, if truncation with data loss occurs, an error is posted.</span></span> <span data-ttu-id="4f403-331">datetime2 に関しては、次の表に示すように、秒の小数点以下桁数 (スケール) は変換先の列のサイズによって決まります。</span><span class="sxs-lookup"><span data-stu-id="4f403-331">For datetime2, the number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="4f403-332">テーブルの範囲よりサイズが大きい列の場合は、9 桁と見なされます。</span><span class="sxs-lookup"><span data-stu-id="4f403-332">For column sizes larger than the range in the table a scale of 9 is implied.</span></span> <span data-ttu-id="4f403-333">この変換では、秒の小数点以下桁数が 9 桁まで許容されます。これは、OLE DB で許容される最大桁数です。</span><span class="sxs-lookup"><span data-stu-id="4f403-333">This conversion should allow for up to nine fractional second digits, the maximum allowed by OLE DB.</span></span><br /><br /> <span data-ttu-id="4f403-334">**種類:** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="4f403-334">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="4f403-335">**暗黙の小数点以下桁数 0** 8</span><span class="sxs-lookup"><span data-stu-id="4f403-335">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="4f403-336">**暗黙の小数点以下桁数 1..9** 1..9</span><span class="sxs-lookup"><span data-stu-id="4f403-336">**Implied scale 1..9** 1..9</span></span><br /><br /> <br /><br /> <span data-ttu-id="4f403-337">**種類:** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="4f403-337">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="4f403-338">**暗黙の小数点以下桁数 0:** 19</span><span class="sxs-lookup"><span data-stu-id="4f403-338">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="4f403-339">**暗黙の小数点以下桁数 1..9:** 21..29</span><span class="sxs-lookup"><span data-stu-id="4f403-339">**Implied scale 1..9:** 21..29</span></span><br /><br /> <br /><br /> <span data-ttu-id="4f403-340">**型:** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="4f403-340">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="4f403-341">**暗黙の小数点以下桁数 0:** 26</span><span class="sxs-lookup"><span data-stu-id="4f403-341">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="4f403-342">**暗黙の小数点以下桁数 1..9:** 28..36</span><span class="sxs-lookup"><span data-stu-id="4f403-342">**Implied scale 1..9:** 28..36</span></span>|  
|<span data-ttu-id="4f403-343">4</span><span class="sxs-lookup"><span data-stu-id="4f403-343">4</span></span>|<span data-ttu-id="4f403-344">日付部分は無視されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-344">The date component is ignored.</span></span>|  
|<span data-ttu-id="4f403-345">5</span><span class="sxs-lookup"><span data-stu-id="4f403-345">5</span></span>|<span data-ttu-id="4f403-346">タイム ゾーンは UTC (00:00 など) に設定されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-346">The timezone is set to UTC (for example, 00:00).</span></span>|  
|<span data-ttu-id="4f403-347">6</span><span class="sxs-lookup"><span data-stu-id="4f403-347">6</span></span>|<span data-ttu-id="4f403-348">時刻は 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-348">The time is set to zero.</span></span>|  
|<span data-ttu-id="4f403-349">7</span><span class="sxs-lookup"><span data-stu-id="4f403-349">7</span></span>|<span data-ttu-id="4f403-350">日付は 1900-01-01 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-350">The date is set to 1900-01-01.</span></span>|  
|<span data-ttu-id="4f403-351">8</span><span class="sxs-lookup"><span data-stu-id="4f403-351">8</span></span>|<span data-ttu-id="4f403-352">タイム ゾーン オフセットは無視されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-352">The timezone offset is ignored.</span></span>|  
|<span data-ttu-id="4f403-353">9</span><span class="sxs-lookup"><span data-stu-id="4f403-353">9</span></span>|<span data-ttu-id="4f403-354">文字列は解析され、最初に検出された句読点、および残りの部分があるかどうかに応じて、date 値、datetime 値、datetimeoffset 値、time 値のいずれかに変換されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-354">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and presence of remaining components.</span></span> <span data-ttu-id="4f403-355">次に、このトピックの最後にある表に示した規則のうち、この処理で検出された変換元の型についての規則に従って、文字列は変換先の型に変換されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-355">The string is then converted to the target type, following the rules in the table at the end of this topic for the source type discovered by this process.</span></span> <span data-ttu-id="4f403-356">指定したデータを解析するとエラーが発生する場合、データを構成するいずれかの部分が許容範囲の外にある場合、または、リテラル型から変換先の型への変換が存在しない場合は、エラーが通知される (OLE DB) か、"キャストした文字コードが正しくありません" というメッセージで SQLSTATE 22018 の ODBC 診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-356">If the data supplied cannot be parsed without error, or if any component part is outside the range allowed, or if there is no conversion from the literal type to target type, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="4f403-357">datetime 型および smalldatetime 型のパラメーターでは、年がこれらの型でサポートされる範囲外の場合、エラーが通知される (OLE DB) か、"datetime 形式が無効です" というメッセージで SQLSTATE 22007 の ODBC 診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-357">For datetime and smalldatetime parameters, if the year is outside the range these types support, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="4f403-358">datetimeoffset では、UTC への変換が必要なくても、値は UTC への変換後の範囲内に収まっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="4f403-358">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="4f403-359">TDS とサーバーは datetimeoffset 値の時刻を常に UTC 用に正規化するので、クライアントは、時刻部分が、UTC への変換後にサポートされる範囲内に収まっていることを確認する必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="4f403-359">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="4f403-360">値が、サポートされている UTC の範囲内にない場合、エラーが通知される (OLE DB) か、"datetime 形式が無効です" というメッセージで SQLSTATE 22007 の ODBC 診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-360">If the value is not within the supported UTC range, an error is posted (OLE DB), or an ODBC diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="4f403-361">10</span><span class="sxs-lookup"><span data-stu-id="4f403-361">10</span></span>|<span data-ttu-id="4f403-362">クライアントからサーバーへの変換で、データの損失を伴う切り捨てが行われると、エラーが通知される (OLE DB) か、"Datetime フィールド オーバーフロー" というメッセージで SQLSTATE 22008 の ODBC 診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-362">If truncation with data loss occurs on a client to server conversion, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="4f403-363">サーバーが使用する UTC の範囲で表すことができる範囲の外に値がある場合にも、このエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="4f403-363">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span> <span data-ttu-id="4f403-364">サーバーからクライアントへの変換で、秒または秒の小数部の切り捨てが行われた場合は、警告のみが発生します。</span><span class="sxs-lookup"><span data-stu-id="4f403-364">If seconds or fractional seconds truncation occurs in a server to client conversion, there is only a warning.</span></span>|  
|<span data-ttu-id="4f403-365">11</span><span class="sxs-lookup"><span data-stu-id="4f403-365">11</span></span>|<span data-ttu-id="4f403-366">データの損失を伴う切り捨てが行われると、診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-366">If truncation with data loss occurs, a diagnostic record is generated.</span></span><br /><br /> <span data-ttu-id="4f403-367">サーバーからクライアントへの変換では、これは警告 (ODBC SQLSTATE S1000) です。</span><span class="sxs-lookup"><span data-stu-id="4f403-367">On a server-to-client conversion, this is a warning (ODBC SQLSTATE S1000).</span></span><br /><br /> <span data-ttu-id="4f403-368">クライアントからサーバーへの変換では、これはエラー (ODBC SQLSTATE 22001) です。</span><span class="sxs-lookup"><span data-stu-id="4f403-368">On a client-to-server conversion, this is an error (ODBC SQLSTATE 22001).</span></span>|  
|<span data-ttu-id="4f403-369">12</span><span class="sxs-lookup"><span data-stu-id="4f403-369">12</span></span>|<span data-ttu-id="4f403-370">秒は 0 に設定され、秒の小数部は破棄されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-370">Seconds are set to zero and fractional seconds are discarded.</span></span> <span data-ttu-id="4f403-371">切り捨てエラーは発生しません。</span><span class="sxs-lookup"><span data-stu-id="4f403-371">No truncation error is possible.</span></span>|  
|<span data-ttu-id="4f403-372">該当なし</span><span class="sxs-lookup"><span data-stu-id="4f403-372">N/A</span></span>|<span data-ttu-id="4f403-373">既存の [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以前のバージョンの動作が維持されます。</span><span class="sxs-lookup"><span data-stu-id="4f403-373">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4f403-374">参照</span><span class="sxs-lookup"><span data-stu-id="4f403-374">See Also</span></span>  
 <span data-ttu-id="4f403-375">[ODBC&#41;&#40;の日付と時刻の改善](date-and-time-improvements-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="4f403-375">[Date and Time Improvements &#40;ODBC&#41;](date-and-time-improvements-odbc.md) </span></span>  
 [<span data-ttu-id="4f403-376">日付と時刻の強化機能 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="4f403-376">Date and Time Improvements &#40;OLE DB&#41;</span></span>](../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)  
  
  
