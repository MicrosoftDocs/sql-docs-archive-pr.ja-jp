---
title: C から SQL への変換 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], C to SQL
ms.assetid: 7ac098db-9147-4883-8da9-a58ab24a0d31
author: rothja
ms.author: jroth
ms.openlocfilehash: 2ec8856b9c516ff3693da2ebf1077289d414e589
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643296"
---
# <a name="conversions-from-c-to-sql"></a><span data-ttu-id="7cee2-102">C から SQL への変換</span><span class="sxs-lookup"><span data-stu-id="7cee2-102">Conversions from C to SQL</span></span>
  <span data-ttu-id="7cee2-103">このトピックでは、C 型から日付型または時刻型に変換する際に考慮すべき問題を示し [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-103">This topic lists issues to consider when you convert from C types to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types.</span></span>  
  
 <span data-ttu-id="7cee2-104">次の表で説明する変換は、クライアントで行われる変換に当てはまります。</span><span class="sxs-lookup"><span data-stu-id="7cee2-104">The conversions described in the following table apply to conversions made on the client.</span></span> <span data-ttu-id="7cee2-105">パラメーターに対して、サーバーで定義されているのとは異なる、秒の小数部の有効桁数をクライアントで指定した場合、クライアントでの変換は成功しても、`SQLExecute` または `SQLExecuteDirect` を呼び出すとサーバーがエラーを返します。</span><span class="sxs-lookup"><span data-stu-id="7cee2-105">In cases where the client specifies fractional second precision for a parameter that differs from that defined on the server, the client conversion might succeed but the server will return an error when `SQLExecute` or `SQLExecuteDirect` is called.</span></span> <span data-ttu-id="7cee2-106">具体的には、ODBC では、秒の小数部の切り捨てがエラーとして処理されますが、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では丸め処理が行われます。たとえば、`datetime2(6)` を `datetime2(2)` に変換するときに丸め処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-106">In particular, ODBC treats any truncation of fractional seconds as an error, whereas the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] behavior is to round; for example, rounding occurs when you go from `datetime2(6)` to `datetime2(2)`.</span></span> <span data-ttu-id="7cee2-107">datetime 列の値は 1/300 秒単位に丸められ、smalldatetime 列では、サーバーによって秒が 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-107">Datetime column values are rounded to 1/300th of a second and smalldatetime columns have seconds set to zero by the server.</span></span>  
  
|||||||||  
|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="7cee2-108">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="7cee2-108">SQL_TYPE_DATE</span></span>|<span data-ttu-id="7cee2-109">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="7cee2-109">SQL_TYPE_TIME</span></span>|<span data-ttu-id="7cee2-110">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="7cee2-110">SQL_SS_TIME2</span></span>|<span data-ttu-id="7cee2-111">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="7cee2-111">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="7cee2-112">SQL_SS_TIMSTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="7cee2-112">SQL_SS_TIMSTAMPOFFSET</span></span>|<span data-ttu-id="7cee2-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="7cee2-113">SQL_CHAR</span></span>|<span data-ttu-id="7cee2-114">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="7cee2-114">SQL_WCHAR</span></span>|  
|<span data-ttu-id="7cee2-115">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="7cee2-115">SQL_C_DATE</span></span>|<span data-ttu-id="7cee2-116">1</span><span class="sxs-lookup"><span data-stu-id="7cee2-116">1</span></span>|-|-|<span data-ttu-id="7cee2-117">1、6</span><span class="sxs-lookup"><span data-stu-id="7cee2-117">1,6</span></span>|<span data-ttu-id="7cee2-118">1、5、6</span><span class="sxs-lookup"><span data-stu-id="7cee2-118">1,5,6</span></span>|<span data-ttu-id="7cee2-119">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-119">1,13</span></span>|<span data-ttu-id="7cee2-120">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-120">1,13</span></span>|  
|<span data-ttu-id="7cee2-121">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="7cee2-121">SQL_C_TIME</span></span>|-|<span data-ttu-id="7cee2-122">1</span><span class="sxs-lookup"><span data-stu-id="7cee2-122">1</span></span>|<span data-ttu-id="7cee2-123">1</span><span class="sxs-lookup"><span data-stu-id="7cee2-123">1</span></span>|<span data-ttu-id="7cee2-124">1、7</span><span class="sxs-lookup"><span data-stu-id="7cee2-124">1,7</span></span>|<span data-ttu-id="7cee2-125">1、5、7</span><span class="sxs-lookup"><span data-stu-id="7cee2-125">1,5,7</span></span>|<span data-ttu-id="7cee2-126">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-126">1,13</span></span>|<span data-ttu-id="7cee2-127">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-127">1,13</span></span>|  
|<span data-ttu-id="7cee2-128">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="7cee2-128">SQL_C_SS_TIME2</span></span>|-|<span data-ttu-id="7cee2-129">1、3</span><span class="sxs-lookup"><span data-stu-id="7cee2-129">1,3</span></span>|<span data-ttu-id="7cee2-130">1、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-130">1,10</span></span>|<span data-ttu-id="7cee2-131">1、7</span><span class="sxs-lookup"><span data-stu-id="7cee2-131">1,7</span></span>|<span data-ttu-id="7cee2-132">1、5、7</span><span class="sxs-lookup"><span data-stu-id="7cee2-132">1,5,7</span></span>|<span data-ttu-id="7cee2-133">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-133">1,13</span></span>|<span data-ttu-id="7cee2-134">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-134">1,13</span></span>|  
|<span data-ttu-id="7cee2-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="7cee2-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span></span>|<span data-ttu-id="7cee2-136">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-136">N/A</span></span>|<span data-ttu-id="7cee2-137">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-137">N/A</span></span>|<span data-ttu-id="7cee2-138">1、10、11</span><span class="sxs-lookup"><span data-stu-id="7cee2-138">1,10,11</span></span>|<span data-ttu-id="7cee2-139">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-139">N/A</span></span>|<span data-ttu-id="7cee2-140">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-140">N/A</span></span>|<span data-ttu-id="7cee2-141">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-141">N/A</span></span>|<span data-ttu-id="7cee2-142">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-142">N/A</span></span>|  
|<span data-ttu-id="7cee2-143">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="7cee2-143">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="7cee2-144">1、2</span><span class="sxs-lookup"><span data-stu-id="7cee2-144">1,2</span></span>|<span data-ttu-id="7cee2-145">1、3、4</span><span class="sxs-lookup"><span data-stu-id="7cee2-145">1,3,4</span></span>|<span data-ttu-id="7cee2-146">1、4、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-146">1,4,10</span></span>|<span data-ttu-id="7cee2-147">1、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-147">1,10</span></span>|<span data-ttu-id="7cee2-148">1、5、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-148">1,5,10</span></span>|<span data-ttu-id="7cee2-149">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-149">1,13</span></span>|<span data-ttu-id="7cee2-150">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-150">1,13</span></span>|  
|<span data-ttu-id="7cee2-151">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="7cee2-151">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="7cee2-152">1、2、8</span><span class="sxs-lookup"><span data-stu-id="7cee2-152">1,2,8</span></span>|<span data-ttu-id="7cee2-153">1、3、4、8</span><span class="sxs-lookup"><span data-stu-id="7cee2-153">1,3,4,8</span></span>|<span data-ttu-id="7cee2-154">1、4、8、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-154">1,4,8,10</span></span>|<span data-ttu-id="7cee2-155">1、8、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-155">1,8,10</span></span>|<span data-ttu-id="7cee2-156">1、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-156">1,10</span></span>|<span data-ttu-id="7cee2-157">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-157">1,13</span></span>|<span data-ttu-id="7cee2-158">1、13</span><span class="sxs-lookup"><span data-stu-id="7cee2-158">1,13</span></span>|  
|<span data-ttu-id="7cee2-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="7cee2-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span></span>|<span data-ttu-id="7cee2-160">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-160">N/A</span></span>|<span data-ttu-id="7cee2-161">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-161">N/A</span></span>|<span data-ttu-id="7cee2-162">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-162">N/A</span></span>|<span data-ttu-id="7cee2-163">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-163">N/A</span></span>|<span data-ttu-id="7cee2-164">1、10、11</span><span class="sxs-lookup"><span data-stu-id="7cee2-164">1,10,11</span></span>|<span data-ttu-id="7cee2-165">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-165">N/A</span></span>|<span data-ttu-id="7cee2-166">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-166">N/A</span></span>|  
|<span data-ttu-id="7cee2-167">SQL_C_CHAR/SQL_WCHAR (date)</span><span class="sxs-lookup"><span data-stu-id="7cee2-167">SQL_C_CHAR/SQL_WCHAR (date)</span></span>|<span data-ttu-id="7cee2-168">9</span><span class="sxs-lookup"><span data-stu-id="7cee2-168">9</span></span>|<span data-ttu-id="7cee2-169">9</span><span class="sxs-lookup"><span data-stu-id="7cee2-169">9</span></span>|<span data-ttu-id="7cee2-170">9</span><span class="sxs-lookup"><span data-stu-id="7cee2-170">9</span></span>|<span data-ttu-id="7cee2-171">9、6</span><span class="sxs-lookup"><span data-stu-id="7cee2-171">9,6</span></span>|<span data-ttu-id="7cee2-172">9、5、6</span><span class="sxs-lookup"><span data-stu-id="7cee2-172">9,5,6</span></span>|<span data-ttu-id="7cee2-173">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-173">N/A</span></span>|<span data-ttu-id="7cee2-174">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-174">N/A</span></span>|  
|<span data-ttu-id="7cee2-175">SQL_C_CHAR/SQL_WCHAR (time2)</span><span class="sxs-lookup"><span data-stu-id="7cee2-175">SQL_C_CHAR/SQL_WCHAR (time2)</span></span>|<span data-ttu-id="7cee2-176">9</span><span class="sxs-lookup"><span data-stu-id="7cee2-176">9</span></span>|<span data-ttu-id="7cee2-177">9、3</span><span class="sxs-lookup"><span data-stu-id="7cee2-177">9,3</span></span>|<span data-ttu-id="7cee2-178">9、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-178">9,10</span></span>|<span data-ttu-id="7cee2-179">9、7、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-179">9,7,10</span></span>|<span data-ttu-id="7cee2-180">9、5、7、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-180">9,5,7,10</span></span>|<span data-ttu-id="7cee2-181">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-181">N/A</span></span>|<span data-ttu-id="7cee2-182">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-182">N/A</span></span>|  
|<span data-ttu-id="7cee2-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span><span class="sxs-lookup"><span data-stu-id="7cee2-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span></span>|<span data-ttu-id="7cee2-184">9、2</span><span class="sxs-lookup"><span data-stu-id="7cee2-184">9,2</span></span>|<span data-ttu-id="7cee2-185">9、3、4</span><span class="sxs-lookup"><span data-stu-id="7cee2-185">9,3,4</span></span>|<span data-ttu-id="7cee2-186">9、4、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-186">9,4,10</span></span>|<span data-ttu-id="7cee2-187">9、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-187">9,10</span></span>|<span data-ttu-id="7cee2-188">9、5、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-188">9,5,10</span></span>|<span data-ttu-id="7cee2-189">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-189">N/A</span></span>|<span data-ttu-id="7cee2-190">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-190">N/A</span></span>|  
|<span data-ttu-id="7cee2-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="7cee2-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span></span>|<span data-ttu-id="7cee2-192">9、2、8</span><span class="sxs-lookup"><span data-stu-id="7cee2-192">9,2,8</span></span>|<span data-ttu-id="7cee2-193">9、3、4、8</span><span class="sxs-lookup"><span data-stu-id="7cee2-193">9,3,4,8</span></span>|<span data-ttu-id="7cee2-194">9、4、8、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-194">9,4,8,10</span></span>|<span data-ttu-id="7cee2-195">9、8、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-195">9,8,10</span></span>|<span data-ttu-id="7cee2-196">9、10</span><span class="sxs-lookup"><span data-stu-id="7cee2-196">9,10</span></span>|<span data-ttu-id="7cee2-197">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-197">N/A</span></span>|<span data-ttu-id="7cee2-198">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-198">N/A</span></span>|  
|<span data-ttu-id="7cee2-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="7cee2-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span></span>|<span data-ttu-id="7cee2-200">1、11</span><span class="sxs-lookup"><span data-stu-id="7cee2-200">1,11</span></span>|<span data-ttu-id="7cee2-201">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-201">N/A</span></span>|<span data-ttu-id="7cee2-202">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-202">N/A</span></span>|<span data-ttu-id="7cee2-203">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-203">N/A</span></span>|<span data-ttu-id="7cee2-204">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-204">N/A</span></span>|<span data-ttu-id="7cee2-205">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-205">N/A</span></span>|<span data-ttu-id="7cee2-206">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-206">N/A</span></span>|  
|<span data-ttu-id="7cee2-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="7cee2-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span></span>|<span data-ttu-id="7cee2-208">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-208">N/A</span></span>|<span data-ttu-id="7cee2-209">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-209">N/A</span></span>|<span data-ttu-id="7cee2-210">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-210">N/A</span></span>|<span data-ttu-id="7cee2-211">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-211">N/A</span></span>|<span data-ttu-id="7cee2-212">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-212">N/A</span></span>|<span data-ttu-id="7cee2-213">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-213">N/A</span></span>|<span data-ttu-id="7cee2-214">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-214">N/A</span></span>|  
|<span data-ttu-id="7cee2-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="7cee2-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span></span>|<span data-ttu-id="7cee2-216">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-216">N/A</span></span>|<span data-ttu-id="7cee2-217">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-217">N/A</span></span>|<span data-ttu-id="7cee2-218">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-218">N/A</span></span>|<span data-ttu-id="7cee2-219">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-219">N/A</span></span>|<span data-ttu-id="7cee2-220">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-220">N/A</span></span>|<span data-ttu-id="7cee2-221">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-221">N/A</span></span>|<span data-ttu-id="7cee2-222">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-222">N/A</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="7cee2-223">記号の説明</span><span class="sxs-lookup"><span data-stu-id="7cee2-223">Key to Symbols</span></span>  
  
|<span data-ttu-id="7cee2-224">Symbol</span><span class="sxs-lookup"><span data-stu-id="7cee2-224">Symbol</span></span>|<span data-ttu-id="7cee2-225">意味</span><span class="sxs-lookup"><span data-stu-id="7cee2-225">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="7cee2-226">変換はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7cee2-226">No conversion is supported.</span></span> <span data-ttu-id="7cee2-227">"データ型の属性に関する制限に違反しました" というメッセージで SQLSTATE 07006 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-227">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="7cee2-228">1</span><span class="sxs-lookup"><span data-stu-id="7cee2-228">1</span></span>|<span data-ttu-id="7cee2-229">指定したデータが無効な場合、"datetime 形式が無効です" というメッセージで SQLSTATE 22007 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-229">If the data supplied is not valid, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="7cee2-230">2</span><span class="sxs-lookup"><span data-stu-id="7cee2-230">2</span></span>|<span data-ttu-id="7cee2-231">時刻フィールドは 0 である必要があります。0 以外の場合、"分数が切り捨てられました" というメッセージで SQLSTATE 22008 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-231">Time fields must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="7cee2-232">3</span><span class="sxs-lookup"><span data-stu-id="7cee2-232">3</span></span>|<span data-ttu-id="7cee2-233">秒の小数部は 0 である必要があります。0 以外の場合、"分数が切り捨てられました" というメッセージで SQLSTATE 22008 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-233">Fractional seconds must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="7cee2-234">4</span><span class="sxs-lookup"><span data-stu-id="7cee2-234">4</span></span>|<span data-ttu-id="7cee2-235">日付部分は無視されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-235">The date component is ignored.</span></span>|  
|<span data-ttu-id="7cee2-236">5</span><span class="sxs-lookup"><span data-stu-id="7cee2-236">5</span></span>|<span data-ttu-id="7cee2-237">タイム ゾーンには、クライアントのタイム ゾーン設定が設定されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-237">The timezone is set to the client's timezone setting.</span></span>|  
|<span data-ttu-id="7cee2-238">6</span><span class="sxs-lookup"><span data-stu-id="7cee2-238">6</span></span>|<span data-ttu-id="7cee2-239">時刻は 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-239">The time is set to zero.</span></span>|  
|<span data-ttu-id="7cee2-240">7</span><span class="sxs-lookup"><span data-stu-id="7cee2-240">7</span></span>|<span data-ttu-id="7cee2-241">日付は現在の日付に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-241">The date is set to the current date.</span></span>|  
|<span data-ttu-id="7cee2-242">8</span><span class="sxs-lookup"><span data-stu-id="7cee2-242">8</span></span>|<span data-ttu-id="7cee2-243">時刻は、クライアントのタイムゾーンから UTC に変換されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-243">The time is converted from the client's timezone to UTC.</span></span> <span data-ttu-id="7cee2-244">この変換中にエラーが発生すると、"Datetime フィールド オーバーフロー" というメッセージで SQLSTATE 22008 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-244">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="7cee2-245">9</span><span class="sxs-lookup"><span data-stu-id="7cee2-245">9</span></span>|<span data-ttu-id="7cee2-246">文字列は解析され、最初に検出された句読点、および残りの部分があるかどうかに応じて、date 値、datetime 値、datetimeoffset 値、time 値のいずれかに変換されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-246">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and the presence of remaining components.</span></span> <span data-ttu-id="7cee2-247">次に、上の表に示した規則のうち、この処理で検出された変換元の型についての規則に従って、文字列は変換先の型に変換されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-247">The string is then converted to the target type, following the rules in the preceding table for the source type discovered by this process.</span></span> <span data-ttu-id="7cee2-248">データの解析中にエラーが検出された場合、"キャストした文字コードが正しくありません" というメッセージで SQLSTATE 22018 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-248">If an error is detected while parsing the data, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="7cee2-249">datetime 型および smalldatetime 型のパラメーターでは、年がこれらの型でサポートされる範囲外の場合、"datetime 形式が無効です" というメッセージで SQLSTATE 22007 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-249">For datetime and smalldatetime parameters, if the year is outside the range supported by these types, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="7cee2-250">datetimeoffset では、UTC への変換が必要なくても、値は UTC への変換後の範囲内に収まっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="7cee2-250">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="7cee2-251">TDS とサーバーは datetimeoffset 値の時刻を常に UTC 用に正規化するので、クライアントは、時刻部分が、UTC への変換後にサポートされる範囲内に収まっていることを確認する必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="7cee2-251">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="7cee2-252">値が、サポートされている UTC の範囲内に収まっていない場合、"datetime 形式が無効です" というメッセージで SQLSTATE 22007 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-252">If the value is not within the supported UTC range, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="7cee2-253">10</span><span class="sxs-lookup"><span data-stu-id="7cee2-253">10</span></span>|<span data-ttu-id="7cee2-254">データの損失を伴う切り捨てが行われると、"時間の形式が正しくありません" というメッセージで SQLSTATE 22008 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-254">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22008 and the message "Invalid time format".</span></span> <span data-ttu-id="7cee2-255">サーバーが使用する UTC の範囲で表すことができる範囲の外に値がある場合にも、このエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="7cee2-255">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span>|  
|<span data-ttu-id="7cee2-256">11</span><span class="sxs-lookup"><span data-stu-id="7cee2-256">11</span></span>|<span data-ttu-id="7cee2-257">データのバイト長が、SQL 型が要求する構造体のサイズと等しくない場合、"数値が範囲を超えています" というメッセージで SQLSTATE 22003 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-257">If the byte length of the data does not equal the size of the struct required by the SQL type, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="7cee2-258">12</span><span class="sxs-lookup"><span data-stu-id="7cee2-258">12</span></span>|<span data-ttu-id="7cee2-259">データのバイト長が 4 バイトまたは 8 バイトの場合、データは、生の TDS smalldatetime 形式または datetime 形式でサーバーに送信されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-259">If the byte length of the data is 4 or 8, the data is sent to the server in raw TDS smalldatetime or datetime format.</span></span> <span data-ttu-id="7cee2-260">データのバイト長が SQL_TIMESTAMP_STRUCT のサイズと完全に一致する場合、データは、datetime2 用の TDS 形式に変換されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-260">If the byte length of the data exactly matches the size of SQL_TIMESTAMP_STRUCT, the data is converted to the TDS format for datetime2.</span></span>|  
|<span data-ttu-id="7cee2-261">13</span><span class="sxs-lookup"><span data-stu-id="7cee2-261">13</span></span>|<span data-ttu-id="7cee2-262">データの損失を伴う切り捨てが行われると、"文字列データの右側が切り捨てられました" というメッセージで SQLSTATE 22001 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-262">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and the message "String data, right truncated".</span></span><br /><br /> <span data-ttu-id="7cee2-263">秒の小数部の桁数 (小数点以下桁数) は、次のように、変換先の列のサイズによって決まります。</span><span class="sxs-lookup"><span data-stu-id="7cee2-263">The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following:</span></span><br /><br /> <span data-ttu-id="7cee2-264">**種類:** SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="7cee2-264">**Type:** SQL_C_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="7cee2-265">暗黙の小数点以下桁数</span><span class="sxs-lookup"><span data-stu-id="7cee2-265">Implied Scale</span></span><br /><br /> <span data-ttu-id="7cee2-266">0</span><span class="sxs-lookup"><span data-stu-id="7cee2-266">0</span></span><br /><br /> <span data-ttu-id="7cee2-267">19</span><span class="sxs-lookup"><span data-stu-id="7cee2-267">19</span></span><br /><br /> <span data-ttu-id="7cee2-268">暗黙の小数点以下桁数</span><span class="sxs-lookup"><span data-stu-id="7cee2-268">Implied Scale</span></span><br /><br /> <span data-ttu-id="7cee2-269">1.. 9</span><span class="sxs-lookup"><span data-stu-id="7cee2-269">1..9</span></span><br /><br /> <span data-ttu-id="7cee2-270">21..29</span><span class="sxs-lookup"><span data-stu-id="7cee2-270">21..29</span></span><br /><br /> <span data-ttu-id="7cee2-271">ただし、SQL_C_TYPE_TIMESTAMP では、データを損失することなく秒の小数部を 3 桁で表すことができる場合で、かつ、列のサイズが 23 以上である場合、ちょうど 3 桁になるように秒の小数部が生成されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-271">However, for SQL_C_TYPE_TIMESTAMP, if the fractional seconds can be represented with three digits without data loss and the column size is 23 or larger, then exactly three fractional seconds' digits are generated.</span></span> <span data-ttu-id="7cee2-272">この動作により、以前の ODBC ドライバーを使用して開発されたアプリケーションの下位互換性が保証されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-272">This behavior ensures backwards compatibility for applications developed using older ODBC drivers.</span></span><br /><br /> <span data-ttu-id="7cee2-273">テーブルの範囲よりサイズが大きい列の場合は、9 桁と見なされます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-273">For column sizes larger than the range in the table, a scale of 9 is implied.</span></span> <span data-ttu-id="7cee2-274">この変換では、秒の小数点以下桁数が 9 桁まで許容されます。これは、ODBC で許容される最大桁数です。</span><span class="sxs-lookup"><span data-stu-id="7cee2-274">This conversion should allow for up to nine fractional seconds digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="7cee2-275">列サイズ 0 は、ODBC では可変長文字型のサイズが無制限であることを意味します (SQL_C_TYPE_TIMESTAMP の 3 桁ルールが適用されなければ 9 桁)。</span><span class="sxs-lookup"><span data-stu-id="7cee2-275">A column size of zero implies unlimited size for variable length character types in ODBC (9 digits, unless the 3-digit rule for SQL_C_TYPE_TIMESTAMP applies).</span></span> <span data-ttu-id="7cee2-276">固定長文字型の列サイズ 0 を指定すると、エラーになります。</span><span class="sxs-lookup"><span data-stu-id="7cee2-276">Specifying a column size of zero with a fixed length character type is an error.</span></span>|  
|<span data-ttu-id="7cee2-277">該当なし</span><span class="sxs-lookup"><span data-stu-id="7cee2-277">N/A</span></span>|<span data-ttu-id="7cee2-278">既存の [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以前のバージョンの動作が維持されます。</span><span class="sxs-lookup"><span data-stu-id="7cee2-278">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="7cee2-279">参照</span><span class="sxs-lookup"><span data-stu-id="7cee2-279">See Also</span></span>  
 [<span data-ttu-id="7cee2-280">ODBC&#41;&#40;の日付と時刻の改善</span><span class="sxs-lookup"><span data-stu-id="7cee2-280">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
