---
title: SQL から C への変換 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], SQL to C
ms.assetid: 059431e2-a65c-4587-ba4a-9929a1611e96
author: rothja
ms.author: jroth
ms.openlocfilehash: 0cc1fe6049824217a12a291b7006599a4a3a7319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643293"
---
# <a name="conversions-from-sql-to-c"></a><span data-ttu-id="7c68d-102">SQL から C への変換</span><span class="sxs-lookup"><span data-stu-id="7c68d-102">Conversions from SQL to C</span></span>
  <span data-ttu-id="7c68d-103">次の表に、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の日付型または時刻型から C の型に変換する際に考慮する問題を示します。</span><span class="sxs-lookup"><span data-stu-id="7c68d-103">The following table lists issues to consider when you convert from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types to C types.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="7c68d-104">変換</span><span class="sxs-lookup"><span data-stu-id="7c68d-104">Conversions</span></span>  
  
||||||||||  
|-|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="7c68d-105">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="7c68d-105">SQL_C_DATE</span></span>|<span data-ttu-id="7c68d-106">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="7c68d-106">SQL_C_TIME</span></span>|<span data-ttu-id="7c68d-107">SQL_C_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="7c68d-107">SQL_C_TIMESTAMP</span></span>|<span data-ttu-id="7c68d-108">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="7c68d-108">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="7c68d-109">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="7c68d-109">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="7c68d-110">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="7c68d-110">SQL_C_BINARY</span></span>|<span data-ttu-id="7c68d-111">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="7c68d-111">SQL_C_CHAR</span></span>|<span data-ttu-id="7c68d-112">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="7c68d-112">SQL_C_WCHAR</span></span>|  
|<span data-ttu-id="7c68d-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="7c68d-113">SQL_CHAR</span></span>|<span data-ttu-id="7c68d-114">2、3、4、5</span><span class="sxs-lookup"><span data-stu-id="7c68d-114">2,3,4,5</span></span>|<span data-ttu-id="7c68d-115">2、3、6、7、8</span><span class="sxs-lookup"><span data-stu-id="7c68d-115">2,3,6,7,8</span></span>|<span data-ttu-id="7c68d-116">2、3、9、10、11</span><span class="sxs-lookup"><span data-stu-id="7c68d-116">2,3,9,10,11</span></span>|<span data-ttu-id="7c68d-117">2、3、6、7</span><span class="sxs-lookup"><span data-stu-id="7c68d-117">2,3,6,7</span></span>|<span data-ttu-id="7c68d-118">2、3、9、10、11</span><span class="sxs-lookup"><span data-stu-id="7c68d-118">2,3,9,10,11</span></span>|<span data-ttu-id="7c68d-119">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-119">1</span></span>|<span data-ttu-id="7c68d-120">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-120">1</span></span>|<span data-ttu-id="7c68d-121">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-121">1</span></span>|  
|<span data-ttu-id="7c68d-122">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="7c68d-122">SQL_WCHAR</span></span>|<span data-ttu-id="7c68d-123">2、3、4、5</span><span class="sxs-lookup"><span data-stu-id="7c68d-123">2,3,4,5</span></span>|<span data-ttu-id="7c68d-124">2、3、6、7、8</span><span class="sxs-lookup"><span data-stu-id="7c68d-124">2,3,6,7,8</span></span>|<span data-ttu-id="7c68d-125">2、3、9、10、11</span><span class="sxs-lookup"><span data-stu-id="7c68d-125">2,3,9,10,11</span></span>|<span data-ttu-id="7c68d-126">2、3、6、7</span><span class="sxs-lookup"><span data-stu-id="7c68d-126">2,3,6,7</span></span>|<span data-ttu-id="7c68d-127">2、3、9、10、11</span><span class="sxs-lookup"><span data-stu-id="7c68d-127">2,3,9,10,11</span></span>|<span data-ttu-id="7c68d-128">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-128">1</span></span>|<span data-ttu-id="7c68d-129">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-129">1</span></span>|<span data-ttu-id="7c68d-130">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-130">1</span></span>|  
|<span data-ttu-id="7c68d-131">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="7c68d-131">SQL_TYPE_DATE</span></span>|<span data-ttu-id="7c68d-132">[OK]</span><span class="sxs-lookup"><span data-stu-id="7c68d-132">OK</span></span>|<span data-ttu-id="7c68d-133">12</span><span class="sxs-lookup"><span data-stu-id="7c68d-133">12</span></span>|<span data-ttu-id="7c68d-134">13</span><span class="sxs-lookup"><span data-stu-id="7c68d-134">13</span></span>|<span data-ttu-id="7c68d-135">12</span><span class="sxs-lookup"><span data-stu-id="7c68d-135">12</span></span>|<span data-ttu-id="7c68d-136">13、23</span><span class="sxs-lookup"><span data-stu-id="7c68d-136">13,23</span></span>|<span data-ttu-id="7c68d-137">14</span><span class="sxs-lookup"><span data-stu-id="7c68d-137">14</span></span>|<span data-ttu-id="7c68d-138">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-138">16</span></span>|<span data-ttu-id="7c68d-139">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-139">16</span></span>|  
|<span data-ttu-id="7c68d-140">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="7c68d-140">SQL_SS_TIME2</span></span>|<span data-ttu-id="7c68d-141">12</span><span class="sxs-lookup"><span data-stu-id="7c68d-141">12</span></span>|<span data-ttu-id="7c68d-142">8</span><span class="sxs-lookup"><span data-stu-id="7c68d-142">8</span></span>|<span data-ttu-id="7c68d-143">15</span><span class="sxs-lookup"><span data-stu-id="7c68d-143">15</span></span>|<span data-ttu-id="7c68d-144">[OK]</span><span class="sxs-lookup"><span data-stu-id="7c68d-144">OK</span></span>|<span data-ttu-id="7c68d-145">10、23</span><span class="sxs-lookup"><span data-stu-id="7c68d-145">10,23</span></span>|<span data-ttu-id="7c68d-146">17</span><span class="sxs-lookup"><span data-stu-id="7c68d-146">17</span></span>|<span data-ttu-id="7c68d-147">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-147">16</span></span>|<span data-ttu-id="7c68d-148">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-148">16</span></span>|  
|<span data-ttu-id="7c68d-149">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="7c68d-149">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="7c68d-150">18</span><span class="sxs-lookup"><span data-stu-id="7c68d-150">18</span></span>|<span data-ttu-id="7c68d-151">7、8</span><span class="sxs-lookup"><span data-stu-id="7c68d-151">7,8</span></span>|<span data-ttu-id="7c68d-152">[OK]</span><span class="sxs-lookup"><span data-stu-id="7c68d-152">OK</span></span>|<span data-ttu-id="7c68d-153">7</span><span class="sxs-lookup"><span data-stu-id="7c68d-153">7</span></span>|<span data-ttu-id="7c68d-154">23</span><span class="sxs-lookup"><span data-stu-id="7c68d-154">23</span></span>|<span data-ttu-id="7c68d-155">19</span><span class="sxs-lookup"><span data-stu-id="7c68d-155">19</span></span>|<span data-ttu-id="7c68d-156">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-156">16</span></span>|<span data-ttu-id="7c68d-157">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-157">16</span></span>|  
|<span data-ttu-id="7c68d-158">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="7c68d-158">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="7c68d-159">18、22</span><span class="sxs-lookup"><span data-stu-id="7c68d-159">18,22</span></span>|<span data-ttu-id="7c68d-160">7、8、20</span><span class="sxs-lookup"><span data-stu-id="7c68d-160">7,8,20</span></span>|<span data-ttu-id="7c68d-161">20</span><span class="sxs-lookup"><span data-stu-id="7c68d-161">20</span></span>|<span data-ttu-id="7c68d-162">7、20</span><span class="sxs-lookup"><span data-stu-id="7c68d-162">7,20</span></span>|<span data-ttu-id="7c68d-163">[OK]</span><span class="sxs-lookup"><span data-stu-id="7c68d-163">OK</span></span>|<span data-ttu-id="7c68d-164">21</span><span class="sxs-lookup"><span data-stu-id="7c68d-164">21</span></span>|<span data-ttu-id="7c68d-165">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-165">16</span></span>|<span data-ttu-id="7c68d-166">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-166">16</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="7c68d-167">記号の説明</span><span class="sxs-lookup"><span data-stu-id="7c68d-167">Key to Symbols</span></span>  
  
|<span data-ttu-id="7c68d-168">Symbol</span><span class="sxs-lookup"><span data-stu-id="7c68d-168">Symbol</span></span>|<span data-ttu-id="7c68d-169">意味</span><span class="sxs-lookup"><span data-stu-id="7c68d-169">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="7c68d-170">[OK]</span><span class="sxs-lookup"><span data-stu-id="7c68d-170">OK</span></span>|<span data-ttu-id="7c68d-171">変換の問題は発生しません。</span><span class="sxs-lookup"><span data-stu-id="7c68d-171">No conversion issues.</span></span>|  
|<span data-ttu-id="7c68d-172">1</span><span class="sxs-lookup"><span data-stu-id="7c68d-172">1</span></span>|<span data-ttu-id="7c68d-173">[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] より前の規則が適用されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-173">Rules prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] apply.</span></span>|  
|<span data-ttu-id="7c68d-174">2</span><span class="sxs-lookup"><span data-stu-id="7c68d-174">2</span></span>|<span data-ttu-id="7c68d-175">先頭および末尾にあるスペースは無視されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-175">Leading and trailing spaces are ignored.</span></span>|  
|<span data-ttu-id="7c68d-176">3</span><span class="sxs-lookup"><span data-stu-id="7c68d-176">3</span></span>|<span data-ttu-id="7c68d-177">文字列が日付、時刻、タイム ゾーン、またはタイム ゾーン オフセットに解析され、秒の小数部は 9 桁まで許容されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-177">The string is parsed into a date, time, timezone, or timezoneoffset, and allows up to 9 digits for fractional seconds.</span></span> <span data-ttu-id="7c68d-178">タイム ゾーン オフセットが解析されると、時刻はクライアントのタイム ゾーンに変換されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-178">If a timezoneoffset is parsed, the time is converted to the client timezone.</span></span> <span data-ttu-id="7c68d-179">この変換中にエラーが発生した場合、"Datetime field overflow" というメッセージで SQLSTATE 22018 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-179">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22018 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="7c68d-180">4</span><span class="sxs-lookup"><span data-stu-id="7c68d-180">4</span></span>|<span data-ttu-id="7c68d-181">値が日付、タイムスタンプ、またはタイムスタンプ オフセットの有効な値ではない場合、"キャストした文字コードが正しくありません" というメッセージで SQLSTATE 22018 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-181">If the value is not a valid date, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="7c68d-182">5</span><span class="sxs-lookup"><span data-stu-id="7c68d-182">5</span></span>|<span data-ttu-id="7c68d-183">時刻が 0 以外の場合、"分数が切り捨てられました" というメッセージで SQLSTATE 01S07 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-183">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="7c68d-184">6</span><span class="sxs-lookup"><span data-stu-id="7c68d-184">6</span></span>|<span data-ttu-id="7c68d-185">値が時刻、タイムスタンプ、またはタイムスタンプ オフセットの有効な値ではない場合、"キャストした文字コードが正しくありません" というメッセージで SQLSTATE 22018 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-185">If the value is not a valid time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="7c68d-186">7</span><span class="sxs-lookup"><span data-stu-id="7c68d-186">7</span></span>|<span data-ttu-id="7c68d-187">日付部分は無視されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-187">The date component is ignored.</span></span>|  
|<span data-ttu-id="7c68d-188">8</span><span class="sxs-lookup"><span data-stu-id="7c68d-188">8</span></span>|<span data-ttu-id="7c68d-189">秒の小数部が 0 以外の場合、"分数が切り捨てられました" というメッセージで SQLSTATE 01S07 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-189">If the fractional seconds are non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="7c68d-190">9</span><span class="sxs-lookup"><span data-stu-id="7c68d-190">9</span></span>|<span data-ttu-id="7c68d-191">値が日付、時刻、タイムスタンプ、またはタイムスタンプ オフセットの有効な値ではない場合、"キャストした文字コードが正しくありません" というメッセージで SQLSTATE 22018 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-191">If the value is not a valid date, time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="7c68d-192">10</span><span class="sxs-lookup"><span data-stu-id="7c68d-192">10</span></span>|<span data-ttu-id="7c68d-193">値が有効な時刻の場合、日付部分は現在のクライアントの日付に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-193">If the value is a valid time, the date component is set to current client date.</span></span>|  
|<span data-ttu-id="7c68d-194">11</span><span class="sxs-lookup"><span data-stu-id="7c68d-194">11</span></span>|<span data-ttu-id="7c68d-195">値が有効な日付の場合、時刻は 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-195">If the value is a valid date, the time is set to zero.</span></span>|  
|<span data-ttu-id="7c68d-196">12</span><span class="sxs-lookup"><span data-stu-id="7c68d-196">12</span></span>|<span data-ttu-id="7c68d-197">"データ型の属性に関する制限に違反しました" というメッセージで SQLSTATE 07006 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-197">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="7c68d-198">13</span><span class="sxs-lookup"><span data-stu-id="7c68d-198">13</span></span>|<span data-ttu-id="7c68d-199">時刻は 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-199">The time is set to zero.</span></span>|  
|<span data-ttu-id="7c68d-200">14</span><span class="sxs-lookup"><span data-stu-id="7c68d-200">14</span></span>|<span data-ttu-id="7c68d-201">SQL_DATE_STRUCT を格納するにはバッファーの大きさが十分ではない場合、"数値が範囲を超えています" というメッセージで SQLSTATE 22003 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-201">If the buffer is not large enough to accommodate a SQL_DATE_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="7c68d-202">15</span><span class="sxs-lookup"><span data-stu-id="7c68d-202">15</span></span>|<span data-ttu-id="7c68d-203">日付は現在のクライアントの日付に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-203">The date is set to the current client date.</span></span>|  
|<span data-ttu-id="7c68d-204">16</span><span class="sxs-lookup"><span data-stu-id="7c68d-204">16</span></span>|<span data-ttu-id="7c68d-205">変換された文字列値の秒の小数部以外を格納するにはバッファーの大きさが十分でない場合、"文字列データの右側が切り捨てられました" というメッセージで SQLSTATE 01004 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-205">If the buffer is not large enough to accommodate the converted string value but only fractional seconds, truncation occurs and a diagnostic record is generated with SQLSTATE 01004 and the message "String data, right truncated".</span></span> <span data-ttu-id="7c68d-206">日付、時刻、またはオフセット部分を切り捨てずに文字列値を格納するにはバッファーの大きさが十分でない場合、"数値が範囲を超えています" というメッセージで SQLSTATE 22003 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-206">If the buffer is not large enough to accommodate the string value without truncation of date, time, or offset components, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span> <span data-ttu-id="7c68d-207">日付とタイムスタンプ オフセットでは、変換された文字列の右端に秒の小数部が含まれないため、SQLSTATE 01004 は生成されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="7c68d-207">Note that for date and timestampoffset, SQLSTATE 01004 is not possible because the rightmost part of the converted string does not contain fractional seconds.</span></span> <span data-ttu-id="7c68d-208">したがって、切り捨てにより、データの損失が発生します。</span><span class="sxs-lookup"><span data-stu-id="7c68d-208">Therefore, any truncation causes data loss.</span></span>|  
|<span data-ttu-id="7c68d-209">17</span><span class="sxs-lookup"><span data-stu-id="7c68d-209">17</span></span>|<span data-ttu-id="7c68d-210">SQL_SS_TIME2_STRUCT を格納するにはバッファーの大きさが十分でない場合、"数値が範囲を超えています" というメッセージで SQLSTATE 22003 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-210">If the buffer is not large enough to accommodate a SQL_SS_TIME2_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="7c68d-211">18</span><span class="sxs-lookup"><span data-stu-id="7c68d-211">18</span></span>|<span data-ttu-id="7c68d-212">時刻が 0 以外の場合、"分数が切り捨てられました" というメッセージで SQLSTATE 01S07 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-212">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="7c68d-213">19</span><span class="sxs-lookup"><span data-stu-id="7c68d-213">19</span></span>|<span data-ttu-id="7c68d-214">サーバー側の型が datetime または smalldatetime の場合、値は TDS ワイヤ形式に対応し、smalldatetime の場合は 4 バイトの値、datetime の場合は 8 バイトの値になります。</span><span class="sxs-lookup"><span data-stu-id="7c68d-214">If the server type is datetime or smalldatetime, the value corresponds to the TDS wire format and will be a 4-byte value for smalldatetime and an 8-byte value for datetime.</span></span><br /><br /> <span data-ttu-id="7c68d-215">サーバー側の型が datetime2 の場合、値は SQL_TIMESTAMP_STRUCT として返されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-215">If the server type is datetime2, the value is returned as a SQL_TIMESTAMP_STRUCT.</span></span> <span data-ttu-id="7c68d-216">返された値を格納するにはバッファーの大きさが十分でない場合、"数値が範囲を超えています" というメッセージで SQLSTATE 22003 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-216">If the buffer is not large enough to accommodate the returned value, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="7c68d-217">20</span><span class="sxs-lookup"><span data-stu-id="7c68d-217">20</span></span>|<span data-ttu-id="7c68d-218">時刻はクライアントのタイム ゾーンに変換されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-218">The time is converted to the client timezone.</span></span> <span data-ttu-id="7c68d-219">この変換中にエラーが発生すると、"Datetime フィールド オーバーフロー" というメッセージで SQLSTATE 22008 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-219">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="7c68d-220">21</span><span class="sxs-lookup"><span data-stu-id="7c68d-220">21</span></span>|<span data-ttu-id="7c68d-221">SQL_SS_TIMESTAMPOFFSET_STRUCT を格納するのにバッファーの大きさが十分である場合、値は SQL_SS_TIMESTAMPOFFSET_STRUCT として返されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-221">If the buffer is large enough to accommodate a SQL_SS_TIMESTAMPOFFSET_STRUCT, the value is returned as a SQL_SS_TIMESTAMPOFFSET_STRUCT.</span></span> <span data-ttu-id="7c68d-222">それ以外の場合は、"数値が範囲を超えています" というメッセージで SQLSTATE 22003 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-222">Otherwise, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="7c68d-223">22</span><span class="sxs-lookup"><span data-stu-id="7c68d-223">22</span></span>|<span data-ttu-id="7c68d-224">値がクライアントのタイム ゾーンに変換されてから、日付が抽出されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-224">The value is converted to the client timezone before the date is extracted.</span></span> <span data-ttu-id="7c68d-225">これにより、タイムスタンプ オフセットの種類によるその他の変換との一貫性が提供されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-225">This provides consistency with other conversions with timestampoffset types.</span></span> <span data-ttu-id="7c68d-226">この変換中にエラーが発生すると、"Datetime フィールド オーバーフロー" というメッセージで SQLSTATE 22008 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-226">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="7c68d-227">これにより、単純な切り捨てによって取得された値とは異なる日付になることもあります。</span><span class="sxs-lookup"><span data-stu-id="7c68d-227">This might result in a date that differs from the value obtained by simple truncation.</span></span>|  
  
 <span data-ttu-id="7c68d-228">このトピックの表では、クライアントに返される型とバインドの型との間の変換について説明しています。</span><span class="sxs-lookup"><span data-stu-id="7c68d-228">The table in this topic describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="7c68d-229">出力パラメーターの場合、SQLBindParameter で指定されたサーバーの型がサーバー上の実際の型と一致しないと、サーバーによって暗黙的な変換が実行され、クライアントに返される型は SQLBindParameter によって指定された型と一致します。</span><span class="sxs-lookup"><span data-stu-id="7c68d-229">For output parameters, if the server type specified in SQLBindParameter does not match the actual type on the server, an implicit conversion will be performed by the server and the type returned to the client will match the type specified through SQLBindParameter.</span></span> <span data-ttu-id="7c68d-230">これにより、サーバーの変換規則が前の表に記載されているものと異なる場合に、予期しない変換結果が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7c68d-230">This can lead to unexpected conversion results when the server's conversion rules are different from those listed in the preceding table.</span></span> <span data-ttu-id="7c68d-231">たとえば、既定の日付を指定する必要がある場合、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では現在の日付ではなく 1900-1-1 が使用されます。</span><span class="sxs-lookup"><span data-stu-id="7c68d-231">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1, rather than the current date.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c68d-232">参照</span><span class="sxs-lookup"><span data-stu-id="7c68d-232">See Also</span></span>  
 [<span data-ttu-id="7c68d-233">ODBC&#41;&#40;の日付と時刻の改善</span><span class="sxs-lookup"><span data-stu-id="7c68d-233">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
