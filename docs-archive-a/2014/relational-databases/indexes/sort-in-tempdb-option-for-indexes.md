---
title: インデックスの SORT_IN_TEMPDB オプション | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- SORT_IN_TEMPDB option
- disk space [SQL Server], indexes
- space [SQL Server], indexes
- tempdb database [SQL Server], indexes
- indexes [SQL Server], tempdb database
- index creation [SQL Server], tempdb database
ms.assetid: 754a003f-fe51-4d10-975a-f6b8c04ebd35
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 8feccc5b1d29617193f481569e10648c6ed77242
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739936"
---
# <a name="sort_in_tempdb-option-for-indexes"></a><span data-ttu-id="f74c0-102">インデックスの SORT_IN_TEMPDB オプション</span><span class="sxs-lookup"><span data-stu-id="f74c0-102">SORT_IN_TEMPDB Option For Indexes</span></span>
  <span data-ttu-id="f74c0-103">インデックスを作成または再構築する際には、SORT_IN_TEMPDB オプションを ON に設定することにより、インデックスの構築に使用する中間の並べ替え結果の格納場所として [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] が **tempdb** を使用するように指定できます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-103">When you create or rebuild an index, by setting the SORT_IN_TEMPDB option to ON you can direct the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to use **tempdb** to store the intermediate sort results that are used to build the index.</span></span> <span data-ttu-id="f74c0-104">このオプションを使用すると、インデックスの作成に使用する一時ディスク領域は増えますが、 **tempdb** がユーザー データベースとは異なるディスク セットにある場合、インデックスの作成または再構築に必要な時間を短縮できることがあります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-104">Although this option increases the amount of temporary disk space that is used to create an index, the option could reduce the time that is required to create or rebuild an index when **tempdb** is on a set of disks different from that of the user database.</span></span> <span data-ttu-id="f74c0-105">**tempdb**の詳細については、「 [index create memory サーバー構成オプションの構成](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f74c0-105">For more information about **tempdb**, see [Configure the index create memory Server Configuration Option](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span></span>  
  
## <a name="phases-of-index-building"></a><span data-ttu-id="f74c0-106">インデックス構築のフェーズ</span><span class="sxs-lookup"><span data-stu-id="f74c0-106">Phases of Index Building</span></span>  
 <span data-ttu-id="f74c0-107">[!INCLUDE[ssDE](../../includes/ssde-md.md)] でインデックスを構築する際には、次のようなフェーズがあります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-107">As the [!INCLUDE[ssDE](../../includes/ssde-md.md)] builds an index, it goes through the following phases:</span></span>  
  
-   <span data-ttu-id="f74c0-108">[!INCLUDE[ssDE](../../includes/ssde-md.md)] により、最初にベース テーブルのデータ ページがスキャンされてキー値が取得されます。次に、データ行ごとにインデックス リーフ行が構築されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-108">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] first scans the data pages of the base table to retrieve key values and builds an index leaf row for each data row.</span></span> <span data-ttu-id="f74c0-109">内部の並べ替えバッファーがリーフ インデックス エントリでいっぱいになると、そのエントリは並べ替えられて中間の並べ替え実行結果としてディスクに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-109">When the internal sort buffers have been filled with leaf index entries, the entries are sorted and written to disk as an intermediate sort run.</span></span> <span data-ttu-id="f74c0-110">その後、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] によりデータ ページのスキャンが再開され、並べ替えバッファーがいっぱいになるまで続行されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-110">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] then resumes the data page scan until the sort buffers are again filled.</span></span> <span data-ttu-id="f74c0-111">この複数のデータ ページをスキャンしてから、並べ替えと並べ替え実行結果の書き込みを行うという一連の操作は、ベース テーブルのすべての行が処理されるまで続きます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-111">This pattern of scanning multiple data pages followed by sorting and writing a sort run continues until all the rows of the base table have been processed.</span></span>  
  
     <span data-ttu-id="f74c0-112">クラスター化インデックスでは、インデックスのリーフ行がテーブルのデータ行なので、中間の並べ替え実行結果にはすべてのデータ行が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-112">In a clustered index, the leaf rows of the index are the data rows of the table; therefore, the intermediate sort runs contain all the data rows.</span></span> <span data-ttu-id="f74c0-113">非クラスター化インデックスでは、リーフ行に非キー列が含まれることがありますが、通常はクラスター化インデックスより小さくなります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-113">In a nonclustered index, the leaf rows may contain nonkey columns, but are generally smaller than a clustered index.</span></span> <span data-ttu-id="f74c0-114">インデックス キーが大きい場合、またはインデックスに複数の非キー列が含まれている場合は、非クラスター化インデックスの並べ替え実行結果が大きくなることがあります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-114">If the index keys are large, or there are several nonkey columns included in the index, a nonclustered sort run can be large.</span></span> <span data-ttu-id="f74c0-115">非キー列を含めることの詳細については、「 [付加列インデックスの作成](create-indexes-with-included-columns.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f74c0-115">For more information about including nonkey columns, see [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span></span>  
  
-   <span data-ttu-id="f74c0-116">[!INCLUDE[ssDE](../../includes/ssde-md.md)] により、インデックス リーフ行の実行結果が 1 つの並べ替えられたストリームにマージされます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-116">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] merges the sorted runs of index leaf rows into a single, sorted stream.</span></span> <span data-ttu-id="f74c0-117">[!INCLUDE[ssDE](../../includes/ssde-md.md)] の並べ替えマージ コンポーネントにより、各並べ替え実行結果の最初のページから開始して、すべてのページ内で最下位のキーが検索され、そのリーフ行がインデックス作成コンポーネントに渡されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-117">The sort merge component of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts with the first page of each sort run, finds the lowest key in all the pages, and passes that leaf row to the index create component.</span></span> <span data-ttu-id="f74c0-118">次に、最初に処理された最下位のキーの次に低いキーが処理され、この方法で順に処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-118">The next lowest key is processed, and then the next, and so on.</span></span> <span data-ttu-id="f74c0-119">並べ替え実行結果ページから最後のリーフ インデックス行が取り出されると、処理がその並べ替え実行結果から次のページに切り替わります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-119">When the last leaf index row is extracted from a sort run page, the process shifts to the next page from that sort run.</span></span> <span data-ttu-id="f74c0-120">並べ替え実行エクステントに含まれるすべてのページが処理されると、そのエクステントは解放されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-120">When all the pages in a sort run extent have been processed, the extent is freed.</span></span> <span data-ttu-id="f74c0-121">インデックス作成コンポーネントに渡された各リーフ インデックス行は、バッファー内のリーフ インデックス ページに格納されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-121">As each leaf index row is passed to the index create component, it is included in a leaf index page in the buffer.</span></span> <span data-ttu-id="f74c0-122">各リーフ ページは、いっぱいになったときに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-122">Each leaf page is written as it is filled.</span></span> <span data-ttu-id="f74c0-123">リーフ ページが書き込まれると、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] によりインデックスの上位レベルも構築されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-123">As leaf pages are written, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] also builds the upper levels of the index.</span></span> <span data-ttu-id="f74c0-124">上位レベルの各インデックス ページは、いっぱいになったときに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-124">Each upper level index page is written when it is filled.</span></span>  
  
## <a name="sort_in_tempdb-option"></a><span data-ttu-id="f74c0-125">SORT_IN_TEMPDB オプション</span><span class="sxs-lookup"><span data-stu-id="f74c0-125">SORT_IN_TEMPDB Option</span></span>  
 <span data-ttu-id="f74c0-126">SORT_IN_TEMPDB を OFF (既定値) に設定すると、並べ替え実行結果が出力先のファイル グループに格納されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-126">When SORT_IN_TEMPDB is set to OFF, the default, the sort runs are stored in the destination filegroup.</span></span> <span data-ttu-id="f74c0-127">インデックスを作成する最初のフェーズの間、ベース テーブルのページの読み取りと並べ替え実行結果の書き込みを交互に実行することにより、ディスクの読み書きヘッドがディスクの 1 つの領域から別の領域に移動します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-127">During the first phase of creating the index, the alternating reads of the base table pages and writes of the sort runs move the disk read/write heads from one area of the disk to another.</span></span> <span data-ttu-id="f74c0-128">ヘッドは、データ ページのスキャン時はデータ ページ領域にあります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-128">The heads are in the data page area as the data pages are scanned.</span></span> <span data-ttu-id="f74c0-129">並べ替えバッファーがいっぱいになり、現在の並べ替え実行結果をディスクに書き込む必要があるときに空き領域に移動し、テーブル ページのスキャンを再開するときにデータ ページ領域に戻ります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-129">They move to an area of free space when the sort buffers fill and the current sort run has to be written to disk, and then move back to the data page area as the table page scan is resumed.</span></span> <span data-ttu-id="f74c0-130">読み書きヘッドの移動は、2 番目のフェーズではさらに頻繁に行われます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-130">The read/write head movement is greater in the second phase.</span></span> <span data-ttu-id="f74c0-131">そのとき並べ替え処理では、通常、各並べ替え実行結果領域からの読み取りを繰り返し行っています。</span><span class="sxs-lookup"><span data-stu-id="f74c0-131">At that time the sort process is typically alternating reads from each sort run area.</span></span> <span data-ttu-id="f74c0-132">並べ替え実行結果と新しいインデックス ページは、どちらも出力先のファイル グループに構築されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-132">Both the sort runs and the new index pages are built in the destination filegroup.</span></span> <span data-ttu-id="f74c0-133">つまり、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] は並べ替え実行結果の読み取りを次々に行っていくのと同時に、インデックス エクステントに定期的にジャンプして、新しいインデックス ページがいっぱいになったときに書き込みを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-133">This means that at the same time the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is spreading reads across the sort runs, it has to periodically jump to the index extents to write new index pages as they are filled.</span></span>  
  
 <span data-ttu-id="f74c0-134">SORT_IN_TEMPDB オプションが ON に設定され、 **tempdb** が出力先のファイル グループとは別のディスク セットにある場合は、最初のフェーズの間に、 **tempdb**にある並べ替えの作業領域への書き込みとは異なるディスクでデータ ページの読み取りが行われます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-134">If the SORT_IN_TEMPDB option is set to ON and **tempdb** is on a separate set of disks from the destination filegroup, during the first phase, the reads of the data pages occur on a different disk from the writes to the sort work area in **tempdb**.</span></span> <span data-ttu-id="f74c0-135">つまり、最終インデックスを構築するときの書き込みと同様に、ディスクのデータ キーの読み取りはディスクに対して通常はどちらかといえば連続的に進行し、 **tempdb** ディスクへの書き込みも通常は連続的に行われます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-135">This means the disk reads of the data keys generally continue more serially across the disk, and the writes to the **tempdb** disk also are generally serial, as do the writes to build the final index.</span></span> <span data-ttu-id="f74c0-136">他のユーザーがデータベースを使用していて個別のディスク アドレスにアクセスしている場合でも、SORT_IN_TEMPDB を指定したときの方が、指定しないときよりも一連の読み取りと書き込みが全体的に効率よく実行されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-136">Even if other users are using the database and accessing separate disk addresses, the overall pattern of reads and writes are more efficient when SORT_IN_TEMPDB is specified than when it is not.</span></span>  
  
 <span data-ttu-id="f74c0-137">特に CREATE INDEX 操作が並列に処理されていない場合、SORT_IN_TEMPDB オプションにより、インデックス エクステントの連続性が向上します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-137">The SORT_IN_TEMPDB option may improve the contiguity of index extents, especially if the CREATE INDEX operation is not being processed in parallel.</span></span> <span data-ttu-id="f74c0-138">並べ替えの作業領域のエクステントは、データベース内の位置という点で多少ランダムに解放されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-138">The sort work area extents are freed on a somewhat random basis with regard to their location in the database.</span></span> <span data-ttu-id="f74c0-139">並べ替えの作業領域が出力先のファイル グループに含まれている場合、並べ替えの作業エクステントが解放されたときに、構築時のインデックス構造をエクステントが保持するように要求することで、それらのエクステントを獲得できます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-139">If the sort work areas are contained in the destination filegroup, as the sort work extents are freed, they can be acquired by the requests for extents to hold the index structure as it is built.</span></span> <span data-ttu-id="f74c0-140">この方法では、インデックス エクステントの位置がある程度ランダムになります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-140">This can randomize the locations of the index extents to a degree.</span></span> <span data-ttu-id="f74c0-141">並べ替えのエクステントが **tempdb**内で別々に保持される場合、それらを解放する順序はインデックス エクステントの位置には影響しません。</span><span class="sxs-lookup"><span data-stu-id="f74c0-141">If the sort extents are held separately in **tempdb**, the sequence in which they are freed has no effect on the location of the index extents.</span></span> <span data-ttu-id="f74c0-142">また、中間の並べ替え実行結果が出力先のファイル グループではなく **tempdb** に格納される場合、出力先のファイル グループの空き領域は増加します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-142">Also, when the intermediate sort runs are stored in **tempdb** instead of the destination filegroup, there is more space available in the destination filegroup.</span></span> <span data-ttu-id="f74c0-143">これにより、インデックス エクステントが連続的になる可能性が高くなります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-143">This increases the chances that index extents will be contiguous.</span></span>  
  
 <span data-ttu-id="f74c0-144">SORT_IN_TEMPDB オプションは、現在のステートメントだけに影響します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-144">The SORT_IN_TEMPDB option affects only the current statement.</span></span> <span data-ttu-id="f74c0-145">インデックスが **tempdb**で並べ替えられたかどうかを記録するメタデータはありません。</span><span class="sxs-lookup"><span data-stu-id="f74c0-145">No metadata records that the index was or was not sorted in **tempdb**.</span></span> <span data-ttu-id="f74c0-146">たとえば、SORT_IN_TEMPDB オプションを使用して非クラスター化インデックスを作成してから、このオプションを指定せずにクラスター化インデックスを作成した場合、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] では、非クラスター化インデックスを再作成するときにこのオプションが使用されません。</span><span class="sxs-lookup"><span data-stu-id="f74c0-146">For example, if you create a nonclustered index using the SORT_IN_TEMPDB option, and at a later time create a clustered index without specifying the option, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] does not use the option when it re-creates the nonclustered index.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f74c0-147">並べ替え操作が必要ない場合、または並べ替えをメモリ内で実行できる場合、SORT_IN_TEMPDB オプションは無視されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-147">If a sort operation is not required or if the sort can be performed in memory, the SORT_IN_TEMPDB option is ignored.</span></span>  
  
## <a name="disk-space-requirements"></a><span data-ttu-id="f74c0-148">必要なディスク領域</span><span class="sxs-lookup"><span data-stu-id="f74c0-148">Disk Space Requirements</span></span>  
 <span data-ttu-id="f74c0-149">SORT_IN_TEMPDB オプションを ON に設定する場合は、中間の並べ替え実行結果を保持するのに十分な空きディスク領域が **tempdb** に必要です。また、新しいインデックスを保持するのに十分な空きディスク領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-149">When you set the SORT_IN_TEMPDB option to ON, you must have sufficient free disk space available in **tempdb** to hold the intermediate sort runs, and enough free disk space in the destination filegroup to hold the new index.</span></span> <span data-ttu-id="f74c0-150">空き領域が不足していて、何らかの理由 (ディスク領域不足や、自動拡張が無効になっているなど) でデータベースを自動拡張して空き領域を確保できない場合、CREATE INDEX ステートメントは失敗します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-150">The CREATE INDEX statement fails if there is insufficient free space and there is some reason the databases cannot autogrow to acquire more space, such as no space on the disk or autogrow is set to off.</span></span>  
  
 <span data-ttu-id="f74c0-151">SORT_IN_TEMPDB を OFF に設定する場合は、出力先のファイル グループに、最終インデックスとほぼ同じサイズの使用可能な空きディスク領域が必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-151">If SORT_IN_TEMPDB is set to OFF, the available free disk space in the destination filegroup must be roughly the size of the final index.</span></span> <span data-ttu-id="f74c0-152">最初のフェーズでは、並べ替えの実行結果が構築され、最終インデックスとほぼ同じ量の領域が必要になります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-152">During the first phase, the sort runs are built and require about the same amount of space as the final index.</span></span> <span data-ttu-id="f74c0-153">2 番目のフェーズでは、各並べ替え実行エクステントが、処理された後に解放されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-153">During the second phase, each sort run extent is freed after it has been processed.</span></span> <span data-ttu-id="f74c0-154">つまり、並べ替え実行エクステントは、最終インデックス ページを保持するためにエクステントを獲得するのとほぼ同じ割合で解放されます。したがって、全体的に必要な領域が最終インデックスのサイズを大幅に超えることはありません。</span><span class="sxs-lookup"><span data-stu-id="f74c0-154">This means that sort run extents are freed at about the same rate at which extents are acquired to hold the final index pages; therefore, the overall space requirements do not greatly exceed the size of the final index.</span></span> <span data-ttu-id="f74c0-155">これに伴う影響として、空き領域の大きさが最終インデックスのサイズに非常に近い場合、並べ替え実行エクステントが解放された後、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] により通常はすぐに再利用されます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-155">One side effect of this is that if the amount of free space is very close to the size of the final index, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] will generally reuse the sort run extents very quickly after they are freed.</span></span> <span data-ttu-id="f74c0-156">並べ替え実行エクステントは多少ランダムに解放されるので、この状況ではインデックス エクステントの連続性が低下します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-156">Because the sort run extents are freed in a somewhat random manner, this reduces the continuity of the index extents in this scenario.</span></span> <span data-ttu-id="f74c0-157">SORT_IN_TEMPDB を OFF に設定した場合、出力先のファイル グループに十分な空き領域があり、新たに割り当て解除された並べ替え実行エクステントからではなく連続的なプールからインデックス エクステントを割り当てることができれば、インデックス エクステントの連続性が向上します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-157">If SORT_IN_TEMPDB is set to OFF, the continuity of the index extents is improved if there is sufficient free space available in the destination filegroup that the index extents can be allocated from a contiguous pool instead of from the freshly deallocated sort run extents.</span></span>  
  
 <span data-ttu-id="f74c0-158">非クラスター化インデックスを作成する場合、次のような状況に応じた空き領域が必要になります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-158">When you create a nonclustered index, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="f74c0-159">SORT_IN_TEMPDB を ON に設定した場合は、並べ替え実行結果を格納するのに十分な空き領域が **tempdb** に必要で、最終インデックス構造を格納するのに十分な空き領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-159">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs, and sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="f74c0-160">並べ替え実行結果には、インデックスのリーフ行が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-160">The sort runs contain the leaf rows of the index.</span></span>  
  
-   <span data-ttu-id="f74c0-161">SORT_IN_TEMPDB を OFF に設定した場合は、最終インデックス構造を格納するのに十分な空き領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-161">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final index structure.</span></span> <span data-ttu-id="f74c0-162">インデックス エクステントの連続性は、空き領域が多いほど向上します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-162">The continuity of the index extends may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="f74c0-163">非クラスター化インデックスが格納されていないテーブルにクラスター化インデックスを作成する場合、次のような状況に応じた空き領域が必要になります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-163">When you create a clustered index on a table that does not have nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="f74c0-164">SORT_IN_TEMPDB を ON に設定した場合、並べ替え実行結果を格納するのに十分な空き領域が **tempdb** に必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-164">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs.</span></span> <span data-ttu-id="f74c0-165">これらの並べ替え実行結果には、テーブルのデータ行が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-165">These include the data rows of the table.</span></span> <span data-ttu-id="f74c0-166">また、最終インデックス構造を格納するのに十分な空き領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-166">There must be sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="f74c0-167">最終インデックス構造には、テーブルとインデックス B-Tree のデータ行が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-167">This includes the data rows of the table and the index B-tree.</span></span> <span data-ttu-id="f74c0-168">キー サイズが大きくなることや FILL FACTOR の値が小さくなることなどの要因を考慮して、必要な空き領域の概算値を調整することが必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-168">You may have to adjust the estimate for factors such as having a large key size or a fill factor with a low value.</span></span>  
  
-   <span data-ttu-id="f74c0-169">SORT_IN_TEMPDB を OFF に設定した場合は、最終テーブルを格納するのに十分な空き領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-169">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="f74c0-170">最終テーブルには、インデックス構造が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-170">This includes the index structure.</span></span> <span data-ttu-id="f74c0-171">テーブルとインデックスのエクステントの連続性は空き領域が多いほど向上します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-171">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="f74c0-172">非クラスター化インデックスが格納されているテーブルにクラスター化インデックスを作成する場合、次のような状況に応じた空き領域が必要になります。</span><span class="sxs-lookup"><span data-stu-id="f74c0-172">When you create a clustered index on a table that has nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="f74c0-173">SORT_IN_TEMPDB を ON に設定した場合は、最も大きいインデックス (通常はクラスター化インデックス) の並べ替え実行結果のコレクションを格納するのに十分な空き領域が **tempdb** に必要であり、すべてのインデックスの最終構造を格納するのに十分な空き領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-173">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the collection of sort runs for the largest index, typically the clustered index, and sufficient free space in the destination filegroup to store the final structures of all the indexes.</span></span> <span data-ttu-id="f74c0-174">これには、テーブルのデータ行を格納しているクラスター化インデックスも含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-174">This includes the clustered index that contains the data rows of the table.</span></span>  
  
-   <span data-ttu-id="f74c0-175">SORT_IN_TEMPDB を OFF に設定した場合は、最終テーブルを格納するのに十分な空き領域が出力先のファイル グループに必要です。</span><span class="sxs-lookup"><span data-stu-id="f74c0-175">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="f74c0-176">最終テーブルには、すべてのインデックスの構造が含まれます。</span><span class="sxs-lookup"><span data-stu-id="f74c0-176">This includes the structures of all the indexes.</span></span> <span data-ttu-id="f74c0-177">テーブルとインデックスのエクステントの連続性は空き領域が多いほど向上します。</span><span class="sxs-lookup"><span data-stu-id="f74c0-177">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="f74c0-178">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="f74c0-178">Related Tasks</span></span>  
 [<span data-ttu-id="f74c0-179">CREATE INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="f74c0-179">CREATE INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-index-transact-sql)  
  
 [<span data-ttu-id="f74c0-180">インデックスの再編成と再構築</span><span class="sxs-lookup"><span data-stu-id="f74c0-180">Reorganize and Rebuild Indexes</span></span>](indexes.md)  
  
## <a name="related-content"></a><span data-ttu-id="f74c0-181">関連コンテンツ</span><span class="sxs-lookup"><span data-stu-id="f74c0-181">Related Content</span></span>  
 [<span data-ttu-id="f74c0-182">ALTER INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="f74c0-182">ALTER INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-index-transact-sql)  
  
 [<span data-ttu-id="f74c0-183">index create memory サーバー構成オプションの構成</span><span class="sxs-lookup"><span data-stu-id="f74c0-183">Configure the index create memory Server Configuration Option</span></span>](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md)  
  
 [<span data-ttu-id="f74c0-184">Disk Space Requirements for Index DDL Operations</span><span class="sxs-lookup"><span data-stu-id="f74c0-184">Disk Space Requirements for Index DDL Operations</span></span>](disk-space-requirements-for-index-ddl-operations.md)  
  
  
