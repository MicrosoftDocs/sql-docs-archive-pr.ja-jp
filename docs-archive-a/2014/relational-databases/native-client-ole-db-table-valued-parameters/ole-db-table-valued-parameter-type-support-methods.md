---
title: OLE DB テーブル値パラメーターの型のサポート (メソッド) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (OLE DB), API support (methods)
ms.assetid: e3c2a450-8fd4-44cb-93d8-affe1b65c68e
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c7ca5946228ea05708984fb89ebc603061d983d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634485"
---
# <a name="ole-db-table-valued-parameter-type-support-methods"></a><span data-ttu-id="ef01d-102">OLE DB テーブル値パラメーターの型のサポート (メソッド)</span><span class="sxs-lookup"><span data-stu-id="ef01d-102">OLE DB Table-Valued Parameter Type Support (Methods)</span></span>
  <span data-ttu-id="ef01d-103">次の OLE DB 標準メソッドでは、テーブル値パラメーターがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-103">The following standard OLE DB methods support table-valued parameters:</span></span>  
  
|<span data-ttu-id="ef01d-104">メソッド</span><span class="sxs-lookup"><span data-stu-id="ef01d-104">Method</span></span>|<span data-ttu-id="ef01d-105">テーブル値パラメーターのサポート</span><span class="sxs-lookup"><span data-stu-id="ef01d-105">Table-valued parameter support</span></span>|  
|------------|-------------------------------------|  
|<span data-ttu-id="ef01d-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span><span class="sxs-lookup"><span data-stu-id="ef01d-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span></span>|<span data-ttu-id="ef01d-107">テーブル値パラメーターの型情報がわかっており、その型情報に基づいてテーブル値パラメーターの行セット オブジェクトのインスタンスを作成する場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-107">Used when you know type information of table-valued parameter, and want to instantiate a table-valued parameter rowset object based on the type-information.</span></span><br /><br /> <span data-ttu-id="ef01d-108">詳細については、「[テーブル値パラメーターの行セットの作成](table-valued-parameter-rowset-creation.md)」の「静的なシナリオ」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ef01d-108">For more information, see "Static Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="ef01d-109">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="ef01d-109">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="ef01d-110">テーブル値パラメーターの型情報がわかっておらず、サーバーから取得したメタデータ情報に基づいてテーブル値パラメーターの行セット オブジェクトのインスタンスを作成する場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-110">Used when you do not know the type information of a table-valued parameter, and want to instantiate a table-valued parameter rowset object based on metadata information retrieved from the server.</span></span><br /><br /> <span data-ttu-id="ef01d-111">詳細については、「[テーブル値パラメーターの行セットの作成](table-valued-parameter-rowset-creation.md)」の「動的なシナリオ」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ef01d-111">For more information, see "Dynamic Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="ef01d-112">ISSCommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="ef01d-112">ISSCommandWithParameters::SetParameterInfo</span></span>|<span data-ttu-id="ef01d-113">テーブル値パラメーターのコマンド パラメーターを指定するには、コンシューマーが DBPARAMBINDINFO 構造体の *pwszName* メンバーでパラメーターの型を "table" または "DBTYPE_TABLE" として指定します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-113">To specify a table-valued parameter command parameter, the consumer specifies the type of the parameter as "table" or "DBTYPE_TABLE" in the *pwszName* member of DBPARAMBINDINFO structure.</span></span> <span data-ttu-id="ef01d-114">*ulParamSize* は ~ 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-114">The *ulParamSize* is set to ~0.</span></span> <span data-ttu-id="ef01d-115">詳細については、「[テーブル値パラメーターを含むコマンドの実行](executing-commands-containing-table-valued-parameters.md)」の「テーブル値パラメーターの指定」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ef01d-115">For more information, see "Table-Valued Parameter Specification" in [Executing Commands Containing Table-Valued Parameters](executing-commands-containing-table-valued-parameters.md).</span></span>|  
|<span data-ttu-id="ef01d-116">ISSCommandWithParameters::SetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="ef01d-116">ISSCommandWithParameters::SetParameterProperties</span></span>|<span data-ttu-id="ef01d-117">スキーマ名、型名、列の順序、既定の列など、テーブル値パラメーター固有のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-117">Sets properties specific to table-valued parameters, such as schema name, type name, column order, and default columns.</span></span><br /><br /> <span data-ttu-id="ef01d-118">コンシューマーは、SSPARAMPROPS 構造体の *iOrdinal* でパラメーターの序数を指定します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-118">The consumer specifies the ordinal of the parameter in the *iOrdinal* of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="ef01d-119">要求されるプロパティ セットは DBPROPSET_SQLSERVERPARAMETER です。</span><span class="sxs-lookup"><span data-stu-id="ef01d-119">The property set requested is DBPROPSET_SQLSERVERPARAMETER.</span></span>|  
|<span data-ttu-id="ef01d-120">ISSCommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="ef01d-120">ISSCommandWithParameters::GetParameterInfo</span></span>|<span data-ttu-id="ef01d-121">指定されたコマンドのすべてのパラメーターの型を取得します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-121">Gets the types of all the parameters to a specified command.</span></span><br /><br /> <span data-ttu-id="ef01d-122">テーブル値パラメーターの場合、DBPARAMINFO 構造体の *wType* フィールドの型は DBTYPE_TABLE になります。</span><span class="sxs-lookup"><span data-stu-id="ef01d-122">For table-valued parameters, the *wType* field in DBPARAMINFO structure will have type DBTYPE_TABLE.</span></span> <span data-ttu-id="ef01d-123">不明な長さを示すために、*ulParamSize* フィールドは ~0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-123">The *ulParamSize* field will be set to ~0 to indicate unknown length.</span></span>|  
|<span data-ttu-id="ef01d-124">ISSCommandWithParameters::GetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="ef01d-124">ISSCommandWithParameters::GetParameterProperties</span></span>|<span data-ttu-id="ef01d-125">DBTYPE_TABLE 型のパラメーターの追加の型情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-125">Gets additional type information for parameters of the DBTYPE_TABLE type.</span></span><br /><br /> <span data-ttu-id="ef01d-126">コンシューマーは、SSPARAMPROPS 構造体の *iOrdinal* メンバーでパラメーターの序数を指定します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-126">The consumer specifies the ordinal of the parameter in the *iOrdinal* member of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="ef01d-127">コンシューマーは、ISSCommandWithParameters::SetParameterProperties に一覧表示される DBPROPSET_SQLSERVERPARAMETER プロパティ セットのプロパティを要求できます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-127">The consumer can request any of the properties in the DBPROPSET_SQLSERVERPARAMETER property set that are listed under ISSCommandWithParameters::SetParameterProperties.</span></span><br /><br /> <span data-ttu-id="ef01d-128">コンシューマーではテーブル値パラメーターの型がわからないため、プロバイダーは SSPROP_PARAM_TYPE_TYPENAME、SSPROP_PARAM_TYPE_SCHEMANAME、および SSPROP_PARAM_TYPE_CATALOGNAME に正しい値を設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ef01d-128">Because the consumer does not know the table-valued parameter type, the provider must set the SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME, and SSPROP_PARAM_TYPE_CATALOGNAME to their correct values.</span></span> <span data-ttu-id="ef01d-129">残りのプロパティ、SSPROP_PARAM_TABLE_DEFAULT_COLUMNS および SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER の値は、既定の値になります。</span><span class="sxs-lookup"><span data-stu-id="ef01d-129">The remaining properties, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS and SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, will have their default values.</span></span> <span data-ttu-id="ef01d-130">コンシューマーがテーブル値パラメーターの型名を検出した後、IOpenRowset::OpenRowset を使用して、テーブル値パラメーターの名前を指定してこのテーブル値パラメーターのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-130">After the consumer has discovered the table-valued parameter type name, it uses IOpenRowset::OpenRowset to create an instance of this table-valued parameter, specifying the name of table-valued parameter type.</span></span> <span data-ttu-id="ef01d-131">詳細については、「[テーブル値パラメーターの型探索](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ef01d-131">For more information, see [Table-Valued Parameter Type Discovery](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span></span>|  
|<span data-ttu-id="ef01d-132">IRowsetInfo::GetProperties</span><span class="sxs-lookup"><span data-stu-id="ef01d-132">IRowsetInfo::GetProperties</span></span>|<span data-ttu-id="ef01d-133">テーブル値パラメーターの行セット プロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-133">Gets table-valued parameter rowset properties.</span></span> <span data-ttu-id="ef01d-134">コンシューマーはこれらのプロパティを使用して、バインドを最適に設定することができます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-134">The consumer can use these properties to optimally set up bindings.</span></span>|  
|<span data-ttu-id="ef01d-135">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="ef01d-135">IColumnsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="ef01d-136">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブルに関するメタデータ情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-136">Retrieves metadata information about a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="ef01d-137">テーブル値パラメーターの場合、この同じインターフェイスにより、次のような各列に関する詳細なメタデータ情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-137">For table-valued parameters, this same interface provides detailed metadata information about each column, such as the following:</span></span><br /><br /> <span data-ttu-id="ef01d-138">-DBCOLUMN_FLAGS DBCOLUMNFLAGS_ISNULLABLE ビットで null 値を許容することを示します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-138">-   DBCOLUMN_FLAGS indicates nullability through the DBCOLUMNFLAGS_ISNULLABLE bit.</span></span><br /><span data-ttu-id="ef01d-139">-DBCOLUMN_ISUNIQUE 列が id 列であるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-139">-   DBCOLUMN_ISUNIQUE indicates whether the column is an identity column.</span></span><br /><span data-ttu-id="ef01d-140">-DBCOLUMN_COMPUTEMODE 列が計算されるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-140">-   DBCOLUMN_COMPUTEMODE indicates whether the column is computed.</span></span>|  
|<span data-ttu-id="ef01d-141">IAccessor::CreateAccessor</span><span class="sxs-lookup"><span data-stu-id="ef01d-141">IAccessor::CreateAccessor</span></span>|<span data-ttu-id="ef01d-142">テーブル値パラメーターの行セット オブジェクトをコマンド パラメーターにバインドするには、*wType* メンバーを DBTYPE_TABLE に設定してアクセサーを作成します。</span><span class="sxs-lookup"><span data-stu-id="ef01d-142">To bind a table-valued parameter rowset object to a command parameter, you create an accessor with its *wType* member set to DBTYPE_TABLE.</span></span> <span data-ttu-id="ef01d-143">DBOBJECT 構造体には、IID_IRowset または、*iid* メンバーのその他の有効な行セット オブジェクトのインターフェイスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-143">The DBOBJECT structure will contain IID_IRowset or any other valid rowset object interface in the *iid* member.</span></span> <span data-ttu-id="ef01d-144">フィールドの残りの部分は、DBTYPE_IUNKNOWN と同じように扱われます。</span><span class="sxs-lookup"><span data-stu-id="ef01d-144">The rest of the fields are treated similarly to DBTYPE_IUNKNOWN.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ef01d-145">参照</span><span class="sxs-lookup"><span data-stu-id="ef01d-145">See Also</span></span>  
 <span data-ttu-id="ef01d-146">[OLE DB テーブル値パラメーターの型のサポート](ole-db-table-valued-parameter-type-support.md) </span><span class="sxs-lookup"><span data-stu-id="ef01d-146">[OLE DB Table-Valued Parameter Type Support](ole-db-table-valued-parameter-type-support.md) </span></span>  
 <span data-ttu-id="ef01d-147">[テーブル値パラメーターの行セットの作成](table-valued-parameter-rowset-creation.md) </span><span class="sxs-lookup"><span data-stu-id="ef01d-147">[Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md) </span></span>  
 [<span data-ttu-id="ef01d-148">テーブル値パラメーターの使用 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="ef01d-148">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](table-valued-parameters-ole-db.md)  
  
  
