---
title: パラメーターと行セットのメタデータ | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- metadata [OLE DB]
ms.assetid: 31b318a4-20e7-4db0-b367-eb9938859029
author: rothja
ms.author: jroth
ms.openlocfilehash: f3bddb4d83a8904b3def70853fe1e6614dd48d9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714314"
---
# <a name="parameter-and-rowset-metadata"></a><span data-ttu-id="348fc-102">パラメーターと行セットのメタデータ</span><span class="sxs-lookup"><span data-stu-id="348fc-102">Parameter and Rowset Metadata</span></span>
  <span data-ttu-id="348fc-103">このトピックでは、OLE DB の日付および時刻の機能強化に関連する、次の型と型メンバーについて説明します。</span><span class="sxs-lookup"><span data-stu-id="348fc-103">This topic provides information about the following type and type members, related to the OLE DB date and time enhancements.</span></span>  
  
-   <span data-ttu-id="348fc-104">DBBINDING 構造体</span><span class="sxs-lookup"><span data-stu-id="348fc-104">DBBINDING structure</span></span>  
  
-   `ICommandWithParameters::GetParameterInfo`  
  
-   `ICommandWithParameters::SetParameterInfo`  
  
-   `IColumnsRowset::GetColumnsRowset`  
  
-   `IColumnsInfo::GetColumnInfo`  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="348fc-105">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="348fc-105">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="348fc-106">*prgParamInfo* を使用して DBPARAMINFO 構造体に次の情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="348fc-106">The following information is returned in the DBPARAMINFO structure through *prgParamInfo*:</span></span>  
  
|<span data-ttu-id="348fc-107">パラメーターの型</span><span class="sxs-lookup"><span data-stu-id="348fc-107">Parameter Type</span></span>|<span data-ttu-id="348fc-108">*wType*</span><span class="sxs-lookup"><span data-stu-id="348fc-108">*wType*</span></span>|<span data-ttu-id="348fc-109">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="348fc-109">*ulParamSize*</span></span>|<span data-ttu-id="348fc-110">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="348fc-110">*bPrecision*</span></span>|<span data-ttu-id="348fc-111">*bScale*</span><span class="sxs-lookup"><span data-stu-id="348fc-111">*bScale*</span></span>|<span data-ttu-id="348fc-112">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="348fc-112">*dwFlags*</span></span><br /><br /> <span data-ttu-id="348fc-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="348fc-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="348fc-114">date</span><span class="sxs-lookup"><span data-stu-id="348fc-114">date</span></span>|<span data-ttu-id="348fc-115">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="348fc-115">DBTYPE_DBDATE</span></span>|<span data-ttu-id="348fc-116">6</span><span class="sxs-lookup"><span data-stu-id="348fc-116">6</span></span>|<span data-ttu-id="348fc-117">10</span><span class="sxs-lookup"><span data-stu-id="348fc-117">10</span></span>|<span data-ttu-id="348fc-118">0</span><span class="sxs-lookup"><span data-stu-id="348fc-118">0</span></span>|<span data-ttu-id="348fc-119">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-119">Clear</span></span>|  
|<span data-ttu-id="348fc-120">time</span><span class="sxs-lookup"><span data-stu-id="348fc-120">time</span></span>|<span data-ttu-id="348fc-121">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="348fc-121">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="348fc-122">10</span><span class="sxs-lookup"><span data-stu-id="348fc-122">10</span></span>|<span data-ttu-id="348fc-123">8、10..16</span><span class="sxs-lookup"><span data-stu-id="348fc-123">8, 10..16</span></span>|<span data-ttu-id="348fc-124">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-124">0..7</span></span>|<span data-ttu-id="348fc-125">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-125">Set</span></span>|  
|<span data-ttu-id="348fc-126">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="348fc-126">smalldatetime</span></span>|<span data-ttu-id="348fc-127">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-127">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-128">16</span><span class="sxs-lookup"><span data-stu-id="348fc-128">16</span></span>|<span data-ttu-id="348fc-129">16</span><span class="sxs-lookup"><span data-stu-id="348fc-129">16</span></span>|<span data-ttu-id="348fc-130">0</span><span class="sxs-lookup"><span data-stu-id="348fc-130">0</span></span>|<span data-ttu-id="348fc-131">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-131">Clear</span></span>|  
|<span data-ttu-id="348fc-132">DATETIME</span><span class="sxs-lookup"><span data-stu-id="348fc-132">datetime</span></span>|<span data-ttu-id="348fc-133">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-133">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-134">16</span><span class="sxs-lookup"><span data-stu-id="348fc-134">16</span></span>|<span data-ttu-id="348fc-135">23</span><span class="sxs-lookup"><span data-stu-id="348fc-135">23</span></span>|<span data-ttu-id="348fc-136">3</span><span class="sxs-lookup"><span data-stu-id="348fc-136">3</span></span>|<span data-ttu-id="348fc-137">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-137">Clear</span></span>|  
|<span data-ttu-id="348fc-138">datetime2</span><span class="sxs-lookup"><span data-stu-id="348fc-138">datetime2</span></span>|<span data-ttu-id="348fc-139">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-139">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-140">16</span><span class="sxs-lookup"><span data-stu-id="348fc-140">16</span></span>|<span data-ttu-id="348fc-141">19、21.. 27</span><span class="sxs-lookup"><span data-stu-id="348fc-141">19,21..27</span></span>|<span data-ttu-id="348fc-142">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-142">0..7</span></span>|<span data-ttu-id="348fc-143">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-143">Set</span></span>|  
|<span data-ttu-id="348fc-144">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="348fc-144">datetimeoffset</span></span>|<span data-ttu-id="348fc-145">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="348fc-145">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="348fc-146">20</span><span class="sxs-lookup"><span data-stu-id="348fc-146">20</span></span>|<span data-ttu-id="348fc-147">26、28.. 34</span><span class="sxs-lookup"><span data-stu-id="348fc-147">26,28..34</span></span>|<span data-ttu-id="348fc-148">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-148">0..7</span></span>|<span data-ttu-id="348fc-149">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-149">Set</span></span>|  
  
 <span data-ttu-id="348fc-150">場合によっては、値の範囲が連続していないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="348fc-150">Notice that in some cases value ranges are not continuous.</span></span> <span data-ttu-id="348fc-151">有効桁数が 0 より大きい場合は、小数点が追加されるためです。</span><span class="sxs-lookup"><span data-stu-id="348fc-151">This is due to the addition of a decimal point when fractional precision is greater than zero.</span></span>  
  
 <span data-ttu-id="348fc-152">DBPARAMFLAGS_SS_ISVARIABLESCALE は、[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 以降のサーバーに接続されている場合にのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="348fc-152">DBPARAMFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="348fc-153">下位レベルのサーバーに接続されている場合は、DBPARAMFLAGS_SS_ISVARIABLESCALE は設定されません。</span><span class="sxs-lookup"><span data-stu-id="348fc-153">DBPARAMFLAGS_SS_ISVARIABLESCALE is never set when connected to down-level servers.</span></span>  
  
## <a name="icommandwithparameterssetparameterinfo-and-implied-parameter-types"></a><span data-ttu-id="348fc-154">ICommandWithParameters::SetParameterInfo と暗黙のパラメーターの型</span><span class="sxs-lookup"><span data-stu-id="348fc-154">ICommandWithParameters::SetParameterInfo and Implied Parameter Types</span></span>  
 <span data-ttu-id="348fc-155">DBPARAMBINDINFO 構造体で提供される情報は、次の表に準拠する必要があります。</span><span class="sxs-lookup"><span data-stu-id="348fc-155">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="348fc-156">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="348fc-156">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="348fc-157">(プロバイダー固有)</span><span class="sxs-lookup"><span data-stu-id="348fc-157">(provider specific)</span></span>|<span data-ttu-id="348fc-158">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="348fc-158">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="348fc-159">(OLE DB 汎用)</span><span class="sxs-lookup"><span data-stu-id="348fc-159">(OLE DB generic)</span></span>|<span data-ttu-id="348fc-160">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="348fc-160">*ulParamSize*</span></span>|<span data-ttu-id="348fc-161">*bScale*</span><span class="sxs-lookup"><span data-stu-id="348fc-161">*bScale*</span></span>|  
|----------------------------------------------------|-------------------------------------------------|-------------------|--------------|  
||<span data-ttu-id="348fc-162">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="348fc-162">DBTYPE_DATE</span></span>|<span data-ttu-id="348fc-163">6</span><span class="sxs-lookup"><span data-stu-id="348fc-163">6</span></span>|<span data-ttu-id="348fc-164">無視</span><span class="sxs-lookup"><span data-stu-id="348fc-164">Ignored</span></span>|  
|<span data-ttu-id="348fc-165">date</span><span class="sxs-lookup"><span data-stu-id="348fc-165">date</span></span>|<span data-ttu-id="348fc-166">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="348fc-166">DBTYPE_DBDATE</span></span>|<span data-ttu-id="348fc-167">6</span><span class="sxs-lookup"><span data-stu-id="348fc-167">6</span></span>|<span data-ttu-id="348fc-168">無視</span><span class="sxs-lookup"><span data-stu-id="348fc-168">Ignored</span></span>|  
||<span data-ttu-id="348fc-169">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="348fc-169">DBTYPE_DBTIME</span></span>|<span data-ttu-id="348fc-170">10</span><span class="sxs-lookup"><span data-stu-id="348fc-170">10</span></span>|<span data-ttu-id="348fc-171">無視</span><span class="sxs-lookup"><span data-stu-id="348fc-171">Ignored</span></span>|  
|<span data-ttu-id="348fc-172">time</span><span class="sxs-lookup"><span data-stu-id="348fc-172">time</span></span>|<span data-ttu-id="348fc-173">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="348fc-173">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="348fc-174">10</span><span class="sxs-lookup"><span data-stu-id="348fc-174">10</span></span>|<span data-ttu-id="348fc-175">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-175">0..7</span></span>|  
|<span data-ttu-id="348fc-176">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="348fc-176">smalldatetime</span></span>||<span data-ttu-id="348fc-177">16</span><span class="sxs-lookup"><span data-stu-id="348fc-177">16</span></span>|<span data-ttu-id="348fc-178">無視</span><span class="sxs-lookup"><span data-stu-id="348fc-178">Ignored</span></span>|  
|<span data-ttu-id="348fc-179">DATETIME</span><span class="sxs-lookup"><span data-stu-id="348fc-179">datetime</span></span>||<span data-ttu-id="348fc-180">16</span><span class="sxs-lookup"><span data-stu-id="348fc-180">16</span></span>|<span data-ttu-id="348fc-181">無視</span><span class="sxs-lookup"><span data-stu-id="348fc-181">Ignored</span></span>|  
|<span data-ttu-id="348fc-182">datetime2 または DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-182">datetime2 or DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-183">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-183">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-184">16</span><span class="sxs-lookup"><span data-stu-id="348fc-184">16</span></span>|<span data-ttu-id="348fc-185">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-185">0..7</span></span>|  
|<span data-ttu-id="348fc-186">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="348fc-186">datetimeoffset</span></span>|<span data-ttu-id="348fc-187">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="348fc-187">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="348fc-188">20</span><span class="sxs-lookup"><span data-stu-id="348fc-188">20</span></span>|<span data-ttu-id="348fc-189">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-189">0..7</span></span>|  
  
 <span data-ttu-id="348fc-190">*bPrecision* パラメーターは無視されます。</span><span class="sxs-lookup"><span data-stu-id="348fc-190">The *bPrecision* parameter is ignored.</span></span>  
  
 <span data-ttu-id="348fc-191">データをサーバーに送信する場合、"DBPARAMFLAGS_SS_ISVARIABLESCALE" は無視されます。</span><span class="sxs-lookup"><span data-stu-id="348fc-191">"DBPARAMFLAGS_SS_ISVARIABLESCALE" is ignored when sending data to the server.</span></span> <span data-ttu-id="348fc-192">アプリケーションでは、プロバイダー固有の型名 "`datetime`" および "`smalldatetime`" を使用して、従来の表形式のデータ ストリーム (TDS) の型を強制的に使用することができます。</span><span class="sxs-lookup"><span data-stu-id="348fc-192">Applications can force the use of legacy tabular-data stream (TDS) types by using the provider-specific type names "`datetime`" and "`smalldatetime`".</span></span> <span data-ttu-id="348fc-193">(またはそれ以降) のサーバーに接続されている場合、"" 形式が使用され、必要に応じて、 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] `datetime2` 型名が " `datetime2` " または "DBTYPE_DBTIMESTAMP" である場合は、暗黙的なサーバー変換が行われます。</span><span class="sxs-lookup"><span data-stu-id="348fc-193">When connected to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) servers, "`datetime2`" format will be used and an implicit server conversion will occur, if necessary, when the type name is "`datetime2`" or "DBTYPE_DBTIMESTAMP".</span></span> <span data-ttu-id="348fc-194">*bScale*プロバイダー固有の型名 "" `datetime` または " `smalldatetime` " が使用されている場合、bscale は無視されます。</span><span class="sxs-lookup"><span data-stu-id="348fc-194">*bScale* is ignored if the provider specific type names "`datetime`" or "`smalldatetime`" are used.</span></span> <span data-ttu-id="348fc-195">それ以外の場合は、appications、 *Bscale*が正しく設定されていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="348fc-195">Otherwise, appications must ensure that *bScale* is set correctly.</span></span> <span data-ttu-id="348fc-196">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]"DBTYPE_DBTIMESTAMP" を使用するから MDAC および Native Client からアップグレード [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] されたアプリケーションは、 *bscale*を正しく設定しないと失敗します。</span><span class="sxs-lookup"><span data-stu-id="348fc-196">Applications upgraded from MDAC and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] that use "DBTYPE_DBTIMESTAMP" will fail if they do not set *bScale* correctly.</span></span> <span data-ttu-id="348fc-197">[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] より前のサーバー インスタンスに接続されている場合は、"DBTYPE_DBTIMESTAMP" で 0 または 3 以外に設定された *bScale* の値はエラーになり、E_FAIL が返されます。</span><span class="sxs-lookup"><span data-stu-id="348fc-197">When connected to server instances earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], a *bScale* value other than 0 or 3 with "DBTYPE_DBTIMESTAMP" is an error and E_FAIL will be returned.</span></span>  
  
 <span data-ttu-id="348fc-198">ICommandWithParameters:: SetParameterInfo が呼び出されない場合、プロバイダーは IAccessor:: CreateAccessor に指定されているバインドの種類からサーバーの種類を次のように基します。</span><span class="sxs-lookup"><span data-stu-id="348fc-198">When ICommandWithParameters::SetParameterInfo is not called, the provider imples the server type from the binding type as specified in IAccessor::CreateAccessor as follows:</span></span>  
  
|<span data-ttu-id="348fc-199">バインドの種類</span><span class="sxs-lookup"><span data-stu-id="348fc-199">Binding Type</span></span>|<span data-ttu-id="348fc-200">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="348fc-200">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="348fc-201">(プロバイダー固有)</span><span class="sxs-lookup"><span data-stu-id="348fc-201">(provider specific)</span></span>|  
|------------------|----------------------------------------------------|  
|<span data-ttu-id="348fc-202">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="348fc-202">DBTYPE_DATE</span></span>|<span data-ttu-id="348fc-203">datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="348fc-203">datetime2(0)</span></span>|  
|<span data-ttu-id="348fc-204">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="348fc-204">DBTYPE_DBDATE</span></span>|<span data-ttu-id="348fc-205">date</span><span class="sxs-lookup"><span data-stu-id="348fc-205">date</span></span>|  
|<span data-ttu-id="348fc-206">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="348fc-206">DBTYPE_DBTIME</span></span>|<span data-ttu-id="348fc-207">time(0)</span><span class="sxs-lookup"><span data-stu-id="348fc-207">time(0)</span></span>|  
|<span data-ttu-id="348fc-208">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="348fc-208">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="348fc-209">time(7)</span><span class="sxs-lookup"><span data-stu-id="348fc-209">time(7)</span></span>|  
|<span data-ttu-id="348fc-210">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-210">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-211">datetime2(7)</span><span class="sxs-lookup"><span data-stu-id="348fc-211">datetime2(7)</span></span>|  
|<span data-ttu-id="348fc-212">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="348fc-212">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="348fc-213">datetimeoffset(7)</span><span class="sxs-lookup"><span data-stu-id="348fc-213">datetimeoffset(7)</span></span>|  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="348fc-214">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="348fc-214">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="348fc-215">`IColumnsRowset::GetColumnsRowset` は次の列を返します。</span><span class="sxs-lookup"><span data-stu-id="348fc-215">`IColumnsRowset::GetColumnsRowset` returns the following columns:</span></span>  
  
|<span data-ttu-id="348fc-216">列の型</span><span class="sxs-lookup"><span data-stu-id="348fc-216">Column Type</span></span>|<span data-ttu-id="348fc-217">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="348fc-217">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="348fc-218">DBCOLUM_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="348fc-218">DBCOLUM_COLUMNSIZE</span></span>|<span data-ttu-id="348fc-219">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="348fc-219">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="348fc-220">DBCOLUMN_SCALE、DBCOLUMN_DATETIMEPRECISION</span><span class="sxs-lookup"><span data-stu-id="348fc-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span></span>|<span data-ttu-id="348fc-221">DBCOLUMN_FLAGS、DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="348fc-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span></span>|  
|-----------------|--------------------|-------------------------|-------------------------|--------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="348fc-222">date</span><span class="sxs-lookup"><span data-stu-id="348fc-222">date</span></span>|<span data-ttu-id="348fc-223">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="348fc-223">DBTYPE_DBDATE</span></span>|<span data-ttu-id="348fc-224">6</span><span class="sxs-lookup"><span data-stu-id="348fc-224">6</span></span>|<span data-ttu-id="348fc-225">10</span><span class="sxs-lookup"><span data-stu-id="348fc-225">10</span></span>|<span data-ttu-id="348fc-226">0</span><span class="sxs-lookup"><span data-stu-id="348fc-226">0</span></span>|<span data-ttu-id="348fc-227">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-227">Clear</span></span>|  
|<span data-ttu-id="348fc-228">time</span><span class="sxs-lookup"><span data-stu-id="348fc-228">time</span></span>|<span data-ttu-id="348fc-229">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="348fc-229">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="348fc-230">10</span><span class="sxs-lookup"><span data-stu-id="348fc-230">10</span></span>|<span data-ttu-id="348fc-231">8、10..16</span><span class="sxs-lookup"><span data-stu-id="348fc-231">8, 10..16</span></span>|<span data-ttu-id="348fc-232">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-232">0..7</span></span>|<span data-ttu-id="348fc-233">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-233">Set</span></span>|  
|<span data-ttu-id="348fc-234">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="348fc-234">smalldatetime</span></span>|<span data-ttu-id="348fc-235">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-235">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-236">16</span><span class="sxs-lookup"><span data-stu-id="348fc-236">16</span></span>|<span data-ttu-id="348fc-237">16</span><span class="sxs-lookup"><span data-stu-id="348fc-237">16</span></span>|<span data-ttu-id="348fc-238">0</span><span class="sxs-lookup"><span data-stu-id="348fc-238">0</span></span>|<span data-ttu-id="348fc-239">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-239">Clear</span></span>|  
|<span data-ttu-id="348fc-240">DATETIME</span><span class="sxs-lookup"><span data-stu-id="348fc-240">datetime</span></span>|<span data-ttu-id="348fc-241">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-241">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-242">16</span><span class="sxs-lookup"><span data-stu-id="348fc-242">16</span></span>|<span data-ttu-id="348fc-243">23</span><span class="sxs-lookup"><span data-stu-id="348fc-243">23</span></span>|<span data-ttu-id="348fc-244">3</span><span class="sxs-lookup"><span data-stu-id="348fc-244">3</span></span>|<span data-ttu-id="348fc-245">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-245">Clear</span></span>|  
|<span data-ttu-id="348fc-246">datetime2</span><span class="sxs-lookup"><span data-stu-id="348fc-246">datetime2</span></span>|<span data-ttu-id="348fc-247">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-247">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-248">16</span><span class="sxs-lookup"><span data-stu-id="348fc-248">16</span></span>|<span data-ttu-id="348fc-249">19、21..27</span><span class="sxs-lookup"><span data-stu-id="348fc-249">19, 21..27</span></span>|<span data-ttu-id="348fc-250">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-250">0..7</span></span>|<span data-ttu-id="348fc-251">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-251">Set</span></span>|  
|<span data-ttu-id="348fc-252">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="348fc-252">datetimeoffset</span></span>|<span data-ttu-id="348fc-253">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="348fc-253">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="348fc-254">20</span><span class="sxs-lookup"><span data-stu-id="348fc-254">20</span></span>|<span data-ttu-id="348fc-255">26、28..34</span><span class="sxs-lookup"><span data-stu-id="348fc-255">26, 28..34</span></span>|<span data-ttu-id="348fc-256">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-256">0..7</span></span>|<span data-ttu-id="348fc-257">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-257">Set</span></span>|  
  
 <span data-ttu-id="348fc-258">DBCOLUMN_FLAGS では、DBCOLUMNFLAGS_ISFIXEDLENGTH は日付/時刻型に対して常に true になり、次のフラグは常に false になります。</span><span class="sxs-lookup"><span data-stu-id="348fc-258">In DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="348fc-259">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="348fc-259">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="348fc-260">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="348fc-260">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="348fc-261">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="348fc-261">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="348fc-262">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="348fc-262">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="348fc-263">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="348fc-263">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="348fc-264">DBCOLUMNFLAGS_ISROWVER</span><span class="sxs-lookup"><span data-stu-id="348fc-264">DBCOLUMNFLAGS_ISROWVER</span></span>  
  
-   <span data-ttu-id="348fc-265">DBCOLUMNFLAGS_MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="348fc-265">DBCOLUMNFLAGS_MAYDEFER</span></span>  
  
 <span data-ttu-id="348fc-266">その他のフラグ (DBCOLUMNFLAGS_ISNULLABLE、DBCOLUMNFLAGS_MAYBENULL、DBCOLUMNFLAGS_WRITE、および DBCOLUMNFLAGS_WRITEUNKNOWN) は、列の定義方法と実際のクエリに応じて設定できます。</span><span class="sxs-lookup"><span data-stu-id="348fc-266">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set, depending on how the column is defined and the actual query.</span></span>  
  
 <span data-ttu-id="348fc-267">DBCOLUMN_FLAGS に用意されている新しいフラグ DBCOLUMNFLAGS_SS_ISVARIABLESCALE を使用すると、アプリケーションは、DBCOLUMN_TYPE が DBTYPE_DBTIMESTAMP である列のサーバーの種類を判断できます。</span><span class="sxs-lookup"><span data-stu-id="348fc-267">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in DBCOLUMN_FLAGS to allow an application to determine the server type of columns, where DBCOLUMN_TYPE is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="348fc-268">サーバーの種類を識別するには、DBCOLUMN_SCALE または DBCOLUMN_DATETIMEPRECISION も使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="348fc-268">DBCOLUMN_SCALE or DBCOLUMN_DATETIMEPRECISION must also be used to identify the server type.</span></span>  
  
 <span data-ttu-id="348fc-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE は [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 以降のサーバーに接続されている場合にのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="348fc-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="348fc-270">下位レベルのサーバーに接続されている場合、DBCOLUMNFLAGS_SS_ISVARIABLESCALE は未定義となります。</span><span class="sxs-lookup"><span data-stu-id="348fc-270">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is undefined when connected to down-level servers.</span></span>  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="348fc-271">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="348fc-271">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="348fc-272">DBCOLUMNINFO 構造体から次の情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="348fc-272">DBCOLUMNINFO structure returns the following information:</span></span>  
  
|<span data-ttu-id="348fc-273">パラメーターの型</span><span class="sxs-lookup"><span data-stu-id="348fc-273">Parameter Type</span></span>|<span data-ttu-id="348fc-274">*wType*</span><span class="sxs-lookup"><span data-stu-id="348fc-274">*wType*</span></span>|<span data-ttu-id="348fc-275">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="348fc-275">*ulColumnSize*</span></span>|<span data-ttu-id="348fc-276">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="348fc-276">*bPrecision*</span></span>|<span data-ttu-id="348fc-277">*bScale*</span><span class="sxs-lookup"><span data-stu-id="348fc-277">*bScale*</span></span>|<span data-ttu-id="348fc-278">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="348fc-278">*dwFlags*</span></span><br /><br /> <span data-ttu-id="348fc-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="348fc-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="348fc-280">date</span><span class="sxs-lookup"><span data-stu-id="348fc-280">date</span></span>|<span data-ttu-id="348fc-281">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="348fc-281">DBTYPE_DBDATE</span></span>|<span data-ttu-id="348fc-282">6</span><span class="sxs-lookup"><span data-stu-id="348fc-282">6</span></span>|<span data-ttu-id="348fc-283">10</span><span class="sxs-lookup"><span data-stu-id="348fc-283">10</span></span>|<span data-ttu-id="348fc-284">0</span><span class="sxs-lookup"><span data-stu-id="348fc-284">0</span></span>|<span data-ttu-id="348fc-285">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-285">Clear</span></span>|  
|<span data-ttu-id="348fc-286">time(1..7)</span><span class="sxs-lookup"><span data-stu-id="348fc-286">time(1..7)</span></span>|<span data-ttu-id="348fc-287">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="348fc-287">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="348fc-288">10</span><span class="sxs-lookup"><span data-stu-id="348fc-288">10</span></span>|<span data-ttu-id="348fc-289">8、10..16</span><span class="sxs-lookup"><span data-stu-id="348fc-289">8, 10..16</span></span>|<span data-ttu-id="348fc-290">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-290">0..7</span></span>|<span data-ttu-id="348fc-291">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-291">Set</span></span>|  
|<span data-ttu-id="348fc-292">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="348fc-292">smalldatetime</span></span>|<span data-ttu-id="348fc-293">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-293">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-294">16</span><span class="sxs-lookup"><span data-stu-id="348fc-294">16</span></span>|<span data-ttu-id="348fc-295">16</span><span class="sxs-lookup"><span data-stu-id="348fc-295">16</span></span>|<span data-ttu-id="348fc-296">0</span><span class="sxs-lookup"><span data-stu-id="348fc-296">0</span></span>|<span data-ttu-id="348fc-297">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-297">Clear</span></span>|  
|<span data-ttu-id="348fc-298">DATETIME</span><span class="sxs-lookup"><span data-stu-id="348fc-298">datetime</span></span>|<span data-ttu-id="348fc-299">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-299">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-300">16</span><span class="sxs-lookup"><span data-stu-id="348fc-300">16</span></span>|<span data-ttu-id="348fc-301">23</span><span class="sxs-lookup"><span data-stu-id="348fc-301">23</span></span>|<span data-ttu-id="348fc-302">3</span><span class="sxs-lookup"><span data-stu-id="348fc-302">3</span></span>|<span data-ttu-id="348fc-303">Clear</span><span class="sxs-lookup"><span data-stu-id="348fc-303">Clear</span></span>|  
|<span data-ttu-id="348fc-304">datetime2</span><span class="sxs-lookup"><span data-stu-id="348fc-304">datetime2</span></span>|<span data-ttu-id="348fc-305">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="348fc-305">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="348fc-306">16</span><span class="sxs-lookup"><span data-stu-id="348fc-306">16</span></span>|<span data-ttu-id="348fc-307">19、21..27</span><span class="sxs-lookup"><span data-stu-id="348fc-307">19, 21..27</span></span>|<span data-ttu-id="348fc-308">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-308">0..7</span></span>|<span data-ttu-id="348fc-309">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-309">Set</span></span>|  
|<span data-ttu-id="348fc-310">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="348fc-310">datetimeoffset</span></span>|<span data-ttu-id="348fc-311">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="348fc-311">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="348fc-312">20</span><span class="sxs-lookup"><span data-stu-id="348fc-312">20</span></span>|<span data-ttu-id="348fc-313">26、28..34</span><span class="sxs-lookup"><span data-stu-id="348fc-313">26, 28..34</span></span>|<span data-ttu-id="348fc-314">0..7</span><span class="sxs-lookup"><span data-stu-id="348fc-314">0..7</span></span>|<span data-ttu-id="348fc-315">オン</span><span class="sxs-lookup"><span data-stu-id="348fc-315">Set</span></span>|  
  
 <span data-ttu-id="348fc-316">*dwFlags* では、DBCOLUMNFLAGS_ISFIXEDLENGTH は日付/時刻型に対して常に true になり、次のフラグは常に false になります。</span><span class="sxs-lookup"><span data-stu-id="348fc-316">In *dwFlags*, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="348fc-317">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="348fc-317">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="348fc-318">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="348fc-318">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="348fc-319">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="348fc-319">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="348fc-320">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="348fc-320">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="348fc-321">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="348fc-321">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="348fc-322">DBCOLUMNFLAGS_ISROWVER、MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="348fc-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span></span>  
  
 <span data-ttu-id="348fc-323">その他のフラグ (DBCOLUMNFLAGS_ISNULLABLE、DBCOLUMNFLAGS_MAYBENULL、DBCOLUMNFLAGS_WRITE、および DBCOLUMNFLAGS_WRITEUNKNOWN) は、設定することができます。</span><span class="sxs-lookup"><span data-stu-id="348fc-323">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set.</span></span>  
  
 <span data-ttu-id="348fc-324">*dwFlags* に用意されている新しいフラグ DBCOLUMNFLAGS_SS_ISVARIABLESCALE を使用すると、アプリケーションは、*wType* が DBTYPE_DBTIMESTAMP である列のサーバーの種類を判断できます。</span><span class="sxs-lookup"><span data-stu-id="348fc-324">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in *dwFlags* to allow an application to determine the server type of columns, where *wType* is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="348fc-325">サーバーの種類を識別するには、*bScale* も使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="348fc-325">*bScale* must also be used to identify the server type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="348fc-326">参照</span><span class="sxs-lookup"><span data-stu-id="348fc-326">See Also</span></span>  
 [<span data-ttu-id="348fc-327">メタデータ &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="348fc-327">Metadata &#40;OLE DB&#41;</span></span>](../../database-engine/dev-guide/metadata-ole-db.md)  
  
  
