---
title: SQL Server テーブルの作成 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- tables [OLE DB]
- SQL Server Native Client OLE DB provider, tables
- DBCOLUMNDESC usage
- adding tables
- CreateTable function
ms.assetid: a7b8d142-d76a-44d9-a583-86ac5109fbe8
author: rothja
ms.author: jroth
ms.openlocfilehash: 7b3d11a26c2f5d27f28a60effdb26978edd07409
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87642054"
---
# <a name="creating-sql-server-tables"></a><span data-ttu-id="67ae8-102">SQL Server テーブルの作成</span><span class="sxs-lookup"><span data-stu-id="67ae8-102">Creating SQL Server Tables</span></span>
  <span data-ttu-id="67ae8-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、 **Itabledefinition:: CreateTable**関数を公開し、コンシューマーがテーブルを作成できるようにし [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider exposes the **ITableDefinition::CreateTable** function, allowing consumers to create [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="67ae8-104">コンシューマーは**CreateTable**を使用して、コンシューマーという名前のパーマネントテーブル、および Native Client OLE DB プロバイダーによって生成された一意の名前を持つパーマネントテーブルまたは一時テーブルを作成し [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-104">Consumers use **CreateTable** to create consumer-named permanent tables, and permanent or temporary tables with unique names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
 <span data-ttu-id="67ae8-105">コンシューマーが**Itabledefinition:: CreateTable**を呼び出すと、DBPROP_TBL_TEMPTABLE プロパティの値が VARIANT_TRUE 場合、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって、コンシューマーの一時テーブル名が生成されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-105">When the consumer calls **ITableDefinition::CreateTable**, if the value of the DBPROP_TBL_TEMPTABLE property is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="67ae8-106">コンシューマーは、**CreateTable** メソッドの *pTableID* パラメーターに NULL を設定します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-106">The consumer sets the *pTableID* parameter of the **CreateTable** method to NULL.</span></span> <span data-ttu-id="67ae8-107">Native Client OLE DB プロバイダーによって生成された名前を持つ一時テーブルは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **tables**行セットには表示されませんが、 **IOpenRowset**インターフェイスを使用してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-107">The temporary tables with names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider do not appear in the **TABLES** rowset, but are accessible through the **IOpenRowset** interface.</span></span>  
  
 <span data-ttu-id="67ae8-108">*Ptableid*パラメーターの*uName*共用体の*pwszName*メンバーにテーブル名を指定すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] その名前のテーブルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-108">When consumers specify the table name in the *pwszName* member of the *uName* union in the *pTableID* parameter, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with that name.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="67ae8-109">テーブルの名前付けに関する制約が適用されるので、そのテーブル名で、パーマネント テーブル、ローカル一時テーブルまたはグローバル一時テーブルのいずれであるかを示すことができます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-109">table naming constraints apply, and the table name can indicate a permanent table, or either a local or global temporary table.</span></span> <span data-ttu-id="67ae8-110">詳細については、「[CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="67ae8-110">For more information, see [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql).</span></span> <span data-ttu-id="67ae8-111">*ppTableID* パラメーターには NULL を指定できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-111">The *ppTableID* parameter can be NULL.</span></span>  
  
 <span data-ttu-id="67ae8-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、パーマネントテーブルまたは一時テーブルの名前を生成できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-112">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider can generate the names of permanent or temporary tables.</span></span> <span data-ttu-id="67ae8-113">コンシューマーが*Ptableid*パラメーターを NULL に設定し、有効な dbid を指すように*pptableid*を設定した場合 \* 、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーは、 *Pptableid*の値が指す DBID の*uName*共用体の*pwszName*メンバー内にあるテーブルの生成された名前を返します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-113">When the consumer sets the *pTableID* parameter to NULL and sets *ppTableID* to point to a valid DBID\*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns the generated name of the table in the *pwszName* member of the *uName* union of the DBID pointed to by the value of *ppTableID*.</span></span> <span data-ttu-id="67ae8-114">Native Client OLE DB プロバイダーの名前付きテーブルを一時的に作成するには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] *rgPropertySets*パラメーターで参照されているテーブルプロパティセットに DBPROP_TBL_TEMPTABLE OLE DB table プロパティをコンシューマーに含めます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-114">To create a temporary, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider-named table, the consumer includes the OLE DB table property DBPROP_TBL_TEMPTABLE in a table property set referenced in the *rgPropertySets* parameter.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="67ae8-115">Native Client OLE DB プロバイダーの名前付き一時テーブルはローカルです。</span><span class="sxs-lookup"><span data-stu-id="67ae8-115">Native Client OLE DB provider-named temporary tables are local.</span></span>  
  
 <span data-ttu-id="67ae8-116">*pTableID* パラメーターの *eKind* メンバーに DBKIND_NAME を指定しないと、**CreateTable** では DB_E_BADTABLEID が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-116">**CreateTable** returns DB_E_BADTABLEID if the *eKind* member of the *pTableID* parameter does not indicate DBKIND_NAME.</span></span>  
  
## <a name="dbcolumndesc-usage"></a><span data-ttu-id="67ae8-117">DBCOLUMNDESC の使用方法</span><span class="sxs-lookup"><span data-stu-id="67ae8-117">DBCOLUMNDESC Usage</span></span>  
 <span data-ttu-id="67ae8-118">コンシューマーは、*pwszTypeName* メンバーまたは *wType* メンバーのいずれかを使用して、列のデータ型を指定できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-118">The consumer can indicate a column data type by using either the *pwszTypeName* member or the *wType* member.</span></span> <span data-ttu-id="67ae8-119">コンシューマーが*pwszTypeName*でデータ型を指定した場合、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーは*wtype*の値を無視します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-119">If the consumer specifies the data type in *pwszTypeName*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider ignores the value of *wType*.</span></span>  
  
 <span data-ttu-id="67ae8-120">*pwszTypeName* メンバーを使用する場合、コンシューマーでは、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のデータ型名を使用してデータ型が指定されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-120">If using the *pwszTypeName* member, the consumer specifies the data type by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type names.</span></span> <span data-ttu-id="67ae8-121">有効なデータ型名は、PROVIDER_TYPES スキーマの行セットの TYPE_NAME 列に返されるデータ型名です。</span><span class="sxs-lookup"><span data-stu-id="67ae8-121">Valid data type names are those returned in the TYPE_NAME column of the PROVIDER_TYPES schema rowset.</span></span>  
  
 <span data-ttu-id="67ae8-122">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、 *wtype*メンバーで OLE DB 列挙型の DBTYPE 値のサブセットを認識します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-122">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider recognizes a subset of OLE DB-enumerated DBTYPE values in the *wType* member.</span></span> <span data-ttu-id="67ae8-123">詳しくは、「[ITableDefinition でのデータ型のマッピング](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ae8-123">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="67ae8-124">列データ型を指定するためにコンシューマーが *pTypeInfo* または *pclsid* メンバーのいずれかを設定すると、**CreateTable** では DB_E_BADTYPE が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-124">**CreateTable** returns DB_E_BADTYPE if consumer sets either the *pTypeInfo* or *pclsid* member to specify the column data type.</span></span>  
  
 <span data-ttu-id="67ae8-125">コンシューマーは、DBCOLUMNDESC *dbcid* メンバーの *uName* 共用体の *pwszName* メンバーに列名を指定します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-125">The consumer specifies the column name in the *pwszName* member of the *uName* union of the DBCOLUMNDESC *dbcid* member.</span></span> <span data-ttu-id="67ae8-126">列名は Unicode 文字列として指定されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-126">The column name is specified as a Unicode character string.</span></span> <span data-ttu-id="67ae8-127">*dbcid* の *eKind* メンバーには、DBKIND_NAME を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ae8-127">The *eKind* member of *dbcid* must be DBKIND_NAME.</span></span> <span data-ttu-id="67ae8-128">*eKind* が無効、または *pwszName* が NULL、あるいは *pwszName* の値が有効な [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ID ではない場合、**CreateTable** では DB_E_BADCOLUMNID が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-128">**CreateTable** returns DB_E_BADCOLUMNID if *eKind* is invalid, *pwszName* is NULL, or if the value of *pwszName* is not a valid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identifier.</span></span>  
  
 <span data-ttu-id="67ae8-129">列のすべてのプロパティは、テーブルに定義されたすべての列で使用できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-129">All column properties are available on all columns defined for the table.</span></span> <span data-ttu-id="67ae8-130">プロパティ値の設定が競合していると、**CreateTable** では DB_S_ERRORSOCCURRED または DB_E_ERRORSOCCURRED が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-130">**CreateTable** can return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED if property values are set in conflict.</span></span> <span data-ttu-id="67ae8-131">無効な列プロパティを設定したことで [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブルの作成に失敗した場合、**CreateTable** ではエラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-131">**CreateTable** returns an error when invalid column property settings cause [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table-creation failure.</span></span>  
  
 <span data-ttu-id="67ae8-132">DBCOLUMNDESC の列プロパティは、次のように解釈されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-132">Column properties in a DBCOLUMNDESC are interpreted as follows.</span></span>  
  
|<span data-ttu-id="67ae8-133">プロパティ ID</span><span class="sxs-lookup"><span data-stu-id="67ae8-133">Property ID</span></span>|<span data-ttu-id="67ae8-134">説明</span><span class="sxs-lookup"><span data-stu-id="67ae8-134">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="67ae8-135">DBPROP_COL_AUTOINCREMENT</span><span class="sxs-lookup"><span data-stu-id="67ae8-135">DBPROP_COL_AUTOINCREMENT</span></span>|<span data-ttu-id="67ae8-136">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-136">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-137">既定値 : VARIANT_FALSE&lt;br&gt;&lt;/br&gt;説明 : 作成された列に ID プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-137">Default: VARIANT_FALSE Description: Sets the identity property on the column created.</span></span> <span data-ttu-id="67ae8-138">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では、ID プロパティをテーブル内の 1 つの列に設定できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-138">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the identity property is valid for a single column within a table.</span></span> <span data-ttu-id="67ae8-139">複数の列に対してプロパティを VARIANT_TRUE に設定すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーがサーバー上にテーブルを作成しようとするとエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-139">Setting the property to VARIANT_TRUE for more than a single column generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="67ae8-140">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の ID プロパティは、**integer** 型、**numeric** 型、および小数点以下桁数が 0 の **decimal** 型の場合のみ有効です。</span><span class="sxs-lookup"><span data-stu-id="67ae8-140">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property is only valid for the **integer**, **numeric**, and **decimal** types when the scale is 0.</span></span> <span data-ttu-id="67ae8-141">その他のデータ型の列でプロパティを VARIANT_TRUE に設定すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーがサーバー上にテーブルを作成しようとするとエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-141">Setting the property to VARIANT_TRUE on a column of any other data type generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="67ae8-142">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、DBPROP_COL_AUTOINCREMENT と DBPROP_COL_NULLABLE が両方 VARIANT_TRUE で、DBPROP_COL_NULLABLE の*dwoption*が DBPROPOPTIONS_REQUIRED ない場合に DB_S_ERRORSOCCURRED を返します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-142">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE is not DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="67ae8-143">DBPROP_COL_AUTOINCREMENT と DBPROP_COL_NULLABLE の両方が VARIANT_TRUE で、DBPROP_COL_NULLABLE の *dwOption* が DBPROPOPTIONS_REQUIRED の場合、DB_E_ERRORSOCCURRED が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-143">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="67ae8-144">列は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の ID プロパティで定義され、DBPROP_COL_NULLABLE の *dwStatus* メンバーが DBPROPSTATUS_CONFLICTING に設定されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-144">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span>|  
|<span data-ttu-id="67ae8-145">DBPROP_COL_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="67ae8-145">DBPROP_COL_DEFAULT</span></span>|<span data-ttu-id="67ae8-146">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-146">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-147">既定値: なし</span><span class="sxs-lookup"><span data-stu-id="67ae8-147">Default: None</span></span><br /><br /> <span data-ttu-id="67ae8-148">説明 : 列に対して [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の DEFAULT 制約を作成します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-148">Description: Creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DEFAULT constraint for the column.</span></span><br /><br /> <span data-ttu-id="67ae8-149">DBPROP の *vValue* メンバーには、さまざまなデータ型のいずれかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-149">The *vValue* DBPROP member can be any of a number of types.</span></span> <span data-ttu-id="67ae8-150">*vValue.vt* メンバーでは、列のデータ型と互換性のある型を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ae8-150">The *vValue.vt* member should specify a type compatible with the data type of the column.</span></span> <span data-ttu-id="67ae8-151">たとえば、DBTYPE_WSTR で定義された列の既定値として BSTR N/A を定義した場合は互換性の要件が満たされます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-151">For example, defining BSTR N/A as the default value for a column defined as DBTYPE_WSTR is a compatible match.</span></span> <span data-ttu-id="67ae8-152">DBTYPE_R8 として定義された列で同じ既定値を定義 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] すると、Native Client OLE DB プロバイダーがサーバー上にテーブルを作成しようとするとエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-152">Defining the same default on a column defined as DBTYPE_R8 generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span>|  
|<span data-ttu-id="67ae8-153">DBPROP_COL_DESCRIPTION</span><span class="sxs-lookup"><span data-stu-id="67ae8-153">DBPROP_COL_DESCRIPTION</span></span>|<span data-ttu-id="67ae8-154">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-154">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-155">既定値: なし</span><span class="sxs-lookup"><span data-stu-id="67ae8-155">Default: None</span></span><br /><br /> <span data-ttu-id="67ae8-156">説明: DBPROP_COL_DESCRIPTION 列プロパティは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって実装されていません。</span><span class="sxs-lookup"><span data-stu-id="67ae8-156">Description: The DBPROP_COL_DESCRIPTION column property is not implemented by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="67ae8-157">コンシューマーがこのプロパティ値の書き込みを試みた時点で、DBPROP 構造体の *dwStatus* メンバーは DBPROPSTATUS_NOTSUPPORTED を返します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-157">The *dwStatus* member of the DBPROP structure returns DBPROPSTATUS_NOTSUPPORTED when the consumer attempts to write the property value.</span></span><br /><br /> <span data-ttu-id="67ae8-158">プロパティを設定しても、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーにとって致命的なエラーは発生しません。</span><span class="sxs-lookup"><span data-stu-id="67ae8-158">Setting the property does not constitute a fatal error for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="67ae8-159">他のすべてのパラメーター値が有効であれば、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のテーブルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-159">If all other parameter values are valid, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table is created.</span></span>|  
|<span data-ttu-id="67ae8-160">DBPROP_COL_FIXEDLENGTH</span><span class="sxs-lookup"><span data-stu-id="67ae8-160">DBPROP_COL_FIXEDLENGTH</span></span>|<span data-ttu-id="67ae8-161">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-161">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-162">既定値はVARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="67ae8-162">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="67ae8-163">説明: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーは、DBCOLUMNDESC の*wtype*メンバーを使用して、コンシューマーが列のデータ型を定義するときに、DBPROP_COL_FIXEDLENGTH を使用してデータ型マッピングを決定します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-163">Description: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses DBPROP_COL_FIXEDLENGTH to determine data type-mapping when the consumer defines a column's data type by using the *wType* member of the DBCOLUMNDESC.</span></span> <span data-ttu-id="67ae8-164">詳しくは、「[ITableDefinition でのデータ型のマッピング](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ae8-164">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>|  
|<span data-ttu-id="67ae8-165">DBPROP_COL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="67ae8-165">DBPROP_COL_NULLABLE</span></span>|<span data-ttu-id="67ae8-166">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-166">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-167">既定値: なし</span><span class="sxs-lookup"><span data-stu-id="67ae8-167">Default: None</span></span><br /><br /> <span data-ttu-id="67ae8-168">説明: テーブルを作成するときに、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーは、プロパティが設定されている場合に列が null 値を受け入れるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-168">Description: When creating the table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider indicates whether the column should accept null values if the property is set.</span></span> <span data-ttu-id="67ae8-169">このプロパティが設定されていないときは、列が値として NULL を許容するかどうかは、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の既定のデータベース オプション ANSI_NULLS によって決まります。</span><span class="sxs-lookup"><span data-stu-id="67ae8-169">When the property is not set, the ability of the column to accept NULL as a value is determined by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ANSI_NULLS default database option.</span></span><br /><br /> <span data-ttu-id="67ae8-170">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、ISO に準拠しているプロバイダーです。</span><span class="sxs-lookup"><span data-stu-id="67ae8-170">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider is an ISO-compliant provider.</span></span> <span data-ttu-id="67ae8-171">接続されたセッションでは、ISO 準拠の動作が行われます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-171">Connected sessions exhibit ISO behaviors.</span></span> <span data-ttu-id="67ae8-172">DBPROP_COL_NULLABLE を設定しないと、列は NULL 値を許容します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-172">If the consumer does not set DBPROP_COL_NULLABLE, columns accept null values.</span></span>|  
|<span data-ttu-id="67ae8-173">DBPROP_COL_PRIMARYKEY</span><span class="sxs-lookup"><span data-stu-id="67ae8-173">DBPROP_COL_PRIMARYKEY</span></span>|<span data-ttu-id="67ae8-174">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-174">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-175">既定値: VARIANT_FALSE 説明: VARIANT_TRUE すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって、PRIMARY KEY 制約を持つ列が作成されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-175">Default: VARIANT_FALSE Description: When VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates the column with a PRIMARY KEY constraint.</span></span><br /><br /> <span data-ttu-id="67ae8-176">列プロパティとして定義するときは、1 つの列だけが制約を判断できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-176">When defined as a column property, only a single column can determine the constraint.</span></span> <span data-ttu-id="67ae8-177">複数の列に対してプロパティ VARIANT_TRUE を設定すると、Native Client OLE DB プロバイダーがテーブルを作成しようとするとエラーが返され [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-177">Setting the property VARIANT_TRUE for more than a single column returns an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span><br /><br /> <span data-ttu-id="67ae8-178">注: コンシューマーは **IIndexDefinition::CreateIndex** を使用して、2 つ以上の列に PRIMARY KEY 制約を作成できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-178">Note: The consumer can use **IIndexDefinition::CreateIndex** to create a PRIMARY KEY constraint on two or more columns.</span></span><br /><br /> <span data-ttu-id="67ae8-179">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、DBPROP_COL_PRIMARYKEY と DBPROP_COL_UNIQUE が両方 VARIANT_TRUE で、DBPROP_COL_UNIQUE の*dwoption*が DBPROPOPTIONS_REQUIRED ない場合に DB_S_ERRORSOCCURRED を返します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-179">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="67ae8-180">DBPROP_COL_PRIMARYKEY と DBPROP_COL_UNIQUE の両方が VARIANT_TRUE で、DBPROP_COL_UNIQUE の *dwOption* が DBPROPOPTIONS_REQUIRED の場合、DB_E_ERRORSOCCURRED が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-180">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="67ae8-181">列は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の ID プロパティで定義され、DBPROP_COL_PRIMARYKEY の *dwStatus* メンバーが DBPROPSTATUS_CONFLICTING に設定されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-181">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="67ae8-182">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]DBPROP_COL_PRIMARYKEY と DBPROP_COL_NULLABLE の両方が VARIANT_TRUE 場合、Native Client OLE DB プロバイダーからエラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-182">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error when DBPROP_COL_PRIMARYKEY and DBPROP_COL_NULLABLE are both VARIANT_TRUE.</span></span><br /><br /> <span data-ttu-id="67ae8-183">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コンシューマーが無効なデータ型の列に PRIMARY KEY 制約を作成しようとすると、からエラーを返し [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-183">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a PRIMARY KEY constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="67ae8-184">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の **bit**、**text**、**ntext**、および **image** データ型で作成した列には、PRIMARY KEY 制約を定義できません。</span><span class="sxs-lookup"><span data-stu-id="67ae8-184">PRIMARY KEY constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types **bit**, **text**, **ntext**, and **image**.</span></span>|  
|<span data-ttu-id="67ae8-185">DBPROP_COL_UNIQUE</span><span class="sxs-lookup"><span data-stu-id="67ae8-185">DBPROP_COL_UNIQUE</span></span>|<span data-ttu-id="67ae8-186">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-186">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-187">既定値 : VARIANT_FALSE&lt;br&gt;&lt;/br&gt;説明 : 列に [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の UNIQUE 制約を適用します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-187">Default: VARIANT_FALSE Description: Applies a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UNIQUE constraint to the column.</span></span><br /><br /> <span data-ttu-id="67ae8-188">列プロパティとして定義するときは、1 つの列だけに制約が適用されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-188">When defined as a column property, the constraint is applied on a single column only.</span></span> <span data-ttu-id="67ae8-189">コンシューマーは **IIndexDefinition::CreateIndex** を使用して、2 つ以上の列の組み合わせ値に UNIQUE 制約を適用できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-189">The consumer can use **IIndexDefinition::CreateIndex** to apply a UNIQUE constraint on the combined values of two or more columns.</span></span><br /><br /> <span data-ttu-id="67ae8-190">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、DBPROP_COL_PRIMARYKEY と DBPROP_COL_UNIQUE が両方 VARIANT_TRUE で、 *dwoption*が DBPROPOPTIONS_REQUIRED ない場合に DB_S_ERRORSOCCURRED を返します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-190">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="67ae8-191">DBPROP_COL_PRIMARYKEY と DBPROP_COL_UNIQUE の両方が VARIANT_TRUE で、*dwOption* が DBPROPOPTIONS_REQUIRED の場合、DB_E_ERRORSOCCURRED が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-191">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="67ae8-192">列は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の ID プロパティで定義され、DBPROP_COL_PRIMARYKEY の *dwStatus* メンバーが DBPROPSTATUS_CONFLICTING に設定されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-192">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="67ae8-193">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、DBPROP_COL_NULLABLE と DBPROP_COL_UNIQUE が両方 VARIANT_TRUE で、 *dwoption*が DBPROPOPTIONS_REQUIRED ない場合に DB_S_ERRORSOCCURRED を返します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-193">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="67ae8-194">DBPROP_COL_NULLABLE と DBPROP_COL_UNIQUE の両方が VARIANT_TRUE で、*dwOption* が DBPROPOPTIONS_REQUIRED の場合、DB_E_ERRORSOCCURRED が返されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-194">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="67ae8-195">列は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の ID プロパティで定義され、DBPROP_COL_NULLABLE の *dwStatus* メンバーが DBPROPSTATUS_CONFLICTING に設定されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-195">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="67ae8-196">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コンシューマーが無効なデータ型の列に対して UNIQUE 制約を作成しようとすると、からエラーを返し [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-196">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a UNIQUE constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="67ae8-197"> の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit** データ型で作成された列には、UNIQUE 制約を定義できません。</span><span class="sxs-lookup"><span data-stu-id="67ae8-197">UNIQUE constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit** data type.</span></span>|  
  
 <span data-ttu-id="67ae8-198">コンシューマーが**Itabledefinition:: CreateTable**を呼び出すと、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーは、次のようにテーブルのプロパティを解釈します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-198">When the consumer calls **ITableDefinition::CreateTable**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider interprets table properties as follows.</span></span>  
  
|<span data-ttu-id="67ae8-199">プロパティ ID</span><span class="sxs-lookup"><span data-stu-id="67ae8-199">Property ID</span></span>|<span data-ttu-id="67ae8-200">説明</span><span class="sxs-lookup"><span data-stu-id="67ae8-200">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="67ae8-201">DBPROP_TBL_TEMPTABLE</span><span class="sxs-lookup"><span data-stu-id="67ae8-201">DBPROP_TBL_TEMPTABLE</span></span>|<span data-ttu-id="67ae8-202">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="67ae8-202">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="67ae8-203">既定値: VARIANT_FALSE 説明: 既定では、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって、コンシューマーによってという名前のテーブルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-203">Default: VARIANT_FALSE Description: By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates tables named by the consumer.</span></span> <span data-ttu-id="67ae8-204">VARIANT_TRUE すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって、コンシューマーの一時テーブル名が生成されます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-204">When VARIANT_TRUE, The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="67ae8-205">コンシューマーは **CreateTable** の *pTableID* パラメーターに NULL を設定します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-205">The consumer sets the *pTableID* parameter of **CreateTable** to NULL.</span></span> <span data-ttu-id="67ae8-206">*ppTableID* パラメーターには、有効なポインターを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ae8-206">The *ppTableID* parameter must contain a valid pointer.</span></span>|  
  
 <span data-ttu-id="67ae8-207">コンシューマーが、正常に作成されたテーブルで行セットを開くように要求すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーによって、カーソルがサポートされている行セットが開かれます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-207">If the consumer requests that a rowset be opened on a successfully created table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider opens a cursor-supported rowset.</span></span> <span data-ttu-id="67ae8-208">渡されるプロパティ セットで任意の行セット プロパティを指定できます。</span><span class="sxs-lookup"><span data-stu-id="67ae8-208">Any rowset properties can be indicated in the property sets passed.</span></span>  
  
 <span data-ttu-id="67ae8-209">次の例では、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブルを作成します。</span><span class="sxs-lookup"><span data-stu-id="67ae8-209">This example creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span>  
  
```  
// This CREATE TABLE statement shows the details of the table created by   
// the following example code.  
//  
// CREATE TABLE OrderDetails  
// (  
//    OrderID      int      NOT NULL  
//    ProductID   int      NOT NULL  
//    CONSTRAINT PK_OrderDetails  
//         PRIMARY KEY CLUSTERED (OrderID, ProductID),  
//    UnitPrice   money      NOT NULL,  
//    Quantity   int      NOT NULL,  
//    Discount   decimal(2,2)   NOT NULL  
//        DEFAULT 0  
// )  
//  
// The PRIMARY KEY constraint is created in an additional example.  
HRESULT CreateTable  
    (  
    ITableDefinition* pITableDefinition  
    )  
    {  
    DBID            dbidTable;  
    const ULONG     nCols = 5;  
    ULONG           nCol;  
    ULONG           nProp;  
    DBCOLUMNDESC    dbcoldesc[nCols];  
  
    HRESULT         hr;  
  
    // Set up column descriptions. First, set default property values for  
    //  the columns.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        dbcoldesc[nCol].pwszTypeName = NULL;  
        dbcoldesc[nCol].pTypeInfo = NULL;  
        dbcoldesc[nCol].rgPropertySets = new DBPROPSET;  
        dbcoldesc[nCol].pclsid = NULL;  
        dbcoldesc[nCol].cPropertySets = 1;  
        dbcoldesc[nCol].ulColumnSize = 0;  
        dbcoldesc[nCol].dbcid.eKind = DBKIND_NAME;  
        dbcoldesc[nCol].wType = DBTYPE_I4;  
        dbcoldesc[nCol].bPrecision = 0;  
        dbcoldesc[nCol].bScale = 0;  
  
        dbcoldesc[nCol].rgPropertySets[0].rgProperties =   
            new DBPROP[NCOLPROPS_MAX];  
        dbcoldesc[nCol].rgPropertySets[0].cProperties = NCOLPROPS_MAX;  
        dbcoldesc[nCol].rgPropertySets[0].guidPropertySet =  
            DBPROPSET_COLUMN;  
  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                dwOptions = DBPROPOPTIONS_REQUIRED;  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].colid  
                 = DB_NULLID;  
  
            VariantInit(  
                &(dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                    vValue));  
  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt = VT_BOOL;  
            }  
        }  
  
    // Set the column-specific information.  
    dbcoldesc[0].dbcid.uName.pwszName = L"OrderID";  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[0].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[1].dbcid.uName.pwszName = L"ProductID";  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[1].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[2].dbcid.uName.pwszName = L"UnitPrice";  
    dbcoldesc[2].wType = DBTYPE_CY;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[2].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[3].dbcid.uName.pwszName = L"Quantity";  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[3].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[4].dbcid.uName.pwszName = L"Discount";  
    dbcoldesc[4].wType = DBTYPE_NUMERIC;  
    dbcoldesc[4].bPrecision = 2;  
    dbcoldesc[4].bScale = 2;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].dwPropertyID =   
        DBPROP_COL_DEFAULT;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.vt = VT_BSTR;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.bstrVal =  
        SysAllocString(L"0");  
    dbcoldesc[4].rgPropertySets[0].cProperties = 2;  
  
    // Set up the dbid for OrderDetails.  
    dbidTable.eKind = DBKIND_NAME;  
    dbidTable.uName.pwszName = L"OrderDetails";  
  
    if (FAILED(hr = pITableDefinition->CreateTable(NULL, &dbidTable,  
        nCols, dbcoldesc, NULL, 0, NULL, NULL, NULL)))  
        {  
        DumpError(pITableDefinition, IID_ITableDefinition);  
        goto SAFE_EXIT;  
        }  
  
SAFE_EXIT:  
    // Clean up dynamic allocation in the property sets.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            if (dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt == VT_BSTR)  
                {  
                SysFreeString(dbcoldesc[nCol].rgPropertySets[0].  
                    rgProperties[nProp].vValue.bstrVal);  
                }  
            }  
  
        delete [] dbcoldesc[nCol].rgPropertySets[0].rgProperties;  
        delete [] dbcoldesc[nCol].rgPropertySets;  
        }  
  
    return (hr);  
    }  
```  
  
## <a name="see-also"></a><span data-ttu-id="67ae8-210">参照</span><span class="sxs-lookup"><span data-stu-id="67ae8-210">See Also</span></span>  
 [<span data-ttu-id="67ae8-211">テーブルとインデックス</span><span class="sxs-lookup"><span data-stu-id="67ae8-211">Tables and Indexes</span></span>](../../relational-databases/native-client-ole-db-tables-indexes/tables-and-indexes.md)  
  
  
