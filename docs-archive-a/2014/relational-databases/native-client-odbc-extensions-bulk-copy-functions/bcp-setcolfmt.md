---
title: bcp_setcolfmt |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- bcp_setcolfmt
api_location:
- sqlncli11.dll
topic_type:
- apiref
helpviewer_keywords:
- bcp_setcolfmt function
ms.assetid: afb47987-39e7-4079-ad66-e0abf4d4c72b
author: rothja
ms.author: jroth
ms.openlocfilehash: bb3b1da62ab4e98ed4497dd11fcc20163025058b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87642062"
---
# <a name="bcp_setcolfmt"></a><span data-ttu-id="e12a2-102">bcp_setcolfmt</span><span class="sxs-lookup"><span data-stu-id="e12a2-102">bcp_setcolfmt</span></span>
  <span data-ttu-id="e12a2-103">**Bcp_setcolfmt**関数は、 [bcp_colfmt](bcp-colfmt.md)よりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-103">The **bcp_setcolfmt** function supersedes the [bcp_colfmt](bcp-colfmt.md).</span></span> <span data-ttu-id="e12a2-104">列の照合順序を指定する場合は、 **bcp_setcolfmt**関数を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e12a2-104">In specifying the column collation, the **bcp_setcolfmt** function must be used.</span></span> <span data-ttu-id="e12a2-105">[bcp_setbulkmode](bcp-setbulkmode.md)を使用すると、複数の列の形式を指定できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-105">[bcp_setbulkmode](bcp-setbulkmode.md) can be used to specify more than one column format.</span></span>  
  
 <span data-ttu-id="e12a2-106">この関数では、一括コピー操作で列の形式を柔軟に指定できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-106">This function provides a flexible approach to specifying the column format in a bulk copy operation.</span></span> <span data-ttu-id="e12a2-107">個別の列形式属性を設定する場合に、この関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-107">It is used to set individual column format attributes.</span></span> <span data-ttu-id="e12a2-108">**Bcp_setcolfmt**を呼び出すたびに、1つの列形式属性が設定されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-108">Each call to **bcp_setcolfmt** sets one column format attribute.</span></span>  
  
 <span data-ttu-id="e12a2-109">**Bcp_setcolfmt**関数は、ユーザーファイル内のデータのソースまたはターゲットの形式を指定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-109">The **bcp_setcolfmt** function specifies the source or target format of the data in a user file.</span></span> <span data-ttu-id="e12a2-110">ソース形式として使用する場合、 **bcp_setcolfmt**は、のテーブルに一括コピーするデータソースとして使用される既存のデータファイルの形式を指定し [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-110">When used as a source format, **bcp_setcolfmt** specifies the format of an existing data file used as a data source of data in a bulk copy to a table in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e12a2-111">ターゲット形式として使用する場合は、 **bcp_setcolfmt**で指定された列形式を使用してデータファイルが作成されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-111">When used as a target format, the data file is created using the column formats specified with **bcp_setcolfmt**.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="e12a2-112">構文</span><span class="sxs-lookup"><span data-stu-id="e12a2-112">Syntax</span></span>  
  
```  
  
RETCODE bcp_setcolfmt (  
HDBC   
hdbc  
,  
INT   
field  
,  
INT   
property  
,  
void*   
pValue  
,  
INT   
cbValue  
);  
  
```  
  
## <a name="arguments"></a><span data-ttu-id="e12a2-113">引数</span><span class="sxs-lookup"><span data-stu-id="e12a2-113">Arguments</span></span>  
 <span data-ttu-id="e12a2-114">*hdbc*</span><span class="sxs-lookup"><span data-stu-id="e12a2-114">*hdbc*</span></span>  
 <span data-ttu-id="e12a2-115">一括コピーが有効な ODBC 接続ハンドルです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-115">Is the bulk copy-enabled ODBC connection handle.</span></span>  
  
 <span data-ttu-id="e12a2-116">*分野*</span><span class="sxs-lookup"><span data-stu-id="e12a2-116">*field*</span></span>  
 <span data-ttu-id="e12a2-117">プロパティを設定する列の序数です。</span><span class="sxs-lookup"><span data-stu-id="e12a2-117">Is the ordinal column number for which the property is being set.</span></span>  
  
 <span data-ttu-id="e12a2-118">*property*</span><span class="sxs-lookup"><span data-stu-id="e12a2-118">*property*</span></span>  
 <span data-ttu-id="e12a2-119">プロパティ定数のいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-119">Is one of the property constants.</span></span> <span data-ttu-id="e12a2-120">次の表に、プロパティ定数を示します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-120">Property constants are defined in this table.</span></span>  
  
|<span data-ttu-id="e12a2-121">プロパティ</span><span class="sxs-lookup"><span data-stu-id="e12a2-121">Property</span></span>|<span data-ttu-id="e12a2-122">値</span><span class="sxs-lookup"><span data-stu-id="e12a2-122">Value</span></span>|<span data-ttu-id="e12a2-123">説明</span><span class="sxs-lookup"><span data-stu-id="e12a2-123">Description</span></span>|  
|--------------|-----------|-----------------|  
|<span data-ttu-id="e12a2-124">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="e12a2-124">BCP_FMT_TYPE</span></span>|<span data-ttu-id="e12a2-125">BYTE</span><span class="sxs-lookup"><span data-stu-id="e12a2-125">BYTE</span></span>|<span data-ttu-id="e12a2-126">ユーザー ファイル内にある列のデータ型です。</span><span class="sxs-lookup"><span data-stu-id="e12a2-126">Is the data type of this column in the user file.</span></span> <span data-ttu-id="e12a2-127">データベース テーブル内の対応する列のデータ型と異なる場合は、一括コピーでは可能な限りデータを変換します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-127">If different from the data type of the corresponding column in the database table, bulk copy converts the data if possible.</span></span><br /><br /> <span data-ttu-id="e12a2-128">BCP_FMT_TYPE パラメーターは、ODBC C データ型の列挙子ではなく、sqlncli.h 内の SQL Server データ型トークンで列挙されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-128">The BCP_FMT_TYPE parameter is enumerated by the SQL Server data type tokens in sqlncli.h, rather than the ODBC C data type enumerators.</span></span> <span data-ttu-id="e12a2-129">たとえば、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 固有の SQLCHARACTER 型を使用して、ODBC の SQL_C_CHAR 型の文字列を指定できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-129">For example, you can specify a character string, ODBC type SQL_C_CHAR, using the SQLCHARACTER type specific to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="e12a2-130">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のデータ型に対して既定のデータ表現を指定するには、このパラメーターに 0 を設定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-130">To specify the default data representation for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type, set this parameter to 0.</span></span><br /><br /> <span data-ttu-id="e12a2-131">BCP_FMT_TYPE に SQLDECIMAL または SQLNUMERIC を指定し、SQL Server からファイルへの一括コピーを行う場合、次の操作が実行されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-131">For a bulk copy out of SQL Server into a file, when BCP_FMT_TYPE is SQLDECIMAL or SQLNUMERIC:</span></span><br /><br /> <span data-ttu-id="e12a2-132">-ソース列が**decimal**または**numeric**でない場合は、既定の有効桁数と小数点以下桁数が使用されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-132">-   If the source column is not **decimal** or **numeric**, the default precision and scale are used.</span></span><br /><span data-ttu-id="e12a2-133">-ソース列が**decimal**または**numeric**の場合、ソース列の有効桁数と小数点以下桁数が使用されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-133">-   If the source column is **decimal** or **numeric**, the precision and scale of the source column are used.</span></span>|  
|<span data-ttu-id="e12a2-134">BCP_FMT_INDICATOR_LEN</span><span class="sxs-lookup"><span data-stu-id="e12a2-134">BCP_FMT_INDICATOR_LEN</span></span>|<span data-ttu-id="e12a2-135">INT</span><span class="sxs-lookup"><span data-stu-id="e12a2-135">INT</span></span>|<span data-ttu-id="e12a2-136">インジケーター (プレフィックス) のバイト単位の長さです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-136">Is the length in bytes of the indicator (prefix).</span></span><br /><br /> <span data-ttu-id="e12a2-137">これは、列データ内にある長さのインジケーターや NULL インジケーターのバイト単位の長さです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-137">It is the length, in bytes, of a length/null indicator within the column data.</span></span> <span data-ttu-id="e12a2-138">インジケーターの長さの有効値は、0 (インジケーターを使用しない)、1、2、または 4 です。</span><span class="sxs-lookup"><span data-stu-id="e12a2-138">Valid indicator length values are 0 (when using no indicator), 1, 2, or 4.</span></span><br /><br /> <span data-ttu-id="e12a2-139">一括コピーのインジケーターの既定の使用方法を指定するには、このパラメーターに SQL_VARLEN_DATA を設定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-139">To specify default bulk copy indicator usage, set this parameter to SQL_VARLEN_DATA.</span></span><br /><br /> <span data-ttu-id="e12a2-140">インジケーターは、メモリ内ではすべてのデータの直前に、データ ファイル内ではインジケーターを適用するデータの直前に配置します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-140">Indicators appear in memory directly before any data, and in the data file directly before the data to which they apply.</span></span><br /><br /> <span data-ttu-id="e12a2-141">複数の方法 (インジケーターと列の最大長、インジケーターとターミネータ シーケンスなど) を使用してデータ ファイルの列長を指定すると、一括コピーではコピーするデータの量が最も少なくなる方法が使用されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-141">If more than one means of specifying a data file column length is used (such as an indicator and a maximum column length, or an indicator and a terminator sequence), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="e12a2-142">ユーザーの操作でデータの形式が調整されずに一括コピーで生成されたデータ ファイルには、列データの長さが異なる場合や、列の値に NULL が許容される場合にインジケーターが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-142">Data files generated by bulk copy when no user intervention adjusts the format of the data contain indicators when the column data can vary in length or the column can accept NULL as a value.</span></span>|  
|<span data-ttu-id="e12a2-143">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="e12a2-143">BCP_FMT_DATA_LEN</span></span>|<span data-ttu-id="e12a2-144">DBINT</span><span class="sxs-lookup"><span data-stu-id="e12a2-144">DBINT</span></span>|<span data-ttu-id="e12a2-145">データ (列長) のバイト単位の長さです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-145">Is the length in bytes of the data (column length)</span></span><br /><br /> <span data-ttu-id="e12a2-146">これは、ユーザー ファイル内にある列データのバイト単位の最大長です。長さのインジケーターやターミネータの長さは含まれません。</span><span class="sxs-lookup"><span data-stu-id="e12a2-146">It is the maximum length, in bytes, of this column's data in the user file, not including the length of any length indicator or terminator.</span></span><br /><br /> <span data-ttu-id="e12a2-147">BCP_FMT_DATA_LEN を SQL_NULL_DATA に設定すると、データ ファイルの列に含まれるすべての値が NULL に設定されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-147">Setting BCP_FMT_DATA_LEN to SQL_NULL_DATA indicates that all values in the data file column are, or should be set to, NULL.</span></span><br /><br /> <span data-ttu-id="e12a2-148">また、BCP_FMT_DATA_LEN を SQL_VARLEN_DATA に設定すると、各列のデータの長さがシステムによって決定されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-148">Setting BCP_FMT_DATA_LEN to SQL_VARLEN_DATA indicates that the system should determine the length of data in each column.</span></span> <span data-ttu-id="e12a2-149">これは、列によっては、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] からコピーされるデータの前に長さのインジケーターや NULL インジケーターを生成したり、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] にコピーするデータにインジケーターが必要になる場合があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-149">For some columns, this could mean that a length/null indicator is generated to precede data on a copy from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], or that the indicator is expected in data copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="e12a2-150">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の文字データ型やバイナリ データ型の場合は、BCP_FMT_DATA_LEN に SQL_VARLEN_DATA、SQL_NULL_DATA、0、正の値のいずれかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-150">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character and binary data types, BCP_FMT_DATA_LEN can be SQL_VARLEN_DATA, SQL_NULL_DATA, 0, or some positive value.</span></span> <span data-ttu-id="e12a2-151">BCP_FMT_DATA_LEN が SQL_VARLEN_DATA の場合、システムは、長さのインジケーター (存在する場合) またはターミネータ シーケンスを使用してデータの長さを決定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-151">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the system uses either the length indicator, if present, or a terminator sequence to determine the length of the data.</span></span> <span data-ttu-id="e12a2-152">長さのインジケーターとターミネータ シーケンスの両方を指定した場合、一括コピーはコピーするデータ量が少なくなる方法を使用します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-152">If both a length indicator and a terminator sequence are supplied, bulk copy uses the one that results in the least amount of data being copied.</span></span> <span data-ttu-id="e12a2-153">BCP_FMT_DATA_LEN が SQL_VARLEN_DATA の場合、データ型は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 文字型またはバイナリ型になります。長さのインジケーターとターミネータ シーケンスをどちらも指定しなかった場合は、システムからエラー メッセージが返されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-153">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the data type is an [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character or binary type, and neither a length indicator nor a terminator sequence is specified, the system returns an error message.</span></span><br /><br /> <span data-ttu-id="e12a2-154">BCP_FMT_DATA_LEN が 0 または正の値の場合、システムは最大データ長として BCP_FMT_DATA_LEN を使用します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-154">If BCP_FMT_DATA_LEN is 0 or a positive value, the system uses BCP_FMT_DATA_LEN as the maximum data length.</span></span> <span data-ttu-id="e12a2-155">ただし、BCP_FMT_DATA_LEN に正の値を指定し、長さのインジケーターとターミネータ シーケンスを指定した場合、システムはコピーするデータ量が少なくなる方法を使用してデータ長を決定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-155">However, if, in addition to a positive BCP_FMT_DATA_LEN, a length indicator or terminator sequence is provided, the system determines the data length by using the method that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="e12a2-156">BCP_FMT_DATA_LEN の値はデータのバイト数を表します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-156">The BCP_FMT_DATA_LEN value represents the count of bytes of data.</span></span> <span data-ttu-id="e12a2-157">文字データが Unicode ワイド文字で表されている場合、BCP_FMT_DATA_LEN パラメーター値が正の値のときは、各文字のサイズ (バイト数) に文字数を掛けた数を表します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-157">If character data is represented by Unicode wide characters, then a positive BCP_FMT_DATA_LEN parameter value represents the number of characters multiplied by the size, in bytes, of each character.</span></span>|  
|<span data-ttu-id="e12a2-158">BCP_FMT_TERMINATOR</span><span class="sxs-lookup"><span data-stu-id="e12a2-158">BCP_FMT_TERMINATOR</span></span>|<span data-ttu-id="e12a2-159">LPCBYTE</span><span class="sxs-lookup"><span data-stu-id="e12a2-159">LPCBYTE</span></span>|<span data-ttu-id="e12a2-160">この列で使用されるターミネータ シーケンス (ANSI または Unicode) を指すポインターです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-160">Pointer to the terminator sequence (either ANSI or Unicode as appropriate) to be used for this column.</span></span> <span data-ttu-id="e12a2-161">このパラメーターは主に文字データ型に対して有効です。これは、他のすべての型は固定長であったり、バイト数を正確に記録するために長さのインジケーターが必要になる (バイナリ データの場合) ためです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-161">This parameter is useful mainly for character data types because all other types are of fixed length or, in the case of binary data, require an indicator of length to accurately record the number of bytes present.</span></span><br /><br /> <span data-ttu-id="e12a2-162">抽出されるデータが途中で終了されないようにしたり、ユーザー ファイル内のデータが途中で終了していないことを示すには、このパラメーターに NULL を設定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-162">To avoid terminating extracted data, or to indicate that data in a user file is not terminated, set this parameter to NULL.</span></span><br /><br /> <span data-ttu-id="e12a2-163">複数の方法 (ターミネータと長さのインジケーター、ターミネータと列の最大長など) を使用してユーザー ファイルの列長を指定すると、一括コピーはコピーするデータの量が最も少なくなる方法を使用します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-163">If more than one means of specifying a user-file column length is used (such as a terminator and a length indicator, or a terminator and a maximum column length), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="e12a2-164">一括コピー API では、必要に応じて Unicode から MBCS への文字変換が実行されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-164">The bulk copy API performs Unicode-to-MBCS character conversion as required.</span></span> <span data-ttu-id="e12a2-165">このため、ターミネータのバイト文字列とそのバイト文字列の長さの両方を正しく設定するように注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e12a2-165">Care must be taken to ensure that both the terminator byte string and the length of the byte string are set correctly.</span></span>|  
|<span data-ttu-id="e12a2-166">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="e12a2-166">BCP_FMT_SERVER_COL</span></span>|<span data-ttu-id="e12a2-167">INT</span><span class="sxs-lookup"><span data-stu-id="e12a2-167">INT</span></span>|<span data-ttu-id="e12a2-168">データベース内での列の序数位置。</span><span class="sxs-lookup"><span data-stu-id="e12a2-168">Ordinal position of the column in the database</span></span>|  
|<span data-ttu-id="e12a2-169">BCP_FMT_COLLATION</span><span class="sxs-lookup"><span data-stu-id="e12a2-169">BCP_FMT_COLLATION</span></span>|<span data-ttu-id="e12a2-170">LPCSTR</span><span class="sxs-lookup"><span data-stu-id="e12a2-170">LPCSTR</span></span>|<span data-ttu-id="e12a2-171">照合順序名。</span><span class="sxs-lookup"><span data-stu-id="e12a2-171">Collation name.</span></span>|  
  
 <span data-ttu-id="e12a2-172">*pValue*</span><span class="sxs-lookup"><span data-stu-id="e12a2-172">*pValue*</span></span>  
 <span data-ttu-id="e12a2-173">*プロパティ*に関連付ける値へのポインターです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-173">Is the pointer to the value to associate to the *property*.</span></span> <span data-ttu-id="e12a2-174">このポインターにより、列形式のプロパティを個別に設定できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-174">It allows each column format property to be set individually.</span></span>  
  
 <span data-ttu-id="e12a2-175">*cbvalue*</span><span class="sxs-lookup"><span data-stu-id="e12a2-175">*cbvalue*</span></span>  
 <span data-ttu-id="e12a2-176">プロパティ バッファーのバイト単位の長さです。</span><span class="sxs-lookup"><span data-stu-id="e12a2-176">Is the length of the property buffer in bytes.</span></span>  
  
## <a name="returns"></a><span data-ttu-id="e12a2-177">戻り値</span><span class="sxs-lookup"><span data-stu-id="e12a2-177">Returns</span></span>  
 <span data-ttu-id="e12a2-178">SUCCEED または FAIL。</span><span class="sxs-lookup"><span data-stu-id="e12a2-178">SUCCEED or FAIL.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="e12a2-179">解説</span><span class="sxs-lookup"><span data-stu-id="e12a2-179">Remarks</span></span>  
 <span data-ttu-id="e12a2-180">この関数は、 **bcp_colfmt**関数よりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-180">This function supersedes the **bcp_colfmt** function.</span></span> <span data-ttu-id="e12a2-181">**Bcp_setcolfmt**関数には、 **bcp_colfmt**のすべての機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="e12a2-181">All the functionality of **bcp_colfmt** is provided in **bcp_setcolfmt** function.</span></span> <span data-ttu-id="e12a2-182">さらに、列の照合順序もサポートされます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-182">In addition, support for column collation is also provided.</span></span> <span data-ttu-id="e12a2-183">列形式属性は、次に示した順番で設定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e12a2-183">It is recommended that the following column format attributes be set in the order given below:</span></span>  
  
 <span data-ttu-id="e12a2-184">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="e12a2-184">BCP_FMT_SERVER_COL</span></span>  
  
 <span data-ttu-id="e12a2-185">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="e12a2-185">BCP_FMT_DATA_LEN</span></span>  
  
 <span data-ttu-id="e12a2-186">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="e12a2-186">BCP_FMT_TYPE</span></span>  
  
 <span data-ttu-id="e12a2-187">**Bcp_setcolfmt**関数を使用すると、一括コピーのユーザーファイル形式を指定できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-187">The **bcp_setcolfmt** function allows you to specify the user-file format for bulk copies.</span></span> <span data-ttu-id="e12a2-188">次に、一括コピーに使用するフォーマットの内容を示します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-188">For bulk copy, a format contains the following parts:</span></span>  
  
-   <span data-ttu-id="e12a2-189">ユーザー ファイルの列からデータベース列へのマッピング</span><span class="sxs-lookup"><span data-stu-id="e12a2-189">A mapping from user-file columns to database columns.</span></span>  
  
-   <span data-ttu-id="e12a2-190">ユーザー ファイルの各列のデータ型</span><span class="sxs-lookup"><span data-stu-id="e12a2-190">The data type of each user-file column.</span></span>  
  
-   <span data-ttu-id="e12a2-191">各列の省略可能なインジケーターの長さ</span><span class="sxs-lookup"><span data-stu-id="e12a2-191">The length of the optional indicator for each column.</span></span>  
  
-   <span data-ttu-id="e12a2-192">ユーザー ファイルの各列におけるデータの最大長</span><span class="sxs-lookup"><span data-stu-id="e12a2-192">The maximum length of data per user-file column.</span></span>  
  
-   <span data-ttu-id="e12a2-193">各列の省略可能なターミネータ バイト シーケンス</span><span class="sxs-lookup"><span data-stu-id="e12a2-193">The optional terminating byte sequence for each column.</span></span>  
  
-   <span data-ttu-id="e12a2-194">省略可能なターミネータ バイト シーケンスの長さ</span><span class="sxs-lookup"><span data-stu-id="e12a2-194">The length of the optional terminating byte sequence.</span></span>  
  
 <span data-ttu-id="e12a2-195">**Bcp_setcolfmt**を呼び出すたびに、1つのユーザーファイル列の形式が指定されます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-195">Each call to **bcp_setcolfmt** specifies the format for one user-file column.</span></span> <span data-ttu-id="e12a2-196">たとえば、5つの列から構成されるユーザーデータファイルの3つの列の既定の設定を変更するには、まず[bcp_columns](bcp-columns.md)**(5)** を呼び出し、 **bcp_setcolfmt**次に5回呼び出します。これらの呼び出しのうち3つを使用して、カスタム形式を設定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-196">For example, to change the default settings for three columns in a five-column user data file, first call [bcp_columns](bcp-columns.md)**(5)**, and then call **bcp_setcolfmt** five times, with three of those calls setting your custom format.</span></span> <span data-ttu-id="e12a2-197">残りの2つの呼び出しについては、BCP_FMT_TYPE を0に設定し、BCP_FMT_INDICATOR_LENGTH、BCP_FMT_DATA_LEN、および*Cbvalue*をそれぞれ0、SQL_VARLEN_DATA、および0に設定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-197">For the remaining two calls, set BCP_FMT_TYPE to 0, and set BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN, and *cbValue* to 0, SQL_VARLEN_DATA, and 0 respectively.</span></span> <span data-ttu-id="e12a2-198">このプロシージャでは、5 つの列すべてをコピーします。それらの列のうち 3 つはカスタマイズされた形式でコピーされ、2 つは既定の形式でコピーされます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-198">This procedure copies all five columns, three with your customized format and two with the default format.</span></span>  
  
 <span data-ttu-id="e12a2-199">**Bcp_setcolfmt**を呼び出す前に、 **bcp_columns**関数を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="e12a2-199">The **bcp_columns** function must be called before calling **bcp_setcolfmt**.</span></span>  
  
 <span data-ttu-id="e12a2-200">ユーザーファイルの各列のプロパティごとに**bcp_setcolfmt**を1回呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="e12a2-200">You must call **bcp_setcolfmt** once for each property of each column in the user file.</span></span>  
  
 <span data-ttu-id="e12a2-201">ユーザー ファイル内のすべてのデータを SQL Server テーブルにコピーする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="e12a2-201">You do not need to copy all data in a user file to the SQL Server table.</span></span> <span data-ttu-id="e12a2-202">列をスキップするには、列のデータの形式を指定する際に BCP_FMT_SERVER_COL パラメーターを 0 に設定します。</span><span class="sxs-lookup"><span data-stu-id="e12a2-202">To skip a column, specify the format of the data for the column, setting the BCP_FMT_SERVER_COL parameter to 0.</span></span> <span data-ttu-id="e12a2-203">列をスキップする場合でも、その列の型を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e12a2-203">If you want to skip a column, you must specify its type.</span></span>  
  
 <span data-ttu-id="e12a2-204">[Bcp_writefmt](bcp-writefmt.md)関数は、書式指定を永続化するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="e12a2-204">The [bcp_writefmt](bcp-writefmt.md) function can be used to persist the format specification.</span></span>  
  
## <a name="bcp_setcolfmt-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="e12a2-205">bcp_setcolfmt による機能強化された日付と時刻のサポート</span><span class="sxs-lookup"><span data-stu-id="e12a2-205">bcp_setcolfmt Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="e12a2-206">日付型または時刻型の BCP_FMT_TYPE プロパティと共に使用される型は、 [&#40;OLE DB および ODBC&#41;の拡張された日付と時刻の型に対する一括コピーの変更](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md)で指定されています。</span><span class="sxs-lookup"><span data-stu-id="e12a2-206">The types used with the BCP_FMT_TYPE property for date/time types are as specified in [Bulk Copy Changes for Enhanced Date and Time Types &#40;OLE DB and ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span></span>  
  
 <span data-ttu-id="e12a2-207">詳細については、「[日付と時刻の機能強化 &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e12a2-207">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e12a2-208">参照</span><span class="sxs-lookup"><span data-stu-id="e12a2-208">See Also</span></span>  
 [<span data-ttu-id="e12a2-209">一括コピー関数</span><span class="sxs-lookup"><span data-stu-id="e12a2-209">Bulk Copy Functions</span></span>](sql-server-driver-extensions-bulk-copy-functions.md)  
  
  
