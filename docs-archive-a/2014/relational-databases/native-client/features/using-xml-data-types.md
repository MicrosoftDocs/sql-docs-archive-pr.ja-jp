---
title: XML データ型の使用 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- IRowsetChange interface
- IRowsetUpdate interface
- data access [SQL Server Native Client], xml data type
- SQL Server Native Client OLE DB schema rowsets
- PROVIDER_TYPES rowset
- IColumnsInfo interface
- IRowsetFind interface
- IColumnsRowset interface
- PROCEDURE_PARAMETERS rowset
- SQLNCLI, XML
- xml data type [SQL Server], SQL Server Native Client
- SQL Server Native Client, XML
- IRowset interface
- ISequentialStream interface
- ISSCommandWithParameters interface
- SS_XMLSCHEMA rowset
- SQL Server Native Client OLE DB interfaces
- XML [SQL Server], SQL Server Native Client
- COLUMNS rowset
ms.assetid: a7af5b72-c5c2-418d-a636-ae4ac6270ee5
author: rothja
ms.author: jroth
ms.openlocfilehash: 3d0dcc8cf7259a24e53281724d8440c6ff2209f1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643283"
---
# <a name="using-xml-data-types"></a><span data-ttu-id="5b228-102">XML データ型の使用</span><span class="sxs-lookup"><span data-stu-id="5b228-102">Using XML Data Types</span></span>
  [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] <span data-ttu-id="5b228-103">には **xml** データ型が導入されています。このデータ型を使用すると XML ドキュメントや XML フラグメントを [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] データベースに格納できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-103">introduced an **xml** data type that enables you to store XML documents and fragments in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="5b228-104">**xml** データ型は [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] での組み込みデータ型の 1 つであり、**int** や **varchar** などの他の組み込みデータ型といくつかの点で似ています。</span><span class="sxs-lookup"><span data-stu-id="5b228-104">The **xml** data type is a built-in data type in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], and is in some ways similar to other built-in types, such as **int** and **varchar**.</span></span> <span data-ttu-id="5b228-105">**xml** データ型は、他の組み込みデータ型と同様に、テーブル作成時の列の型、変数の型、パラメーターの型、または関数の戻り値の型として使用したり、CAST 関数や CONVERT 関数でも使用できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-105">As with other built-in types, you can use the **xml** data type as a column type when creating a table; as a variable type, a parameter type, or a function-return type; or in CAST and CONVERT functions.</span></span>  
  
## <a name="programming-considerations"></a><span data-ttu-id="5b228-106">プログラミングに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="5b228-106">Programming Considerations</span></span>  
 <span data-ttu-id="5b228-107">XML は自己記述型で、必要に応じて、次のようにドキュメントのエンコードを指定する XML ヘッダーを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="5b228-107">XML can be self-describing in that it can optionally include an XML header that specifies the encoding of the document, for example:</span></span>  
  
 `<?xml version="1.0" encoding="windows-1252"?><doc/>`  
  
 <span data-ttu-id="5b228-108">XML 標準では、ドキュメントの先頭の数バイトを調べることで、ドキュメントで使用しているエンコードを XML プロセッサで検出する方法が説明されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-108">The XML standard describes how an XML processor can detect the encoding used for a document by examining the first few bytes of the document.</span></span> <span data-ttu-id="5b228-109">アプリケーションで指定するエンコードとドキュメントで指定されているエンコードが競合する場合があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-109">There are opportunities for the encoding specified by the application to conflict with the encoding specified by the document.</span></span> <span data-ttu-id="5b228-110">バインドされたパラメーターとして渡されるドキュメントの場合、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] では XML がバイナリ データとして扱われるので、データ変換は行われず、XML パーサーはドキュメントに指定されたエンコードを問題なく使用することができます。</span><span class="sxs-lookup"><span data-stu-id="5b228-110">For documents passed as bound parameters, XML is treated as binary data by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], so no conversions are made and the XML parser can use the encoding specified within the document without problems.</span></span> <span data-ttu-id="5b228-111">ただし、WSTR としてバインドされた XML データの場合、そのドキュメントが Unicode でエンコードされていることをアプリケーションで確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-111">However, for XML data that is bound as WSTR, then the application must ensure that the document is encoded as Unicode.</span></span> <span data-ttu-id="5b228-112">この場合、必然的にドキュメントが DOM に読み込まれることになり、エンコードが Unicode に変更され、ドキュメントはシリアル化されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-112">This may entail loading the document into a DOM, changing the encoding to Unicode and serializing the document.</span></span> <span data-ttu-id="5b228-113">この処理が行われないと、データ変換が行われ、結果として無効なまたは破損した XML になります。</span><span class="sxs-lookup"><span data-stu-id="5b228-113">If this is not done, data conversions may occur, resulting in invalid or corrupt XML.</span></span>  
  
 <span data-ttu-id="5b228-114">また、XML がリテラルで指定された場合も競合が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-114">There is also potential for conflict when XML is specified in literals.</span></span> <span data-ttu-id="5b228-115">たとえば、次に示すステートメントは無効です。</span><span class="sxs-lookup"><span data-stu-id="5b228-115">For example the following are invalid:</span></span>  
  
 `INSERT INTO xmltable(xmlcol) VALUES('<?xml version="1.0" encoding="UTF-16"?><doc/>')`  
  
 `INSERT INTO xmltable(xmlcol) VALUES(N'<?xml version="1.0" encoding="UTF-8"?><doc/>')`  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="5b228-116">SQL Server Native Client OLE DB プロバイダー</span><span class="sxs-lookup"><span data-stu-id="5b228-116">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="5b228-117">DBTYPE_XML は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーの新しい XML 固有のデータ型です。</span><span class="sxs-lookup"><span data-stu-id="5b228-117">DBTYPE_XML is a new data type specific to XML in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="5b228-118">また、既存の OLE DB 型である DBTYPE_BYTES、DBTYPE_WSTR、DBTYPE_BSTR、DBTYPE_XML、DBTYPE_STR、DBTYPE_VARIANT、および DBTYPE_IUNKNOWN を使用して、XML データにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="5b228-118">In addition, XML data can be accessed through the existing OLE DB types of DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT, and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="5b228-119">XML 型の列に格納されたデータ型は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーの行セット内の列から、次の形式で取得できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-119">Data stored in columns of type XML can be retrieved from a column in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset in the following formats:</span></span>  
  
-   <span data-ttu-id="5b228-120">テキスト文字列</span><span class="sxs-lookup"><span data-stu-id="5b228-120">A text string</span></span>  
  
-   <span data-ttu-id="5b228-121">**ISequentialStream**</span><span class="sxs-lookup"><span data-stu-id="5b228-121">An **ISequentialStream**</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5b228-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーには sax リーダーは含まれていませんが、MSXML では**ISEQUENTIALSTREAM**を sax および DOM オブジェクトに簡単に渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="5b228-122">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not include a SAX reader, but the **ISequentialStream** can be easily passed to SAX and DOM objects in MSXML.</span></span>  
  
 <span data-ttu-id="5b228-123">**ISequentialStream**は、大きな XML ドキュメントを取得するために使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-123">**ISequentialStream** should be use used for retrieval of large XML documents.</span></span> <span data-ttu-id="5b228-124">他の大きな値の型で使用される方法と同じ方法を XML でも使用できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-124">The same techniques used for other large value types also apply to XML.</span></span> <span data-ttu-id="5b228-125">詳細については、「[大きな値をとるデータ型の使用](using-large-value-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5b228-125">For more information, see [Using Large Value Types](using-large-value-types.md).</span></span>  
  
 <span data-ttu-id="5b228-126">行セットの XML 型の列に格納されているデータは、アプリケーションで **IRow::GetColumns**、**IRowChange::SetColumns**、**ICommand::Execute** などの通常のインターフェイスを使用することにより、取得、挿入、または更新することもできます。</span><span class="sxs-lookup"><span data-stu-id="5b228-126">Data stored in columns of type XML in a rowset can also be retrieved, inserted, or updated by an application via the usual interfaces such as **IRow::GetColumns**, **IRowChange::SetColumns**, and **ICommand::Execute**.</span></span> <span data-ttu-id="5b228-127">検索の場合と同様に、アプリケーションプログラムは、テキスト文字列または**ISequentialStream**を Native Client OLE DB プロバイダーに渡すことができ [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="5b228-127">Similarly to the retrieval case, an application program can pass either a text string or an **ISequentialStream** to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5b228-128">**ISequentialStream** インターフェイスを使用して XML データを文字列形式で送信するには、DBTYPE_IUNKNOWN を指定して **ISequentialStream** を取得し、その *pObject* 引数をバインドの際に NULL に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-128">To send XML data in string format through the **ISequentialStream** interface, you must obtain **ISequentialStream** by specifying DBTYPE_IUNKNOWN and set its *pObject* argument to null in the binding.</span></span>  
  
 <span data-ttu-id="5b228-129">コンシューマーのバッファーが小さすぎて取得した XML データが切り捨てられるときは、データ長が 0xffffffff で返されます。この値は、長さが不明であることを意味します。</span><span class="sxs-lookup"><span data-stu-id="5b228-129">When retrieved XML data is truncated due to the consumer buffer being too small, the length may be returned as 0xffffffff, which means that the length is unknown.</span></span> <span data-ttu-id="5b228-130">この動作は、実際のデータの前に長さの情報を送信しないでクライアントにストリーム送信されるデータ型の実装と一貫性を持たせています。</span><span class="sxs-lookup"><span data-stu-id="5b228-130">This is consistent with its implementation as a data type that is streamed to the client without sending length information ahead of the actual data.</span></span> <span data-ttu-id="5b228-131">場合によっては、プロバイダーが**IRowset:: GetData**などの値全体をバッファーに格納し、データ変換が実行されるときに、実際の長さが返されることがあります。</span><span class="sxs-lookup"><span data-stu-id="5b228-131">In some cases the actual length may be returned when the provider has buffered the whole value, such as **IRowset::GetData** and where data conversion is performed.</span></span>  
  
 <span data-ttu-id="5b228-132">SQL Server に送信される XML データは、サーバーではバイナリ データとして扱われます。</span><span class="sxs-lookup"><span data-stu-id="5b228-132">XML data sent to SQL Server is treated as binary data by the server.</span></span> <span data-ttu-id="5b228-133">その結果、変換が行われず、XML パーサーが XML エンコードを自動検出できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-133">This prevents any conversions occurring and allows the XML parser to auto-detect the XML encoding.</span></span> <span data-ttu-id="5b228-134">これにより、広範な XML ドキュメント (UTF-8 でエンコードされた XML ドキュメントなど) を [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] への入力として受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="5b228-134">This allows a wider range of XML documents (for example those encoded in UTF-8) to be accepted as input to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="5b228-135">入力 XML が DBTYPE_WSTR にバインドされる場合、不要なデータ変換によってデータが破損しないようにするために、アプリケーションでは入力 XML が Unicode でエンコードされていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-135">If input XML is bound as DBTYPE_WSTR, the application must ensure it is already Unicode encoded to avoid any possibility of corruption by unwanted data conversions.</span></span>  
  
### <a name="data-bindings-and-coercions"></a><span data-ttu-id="5b228-136">データ バインドと強制型変換</span><span class="sxs-lookup"><span data-stu-id="5b228-136">Data Bindings and Coercions</span></span>  
 <span data-ttu-id="5b228-137">次の表に、特定のデータ型を  の [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **xml** データ型と共に使用した場合に行われるバインドおよび強制型変換を示します。</span><span class="sxs-lookup"><span data-stu-id="5b228-137">The following table describes the binding and coercion that occurs when using the listed data types with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **xml** data type.</span></span>  
  
|<span data-ttu-id="5b228-138">データ型</span><span class="sxs-lookup"><span data-stu-id="5b228-138">Data type</span></span>|<span data-ttu-id="5b228-139">SQL Server の</span><span class="sxs-lookup"><span data-stu-id="5b228-139">To Server</span></span><br /><br /> <span data-ttu-id="5b228-140">**XML**</span><span class="sxs-lookup"><span data-stu-id="5b228-140">**XML**</span></span>|<span data-ttu-id="5b228-141">SQL Server の</span><span class="sxs-lookup"><span data-stu-id="5b228-141">To Server</span></span><br /><br /> <span data-ttu-id="5b228-142">**XML 以外から**</span><span class="sxs-lookup"><span data-stu-id="5b228-142">**Non-XML**</span></span>|<span data-ttu-id="5b228-143">サーバーからの</span><span class="sxs-lookup"><span data-stu-id="5b228-143">From Server</span></span><br /><br /> <span data-ttu-id="5b228-144">**XML**</span><span class="sxs-lookup"><span data-stu-id="5b228-144">**XML**</span></span>|<span data-ttu-id="5b228-145">サーバーからの</span><span class="sxs-lookup"><span data-stu-id="5b228-145">From Server</span></span><br /><br /> <span data-ttu-id="5b228-146">**XML 以外から**</span><span class="sxs-lookup"><span data-stu-id="5b228-146">**Non-XML**</span></span>|  
|---------------|---------------------------|--------------------------------|-----------------------------|----------------------------------|  
|<span data-ttu-id="5b228-147">DBTYPE_XML</span><span class="sxs-lookup"><span data-stu-id="5b228-147">DBTYPE_XML</span></span>|<span data-ttu-id="5b228-148">パス スルー<sup>6、7</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-148">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="5b228-149">エラー<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-149">Error<sup>1</sup></span></span>|<span data-ttu-id="5b228-150">OK<sup>11、6</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-150">OK<sup>11, 6</sup></span></span>|<span data-ttu-id="5b228-151">エラー<sup>8</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-151">Error<sup>8</sup></span></span>|  
|<span data-ttu-id="5b228-152">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="5b228-152">DBTYPE_BYTES</span></span>|<span data-ttu-id="5b228-153">パス スルー<sup>6、7</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-153">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="5b228-154">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-154">N/A<sup>2</sup></span></span>|<span data-ttu-id="5b228-155">可 <sup>11、6</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-155">OK <sup>11, 6</sup></span></span>|<span data-ttu-id="5b228-156">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-156">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="5b228-157">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-157">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-158">パス スルー<sup>6、10</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-158">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="5b228-159">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-159">N/A <sup>2</sup></span></span>|<span data-ttu-id="5b228-160">OK<sup>4、6、12</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-160">OK<sup>4, 6, 12</sup></span></span>|<span data-ttu-id="5b228-161">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-161">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="5b228-162">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-162">DBTYPE_BSTR</span></span>|<span data-ttu-id="5b228-163">パス スルー<sup>6、10</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-163">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="5b228-164">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-164">N/A <sup>2</sup></span></span>|<span data-ttu-id="5b228-165">可 <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-165">OK <sup>3</sup></span></span>|<span data-ttu-id="5b228-166">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-166">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="5b228-167">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="5b228-167">DBTYPE_STR</span></span>|<span data-ttu-id="5b228-168">OK<sup>6、9、10</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-168">OK<sup>6, 9, 10</sup></span></span>|<span data-ttu-id="5b228-169">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-169">N/A <sup>2</sup></span></span>|<span data-ttu-id="5b228-170">可<sup>5、6、12</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-170">OK<sup>5, 6, 12</sup></span></span>|<span data-ttu-id="5b228-171">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-171">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="5b228-172">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="5b228-172">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="5b228-173">**ISequentialStream** 経由のバイト ストリーム<sup>7</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-173">Byte stream via **ISequentialStream**<sup>7</sup></span></span>|<span data-ttu-id="5b228-174">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-174">N/A <sup>2</sup></span></span>|<span data-ttu-id="5b228-175">**ISequentialStream** 経由のバイト ストリーム<sup>11</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-175">Byte stream via **ISequentialStream**<sup>11</sup></span></span>|<span data-ttu-id="5b228-176">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-176">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="5b228-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="5b228-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="5b228-178">パス スルー<sup>6、7</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-178">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="5b228-179">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-179">N/A <sup>2</sup></span></span>|<span data-ttu-id="5b228-180">該当なし</span><span class="sxs-lookup"><span data-stu-id="5b228-180">N/A</span></span>|<span data-ttu-id="5b228-181">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-181">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="5b228-182">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="5b228-182">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="5b228-183">パス スルー<sup>6、10</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-183">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="5b228-184">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-184">N/A <sup>2</sup></span></span>|<span data-ttu-id="5b228-185">可<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-185">OK<sup>3</sup></span></span>|<span data-ttu-id="5b228-186">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5b228-186">N/A <sup>2</sup></span></span>|  
  
 <span data-ttu-id="5b228-187"><sup>1</sup>DBTYPE_XML 以外のサーバー型が **ICommandWithParameters::SetParameterInfo** で指定され、アクセサー型が DBTYPE_XML の場合、ステートメントの実行時にエラーが発生します (DB_E_ERRORSOCCURRED、パラメーターの状態は DBSTATUS_E_BADACCESSOR)。それ以外の場合は、データがサーバーに送信されますが、XML 型からパラメーターのデータ型への暗黙の変換が行われないことを示すエラーがサーバーから返されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-187"><sup>1</sup>If a server type other than DBTYPE_XML is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_XML, an error occurs when the statement is executed (DB_E_ERRORSOCCURRED, the parameter status is DBSTATUS_E_BADACCESSOR); otherwise the data is sent to the server, but the server returns an error indicating that there is no implicit conversion from XML to the parameter's data type.</span></span>  
  
 <span data-ttu-id="5b228-188"><sup>2</sup>このトピックでは扱いません。</span><span class="sxs-lookup"><span data-stu-id="5b228-188"><sup>2</sup>Beyond the scope of this topic.</span></span>  
  
 <span data-ttu-id="5b228-189"><sup>3</sup>形式は UTF-16 です。バイト順マーク (BOM)、エンコード仕様、および終端を示す NULL は付加されません。</span><span class="sxs-lookup"><span data-stu-id="5b228-189"><sup>3</sup>Format is UTF-16, no bye-order mark (BOM), no encoding specification, no null termination.</span></span>  
  
 <span data-ttu-id="5b228-190"><sup>4</sup>形式は UTF-16 です。BOM とエンコード仕様は付加されず、NULL で終端が示されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-190"><sup>4</sup>Format is UTF-16, no BOM, no encoding specification, null termination.</span></span>  
  
 <span data-ttu-id="5b228-191"><sup>5</sup>クライアントのコード ページでエンコードされ、NULL で終端が示される、マルチバイト文字列形式です。</span><span class="sxs-lookup"><span data-stu-id="5b228-191"><sup>5</sup>Format is multibyte characters encoded in client code page with null terminator.</span></span> <span data-ttu-id="5b228-192">Unicode を使用できるサーバーから変換するとデータが破損する場合があるので、このバインドはお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="5b228-192">Conversion from server supplied Unicode may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="5b228-193"><sup>6</sup>BY_REF を使用できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-193"><sup>6</sup>BY_REF may be used.</span></span>  
  
 <span data-ttu-id="5b228-194"><sup>7</sup>UTF-16 データは BOM で始まる必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-194"><sup>7</sup>UTF-16 data must start with a BOM.</span></span> <span data-ttu-id="5b228-195">BOM で始まらない場合は、サーバーでエンコードが正しく認識されないことがあります。</span><span class="sxs-lookup"><span data-stu-id="5b228-195">If it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
 <span data-ttu-id="5b228-196"><sup>8</sup>検証は、アクセサーの作成時、またはフェッチ時に行われます。</span><span class="sxs-lookup"><span data-stu-id="5b228-196"><sup>8</sup>Validation can happen at create accessor time, or at fetch time.</span></span> <span data-ttu-id="5b228-197">エラーは DB_E_ERRORSOCCURRED です。その場合、バインドの状態は DBBINDSTATUS_UNSUPPORTEDCONVERSION に設定されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-197">The error is DB_E_ERRORSOCCURRED, binding status set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>  
  
 <span data-ttu-id="5b228-198"><sup>9</sup>データは、サーバーに送信される前にクライアントのコード ページを使用して Unicode に変換されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-198"><sup>9</sup>Data is converted to Unicode using the client codepage before being sent to the server.</span></span> <span data-ttu-id="5b228-199">ドキュメントのエンコードがクライアントのコード ページと一致しない場合、変換によってデータが破損することがあるので、このバインドはお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="5b228-199">If the document encoding does not match the client codepage, this can result in data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="5b228-200"><sup>10</sup>サーバーに送信されるデータには必ず BOM が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-200"><sup>10</sup>A BOM is always added to data sent to the server.</span></span> <span data-ttu-id="5b228-201">既にデータが BOM で始まる場合、この動作により、バッファーの先頭に 2 つの BOM が存在することになります。</span><span class="sxs-lookup"><span data-stu-id="5b228-201">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="5b228-202">サーバーでは、1 つ目の BOM からエンコードを UTF-16 と認識した後、その BOM を破棄します。</span><span class="sxs-lookup"><span data-stu-id="5b228-202">The server uses the first BOM to recognize the encoding as UTF-16 and then discards it.</span></span> <span data-ttu-id="5b228-203">2 つ目の BOM は、幅が 0 の改行を行わない空白文字として解釈されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-203">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
 <span data-ttu-id="5b228-204"><sup>11</sup>形式は UTF-16 です。エンコード仕様は付加されません。サーバーから受け取ったデータに BOM が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-204"><sup>11</sup>Format is UTF-16, no encoding specification, a BOM is added to data received from the server.</span></span> <span data-ttu-id="5b228-205">サーバーから空文字列が返されても、アプリケーションには BOM が返されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-205">If an empty string is returned by the server, a BOM is still returned to the application.</span></span> <span data-ttu-id="5b228-206">バッファー長が奇数バイトの場合、データは適切に切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="5b228-206">If the buffer length is an odd number of bytes, the data is truncated correctly.</span></span> <span data-ttu-id="5b228-207">1 つの値が複数のチャンクで返される場合、それぞれを連結して正しい値を再構成できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-207">If the whole value is returned in chunks, they can be concatenated to reconstitute the correct value.</span></span>  
  
 <span data-ttu-id="5b228-208"><sup>12</sup>バッファーの長さが2文字未満の場合 (つまり、null 終了に十分な領域がない場合)、オーバーフローエラーが報告されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-208"><sup>12</sup>If the buffer length is less than two characters--that is, not enough space for null termination--an overflow error is reported.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5b228-209">NULL の XML 値の場合は、データは返されません。</span><span class="sxs-lookup"><span data-stu-id="5b228-209">No data is returned for NULL XML values.</span></span>  
  
 <span data-ttu-id="5b228-210">XML 標準では、UTF-16 でエンコードされた XML をバイト順マーク (BOM) で始める必要があります。BOM は UTF-16 の文字コードでは 0xFEFF です。</span><span class="sxs-lookup"><span data-stu-id="5b228-210">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="5b228-211">WSTR と BSTR バインドを使用する場合、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] バインドによってエンコードが暗黙的に使用されるため、Native Client では BOM が必要でも追加されません。</span><span class="sxs-lookup"><span data-stu-id="5b228-211">When working with WSTR and BSTR bindings, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM as the encoding is implied by the binding.</span></span> <span data-ttu-id="5b228-212">BYTES バインド、XML バインド、または IUNKNOWN バインドを使用する場合、その目的は他の XML プロセッサや XML ストレージ システムでの処理を簡単にすることです。</span><span class="sxs-lookup"><span data-stu-id="5b228-212">When working with BYTES, XML, or IUNKNOWN bindings, the intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="5b228-213">この場合、BOM は UTF-16 でエンコードされた XML を示し、SQL Server を含め XML プロセッサの多くは値の先頭の数バイトを調べてエンコードを推定するので、アプリケーションで実際のエンコードを考慮する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="5b228-213">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, since the majority of XML processors (including SQL Server) deduces the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="5b228-214">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]バイト、xml、または IUNKNOWN バインドを使用してネイティブクライアントから受信した xml データは、常に、BOM では utf-16 でエンコードされ、エンコード宣言は埋め込まれません。</span><span class="sxs-lookup"><span data-stu-id="5b228-214">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using BYTES, XML, or IUNKNOWN bindings is always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
 <span data-ttu-id="5b228-215">OLE DB Core Services で提供されるデータ変換 (**IDataConvert**) は、DBTYPE_XML 型には適用できません。</span><span class="sxs-lookup"><span data-stu-id="5b228-215">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_XML.</span></span>  
  
 <span data-ttu-id="5b228-216">検証はデータがサーバーに送信されたときに行われます。</span><span class="sxs-lookup"><span data-stu-id="5b228-216">Validation is done when data is sent to the server.</span></span> <span data-ttu-id="5b228-217">クライアント側の検証とエンコードの変更はアプリケーションで処理する必要がありますが、直接処理するのではなく、DOM リーダーや SAX リーダーを使用して XML データを処理することを強くお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5b228-217">Client-side validation and encoding changes should be handled by your application, and it is strongly recommended that you not process the XML data directly, but should instead use a DOM or SAX reader to process it.</span></span>  
  
 <span data-ttu-id="5b228-218">DBTYPE_NULL と DBTYPE_EMPTY は入力パラメーターにバインドできますが、出力パラメーターや結果にはバインドできません。</span><span class="sxs-lookup"><span data-stu-id="5b228-218">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters but not for output parameters or results.</span></span> <span data-ttu-id="5b228-219">入力パラメーターにバインドした場合、状態を DBSTATUS_S_ISNULL または DBSTATUS_S_DEFAULT に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-219">When bound for input parameters the status must be set to DBSTATUS_S_ISNULL or DBSTATUS_S_DEFAULT.</span></span>  
  
 <span data-ttu-id="5b228-220">DBTYPE_XML は DBTYPE_EMPTY および DBTYPE_NULL に変換でき、DBTYPE_EMPTY は DBTYPE_XML に変換できますが、DBTYPE_NULL を DBTYPE_XML に変換することはできません。</span><span class="sxs-lookup"><span data-stu-id="5b228-220">DBTYPE_XML can be converted to DBTYPE_EMPTY and DBTYPE_NULL, DBTYPE_EMPTY can be converted to DBTYPE_XML, but DBTYPE_NULL cannot be converted to DBTYPE_XML.</span></span> <span data-ttu-id="5b228-221">この動作は、DBTYPE_WSTR と一貫性があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-221">This is consistent with DBTYPE_WSTR.</span></span>  
  
 <span data-ttu-id="5b228-222">DBTYPE_IUNKNOWN は上記の表に示したようにサポート済みのバインドですが、DBTYPE_XML と DBTYPE_IUNKNOWN との間では変換は行われません。</span><span class="sxs-lookup"><span data-stu-id="5b228-222">DBTYPE_IUNKNOWN is a supported binding (as shown in the above table), but there are no conversions between DBTYPE_XML and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="5b228-223">DBTYPE_IUNKNOWN は、DBTYPE_BYREF と共に使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="5b228-223">DBTYPE_IUNKNOWN may not be used with DBTYPE_BYREF.</span></span>  
  
### <a name="ole-db-rowset-additions-and-changes"></a><span data-ttu-id="5b228-224">OLE DB 行セットに関する追加事項と変更事項</span><span class="sxs-lookup"><span data-stu-id="5b228-224">OLE DB Rowset Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="5b228-225">Native Client では、新しい値または多くのコア OLE DB スキーマ行セットへの変更が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-225">Native Client adds new values or changes to many of the core OLE DB schema rowsets.</span></span>  
  
#### <a name="the-columns-and-procedure_parameters-schema-rowsets"></a><span data-ttu-id="5b228-226">COLUMNS スキーマ行セットと PARAMETERS スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="5b228-226">The COLUMNS and PROCEDURE_PARAMETERS Schema Rowsets</span></span>  
 <span data-ttu-id="5b228-227">COLUMNS スキーマ行セットと PROCEDURE_PARAMETERS スキーマ行セットに次の列が追加されました。</span><span class="sxs-lookup"><span data-stu-id="5b228-227">Additions to the COLUMNS and PROCEDURE_PARAMETERS schema rowsets include the following columns.</span></span>  
  
|<span data-ttu-id="5b228-228">列名</span><span class="sxs-lookup"><span data-stu-id="5b228-228">Column name</span></span>|<span data-ttu-id="5b228-229">Type</span><span class="sxs-lookup"><span data-stu-id="5b228-229">Type</span></span>|<span data-ttu-id="5b228-230">説明</span><span class="sxs-lookup"><span data-stu-id="5b228-230">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="5b228-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="5b228-232">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-232">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-233">XML スキーマ コレクションを定義しているカタログの名前。</span><span class="sxs-lookup"><span data-stu-id="5b228-233">The name of a catalog in which an XML schema collection is defined.</span></span> <span data-ttu-id="5b228-234">XML 型以外の列または型指定されていない XML 列の場合は NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-234">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="5b228-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="5b228-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="5b228-236">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-236">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-237">XML スキーマ コレクションを定義しているスキーマの名前。</span><span class="sxs-lookup"><span data-stu-id="5b228-237">The name of a schema in which an XML schema collection is defined.</span></span> <span data-ttu-id="5b228-238">XML 型以外の列または型指定されていない XML 列の場合は NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-238">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="5b228-239">SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-239">SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="5b228-240">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-240">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-241">XML スキーマ コレクションの名前。</span><span class="sxs-lookup"><span data-stu-id="5b228-241">The name of XML schema collection.</span></span> <span data-ttu-id="5b228-242">XML 型以外の列または型指定されていない XML 列の場合は NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-242">NULL for a non-XML column or un-typed XML column.</span></span>|  
  
#### <a name="the-provider_types-schema-rowset"></a><span data-ttu-id="5b228-243">PROVIDER_TYPES スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="5b228-243">The PROVIDER_TYPES Schema Rowset</span></span>  
 <span data-ttu-id="5b228-244">PROVIDER_TYPES スキーマ行では、**xml** データ型の COLUMN_SIZE の値は 0 で、DATA_TYPE は DBTYPE_XML です。</span><span class="sxs-lookup"><span data-stu-id="5b228-244">In the PROVIDER_TYPES schema rowset, the COLUMN_SIZE value is 0 for the **xml** data type, and the DATA_TYPE is DBTYPE_XML.</span></span>  
  
#### <a name="the-ss_xmlschema-schema-rowset"></a><span data-ttu-id="5b228-245">SS_XMLSCHEMA スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="5b228-245">The SS_XMLSCHEMA Schema Rowset</span></span>  
 <span data-ttu-id="5b228-246">クライアントで XML スキーマ情報を取得できるように、新しいスキーマ行セット SS_XMLSCHEMA が導入されました。</span><span class="sxs-lookup"><span data-stu-id="5b228-246">A new schema rowset SS_XMLSCHEMA is introduced for clients to retrieve XML schema information.</span></span> <span data-ttu-id="5b228-247">SS_XMLSCHEMA 行セットには、次の列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="5b228-247">The SS_XMLSCHEMA rowset contains the following columns.</span></span>  
  
|<span data-ttu-id="5b228-248">列名</span><span class="sxs-lookup"><span data-stu-id="5b228-248">Column name</span></span>|<span data-ttu-id="5b228-249">Type</span><span class="sxs-lookup"><span data-stu-id="5b228-249">Type</span></span>|<span data-ttu-id="5b228-250">説明</span><span class="sxs-lookup"><span data-stu-id="5b228-250">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="5b228-251">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-251">SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="5b228-252">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-252">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-253">XML コレクションが属するカタログ。</span><span class="sxs-lookup"><span data-stu-id="5b228-253">The catalog an XML collection belongs to.</span></span>|  
|<span data-ttu-id="5b228-254">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="5b228-254">SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="5b228-255">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-255">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-256">XML コレクションが属するスキーマ。</span><span class="sxs-lookup"><span data-stu-id="5b228-256">The schema an XML collection belongs to.</span></span>|  
|<span data-ttu-id="5b228-257">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-257">SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="5b228-258">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-258">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-259">型指定された XML 列の場合は、XML スキーマ コレクションの名前です。それ以外の場合は、NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-259">The name of an XML schema collection for typed XML columns, NULL otherwise.</span></span>|  
|<span data-ttu-id="5b228-260">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="5b228-260">TARGETNAMESPACEURI</span></span>|<span data-ttu-id="5b228-261">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-261">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-262">XML スキーマの対象名前空間。</span><span class="sxs-lookup"><span data-stu-id="5b228-262">The target name space of an XML schema.</span></span>|  
|<span data-ttu-id="5b228-263">SCHEMACONTENT</span><span class="sxs-lookup"><span data-stu-id="5b228-263">SCHEMACONTENT</span></span>|<span data-ttu-id="5b228-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-265">XML スキーマのコンテンツ。</span><span class="sxs-lookup"><span data-stu-id="5b228-265">The XML schema content.</span></span>|  
  
 <span data-ttu-id="5b228-266">各 XML スキーマのスコープは、カタログ名、スキーマ名、スキーマ コレクション名、および対象名前空間を識別する Uniform Resource Identifier (URI) 別に設定されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-266">Each XML schema is scoped by catalog name, schema name, schema collection name, and target name space Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="5b228-267">また、DBSCHEMA_XML_COLLECTIONS という名前の新しい GUID も定義されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-267">In addition, a new GUID with the name DBSCHEMA_XML_COLLECTIONS is also defined.</span></span> <span data-ttu-id="5b228-268">SS_XMLSCHEMA スキーマ行セットの制限数と制限列は、次のように定義されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-268">The number of restrictions and restricted columns for the SS_XMLSCHEMA schema rowset are defined as follows.</span></span>  
  
|<span data-ttu-id="5b228-269">GUID</span><span class="sxs-lookup"><span data-stu-id="5b228-269">GUID</span></span>|<span data-ttu-id="5b228-270">制限数</span><span class="sxs-lookup"><span data-stu-id="5b228-270">Number of restrictions</span></span>|<span data-ttu-id="5b228-271">制限列</span><span class="sxs-lookup"><span data-stu-id="5b228-271">Restricted columns</span></span>|  
|----------|----------------------------|------------------------|  
|<span data-ttu-id="5b228-272">DBSCHEMA_XML_COLLECTIONS</span><span class="sxs-lookup"><span data-stu-id="5b228-272">DBSCHEMA_XML_COLLECTIONS</span></span>|<span data-ttu-id="5b228-273">4</span><span class="sxs-lookup"><span data-stu-id="5b228-273">4</span></span>|<span data-ttu-id="5b228-274">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-274">SCHEMACOLLECTION_CATALOGNAME</span></span><br /><br /> <span data-ttu-id="5b228-275">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="5b228-275">SCHEMACOLLECTION_SCHEMANAME</span></span><br /><br /> <span data-ttu-id="5b228-276">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-276">SCHEMACOLLECTIONNAME</span></span><br /><br /> <span data-ttu-id="5b228-277">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="5b228-277">TARGETNAMESPACEURI</span></span>|  
  
### <a name="ole-db-property-set-additions-and-changes"></a><span data-ttu-id="5b228-278">OLE DB プロパティ セットに関する追加事項と変更事項</span><span class="sxs-lookup"><span data-stu-id="5b228-278">OLE DB Property Set Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="5b228-279">Native Client では、多くの主要な OLE DB プロパティセットに新しい値または変更が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-279">Native Client adds new values or changes to many of the core OLE DB property sets.</span></span>  
  
#### <a name="the-dbpropset_sqlserverparameter-property-set"></a><span data-ttu-id="5b228-280">DBPROPSET_SQLSERVERPARAMETER プロパティ セット</span><span class="sxs-lookup"><span data-stu-id="5b228-280">The DBPROPSET_SQLSERVERPARAMETER Property Set</span></span>  
 <span data-ttu-id="5b228-281">OLE DB で**xml**データ型をサポートするために、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では、次の値を含む新しい DBPROPSET_SQLSERVERPARAMETER プロパティセットが実装されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-281">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements the new DBPROPSET_SQLSERVERPARAMETER property set, which contains the following values.</span></span>  
  
|<span data-ttu-id="5b228-282">名前</span><span class="sxs-lookup"><span data-stu-id="5b228-282">Name</span></span>|<span data-ttu-id="5b228-283">Type</span><span class="sxs-lookup"><span data-stu-id="5b228-283">Type</span></span>|<span data-ttu-id="5b228-284">説明</span><span class="sxs-lookup"><span data-stu-id="5b228-284">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="5b228-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="5b228-286">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-286">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-287">XML スキーマ コレクションを定義しているカタログ (データベース) の名前。</span><span class="sxs-lookup"><span data-stu-id="5b228-287">The name of a catalog (database) in which an XML schema collection is defined.</span></span> <span data-ttu-id="5b228-288">SQL の 3 部構成による名前の識別子の一部になります。</span><span class="sxs-lookup"><span data-stu-id="5b228-288">A part of the SQL three-part name identifier.</span></span>|  
|<span data-ttu-id="5b228-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="5b228-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="5b228-290">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-290">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-291">スキーマ コレクションに含まれている XML スキーマの名前。</span><span class="sxs-lookup"><span data-stu-id="5b228-291">The name of an XML schema within the schema collection.</span></span> <span data-ttu-id="5b228-292">SQL の 3 部構成による名前の識別子の一部になります。</span><span class="sxs-lookup"><span data-stu-id="5b228-292">A part of the SQL three -part name identifier.</span></span>|  
|<span data-ttu-id="5b228-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="5b228-294">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-294">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-295">カタログに含まれている XML スキーマ コレクションの名前。SQL の 3 部構成による名前の識別子の一部になります。</span><span class="sxs-lookup"><span data-stu-id="5b228-295">The name of the XML schema collection within the catalog A part of the SQL three -part name identifier.</span></span>|  
  
#### <a name="the-dbpropset_sqlservercolumn-property-set"></a><span data-ttu-id="5b228-296">DBPROPSET_SQLSERVERCOLUMN プロパティ セット</span><span class="sxs-lookup"><span data-stu-id="5b228-296">The DBPROPSET_SQLSERVERCOLUMN Property Set</span></span>  
 <span data-ttu-id="5b228-297">**Itabledefinition**インターフェイスでのテーブルの作成をサポートするために、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では DBPROPSET_SQLSERVERCOLUMN プロパティセットに3つの新しい列が追加されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-297">To support the creation of tables in the **ITableDefinition** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client adds three new columns to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span>  
  
|<span data-ttu-id="5b228-298">名前</span><span class="sxs-lookup"><span data-stu-id="5b228-298">Name</span></span>|<span data-ttu-id="5b228-299">Type</span><span class="sxs-lookup"><span data-stu-id="5b228-299">Type</span></span>|<span data-ttu-id="5b228-300">説明</span><span class="sxs-lookup"><span data-stu-id="5b228-300">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="5b228-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="5b228-302">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-302">VT_BSTR</span></span>|<span data-ttu-id="5b228-303">型指定された XML 列の場合、このプロパティは XML スキーマが格納されているカタログ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="5b228-303">For typed XML columns, this property is a string specifying the name of the catalog where the XML schema is stored.</span></span> <span data-ttu-id="5b228-304">他のデータ型の列の場合、このプロパティでは空文字列が返されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-304">For other column types this property returns an empty string.</span></span>|  
|<span data-ttu-id="5b228-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="5b228-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="5b228-306">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-306">VT_BSTR</span></span>|<span data-ttu-id="5b228-307">型指定された XML 列の場合、このプロパティはこの列を定義している XML スキーマ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="5b228-307">For typed XML columns, this property is a string specifying the name of XML schema that defines this column.</span></span>|  
|<span data-ttu-id="5b228-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="5b228-309">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-309">VT_BSTR</span></span>|<span data-ttu-id="5b228-310">型指定された XML 列の場合、このプロパティは値を定義している XML スキーマ コレクション名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="5b228-310">For typed XML columns, this property is a string specifying the name of the schema XML schema collection defining the value.</span></span>|  
  
 <span data-ttu-id="5b228-311">SSPROP_PARAM 値と同様に、これらのプロパティはすべて省略可能なプロパティで、既定値は空です。</span><span class="sxs-lookup"><span data-stu-id="5b228-311">Like the SSPROP_PARAM values, all of these properties are optional and default to empty.</span></span> <span data-ttu-id="5b228-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME と SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME は、SSPROP_COL_XML_SCHEMACOLLECTIONNAME が指定されている場合のみ指定できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME and SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME may only be specified if SSPROP_COL_XML_SCHEMACOLLECTIONNAME is specified.</span></span> <span data-ttu-id="5b228-313">XML をサーバーに渡すときにこれらの値が含まれていると、これらの値が妥当かどうかが現在のデータベースとの比較によりチェックされ、インスタンス データがスキーマとの比較によりチェックされます。</span><span class="sxs-lookup"><span data-stu-id="5b228-313">When passing XML to the server, if these values are included they are checked for existence (validity) against the current database and the instance data is checked against the schema.</span></span> <span data-ttu-id="5b228-314">どの場合でも、これらはすべて空かすべて設定されている場合に妥当と判断されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-314">In all cases, to be valid they are either all empty or all filled in.</span></span>  
  
### <a name="ole-db-interface-additions-and-changes"></a><span data-ttu-id="5b228-315">OLE DB インターフェイスに関する追加事項と変更事項</span><span class="sxs-lookup"><span data-stu-id="5b228-315">OLE DB Interface Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="5b228-316">Native Client では、コア OLE DB インターフェイスの多くに新しい値または変更を追加します。</span><span class="sxs-lookup"><span data-stu-id="5b228-316">Native Client adds new values or changes to many of the core OLE DB interfaces.</span></span>  
  
#### <a name="the-isscommandwithparameters-interface"></a><span data-ttu-id="5b228-317">ISSCommandWithParameters インターフェイス</span><span class="sxs-lookup"><span data-stu-id="5b228-317">The ISSCommandWithParameters Interface</span></span>  
 <span data-ttu-id="5b228-318">OLE DB で**xml**データ型をサポートするために、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では、 [Isscommandwithparameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)インターフェイスの追加など、多数の変更が実装されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-318">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements a number of changes including the addition of the [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) interface.</span></span> <span data-ttu-id="5b228-319">この新しいインターフェイスは、主要な OLE DB インターフェイス **ICommandWithParameters** から継承されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-319">This new interface inherits from the core OLE DB interface **ICommandWithParameters**.</span></span> <span data-ttu-id="5b228-320">**ICommandWithParameters**から継承された3つのメソッドに加えて、**Getparameterinfo**、 **Mapparameternames**、および**setparameterinfo**;**Isscommandwithparameters**には、サーバー固有のデータ型を処理するために使用される[getparameterproperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md)メソッドと[setparameterproperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md)メソッドが用意されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-320">In addition to the three methods inherited from **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**, and **SetParameterInfo**; **ISSCommandWithParameters** provides the [GetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) and [SetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) methods that are used to handle server specific data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5b228-321">**ISSCommandWithParameters** インターフェイスでは、新しい SSPARAMPROPS 構造体も使用されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-321">The **ISSCommandWithParameters** interface also makes use of the new SSPARAMPROPS structure.</span></span>  
  
#### <a name="the-icolumnsrowset-interface"></a><span data-ttu-id="5b228-322">IColumnsRowset インターフェイス</span><span class="sxs-lookup"><span data-stu-id="5b228-322">The IColumnsRowset Interface</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="5b228-323">Native Client では、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **IColumnRowset:: GetColumnsRowset**メソッドによって返される行セットに、次の固有の列が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-323">Native Client adds the following [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific columns to the rowset returned by the **IColumnRowset::GetColumnsRowset** method.</span></span> <span data-ttu-id="5b228-324">これらの列には、XML スキーマ コレクションの 3 部構成の名前が含まれます。</span><span class="sxs-lookup"><span data-stu-id="5b228-324">These columns contain the three-part name of an XML schema collection.</span></span> <span data-ttu-id="5b228-325">XML 以外の列または型指定されていない XML 列の場合、これら 3 列の既定値はすべて NULL になります。</span><span class="sxs-lookup"><span data-stu-id="5b228-325">For non-XML columns or untyped XML columns, all three columns take the default value of NULL.</span></span>  
  
|<span data-ttu-id="5b228-326">列名</span><span class="sxs-lookup"><span data-stu-id="5b228-326">Column name</span></span>|<span data-ttu-id="5b228-327">Type</span><span class="sxs-lookup"><span data-stu-id="5b228-327">Type</span></span>|<span data-ttu-id="5b228-328">説明</span><span class="sxs-lookup"><span data-stu-id="5b228-328">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="5b228-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="5b228-330">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-330">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-331">XML スキーマ コレクションが属するカタログ。</span><span class="sxs-lookup"><span data-stu-id="5b228-331">The catalog an XML schema collection belongs to,</span></span><br /><br /> <span data-ttu-id="5b228-332">それ以外の場合は、NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-332">NULL otherwise.</span></span>|  
|<span data-ttu-id="5b228-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="5b228-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="5b228-334">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-334">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-335">XML スキーマ コレクションが属するスキーマ。</span><span class="sxs-lookup"><span data-stu-id="5b228-335">The schema an XML schema collection belongs to.</span></span> <span data-ttu-id="5b228-336">それ以外の場合は、NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-336">NULL otherwise.</span></span>|  
|<span data-ttu-id="5b228-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="5b228-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="5b228-338">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="5b228-338">DBTYPE_WSTR</span></span>|<span data-ttu-id="5b228-339">型指定された XML 列の場合は、XML スキーマ コレクションの名前です。それ以外の場合は、NULL です。</span><span class="sxs-lookup"><span data-stu-id="5b228-339">The name of XML schema collection for typed XML column, NULL otherwise.</span></span>|  
  
#### <a name="the-irowset-interface"></a><span data-ttu-id="5b228-340">IRowset インターフェイス</span><span class="sxs-lookup"><span data-stu-id="5b228-340">The IRowset Interface</span></span>  
 <span data-ttu-id="5b228-341">XML 列内の XML インスタンスは **IRowset::GetData** メソッドを使用して取得されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-341">An XML instance in an XML column is retrieved through the **IRowset::GetData** method.</span></span> <span data-ttu-id="5b228-342">クライアントで指定されているバインドによって異なりますが、XML インスタンスは DBTYPE_BSTR、DBTYPE_WSTR、DBTYPE_VARIANT、DBTYPE_XML、DBTYPE_STR、DBTYPE_BYTES として、または DBTYPE_IUNKNOWN 経由のインターフェイスとして取得できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-342">Depending on the binding specified by the client, an XML instance can be retrieved as DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR, DBTYPE_BYTES, or as an interface via DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="5b228-343">コンシューマーが DBTYPE_BSTR、DBTYPE_WSTR、または DBTYPE_VARIANT を指定すると、プロバイダーで XML インスタンスの型がユーザーが要求した型に変換され、対応するバインドで指定した場所に格納されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-343">If the consumer specifies DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider converts the XML instance to the user requested type and put it into the location specified in the corresponding binding.</span></span>  
  
 <span data-ttu-id="5b228-344">コンシューマーが DBTYPE_IUNKNOWN を指定し、*pObject* 引数に NULL を設定した場合、または *pObject* 引数に IID_ISequentialStream を設定した場合、プロバイダーから **ISequentialStream** インターフェイスが返されるので、列の XML データをストリーム出力できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-344">If the consumer specifies DBTYPE_IUNKNOWN and sets the *pObject* argument to NULL, or sets the *pObject* argument to IID_ISequentialStream, the provider returns an **ISequentialStream** interface to the consumer so that the consumer can stream the XML data out of the column.</span></span> <span data-ttu-id="5b228-345">その後、**ISequentialStream** から XML データが Unicode 文字のストリームとして返されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-345">**ISequentialStream** then returns the XML data as a Unicode character stream.</span></span>  
  
 <span data-ttu-id="5b228-346">プロバイダーは DBTYPE_IUNKNOWN にバインドされた XML 値を返すときに、`sizeof (IUnknown *)` でサイズ値を報告します。</span><span class="sxs-lookup"><span data-stu-id="5b228-346">When returning an XML value bound to DBTYPE_IUNKNOWN, the provider reports a size value of `sizeof (IUnknown *)`.</span></span> <span data-ttu-id="5b228-347">この動作は、列が DBTYPE_IUnknown または DBTYPE_IDISPATCH としてバインドされる場合行われる動作、および正確な列のサイズを特定できない場合に DBTYPE_IUNKNOWN や ISequentialStream で行われる動作と同じです。</span><span class="sxs-lookup"><span data-stu-id="5b228-347">Note that this is consistent with the approach taken when a column is bound as DBTYPE_IUnknown or DBTYPE_IDISPATCH, and by DBTYPE_IUNKNOWN/ISequentialStream when the exact column size cannot be determined.</span></span>  
  
#### <a name="the-irowsetchange-interface"></a><span data-ttu-id="5b228-348">IRowsetChange インターフェイス</span><span class="sxs-lookup"><span data-stu-id="5b228-348">The IRowsetChange Interface</span></span>  
 <span data-ttu-id="5b228-349">コンシューマーは、列の XML インスタンスを 2 とおりの方法で更新できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-349">There are two ways a consumer can update an XML instance in a column.</span></span> <span data-ttu-id="5b228-350">1 つ目の方法では、プロバイダーで作成されるストレージ オブジェクト **ISequentialStream** を使用します。</span><span class="sxs-lookup"><span data-stu-id="5b228-350">The first one is through the storage object **ISequentialStream** created by the provider.</span></span> <span data-ttu-id="5b228-351">コンシューマーは **ISequentialStream::Write** メソッドを呼び出して、プロバイダーから返された XML インスタンスを直接更新できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-351">The consumer can call the **ISequentialStream::Write** method to directly update the XML instance returned by the provider.</span></span>  
  
 <span data-ttu-id="5b228-352">2 つ目の方法では、**IRowsetChange::SetData** メソッドまたは **IRowsetChange::InsertRow** メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="5b228-352">The second approach is through **IRowsetChange::SetData** or **IRowsetChange::InsertRow** methods.</span></span> <span data-ttu-id="5b228-353">この方法では、コンシューマーのバッファーにある XML インスタンスを DBTYPE_BSTR、DBTYPE_WSTR、DBTYPE_VARIANT、DBTYPE_XML、または DBTYPE_IUNKNOWN 型のバインドで指定できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-353">In this approach, an XML instance in the consumer's buffer can be specified in a binding of type DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML or DBTYPE_IUNKNOWN.</span></span>  
  
 <span data-ttu-id="5b228-354">DBTYPE_BSTR、DBTYPE_WSTR、または DBTYPE_VARIANT の場合、コンシューマーのバッファーに存在する XML インスタンスがプロバイダーによって適切な列に格納されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-354">In case of DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider stores the XML instance residing in the consumer buffer into the proper column.</span></span>  
  
 <span data-ttu-id="5b228-355">DBTYPE_IUNKNOWN/ISequentialStream の場合、コンシューマーがストレージオブジェクトを指定していない場合は、コンシューマーが**ISequentialStream**オブジェクトを事前に作成し、XML ドキュメントをオブジェクトにバインドしてから、 **IRowsetChange:: SetData**メソッドを使用してそのオブジェクトをプロバイダーに渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-355">In the case of DBTYPE_IUNKNOWN/ISequentialStream, if the consumer does not specify any storage object, the consumer must create an **ISequentialStream** object in advance, bind the XML document with the object, and then pass the object to the provider through the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="5b228-356">また、ストレージ オブジェクトを作成して pObject 引数に IID_ISequentialStream を設定し、**ISequentialStream** オブジェクトを作成してから、その **ISequentialStream** オブジェクトを **IRowsetChange::SetData** メソッドに渡すこともできます。</span><span class="sxs-lookup"><span data-stu-id="5b228-356">The consumer can also create a storage object, set the pObject argument to IID_ISequentialStream, create an **ISequentialStream** object and then pass the **ISequentialStream** object to the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="5b228-357">どちらの場合も、プロバイダーは **ISequentialStream** オブジェクトを使用して XML オブジェクトを取得し、それを適切な列に挿入できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-357">In both cases, the provider can retrieve the XML object through the **ISequentialStream** object and insert it into a proper column.</span></span>  
  
#### <a name="the-irowsetupdate-interface"></a><span data-ttu-id="5b228-358">IRowsetUpdate インターフェイス</span><span class="sxs-lookup"><span data-stu-id="5b228-358">The IRowsetUpdate Interface</span></span>  
 <span data-ttu-id="5b228-359">**IRowsetUpdate** インターフェイスには遅延更新のための機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-359">**IRowsetUpdate** interface provides functionality for delayed updates.</span></span> <span data-ttu-id="5b228-360">行セットで使用できるデータは、コンシューマーが**IRowsetUpdate: Update**メソッドを呼び出すまで、他のトランザクションでは使用できません。</span><span class="sxs-lookup"><span data-stu-id="5b228-360">The data made available to the rowsets is not made available to other transactions until the consumer calls the **IRowsetUpdate:Update** method.</span></span>  
  
#### <a name="the-irowsetfind-interface"></a><span data-ttu-id="5b228-361">IRowsetFind インターフェイス</span><span class="sxs-lookup"><span data-stu-id="5b228-361">The IRowsetFind Interface</span></span>  
 <span data-ttu-id="5b228-362">**IRowsetFind::FindNextRow** メソッドでは、**xml** データ型を処理できません。</span><span class="sxs-lookup"><span data-stu-id="5b228-362">The **IRowsetFind::FindNextRow** method does not work with the **xml** data type.</span></span> <span data-ttu-id="5b228-363">*hAccessor* 引数に DBTYPE_XML の列を指定して **IRowsetFind::FindNextRow** を呼び出すと、DB_E_BADBINDINFO が返されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-363">When **IRowsetFind::FindNextRow** is called and the *hAccessor* argument specifies a column of DBTYPE_XML, DB_E_BADBINDINFO is returned.</span></span> <span data-ttu-id="5b228-364">この動作は、検索対象の列の型とは無関係に行われます。</span><span class="sxs-lookup"><span data-stu-id="5b228-364">This occurs regardless of the type of column that is being searched.</span></span> <span data-ttu-id="5b228-365">その他のバインドの型では、検索対象の列が **xml** データ型の場合、**FindNextRow** が DB_E_BADCOMPAREOP を返して失敗します。</span><span class="sxs-lookup"><span data-stu-id="5b228-365">For any other binding type, the **FindNextRow** fails with DB_E_BADCOMPAREOP if the column to be searched is of the **xml** data type.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="5b228-366">SQL Server Native Client ODBC ドライバー</span><span class="sxs-lookup"><span data-stu-id="5b228-366">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="5b228-367">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーでは、 **xml**データ型をサポートするために、さまざまな関数にいくつかの変更が加えられています。</span><span class="sxs-lookup"><span data-stu-id="5b228-367">In the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, a number of changes have been made to various functions to support the **xml** data type.</span></span>  
  
### <a name="sqlcolattribute"></a><span data-ttu-id="5b228-368">SQLColAttribute</span><span class="sxs-lookup"><span data-stu-id="5b228-368">SQLColAttribute</span></span>  
 <span data-ttu-id="5b228-369">[Sqlcolattribute](../../native-client-odbc-api/sqlcolattribute.md)関数には、SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME、SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME、SQL_CA_SS _XML_SCHEMACOLLECTION_NAME を含む3つの新しいフィールド識別子があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-369">The [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) function has three new field identifiers, including SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span></span>  
  
 <span data-ttu-id="5b228-370">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーでは、SQL_DESC_DISPLAY_SIZE 列と SQL_DESC_LENGTH 列の SQL_SS_LENGTH_UNLIMITED が報告されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-370">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the SQL_DESC_DISPLAY_SIZE and SQL_DESC_LENGTH columns.</span></span>  
  
### <a name="sqlcolumns"></a><span data-ttu-id="5b228-371">SQLColumns</span><span class="sxs-lookup"><span data-stu-id="5b228-371">SQLColumns</span></span>  
 <span data-ttu-id="5b228-372">[Sqlcolumns](../../native-client-odbc-api/sqlcolumns.md)関数には、SS_XML_SCHEMACOLLECTION_CATALOG_NAME、SS_XML_SCHEMACOLLECTION_SCHEMA_NAME、SS_XML_SCHEMACOLLECTION_NAME を含む3つの新しい列があります。</span><span class="sxs-lookup"><span data-stu-id="5b228-372">The [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) function has three new columns including SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SS_XML_SCHEMACOLLECTION_NAME.</span></span> <span data-ttu-id="5b228-373">既存の TYPE_NAME 列を使用して XML 型の名前が示されます。XML 型の列または XML 型のパラメーターの DATA_TYPE は SQL_SS_XML になります。</span><span class="sxs-lookup"><span data-stu-id="5b228-373">The existing TYPE_NAME column is used to indicate the name of the XML type, and the DATA_TYPE for a XML type column or parameter is SQL_SS_XML.</span></span>  
  
 <span data-ttu-id="5b228-374">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーは、COLUMN_SIZE と CHAR_OCTET_LENGTH 値の SQL_SS_LENGTH_UNLIMITED を報告します。</span><span class="sxs-lookup"><span data-stu-id="5b228-374">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the COLUMN_SIZE and CHAR_OCTET_LENGTH values.</span></span>  
  
### <a name="sqldescribecol"></a><span data-ttu-id="5b228-375">SQLDescribeCol</span><span class="sxs-lookup"><span data-stu-id="5b228-375">SQLDescribeCol</span></span>  
 <span data-ttu-id="5b228-376">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーでは、 [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md)関数で列のサイズを特定できない場合に SQL_SS_LENGTH_UNLIMITED が報告されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-376">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED when the column size cannot be determined in the [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) function.</span></span>  
  
### <a name="sqlgettypeinfo"></a><span data-ttu-id="5b228-377">SQLGetTypeInfo</span><span class="sxs-lookup"><span data-stu-id="5b228-377">SQLGetTypeInfo</span></span>  
 <span data-ttu-id="5b228-378">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーでは、 [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md)関数の**xml**データ型の最大 COLUMN_SIZE として SQL_SS_LENGTH_UNLIMITED が報告されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-378">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type in the [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) function.</span></span>  
  
### <a name="sqlprocedurecolumns"></a><span data-ttu-id="5b228-379">SQLProcedureColumns</span><span class="sxs-lookup"><span data-stu-id="5b228-379">SQLProcedureColumns</span></span>  
 <span data-ttu-id="5b228-380">[SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md)関数には、 **sqlcolumns**関数と同じ列が追加されています。</span><span class="sxs-lookup"><span data-stu-id="5b228-380">The [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) function has the same column additions as the **SQLColumns** function.</span></span>  
  
 <span data-ttu-id="5b228-381">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーでは、 **xml**データ型の最大 COLUMN_SIZE として SQL_SS_LENGTH_UNLIMITED が報告されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-381">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type.</span></span>  
  
### <a name="supported-conversions"></a><span data-ttu-id="5b228-382">サポートされる変換</span><span class="sxs-lookup"><span data-stu-id="5b228-382">Supported Conversions</span></span>  
 <span data-ttu-id="5b228-383">SQL データ型から C データ型に変換する際、SQL_C_WCHAR、SQL_C_BINARY、および SQL_C_CHAR は、次の条件下ですべて SQL_SS_XML に変換できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-383">When converting from SQL to C data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="5b228-384">SQL_C_WCHAR: 形式は UTF-16 で、バイト順マーク (BOM) は付加されず、NULL で終端が示されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-384">SQL_C_WCHAR: Format is UTF-16, no byte-order mark (BOM), with null termination.</span></span>  
  
-   <span data-ttu-id="5b228-385">SQL_C_BINARY: 形式は UTF-16 で、NULL で終端は示されません。</span><span class="sxs-lookup"><span data-stu-id="5b228-385">SQL_C_BINARY: Format is UTF-16, with no null termination.</span></span> <span data-ttu-id="5b228-386">サーバーから受け取ったデータに BOM が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-386">A BOM is added to data received from the server.</span></span> <span data-ttu-id="5b228-387">サーバーから空文字列が返されても、アプリケーションには BOM が返されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-387">If an empty string is returned by the server a BOM is still returned to the application.</span></span> <span data-ttu-id="5b228-388">バッファー長が奇数バイトの場合、データは適切に切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="5b228-388">If the buffer length is an odd number of bytes the data ise truncated correctly.</span></span> <span data-ttu-id="5b228-389">1 つの値が複数のチャンクで返される場合、それぞれを連結して正しい値を再構成できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-389">If the whole value is returned in chunks they can be concatenated to re-constitute the correct value</span></span>  
  
-   <span data-ttu-id="5b228-390">SQL_C_CHAR: クライアント コード ページでエンコードされ、NULL で終端が示される、マルチバイト文字列形式です。</span><span class="sxs-lookup"><span data-stu-id="5b228-390">SQL_C_CHAR: Format is multibyte characters encoded in client code page with null termination.</span></span> <span data-ttu-id="5b228-391">UTF-16 を使用できるサーバーから変換するとデータが破損する場合があるので、このバインドはお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="5b228-391">Conversion from server supplied UTF-16 may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="5b228-392">C データ型から SQL データ型に変換する際、SQL_C_WCHAR、SQL_C_BINARY、および SQL_C_CHAR は、次の条件下ですべて SQL_SS_XML に変換できます。</span><span class="sxs-lookup"><span data-stu-id="5b228-392">When converting from C to SQL data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="5b228-393">SQL_C_WCHAR: サーバーに送信されるデータには必ず BOM が追加されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-393">SQL_C_WCHAR: A BOM is always be added to data sent to the server.</span></span> <span data-ttu-id="5b228-394">既にデータが BOM で始まる場合、この動作により、バッファーの先頭に 2 つの BOM が存在することになります。</span><span class="sxs-lookup"><span data-stu-id="5b228-394">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="5b228-395">サーバーでは、1 つ目の BOM からエンコードを UTF-16 と認識した後、その BOM を破棄します。</span><span class="sxs-lookup"><span data-stu-id="5b228-395">The server uses the first BOM to recognize the encoding as UTF-16 and then discard it.</span></span> <span data-ttu-id="5b228-396">2 つ目の BOM は、幅が 0 の改行を行わない空白文字として解釈されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-396">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
-   <span data-ttu-id="5b228-397">SQL_C_BINARY: 変換が行われないので、データはそのままの状態でサーバーに渡されます。</span><span class="sxs-lookup"><span data-stu-id="5b228-397">SQL_C_BINARY: No conversion is performed, and the data is passed to the server "as is."</span></span> <span data-ttu-id="5b228-398">UTF-16 データは BOM で始まる必要があります。BOM で始まらない場合、エンコードがサーバーで適切に認識されません。</span><span class="sxs-lookup"><span data-stu-id="5b228-398">UTF-16 data must start with a BOM; if it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
-   <span data-ttu-id="5b228-399">SQL_C_CHAR: データはクライアント上で UTF-16 に変換され、サーバーにそのまま SQL_C_WCHAR として送信されます (ただし、BOM が追加されます)。</span><span class="sxs-lookup"><span data-stu-id="5b228-399">SQL_C_CHAR: The data is converted to UTF-16 on the client and sent to the server just as SQL_C_WCHAR (including the addition of a BOM).</span></span> <span data-ttu-id="5b228-400">XML がクライアントのコード ページでエンコードされない場合、この変換が原因でデータが破損することがあります。</span><span class="sxs-lookup"><span data-stu-id="5b228-400">If the XML is not encoded in the client code page this can cause data corruption.</span></span>  
  
 <span data-ttu-id="5b228-401">XML 標準では、UTF-16 でエンコードされた XML をバイト順マーク (BOM) で始める必要があります。BOM は UTF-16 の文字コードでは 0xFEFF です。</span><span class="sxs-lookup"><span data-stu-id="5b228-401">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="5b228-402">SQL_C_BINARY バインドを使用する場合、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] バインドによってエンコードが暗黙的に使用されるため、Native Client では BOM が必要でも追加されません。</span><span class="sxs-lookup"><span data-stu-id="5b228-402">When working with a SQL_C_BINARY binding, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM, as the encoding is implied by the binding.</span></span> <span data-ttu-id="5b228-403">SQL_C_BINARY バインドを使用する目的は、その他の XML プロセッサや XML ストレージ システムでの処理を簡単にすることです。</span><span class="sxs-lookup"><span data-stu-id="5b228-403">The intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="5b228-404">この場合、BOM は UTF-16 でエンコードされた XML を示し、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] を含め XML プロセッサの多くは値の先頭の数バイトを調べてエンコードを推定するので、アプリケーションで実際のエンコードを考慮する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="5b228-404">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, because the majority of XML processors (including [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) deduce the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="5b228-405">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]SQL_C_BINARY バインディングを使用してネイティブクライアントから受信した XML データは、常に、BOM と共に utf-16 でエンコードされ、エンコード宣言は埋め込まれません。</span><span class="sxs-lookup"><span data-stu-id="5b228-405">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using SQL_C_BINARY bindings are always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5b228-406">参照</span><span class="sxs-lookup"><span data-stu-id="5b228-406">See Also</span></span>  
 <span data-ttu-id="5b228-407">[SQL Server Native Client の機能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="5b228-407">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="5b228-408">ISSCommandWithParameters &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="5b228-408">ISSCommandWithParameters &#40;OLE DB&#41;</span></span>](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)  
  
  
