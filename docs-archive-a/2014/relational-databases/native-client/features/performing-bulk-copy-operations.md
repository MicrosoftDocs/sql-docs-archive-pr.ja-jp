---
title: 一括コピー操作の実行 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633126"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="32645-102">一括コピー操作の実行</span><span class="sxs-lookup"><span data-stu-id="32645-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="32645-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の一括コピー機能により、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] テーブルやビューに大量のデータを入出力できます。</span><span class="sxs-lookup"><span data-stu-id="32645-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="32645-104">SELECT ステートメントを指定してデータを外部に転送することもできます。</span><span class="sxs-lookup"><span data-stu-id="32645-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="32645-105">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] と ASCII ファイルなどのオペレーティング システム データ ファイルとの間でデータを移動できます。</span><span class="sxs-lookup"><span data-stu-id="32645-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="32645-106">データ ファイルには、さまざまな形式を使用できます。一括コピーの形式は、フォーマット ファイルで定義されます。</span><span class="sxs-lookup"><span data-stu-id="32645-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="32645-107">必要に応じて、データをプログラム変数に読み込んでから、一括コピー関数や一括コピー メソッドを使用して [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に転送できます。</span><span class="sxs-lookup"><span data-stu-id="32645-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="32645-108">この機能を示すサンプル アプリケーションについては、「[IRowsetFastLoad を使用したデータの一括コピー &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="32645-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="32645-109">アプリケーションでは、通常、次のいずれかの方法で一括コピーを使用します。</span><span class="sxs-lookup"><span data-stu-id="32645-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="32645-110">テーブル、ビュー、または Transact-SQL ステートメントの結果セットからデータ ファイルに一括コピーします。その際、コピー先のデータ ファイルには、テーブルやビューと同じ形式でデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="32645-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="32645-111">これをネイティブモード データ ファイルと呼びます。</span><span class="sxs-lookup"><span data-stu-id="32645-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="32645-112">テーブル、ビュー、または Transact-SQL ステートメントの結果セットからデータ ファイルに一括コピーします。その際、コピー先のデータ ファイルには、テーブルやビューとは異なる形式でデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="32645-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="32645-113">この場合、データ ファイルに格納される各列の特性 (データ型、位置、長さ、ターミネータなど) を定義するフォーマット ファイルを別に作成します。</span><span class="sxs-lookup"><span data-stu-id="32645-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="32645-114">すべての列を文字形式に変換する場合、変換後のファイルをキャラクターモード データ ファイルと呼びます。</span><span class="sxs-lookup"><span data-stu-id="32645-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="32645-115">データ ファイルからテーブルやビューに一括コピーします。</span><span class="sxs-lookup"><span data-stu-id="32645-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="32645-116">必要に応じて、フォーマット ファイルを使用してデータ ファイルのレイアウトを決定します。</span><span class="sxs-lookup"><span data-stu-id="32645-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="32645-117">プログラム変数にデータを読み込んでから、毎回 1 行ずつ一括コピーを行う一括コピー関数を使用して、データをテーブルやビューにインポートします。</span><span class="sxs-lookup"><span data-stu-id="32645-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="32645-118">一括コピー関数で使用するデータ ファイルを、別の一括コピー プログラムで作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="32645-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="32645-119">他のシステムでも、一括コピー定義に従ってデータ ファイルとフォーマット ファイルを作成できます。その後、これらのファイルを [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の一括コピー プログラムで使用して、データを [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] にインポートできます。</span><span class="sxs-lookup"><span data-stu-id="32645-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="32645-120">たとえば、スプレッドシートからタブ区切り形式のファイルにデータをエクスポートし、タブ区切りファイルの形式を示すフォーマット ファイルを作成した後、一括コピー プログラムを使用して、データを [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に簡単にインポートできます。</span><span class="sxs-lookup"><span data-stu-id="32645-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="32645-121">一括コピーで生成されたデータ ファイルを、他のアプリケーションにインポートすることもできます。</span><span class="sxs-lookup"><span data-stu-id="32645-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="32645-122">たとえば、一括コピー関数を使用して、スプレッドシートに読み込むことができるタブ区切りファイルとして、テーブルやビューからデータをエクスポートできます。</span><span class="sxs-lookup"><span data-stu-id="32645-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="32645-123">一括コピー関数を使用するアプリケーションをコーディングするプログラマは、適切なパフォーマンスで一括コピーを行うための一般的な規則に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="32645-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="32645-124">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] での一括コピー操作のサポートの詳細については、「[データの一括インポートと一括エクスポート &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="32645-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="32645-125">制限事項と制約事項</span><span class="sxs-lookup"><span data-stu-id="32645-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="32645-126">CLR ユーザー定義型 (UDT) はバイナリ データとしてバインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="32645-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="32645-127">フォーマット ファイルで、SQLCHAR がコピー先の UDT 列のデータ型として指定されていたとしても、BCP ユーティリティは、そのデータをバイナリとして扱います。</span><span class="sxs-lookup"><span data-stu-id="32645-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="32645-128">一括コピー操作では SET FMTONLY OFF を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="32645-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="32645-129">SET FMTONLY OFF を使用すると、一括コピー操作でエラーや予期しない結果が生じることがあります。</span><span class="sxs-lookup"><span data-stu-id="32645-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="32645-130">SQL Server Native Client OLE DB プロバイダー</span><span class="sxs-lookup"><span data-stu-id="32645-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="32645-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、データベースで一括コピー操作を実行する2つの方法を実装して [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] います。</span><span class="sxs-lookup"><span data-stu-id="32645-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="32645-132">1 つ目のメソッドでは、メモリベースの一括コピー操作に [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) インターフェイスを使用します。2 つ目のメソッドでは、ファイルベースの一括コピー操作に [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) インターフェイスを使用します。</span><span class="sxs-lookup"><span data-stu-id="32645-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="32645-133">メモリ ベースの一括コピー操作の使用</span><span class="sxs-lookup"><span data-stu-id="32645-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="32645-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、 **IRowsetFastLoad**インターフェイスを実装して、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] メモリベースの一括コピー操作のサポートを公開します。</span><span class="sxs-lookup"><span data-stu-id="32645-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="32645-135">**IRowsetFastLoad** インターフェイスには、[IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) メソッドと [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) メソッドが実装されています。</span><span class="sxs-lookup"><span data-stu-id="32645-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="32645-136">IRowsetFastLoad のセッションの有効化</span><span class="sxs-lookup"><span data-stu-id="32645-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="32645-137">コンシューマーは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダー固有のデータ ソース プロパティである SSPROP_ENABLEFASTLOAD を VARIANT_TRUE に設定することにより、一括コピーを実行する必要があることを [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーに通知します。</span><span class="sxs-lookup"><span data-stu-id="32645-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="32645-138">コンシューマーはデータ ソースのプロパティ セットを使用して、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダー セッションを作成します。</span><span class="sxs-lookup"><span data-stu-id="32645-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="32645-139">この新しいセッションによって、コンシューマーから **IRowsetFastLoad** インターフェイスにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="32645-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="32645-140">データ ソースの初期化に **IDataInitialize** インターフェイスを使用する場合は、**IOpenRowset::OpenRowset** メソッドの *rgPropertySets* パラメーターで SSPROP_IRowsetFastLoad プロパティを設定する必要があります。このプロパティを設定せずに **OpenRowset** メソッドを呼び出すと、E_NOINTERFACE が返されます。</span><span class="sxs-lookup"><span data-stu-id="32645-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="32645-141">一括コピー用にセッションを有効にすることで、そのセッションのインターフェイスに対する [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーのサポートが制限されます。</span><span class="sxs-lookup"><span data-stu-id="32645-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="32645-142">一括コピーが可能なセッションは、次のインターフェイスのみを公開します。</span><span class="sxs-lookup"><span data-stu-id="32645-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="32645-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="32645-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="32645-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="32645-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="32645-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="32645-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="32645-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="32645-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="32645-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="32645-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="32645-148">一括コピー可能な行セットの作成を無効にし、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダー セッションの処理を標準処理に戻すには、SSPROP_ENABLEFASTLOAD を VARIANT_FALSE にリセットします。</span><span class="sxs-lookup"><span data-stu-id="32645-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="32645-149">IRowsetFastLoad 行セット</span><span class="sxs-lookup"><span data-stu-id="32645-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="32645-150">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーの一括コピー行セットは書き込み専用ですが、コンシューマーはこれらの行セットが公開するインターフェイスを使用することで、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] テーブルの構造を決定できます。</span><span class="sxs-lookup"><span data-stu-id="32645-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="32645-151">一括コピー可能な [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダー行セットは、次のインターフェイスを公開します。</span><span class="sxs-lookup"><span data-stu-id="32645-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="32645-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="32645-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="32645-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="32645-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="32645-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="32645-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="32645-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="32645-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="32645-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="32645-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="32645-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="32645-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="32645-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="32645-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="32645-159">プロバイダー固有のプロパティ SSPROP_FASTLOADOPTIONS、SSPROP_FASTLOADKEEPNULLS、および SSPROP_FASTLOADKEEPIDENTITY により、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーの一括コピー行セットの動作が制御されます。</span><span class="sxs-lookup"><span data-stu-id="32645-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="32645-160">プロパティは、 _rgPropertySets_**IOpenRowset**parameter メンバーの*rgProperties*メンバーに指定されています。</span><span class="sxs-lookup"><span data-stu-id="32645-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="32645-161">プロパティ ID</span><span class="sxs-lookup"><span data-stu-id="32645-161">Property ID</span></span>|<span data-ttu-id="32645-162">説明</span><span class="sxs-lookup"><span data-stu-id="32645-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="32645-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="32645-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="32645-164">列:いいえ</span><span class="sxs-lookup"><span data-stu-id="32645-164">Column: No</span></span><br /><br /> <span data-ttu-id="32645-165">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="32645-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="32645-166">型: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="32645-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="32645-167">既定値はVARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="32645-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="32645-168">説明:コンシューマーが指定する ID 値を管理します。</span><span class="sxs-lookup"><span data-stu-id="32645-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="32645-169">VARIANT_FALSE:[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] テーブルの ID 列の値が [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] によって生成されます。</span><span class="sxs-lookup"><span data-stu-id="32645-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="32645-170">列にバインドされている値は、Native Client OLE DB プロバイダーによって無視され [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="32645-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="32645-171">VARIANT_TRUE:コンシューマーが、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ID 列に値を提供するアクセサーをバインドします。</span><span class="sxs-lookup"><span data-stu-id="32645-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="32645-172">NULL を許容する列では ID プロパティを使用できないので、コンシューマーは **IRowsetFastLoad::Insert** を呼び出すたびに一意な値を指定します。</span><span class="sxs-lookup"><span data-stu-id="32645-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="32645-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="32645-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="32645-174">列:いいえ</span><span class="sxs-lookup"><span data-stu-id="32645-174">Column: No</span></span><br /><br /> <span data-ttu-id="32645-175">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="32645-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="32645-176">型: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="32645-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="32645-177">既定値はVARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="32645-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="32645-178">説明:DEFAULT 制約が適用されている列の NULL 値を管理します。</span><span class="sxs-lookup"><span data-stu-id="32645-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="32645-179">影響を受けるのは、NULL 値を許容し、DEFAULT 制約が適用されている [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 列だけです。</span><span class="sxs-lookup"><span data-stu-id="32645-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="32645-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーのコンシューマーが列に NULL 値を含む行を挿入すると、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ではその列に既定値が挿入されます。</span><span class="sxs-lookup"><span data-stu-id="32645-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="32645-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーのコンシューマーが列に NULL 値を含む行を挿入すると、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ではその列に NULL 値が挿入されます。</span><span class="sxs-lookup"><span data-stu-id="32645-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="32645-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="32645-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="32645-183">列:いいえ</span><span class="sxs-lookup"><span data-stu-id="32645-183">Column: No</span></span><br /><br /> <span data-ttu-id="32645-184">R/W:読み取り/書き込み</span><span class="sxs-lookup"><span data-stu-id="32645-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="32645-185">型: VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="32645-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="32645-186">既定値 : なし</span><span class="sxs-lookup"><span data-stu-id="32645-186">Default: none</span></span><br /><br /> <span data-ttu-id="32645-187">説明:このプロパティは、**bcp** ユーティリティの **-h** "*hint*[,...*n*]" オプションと同じです。</span><span class="sxs-lookup"><span data-stu-id="32645-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="32645-188">データをテーブルに一括コピーするときのオプションとして、次の文字列を使用できます。</span><span class="sxs-lookup"><span data-stu-id="32645-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="32645-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]):データ ファイル内のデータの並べ替え順序です。</span><span class="sxs-lookup"><span data-stu-id="32645-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="32645-190">読み込むデータ ファイルをテーブル上のクラスター化インデックスに従って並べ替えると、一括コピーのパフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="32645-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="32645-191">**ROWS_PER_BATCH** = *bb*:各バッチあたりのデータ行数 ( *bb*) です。</span><span class="sxs-lookup"><span data-stu-id="32645-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="32645-192">サーバーは、 *bb*の値に応じて一括コピーの負荷を最適化します。</span><span class="sxs-lookup"><span data-stu-id="32645-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="32645-193">**ROWS_PER_BATCH** の既定値はありません。</span><span class="sxs-lookup"><span data-stu-id="32645-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="32645-194">**KILOBYTES_PER_BATCH** = *cc*:バッチごとのデータのキロバイト数 (KB) です (cc)。</span><span class="sxs-lookup"><span data-stu-id="32645-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="32645-195">**KILOBYTES_PER_BATCH** の既定値はありません。</span><span class="sxs-lookup"><span data-stu-id="32645-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="32645-196">**TABLOCK**:一括コピー操作時にテーブルレベルのロックを行います。</span><span class="sxs-lookup"><span data-stu-id="32645-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="32645-197">一括コピー操作中だけロックを保持することにより、テーブル ロックの競合が少なくなるので、このオプションによりパフォーマンスが大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="32645-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="32645-198">テーブルにインデックスがなく、**TABLOCK** が指定されている場合は、複数のクライアントが同時に 1 つのテーブルを読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="32645-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="32645-199">既定では、ロック動作はテーブル オプション **table lock on bulk load** によって決定されます。</span><span class="sxs-lookup"><span data-stu-id="32645-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="32645-200">**CHECK_CONSTRAINTS**:一括コピー操作中、*table_name* に適用されているすべての制約がチェックされます。</span><span class="sxs-lookup"><span data-stu-id="32645-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="32645-201">既定では、制約は無視されます。</span><span class="sxs-lookup"><span data-stu-id="32645-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="32645-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] では、トリガーに対して行のバージョン管理が使用され、行のバージョンが **tempdb** 内のバージョン ストアに格納されます。</span><span class="sxs-lookup"><span data-stu-id="32645-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="32645-203">したがって、トリガーが有効になっていても一括ログ記録を最適化できます。</span><span class="sxs-lookup"><span data-stu-id="32645-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="32645-204">トリガーを有効にして大量の行が含まれるバッチを一括インポートする前に、**tempdb** のサイズの拡張が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="32645-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="32645-205">ファイル ベースの一括コピー操作の使用</span><span class="sxs-lookup"><span data-stu-id="32645-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="32645-206">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、 **Ibcpsession**インターフェイスを実装して、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ファイルベースの一括コピー操作のサポートを公開します。</span><span class="sxs-lookup"><span data-stu-id="32645-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="32645-207">**IBCPSession** インターフェイスには、[IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md)、[IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md)、[IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md)、[IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md)、[IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md)、[IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md)、[IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md)、および [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md) の各メソッドが実装されます。</span><span class="sxs-lookup"><span data-stu-id="32645-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="32645-208">SQL Server Native Client ODBC ドライバー</span><span class="sxs-lookup"><span data-stu-id="32645-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="32645-209">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC ドライバーでは、以前のバージョンの [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC ドライバーの一部であった一括コピー操作サポートが同様に提供されます。</span><span class="sxs-lookup"><span data-stu-id="32645-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="32645-210">Native Client ODBC ドライバーを使用した一括コピー操作の詳細につい [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ては、「 [odbc&#41;&#40;の一括コピー操作の実行](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="32645-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="32645-211">参照</span><span class="sxs-lookup"><span data-stu-id="32645-211">See Also</span></span>  
 <span data-ttu-id="32645-212">[SQL Server Native Client の機能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="32645-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="32645-213">[データ ソースのプロパティ &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="32645-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="32645-214">[データの一括インポートと一括エクスポート &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="32645-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="32645-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="32645-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="32645-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="32645-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="32645-217">[一括インポートのパフォーマンスの最適化](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="32645-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
