---
title: ユーザー定義型の使用 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- DBPROPSET_DATASOURCEINFO property set
- UDTs [SQL Server Native Client]
- user-defined types [SQL Server], SQL Server Native Client
- SQL Server Native Client OLE DB provider, user-defined types
- DBPROPSET_SQLSERVERPARAMETER property set
- IColumnsRowset interface
- SQLNCLI, user-defined types
- SQL Server Native Client, user-defined types
- data access [SQL Server Native Client], user-defined types
- ISSCommandWithParameters interface
ms.assetid: e15d8169-3517-4323-9c9e-0f5c34aff7df
author: rothja
ms.author: jroth
ms.openlocfilehash: 40608f52f5d14e80aaf3c1d534241cc0ede78348
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643277"
---
# <a name="using-user-defined-types"></a><span data-ttu-id="aa7e6-102">ユーザー定義型の使用</span><span class="sxs-lookup"><span data-stu-id="aa7e6-102">Using User-Defined Types</span></span>
  [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] <span data-ttu-id="aa7e6-103">では、ユーザー定義型 (UDT) が導入されました。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-103">introduced user-defined types (UDTs).</span></span> <span data-ttu-id="aa7e6-104">これにより、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] データベースにオブジェクトやカスタム データ構造を格納できるようになり、SQL の型システムが拡張されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-104">UDTs extend the SQL type system by allowing you to store objects and custom data structures in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="aa7e6-105">UDT は複数のデータ型を持つことができ、動作を定義できます。この点は、1 つの [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] システム データ型から構成される従来の別名データ型と異なります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-105">UDTs can contain multiple data types and can have behaviors, differentiating them from the traditional alias data types that consist of a single [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] system data type.</span></span> <span data-ttu-id="aa7e6-106">UDT は、検証可能なコードを生成する .NET 共通言語ランタイム (CLR) でサポートされる任意の言語を使用して定義されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-106">UDTs are defined using any of the languages supported by the .NET common language runtime (CLR) that produce verifiable code.</span></span> <span data-ttu-id="aa7e6-107">これには Microsoft Visual<sup>C# が</sup>含まれますか?</span><span class="sxs-lookup"><span data-stu-id="aa7e6-107">This includes Microsoft Visual C#<sup>??</sup></span></span> <span data-ttu-id="aa7e6-108">Visual Basic<sup>?</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-108">and Visual Basic<sup>??</sup></span></span> <span data-ttu-id="aa7e6-109">Net.</span><span class="sxs-lookup"><span data-stu-id="aa7e6-109">.NET.</span></span> <span data-ttu-id="aa7e6-110">データは、.NET のクラスまたは構造体のフィールドやプロパティとして公開され、動作はクラスまたは構造体のメソッドによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-110">The data is exposed as fields and properties of a .NET class or structure, and behaviors are defined by methods of the class or structure.</span></span>  
  
 <span data-ttu-id="aa7e6-111">UDT は、テーブルの列定義、[!INCLUDE[tsql](../../../includes/tsql-md.md)] バッチの変数、または [!INCLUDE[tsql](../../../includes/tsql-md.md)] 関数やストアド プロシージャの引数として使用することができます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-111">A UDT can be used as the column definition of a table, as a variable in a [!INCLUDE[tsql](../../../includes/tsql-md.md)] batch, or as an argument of a [!INCLUDE[tsql](../../../includes/tsql-md.md)] function or stored procedure.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="aa7e6-112">SQL Server Native Client OLE DB プロバイダー</span><span class="sxs-lookup"><span data-stu-id="aa7e6-112">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="aa7e6-113">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、udt をメタデータ情報と共にバイナリ型としてサポートします。これにより、udt をオブジェクトとして管理できます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-113">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports UDTs as binary types with metadata information, which allows you to manage UDTs as objects.</span></span> <span data-ttu-id="aa7e6-114">UDT 列は、DBTYPE_UDT 型として公開され、この列のメタデータは主要な OLE DB インターフェイスの **IColumnRowset** と新しいインターフェイスの [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) により公開されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-114">UDT columns are exposed as DBTYPE_UDT, and their metadata are exposed through the core OLE DB interface **IColumnRowset**, and the new [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aa7e6-115">**IRowsetFind::FindNextRow** メソッドでは、UDT データ型を処理できません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-115">The **IRowsetFind::FindNextRow** method does not work with the UDT data type.</span></span> <span data-ttu-id="aa7e6-116">UDT が検索列の型として使用されると、DB_E_BADCOMPAREOP が返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-116">DB_E_BADCOMPAREOP is returned if the UDT is used as a search column type.</span></span>  
  
### <a name="data-bindings-and-coercions"></a><span data-ttu-id="aa7e6-117">データ バインドと強制型変換</span><span class="sxs-lookup"><span data-stu-id="aa7e6-117">Data Bindings and Coercions</span></span>  
 <span data-ttu-id="aa7e6-118">次の表に、特定のデータ型を [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の UDT と共に使用した場合に行われるバインドおよび強制型変換を示します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-118">The following table describes the binding and coercion that occurs when using the listed data types with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT.</span></span> <span data-ttu-id="aa7e6-119">UDT 列は [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DBTYPE_UDT として Native Client OLE DB プロバイダーを介して公開されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-119">UDT columns are exposed through the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider as DBTYPE_UDT.</span></span> <span data-ttu-id="aa7e6-120">この列のメタデータは、適切なスキーマ行セットを使用して取得できるので、独自に定義した型をオブジェクトとして管理できます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-120">You can get metadata through the appropriate schema rowsets so you can manage your own defined types as objects.</span></span>  
  
|<span data-ttu-id="aa7e6-121">データ型</span><span class="sxs-lookup"><span data-stu-id="aa7e6-121">Data type</span></span>|<span data-ttu-id="aa7e6-122">SQL Server の</span><span class="sxs-lookup"><span data-stu-id="aa7e6-122">To Server</span></span><br /><br /> <span data-ttu-id="aa7e6-123">**UDT**</span><span class="sxs-lookup"><span data-stu-id="aa7e6-123">**UDT**</span></span>|<span data-ttu-id="aa7e6-124">SQL Server の</span><span class="sxs-lookup"><span data-stu-id="aa7e6-124">To Server</span></span><br /><br /> <span data-ttu-id="aa7e6-125">**UDT 以外から**</span><span class="sxs-lookup"><span data-stu-id="aa7e6-125">**non-UDT**</span></span>|<span data-ttu-id="aa7e6-126">サーバーからの</span><span class="sxs-lookup"><span data-stu-id="aa7e6-126">From Server</span></span><br /><br /> <span data-ttu-id="aa7e6-127">**UDT**</span><span class="sxs-lookup"><span data-stu-id="aa7e6-127">**UDT**</span></span>|<span data-ttu-id="aa7e6-128">サーバーからの</span><span class="sxs-lookup"><span data-stu-id="aa7e6-128">From Server</span></span><br /><br /> <span data-ttu-id="aa7e6-129">**UDT 以外から**</span><span class="sxs-lookup"><span data-stu-id="aa7e6-129">**non-UDT**</span></span>|  
|---------------|---------------------------|--------------------------------|-----------------------------|----------------------------------|  
|<span data-ttu-id="aa7e6-130">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="aa7e6-130">DBTYPE_UDT</span></span>|<span data-ttu-id="aa7e6-131">サポートされている<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-131">Supported<sup>6</sup></span></span>|<span data-ttu-id="aa7e6-132">エラー<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-132">Error<sup>1</sup></span></span>|<span data-ttu-id="aa7e6-133">サポートされている<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-133">Supported<sup>6</sup></span></span>|<span data-ttu-id="aa7e6-134">エラー<sup>5</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-134">Error<sup>5</sup></span></span>|  
|<span data-ttu-id="aa7e6-135">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="aa7e6-135">DBTYPE_BYTES</span></span>|<span data-ttu-id="aa7e6-136">サポートされている<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-136">Supported<sup>6</sup></span></span>|<span data-ttu-id="aa7e6-137">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-137">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-138">サポートされている<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-138">Supported<sup>6</sup></span></span>|<span data-ttu-id="aa7e6-139">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-139">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="aa7e6-140">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-140">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-141">サポートされている<sup>3、6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-141">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="aa7e6-142">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-142">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-143">サポートされている<sup>4、6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-143">Supported<sup>4,6</sup></span></span>|<span data-ttu-id="aa7e6-144">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-144">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="aa7e6-145">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-145">DBTYPE_BSTR</span></span>|<span data-ttu-id="aa7e6-146">サポートされている<sup>3、6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-146">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="aa7e6-147">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-147">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-148">サポートされている<sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-148">Supported<sup>4</sup></span></span>|<span data-ttu-id="aa7e6-149">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-149">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="aa7e6-150">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-150">DBTYPE_STR</span></span>|<span data-ttu-id="aa7e6-151">サポートされている<sup>3、6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-151">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="aa7e6-152">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-152">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-153">サポートされている<sup>4、6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-153">Supported<sup>4,6</sup></span></span>|<span data-ttu-id="aa7e6-154">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-154">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="aa7e6-155">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="aa7e6-155">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="aa7e6-156">サポートされていません</span><span class="sxs-lookup"><span data-stu-id="aa7e6-156">Not supported</span></span>|<span data-ttu-id="aa7e6-157">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-157">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-158">サポートされていません</span><span class="sxs-lookup"><span data-stu-id="aa7e6-158">Not supported</span></span>|<span data-ttu-id="aa7e6-159">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-159">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="aa7e6-160">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="aa7e6-160">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="aa7e6-161">サポートされている<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-161">Supported<sup>6</sup></span></span>|<span data-ttu-id="aa7e6-162">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-162">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-163">サポートされている<sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-163">Supported<sup>4</sup></span></span>|<span data-ttu-id="aa7e6-164">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-164">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="aa7e6-165">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="aa7e6-165">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="aa7e6-166">サポートされている<sup>3、6</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-166">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="aa7e6-167">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-167">N/A<sup>2</sup></span></span>|<span data-ttu-id="aa7e6-168">該当なし</span><span class="sxs-lookup"><span data-stu-id="aa7e6-168">N/A</span></span>|<span data-ttu-id="aa7e6-169">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="aa7e6-169">N/A<sup>2</sup></span></span>|  
  
 <span data-ttu-id="aa7e6-170"><sup>1</sup>**ICommandWithParameters::SetParameterInfo** で DBTYPE_UDT 以外のサーバーの型が指定され、アクセサーの型が DBTYPE_UDT の場合、ステートメントの実行時にエラー (DB_E_ERRORSOCCURRED) が発生します (パラメーターの状態は DBSTATUS_E_BADACCESSOR になります)。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-170"><sup>1</sup>If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed (DB_E_ERRORSOCCURRED; the parameter status is DBSTATUS_E_BADACCESSOR).</span></span> <span data-ttu-id="aa7e6-171">それ以外の場合、データはサーバーに送信されますが、サーバーからは、UDT からパラメーターのデータ型への暗黙的な変換がないことを示すエラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-171">Otherwise the data is sent to the server, but the server returns an error indicating that there is no implicit conversion from UDT to the parameter's data type.</span></span>  
  
 <span data-ttu-id="aa7e6-172"><sup>2</sup>このトピックでは扱いません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-172"><sup>2</sup>Beyond the scope of this topic.</span></span>  
  
 <span data-ttu-id="aa7e6-173"><sup>3</sup> 16 進文字列からバイナリ データへのデータ変換が行われます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-173"><sup>3</sup> Data conversion from hex string to binary data occurs.</span></span>  
  
 <span data-ttu-id="aa7e6-174"><sup>4</sup> バイナリ データから 16 進文字列へのデータ変換が行われます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-174"><sup>4</sup> Data conversion from binary data to hex string occurs.</span></span>  
  
 <span data-ttu-id="aa7e6-175"><sup>5</sup>アクセサーの作成時またはフェッチ時に検証が行われることがあります。エラー DB_E_ERRORSOCCURRED が返され、バインドの状態は DBBINDSTATUS_UNSUPPORTEDCONVERSION になります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-175"><sup>5</sup>Validation can occur at create accessor time, or at fetch time, the error is DB_E_ERRORSOCCURRED, binding status set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>  
  
 <span data-ttu-id="aa7e6-176"><sup>6</sup>BY_REF を使用できます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-176"><sup>6</sup>BY_REF may be used.</span></span>  
  
 <span data-ttu-id="aa7e6-177">DBTYPE_NULL と DBTYPE_EMPTY は入力パラメーターにバインドできますが、出力パラメーターや結果にはバインドできません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-177">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters but not for output parameters or results.</span></span> <span data-ttu-id="aa7e6-178">入力パラメーターにバインドした場合、状態を DBSTATUS_S_ISNULL または DBSTATUS_S_DEFAULT に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-178">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL or DBSTATUS_S_DEFAULT.</span></span>  
  
 <span data-ttu-id="aa7e6-179">DBTYPE_UDT 型は、DBTYPE_EMPTY と DBTYPE_NULL に変換できますが、DBTYPE_EMPTY と DBTYPE_NULL は DBTYPE_UDT に変換できません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-179">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL, but DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="aa7e6-180">この動作は、DBTYPE_BYTES 型と一貫性があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-180">This is consistent with DBTYPE_BYTES.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aa7e6-181">UDT をパラメーターとして処理するための新しいインターフェイス **ISSCommandWithParameters** が導入されました。これは、**ICommandWithParameters** インターフェイスから継承されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-181">A new interface is used for dealing with UDTs as parameters, **ISSCommandWithParameters**, which inherits from **ICommandWithParameters**.</span></span> <span data-ttu-id="aa7e6-182">アプリケーションでは、少なくとも UDT パラメーターの SSPROP_PARAM_UDT_NAME プロパティ セットの DBPROPSET_SQLSERVERPARAMETER プロパティの設定に、このインターフェイスを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-182">Applications must use this interface to set at least the SSPROP_PARAM_UDT_NAME of the DBPROPSET_SQLSERVERPARAMETER property set for UDT parameters.</span></span> <span data-ttu-id="aa7e6-183">これを行わないと、**ICommand::Execute** から DB_E_ERRORSOCCURRED が返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-183">If this is not done, **ICommand::Execute** will return DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="aa7e6-184">このインターフェイスとプロパティ セットについては、このトピックの後半で説明します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-184">This interface and property set is described later in this topic.</span></span>  
  
 <span data-ttu-id="aa7e6-185">データをすべて格納できる大きさがない列にユーザー定義型を挿入した場合、**ICommand::Execute** は状態が DB_E_ERRORSOCCURRED の S_OK を返します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-185">If a user-defined type is inserted into a column that is not large enough to hold all its data, **ICommand::Execute** will return S_OK with a status of DB_E_ERRORSOCCURRED.</span></span>  
  
 <span data-ttu-id="aa7e6-186">OLE DB Core Services で提供されるデータ変換 (**IDataConvert**) は、DBTYPE_UDT 型には適用できません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-186">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span> <span data-ttu-id="aa7e6-187">また、その他のバインドもサポートされません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-187">No other bindings are supported.</span></span>  
  
### <a name="ole-db-rowset-additions-and-changes"></a><span data-ttu-id="aa7e6-188">OLE DB 行セットに関する追加事項と変更事項</span><span class="sxs-lookup"><span data-stu-id="aa7e6-188">OLE DB Rowset Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="aa7e6-189">Native Client では、新しい値または多くのコア OLE DB スキーマ行セットへの変更が追加されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-189">Native Client adds new values or changes to many of the core OLE DB schema rowsets.</span></span>  
  
#### <a name="the-procedure_parameters-schema-rowset"></a><span data-ttu-id="aa7e6-190">PROCEDURE_PARAMETERS スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-190">The PROCEDURE_PARAMETERS Schema Rowset</span></span>  
 <span data-ttu-id="aa7e6-191">PROCEDURE_PARAMETERS スキーマ行セットには、次の列が追加されました。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-191">The following additions have been made to the PROCEDURE_PARAMETERS schema rowset.</span></span>  
  
|<span data-ttu-id="aa7e6-192">列名</span><span class="sxs-lookup"><span data-stu-id="aa7e6-192">Column name</span></span>|<span data-ttu-id="aa7e6-193">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-193">Type</span></span>|<span data-ttu-id="aa7e6-194">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-194">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-195">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-195">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-196">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-196">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-197">3 部構成の名前の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-197">The three-part name identifier.</span></span>|  
|<span data-ttu-id="aa7e6-198">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-198">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-199">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-199">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-200">3 部構成の名前の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-200">The three-part name identifier.</span></span>|  
|<span data-ttu-id="aa7e6-201">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-201">SS_UDT_NAME</span></span>|<span data-ttu-id="aa7e6-202">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-202">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-203">3 部構成の名前の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-203">The three-part name identifier.</span></span>|  
|<span data-ttu-id="aa7e6-204">SS_UDT_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-204">SS_UDT_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="aa7e6-205">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-205">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-206">型名と、CLR での参照に必要なすべてのアセンブリ ID を含むアセンブリ修飾名。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-206">The Assembly Qualified Name, which includes the type name and all the assembly identification necessary to be referenced by the CLR.</span></span>|  
  
#### <a name="the-sql_assemblies-schema-rowset"></a><span data-ttu-id="aa7e6-207">SQL_ASSEMBLIES スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-207">The SQL_ASSEMBLIES Schema Rowset</span></span>  
 <span data-ttu-id="aa7e6-208">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、登録されている udt を記述する新しいプロバイダー固有のスキーマ行セットを公開します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-208">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider exposes a new provider specific schema rowset that describes the registered UDTs.</span></span> <span data-ttu-id="aa7e6-209">ASSEMBLY_SERVER を DBTYPE_WSTR 型として指定することはできますが、行セットには格納されません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-209">The ASSEMBLY server may be specified as a DBTYPE_WSTR, but is not present in the rowset.</span></span> <span data-ttu-id="aa7e6-210">指定しない場合、行セットでは既定で現在のサーバーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-210">If not specified, the rowset will default to the current server.</span></span> <span data-ttu-id="aa7e6-211">次の表に、SQL_ASSEMBLIES スキーマ行セットの定義を示します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-211">The SQL_ASSEMBLIES schema rowset is defined in the following table.</span></span>  
  
|<span data-ttu-id="aa7e6-212">列名</span><span class="sxs-lookup"><span data-stu-id="aa7e6-212">Column name</span></span>|<span data-ttu-id="aa7e6-213">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-213">Type</span></span>|<span data-ttu-id="aa7e6-214">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-214">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-215">ASSEMBLY_CATALOG</span><span class="sxs-lookup"><span data-stu-id="aa7e6-215">ASSEMBLY_CATALOG</span></span>|<span data-ttu-id="aa7e6-216">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-216">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-217">このデータ型を含むアセンブリのカタログ名。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-217">The catalog name of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="aa7e6-218">ASSEMBLY_SCHEMA</span><span class="sxs-lookup"><span data-stu-id="aa7e6-218">ASSEMBLY_SCHEMA</span></span>|<span data-ttu-id="aa7e6-219">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-219">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-220">このデータ型を含むアセンブリのスキーマ名 (所有者の名前)。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-220">The schema name, or owner name, of the assembly that contains the type.</span></span> <span data-ttu-id="aa7e6-221">アセンブリのスコープはスキーマではなくデータベースによって決まりますが、アセンブリには依然として所有者が存在します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-221">Although assemblies are scoped by database and not by schema, they still have an owner which is reflected here.</span></span>|  
|<span data-ttu-id="aa7e6-222">ASSEMBLY_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-222">ASSEMBLY_NAME</span></span>|<span data-ttu-id="aa7e6-223">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-223">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-224">このデータ型を含むアセンブリの名前。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-224">The name of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="aa7e6-225">ASSEMBLY_ID</span><span class="sxs-lookup"><span data-stu-id="aa7e6-225">ASSEMBLY_ID</span></span>|<span data-ttu-id="aa7e6-226">DBTYPE_UI4</span><span class="sxs-lookup"><span data-stu-id="aa7e6-226">DBTYPE_UI4</span></span>|<span data-ttu-id="aa7e6-227">このデータ型を含むアセンブリのオブジェクト ID。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-227">The object id of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="aa7e6-228">PERMISSION_SET</span><span class="sxs-lookup"><span data-stu-id="aa7e6-228">PERMISSION_SET</span></span>|<span data-ttu-id="aa7e6-229">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-229">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-230">アセンブリのアクセスのスコープを示す値。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-230">A value that indicates the scope of access for the assembly.</span></span> <span data-ttu-id="aa7e6-231">スコープを示す値には、"SAFE"、"EXTERNAL_ACCESS"、および "UNSAFE" があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-231">Values include "SAFE", "EXTERNAL_ACCESS", and "UNSAFE".</span></span>|  
|<span data-ttu-id="aa7e6-232">ASSEMBLY_BINARY</span><span class="sxs-lookup"><span data-stu-id="aa7e6-232">ASSEMBLY_BINARY</span></span>|<span data-ttu-id="aa7e6-233">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="aa7e6-233">DBTYPE_BYTES</span></span>|<span data-ttu-id="aa7e6-234">アセンブリのバイナリ表記。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-234">The binary representation of the assembly.</span></span>|  
  
#### <a name="the-sql_assemblies_-dependencies-schema-rowset"></a><span data-ttu-id="aa7e6-235">SQL_ASSEMBLIES_ DEPENDENCIES スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-235">The SQL_ASSEMBLIES_ DEPENDENCIES Schema Rowset</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="aa7e6-236">Native Client OLE DB プロバイダーは、指定されたサーバーのアセンブリの依存関係を記述する、プロバイダー固有の新しいスキーマ行セットを公開します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-236">Native Client OLE DB provider exposes a new provider-specific schema rowset that describes the assembly dependencies for a specified server.</span></span> <span data-ttu-id="aa7e6-237">ASSEMBLY_SERVER は呼び出し元により DBTYPE_WSTR 型として指定することができますが、行セットには格納されません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-237">ASSEMBLY_SERVER may be specified by the caller as a DBTYPE_WSTR, but is not present in the rowset.</span></span> <span data-ttu-id="aa7e6-238">指定しない場合、行セットでは既定で現在のサーバーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-238">If not specified, the rowset will default to the current server.</span></span> <span data-ttu-id="aa7e6-239">次の表に、SQL_ASSEMBLY_DEPENDENCIES スキーマ行セットの定義を示します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-239">The SQL_ASSEMBLY_DEPENDENCIES schema rowset is defined in the following table.</span></span>  
  
|<span data-ttu-id="aa7e6-240">列名</span><span class="sxs-lookup"><span data-stu-id="aa7e6-240">Column name</span></span>|<span data-ttu-id="aa7e6-241">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-241">Type</span></span>|<span data-ttu-id="aa7e6-242">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-242">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-243">ASSEMBLY_CATALOG</span><span class="sxs-lookup"><span data-stu-id="aa7e6-243">ASSEMBLY_CATALOG</span></span>|<span data-ttu-id="aa7e6-244">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-244">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-245">このデータ型を含むアセンブリのカタログ名。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-245">The catalog name of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="aa7e6-246">ASSEMBLY_SCHEMA</span><span class="sxs-lookup"><span data-stu-id="aa7e6-246">ASSEMBLY_SCHEMA</span></span>|<span data-ttu-id="aa7e6-247">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-247">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-248">このデータ型を含むアセンブリのスキーマ名 (所有者の名前)。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-248">The schema name, or owner name, of the assembly that contains the type.</span></span> <span data-ttu-id="aa7e6-249">アセンブリのスコープはスキーマではなくデータベースによって決まりますが、アセンブリには依然として所有者が存在します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-249">Although assemblies are scoped by database and not by schema, they still have an owner, which is reflected here.</span></span>|  
|<span data-ttu-id="aa7e6-250">ASSEMBLY_ID</span><span class="sxs-lookup"><span data-stu-id="aa7e6-250">ASSEMBLY_ID</span></span>|<span data-ttu-id="aa7e6-251">DBTYPE_UI4</span><span class="sxs-lookup"><span data-stu-id="aa7e6-251">DBTYPE_UI4</span></span>|<span data-ttu-id="aa7e6-252">アセンブリのオブジェクト ID。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-252">The object id of the assembly.</span></span>|  
|<span data-ttu-id="aa7e6-253">REFERENCED_ASSEMBLY_ID</span><span class="sxs-lookup"><span data-stu-id="aa7e6-253">REFERENCED_ASSEMBLY_ID</span></span>|<span data-ttu-id="aa7e6-254">DBTYPE_UI4</span><span class="sxs-lookup"><span data-stu-id="aa7e6-254">DBTYPE_UI4</span></span>|<span data-ttu-id="aa7e6-255">参照されるアセンブリのオブジェクト ID。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-255">The object id of the referenced assembly.</span></span>|  
  
#### <a name="the-sql_user_types-schema-rowset"></a><span data-ttu-id="aa7e6-256">SQL_USER_TYPES スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-256">The SQL_USER_TYPES Schema Rowset</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="aa7e6-257">Native Client OLE DB プロバイダーは、指定されたサーバーの登録済み Udt が追加されるタイミングを記述する、SQL_USER_TYPES の新しいスキーマ行セットを公開します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-257">Native Client OLE DB provider exposes new schema rowset, SQL_USER_TYPES, that describes when the registered UDTs for a specified server is added.</span></span> <span data-ttu-id="aa7e6-258">UDT_SERVER は、呼び出し元により DBTYPE_WSTR 型として指定される必要がありますが、行セットには格納されません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-258">UDT_SERVER must be specified as a DBTYPE_WSTR by the caller but is not present in the rowset.</span></span> <span data-ttu-id="aa7e6-259">次の表に、SQL_USER_TYPES スキーマ行セットの定義を示します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-259">The SQL_USER_TYPES schema rowset is defined in the following table.</span></span>  
  
|<span data-ttu-id="aa7e6-260">列名</span><span class="sxs-lookup"><span data-stu-id="aa7e6-260">Column name</span></span>|<span data-ttu-id="aa7e6-261">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-261">Type</span></span>|<span data-ttu-id="aa7e6-262">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-262">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-263">UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-263">UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-265">UDT 列の場合、このプロパティは、UDT が定義されているカタログ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-265">For UDT columns this property is a string specifying the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="aa7e6-266">UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-266">UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-267">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-267">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-268">UDT 列の場合、このプロパティは、UDT が定義されているスキーマ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-268">For UDT columns this property is a string specifying the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="aa7e6-269">UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-269">UDT_NAME</span></span>|<span data-ttu-id="aa7e6-270">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-270">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-271">UDT を含むアセンブリの名前。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-271">The name of the assembly containing the UDT class.</span></span>|  
|<span data-ttu-id="aa7e6-272">UDT_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-272">UDT_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="aa7e6-273">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-273">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-274">型名の前に名前空間を付けた完全な型名 (AQN) (該当する場合)。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-274">Full type name (AQN) includes type name prefixed by namespace if applicable.</span></span>|  
  
#### <a name="the-columns-schema-rowset"></a><span data-ttu-id="aa7e6-275">COLUMNS スキーマ行セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-275">The COLUMNS Schema Rowset</span></span>  
 <span data-ttu-id="aa7e6-276">COLUMNS スキーマ行セットには、次の列が追加されました。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-276">Additions to the COLUMNS schema rowset include the following columns.</span></span>  
  
|<span data-ttu-id="aa7e6-277">列名</span><span class="sxs-lookup"><span data-stu-id="aa7e6-277">Column name</span></span>|<span data-ttu-id="aa7e6-278">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-278">Type</span></span>|<span data-ttu-id="aa7e6-279">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-279">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-280">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-280">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-281">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-281">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-282">UDT 列の場合、このプロパティは、UDT が定義されているカタログ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-282">For UDT columns this property is a string specifying the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="aa7e6-283">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-283">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-284">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-284">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-285">UDT 列の場合、このプロパティは、UDT が定義されているスキーマ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-285">For UDT columns this property is a string specifying the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="aa7e6-286">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-286">SS_UDT_NAME</span></span>|<span data-ttu-id="aa7e6-287">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-287">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-288">UDT の名前。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-288">The name of the UDT</span></span>|  
|<span data-ttu-id="aa7e6-289">SS_UDT_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-289">SS_UDT_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="aa7e6-290">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-290">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-291">型名の前に名前空間を付けた完全な型名 (AQN) (該当する場合)。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-291">Full type name (AQN) includes type name prefixed by namespace if applicable.</span></span>|  
  
### <a name="ole-db-property-set-additions-and-changes"></a><span data-ttu-id="aa7e6-292">OLE DB プロパティ セットに関する追加事項と変更事項</span><span class="sxs-lookup"><span data-stu-id="aa7e6-292">OLE DB Property Set Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="aa7e6-293">Native Client では、多くの主要な OLE DB プロパティセットに新しい値または変更が追加されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-293">Native Client adds new values or changes to many of the core OLE DB property sets.</span></span>  
  
#### <a name="the-dbpropset_sqlserverparameter-property-set"></a><span data-ttu-id="aa7e6-294">DBPROPSET_SQLSERVERPARAMETER プロパティ セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-294">The DBPROPSET_SQLSERVERPARAMETER Property Set</span></span>  
 <span data-ttu-id="aa7e6-295">OLE DB を通じて Udt をサポートするために、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client は、次の値を含む新しい DBPROPSET_SQLSERVERPARAMETER プロパティセットを実装します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-295">In order to support UDTs through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements the new DBPROPSET_SQLSERVERPARAMETER property set which contains the following values.</span></span>  
  
|<span data-ttu-id="aa7e6-296">名前</span><span class="sxs-lookup"><span data-stu-id="aa7e6-296">Name</span></span>|<span data-ttu-id="aa7e6-297">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-297">Type</span></span>|<span data-ttu-id="aa7e6-298">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-298">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="aa7e6-299">SSPROP_PARAM_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-299">SSPROP_PARAM_UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-300">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-300">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-301">3 部構成の名前の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-301">The three-part name identifier.</span></span><br /><br /> <span data-ttu-id="aa7e6-302">UDT パラメーターの場合、このプロパティは、ユーザー定義型が定義されているカタログ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-302">For UDT parameters, this property is a string that specifies the name of the catalog where the user-defined type is defined.</span></span>|  
|<span data-ttu-id="aa7e6-303">SSPROP_PARAM_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-303">SSPROP_PARAM_UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-304">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-304">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-305">3 部構成の名前の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-305">The three-part name identifier.</span></span><br /><br /> <span data-ttu-id="aa7e6-306">UDT パラメーターの場合、このプロパティは、ユーザー定義型が定義されているスキーマ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-306">For UDT parameters, this property is a string that specifies the name of the schema where the user-defined type is defined.</span></span>|  
|<span data-ttu-id="aa7e6-307">SSPROP_PARAM_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-307">SSPROP_PARAM_UDT_NAME</span></span>|<span data-ttu-id="aa7e6-308">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-308">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-309">3 部構成の名前の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-309">The three-part name identifier.</span></span><br /><br /> <span data-ttu-id="aa7e6-310">UDT 列の場合、このプロパティは、ユーザー定義型の 1 部構成の名前を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-310">For UDT columns, this property is a string that specifies the single part name of the user-defined type.</span></span>|  
  
 <span data-ttu-id="aa7e6-311">SSPROP_PARAM_UDT_NAME は必須です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-311">SSPROP_PARAM_UDT_NAME is mandatory.</span></span> <span data-ttu-id="aa7e6-312">SSPROP_PARAM_UDT_CATALOGNAME と SSPROP_PARAM_UDT_SCHEMANAME は省略可能です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-312">SSPROP_PARAM_UDT_CATALOGNAME and SSPROP_PARAM_UDT_SCHEMANAME are optional.</span></span> <span data-ttu-id="aa7e6-313">いずれかのプロパティが適切に指定されていない場合、DB_E_ERRORSINCOMMAND が返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-313">If any of the properties are specified incorrectly DB_E_ERRORSINCOMMAND will be returned.</span></span> <span data-ttu-id="aa7e6-314">SSPROP_PARAM_UDT_CATALOGNAME プロパティと SSPROP_PARAM_UDT_SCHEMANAME プロパティがどちらも指定されていない場合、UDT は、テーブルと同じデータベースおよびスキーマ内に定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-314">If both SSPROP_PARAM_UDT_CATALOGNAME and SSPROP_PARAM_UDT_SCHEMANAME are not specified, then the UDT must be defined in the same database and schema as the table.</span></span> <span data-ttu-id="aa7e6-315">UDT の定義が、テーブルと同じデータベース内にあって、同じスキーマ内にない場合、SSPROP_PARAM_UDT_SCHEMANAME プロパティを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-315">If the UDT definition is not in the same schema as the table (but is in the same database), then SSPROP_PARAM_UDT_SCHEMANAME must be specified.</span></span> <span data-ttu-id="aa7e6-316">UDT の定義がテーブルと異なるデータベースにある場合、SSPROP_PARAM_UDT_CATALOGNAME プロパティと SSPROP_PARAM_UDT_SCHEMANAME プロパティの両方を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-316">If the UDT definition is in a different database then both SSPROP_PARAM_UDT_CATALOGNAME and SSPROP_PARAM_UDT_SCHEMANAME must be specified.</span></span>  
  
#### <a name="the-dbpropset_sqlservercolumn-property-set"></a><span data-ttu-id="aa7e6-317">DBPROPSET_SQLSERVERCOLUMN プロパティ セット</span><span class="sxs-lookup"><span data-stu-id="aa7e6-317">The DBPROPSET_SQLSERVERCOLUMN Property Set</span></span>  
 <span data-ttu-id="aa7e6-318">**Itabledefinition**インターフェイスでのテーブルの作成をサポートするために、Native Client では、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 次の3つの新しい列が DBPROPSET_SQLSERVERCOLUMN プロパティセットに追加されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-318">To support the creation of tables in the **ITableDefinition** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client adds the following three new columns to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span>  
  
|<span data-ttu-id="aa7e6-319">名前</span><span class="sxs-lookup"><span data-stu-id="aa7e6-319">Name</span></span>|<span data-ttu-id="aa7e6-320">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-320">Description</span></span>|<span data-ttu-id="aa7e6-321">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-321">Type</span></span>|<span data-ttu-id="aa7e6-322">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-322">Description</span></span>|  
|----------|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-323">SSPROP_COL_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-323">SSPROP_COL_UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-324">UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-324">UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-325">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-325">VT_BSTR</span></span>|<span data-ttu-id="aa7e6-326">DBTYPE_UDT 型の列の場合、このプロパティは、UDT が定義されているカタログ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-326">For columns of type DBTYPE_UDT, this property is a string specifying the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="aa7e6-327">SSPROP_COL_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-327">SSPROP_COL_UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-328">UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-328">UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-329">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-329">VT_BSTR</span></span>|<span data-ttu-id="aa7e6-330">DBTYPE_UDT 型の列の場合、このプロパティは、UDT が定義されているスキーマ名を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-330">For columns of type DBTYPE_UDT, this property is a string specifying the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="aa7e6-331">SSPROP_COL_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-331">SSPROP_COL_UDT_NAME</span></span>|<span data-ttu-id="aa7e6-332">UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-332">UDT_NAME</span></span>|<span data-ttu-id="aa7e6-333">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-333">VT_BSTR</span></span>|<span data-ttu-id="aa7e6-334">DBTYPE_UDT 型の列の場合、このプロパティは、UDT の 1 部構成の名前を指定する文字列です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-334">For columns of type DBTYPE_UDT, this property is a string specifying the single part name of the UDT.</span></span> <span data-ttu-id="aa7e6-335">他の列の型の場合、このプロパティでは空文字列が返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-335">For other column types, this property returns an empty string.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="aa7e6-336">UDT は PROVIDER_TYPES スキーマ行セットには表示されません。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-336">UDTs do not appear in the PROVIDER_TYPES schema rowset.</span></span> <span data-ttu-id="aa7e6-337">すべての列は読み取り/書き込みアクセスです。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-337">All columns have read and write access.</span></span>  
  
 <span data-ttu-id="aa7e6-338">ADO では、"説明" 列の対応するエントリを使用してこれらのプロパティを参照します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-338">ADO will refer to these properties by using the corresponding entry in the Description column.</span></span>  
  
 <span data-ttu-id="aa7e6-339">SSPROP_COL_UDTNAME は必須です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-339">SSPROP_COL_UDTNAME is mandatory.</span></span> <span data-ttu-id="aa7e6-340">SSPROP_COL_UDT_CATALOGNAME と SSPROP_COL_UDT_SCHEMANAME は省略可能です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-340">SSPROP_COL_UDT_CATALOGNAME and SSPROP_COL_UDT_SCHEMANAME are optional.</span></span> <span data-ttu-id="aa7e6-341">いずれかのプロパティが適切に指定されていない場合、`DB_E_ERRORSINCOMMAND` が返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-341">If any of the properties are specified incorrectly, `DB_E_ERRORSINCOMMAND` will be returned.</span></span>  
  
 <span data-ttu-id="aa7e6-342">SSPROP_COL_UDT_CATALOGNAME プロパティと SSPROP_COL_UDT_SCHEMANAME プロパティがどちらも指定されていない場合、UDT は、テーブルと同じデータベースおよびスキーマ内に定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-342">If neither SSPROP_COL_UDT_CATALOGNAME nor SSPROP_COL_UDT_SCHEMANAME is specified, the UDT must be defined in the same database and schema as the table.</span></span>  
  
 <span data-ttu-id="aa7e6-343">UDT の定義が、テーブルと同じデータベース内にあって、同じスキーマ内にない場合、SSPROP_COL_UDT_SCHEMANAME プロパティを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-343">If the UDT definition is not in the same schema as the table (but is in the same database), SSPROP_COL_UDT_SCHEMANAME must be specified.</span></span>  
  
 <span data-ttu-id="aa7e6-344">UDT の定義がテーブルと異なるデータベースにある場合、SSPROP_COL_UDT_CATALOGNAME プロパティと SSPROP_COL_UDT_SCHEMANAME プロパティの両方を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-344">If the UDT definition is in a different database, both SSPROP_COL_UDT_CATALOGNAME and SSPROP_COL_UDT_SCHEMANAME must be specified.</span></span>  
  
### <a name="ole-db-interface-additions-and-changes"></a><span data-ttu-id="aa7e6-345">OLE DB インターフェイスに関する追加事項と変更事項</span><span class="sxs-lookup"><span data-stu-id="aa7e6-345">OLE DB Interface Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="aa7e6-346">Native Client では、コア OLE DB インターフェイスの多くに新しい値または変更を追加します。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-346">Native Client adds new values or changes to many of the core OLE DB interfaces.</span></span>  
  
#### <a name="the-isscommandwithparameters-interface"></a><span data-ttu-id="aa7e6-347">ISSCommandWithParameters インターフェイス</span><span class="sxs-lookup"><span data-stu-id="aa7e6-347">The ISSCommandWithParameters Interface</span></span>  
 <span data-ttu-id="aa7e6-348">OLE DB を通じて Udt をサポートするために、Native Client では、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **Isscommandwithparameters**インターフェイスの追加など、多数の変更が実装されています。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-348">To support UDTs through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements a number of changes, including the addition of the **ISSCommandWithParameters** interface.</span></span> <span data-ttu-id="aa7e6-349">この新しいインターフェイスは、主要な OLE DB インターフェイス **ICommandWithParameters** から継承されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-349">This new interface inherits from the core OLE DB interface **ICommandWithParameters**.</span></span> <span data-ttu-id="aa7e6-350">**ICommandWithParameters**から継承された3つのメソッドに加えて、**Getparameterinfo**、 **Mapparameternames**、および**setparameterinfo**;**Isscommandwithparameters**には、サーバー固有のデータ型を処理するために使用される**getparameterproperties**メソッドと**setparameterproperties**メソッドが用意されています。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-350">In addition to the three methods inherited from **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**, and **SetParameterInfo**; **ISSCommandWithParameters** provides the **GetParameterProperties** and **SetParameterProperties** methods that are used to handle server specific data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aa7e6-351">**ISSCommandWithParameters** インターフェイスでは、新しい SSPARAMPROPS 構造体も使用されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-351">The **ISSCommandWithParameters** interface also makes use of the new SSPARAMPROPS structure.</span></span>  
  
#### <a name="the-icolumnsrowset-interface"></a><span data-ttu-id="aa7e6-352">IColumnsRowset インターフェイス</span><span class="sxs-lookup"><span data-stu-id="aa7e6-352">The IColumnsRowset Interface</span></span>  
 <span data-ttu-id="aa7e6-353">Native Client では、 **Isscommandwithparameters**インターフェイスに加えて、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 次のような**IColumnsRowset:: getcolumnrowset**メソッドの呼び出しから返される行セットに新しい値が追加されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-353">In addition to the **ISSCommandWithParameters** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client also adds new values to the rowset returned from calling the **IColumnsRowset::GetColumnRowset** method including the following.</span></span>  
  
|<span data-ttu-id="aa7e6-354">列名</span><span class="sxs-lookup"><span data-stu-id="aa7e6-354">Column Name</span></span>|<span data-ttu-id="aa7e6-355">Type</span><span class="sxs-lookup"><span data-stu-id="aa7e6-355">Type</span></span>|<span data-ttu-id="aa7e6-356">説明</span><span class="sxs-lookup"><span data-stu-id="aa7e6-356">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="aa7e6-357">DBCOLUMN_SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-357">DBCOLUMN_SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="aa7e6-358">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-358">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-359">UDT カタログ名の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-359">A UDT catalog name identifier.</span></span>|  
|<span data-ttu-id="aa7e6-360">DBCOLUMN_SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-360">DBCOLUMN_SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="aa7e6-361">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-361">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-362">UDT スキーマ名の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-362">A UDT schema name identifier.</span></span>|  
|<span data-ttu-id="aa7e6-363">DBCOLUMN_SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-363">DBCOLUMN_SS_UDT_NAME</span></span>|<span data-ttu-id="aa7e6-364">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-364">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-365">UDT 名の識別子。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-365">A UDT name identifier.</span></span>|  
|<span data-ttu-id="aa7e6-366">DBCOLUMN_SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="aa7e6-366">DBCOLUMN_SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="aa7e6-367">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="aa7e6-367">DBTYPE_WSTR</span></span>|<span data-ttu-id="aa7e6-368">型名と、CLR での参照に必要なすべてのアセンブリ ID を含むアセンブリ修飾名。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-368">The assembly qualified name, which includes the type name and all the assembly identification necessary to be referenced by the CLR.</span></span>|  
  
 <span data-ttu-id="aa7e6-369">DBCOLUMN_TYPE を DBTYPE_UDT に設定すると、上記の新しく追加された UDT メタデータを参照することにより、サーバーの UDT 列と他のバイナリ型列とを区別することができます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-369">You can differentiate a server UDT column from other binary types when the DBCOLUMN_TYPE is set to DBTYPE_UDT by looking at the added UDT metadata specified above.</span></span> <span data-ttu-id="aa7e6-370">そのデータが部分的に完成している場合、サーバーのデータ型は UDT になります。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-370">If that data is partially complete, the server type is a UDT.</span></span> <span data-ttu-id="aa7e6-371">サーバーのデータ型が UDT 以外の場合、これらの列は、常に NULL として返されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-371">For non-UDT server types, these columns are always returned as NULL.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="aa7e6-372">SQL Server Native Client ODBC ドライバー</span><span class="sxs-lookup"><span data-stu-id="aa7e6-372">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="aa7e6-373">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Udt をサポートするために、Native CLIENT ODBC ドライバーでいくつかの変更が加えられました。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-373">A number of changes have been made in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver to support UDTs.</span></span> <span data-ttu-id="aa7e6-374">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーは、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT を SQL_SS_UDT ドライバー固有の SQL データ型識別子にマップします。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-374">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maps the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT to SQL_SS_UDT driver-specific SQL data type identifier.</span></span> <span data-ttu-id="aa7e6-375">UDT 列は SQL_SS_UDT 型としてマップされます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-375">UDT columns are surfaced as SQL_SS_UDT.</span></span> <span data-ttu-id="aa7e6-376">Udt の**ToString**メソッドまたは**ToXMLString**メソッドを使用して、udt 列を SQL ステートメント内の別の型に明示的にマップする場合、または**CAST/CONVERT**関数を使用して、結果セット内の列の型に、列の変換後の実際の型が反映されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-376">If you map a UDT column explicitly to another type in a SQL statement by using the **ToString** or **ToXMLString** methods of the UDT or via the **CAST/CONVERT** function, the type of the column in the result set reflects the actual type the column was converted to</span></span>  
  
### <a name="sqlcolattribute-sqldescribeparam-sqlgetdescfield"></a><span data-ttu-id="aa7e6-377">SQLColAttribute、SQLDescribeParam、SQLGetDescField</span><span class="sxs-lookup"><span data-stu-id="aa7e6-377">SQLColAttribute, SQLDescribeParam, SQLGetDescField</span></span>  
 <span data-ttu-id="aa7e6-378">新しい4つのドライバー固有の記述子フィールドが追加されました。これにより、結果セットの UDT 列、またはストアドプロシージャやパラメーター化されたクエリの UDT パラメーターの追加情報を、 [Sqlcolattribute](../../native-client-odbc-api/sqlcolattribute.md)、 [SQLDescribeParam](../../native-client-odbc-api/sqldescribeparam.md)、および[SQLGetDescField](../../native-client-odbc-api/sqlgetdescfield.md)関数を使用して取得できます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-378">Four new driver-specific descriptor fields have been added to provide additional information for either a UDT column of a result set, or a UDT parameter of stored procedure/parameterized query, to be retrieved via the [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md), [SQLDescribeParam](../../native-client-odbc-api/sqldescribeparam.md), and [SQLGetDescField](../../native-client-odbc-api/sqlgetdescfield.md) functions.</span></span>  
  
 <span data-ttu-id="aa7e6-379">新しく追加された記述子フィールドは、SQL_CA_SS_UDT_CATALOG_NAME、SQL_CA_SS_UDT_SCHEMA_NAME、SQL_CA_SS_UDT_TYPE_NAME、および SQL_CA_SS_UDT_ASSEMBLY_TYPE_NAME です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-379">The four new descriptor fields that have been added are SQL_CA_SS_UDT_CATALOG_NAME, SQL_CA_SS_UDT_SCHEMA_NAME, SQL_CA_SS_UDT_TYPE_NAME, and SQL_CA_SS_UDT_ASSEMBLY_TYPE_NAME.</span></span>  
  
### <a name="sqlcolumns-sqlprocedurecolumns"></a><span data-ttu-id="aa7e6-380">SQLColumns、SQLProcedureColumns</span><span class="sxs-lookup"><span data-stu-id="aa7e6-380">SQLColumns, SQLProcedureColumns</span></span>  
 <span data-ttu-id="aa7e6-381">さらに、 [sqlcolumns](../../native-client-odbc-api/sqlcolumns.md)関数と[SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md)関数から返される結果セットには、新しいドライバー固有の3つの列が追加され、udt 結果セット列または udt パラメーターに関する追加情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-381">In addition, three new driver specific columns are added to the result set returned from the [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) and [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) functions to provide additional information about either a UDT result set column or a UDT parameter.</span></span> <span data-ttu-id="aa7e6-382">新しく追加された 3 つの列は、SS_UDT_CATALOG_NAME、SS_UDT_SCHEMA_NAME、および SS_UDT_ASSEMBLY_TYPE_NAME です。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-382">These three new columns are SS_UDT_CATALOG_NAME, SS_UDT_SCHEMA_NAME, and SS_UDT_ASSEMBLY_TYPE_NAME.</span></span>  
  
### <a name="supported-conversions"></a><span data-ttu-id="aa7e6-383">サポートされる変換</span><span class="sxs-lookup"><span data-stu-id="aa7e6-383">Supported Conversions</span></span>  
 <span data-ttu-id="aa7e6-384">SQL データ型から C データ型に変換する際、SQL_C_WCHAR、SQL_C_BINARY、および SQL_C_CHAR は、すべて SQL_SS_UDT に変換できます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-384">When converting from SQL to C data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_UDT.</span></span> <span data-ttu-id="aa7e6-385">ただし、SQL_C_WCHAR と SQL_C_CHAR SQL から変換した場合、バイナリ データは 16 進文字列に変換されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-385">Note, however, that binary data is converted to a hex string when converting from the SQL_C_WCHAR and SQL_C_CHAR SQL data types.</span></span>  
  
 <span data-ttu-id="aa7e6-386">C データ型から SQL データ型に変換する際、SQL_C_WCHAR、SQL_C_BINARY、および SQL_C_CHAR は、すべて SQL_SS_UDT に変換できます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-386">When converting from C to SQL data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_UDT.</span></span> <span data-ttu-id="aa7e6-387">ただし、SQL_C_WCHAR および SQL_C_CHAR SQL データ型から変換する場合、バイナリデータは16進数の文字列に変換されます。</span><span class="sxs-lookup"><span data-stu-id="aa7e6-387">Note however that binary data is converted to a hex string when converting from the SQL_C_WCHAR and SQL_C_CHAR SQL data types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aa7e6-388">参照</span><span class="sxs-lookup"><span data-stu-id="aa7e6-388">See Also</span></span>  
 <span data-ttu-id="aa7e6-389">[SQL Server Native Client の機能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="aa7e6-389">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="aa7e6-390">ISSCommandWithParameters &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="aa7e6-390">ISSCommandWithParameters &#40;OLE DB&#41;</span></span>](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)  
  
  
