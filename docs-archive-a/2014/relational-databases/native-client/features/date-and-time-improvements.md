---
title: 日付と時刻の機能強化 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 9b1d0d9d-1f6e-4399-8f61-e23f9a486a7a
author: rothja
ms.author: jroth
ms.openlocfilehash: 94f3fb5c00c15912840c494d3a6f6b0b05ea7257
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714282"
---
# <a name="date-and-time-improvements"></a><span data-ttu-id="9d6ed-102">日付と時刻の強化機能</span><span class="sxs-lookup"><span data-stu-id="9d6ed-102">Date and Time Improvements</span></span>
  <span data-ttu-id="9d6ed-103">このトピックでは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に追加された日付と時刻のデータ型の [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client サポートについて説明します。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-103">This topic describes the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support for the date and time data types that were added in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  
  
 <span data-ttu-id="9d6ed-104">日付/時刻の強化の詳細については、「[日付と時刻の機能強化 &#40;OLE DB&#41;](../../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)および[日付と時刻の機能強化 &#40;ODBC&#41;](../../native-client-odbc-date-time/date-and-time-improvements-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-104">For more information about date/time improvements, see [Date and Time Improvements &#40;OLE DB&#41;](../../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md) and [Date and Time Improvements &#40;ODBC&#41;](../../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
 <span data-ttu-id="9d6ed-105">この機能を説明するサンプル アプリケーションについては、「[SQL Server データ プログラミング サンプル](https://msftdpprodsamples.codeplex.com/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-105">For information about sample applications that demonstrate this feature, see [SQL Server Data Programming Samples](https://msftdpprodsamples.codeplex.com/).</span></span>  
  
## <a name="usage"></a><span data-ttu-id="9d6ed-106">使用法</span><span class="sxs-lookup"><span data-stu-id="9d6ed-106">Usage</span></span>  
 <span data-ttu-id="9d6ed-107">ここでは、新しい日付型と時刻型のさまざまな使用方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-107">The following sections describe various ways of using the new date and time types.</span></span>  
  
### <a name="use-date-as-a-distinct-data-type"></a><span data-ttu-id="9d6ed-108">個別のデータ型として日付を使用する</span><span class="sxs-lookup"><span data-stu-id="9d6ed-108">Use Date as a Distinct Data Type</span></span>  
 <span data-ttu-id="9d6ed-109">[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 以降、日付型と時刻型のサポートの強化により、SQL_TYPE_DATE ODBC 型 (ODBC 2.0 アプリケーションの場合は SQL_DATE) と DBTYPE_DBDATE OLE DB 型をより効果的に使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-109">Beginning with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], enhanced support for date/time types makes it more efficient to use the SQL_TYPE_DATE ODBC type (SQL_DATE for ODBC 2.0 applications) and the DBTYPE_DBDATE OLE DB type.</span></span>  
  
### <a name="use-time-as-a-distinct-data-type"></a><span data-ttu-id="9d6ed-110">個別のデータ型として時刻を使用する</span><span class="sxs-lookup"><span data-stu-id="9d6ed-110">Use Time as a Distinct Data Type</span></span>  
 <span data-ttu-id="9d6ed-111">OLE DB には既に、有効桁数が 1 秒のデータ型として DBTYPE_DBTIME があります。このデータ型には時刻のみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-111">OLE DB already has a data type that just contains the time, DBTYPE_DBTIME, which has a precision of 1 second.</span></span> <span data-ttu-id="9d6ed-112">この型は、ODBC の SQL_TYPE_TIME (ODBC 2.0 アプリケーションの場合は SQL_TIME) に相当します。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-112">In ODBC, the equivalent type is SQL_TYPE_TIME (SQL_TIME for ODBC 2.0 applications).</span></span>  
  
 <span data-ttu-id="9d6ed-113">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の新しい時刻データ型では、秒の小数部の精度が 100 ナノ秒です。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-113">The new [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] time data type has fractional seconds accurate to 100 nanoseconds.</span></span> <span data-ttu-id="9d6ed-114">これに [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] は、Native Client の新しい型 (DBTYPE_DBTIME2 (OLE DB) と SQL_SS_TIME2 (ODBC) が必要です。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-114">This requires new types in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client: DBTYPE_DBTIME2 (OLE DB) and SQL_SS_TIME2 (ODBC).</span></span> <span data-ttu-id="9d6ed-115">秒の小数部を含まない時刻を使用するように記述された既存のアプリケーションでは、time(0) 列を使用できます。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-115">Existing applications written to use times with no fractional seconds can use time(0) columns.</span></span> <span data-ttu-id="9d6ed-116">アプリケーションがメタデータに返される型に依存しない場合は、既存の OLE DB DBTYPE_TIME 型と ODBC SQL_TYPE_TIME 型、およびそれに対応する構造体が正常に動作します。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-116">The existing OLE DB DBTYPE_TIME and ODBC SQL_TYPE_TIME types and their corresponding structs should work correctly, unless the applications rely on the type returned in metadata.</span></span>  
  
### <a name="use-time-as-a-distinct-data-type-with-extended-fractional-seconds-precision"></a><span data-ttu-id="9d6ed-117">秒の有効桁数が拡張された個別のデータ型として時刻を使用する</span><span class="sxs-lookup"><span data-stu-id="9d6ed-117">Use Time as a Distinct Data Type with Extended Fractional Seconds Precision</span></span>  
 <span data-ttu-id="9d6ed-118">プロセス制御や製造アプリケーションなど、アプリケーションによっては、有効桁数が 100 ナノ秒までの時刻データを処理できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-118">Some applications, such as process control and manufacturing applications, require the ability to handle time data with a precision of up to 100 nanoseconds.</span></span> <span data-ttu-id="9d6ed-119">このための新しい型が DBTYPE_DBTIME2 (OLE DB) と SQL_SS_TIME2 (ODBC) です。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-119">New types for this purpose are DBTYPE_DBTIME2 (OLE DB) and SQL_SS_TIME2 (ODBC).</span></span>  
  
### <a name="use-datetime-with-extended-fractional-seconds-precision"></a><span data-ttu-id="9d6ed-120">秒の有効桁数が拡張された Datetime を使用する</span><span class="sxs-lookup"><span data-stu-id="9d6ed-120">Use Datetime with Extended Fractional Seconds Precision</span></span>  
 <span data-ttu-id="9d6ed-121">OLE DB では既に、有効桁数が 1 ナノ秒までの型が定義されています。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-121">OLE DB already defines a type with a precision of up to 1 nanosecond.</span></span> <span data-ttu-id="9d6ed-122">ただし、この型は既に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の既存のアプリケーションで使用されており、このようなアプリケーションでは、有効桁数を 1/300 秒までしか想定していません。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-122">However, this type is already used by existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] applications and such applications have an expectation of only 1/300 of a second precision.</span></span> <span data-ttu-id="9d6ed-123">新しい `datetime2(3)` 型は、既存の datetime 型と直接的な互換性がありません。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-123">The new `datetime2(3)` type is not directly compatible with the existing datetime type.</span></span> <span data-ttu-id="9d6ed-124">これがアプリケーションの動作に影響するというリスクがある場合、アプリケーションは新しい DBCOLUMN フラグを使用して、実際のサーバーの種類を判断する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-124">If there is a risk that this will affect application behavior, applications must use a new DBCOLUMN flag to determine the actual server type.</span></span>  
  
 <span data-ttu-id="9d6ed-125">ODBC DB でも既に、有効桁数が 1 ナノ秒までの型が定義されています。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-125">ODBC also defines a type with a precision of up to 1 nanosecond.</span></span> <span data-ttu-id="9d6ed-126">ただし、この型は既に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の既存のアプリケーションで使用されており、このようなアプリケーションでは、有効桁数を 3 ミリ秒までしか想定していません。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-126">However, this type is already used by existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] applications and such applications expect only 3 millisecond precision.</span></span> <span data-ttu-id="9d6ed-127">新しい `datetime2(3)` 型は、既存の `datetime` 型と直接的な互換性がありません。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-127">The new `datetime2(3)` type is not  directly compatible with the existing `datetime` type.</span></span> <span data-ttu-id="9d6ed-128">`datetime2(3)` の有効桁数は 1 ミリ秒、`datetime` の有効桁数は 1/300 秒です。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-128">`datetime2(3)` has a precision of one millisecond, and `datetime` has a precision of 1/300 of a second.</span></span> <span data-ttu-id="9d6ed-129">ODBC では、アプリケーションが SQL_DESC_TYPE_NAME 記述子フィールドで使用されているサーバーの種類を判断できます。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-129">In ODBC, applications can determine which server type is in use with the descriptor field SQL_DESC_TYPE_NAME.</span></span> <span data-ttu-id="9d6ed-130">したがって、既存の型 SQL_TYPE_TIMESTAMP (ODBC 2.0 アプリケーションの場合は SQL_TIMESTAMP) は両方の型に使用できます。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-130">Therefore, the existing type SQL_TYPE_TIMESTAMP (SQL_TIMESTAMP for ODBC 2.0 applications) can be used for both types.</span></span>  
  
### <a name="use-datetime-with-extended-fractional-seconds-precision-and-timezone"></a><span data-ttu-id="9d6ed-131">秒の有効桁数とタイム ゾーンが拡張された Datetime を使用する</span><span class="sxs-lookup"><span data-stu-id="9d6ed-131">Use Datetime with Extended Fractional Seconds Precision and Timezone</span></span>  
 <span data-ttu-id="9d6ed-132">アプリケーションによっては、タイム ゾーン情報を含む datetime 値が必要です。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-132">Some applications require datetime values with timezone information.</span></span> <span data-ttu-id="9d6ed-133">これは、新しい型 DBTYPE_DBTIMESTAMPOFFSET (OLE DB) および SQL_SS_TIMESTAMPOFFSET (ODBC) でサポートされています。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-133">This is supported by the new DBTYPE_DBTIMESTAMPOFFSET (OLE DB) and SQL_SS_TIMESTAMPOFFSET (ODBC) types.</span></span>  
  
### <a name="use-datetimedatetimedatetimeoffset-data-with-client-side-conversions-consistent-with-existing-conversions"></a><span data-ttu-id="9d6ed-134">既存の変換と一貫性のあるクライアント側変換で Date/Time/Datetime/Datetimeoffset データを使用する</span><span class="sxs-lookup"><span data-stu-id="9d6ed-134">Use Date/Time/Datetime/Datetimeoffset Data with Client-Side Conversions Consistent with Existing Conversions</span></span>  
 <span data-ttu-id="9d6ed-135">ODBC 標準では、既存の date 型、time 型、および timestamp 型の間の変換のしくみについて説明します。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-135">The ODBC standard describes how conversions between existing date, time, and timestamp types work.</span></span> <span data-ttu-id="9d6ed-136">このような変換は、[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] で導入されたすべての日付型と時刻型との間の変換を含めるように一貫して拡張されます。</span><span class="sxs-lookup"><span data-stu-id="9d6ed-136">These are extended in a consistent manner to include conversions between all date and time types introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9d6ed-137">参照</span><span class="sxs-lookup"><span data-stu-id="9d6ed-137">See Also</span></span>  
 [<span data-ttu-id="9d6ed-138">SQL Server Native Client の機能</span><span class="sxs-lookup"><span data-stu-id="9d6ed-138">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
