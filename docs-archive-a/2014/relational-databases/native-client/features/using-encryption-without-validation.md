---
title: 検証を伴わない暗号化の使用 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], encryption
- cryptography [SQL Server Native Client]
- SQLNCLI, encryption
- encryption [SQL Server Native Client]
- SQL Server Native Client, encryption
ms.assetid: f4c63206-80bb-4d31-84ae-ccfcd563effa
author: rothja
ms.author: jroth
ms.openlocfilehash: 0a6d2e8b3d696a92e3fa3e1b7de7604551d4f9ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633116"
---
# <a name="using-encryption-without-validation"></a><span data-ttu-id="75174-102">検証を伴わない暗号化の使用</span><span class="sxs-lookup"><span data-stu-id="75174-102">Using Encryption Without Validation</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="75174-103">は、常に、ログインに関連するネットワーク パケットを暗号化します。</span><span class="sxs-lookup"><span data-stu-id="75174-103">always encrypts network packets associated with logging in.</span></span> <span data-ttu-id="75174-104">サーバーの起動時に証明書がサーバーに提供されないと、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] はログイン パケットの暗号化に使用される自己署名入りの証明書を生成します。</span><span class="sxs-lookup"><span data-stu-id="75174-104">If no certificate has been provisioned on the server when it starts up, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a self-signed certificate which is used to encrypt login packets.</span></span>  
  
 <span data-ttu-id="75174-105">アプリケーションでは、接続文字列キーワードまたは接続プロパティを使用して、すべてのネットワーク トラフィックの暗号化を要求することもできます。</span><span class="sxs-lookup"><span data-stu-id="75174-105">Applications may also request encryption of all network traffic by using connection string keywords or connection properties.</span></span> <span data-ttu-id="75174-106">キーワードは、 **IDataInitialize**で初期化文字列を使用する場合に、 **IDbInitialize:: Initialize**でプロバイダー文字列を使用する場合は ODBC と OLE DB、OLE DB ADO の場合は "データの暗号化" を使用する場合は "暗号化" を使用します。</span><span class="sxs-lookup"><span data-stu-id="75174-106">The keywords are "Encrypt" for ODBC and OLE DB when using a provider string with **IDbInitialize::Initialize**, or "Use Encryption for Data" for ADO and OLE DB when using an initialization string with **IDataInitialize**.</span></span> <span data-ttu-id="75174-107">これは [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 、[**プロトコルの暗号化**を設定する] オプションを使用して Configuration Manager によって構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="75174-107">This may also be configured by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager using the **Force Protocol Encryption** option.</span></span> <span data-ttu-id="75174-108">既定では、接続のネットワーク トラフィックをすべて暗号化するには、証明書をサーバーに提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="75174-108">By default, encryption of all network traffic for a connection requires that a certificate be provisioned on the server.</span></span>  
  
 <span data-ttu-id="75174-109">接続文字列キーワードの詳細については、「 [SQL Server Native Client での接続文字列キーワードの使用](../applications/using-connection-string-keywords-with-sql-server-native-client.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="75174-109">For information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="75174-110">証明書がサーバーに提供されていないときに暗号化を有効にするには、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 構成マネージャーを使用して **[Force Protocol Encryption]** オプションと **[Trust Server Certificate]** オプションの両方を設定できます。</span><span class="sxs-lookup"><span data-stu-id="75174-110">To enable encryption to be used when a certificate has not been provisioned on the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager can be used to set both the **Force Protocol Encryption** and the **Trust Server Certificate** options.</span></span> <span data-ttu-id="75174-111">このように、検証可能なサーバー証明書がプロビジョニングされていない場合、暗号化には検証を伴わない自己署名入りのサーバー証明書が使用されます。</span><span class="sxs-lookup"><span data-stu-id="75174-111">In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.</span></span>  
  
 <span data-ttu-id="75174-112">アプリケーションでは、暗号化が行われることを保証するために "TrustServerCertificate" キーワードまたはそれに関連する接続属性も使用できます。</span><span class="sxs-lookup"><span data-stu-id="75174-112">Applications may also use the "TrustServerCertificate" keyword or its associated connection attribute to guarantee that encryption takes place.</span></span> <span data-ttu-id="75174-113">アプリケーションの設定によって、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] クライアント構成マネージャーで設定されるセキュリティのレベルを緩和することはできません。ただし、厳密にすることはできます。</span><span class="sxs-lookup"><span data-stu-id="75174-113">Application settings never reduce the level of security set by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Client Configuration Manager, but may strengthen it.</span></span> <span data-ttu-id="75174-114">たとえば、クライアントに **[Force Protocol Encryption]** オプションが設定されていない場合、アプリケーションから暗号化自体を要求することができます。</span><span class="sxs-lookup"><span data-stu-id="75174-114">For example, if **Force Protocol Encryption** is not set for the client, an application may request encryption itself.</span></span> <span data-ttu-id="75174-115">サーバー証明書が提供されなかった場合でも暗号化を保証するには、アプリケーションから暗号化と "TrustServerCertificate" を要求できます。</span><span class="sxs-lookup"><span data-stu-id="75174-115">To guarantee encryption even when a server certificate has not been provisioned, an application may request encryption and "TrustServerCertificate".</span></span> <span data-ttu-id="75174-116">ただし、クライアントの構成で "TrustServerCertificate" が有効になっていない場合は、サーバー証明書を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="75174-116">However, if "TrustServerCertificate" is not enabled in the client configuration, a provisioned server certificate is still required.</span></span> <span data-ttu-id="75174-117">次の表ですべてのケースを説明します。</span><span class="sxs-lookup"><span data-stu-id="75174-117">The following table describes all cases:</span></span>  
  
|<span data-ttu-id="75174-118">[プロトコルの暗号化を設定する] クライアント設定</span><span class="sxs-lookup"><span data-stu-id="75174-118">Force Protocol Encryption client setting</span></span>|<span data-ttu-id="75174-119">[サーバー証明書を信頼する] クライアント設定</span><span class="sxs-lookup"><span data-stu-id="75174-119">Trust Server Certificate client setting</span></span>|<span data-ttu-id="75174-120">接続文字列/接続属性 Encrypt/Use Encryption for Data</span><span class="sxs-lookup"><span data-stu-id="75174-120">Connection string/connection attribute Encrypt/Use Encryption for Data</span></span>|<span data-ttu-id="75174-121">接続文字列/接続属性 Trust Server Certificate</span><span class="sxs-lookup"><span data-stu-id="75174-121">Connection string/connection attribute Trust Server Certificate</span></span>|<span data-ttu-id="75174-122">結果</span><span class="sxs-lookup"><span data-stu-id="75174-122">Result</span></span>|  
|----------------------------------------------|---------------------------------------------|------------------------------------------------------------------------------|----------------------------------------------------------------------|------------|  
|<span data-ttu-id="75174-123">いいえ</span><span class="sxs-lookup"><span data-stu-id="75174-123">No</span></span>|<span data-ttu-id="75174-124">N/A</span><span class="sxs-lookup"><span data-stu-id="75174-124">N/A</span></span>|<span data-ttu-id="75174-125">無効 (既定値)</span><span class="sxs-lookup"><span data-stu-id="75174-125">No (default)</span></span>|<span data-ttu-id="75174-126">無視</span><span class="sxs-lookup"><span data-stu-id="75174-126">Ignored</span></span>|<span data-ttu-id="75174-127">暗号化は行われません。</span><span class="sxs-lookup"><span data-stu-id="75174-127">No encryption occurs.</span></span>|  
|<span data-ttu-id="75174-128">いいえ</span><span class="sxs-lookup"><span data-stu-id="75174-128">No</span></span>|<span data-ttu-id="75174-129">該当なし</span><span class="sxs-lookup"><span data-stu-id="75174-129">N/A</span></span>|<span data-ttu-id="75174-130">はい</span><span class="sxs-lookup"><span data-stu-id="75174-130">Yes</span></span>|<span data-ttu-id="75174-131">無効 (既定値)</span><span class="sxs-lookup"><span data-stu-id="75174-131">No (default)</span></span>|<span data-ttu-id="75174-132">暗号化は、検証可能なサーバー証明書が提供されている場合にのみ行われます。それ以外の場合は、接続試行が失敗します。</span><span class="sxs-lookup"><span data-stu-id="75174-132">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="75174-133">いいえ</span><span class="sxs-lookup"><span data-stu-id="75174-133">No</span></span>|<span data-ttu-id="75174-134">該当なし</span><span class="sxs-lookup"><span data-stu-id="75174-134">N/A</span></span>|<span data-ttu-id="75174-135">はい</span><span class="sxs-lookup"><span data-stu-id="75174-135">Yes</span></span>|<span data-ttu-id="75174-136">はい</span><span class="sxs-lookup"><span data-stu-id="75174-136">Yes</span></span>|<span data-ttu-id="75174-137">暗号化は常に行われますが、自己署名入りのサーバー証明書を使用することがあります。</span><span class="sxs-lookup"><span data-stu-id="75174-137">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="75174-138">はい</span><span class="sxs-lookup"><span data-stu-id="75174-138">Yes</span></span>|<span data-ttu-id="75174-139">いいえ</span><span class="sxs-lookup"><span data-stu-id="75174-139">No</span></span>|<span data-ttu-id="75174-140">無視</span><span class="sxs-lookup"><span data-stu-id="75174-140">Ignored</span></span>|<span data-ttu-id="75174-141">無視</span><span class="sxs-lookup"><span data-stu-id="75174-141">Ignored</span></span>|<span data-ttu-id="75174-142">暗号化は、検証可能なサーバー証明書が提供されている場合にのみ行われます。それ以外の場合は、接続試行が失敗します。</span><span class="sxs-lookup"><span data-stu-id="75174-142">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="75174-143">はい</span><span class="sxs-lookup"><span data-stu-id="75174-143">Yes</span></span>|<span data-ttu-id="75174-144">はい</span><span class="sxs-lookup"><span data-stu-id="75174-144">Yes</span></span>|<span data-ttu-id="75174-145">無効 (既定値)</span><span class="sxs-lookup"><span data-stu-id="75174-145">No (default)</span></span>|<span data-ttu-id="75174-146">無視</span><span class="sxs-lookup"><span data-stu-id="75174-146">Ignored</span></span>|<span data-ttu-id="75174-147">暗号化は常に行われますが、自己署名入りのサーバー証明書を使用することがあります。</span><span class="sxs-lookup"><span data-stu-id="75174-147">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="75174-148">はい</span><span class="sxs-lookup"><span data-stu-id="75174-148">Yes</span></span>|<span data-ttu-id="75174-149">はい</span><span class="sxs-lookup"><span data-stu-id="75174-149">Yes</span></span>|<span data-ttu-id="75174-150">はい</span><span class="sxs-lookup"><span data-stu-id="75174-150">Yes</span></span>|<span data-ttu-id="75174-151">無効 (既定値)</span><span class="sxs-lookup"><span data-stu-id="75174-151">No (default)</span></span>|<span data-ttu-id="75174-152">暗号化は、検証可能なサーバー証明書が提供されている場合にのみ行われます。それ以外の場合は、接続試行が失敗します。</span><span class="sxs-lookup"><span data-stu-id="75174-152">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="75174-153">はい</span><span class="sxs-lookup"><span data-stu-id="75174-153">Yes</span></span>|<span data-ttu-id="75174-154">はい</span><span class="sxs-lookup"><span data-stu-id="75174-154">Yes</span></span>|<span data-ttu-id="75174-155">はい</span><span class="sxs-lookup"><span data-stu-id="75174-155">Yes</span></span>|<span data-ttu-id="75174-156">はい</span><span class="sxs-lookup"><span data-stu-id="75174-156">Yes</span></span>|<span data-ttu-id="75174-157">暗号化は常に行われますが、自己署名入りのサーバー証明書を使用することがあります。</span><span class="sxs-lookup"><span data-stu-id="75174-157">Encryption always occurs, but might use a self-signed server certificate.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="75174-158">SQL Server Native Client OLE DB プロバイダー</span><span class="sxs-lookup"><span data-stu-id="75174-158">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="75174-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB プロバイダーは、DBPROPSET_SQLSERVERDBINIT プロパティセットに実装されている SSPROP_INIT_TRUST_SERVER_CERTIFICATE データソース初期化プロパティを追加することによって、検証を行わずに暗号化をサポートします。</span><span class="sxs-lookup"><span data-stu-id="75174-159">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports encryption without validation through the addition of the SSPROP_INIT_TRUST_SERVER_CERTIFICATE data source initialization property, which is implemented in the DBPROPSET_SQLSERVERDBINIT property set.</span></span> <span data-ttu-id="75174-160">また、新しい接続文字列のキーワードとして "TrustServerCertificate" が追加されました。</span><span class="sxs-lookup"><span data-stu-id="75174-160">In addition, a new connection string keyword, "TrustServerCertificate", as been added.</span></span> <span data-ttu-id="75174-161">"TrustServerCertificate" は、yes または no を値として受け取ります。既定値は no です。</span><span class="sxs-lookup"><span data-stu-id="75174-161">It accepts yes or no values; no is the default.</span></span> <span data-ttu-id="75174-162">サービス コンポーネントを使用しているときは、"TrustServerCertificate" は true または false を値として受け取ります。既定値は false です。</span><span class="sxs-lookup"><span data-stu-id="75174-162">When using service components, it accepts true or false values; false is the default.</span></span>  
  
 <span data-ttu-id="75174-163">DBPROPSET_SQLSERVERDBINIT プロパティ セットに行われた機能強化の詳細については、「[初期化プロパティと承認プロパティ](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="75174-163">For more information about enhancements made to the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="75174-164">SQL Server Native Client ODBC ドライバー</span><span class="sxs-lookup"><span data-stu-id="75174-164">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="75174-165">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC ドライバーでは、 [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)および[sqlgetconnectattr](../../native-client-odbc-api/sqlgetconnectattr.md)関数への追加によって、検証なしの暗号化がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="75174-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports encryption without validation through additions to the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) and [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) functions.</span></span> <span data-ttu-id="75174-166">SQL_TRUST_SERVER_CERTIFICATE_YES または SQL_TRUST_SERVER_CERTIFICATE_NO を受け取る、SQL_COPT_SS_TRUST_SERVER_CERTIFICATE が追加されました。既定値は SQL_TRUST_SERVER_CERTIFICATE_NO です。</span><span class="sxs-lookup"><span data-stu-id="75174-166">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE has been added to accept either SQL_TRUST_SERVER_CERTIFICATE_YES or SQL_TRUST_SERVER_CERTIFICATE_NO, with SQL_TRUST_SERVER_CERTIFICATE_NO being the default.</span></span> <span data-ttu-id="75174-167">また、新しい接続文字列のキーワードとして "TrustServerCertificate" が追加されました。</span><span class="sxs-lookup"><span data-stu-id="75174-167">In addition, a new connection string keyword, "TrustServerCertificate", has been added.</span></span> <span data-ttu-id="75174-168">"TrustServerCertificate" は、"yes" または "no" を値として受け取ります。既定値は "no" です。</span><span class="sxs-lookup"><span data-stu-id="75174-168">It accepts yes or no values; "no" is the default.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="75174-169">参照</span><span class="sxs-lookup"><span data-stu-id="75174-169">See Also</span></span>  
 [<span data-ttu-id="75174-170">SQL Server Native Client の機能</span><span class="sxs-lookup"><span data-stu-id="75174-170">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  
