---
title: 高可用性、ディザスターリカバリーをサポートする SQL Server Native ClientMicrosoft Docs
ms.custom: ''
ms.date: 08/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 2b06186b-4090-4728-b96b-90d6ebd9f66f
author: rothja
ms.author: jroth
ms.openlocfilehash: 43c835d5c0e1c064387aee7fb0db65f577c3aa26
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87644442"
---
# <a name="sql-server-native-client-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="7c51e-102">SQL Server Native Client の HADR サポート</span><span class="sxs-lookup"><span data-stu-id="7c51e-102">SQL Server Native Client Support for High Availability, Disaster Recovery</span></span>
  <span data-ttu-id="7c51e-103">このトピックでは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] Native Client のサポート ([!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] で追加) について説明します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-103">This topic discusses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support (added in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="7c51e-104">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] の詳細については、「[可用性グループ リスナー、クライアント接続、およびアプリケーションのフェールオーバー &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md)」、「[可用性グループの作成と構成 &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md)」、「[フェールオーバー クラスタリングと AlwaysOn 可用性グループ &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md)」、および「[アクティブなセカンダリ: 読み取り可能なセカンダリ レプリカ (AlwaysOn 可用性グループ)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-104">For more information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md), and [Active Secondaries: Readable Secondary Replicas (AlwaysOn Availability Groups)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>  
  
 <span data-ttu-id="7c51e-105">接続文字列で、特定の可用性グループの可用性グループ リスナーを指定できます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-105">You can specify the availability group listener of a given availability group in the connection string.</span></span> <span data-ttu-id="7c51e-106">フェールオーバーする可用性グループ内のデータベースに [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client アプリケーションが接続されている場合、元の接続が切断されるため、フェールオーバー後にアプリケーションが動作を継続するには新しい接続を開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-106">If a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application is connected to a database in an availability group that fails over, the original connection is broken, and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="7c51e-107">可用性グループ リスナーに接続しておらず、ホスト名に複数の IP アドレスが関連付けられている場合、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client は DNS エントリに関連付けられているすべての IP アドレスを順次繰り返し処理します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-107">If you are not connecting to an availability group listener, and if multiple IP addresses are associated with a hostname, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="7c51e-108">これは、DNS サーバーによって返された最初の IP アドレスがネットワーク インターフェイス カード (NIC) にバインドされていない場合、時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-108">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="7c51e-109">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client が可用性グループ リスナーに接続するとき、すべての IP アドレスに対して並列で接続を試行します。1 つの接続試行が成功すると、保留中の接続試行はすべて破棄されます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-109">When connecting to an availability group listener, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7c51e-110">接続タイムアウト値を大きくし、接続再試行ロジックを実装することにより、アプリケーションが可用性グループに接続する確立が高まります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-110">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="7c51e-111">また、可用性グループのフェールオーバーにより接続が失敗する可能性があるため、接続再試行ロジックを実装して、再接続されるまで、失敗した接続の再接続を試行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-111">Also, because a connection can fail because of an availability group failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="7c51e-112">MultiSubnetFailover を使用した接続</span><span class="sxs-lookup"><span data-stu-id="7c51e-112">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="7c51e-113">SQL Server 2012 可用性グループ リスナーまたは SQL Server 2012 フェールオーバー クラスター インスタンスに接続する際には、必ず `MultiSubnetFailover=Yes` を指定してください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-113">Always specify `MultiSubnetFailover=Yes` when connecting to a SQL Server 2012 availability group listener or SQL Server 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="7c51e-114">`MultiSubnetFailover` を指定することで、SQL Server 2012 のすべての可用性グループおよびフェールオーバー クラスター インスタンスに対して高速フェールオーバーが有効化され、単一サブネットおよびマルチサブネットの AlwaysOn トポロジにおけるフェールオーバー時間が大幅に短縮されます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-114">`MultiSubnetFailover` enables faster failover for all Availability Groups and failover cluster instance in SQL Server 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="7c51e-115">複数のサブネットのフェールオーバーでは、クライアントは並列接続を試みます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-115">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="7c51e-116">サブネット フェールオーバーの際には、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client は積極的に TCP 接続を再試行します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-116">During a subnet failover, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="7c51e-117">`MultiSubnetFailover` 接続プロパティを指定すると、アプリケーションが可用性グループまたはフェールオーバー クラスター インスタンスに配置され、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client がすべての IP アドレスに対して接続を試行することでプライマリ [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] インスタンス上のデータベースに接続を試みます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-117">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or Failover Cluster Instance, and that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="7c51e-118">`MultiSubnetFailover=Yes`が接続に対して指定されている場合、クライアントは、オペレーティングシステムの既定の tcp 再送信間隔よりも速く tcp 接続の試行を再試行します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-118">When `MultiSubnetFailover=Yes` is specified for a connection, the client retries TCP connection attempts faster than the operating system's default TCP retransmit intervals.</span></span> <span data-ttu-id="7c51e-119">これは、AlwaysOn 可用性グループまたは AlwaysOn フェールオーバー クラスター インスタンスのフェールオーバー後のより高速な再接続を可能にし、単一および複数のサブネットの可用性グループおよびフェールオーバー クラスター インスタンスの両方に適用可能です。</span><span class="sxs-lookup"><span data-stu-id="7c51e-119">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="7c51e-120">接続文字列キーワードの詳細については、「[SQL Server Native Client での接続文字列キーワードの使用](../applications/using-connection-string-keywords-with-sql-server-native-client.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-120">For more information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="7c51e-121">接続先が可用性グループ リスナーでもフェールオーバー クラスター インスタンスでもないときに `MultiSubnetFailover=Yes` を指定すると、パフォーマンスが低下する可能性があるため、このような指定はサポートされません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-121">Specifying `MultiSubnetFailover=Yes` when connecting to something other than an availability group listener or Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="7c51e-122">可用性グループまたはフェールオーバー クラスター インスタンス内のサーバーに接続する際には、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="7c51e-122">Use the following guidelines to connect to a server in an availability group or Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="7c51e-123">単一のサブネットまたは複数のサブネットへの接続時には、`MultiSubnetFailover` 接続プロパティを使用します。これにより、両方の場合でパフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-123">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="7c51e-124">可用性グループに接続するには、使用する接続文字列でサーバーとして可用性グループの可用性グループ リスナーを指定します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-124">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="7c51e-125">64 個を超える数の IP アドレスが構成された [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] インスタンスに接続すると、接続エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-125">Connecting to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="7c51e-126">`MultiSubnetFailover` 接続プロパティを使用するアプリケーションの動作は、認証の種類 ([!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 認証、Kerberos 認証、または Windows 認証) の影響を受けません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-126">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="7c51e-127">`loginTimeout` の値を増やすことで、フェールオーバー時間に対応し、アプリケーションの接続試行回数を減らすことができます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-127">You can increase the value of `loginTimeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="7c51e-128">分散トランザクションはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-128">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="7c51e-129">読み取り専用のルーティングが無効である場合、次の状況では可用性グループのセカンダリ レプリカの場所には接続できません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-129">If read-only routing is not in effect, connecting to a secondary replica location in an availability group will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="7c51e-130">セカンダリ レプリカの場所が接続を受け入れないように構成されている場合。</span><span class="sxs-lookup"><span data-stu-id="7c51e-130">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="7c51e-131">アプリケーションが `ApplicationIntent=ReadWrite` (後で説明) を使用している場合、セカンダリ レプリカの場所は読み取り専用アクセスとして構成されます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-131">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="7c51e-132">プライマリ レプリカが読み取り専用のワークロードを拒否するように設定され、接続文字列が  `ApplicationIntent=ReadOnly` を含んでいる場合、接続は失敗します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-132">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="7c51e-133">データベース ミラーリングから複数のサブネット クラスターを使用するためのアップグレード</span><span class="sxs-lookup"><span data-stu-id="7c51e-133">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="7c51e-134">接続文字列に `MultiSubnetFailover` および `Failover_Partner` の接続キーワードが存在する場合、接続エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-134">A connection error will occur if the `MultiSubnetFailover` and `Failover_Partner` connection keywords are present in the connection string.</span></span> <span data-ttu-id="7c51e-135">また、`MultiSubnetFailover` が使用されているとき、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] から、データベース ミラーリング ペアに属していることを示すフェールオーバー パートナー応答が返された場合にも、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-135">An error will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="7c51e-136">データベース ミラーリングを現在使用している [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client アプリケーションをマルチサブネットのシナリオにアップグレードする場合、`Failover_Partner` 接続プロパティを削除して `MultiSubnetFailover` に置き換え、それを `Yes` に設定し、接続文字列内のサーバー名を可用性グループ リスナーの名前に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-136">If you upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover_Partner` connection property and replace it with `MultiSubnetFailover` set to `Yes` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="7c51e-137">接続文字列が `Failover_Partner` および `MultiSubnetFailover=Yes` を使用していると、ドライバーがエラーを生成します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-137">If a connection string uses `Failover_Partner` and `MultiSubnetFailover=Yes`, the driver will generate an error.</span></span> <span data-ttu-id="7c51e-138">ただし、接続文字列が `Failover_Partner` および `MultiSubnetFailover=No` (または  `ApplicationIntent=ReadWrite`) を使用している場合、アプリケーションはデータベース ミラーリングを使用します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-138">However, if a connection string uses `Failover_Partner` and `MultiSubnetFailover=No` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="7c51e-139">可用性グループのプライマリデータベースでデータベースミラーリングが使用されていて、 `MultiSubnetFailover=Yes` 可用性グループリスナーではなくプライマリデータベースに接続する接続文字列でが使用されている場合、ドライバーはエラーを返します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-139">The driver will return an error if database mirroring is used on the primary database in the availability group, and if `MultiSubnetFailover=Yes` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="7c51e-140">アプリケーションの目的の指定</span><span class="sxs-lookup"><span data-stu-id="7c51e-140">Specifying Application Intent</span></span>  
 <span data-ttu-id="7c51e-141">`ApplicationIntent=ReadOnly` の場合、クライアントは AlwaysOn が有効になったデータベースに接続する場合に、読み取られたワークロードを要求します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-141">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="7c51e-142">サーバーは、接続時および USE データベース ステートメントの間、その目的を強制しますが、AlwaysOn が有効になったデータベースに対してのみ、これを行います。</span><span class="sxs-lookup"><span data-stu-id="7c51e-142">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="7c51e-143">`ApplicationIntent` キーワードは従来の読み取り専用のデータベースでは機能しません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-143">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="7c51e-144">データベースは、対象となる AlwaysOn データベースのワークロードの読み取りを許可または拒否できます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-144">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="7c51e-145">(これは `ALLOW_CONNECTIONS` の `PRIMARY_ROLE` 句および `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)] ステートメントを使用して行います。)</span><span class="sxs-lookup"><span data-stu-id="7c51e-145">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="7c51e-146">`ApplicationIntent` キーワードは、読み取り専用のルーティングを有効にするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-146">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="7c51e-147">読み取り専用ルーティング</span><span class="sxs-lookup"><span data-stu-id="7c51e-147">Read-Only Routing</span></span>  
 <span data-ttu-id="7c51e-148">読み取り専用のルーティングはデータベースの読み取り専用のレプリカの可用性を確保できる機能です。</span><span class="sxs-lookup"><span data-stu-id="7c51e-148">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="7c51e-149">読み取り専用のルーティングを有効にするには次のことが必要です。</span><span class="sxs-lookup"><span data-stu-id="7c51e-149">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="7c51e-150">AlwaysOn 可用性グループの可用性グループ リスナーに接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-150">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="7c51e-151">`ApplicationIntent` 接続文字列キーワードを `ReadOnly` に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-151">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="7c51e-152">可用性グループは、データベース管理者によって、読み取り専用のルーティングを有効にするように構成される必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-152">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="7c51e-153">読み取り専用のルーティングを使用する複数の接続のすべてが、同じ読み取り専用のレプリカに接続しないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-153">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="7c51e-154">データベースの同期変更またはサーバーのルーティング構成の変更は、異なる読み取り専用のレプリカに対するクライアントの接続につながることがあります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-154">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="7c51e-155">すべての読み取り専用の要求が、確実に同じ読み取り専用のレプリカに接続するようにするには、`Server` 接続文字列キーワードに可用性グループ リスナーを渡さないでください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-155">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Server` connection string keyword.</span></span> <span data-ttu-id="7c51e-156">代わりに、読み取り専用のインスタンスの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-156">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="7c51e-157">読み取り専用のルーティングでは、最初にプライマリに接続し、最適な可用性の読み取り可能なセカンダリを検索するため、プライマリに接続するよりも時間がかかる場合があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-157">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="7c51e-158">そのため、ログインのタイムアウトを増やす必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c51e-158">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="odbc"></a><span data-ttu-id="7c51e-159">ODBC</span><span class="sxs-lookup"><span data-stu-id="7c51e-159">ODBC</span></span>  
 <span data-ttu-id="7c51e-160">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] をサポートするために、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client には、次の 2 つの ODBC 接続文字列キーワードが追加されています。</span><span class="sxs-lookup"><span data-stu-id="7c51e-160">Two ODBC connection string keywords were added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="7c51e-161">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の ODBC 接続文字列キーワードの詳細については、「[SQL Server Native Client での接続文字列キーワードの使用](../applications/using-connection-string-keywords-with-sql-server-native-client.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-161">For more information about ODBC connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="7c51e-162">対応する接続プロパティは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="7c51e-162">The equivalent connection properties are:</span></span>  
  
-   `SQL_COPT_SS_APPLICATION_INTENT`  
  
-   `SQL_COPT_SS_MULTISUBNET_FAILOVER`  
  
 <span data-ttu-id="7c51e-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の ODBC 接続文字列プロパティの詳細については、「[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-163">For more information about ODBC connection properties in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span></span>  
  
 <span data-ttu-id="7c51e-164">`ApplicationIntent` キーワードと `MultiSubnetFailover` キーワードの機能は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ドライバーを使用する DSN の ODBC データ ソース アドミニストレーターで公開されます ([!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] 以降)。</span><span class="sxs-lookup"><span data-stu-id="7c51e-164">The functionality of the `ApplicationIntent` and `MultiSubnetFailover` keywords will be exposed in the ODBC Data Source Administrator for DSNs that use the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver, beginning in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
 <span data-ttu-id="7c51e-165">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC アプリケーションは、次に示した 3 つの関数のいずれかを使用して、接続を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-165">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC application can use one of three functions to make the connection:</span></span>  
  
|<span data-ttu-id="7c51e-166">機能</span><span class="sxs-lookup"><span data-stu-id="7c51e-166">Function</span></span>|<span data-ttu-id="7c51e-167">説明</span><span class="sxs-lookup"><span data-stu-id="7c51e-167">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="7c51e-168">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="7c51e-168">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)|<span data-ttu-id="7c51e-169">`SQLBrowseConnect` から返されるサーバーの一覧に VNN は含まれません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-169">The list of servers returned by `SQLBrowseConnect` will not include VNNs.</span></span> <span data-ttu-id="7c51e-170">確認できるのはサーバーの一覧だけです。スタンドアロン サーバーであるのか、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] が有効な 2 つ以上の [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] インスタンスが含まれる Windows Server フェールオーバー クラスタリング (WSFC) クラスターのうちのプライマリ サーバーまたはセカンダリ サーバーであるのかは示されません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-170">You will only see a list of servers without any indication if the server is a standalone server, or a primary or secondary server in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="7c51e-171">サーバーへの接続時にエラーが返された場合、接続先のサーバーの構成に `ApplicationIntent` 設定との互換性がないことが原因として考えられます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-171">If you connect to a server and get a failure, it may be because you have connected to a server, and the `ApplicationIntent` setting is not compatible with the server configuration.</span></span><br /><br /> <span data-ttu-id="7c51e-172">`SQLBrowseConnect` は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] が有効な 2 つ以上の [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] インスタンスが含まれる Windows Server フェールオーバー クラスタリング (WSFC) クラスター内のサーバーを認識しません。このため、`SQLBrowseConnect` 接続文字列キーワードは、`MultiSubnetFailover` では無視されます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-172">Because `SQLBrowseConnect` does not recognize servers in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignores the `MultiSubnetFailover` connection string keyword.</span></span>|  
|[<span data-ttu-id="7c51e-173">SQLConnect</span><span class="sxs-lookup"><span data-stu-id="7c51e-173">SQLConnect</span></span>](../../native-client-odbc-api/sqlconnect.md)|<span data-ttu-id="7c51e-174">`SQLConnect` は、データ ソース名 (DSN) または接続プロパティを介して、`ApplicationIntent` と `MultiSubnetFailover` の両方をサポートします。</span><span class="sxs-lookup"><span data-stu-id="7c51e-174">`SQLConnect` supports both `ApplicationIntent` and `MultiSubnetFailover` via a data source name (DSN) or connection properties.</span></span>|  
|[<span data-ttu-id="7c51e-175">SQLDriverConnect</span><span class="sxs-lookup"><span data-stu-id="7c51e-175">SQLDriverConnect</span></span>](../../native-client-odbc-api/sqldriverconnect.md)|<span data-ttu-id="7c51e-176">`SQLDriverConnect` は、接続文字列キーワード、接続プロパティ、または DSN を介して、`ApplicationIntent` と `MultiSubnetFailover` をサポートします。</span><span class="sxs-lookup"><span data-stu-id="7c51e-176">`SQLDriverConnect` supports `ApplicationIntent` and `MultiSubnetFailover` via connection string keywords, connection properties, or DSN.</span></span>|  
  
## <a name="ole-db"></a><span data-ttu-id="7c51e-177">OLE DB (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="7c51e-177">OLE DB</span></span>  
 <span data-ttu-id="7c51e-178">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の OLE DB では、`MultiSubnetFailover` キーワードはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="7c51e-178">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not support the `MultiSubnetFailover` keyword.</span></span>  
  
 <span data-ttu-id="7c51e-179">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の OLE DB では、アプリケーション インテントがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-179">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will support application intent.</span></span> <span data-ttu-id="7c51e-180">OLE DB アプリケーションにおけるアプリケーション インテントの動作は、ODBC アプリケーションの場合と同じです (上記を参照)。</span><span class="sxs-lookup"><span data-stu-id="7c51e-180">Application intent will behave the same for OLE DB applications as ODBC applications (see above).</span></span>  
  
 <span data-ttu-id="7c51e-181">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] をサポートするため、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client には、次の OLE DB 接続文字列キーワードが追加されています。</span><span class="sxs-lookup"><span data-stu-id="7c51e-181">One OLE DB connection string keyword added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `Application Intent`  
  
 <span data-ttu-id="7c51e-182">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の接続文字列キーワードの詳細については、「[SQL Server Native Client での接続文字列キーワードの使用](../applications/using-connection-string-keywords-with-sql-server-native-client.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7c51e-182">For more information about connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="7c51e-183">対応する接続プロパティは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="7c51e-183">The equivalent connection properties are:</span></span>  
  
-   `SSPROP_INIT_APPLICATIONINTENT`  
  
-   `DBPROP_INIT_PROVIDERSTRING`  
  
 <span data-ttu-id="7c51e-184">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB アプリケーションは、次のいずれかの方法で、アプリケーション インテントを指定できます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-184">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB application can use one of the methods to specify application intent:</span></span>  
  
 `IDBInitialize::Initialize`  
 <span data-ttu-id="7c51e-185">`IDBInitialize::Initialize` は、あらかじめ構成された一連のプロパティを使用して、データ ソースを初期化し、データ ソース オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-185">`IDBInitialize::Initialize` uses the previously configured set of properties to initialize the data source and create the data source object.</span></span> <span data-ttu-id="7c51e-186">アプリケーション インテントは、プロバイダーのプロパティとして指定するか、拡張プロパティ文字列の一部として指定します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-186">Specify application intent as a provider property or as part of the extended properties string.</span></span>  
  
 `IDataInitialize::GetDataSource`  
 <span data-ttu-id="7c51e-187">`IDataInitialize::GetDataSource` には、`Application Intent` キーワードを含んだ入力接続文字列を渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-187">`IDataInitialize::GetDataSource` takes an input connection string that can contain the `Application Intent` keyword.</span></span>  
  
 `IDBProperties::GetProperties`  
 <span data-ttu-id="7c51e-188">`IDBProperties::GetProperties` は、現在データ ソースに設定されているプロパティの値を取得します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-188">`IDBProperties::GetProperties` retrieves the value of the property that is currently set on the data source.</span></span>  <span data-ttu-id="7c51e-189">`Application Intent` の値は、DBPROP_INIT_PROVIDERSTRING プロパティおよび SSPROP_INIT_APPLICATIONINTENT プロパティを通じて取得できます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-189">You can retrieve the `Application Intent` value through the DBPROP_INIT_PROVIDERSTRING property and SSPROP_INIT_APPLICATIONINTENT property.</span></span>  
  
 `IDBProperties::SetProperties`  
 <span data-ttu-id="7c51e-190">`ApplicationIntent` プロパティの値を設定するには、`IDBProperties::SetProperties` を呼び出します。このとき、引数として、"`SSPROP_INIT_APPLICATIONINTENT`" または "`ReadWrite`" を値として持つ `ReadOnly` プロパティを指定するか、"`DBPROP_INIT_PROVIDERSTRING`" または "`ApplicationIntent=ReadOnly`" を値として持つ `ApplicationIntent=ReadWrite` プロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-190">To set the `ApplicationIntent` property value, call `IDBProperties::SetProperties` passing in the `SSPROP_INIT_APPLICATIONINTENT` property with value "`ReadWrite`" or "`ReadOnly`" or `DBPROP_INIT_PROVIDERSTRING` property with value containing "`ApplicationIntent=ReadOnly`" or "`ApplicationIntent=ReadWrite`".</span></span>  
  
 <span data-ttu-id="7c51e-191">アプリケーション インテントは、**[データ リンク プロパティ]** ダイアログ ボックスの [すべて] タブの [アプリケーション インテントのプロパティ] フィールドで指定できます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-191">You can specify application intent in the Application Intent Properties field of the All tab in the **Data Link Properties** dialog box.</span></span>  
  
 <span data-ttu-id="7c51e-192">暗黙的な接続が確立された場合、その接続には、親の接続のアプリケーション インテント設定が使用されます。</span><span class="sxs-lookup"><span data-stu-id="7c51e-192">When implicit connections are established, the implicit connection will use the application intent setting of the parent connection.</span></span> <span data-ttu-id="7c51e-193">同様に、同じデータ ソースから作成されたセッションはいずれも、そのデータ ソースのアプリケーション インテント設定を継承します。</span><span class="sxs-lookup"><span data-stu-id="7c51e-193">Similarly, multiple sessions created from the same data source will inherit the data source's application intent setting.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c51e-194">参照</span><span class="sxs-lookup"><span data-stu-id="7c51e-194">See Also</span></span>  
 <span data-ttu-id="7c51e-195">[SQL Server Native Client の機能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="7c51e-195">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="7c51e-196">SQL Server Native Client での接続文字列キーワードの使用</span><span class="sxs-lookup"><span data-stu-id="7c51e-196">Using Connection String Keywords with SQL Server Native Client</span></span>](../applications/using-connection-string-keywords-with-sql-server-native-client.md)  
  
  
