---
title: 大きな CLR ユーザー定義型 (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- large CLR user-defined types [OLE DB]
ms.assetid: 4bf12058-0534-42ca-a5ba-b1c23b24d90f
author: rothja
ms.author: jroth
ms.openlocfilehash: 62384b2be5fda767ba306c0e9321fd27b8239f10
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714269"
---
# <a name="large-clr-user-defined-types-ole-db"></a><span data-ttu-id="1fdf8-102">大きな CLR ユーザー定義型 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-102">Large CLR User-Defined Types (OLE DB)</span></span>
  <span data-ttu-id="1fdf8-103">このトピックでは、大きな共通言語ランタイム (CLR) ユーザー定義型 (UDT) をサポートするための、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の OLE DB に対する変更について説明します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-103">This topic discusses the changes to OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support large common language runtime (CLR) user-defined types (UDTs).</span></span>  
  
 <span data-ttu-id="1fdf8-104">Native Client での大きな CLR Udt のサポートの詳細につい [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ては、「[大きな Clr ユーザー定義型](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-104">For more information about support for large CLR UDTs in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Large CLR User-Defined Types](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span></span> <span data-ttu-id="1fdf8-105">サンプルについては、「[大きな CLR UDT の使用 &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-105">For a sample, see [Use Large CLR UDTs &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span></span>  
  
## <a name="data-format"></a><span data-ttu-id="1fdf8-106">データ形式</span><span class="sxs-lookup"><span data-stu-id="1fdf8-106">Data Format</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1fdf8-107">Native Client では、大きなオブジェクト (LOB) の型についてサイズが無制限である値の長さを表す場合に、~0 が使用されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-107">Native Client uses ~0 to represent the length of values that are of unlimited size for large object (LOB) types.</span></span> <span data-ttu-id="1fdf8-108">8,000 バイトを超える CLR UDT のサイズも ~0 で表されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-108">~0 also represents the size of CLR UDTs that are larger than 8,000 bytes.</span></span>  
  
 <span data-ttu-id="1fdf8-109">次の表に、パラメーターおよび行セットでのデータ型のマッピングを示します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-109">The following table shows data type mapping in parameters and rowsets:</span></span>  
  
|<span data-ttu-id="1fdf8-110">SQL Server のデータ型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-110">SQL Server data type</span></span>|<span data-ttu-id="1fdf8-111">OLE DB データ型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-111">OLE DB data type</span></span>|<span data-ttu-id="1fdf8-112">メモリ レイアウト</span><span class="sxs-lookup"><span data-stu-id="1fdf8-112">Memory layout</span></span>|<span data-ttu-id="1fdf8-113">値</span><span class="sxs-lookup"><span data-stu-id="1fdf8-113">Value</span></span>|  
|--------------------------|----------------------|-------------------|-----------|  
|<span data-ttu-id="1fdf8-114">CLR UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-114">CLR UDT</span></span>|<span data-ttu-id="1fdf8-115">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-115">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-116">BYTE[](バイト配列\)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-116">BYTE[](byte array\)</span></span>|<span data-ttu-id="1fdf8-117">132 (oledb.h)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-117">132 (oledb.h)</span></span>|  
  
 <span data-ttu-id="1fdf8-118">UDT 値はバイト配列として表されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-118">UDT values are represented as byte arrays.</span></span> <span data-ttu-id="1fdf8-119">16 進文字列との間の変換がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-119">Conversions to and from hex strings are supported.</span></span> <span data-ttu-id="1fdf8-120">リテラル値は、"0x" で始まる 16 進文字列として表されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-120">Literal values are represented as hex strings with a prefix of "0x".</span></span> <span data-ttu-id="1fdf8-121">16 進文字列は、ベース 16 のバイナリ データをテキストで表現したものです。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-121">A hex string is the textual representation of binary data in base 16.</span></span> <span data-ttu-id="1fdf8-122">一例として、サーバー型 `varbinary(10)` から DBTYPE_STR への変換が挙げられます。この変換では、1 対の文字が 1 バイトを表す 20 文字の 16 進表記が生成されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-122">A example is a conversion from server type `varbinary(10)` to DBTYPE_STR, which results in hexadecimal representation of 20 characters where every pair of characters represents a single byte.</span></span>  
  
## <a name="parameter-properties"></a><span data-ttu-id="1fdf8-123">パラメーターのプロパティ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-123">Parameter Properties</span></span>  
 <span data-ttu-id="1fdf8-124">DBPROPSET_SQLSERVERPARAMETER プロパティ セットは、OLE DB を介して UDT をサポートします。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-124">The DBPROPSET_SQLSERVERPARAMETER property set supports UDTs through OLE DB.</span></span> <span data-ttu-id="1fdf8-125">詳細については、「[ユーザー定義型の使用](../features/using-user-defined-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-125">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="column-properties"></a><span data-ttu-id="1fdf8-126">列のプロパティ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-126">Column Properties</span></span>  
 <span data-ttu-id="1fdf8-127">DBPROPSET_SQLSERVERCOLUMN プロパティ セットは、OLE DB を介してテーブルの作成をサポートします。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-127">The DBPROPSET_SQLSERVERCOLUMN property set supports the creation of tables through OLE DB.</span></span> <span data-ttu-id="1fdf8-128">詳細については、「[ユーザー定義型の使用](../features/using-user-defined-types.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-128">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="data-type-mapping-in-itabledefinitioncreatetable"></a><span data-ttu-id="1fdf8-129">ITableDefinition::CreateTable でのデータ型マッピング</span><span class="sxs-lookup"><span data-stu-id="1fdf8-129">Data Type Mapping in ITableDefinition::CreateTable</span></span>  
 <span data-ttu-id="1fdf8-130">`DBCOLUMNDESC`UDT 列が必要な場合、ITableDefinition:: CreateTable で使用される構造体では、次の情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-130">The following information is used in `DBCOLUMNDESC` structures used by ITableDefinition::CreateTable when UDT columns are required:</span></span>  
  
|<span data-ttu-id="1fdf8-131">OLE DB データ型 (*wType*)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-131">OLE DB data type (*wType*)</span></span>|<span data-ttu-id="1fdf8-132">*pwszTypeName*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-132">*pwszTypeName*</span></span>|<span data-ttu-id="1fdf8-133">SQL Server のデータ型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-133">SQL Server data type</span></span>|<span data-ttu-id="1fdf8-134">*rgPropertySets*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-134">*rgPropertySets*</span></span>|  
|----------------------------------|--------------------|--------------------------|----------------------|  
|<span data-ttu-id="1fdf8-135">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-135">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-136">無視</span><span class="sxs-lookup"><span data-stu-id="1fdf8-136">Ignored</span></span>|<span data-ttu-id="1fdf8-137">UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-137">UDT</span></span>|<span data-ttu-id="1fdf8-138">DBPROPSET_SQLSERVERCOLUMN プロパティ セットを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-138">Must include a DBPROPSET_SQLSERVERCOLUMN property set.</span></span>|  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="1fdf8-139">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="1fdf8-139">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="1fdf8-140">**prgParamInfo** を介して DBPARAMINFO 構造体に返される情報は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-140">Information returned in the DBPARAMINFO structure through **prgParamInfo** is as follows:</span></span>  
  
|<span data-ttu-id="1fdf8-141">パラメーターのタイプ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-141">Parameter type</span></span>|<span data-ttu-id="1fdf8-142">*wType*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-142">*wType*</span></span>|<span data-ttu-id="1fdf8-143">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-143">*ulParamSize*</span></span>|<span data-ttu-id="1fdf8-144">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-144">*bPrecision*</span></span>|<span data-ttu-id="1fdf8-145">*bScale*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-145">*bScale*</span></span>|<span data-ttu-id="1fdf8-146">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1fdf8-146">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="1fdf8-147">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-147">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-148">(8,000 バイト以下の長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-148">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-149">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="1fdf8-149">"DBTYPE_UDT"</span></span>|<span data-ttu-id="1fdf8-150">*n*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-150">*n*</span></span>|<span data-ttu-id="1fdf8-151">undefined</span><span class="sxs-lookup"><span data-stu-id="1fdf8-151">undefined</span></span>|<span data-ttu-id="1fdf8-152">undefined</span><span class="sxs-lookup"><span data-stu-id="1fdf8-152">undefined</span></span>|<span data-ttu-id="1fdf8-153">オフ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-153">clear</span></span>|  
|<span data-ttu-id="1fdf8-154">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-154">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-155">(8,000 バイトを超える長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-155">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-156">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="1fdf8-156">"DBTYPE_UDT"</span></span>|<span data-ttu-id="1fdf8-157">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-157">~0</span></span>|<span data-ttu-id="1fdf8-158">undefined</span><span class="sxs-lookup"><span data-stu-id="1fdf8-158">undefined</span></span>|<span data-ttu-id="1fdf8-159">undefined</span><span class="sxs-lookup"><span data-stu-id="1fdf8-159">undefined</span></span>|<span data-ttu-id="1fdf8-160">set</span><span class="sxs-lookup"><span data-stu-id="1fdf8-160">set</span></span>|  
  
## <a name="icommandwithparameterssetparameterinfo"></a><span data-ttu-id="1fdf8-161">ICommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="1fdf8-161">ICommandWithParameters::SetParameterInfo</span></span>  
 <span data-ttu-id="1fdf8-162">DBPARAMBINDINFO 構造体で提供される情報は、次の表に準拠する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-162">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="1fdf8-163">パラメーターのタイプ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-163">Parameter type</span></span>|<span data-ttu-id="1fdf8-164">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-164">*pwszDataSourceType*</span></span>|<span data-ttu-id="1fdf8-165">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-165">*ulParamSize*</span></span>|<span data-ttu-id="1fdf8-166">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-166">*bPrecision*</span></span>|<span data-ttu-id="1fdf8-167">*bScale*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-167">*bScale*</span></span>|<span data-ttu-id="1fdf8-168">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1fdf8-168">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|--------------------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="1fdf8-169">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-169">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-170">(8,000 バイト以下の長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-170">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-171">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-171">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-172">*n*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-172">*n*</span></span>|<span data-ttu-id="1fdf8-173">無視</span><span class="sxs-lookup"><span data-stu-id="1fdf8-173">ignored</span></span>|<span data-ttu-id="1fdf8-174">無視</span><span class="sxs-lookup"><span data-stu-id="1fdf8-174">ignored</span></span>|<span data-ttu-id="1fdf8-175">パラメーターが DBTYPE_IUNKNOWN を使用して渡される場合に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-175">Must be set if the parameter is to be passed using DBTYPE_IUNKNOWN.</span></span>|  
|<span data-ttu-id="1fdf8-176">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-176">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-177">(8,000 バイトを超える長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-177">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-178">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-178">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-179">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-179">~0</span></span>|<span data-ttu-id="1fdf8-180">無視</span><span class="sxs-lookup"><span data-stu-id="1fdf8-180">ignored</span></span>|<span data-ttu-id="1fdf8-181">無視</span><span class="sxs-lookup"><span data-stu-id="1fdf8-181">ignored</span></span>|<span data-ttu-id="1fdf8-182">無視</span><span class="sxs-lookup"><span data-stu-id="1fdf8-182">ignored</span></span>|  
  
## <a name="isscommandwithparameters"></a><span data-ttu-id="1fdf8-183">ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="1fdf8-183">ISSCommandWithParameters</span></span>  
 <span data-ttu-id="1fdf8-184">アプリケーションでは、**ISSCommandWithParameters** を使用して、「パラメーターのプロパティ」セクションで定義されているパラメーターのプロパティを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-184">Applications use **ISSCommandWithParameters** to get and set the parameter properties defined in the Parameter Properties section.</span></span>  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="1fdf8-185">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="1fdf8-185">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="1fdf8-186">返される列は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-186">Columns returned are as follows:</span></span>  
  
|<span data-ttu-id="1fdf8-187">列の型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-187">Column type</span></span>|<span data-ttu-id="1fdf8-188">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-188">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="1fdf8-189">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-189">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="1fdf8-190">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="1fdf8-190">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="1fdf8-191">DBCOLUMN_SCALE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-191">DBCOLUMN_SCALE</span></span>|<span data-ttu-id="1fdf8-192">DBCOLUMN_FLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1fdf8-192">DBCOLUMN_FLAGS_ISLONG</span></span>|<span data-ttu-id="1fdf8-193">DBCOLUMNS_ISSEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-193">DBCOLUMNS_ISSEARCHABLE</span></span>|<span data-ttu-id="1fdf8-194">DBCOLUMN_OCTETLENGTH</span><span class="sxs-lookup"><span data-stu-id="1fdf8-194">DBCOLUMN_OCTETLENGTH</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|---------------------|-----------------------------|-----------------------------|---------------------------|  
|<span data-ttu-id="1fdf8-195">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-195">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-196">(8,000 バイト以下の長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-196">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-197">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-197">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-198">*n*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-198">*n*</span></span>|<span data-ttu-id="1fdf8-199">NULL</span><span class="sxs-lookup"><span data-stu-id="1fdf8-199">NULL</span></span>|<span data-ttu-id="1fdf8-200">NULL</span><span class="sxs-lookup"><span data-stu-id="1fdf8-200">NULL</span></span>|<span data-ttu-id="1fdf8-201">Clear</span><span class="sxs-lookup"><span data-stu-id="1fdf8-201">Clear</span></span>|<span data-ttu-id="1fdf8-202">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-202">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="1fdf8-203">n</span><span class="sxs-lookup"><span data-stu-id="1fdf8-203">n</span></span>|  
|<span data-ttu-id="1fdf8-204">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-204">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-205">(8,000 バイトを超える長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-205">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-206">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-206">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-207">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-207">~0</span></span>|<span data-ttu-id="1fdf8-208">NULL</span><span class="sxs-lookup"><span data-stu-id="1fdf8-208">NULL</span></span>|<span data-ttu-id="1fdf8-209">NULL</span><span class="sxs-lookup"><span data-stu-id="1fdf8-209">NULL</span></span>|<span data-ttu-id="1fdf8-210">オン</span><span class="sxs-lookup"><span data-stu-id="1fdf8-210">Set</span></span>|<span data-ttu-id="1fdf8-211">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-211">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="1fdf8-212">0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-212">0</span></span>|  
  
 <span data-ttu-id="1fdf8-213">UDT には次の列も定義されています。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-213">The following columns are also defined for UDTs:</span></span>  
  
|<span data-ttu-id="1fdf8-214">列識別子</span><span class="sxs-lookup"><span data-stu-id="1fdf8-214">Column Identifier</span></span>|<span data-ttu-id="1fdf8-215">Type</span><span class="sxs-lookup"><span data-stu-id="1fdf8-215">Type</span></span>|<span data-ttu-id="1fdf8-216">説明</span><span class="sxs-lookup"><span data-stu-id="1fdf8-216">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="1fdf8-217">DBCOLUMN_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-217">DBCOLUMN_UDT_CATALOGNAME</span></span>|<span data-ttu-id="1fdf8-218">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-218">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-219">UDT 列の場合は、UDT が定義されているカタログの名前。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-219">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="1fdf8-220">DBCOLUMN_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-220">DBCOLUMN_UDT_SCHEMANAME</span></span>|<span data-ttu-id="1fdf8-221">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-221">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-222">UDT 列の場合は、UDT が定義されているスキーマの名前。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-222">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="1fdf8-223">DBCOLUMN_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-223">DBCOLUMN_UDT_NAME</span></span>|<span data-ttu-id="1fdf8-224">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-224">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-225">UDT 列の場合は、UDT の 1 部構成の名前。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-225">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="1fdf8-226">DBCOLUMN_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-226">DBCOLUMN_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="1fdf8-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-228">UDT 列の場合は、UDT の完全な型名。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-228">For UDT columns, the full type name of the UDT.</span></span> <span data-ttu-id="1fdf8-229">アセンブリ型の完全修飾名を使用することで、Type.GetType メソッドを使用してその型のオブジェクトのインスタンスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-229">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="1fdf8-230">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="1fdf8-230">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="1fdf8-231">DBCOLUMNINFO 構造体で返される情報は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-231">The information returned in the DBCOLUMNINFO structure is as follows:</span></span>  
  
|<span data-ttu-id="1fdf8-232">パラメーターのタイプ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-232">Parameter type</span></span>|<span data-ttu-id="1fdf8-233">*wType*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-233">*wType*</span></span>|<span data-ttu-id="1fdf8-234">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-234">*ulColumnSize*</span></span>|<span data-ttu-id="1fdf8-235">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-235">*bPrecision*</span></span>|<span data-ttu-id="1fdf8-236">*bScale*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-236">*bScale*</span></span>|<span data-ttu-id="1fdf8-237">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-237">*dwFlags*</span></span><br /><br /> <span data-ttu-id="1fdf8-238">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1fdf8-238">DBCOLUMNFLAGS_ISLONG</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------|  
|<span data-ttu-id="1fdf8-239">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-239">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-240">(8,000 バイト以下の長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-240">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-241">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-241">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-242">*n*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-242">*n*</span></span>|<span data-ttu-id="1fdf8-243">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-243">~0</span></span>|<span data-ttu-id="1fdf8-244">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-244">~0</span></span>|<span data-ttu-id="1fdf8-245">Clear</span><span class="sxs-lookup"><span data-stu-id="1fdf8-245">Clear</span></span>|  
|<span data-ttu-id="1fdf8-246">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-246">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-247">(8,000 バイトを超える長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-247">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-248">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-248">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-249">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-249">~0</span></span>|<span data-ttu-id="1fdf8-250">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-250">~0</span></span>|<span data-ttu-id="1fdf8-251">~0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-251">~0</span></span>|<span data-ttu-id="1fdf8-252">オン</span><span class="sxs-lookup"><span data-stu-id="1fdf8-252">Set</span></span>|  
  
## <a name="columns-rowset-schema-rowsets"></a><span data-ttu-id="1fdf8-253">COLUMNS 行セット (スキーマ行セット)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-253">COLUMNS Rowset (Schema Rowsets)</span></span>  
 <span data-ttu-id="1fdf8-254">UDT 型に対して返される列値を次に示します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-254">The following column values are returned for UDT types:</span></span>  
  
|<span data-ttu-id="1fdf8-255">列の型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-255">Column type</span></span>|<span data-ttu-id="1fdf8-256">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-256">DATA_TYPE</span></span>|<span data-ttu-id="1fdf8-257">COLUMN_FLAGS、DBCOLUMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="1fdf8-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span></span>|<span data-ttu-id="1fdf8-258">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="1fdf8-258">CHARACTER_OCTET_LENGTH</span></span>|  
|-----------------|----------------|-----------------------------------------|------------------------------|  
|<span data-ttu-id="1fdf8-259">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-259">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-260">(8,000 バイト以下の長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-260">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-261">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-261">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-262">Clear</span><span class="sxs-lookup"><span data-stu-id="1fdf8-262">Clear</span></span>|<span data-ttu-id="1fdf8-263">*n*</span><span class="sxs-lookup"><span data-stu-id="1fdf8-263">*n*</span></span>|  
|<span data-ttu-id="1fdf8-264">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-264">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-265">(8,000 バイトを超える長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-265">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-266">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-266">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-267">オン</span><span class="sxs-lookup"><span data-stu-id="1fdf8-267">Set</span></span>|<span data-ttu-id="1fdf8-268">0</span><span class="sxs-lookup"><span data-stu-id="1fdf8-268">0</span></span>|  
  
 <span data-ttu-id="1fdf8-269">UDT には、次の追加の列が定義されています。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-269">The following additional columns are defined for UDTs:</span></span>  
  
|<span data-ttu-id="1fdf8-270">列識別子</span><span class="sxs-lookup"><span data-stu-id="1fdf8-270">Column identifier</span></span>|<span data-ttu-id="1fdf8-271">Type</span><span class="sxs-lookup"><span data-stu-id="1fdf8-271">Type</span></span>|<span data-ttu-id="1fdf8-272">説明</span><span class="sxs-lookup"><span data-stu-id="1fdf8-272">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="1fdf8-273">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-273">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="1fdf8-274">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-274">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-275">UDT 列の場合は、UDT が定義されているカタログの名前。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-275">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="1fdf8-276">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-276">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="1fdf8-277">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-277">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-278">UDT 列の場合は、UDT が定義されているスキーマの名前。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-278">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="1fdf8-279">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-279">SS_UDT_NAME</span></span>|<span data-ttu-id="1fdf8-280">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-280">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-281">UDT 列の場合は、UDT の 1 部構成の名前。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-281">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="1fdf8-282">SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="1fdf8-282">SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="1fdf8-283">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-283">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-284">UDT 列の場合は、UDT の完全な型名。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-284">For UDT columns, this is the full type name of the UDT.</span></span> <span data-ttu-id="1fdf8-285">アセンブリ型の完全修飾名を使用することで、Type.GetType メソッドを使用してその型のオブジェクトのインスタンスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-285">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
 <span data-ttu-id="1fdf8-286">PROCEDURE_PARAMETERS 行セットに関しては、DATA_TYPE に COLUMNS スキーマ行セットと同じ値が格納され、TYPE_NAME に UDT が格納されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-286">Regarding the PROCEDURE_PARAMETERS rowset, DATA_TYPE contains the same values as the COLUMNS schema rowset and TYPE_NAME contains UDT.</span></span> <span data-ttu-id="1fdf8-287">同じ追加の列も定義されています。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-287">The same additional columns are also defined.</span></span>  
  
 <span data-ttu-id="1fdf8-288">PROVIDER_TYPES スキーマ行セットには、ユーザー定義型が表示されません。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-288">User-defined types will not appear in the PROVIDER_TYPES schema rowset.</span></span>  
  
## <a name="bindings-and-conversions"></a><span data-ttu-id="1fdf8-289">バインドと変換</span><span class="sxs-lookup"><span data-stu-id="1fdf8-289">Bindings and Conversions</span></span>  
  
|<span data-ttu-id="1fdf8-290">Binding データ型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-290">Binding data tpe</span></span>|<span data-ttu-id="1fdf8-291">UDT からサーバー</span><span class="sxs-lookup"><span data-stu-id="1fdf8-291">UDT to server</span></span>|<span data-ttu-id="1fdf8-292">UDT 以外からサーバー</span><span class="sxs-lookup"><span data-stu-id="1fdf8-292">Non-UDT to server</span></span>|<span data-ttu-id="1fdf8-293">サーバーから UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-293">UDT from server</span></span>|<span data-ttu-id="1fdf8-294">サーバーから UDT 以外</span><span class="sxs-lookup"><span data-stu-id="1fdf8-294">Non-UDT from server</span></span>|  
|----------------------|-------------------|------------------------|---------------------|--------------------------|  
|<span data-ttu-id="1fdf8-295">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-295">DBTYPE_UDT</span></span>|<span data-ttu-id="1fdf8-296">サポート (5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-296">Supported (5)</span></span>|<span data-ttu-id="1fdf8-297">エラー (1)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-297">Error (1)</span></span>|<span data-ttu-id="1fdf8-298">サポート (5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-298">Supported (5)</span></span>|<span data-ttu-id="1fdf8-299">エラー (4)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-299">Error (4)</span></span>|  
|<span data-ttu-id="1fdf8-300">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="1fdf8-300">DBTYPE_BYTES</span></span>|<span data-ttu-id="1fdf8-301">サポート (5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-301">Supported (5)</span></span>|<span data-ttu-id="1fdf8-302">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-302">N/A</span></span>|<span data-ttu-id="1fdf8-303">サポート (5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-303">Supported (5)</span></span>|<span data-ttu-id="1fdf8-304">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-304">N/A</span></span>|  
|<span data-ttu-id="1fdf8-305">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-305">DBTYPE_WSTR</span></span>|<span data-ttu-id="1fdf8-306">サポート (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-306">Supported (2), (5)</span></span>|<span data-ttu-id="1fdf8-307">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-307">N/A</span></span>|<span data-ttu-id="1fdf8-308">サポート (3)、(5)、(6)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-308">Supported (3), (5), (6)</span></span>|<span data-ttu-id="1fdf8-309">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-309">N/A</span></span>|  
|<span data-ttu-id="1fdf8-310">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-310">DBTYPE_BSTR</span></span>|<span data-ttu-id="1fdf8-311">サポート (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-311">Supported (2), (5)</span></span>|<span data-ttu-id="1fdf8-312">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-312">N/A</span></span>|<span data-ttu-id="1fdf8-313">サポート (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-313">Supported (3), (5)</span></span>|<span data-ttu-id="1fdf8-314">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-314">N/A</span></span>|  
|<span data-ttu-id="1fdf8-315">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="1fdf8-315">DBTYPE_STR</span></span>|<span data-ttu-id="1fdf8-316">サポート (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-316">Supported (2), (5)</span></span>|<span data-ttu-id="1fdf8-317">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-317">N/A</span></span>|<span data-ttu-id="1fdf8-318">サポート (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-318">Supported (3), (5)</span></span>|<span data-ttu-id="1fdf8-319">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-319">N/A</span></span>|  
|<span data-ttu-id="1fdf8-320">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="1fdf8-320">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="1fdf8-321">サポート (6)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-321">Supported (6)</span></span>|<span data-ttu-id="1fdf8-322">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-322">N/A</span></span>|<span data-ttu-id="1fdf8-323">サポート (6)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-323">Supported (6)</span></span>|<span data-ttu-id="1fdf8-324">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-324">N/A</span></span>|  
|<span data-ttu-id="1fdf8-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="1fdf8-326">サポート (5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-326">Supported  (5)</span></span>|<span data-ttu-id="1fdf8-327">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-327">N/A</span></span>|<span data-ttu-id="1fdf8-328">サポート (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-328">Supported (3), (5)</span></span>|<span data-ttu-id="1fdf8-329">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-329">N/A</span></span>|  
|<span data-ttu-id="1fdf8-330">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-330">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="1fdf8-331">サポート (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-331">Supported (2), (5)</span></span>|<span data-ttu-id="1fdf8-332">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-332">N/A</span></span>|<span data-ttu-id="1fdf8-333">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-333">N/A</span></span>|<span data-ttu-id="1fdf8-334">該当なし</span><span class="sxs-lookup"><span data-stu-id="1fdf8-334">N/A</span></span>|  
  
### <a name="key-to-symbols"></a><span data-ttu-id="1fdf8-335">記号の説明</span><span class="sxs-lookup"><span data-stu-id="1fdf8-335">Key to Symbols</span></span>  
  
|<span data-ttu-id="1fdf8-336">Symbol</span><span class="sxs-lookup"><span data-stu-id="1fdf8-336">Symbol</span></span>|<span data-ttu-id="1fdf8-337">意味</span><span class="sxs-lookup"><span data-stu-id="1fdf8-337">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="1fdf8-338">1</span><span class="sxs-lookup"><span data-stu-id="1fdf8-338">1</span></span>|<span data-ttu-id="1fdf8-339">**ICommandWithParameters::SetParameterInfo** で DBTYPE_UDT 以外のサーバーの型が指定され、アクセサーの型が DBTYPE_UDT の場合は、ステートメントの実行時にエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-339">If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed.</span></span>  <span data-ttu-id="1fdf8-340">発生するエラーは DB_E_ERRORSOCCURRED、パラメーターの状態は DBSTATUS_E_BADACCESSOR です。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-340">The error will be DB_E_ERRORSOCCURRED and the parameter status will be DBSTATUS_E_BADACCESSOR.</span></span><br /><br /> <span data-ttu-id="1fdf8-341">UDT ではないサーバー パラメーターに UDT 型のパラメーターを指定すると、エラーになります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-341">It is an error to specify a parameter of type UDT for a server parameter that is not a UDT.</span></span>|  
|<span data-ttu-id="1fdf8-342">2</span><span class="sxs-lookup"><span data-stu-id="1fdf8-342">2</span></span>|<span data-ttu-id="1fdf8-343">データが 16 進数文字列からバイナリ データに変換されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-343">Data is converted from hex string to binary data.</span></span>|  
|<span data-ttu-id="1fdf8-344">3</span><span class="sxs-lookup"><span data-stu-id="1fdf8-344">3</span></span>|<span data-ttu-id="1fdf8-345">データがバイナリ データから 16 進文字列に変換されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-345">Data is converted from binary data to hex string.</span></span>|  
|<span data-ttu-id="1fdf8-346">4</span><span class="sxs-lookup"><span data-stu-id="1fdf8-346">4</span></span>|<span data-ttu-id="1fdf8-347">**CreateAccessor** または **GetNextRows** を使用したときに、検証が行われる場合があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-347">Validation can happen when using **CreateAccessor** or **GetNextRows**.</span></span> <span data-ttu-id="1fdf8-348">このエラーは DB_E_ERRORSOCCURRED です。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-348">The error is DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="1fdf8-349">バインドの状態は、DBBINDSTATUS_UNSUPPORTEDCONVERSION に設定されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-349">Binding status is set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>|  
|<span data-ttu-id="1fdf8-350">5</span><span class="sxs-lookup"><span data-stu-id="1fdf8-350">5</span></span>|<span data-ttu-id="1fdf8-351">BY_REF を使用できます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-351">BY_REF may be used.</span></span>|  
|<span data-ttu-id="1fdf8-352">6</span><span class="sxs-lookup"><span data-stu-id="1fdf8-352">6</span></span>|<span data-ttu-id="1fdf8-353">UDT パラメーターを、DBBINDING で DBTYPE_IUNKNOWN としてバインドできます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-353">UDT parameters can be bound as DBTYPE_IUNKNOWN in the DBBINDING.</span></span> <span data-ttu-id="1fdf8-354">DBTYPE_IUNKNOWN へのバインドは、アプリケーションで ISequentialStream インターフェイスを使用してデータをストリームとして処理する必要があることを示します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-354">Binding to DBTYPE_IUNKNOWN indicates that the application wants to process the data as a stream using the ISequentialStream interface.</span></span> <span data-ttu-id="1fdf8-355">コンシューマーが DBTYPE_IUNKNOWN 型としてバインドで*Wtype*を指定し、ストアドプロシージャの対応する列または出力パラメーターが UDT の場合、SQL Server Native Client は ISequentialStream を返します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-355">When a consumer specifies *wType* in a binding as type DBTYPE_IUNKNOWN, and the corresponding column or output parameter of the stored procedure is a UDT, SQL Server Native Client will return ISequentialStream.</span></span> <span data-ttu-id="1fdf8-356">入力パラメーターの場合、SQL Server Native Client は ISequentialStream インターフェイスのを照会します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-356">For an input parameter, SQL Server Native Client will query for the for the ISequentialStream interface.</span></span><br /><br /> <span data-ttu-id="1fdf8-357">UDT が大きい場合は、DBTYPE_IUNKNOWN バインドを使用しながら UDT データの長さをバインドしないようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-357">You can choose to not bind the length of UDT data while using DBTYPE_IUNKNOWN binding, in the case of large UDTs.</span></span> <span data-ttu-id="1fdf8-358">ただし、小さな UDT の場合は長さをバインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-358">However, the length must be bound for small UDTs.</span></span> <span data-ttu-id="1fdf8-359">次の条件が 1 つ以上当てはまる場合は、DBTYPE_UDT パラメーターを大きな UDT として指定できます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-359">A DBTYPE_UDT parameter can be specified as a large UDT if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="1fdf8-360">-   *Ulparamparamsize*は ~ 0 です。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-360">-   *ulParamParamSize* is ~0.</span></span><br /><span data-ttu-id="1fdf8-361">-DBPARAMFLAGS_ISLONG が DBPARAMBINDINFO 構造体で設定されています。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-361">-   DBPARAMFLAGS_ISLONG is set in the DBPARAMBINDINFO struct.</span></span><br /><br /> <span data-ttu-id="1fdf8-362">行データの場合は、DBTYPE_IUNKNOWN バインドを大きな UDT だけに使用できます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-362">For row data, DBTYPE_IUNKNOWN binding is only allowed for large UDTs.</span></span> <span data-ttu-id="1fdf8-363">列が大きな UDT 型であるかどうかを確認するには、行セットまたはコマンド オブジェクトの IColumnsInfo インターフェイス上で IColumnsInfo::GetColumnInfo メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-363">You can find out whether a column is a large UDT type by using the IColumnsInfo::GetColumnInfo method on a Rowset or Command object's IColumnsInfo interface.</span></span> <span data-ttu-id="1fdf8-364">次の条件が 1 つ以上当てはまる場合、DBTYPE_UDT 列は大きな UDT 列です。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-364">A DBTYPE_UDT column is a large UDT column if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="1fdf8-365">-DBCOLUMNFLAGS_ISLONG フラグが、DBCOLUMNINFO 構造体の*dwFlags*メンバーに設定されています</span><span class="sxs-lookup"><span data-stu-id="1fdf8-365">-   DBCOLUMNFLAGS_ISLONG flag is set on *dwFlags* member of DBCOLUMNINFO structure</span></span><br /><span data-ttu-id="1fdf8-366">-   DBCOLUMNINFO の*Ulcolumnsize*メンバーは ~ 0 です。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-366">-   *ulColumnSize* member of DBCOLUMNINFO is ~0.</span></span>|  
  
 <span data-ttu-id="1fdf8-367">DBTYPE_NULL と DBTYPE_EMPTY は入力パラメーターにバインドできますが、出力パラメーターや結果にはバインドできません。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-367">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters, but not for output parameters or results.</span></span> <span data-ttu-id="1fdf8-368">入力パラメーターにバインドした場合は、状態を DBSTATUS_S_ISNULL (DBTYPE_NULL の場合) または DBSTATUS_S_DEFAULT (DBTYPE_EMPTY の場合) に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-368">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL for DBTYPE_NULL or DBSTATUS_S_DEFAULT for DBTYPE_EMPTY.</span></span> <span data-ttu-id="1fdf8-369">DBTYPE_BYREF を、DBTYPE_NULL または DBTYPE_EMPTY と共に使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-369">DBTYPE_BYREF cannot be used with DBTYPE_NULL or DBTYPE_EMPTY.</span></span>  
  
 <span data-ttu-id="1fdf8-370">DBTYPE_UDT は、DBTYPE_EMPTY および DBTYPE_NULL に変換することもできます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-370">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL.</span></span> <span data-ttu-id="1fdf8-371">ただし、DBTYPE_NULL および DBTYPE_EMPTY を DBTYPE_UDT に変換することはできません。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-371">However, DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="1fdf8-372">この動作は、DBTYPE_BYTES 型と一貫性があります。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-372">This is consistent with DBTYPE_BYTES.</span></span> <span data-ttu-id="1fdf8-373">UDT をパラメーターとして処理する場合には、**ISSCommandWithParameters** が使用されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-373">**ISSCommandWithParameters** is used to process UDTs as parameters.</span></span>  
  
 <span data-ttu-id="1fdf8-374">OLE DB Core Services で提供されるデータ変換 (**IDataConvert**) は、DBTYPE_UDT 型には適用できません。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-374">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span>  
  
 <span data-ttu-id="1fdf8-375">また、その他のバインドもサポートされません。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-375">No other bindings are supported.</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="1fdf8-376">IRowsetFind での比較</span><span class="sxs-lookup"><span data-stu-id="1fdf8-376">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="1fdf8-377">UDT 型については、次の比較のみがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-377">For UDT types, only the following comparisons are supported:</span></span>  
  
-   <span data-ttu-id="1fdf8-378">EQ</span><span class="sxs-lookup"><span data-stu-id="1fdf8-378">EQ</span></span>  
  
-   <span data-ttu-id="1fdf8-379">NE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-379">NE</span></span>  
  
-   <span data-ttu-id="1fdf8-380">IGNORE</span><span class="sxs-lookup"><span data-stu-id="1fdf8-380">IGNORE</span></span>  
  
 <span data-ttu-id="1fdf8-381">その他の比較を試みると、DB_E_BADCOMPAREOP が返されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-381">If any other comparison is attempted DB_E_BADCOMPAREOP is returned.</span></span>  
  
## <a name="bcp-support-for-udts"></a><span data-ttu-id="1fdf8-382">BCP による UDT のサポート</span><span class="sxs-lookup"><span data-stu-id="1fdf8-382">BCP Support for UDTs</span></span>  
 <span data-ttu-id="1fdf8-383">UDT 値は、文字値またはバイナリ値としてのみインポートおよびエクスポートできます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-383">UDT values can be imported and exported only as character or binary values.</span></span>  
  
## <a name="down-level-client-behavior-for-udts"></a><span data-ttu-id="1fdf8-384">UDT に対する下位クライアントの動作</span><span class="sxs-lookup"><span data-stu-id="1fdf8-384">Down-level Client Behavior for UDTs</span></span>  
 <span data-ttu-id="1fdf8-385">UDT に対しては、下位クライアントで次のように型マッピングが行われます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-385">UDTs are subject to type mapping with down-level clients, as follows:</span></span>  
  
|<span data-ttu-id="1fdf8-386">クライアントのバージョン</span><span class="sxs-lookup"><span data-stu-id="1fdf8-386">Client version</span></span>|<span data-ttu-id="1fdf8-387">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-387">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-388">(8,000 バイト以下の長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-388">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="1fdf8-389">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-389">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="1fdf8-390">(8,000 バイトを超える長さ)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-390">(length greater than 8,000 bytes)</span></span>|  
|--------------------|------------------------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="1fdf8-391">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="1fdf8-391">SQL Server 2005</span></span>|<span data-ttu-id="1fdf8-392">UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-392">UDT</span></span>|<span data-ttu-id="1fdf8-393">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="1fdf8-393">varbinary(max)</span></span>|  
|<span data-ttu-id="1fdf8-394">SQL Server 2008 以降</span><span class="sxs-lookup"><span data-stu-id="1fdf8-394">SQL Server 2008 and later</span></span>|<span data-ttu-id="1fdf8-395">UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-395">UDT</span></span>|<span data-ttu-id="1fdf8-396">UDT</span><span class="sxs-lookup"><span data-stu-id="1fdf8-396">UDT</span></span>|  
  
 <span data-ttu-id="1fdf8-397">`DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) を "80" に設定すると、大きな UDT 型が、下位クライアントで表示されるときと同じようにクライアントで表示されます。</span><span class="sxs-lookup"><span data-stu-id="1fdf8-397">When `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) is set to "80", large UDT types appear to clients in the same way that they appear for down-level clients.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1fdf8-398">参照</span><span class="sxs-lookup"><span data-stu-id="1fdf8-398">See Also</span></span>  
 [<span data-ttu-id="1fdf8-399">大きな CLR ユーザー定義型</span><span class="sxs-lookup"><span data-stu-id="1fdf8-399">Large CLR User-Defined Types</span></span>](../features/large-clr-user-defined-types.md)  
  
  
