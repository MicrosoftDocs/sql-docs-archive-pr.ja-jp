---
title: SQL Server 2005 Native Client からのアプリケーションの更新 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: rothja
ms.author: jroth
ms.openlocfilehash: 6db02837b854d237607eba7583d204a4860906b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738238"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a><span data-ttu-id="9ed0e-102">SQL Server 2005 Native Client からのアプリケーションの更新</span><span class="sxs-lookup"><span data-stu-id="9ed0e-102">Updating an Application from SQL Server 2005 Native Client</span></span>
  <span data-ttu-id="9ed0e-103">このトピックでは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 以降の [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Native Client における重大な変更について説明します。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-103">This topic discusses the breaking changes in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client since [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="9ed0e-104">Microsoft Data Access Components (MDAC) を [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client にアップグレードした場合も、一部の動作で違いが生じます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-104">When you upgrade from Microsoft Data Access Components (MDAC) to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, you might also see some behavior differences.</span></span> <span data-ttu-id="9ed0e-105">詳細については、「 [MDAC から SQL Server Native Client するようにアプリケーションを更新する](updating-an-application-to-sql-server-native-client-from-mdac.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-105">For more information, see [Updating an Application to SQL Server Native Client from MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span></span>  
  
 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] <span data-ttu-id="9ed0e-106">に付属する [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-106">Native Client 9.0 shipped with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] <span data-ttu-id="9ed0e-107">に付属する [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-107">Native Client 10.0 shipped with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9ed0e-108">に付属する [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] Native Client 10.5。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-108">Native Client 10.5 shipped with [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9ed0e-109">および [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] に付属する [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] Native Client 11.0。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-109">Native Client 11.0 shipped with [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] and [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span>  
  
|<span data-ttu-id="9ed0e-110">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降の SQL Server Native Client で変更された動作</span><span class="sxs-lookup"><span data-stu-id="9ed0e-110">Changed behavior in SQL Server Native Client Since [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span></span>|<span data-ttu-id="9ed0e-111">説明</span><span class="sxs-lookup"><span data-stu-id="9ed0e-111">Description</span></span>|  
|------------------------------------------------------------------------------------|-----------------|  
|<span data-ttu-id="9ed0e-112">OLE DB によって定義された有効桁数までしか埋め込まれない</span><span class="sxs-lookup"><span data-stu-id="9ed0e-112">OLE DB pads only to the defined scale.</span></span>|<span data-ttu-id="9ed0e-113">変換後のデータがサーバーに送信される変換の場合、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 以降) では、データの末尾の 0 は `datetime` 値の最大長までしか埋め込まれません。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-113">For conversions where converted data is sent to the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) pads trailing zeros in data only up to the maximum length of `datetime` values.</span></span> <span data-ttu-id="9ed0e-114">SQL Server Native Client 9.0 では、9 桁まで埋め込まれていました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-114">SQL Server Native Client 9.0 padded to 9 digits.</span></span>|  
|<span data-ttu-id="9ed0e-115">ICommandWithParameter::SetParameterInfo の DBTYPE_DBTIMESTAMP が検証される。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-115">Validate DBTYPE_DBTIMESTAMP for ICommandWithParameter::SetParameterInfo.</span></span>|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="9ed0e-116">Native Client (以降 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ) では、ICommandWithParameter:: SetParameterInfo の*bscale*の OLE DB 要件を DBTYPE_DBTIMESTAMP の秒の小数部の有効桁数に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-116">Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) implements the OLE DB requirement for *bScale* in ICommandWithParameter::SetParameterInfo to be set to the fractional seconds' precision for DBTYPE_DBTIMESTAMP.</span></span>|  
|<span data-ttu-id="9ed0e-117">この `sp_columns` ストアドプロシージャでは、IS_NULLABLE 列に対して " **no** " ではなく **"no"** が返されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-117">The `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for the IS_NULLABLE column.</span></span>|<span data-ttu-id="9ed0e-118">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 10.0 () 以降で [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] は、 `sp_columns` ストアドプロシージャは IS_NULLABLE 列に対して " **no** " ではなく **"no"** を返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-118">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]), `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for an IS_NULLABLE column.</span></span>|  
|<span data-ttu-id="9ed0e-119">SQLSetDescRec、SQLBindParameter、SQLBindCol が整合性チェックを実行するようになりました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-119">SQLSetDescRec, SQLBindParameter, and SQLBindCol now perform consistency checking.</span></span>|<span data-ttu-id="9ed0e-120">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 10.0 より前では、SQL_DESC_DATA_PTR を設定しても、SQLSetDescRec、SQLBindParameter、または SQLBindCol の記述子の種類に対して整合性チェックを行うことができませんでした。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-120">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, setting SQL_DESC_DATA_PTR did not cause a consistency check for any descriptor type in SQLSetDescRec, SQLBindParameter, or SQLBindCol.</span></span>|  
|<span data-ttu-id="9ed0e-121">SQLCopyDesc で、記述子の一貫性チェックが行われるようになりました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-121">SQLCopyDesc now does descriptor consistency checking.</span></span>|<span data-ttu-id="9ed0e-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 10.0 より前では、SQL_DESC_DATA_PTR フィールドが特定のレコードに設定されている場合、SQLCopyDesc は整合性チェックを実行しませんでした。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-122">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLCopyDesc did not do a consistency check when the SQL_DESC_DATA_PTR field was set on a particular record.</span></span>|  
|<span data-ttu-id="9ed0e-123">SQLGetDescRec では、記述子の整合性チェックは行われなくなりました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-123">SQLGetDescRec no longer does a descriptor consistency check.</span></span>|<span data-ttu-id="9ed0e-124">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 10.0 より前では、SQLGetDescRec は SQL_DESC_DATA_PTR フィールドが設定されたときに記述子の整合性チェックを実行しました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-124">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLGetDescRec performed a descriptor consistency check when the SQL_DESC_DATA_PTR field was set.</span></span> <span data-ttu-id="9ed0e-125">この一貫性チェックは、ODBC 仕様では不要になったため、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) 以降のバージョンでは行われなくなりました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-125">This was not required by the ODBC specification and in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) and later versions, this consistency check is no longer performed.</span></span>|  
|<span data-ttu-id="9ed0e-126">日付が範囲外の場合に別のエラーが返される</span><span class="sxs-lookup"><span data-stu-id="9ed0e-126">Different error returned when date is out of range.</span></span>|<span data-ttu-id="9ed0e-127">`datetime` 型で、範囲外の日付に対して [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 以降) によって返されるエラー番号が、前のバージョンで返されていたエラー番号と異なります。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-127">For the `datetime` type, a different error number will be returned by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) for an out-of-range date than was returned in earlier versions.</span></span><br /><br /> <span data-ttu-id="9ed0e-128">具体的には、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 では、文字列から `datetime` への変換で年の値が範囲外の場合は 22007 が返されました。[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) 以降のバージョンでは、日付が `datetime2` でサポートされる範囲内でも、`datetime` または `smalldatetime` でサポートされる範囲外の場合、22008 が返されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-128">Specifically, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 returned 22007 for all out of range year values in string conversions to `datetime`, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client beginning with version 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) returns 22008 when the date is within the range supported by `datetime2` but outside the range supported by `datetime` or `smalldatetime`.</span></span>|  
|<span data-ttu-id="9ed0e-129">丸め処理によって日が変わる場合に `datetime` 値では秒の小数部が丸められずに切り捨てられる</span><span class="sxs-lookup"><span data-stu-id="9ed0e-129">`datetime` value truncates fractional seconds and not round if rounding will change the day.</span></span>|<span data-ttu-id="9ed0e-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 より前のバージョンでは、サーバーに送信される `datetime` 値は、クライアントによって 1/300 秒単位に丸められていました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-130">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the client behavior for `datetime` values sent to the server is to round them to nearest 1/300th of a second.</span></span> <span data-ttu-id="9ed0e-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 以降では、丸め処理によって日が変わる場合、秒の小数部が切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-131">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, this scenario causes a truncation of fractional seconds if rounding changes the day.</span></span>|  
|<span data-ttu-id="9ed0e-132">有効な切り捨ての値の秒数 `datetime` 。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-132">Possible trunction of seconds for `datetime` value.</span></span>|<span data-ttu-id="9ed0e-133">[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client 以降でビルドしたアプリケーションが [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 サーバーに接続する場合、型識別子を DBTYPE_DBTIMESTAMP (OLE DB) または SQL_TIMESTAMP (ODBC) に設定し、小数点以下桁数を 0 に設定して datetime 列にバインドすると、サーバーに送信されるデータの時刻部分の秒および秒の小数部が切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-133">An application built with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (or later) that connects to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 server will truncate seconds and fractional seconds for time portion of data sent to the server if you bind to a datetime column with a type identifier of DBTYPE_DBTIMESTAMP (OLE DB) or SQL_TIMESTAMP (ODBC) and a scale of 0.</span></span><br /><br /> <span data-ttu-id="9ed0e-134">例:</span><span class="sxs-lookup"><span data-stu-id="9ed0e-134">For example:</span></span><br /><br /> <span data-ttu-id="9ed0e-135">入力データ: 1994-08-21 21:21:36.000</span><span class="sxs-lookup"><span data-stu-id="9ed0e-135">Input data: 1994-08-21 21:21:36.000</span></span><br /><br /> <span data-ttu-id="9ed0e-136">挿入されるデータ: 1994-08-21 21:21:00.000</span><span class="sxs-lookup"><span data-stu-id="9ed0e-136">Inserted data: 1994-08-21 21:21:00.000</span></span>|  
|<span data-ttu-id="9ed0e-137">DBTYPE_DBTIME から DBTYPE_DATE への OLE DB データ変換で日が変更されなくなる</span><span class="sxs-lookup"><span data-stu-id="9ed0e-137">OLE DB data conversion from DBTYPE_DBTIME to DBTYPE_DATE no longer can cause the day to change.</span></span>|<span data-ttu-id="9ed0e-138">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 より前のバージョンでは、DBTYPE_DATE の時刻部分が午前 0 時から 0.5 秒以内の場合、OLE DB の変換コードによって日が変更されました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-138">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, if the time part of a DBTYPE_DATE was within a half second of midnight, OLE DB conversion code caused the day to change.</span></span> <span data-ttu-id="9ed0e-139">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 以降では、日は変更されません (秒の小数部は丸められずに切り捨てられます)。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-139">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the day will not change (fractional seconds are truncated and not rounded).</span></span>|  
|<span data-ttu-id="9ed0e-140">IBCPSession::BCColFmt の変換の変更。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-140">IBCPSession::BCColFmt conversion changes.</span></span>|<span data-ttu-id="9ed0e-141">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 10.0 以降では、IBCPSession:: BCOColFmt を使用して sqldatetime または SQLDATETIME を文字列型に変換すると、小数値がエクスポートされます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-141">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, when you use IBCPSession::BCOColFmt to convert SQLDATETIME or SQLDATETIME to a string type, a fractional value is exported.</span></span> <span data-ttu-id="9ed0e-142">たとえば、SQLDATETIME 型を SQLNVARCHARMAX 型に変換すると、以前のバージョンの [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では、</span><span class="sxs-lookup"><span data-stu-id="9ed0e-142">For example, when converting type SQLDATETIME to type SQLNVARCHARMAX, earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client returned</span></span><br /><br /> <span data-ttu-id="9ed0e-143">1989-02-01 00:00:00 が返されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-143">1989-02-01 00:00:00.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9ed0e-144">Native Client 10.0 以降のバージョンでは、1989-02-01 00:00:00.0000000 が返されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-144">Native Client 10.0 and later versions return 1989-02-01 00:00:00.0000000.</span></span>|  
|<span data-ttu-id="9ed0e-145">送信するデータのサイズを SQL_LEN_DATA_AT_EXEC で指定した長さと一致させる必要がある</span><span class="sxs-lookup"><span data-stu-id="9ed0e-145">Size of data sent must match length specified in SQL_LEN_DATA_AT_EXEC.</span></span>|<span data-ttu-id="9ed0e-146">SQL_LEN_DATA_AT_EXEC を使用する場合、データのサイズを SQL_LEN_DATA_AT_EXEC で指定した長さと一致させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-146">When using SQL_LEN_DATA_AT_EXEC, the size of the data must match the length that you specified with SQL_LEN_DATA_AT_EXEC.</span></span> <span data-ttu-id="9ed0e-147">SQL_DATA_AT_EXEC を使用することはできますが、SQL_LEN_DATA_AT_EXEC を使用するとパフォーマンスが向上する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-147">You can use SQL_DATA_AT_EXEC but there are potential performance benefits to using SQL_LEN_DATA_AT_EXEC.</span></span>|  
|<span data-ttu-id="9ed0e-148">BCP API を使用するカスタム アプリケーションで警告が表示される</span><span class="sxs-lookup"><span data-stu-id="9ed0e-148">Custom applications that use the BCP API can now see a warning.</span></span>|<span data-ttu-id="9ed0e-149">指定されたフィールド長をデータ長が上回る場合、どの型の場合でも BCP API によって警告メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-149">The BCP API will generate a warning message if data length is greater than the specified length for a field for all types.</span></span> <span data-ttu-id="9ed0e-150">以前のバージョンでは、この警告は、すべての型ではなく文字型についてのみ表示されました。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-150">Previously, this warning was only given for character types, but will not be issued for all types.</span></span>|  
|<span data-ttu-id="9ed0e-151">日付型または時刻型としてバインドされた `sql_variant` に空の文字列を挿入するとエラーが生成される</span><span class="sxs-lookup"><span data-stu-id="9ed0e-151">Inserting an empty string into a `sql_variant` bound as a date/time type generates an error.</span></span>|<span data-ttu-id="9ed0e-152">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 では、日付型または時刻型としてバインドされた `sql_variant` に空の文字列を挿入してもエラーは生成されませんでした。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-152">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, inserting an empty string into a `sql_variant` bound as a date/time type did not generate an error.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9ed0e-153">Native Client 10.0 以降では、この場合に正しくエラーが生成されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-153">Native Client 10.0 (and later) correctly generates an error in this situation.</span></span>|  
|<span data-ttu-id="9ed0e-154">SQL_C_TYPE_TIMESTAMP と DBTYPE_DBTIMESTAMP のパラメーターの検証がより厳密に行われる</span><span class="sxs-lookup"><span data-stu-id="9ed0e-154">Stricter SQL_C_TYPE _TIMESTAMP and DBTYPE_DBTIMESTAMP parameter validation.</span></span>|<span data-ttu-id="9ed0e-155">Native Client より前で [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] は、 `datetime` 列と列の小数点以下桁数に合わせて値が丸められ `datetime` `smalldatetime` ていました [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-155">Prior to [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client, `datetime` values were rounded to fit the scale of `datetime` and `smalldatetime` columns by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] <span data-ttu-id="9ed0e-156">Native Client 以降では、秒の小数部に対して、ODBC のコア仕様で定義されている、より厳密な検証規則が適用されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-156">Native Client (and later) applies the stricter validation rules that are defined in the ODBC core specification for fractional seconds.</span></span> <span data-ttu-id="9ed0e-157">クライアントのバインドで明示的または暗黙的に指定された桁数を使用することによって、末尾の桁を切り捨てることなくパラメーター値を SQL 型に変換できない場合は、エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-157">If a parameter value cannot be converted to the SQL type by using the scale specified or implied by the client binding without truncation of trailing digits, an error is returned.</span></span>|  
|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="9ed0e-158">は、トリガーの実行時に異なる結果を返す場合がある</span><span class="sxs-lookup"><span data-stu-id="9ed0e-158">might return different results when a trigger runs.</span></span>|<span data-ttu-id="9ed0e-159">[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] で導入された変更により、`NOCOUNT OFF` が有効なときに、トリガーを実行させたステートメントからアプリケーションに返される結果が異なる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-159">Changes introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] might cause an application to have different results returned from a statement that caused a trigger to run when `NOCOUNT OFF` was in effect.</span></span> <span data-ttu-id="9ed0e-160">このような場合、アプリケーションでエラーが発生することがあります。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-160">In this situation, your application might generate an error.</span></span> <span data-ttu-id="9ed0e-161">このエラーを解決するに `NOCOUNT ON` は、トリガーにを設定するか、SQLMoreResults を呼び出して次の結果に進みます。</span><span class="sxs-lookup"><span data-stu-id="9ed0e-161">To resolve this error, set `NOCOUNT ON` in the trigger or call SQLMoreResults to advance to the next result.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="9ed0e-162">参照</span><span class="sxs-lookup"><span data-stu-id="9ed0e-162">See Also</span></span>  
 [<span data-ttu-id="9ed0e-163">SQL Server Native Client プログラミング</span><span class="sxs-lookup"><span data-stu-id="9ed0e-163">SQL Server Native Client Programming</span></span>](../sql-server-native-client-programming.md)  
  
  
