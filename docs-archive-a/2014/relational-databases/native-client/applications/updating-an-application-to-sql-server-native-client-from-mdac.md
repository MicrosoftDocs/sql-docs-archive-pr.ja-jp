---
title: MDAC から SQL Server Native Client するようにアプリケーションを更新する |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- SQLNCLI, vs. MDAC
- SQL Server Native Client, vs. MDAC
- data access [SQL Server Native Client], vs. MDAC
- SQL Server Native Client, updating applications
ms.assetid: 2860efdd-c59a-4deb-8a0e-5124a8f4e6dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 804f4340f3ca9a381f28507e0516d5f2e7d913a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738233"
---
# <a name="updating-an-application-to-sql-server-native-client-from-mdac"></a><span data-ttu-id="b6359-102">MDAC から SQL Server Native Client へのアプリケーションの更新</span><span class="sxs-lookup"><span data-stu-id="b6359-102">Updating an Application to SQL Server Native Client from MDAC</span></span>
  <span data-ttu-id="b6359-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client と MDAC (Microsoft Data Access Components) には多くの違いがあります (Windows Vista 以降、このデータ アクセス コンポーネントは Windows DAC (Windows Data Access Components) と呼ばれています)。</span><span class="sxs-lookup"><span data-stu-id="b6359-103">There are a number of differences between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and Microsoft Data Access Components (MDAC; starting with Windows Vista, the data access components are now called Windows Data Access Components, or Windows DAC).</span></span> <span data-ttu-id="b6359-104">どちらを使用しても [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] データベースへのネイティブ データ アクセスは可能ですが、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client は、旧バージョンとの互換性を維持しながら、[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] の新機能を公開することを主眼において作成されています。</span><span class="sxs-lookup"><span data-stu-id="b6359-104">Although both provide native data access to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has been specifically designed to expose the new features of [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], while at the same time maintaining backward compatibility with earlier versions.</span></span>  
  
 <span data-ttu-id="b6359-105">このトピックの情報は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に付属するバージョンの [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Native Client に対応するように MDAC (Windows DAC) アプリケーションを更新する場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="b6359-105">The information in this topic helps update your MDAC (or Windows DAC) application to be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that was included in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="b6359-106">に付属している native Client のバージョンでこのアプリケーションを最新の状態にする方法に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] ついては、「 [SQL Server 2005 Native client からアプリケーションを更新](updating-an-application-from-sql-server-2005-native-client.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6359-106">To help you make this application be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that shipped in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], see [Updating an Application from SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span></span>  
  
 <span data-ttu-id="b6359-107">また、MDAC には OLE DB、ODBC、および ADO (ActiveX Data Objects) を使用するためのコンポーネントが含まれていますが、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client には、OLE DB と ODBC しか実装されていません (ただし、ADO から [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の機能にアクセスすることはできます)。</span><span class="sxs-lookup"><span data-stu-id="b6359-107">In addition, although MDAC contains components for using OLE DB, ODBC, and ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client only implements OLE DB and ODBC (although ADO can access the functionality of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-108">Native Client と MDAC のその他の違いを次に示します。</span><span class="sxs-lookup"><span data-stu-id="b6359-108">Native Client and MDAC differ in the other following areas:</span></span>  
  
-   <span data-ttu-id="b6359-109">ADO を使用して [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client プロバイダーにアクセスした場合に使用できるフィルター機能は、同じユーザーが SQL OLE DB プロバイダーにアクセスした場合よりも少ないことがあります。</span><span class="sxs-lookup"><span data-stu-id="b6359-109">Users who use ADO to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client provider may find less filtering functionality than when they accessed a SQL OLE DB provider.</span></span>  
  
-   <span data-ttu-id="b6359-110">ADO アプリケーションで [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client を使用している場合に計算列の更新を試みると、エラーが報告されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-110">If an ADO application uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and attempts to update a computed column, an error will be reported.</span></span> <span data-ttu-id="b6359-111">MDAC では、更新が受け付けられたうえで、無視されていました。</span><span class="sxs-lookup"><span data-stu-id="b6359-111">With MDAC the update was accepted but ignored.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-112">Native Client は、1 つの自己完結型 DLL (ダイナミック リンク ライブラリ) ファイルです。</span><span class="sxs-lookup"><span data-stu-id="b6359-112">Native Client is a single self-contained dynamic link library (DLL) file.</span></span> <span data-ttu-id="b6359-113">配布を容易にすることと、セキュリティの危険にさらされるのを防ぐことの両面から、最小限のインターフェイスしか公開されません。</span><span class="sxs-lookup"><span data-stu-id="b6359-113">The publicly exposed interfaces have been kept to a minimum, both to ease distribution, as well as to limit security exposure.</span></span>  
  
-   <span data-ttu-id="b6359-114">OLE DB インターフェイスと ODBC インターフェイスのみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="b6359-114">Only OLE DB and ODBC interfaces are supported.</span></span>  
  
-   <span data-ttu-id="b6359-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の OLE DB プロバイダー名と ODBC ドライバー名は、MDAC で使用されるものと異なります。</span><span class="sxs-lookup"><span data-stu-id="b6359-115">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and ODBC driver names are different from those used with MDAC.</span></span>  
  
-   <span data-ttu-id="b6359-116">MDAC コンポーネントによって提供される、ユーザーがアクセスできる機能は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の使用時に使用できます。</span><span class="sxs-lookup"><span data-stu-id="b6359-116">User-accessible functionality supplied by MDAC components is available when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="b6359-117">この機能には、接続プーリング、ADO サポート、クライアント カーソルのサポートなどがあります。</span><span class="sxs-lookup"><span data-stu-id="b6359-117">This includes, but is not limited to, the following: connection pooling, ADO support, and client cursor support.</span></span> <span data-ttu-id="b6359-118">このような機能を使用するとき、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ではデータベース接続のみが提供されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-118">When any of these features are used, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supplies only database connectivity.</span></span> <span data-ttu-id="b6359-119">MDAC は、トレース、管理制御、およびパフォーマンス カウンターなどの機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="b6359-119">MDAC provides functionality such as tracing, management controls, and performance counters.</span></span>  
  
-   <span data-ttu-id="b6359-120">アプリケーションでは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client と共に OLE DB Core Services を使用できます。ただし、OLE DB カーソル エンジンを使用している場合、このカーソル エンジンでは新しい [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] のデータ型が認識されないので、アプリケーションでデータ型互換性オプションを使用して、問題が発生しないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-120">Applications can use OLE DB core services with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but if using the OLE DB cursor engine, they should use the data type compatibility option to avoid any potential problems that might arise because the cursor engine has no knowledge of the new [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] data types.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-121">Native Client は、以前の [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] データベースへのアクセスをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="b6359-121">Native Client supports access to previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-122">Native Client には、XML の統合は含まれていません。</span><span class="sxs-lookup"><span data-stu-id="b6359-122">Native Client does not contain XML integration.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="b6359-123">Native Client は SELECT...FOR XML クエリでは、他の XML 機能はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="b6359-123">Native Client supports SELECT ... FOR XML queries, but does not support any other XML functionality.</span></span> <span data-ttu-id="b6359-124">ただし、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では、[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] で導入された `xml` データ型はサポートされます。</span><span class="sxs-lookup"><span data-stu-id="b6359-124">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does support the `xml` data type introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-125">Native Client では、接続文字列の属性のみを使用する、クライアント側のネットワーク ライブラリの構成がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="b6359-125">Native Client supports configuring client-side network libraries using only connection string attributes.</span></span> <span data-ttu-id="b6359-126">ネットワーク ライブラリをさらに詳細に構成する場合は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 構成マネージャーを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-126">If you need more complete network library configuration, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-127">Native Client には、odbcbcp.dll との互換性がありません。</span><span class="sxs-lookup"><span data-stu-id="b6359-127">Native Client is not compatible with odbcbcp.dll.</span></span> <span data-ttu-id="b6359-128">ODBC api と**bcp** api の両方を使用するアプリケーションは、Native Client を使用するために sqlncli11 とリンクするように再構築する必要があり [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="b6359-128">Applications that use both ODBC and **bcp** APIs must be rebuilt to link with sqlncli11.lib in order to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-129">Native Client は、MSDASQL (Microsoft OLE DB Provider for ODBC) からはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="b6359-129">Native Client is not supported from the Microsoft OLE DB provider for ODBC (MSDASQL).</span></span> <span data-ttu-id="b6359-130">MDAC SQLODBC ドライバーを MSDASQL と共に使用しているか、MDAC SQLODBC ドライバーを ADO と共に使用している場合は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の OLE DB を使用してください。</span><span class="sxs-lookup"><span data-stu-id="b6359-130">If you are using the MDAC SQLODBC driver with MSDASQL or MDAC SQLODBC driver with ADO, use OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client..</span></span>  
  
-   <span data-ttu-id="b6359-131">MDAC 接続文字列では、Trusted_Connection キーワードにブール値 () を使用でき `true` ます。 **Trusted_Connection**</span><span class="sxs-lookup"><span data-stu-id="b6359-131">MDAC connection strings allow a Boolean value (`true`) for the **Trusted_Connection** keyword.</span></span> <span data-ttu-id="b6359-132">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client 接続文字列では、 `yes` または**no**を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-132">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client connection string must use `yes` or **no**.</span></span>  
  
-   <span data-ttu-id="b6359-133">警告とエラーが一部変更されています。</span><span class="sxs-lookup"><span data-stu-id="b6359-133">Minor changes have occurred to warnings and errors.</span></span> <span data-ttu-id="b6359-134">サーバーから返される警告とエラーの重大度は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client に渡されるときも保持されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="b6359-134">Warnings and errors returned by the server now retain the same severity when passed to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="b6359-135">特定の警告やエラーのトラッピングに依存しているアプリケーションは、十分にテストする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-135">You should ensure you have thoroughly tested your application if you depend on trapping particular warnings and errors.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-136">Native Client では、MDAC よりも厳密なエラー チェックが行われます。そのため、アプリケーションが ODBC と OLE DB の仕様に厳密に準拠していないときには動作が異なることがあります。</span><span class="sxs-lookup"><span data-stu-id="b6359-136">Native Client has stricter error checking than MDAC, which means that some applications that do not conform strictly to the ODBC and OLE DB specifications may behave differently.</span></span> <span data-ttu-id="b6359-137">たとえば、SQLOLEDB プロバイダーは、結果パラメーターとしてパラメーター名を ' ' で始める必要があり \@ ますが、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーはこの規則を適用しませんでした。</span><span class="sxs-lookup"><span data-stu-id="b6359-137">For example, the SQLOLEDB provider did not enforce the rule that parameter names must start with '\@' for result parameters, but the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-138">Native Client では、接続が失敗したときの動作が MDAC と異なります。</span><span class="sxs-lookup"><span data-stu-id="b6359-138">Native Client behaves differently from MDAC in regards to failed connections.</span></span> <span data-ttu-id="b6359-139">たとえば、MDAC では接続が失敗した場合はキャッシュされたプロパティ値を返しますが、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では呼び出し元のアプリケーションにエラーを報告します。</span><span class="sxs-lookup"><span data-stu-id="b6359-139">For example, MDAC returns cached property values for a connection that has failed, whereas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client reports an error to the calling application.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-140">Native Client では、Visual Studio Analyzer イベントは生成されませんが、代わりに Windows トレース イベントが生成されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-140">Native Client does not generate Visual Studio Analyzer events, but instead generates Windows tracing events.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-141">Native Client をパフォーマンス モニターと併用することはできません。</span><span class="sxs-lookup"><span data-stu-id="b6359-141">Native Client cannot be used with perfmon.</span></span> <span data-ttu-id="b6359-142">パフォーマンス モニターは、Windows に付属している MDAC SQLODBC ドライバーを使用する DSN のみと併用できる Windows ツールです。</span><span class="sxs-lookup"><span data-stu-id="b6359-142">Perfmon is a Windows tool that can only be used with DSNs that use the MDAC SQLODBC driver included with Windows.</span></span>  
  
-   <span data-ttu-id="b6359-143">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client を [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンに接続すると、サーバー エラー 16947 が SQL_ERROR として返されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-143">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is connected to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions, server error 16947 is returned as a SQL_ERROR.</span></span> <span data-ttu-id="b6359-144">このエラーは、位置指定更新または位置指定削除による行の更新や削除が失敗したときに発生します。</span><span class="sxs-lookup"><span data-stu-id="b6359-144">This error occurs when a positioned update or delete fails to update or delete a row.</span></span> <span data-ttu-id="b6359-145">任意のバージョンの [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に接続している MDAC では、サーバー エラー 16947 は警告 (SQL_SUCCESS_WITH_INFO) として返されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-145">With MDAC when connecting to any version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], server error 16947 is returned as a warning (SQL_SUCCESS_WITH_INFO).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="b6359-146">Native Client では、 **IDBDataSourceAdmin**インターフェイスが実装されています。これは、以前に実装されていないオプションの OLE DB インターフェイスですが、この省略可能なインターフェイスの**createdatasource**メソッドのみが実装されています。</span><span class="sxs-lookup"><span data-stu-id="b6359-146">Native Client implements the **IDBDataSourceAdmin** interface, which is an optional OLE DB interface that was not previously implemented, but only the **CreateDataSource** method of this optional interface is implemented.</span></span> [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
-   <span data-ttu-id="b6359-147">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB プロバイダーでは、TABLE_TYPE を SYNONYM に設定すると、TABLES スキーマ行セットと TABLE_INFO スキーマ行セットのシノニムを返します。</span><span class="sxs-lookup"><span data-stu-id="b6359-147">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns synonyms in the TABLES and TABLE_INFO schema rowsets, with TABLE_TYPE set to SYNONYM.</span></span>  
  
-   <span data-ttu-id="b6359-148">データ型、、、、、 `varchar(max)` `nvarchar(max)` `varbinary(max)` `xml` `udt` またはその他のラージオブジェクト型の戻り値をよりも前のバージョンのクライアントに返すことはできません [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="b6359-148">Return values of data type `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, `xml`, `udt`, or other large object types can not be returned to client versions earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="b6359-149">これらの型を戻り値として使用する場合は、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-149">If you wish to use these types as return values, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="b6359-150">手動および暗黙のトランザクション開始時において、以下のステートメントの実行が MDAC では許可されていましたが、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client では許可されません。</span><span class="sxs-lookup"><span data-stu-id="b6359-150">MDAC allows the following statements to be executed at the start of manual and implicit transactions, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not.</span></span> <span data-ttu-id="b6359-151">これらは、自動コミット モードで実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-151">They must be executed in autocommit mode.</span></span>  
  
    -   <span data-ttu-id="b6359-152">すべてのフルテキスト操作 (インデックスおよびカタログ DDL)</span><span class="sxs-lookup"><span data-stu-id="b6359-152">All full-text operations (index and catalog DDL)</span></span>  
  
    -   <span data-ttu-id="b6359-153">すべてのデータベース操作 (データベースの作成、変更、および削除)</span><span class="sxs-lookup"><span data-stu-id="b6359-153">All database operations (create database, alter database, drop database)</span></span>  
  
    -   <span data-ttu-id="b6359-154">再構成</span><span class="sxs-lookup"><span data-stu-id="b6359-154">Reconfigure</span></span>  
  
    -   <span data-ttu-id="b6359-155">Shutdown</span><span class="sxs-lookup"><span data-stu-id="b6359-155">Shutdown</span></span>  
  
    -   <span data-ttu-id="b6359-156">強制終了</span><span class="sxs-lookup"><span data-stu-id="b6359-156">Kill</span></span>  
  
    -   <span data-ttu-id="b6359-157">バックアップ</span><span class="sxs-lookup"><span data-stu-id="b6359-157">Backup</span></span>  
  
-   <span data-ttu-id="b6359-158">MDAC アプリケーションから [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に接続すると、[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] で導入されたデータ型は、次の表に示すような、[!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] と互換性を持つデータ型として扱われます。</span><span class="sxs-lookup"><span data-stu-id="b6359-158">When MDAC applications connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the data types introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] will appear as [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]-compatible data types as shown in the following table.</span></span>  
  
    |<span data-ttu-id="b6359-159">SQL Server 2005 の型</span><span class="sxs-lookup"><span data-stu-id="b6359-159">SQL Server 2005 type</span></span>|<span data-ttu-id="b6359-160">SQL Server 2000 の型</span><span class="sxs-lookup"><span data-stu-id="b6359-160">SQL Server 2000 type</span></span>|  
    |--------------------------|--------------------------|  
    |`varchar(max)`|`text`|  
    |`nvarchar(max)`|`ntext`|  
    |`varbinary(max)`|`image`|  
    |`udt`|`varbinary`|  
    |`xml`|`ntext`|  
  
     <span data-ttu-id="b6359-161">この型マッピングは、列のメタデータに返される値に影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="b6359-161">This type mapping affects the values returned for column metadata.</span></span> <span data-ttu-id="b6359-162">たとえば、列の `text` 最大サイズは2147483647ですが、Native CLIENT ODBC では、列の最大サイズが SQL_SS_LENGTH_UNLIMITED として報告され [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] `varchar(max)` ます。また、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client OLE DB で `varchar(max)` は、プラットフォームに応じて、列の最大サイズが2147483647または-1 として報告されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-162">For example, a `text` column has a maximum size of 2,147,483,647, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC reports the maximum size of `varchar(max)` columns as SQL_SS_LENGTH_UNLIMITED, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB reports the maximum size of `varchar(max)` columns as 2,147,483,647 or -1, depending on platform.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b6359-163">Native Client では、旧バージョンとの互換性を維持するために接続文字列のあいまい性が許可されます。たとえば、キーワードを複数回指定したり、位置と優先順位に基づいた解決方法を使用して、競合するキーワードを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="b6359-163">Native Client allows ambiguity in connection strings (for example, some keywords may be specified more than once, and conflicting keywords may be allowed with resolution based on position or precedence) for reasons of backward compatibility.</span></span> <span data-ttu-id="b6359-164">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client の今後のリリースでは、あいまいな接続文字列を使用できなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-164">Future releases of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client might not allow ambiguity in connection strings.</span></span> <span data-ttu-id="b6359-165">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client を使用するアプリケーションでは、あいまいな接続文字列を利用しないように変更することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b6359-165">It is good practice when modifying applications to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to eliminate any dependency on connection string ambiguity.</span></span>  
  
-   <span data-ttu-id="b6359-166">ODBC または OLE DB 呼び出しを使用してトランザクションを開始した場合、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client と MDAC とでは動作が異なります。[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ではトランザクションがすぐに開始されますが、MDAC では最初のデータベース アクセスの後にトランザクションが開始されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-166">If you use an ODBC or OLE DB call to start transactions, there is a difference in behavior between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC; transactions will begin immediately with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but transactions will begin after the first database access using MDAC.</span></span> <span data-ttu-id="b6359-167">これは、バッチまたはストアドプロシージャが開始さ [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] \@ \@ れたときと同じように、バッチまたはストアドプロシージャの実行が完了した後に、TRANCOUNT を同じにする必要があるので、ストアドプロシージャとバッチの動作に影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-167">This can affect the behavior of stored procedures and batches because [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires \@\@TRANCOUNT to be the same after a batch or stored procedure finishes execution as it was when the batch or stored procedure started.</span></span>  
  
-   <span data-ttu-id="b6359-168">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client では、ITransactionLocal:: BeginTransaction によってトランザクションがすぐに開始されます。</span><span class="sxs-lookup"><span data-stu-id="b6359-168">With [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal::BeginTransaction will cause a transaction to be started immediately.</span></span> <span data-ttu-id="b6359-169">MDAC では、暗黙のトランザクション モードを必要とするステートメントをアプリケーションが実行するまで、トランザクションの開始が遅延されました。</span><span class="sxs-lookup"><span data-stu-id="b6359-169">With MDAC the transaction start was delayed until the application executed a statement which required a transaction in implicit transaction mode.</span></span> <span data-ttu-id="b6359-170">詳細については、「 [SET IMPLICIT_TRANSACTIONS &#40;transact-sql&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6359-170">For more information, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span>  
  
-   <span data-ttu-id="b6359-171">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client driver を system.string と共に使用して [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 、新しい、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 固有のデータ型または機能を公開するサーバーコンピューターにアクセスすると、エラーが発生する場合があります。</span><span class="sxs-lookup"><span data-stu-id="b6359-171">You might encounter errors when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver with System.Data.Odbc to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] server computer that exposes new, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific data types or features.</span></span> <span data-ttu-id="b6359-172">System.string では、汎用の ODBC 実装が提供されます。その後、ベンダー固有の機能や拡張機能は公開されません。</span><span class="sxs-lookup"><span data-stu-id="b6359-172">System.Data.Odbc provides a generic ODBC implementation and subsequently does not expose vendor specific functionality or extensions.</span></span> <span data-ttu-id="b6359-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)](Native Client ドライバーは、最新の機能をネイティブにサポートするように更新されてい [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ます。)この問題を回避するには、MDAC に戻すか、または system.string に移行します。</span><span class="sxs-lookup"><span data-stu-id="b6359-173">(The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver is updated to natively support the latest [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features.) To workaround this issue, you can either revert to MDAC, or migrate to System.Data.SqlClient.</span></span>  
  
 <span data-ttu-id="b6359-174">行のバージョン管理機能を使用した Read Committed トランザクション分離は [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client と MDAC の両方でサポートされていますが、スナップショット トランザクション分離は [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client のみでサポートされています </span><span class="sxs-lookup"><span data-stu-id="b6359-174">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC support read committed transaction isolation using row versioning, but only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports snapshot transaction isolation.</span></span> <span data-ttu-id="b6359-175">(プログラミング用語では、「行のバージョン管理機能を使用した Read Committed トランザクション分離」は「Read Committed トランザクション」と同義語です)。</span><span class="sxs-lookup"><span data-stu-id="b6359-175">(In programming terms, read committed transaction isolation using row versioning is the same as read-committed transaction.).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b6359-176">参照</span><span class="sxs-lookup"><span data-stu-id="b6359-176">See Also</span></span>  
 [<span data-ttu-id="b6359-177">SQL Server Native Client を使用したアプリケーションのビルド</span><span class="sxs-lookup"><span data-stu-id="b6359-177">Building Applications with SQL Server Native Client</span></span>](building-applications-with-sql-server-native-client.md)  
  
  
