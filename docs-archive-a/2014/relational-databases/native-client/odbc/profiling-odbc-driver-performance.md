---
title: ODBC ドライバーのパフォーマンスのプロファイル |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- profiling ODBC driver performance data [SQL Server Native Client]
- performance [ODBC]
- application statistics [ODBC]
- time statistics [ODBC]
- ODBC, performance data
- SQL Server Native Client ODBC driver, profiling performance data
- SQLPERF data structure
- statistical information [ODBC]
ms.assetid: 8f44e194-d556-4119-a759-4c9dec7ecead
author: rothja
ms.author: jroth
ms.openlocfilehash: 91373d22b845dd0abb1263b7fa367b4bf3bff42e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633811"
---
# <a name="profiling-odbc-driver-performance"></a><span data-ttu-id="a780b-102">ODBC ドライバーのパフォーマンスのプロファイル</span><span class="sxs-lookup"><span data-stu-id="a780b-102">Profiling ODBC Driver Performance</span></span>
  <span data-ttu-id="a780b-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC ドライバーは、次の 2 種類のパフォーマンス データをプロファイルできます。</span><span class="sxs-lookup"><span data-stu-id="a780b-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can profile two types of performance data:</span></span>  
  
-   <span data-ttu-id="a780b-104">実行時間の長いクエリ。</span><span class="sxs-lookup"><span data-stu-id="a780b-104">Long-running queries.</span></span>  
  
     <span data-ttu-id="a780b-105">ドライバーは、指定した時間内にサーバーから応答が得られないクエリをログ ファイルに書き込むことができます。</span><span class="sxs-lookup"><span data-stu-id="a780b-105">The driver can write to a log file any query that does not get a response from the server within a specified amount of time.</span></span> <span data-ttu-id="a780b-106">アプリケーション プログラマやデータベース管理者は、ログに記録された各 SQL ステートメントを確認し、パフォーマンスを改善する方法を判断できます。</span><span class="sxs-lookup"><span data-stu-id="a780b-106">Application programmers or database administrators can then research each logged SQL statement to determine how they can improve its performance.</span></span>  
  
-   <span data-ttu-id="a780b-107">ドライバーのパフォーマンス データ。</span><span class="sxs-lookup"><span data-stu-id="a780b-107">Driver-performance data.</span></span>  
  
     <span data-ttu-id="a780b-108">ドライバーはパフォーマンス統計情報を記録できます。また、この情報をファイルに書き込んだり、SQLPERF というドライバー固有の構造体を使用して、アプリケーションで利用可能にすることができます。</span><span class="sxs-lookup"><span data-stu-id="a780b-108">The driver can record performance statistics and either write them to a file or make them available to an application through a driver-specific data structure named SQLPERF.</span></span> <span data-ttu-id="a780b-109">このパフォーマンス統計情報が書き込まれるファイルはタブで区切られており、Microsoft Excel など、タブ区切りのファイルをサポートするスプレッドシートを使用して容易に分析できます。</span><span class="sxs-lookup"><span data-stu-id="a780b-109">The file containing the performance statistics is a tab-delimited file that can be easily analyzed with any spreadsheet that supports tab-delimited files, such as Microsoft Excel.</span></span>  
  
 <span data-ttu-id="a780b-110">各プロファイルは、次の方法で有効にできます。</span><span class="sxs-lookup"><span data-stu-id="a780b-110">Either type of profiling can be turned on by:</span></span>  
  
-   <span data-ttu-id="a780b-111">ログ記録が指定されているデータ ソースに接続する。</span><span class="sxs-lookup"><span data-stu-id="a780b-111">Connecting to a data source that specifies logging.</span></span>  
  
-   <span data-ttu-id="a780b-112">[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)を呼び出して、プロファイルを制御するドライバー固有の属性を設定します。</span><span class="sxs-lookup"><span data-stu-id="a780b-112">Calling [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set driver-specific attributes that control profiling.</span></span>  
  
 <span data-ttu-id="a780b-113">各アプリケーション プロセスは、個別に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC ドライバーのコピーを取得しますが、プロファイルは、ドライバーのコピーとアプリケーション プロセスの組み合わせに対してグローバルに実行されます。</span><span class="sxs-lookup"><span data-stu-id="a780b-113">Each application process gets its own copy of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and profiling is global to the combination of a driver copy and an application process.</span></span> <span data-ttu-id="a780b-114">アプリケーションによってプロファイルが有効になると、ドライバー内でアクティブになっている、そのアプリケーションからの全接続に関する情報が、プロファイルによって記録されます。</span><span class="sxs-lookup"><span data-stu-id="a780b-114">When anything in the application turns on profiling, profiling records information for all connections active in the driver from that application.</span></span> <span data-ttu-id="a780b-115">特にプロファイルを要求していない接続も、プロファイルの対象に含まれます。</span><span class="sxs-lookup"><span data-stu-id="a780b-115">Even connections that did not specifically call for profiling are included.</span></span>  
  
 <span data-ttu-id="a780b-116">ドライバーがプロファイル ログ (パフォーマンス データまたは実行時間の長いクエリのログ) を開くと、ドライバーで開かれているすべての環境ハンドルがアプリケーションによって解放され、ODBC ドライバー マネージャーがドライバーをアンロードするまで、このプロファイル ログは閉じられません。</span><span class="sxs-lookup"><span data-stu-id="a780b-116">After the driver has opened a profiling log (either the performance data or long-running query log), it does not close the log until the driver is unloaded by the ODBC Driver Manager, when an application frees all the environment handles it opened in the driver.</span></span> <span data-ttu-id="a780b-117">アプリケーションが新しい環境ハンドルを開くと、ドライバーの新しいコピーが読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="a780b-117">If the application opens a new environment handle, a new copy of the driver is loaded.</span></span> <span data-ttu-id="a780b-118">その後、アプリケーションが同じログ ファイルを指定しているデータ ソースに接続するか、同じファイルにログ記録するようにドライバー固有の属性を設定している場合、ドライバーは古いログを上書きします。</span><span class="sxs-lookup"><span data-stu-id="a780b-118">If the application then either connects to a data source that specifies the same log file or sets the driver-specific attributes to log to the same file, the driver overwrites the old log.</span></span>  
  
 <span data-ttu-id="a780b-119">あるアプリケーションが任意のログ ファイルに対してプロファイルの記録を開始し、別のアプリケーションが同じログ ファイルに対してプロファイルの記録を開始しようとすると、2 番目のアプリケーションはプロファイル データをログに記録できません。</span><span class="sxs-lookup"><span data-stu-id="a780b-119">If an application starts profiling to a log file and a second application attempts to start profiling to the same log file, the second application is not able to log any profiling data.</span></span> <span data-ttu-id="a780b-120">最初のアプリケーションがドライバーをアンロードした後に、2 番目のアプリケーションがプロファイルを開始した場合、最初のアプリケーションのデータを記録しているログ ファイルは、2 番目のアプリケーションによって上書きされます。</span><span class="sxs-lookup"><span data-stu-id="a780b-120">If the second application starts profiling after the first application has unloaded its driver, the second application overwrites the log file from the first application.</span></span>  
  
 <span data-ttu-id="a780b-121">アプリケーションがプロファイルが有効になっているデータソースに接続する場合、アプリケーションが**SQLSetConnectOption**を呼び出してログ記録を開始すると、ドライバーは SQL_ERROR を返します。</span><span class="sxs-lookup"><span data-stu-id="a780b-121">If an application connects to a data source that has profiling enabled, the driver returns SQL_ERROR if the application calls **SQLSetConnectOption** to start logging.</span></span> <span data-ttu-id="a780b-122">**SQLGetDiagRec**を呼び出すと、次の値が返されます。</span><span class="sxs-lookup"><span data-stu-id="a780b-122">A call to **SQLGetDiagRec** then returns the following:</span></span>  
  
```  
SQLState: 01000, pfNative = 0  
ErrorMsg: [Microsoft][SQL Server Native Client]  
   An error has occurred during the attempt to access  
   the log file, logging disabled.  
```  
  
 <span data-ttu-id="a780b-123">ドライバーは、環境ハンドルが閉じられると、パフォーマンス データの収集を停止します。</span><span class="sxs-lookup"><span data-stu-id="a780b-123">The driver stops gathering performance data when an environment handle is closed.</span></span> <span data-ttu-id="a780b-124">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client アプリケーションが、それぞれ固有の環境ハンドルを持つ複数の接続を保持している場合、関連付けられている環境ハンドルのいずれかが閉じられると、ドライバーはパフォーマンス データの収集を停止します。</span><span class="sxs-lookup"><span data-stu-id="a780b-124">If an [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application has multiple connections, each with its own environment handle, then the driver will stop gathering performance data when any of the associated environment handles are closed.</span></span>  
  
 <span data-ttu-id="a780b-125">ドライバーのパフォーマンス データは、SQLPERF データ構造体に保存するか、タブ区切り形式ファイルに記録できます。</span><span class="sxs-lookup"><span data-stu-id="a780b-125">The driver's performance data can either be stored in the SQLPERF data structure or logged in a tab-delimited file.</span></span> <span data-ttu-id="a780b-126">このデータには、次の種類の統計情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a780b-126">The data includes the following categories of statistics:</span></span>  
  
-   <span data-ttu-id="a780b-127">アプリケーション プロファイル</span><span class="sxs-lookup"><span data-stu-id="a780b-127">Application profile</span></span>  
  
-   <span data-ttu-id="a780b-128">Connection</span><span class="sxs-lookup"><span data-stu-id="a780b-128">Connection</span></span>  
  
-   <span data-ttu-id="a780b-129">ネットワーク</span><span class="sxs-lookup"><span data-stu-id="a780b-129">Network</span></span>  
  
-   <span data-ttu-id="a780b-130">Time</span><span class="sxs-lookup"><span data-stu-id="a780b-130">Time</span></span>  
  
 <span data-ttu-id="a780b-131">次の表では、SQLPERF データ構造体のフィールドについて説明します。この説明は、パフォーマンス ログ ファイルに記録される統計情報にも適用されます。</span><span class="sxs-lookup"><span data-stu-id="a780b-131">In the following table, the descriptions of the fields in the SQLPERF data structure also apply to the statistics recorded in the performance log file.</span></span>  
  
### <a name="application-profile-statistics"></a><span data-ttu-id="a780b-132">アプリケーション プロファイル統計情報</span><span class="sxs-lookup"><span data-stu-id="a780b-132">Application Profile Statistics</span></span>  
  
|<span data-ttu-id="a780b-133">SQLPERF のフィールド</span><span class="sxs-lookup"><span data-stu-id="a780b-133">SQLPERF field</span></span>|<span data-ttu-id="a780b-134">説明</span><span class="sxs-lookup"><span data-stu-id="a780b-134">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="a780b-135">TimerResolution</span><span class="sxs-lookup"><span data-stu-id="a780b-135">TimerResolution</span></span>|<span data-ttu-id="a780b-136">ミリ秒単位で表されたサーバーのクロック時間の最小単位。</span><span class="sxs-lookup"><span data-stu-id="a780b-136">Minimum resolution of the server's clock time in milliseconds.</span></span> <span data-ttu-id="a780b-137">通常は 0 (ゼロ) が報告されます。大きな値が報告される場合のみ考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a780b-137">This is usually reported as 0 (zero) and should only be considered if the number reported is large.</span></span> <span data-ttu-id="a780b-138">サーバー クロックの最小単位が、タイマベースの一部の統計で予想される間隔よりも大きい場合は、統計値が増加する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a780b-138">If the minimum resolution of the server clock is larger than the likely interval for some of the timer-based statistics, those statistics could be inflated.</span></span>|  
|<span data-ttu-id="a780b-139">SQLidu</span><span class="sxs-lookup"><span data-stu-id="a780b-139">SQLidu</span></span>|<span data-ttu-id="a780b-140">SQL_PERF_START 以降に処理された INSERT、DELETE、または UPDATE ステートメントの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-140">Number of INSERT, DELETE, or UPDATE statements after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-141">SQLiduRows</span><span class="sxs-lookup"><span data-stu-id="a780b-141">SQLiduRows</span></span>|<span data-ttu-id="a780b-142">SQL_PERF_START 以降に処理された INSERT、DELETE、または UPDATE ステートメントの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-142">Number of INSERT, DELETE, or UPDATE statements after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-143">SQLSelects</span><span class="sxs-lookup"><span data-stu-id="a780b-143">SQLSelects</span></span>|<span data-ttu-id="a780b-144">SQL_PERF_START 以降に処理された SELECT ステートメントの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-144">Number of SELECT statements processed after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-145">SQLSelectRows</span><span class="sxs-lookup"><span data-stu-id="a780b-145">SQLSelectRows</span></span>|<span data-ttu-id="a780b-146">SQL_PERF_START 以降に選択された行数。</span><span class="sxs-lookup"><span data-stu-id="a780b-146">Number of rows selected after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-147">トランザクション</span><span class="sxs-lookup"><span data-stu-id="a780b-147">Transactions</span></span>|<span data-ttu-id="a780b-148">SQL_PERF_START 以降のユーザー トランザクションの数。ロールバックの数も含まれます。</span><span class="sxs-lookup"><span data-stu-id="a780b-148">Number of user transactions after SQL_PERF_START, including rollbacks.</span></span> <span data-ttu-id="a780b-149">SQL_AUTOCOMMIT_ON の状態で ODBC アプリケーションが実行されている場合は、各コマンドがトランザクションと見なされます。</span><span class="sxs-lookup"><span data-stu-id="a780b-149">When an ODBC application is running with SQL_AUTOCOMMIT_ON, each command is considered a transaction.</span></span>|  
|<span data-ttu-id="a780b-150">SQLPrepares</span><span class="sxs-lookup"><span data-stu-id="a780b-150">SQLPrepares</span></span>|<span data-ttu-id="a780b-151">SQL_PERF_START 後の[SQLPrepare 関数](https://go.microsoft.com/fwlink/?LinkId=59360)呼び出しの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-151">Number of [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360) calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-152">ExecDirects</span><span class="sxs-lookup"><span data-stu-id="a780b-152">ExecDirects</span></span>|<span data-ttu-id="a780b-153">SQL_PERF_START 後の**SQLExecDirect**呼び出しの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-153">Number of **SQLExecDirect** calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-154">SQLExecutes</span><span class="sxs-lookup"><span data-stu-id="a780b-154">SQLExecutes</span></span>|<span data-ttu-id="a780b-155">SQL_PERF_START 後の**Sqlexecute**呼び出しの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-155">Number of **SQLExecute** calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-156">CursorOpens</span><span class="sxs-lookup"><span data-stu-id="a780b-156">CursorOpens</span></span>|<span data-ttu-id="a780b-157">SQL_PERF_START 以降にドライバーがサーバー カーソルを開いた回数。</span><span class="sxs-lookup"><span data-stu-id="a780b-157">Number of times the driver has opened a server cursor after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-158">CursorSize</span><span class="sxs-lookup"><span data-stu-id="a780b-158">CursorSize</span></span>|<span data-ttu-id="a780b-159">SQL_PERF_START 以降にカーソルによって開かれた結果セット内の行数。</span><span class="sxs-lookup"><span data-stu-id="a780b-159">Number of rows in the result sets opened by cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-160">CursorUsed</span><span class="sxs-lookup"><span data-stu-id="a780b-160">CursorUsed</span></span>|<span data-ttu-id="a780b-161">SQL_PERF_START 以降に実際にドライバーによってカーソルから取得された行数。</span><span class="sxs-lookup"><span data-stu-id="a780b-161">Number of rows actually retrieved through the driver from cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-162">PercentCursorUsed</span><span class="sxs-lookup"><span data-stu-id="a780b-162">PercentCursorUsed</span></span>|<span data-ttu-id="a780b-163">CursorUsed/CursorSize の計算結果になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-163">Equals CursorUsed/CursorSize.</span></span> <span data-ttu-id="a780b-164">たとえば、アプリケーションによりドライバーでサーバー カーソルが開かれて "SELECT COUNT(\*) FROM Authors" が実行され、この SELECT ステートメントの結果セットには 23 行が含まれるとします。</span><span class="sxs-lookup"><span data-stu-id="a780b-164">For example, if an application causes the driver to open a server cursor to do "SELECT COUNT(\*) FROM Authors," 23 rows will be in the result set for the SELECT statement.</span></span> <span data-ttu-id="a780b-165">その後、アプリケーションがこれらの行から 3 行のみをフェッチした場合、CursorUsed/CursorSize は 3/23 なので、PercentCursorUsed は 13.043478 になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-165">If the application then fetches only three of these rows, CursorUsed/CursorSize is 3/23, so PercentCursorUsed is 13.043478.</span></span>|  
|<span data-ttu-id="a780b-166">AvgFetchTime</span><span class="sxs-lookup"><span data-stu-id="a780b-166">AvgFetchTime</span></span>|<span data-ttu-id="a780b-167">SQLFetchTime/SQLFetchCount の計算結果になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-167">Equals SQLFetchTime/SQLFetchCount.</span></span>|  
|<span data-ttu-id="a780b-168">AvgCursorSize</span><span class="sxs-lookup"><span data-stu-id="a780b-168">AvgCursorSize</span></span>|<span data-ttu-id="a780b-169">CursorSize/CursorOpens の計算結果になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-169">Equals CursorSize/CursorOpens.</span></span>|  
|<span data-ttu-id="a780b-170">AvgCursorUsed</span><span class="sxs-lookup"><span data-stu-id="a780b-170">AvgCursorUsed</span></span>|<span data-ttu-id="a780b-171">CursorUsed/CursorOpens の計算結果になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-171">Equals CursorUsed/CursorOpens.</span></span>|  
|<span data-ttu-id="a780b-172">SQLFetchTime</span><span class="sxs-lookup"><span data-stu-id="a780b-172">SQLFetchTime</span></span>|<span data-ttu-id="a780b-173">サーバー カーソルに対してフェッチの完了に要した累積時間。</span><span class="sxs-lookup"><span data-stu-id="a780b-173">Cumulative amount of time it took fetches against server cursors to complete.</span></span>|  
|<span data-ttu-id="a780b-174">SQLFetchCount</span><span class="sxs-lookup"><span data-stu-id="a780b-174">SQLFetchCount</span></span>|<span data-ttu-id="a780b-175">SQL_PERF_START 以降にサーバー カーソルに対して実行されたフェッチの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-175">Number of fetches done against server cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-176">CurrentStmtCount</span><span class="sxs-lookup"><span data-stu-id="a780b-176">CurrentStmtCount</span></span>|<span data-ttu-id="a780b-177">ドライバー内で開かれているすべての接続上で、現在開いているステートメント ハンドルの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-177">Number of statement handles currently open on all connections open in the driver.</span></span>|  
|<span data-ttu-id="a780b-178">MaxOpenStmt</span><span class="sxs-lookup"><span data-stu-id="a780b-178">MaxOpenStmt</span></span>|<span data-ttu-id="a780b-179">SQL_PERF_START 以降に同時に開かれたステートメント ハンドルの最大数。</span><span class="sxs-lookup"><span data-stu-id="a780b-179">Maximum number of concurrently opened statement handles after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-180">SumOpenStmt</span><span class="sxs-lookup"><span data-stu-id="a780b-180">SumOpenStmt</span></span>|<span data-ttu-id="a780b-181">SQL_PERF_START 以降に開かれたステートメント ハンドルの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-181">Number of statement handles that have been opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-182">**接続統計情報 :**</span><span class="sxs-lookup"><span data-stu-id="a780b-182">**Connection Statistics:**</span></span>||  
|<span data-ttu-id="a780b-183">CurrentConnectionCount</span><span class="sxs-lookup"><span data-stu-id="a780b-183">CurrentConnectionCount</span></span>|<span data-ttu-id="a780b-184">アプリケーションがサーバーに対して開いている現在アクティブな接続ハンドルの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-184">Current number of active connection handles the application has open to the server.</span></span>|  
|<span data-ttu-id="a780b-185">MaxConnectionsOpened</span><span class="sxs-lookup"><span data-stu-id="a780b-185">MaxConnectionsOpened</span></span>|<span data-ttu-id="a780b-186">SQL_PERF_START 以降に開かれたコンカレント接続ハンドルの最大数。</span><span class="sxs-lookup"><span data-stu-id="a780b-186">Maximum number of concurrent connection handles opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-187">SumConnectionsOpened</span><span class="sxs-lookup"><span data-stu-id="a780b-187">SumConnectionsOpened</span></span>|<span data-ttu-id="a780b-188">SQL_PERF_START 以降に開かれた接続ハンドルの合計数。</span><span class="sxs-lookup"><span data-stu-id="a780b-188">Sum of the number of connection handles that have been opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="a780b-189">SumConnectionTime</span><span class="sxs-lookup"><span data-stu-id="a780b-189">SumConnectionTime</span></span>|<span data-ttu-id="a780b-190">SQL_PERF_START 以降に開かれたすべての接続の接続時間の合計。</span><span class="sxs-lookup"><span data-stu-id="a780b-190">Sum of the amount of time that all of the connections have been opened after SQL_PERF_START.</span></span> <span data-ttu-id="a780b-191">たとえば、アプリケーションが接続を 10 開いていて、各接続を 5 秒間保持していた場合、SumConnectionTime は 50 秒になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-191">For example, if an application opened 10 connections and maintained each connection for 5 seconds, then SumConnectionTime would be 50 seconds.</span></span>|  
|<span data-ttu-id="a780b-192">AvgTimeOpened</span><span class="sxs-lookup"><span data-stu-id="a780b-192">AvgTimeOpened</span></span>|<span data-ttu-id="a780b-193">SumConnectionsOpened/ SumConnectionTime の計算結果になります。</span><span class="sxs-lookup"><span data-stu-id="a780b-193">Equals SumConnectionsOpened/ SumConnectionTime.</span></span>|  
|<span data-ttu-id="a780b-194">**ネットワーク統計情報 :**</span><span class="sxs-lookup"><span data-stu-id="a780b-194">**Network Statistics:**</span></span>||  
|<span data-ttu-id="a780b-195">ServerRndTrips</span><span class="sxs-lookup"><span data-stu-id="a780b-195">ServerRndTrips</span></span>|<span data-ttu-id="a780b-196">ドライバーがサーバーにコマンドを送信し、応答を受け取った回数。</span><span class="sxs-lookup"><span data-stu-id="a780b-196">The number of times the driver sent commands to the server and got a reply back.</span></span>|  
|<span data-ttu-id="a780b-197">BuffersSent</span><span class="sxs-lookup"><span data-stu-id="a780b-197">BuffersSent</span></span>|<span data-ttu-id="a780b-198">SQL_PERF_START 以降にドライバーから [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に送信された表形式データ ストリーム (TDS) パケットの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-198">Number of Tabular Data Stream (TDS) packets sent to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by the driver after SQL_PERF_START.</span></span> <span data-ttu-id="a780b-199">大量の処理を伴うコマンドは複数のバッファーを使用する可能性があるので、このようなコマンドがサーバーに送信され、6 個のパケットを使用する場合、ServerRndTrips は 1 ずつ増加しますが、BuffersSent は 6 ずつ増加します。</span><span class="sxs-lookup"><span data-stu-id="a780b-199">Large commands can take multiple buffers, so if a large command is sent to the server and it fills six packets, ServerRndTrips is incremented by one and BuffersSent is incremented by six.</span></span>|  
|<span data-ttu-id="a780b-200">BuffersRec</span><span class="sxs-lookup"><span data-stu-id="a780b-200">BuffersRec</span></span>|<span data-ttu-id="a780b-201">アプリケーションがドライバーの使用を開始した後に、ドライバーが [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] から受信した TDS パケットの数。</span><span class="sxs-lookup"><span data-stu-id="a780b-201">Number of TDS packets received by the driver from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] after the application started using the driver.</span></span>|  
|<span data-ttu-id="a780b-202">BytesSent</span><span class="sxs-lookup"><span data-stu-id="a780b-202">BytesSent</span></span>|<span data-ttu-id="a780b-203">アプリケーションがドライバーの使用を開始した後に、TDS パケットを使用して [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] に送信されたデータのバイト数。</span><span class="sxs-lookup"><span data-stu-id="a780b-203">Number of bytes of data sent to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in TDS packets after the application started using the driver.</span></span>|  
|<span data-ttu-id="a780b-204">BytesRec</span><span class="sxs-lookup"><span data-stu-id="a780b-204">BytesRec</span></span>|<span data-ttu-id="a780b-205">アプリケーションがドライバーの使用を開始した後に、ドライバーが [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] から TDS パケットを使用して受信したデータのバイト数。</span><span class="sxs-lookup"><span data-stu-id="a780b-205">Number of bytes of data in TDS packets received by the driver from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] after the application started using the driver.</span></span>|  
  
### <a name="time-statistics"></a><span data-ttu-id="a780b-206">時間統計情報</span><span class="sxs-lookup"><span data-stu-id="a780b-206">Time Statistics</span></span>  
  
|<span data-ttu-id="a780b-207">SQLPERF フィールド</span><span class="sxs-lookup"><span data-stu-id="a780b-207">SQLPERF Field</span></span>|<span data-ttu-id="a780b-208">説明</span><span class="sxs-lookup"><span data-stu-id="a780b-208">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="a780b-209">msExecutionTime</span><span class="sxs-lookup"><span data-stu-id="a780b-209">msExecutionTime</span></span>|<span data-ttu-id="a780b-210">SQL_PERF_START 以降、ドライバーが処理に要した累積時間。サーバーからの応答の待ち時間も含まれます。</span><span class="sxs-lookup"><span data-stu-id="a780b-210">Cumulative amount of time the driver spent processing after SQL_PERF_START, including the time spent waiting for replies from the server.</span></span>|  
|<span data-ttu-id="a780b-211">msNetworkServerTime</span><span class="sxs-lookup"><span data-stu-id="a780b-211">msNetworkServerTime</span></span>|<span data-ttu-id="a780b-212">ドライバーがサーバーからの応答待ちに要した累積時間。</span><span class="sxs-lookup"><span data-stu-id="a780b-212">Cumulative amount of time the driver spent waiting for replies from the server.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a780b-213">参照</span><span class="sxs-lookup"><span data-stu-id="a780b-213">See Also</span></span>  
 <span data-ttu-id="a780b-214">[SQL Server Native Client &#40;ODBC&#41;](sql-server-native-client-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="a780b-214">[SQL Server Native Client &#40;ODBC&#41;](sql-server-native-client-odbc.md) </span></span>  
 [<span data-ttu-id="a780b-215">Odbc&#41;&#40;ODBC ドライバーのパフォーマンスのプロファイル方法に関するトピック</span><span class="sxs-lookup"><span data-stu-id="a780b-215">Profiling ODBC Driver Performance How-to Topics &#40;ODBC&#41;</span></span>](../../native-client-odbc-how-to/profiling-odbc-driver-performance-odbc.md)  
  
  
