---
title: 追加のテーブル値パラメーターのメタデータ |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), catalog functions to retrieve metadata
- table-valued parameters (ODBC), metadata
ms.assetid: 6c193188-5185-4373-9a0d-76cfc150c828
author: rothja
ms.author: jroth
ms.openlocfilehash: 9907b6bdbabcea427e5feffd14369e8aa718094f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643825"
---
# <a name="additional-table-valued-parameter-metadata"></a><span data-ttu-id="a26cd-102">テーブル値パラメーターの追加メタデータ</span><span class="sxs-lookup"><span data-stu-id="a26cd-102">Additional Table-Valued Parameter Metadata</span></span>
  <span data-ttu-id="a26cd-103">アプリケーションは、テーブル値パラメーターのメタデータを取得するために SQLProcedureColumns を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-103">To retrieve metadata for a table-valued parameter, an application calls SQLProcedureColumns.</span></span> <span data-ttu-id="a26cd-104">テーブル値パラメーターの場合、SQLProcedureColumns は単一の行を返します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-104">For a table-valued parameter, SQLProcedureColumns returns a single row.</span></span> <span data-ttu-id="a26cd-105">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]テーブル値パラメーターに関連付けられているテーブル型のスキーマとカタログの情報を提供するために、SS_TYPE_CATALOG_NAME と SS_TYPE_SCHEMA_NAME という2つの追加固有の列が追加されました。</span><span class="sxs-lookup"><span data-stu-id="a26cd-105">Two additional [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific columns, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME, have been added to provide schema and catalog information for table types associated with table-valued parameters.</span></span> <span data-ttu-id="a26cd-106">ODBC 仕様に準拠して、SS_TYPE_CATALOG_NAME と SS_TYPE_SCHEMA_NAME は、以前のバージョンので追加されたすべてのドライバー固有の列の前、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] および odbc 自体によって必須とされるすべての列の前に表示されます。</span><span class="sxs-lookup"><span data-stu-id="a26cd-106">In conformance with the ODBC specification, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME appear before all driver-specific columns added in earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and after all columns mandated by ODBC itself.</span></span>  
  
 <span data-ttu-id="a26cd-107">テーブル値パラメーターにとって重要な列を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-107">The following table lists columns that are significant for table-valued parameters.</span></span>  
  
|<span data-ttu-id="a26cd-108">列名</span><span class="sxs-lookup"><span data-stu-id="a26cd-108">Column name</span></span>|<span data-ttu-id="a26cd-109">データ型</span><span class="sxs-lookup"><span data-stu-id="a26cd-109">Data type</span></span>|<span data-ttu-id="a26cd-110">値およびコメント</span><span class="sxs-lookup"><span data-stu-id="a26cd-110">Value/comments</span></span>|  
|-----------------|---------------|---------------------|  
|<span data-ttu-id="a26cd-111">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="a26cd-111">DATA_TYPE</span></span>|<span data-ttu-id="a26cd-112">Smallint (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-112">Smallint not NULL</span></span>|<span data-ttu-id="a26cd-113">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="a26cd-113">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="a26cd-114">TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="a26cd-114">TYPE_NAME</span></span>|<span data-ttu-id="a26cd-115">WVarchar(128) (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-115">WVarchar(128) not NULL</span></span>|<span data-ttu-id="a26cd-116">テーブル値パラメーターの型名</span><span class="sxs-lookup"><span data-stu-id="a26cd-116">The type name of the table-valued parameter.</span></span>|  
|<span data-ttu-id="a26cd-117">COLUMN_SIZE</span><span class="sxs-lookup"><span data-stu-id="a26cd-117">COLUMN_SIZE</span></span>|<span data-ttu-id="a26cd-118">Integer</span><span class="sxs-lookup"><span data-stu-id="a26cd-118">Integer</span></span>|<span data-ttu-id="a26cd-119">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-119">NULL</span></span>|  
|<span data-ttu-id="a26cd-120">BUFFER_LENGTH</span><span class="sxs-lookup"><span data-stu-id="a26cd-120">BUFFER_LENGTH</span></span>|<span data-ttu-id="a26cd-121">Integer</span><span class="sxs-lookup"><span data-stu-id="a26cd-121">Integer</span></span>|<span data-ttu-id="a26cd-122">0</span><span class="sxs-lookup"><span data-stu-id="a26cd-122">0</span></span>|  
|<span data-ttu-id="a26cd-123">DECIMAL_DIGITS</span><span class="sxs-lookup"><span data-stu-id="a26cd-123">DECIMAL_DIGITS</span></span>|<span data-ttu-id="a26cd-124">Smallint</span><span class="sxs-lookup"><span data-stu-id="a26cd-124">Smallint</span></span>|<span data-ttu-id="a26cd-125">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-125">NULL</span></span>|  
|<span data-ttu-id="a26cd-126">NUM_PREC_RADIX</span><span class="sxs-lookup"><span data-stu-id="a26cd-126">NUM_PREC_RADIX</span></span>|<span data-ttu-id="a26cd-127">Smallint</span><span class="sxs-lookup"><span data-stu-id="a26cd-127">Smallint</span></span>|<span data-ttu-id="a26cd-128">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-128">NULL</span></span>|  
|<span data-ttu-id="a26cd-129">NULLABLE</span><span class="sxs-lookup"><span data-stu-id="a26cd-129">NULLABLE</span></span>|<span data-ttu-id="a26cd-130">Smallint (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-130">Smallint not NULL</span></span>|<span data-ttu-id="a26cd-131">SQL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="a26cd-131">SQL_NULLABLE</span></span>|  
|<span data-ttu-id="a26cd-132">REMARKS</span><span class="sxs-lookup"><span data-stu-id="a26cd-132">REMARKS</span></span>|<span data-ttu-id="a26cd-133">Varchar</span><span class="sxs-lookup"><span data-stu-id="a26cd-133">Varchar</span></span>|<span data-ttu-id="a26cd-134">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-134">NULL</span></span>|  
|<span data-ttu-id="a26cd-135">COLUMN_DEF</span><span class="sxs-lookup"><span data-stu-id="a26cd-135">COLUMN_DEF</span></span>|<span data-ttu-id="a26cd-136">WVarchar(4000)</span><span class="sxs-lookup"><span data-stu-id="a26cd-136">WVarchar(4000)</span></span>|<span data-ttu-id="a26cd-137">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-137">NULL</span></span>|  
|<span data-ttu-id="a26cd-138">SQL_DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="a26cd-138">SQL_DATA_TYPE</span></span>|<span data-ttu-id="a26cd-139">Smallint (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-139">Smallint not NULL</span></span>|<span data-ttu-id="a26cd-140">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="a26cd-140">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="a26cd-141">SQL_DATETIME_SUB</span><span class="sxs-lookup"><span data-stu-id="a26cd-141">SQL_DATETIME_SUB</span></span>|<span data-ttu-id="a26cd-142">Smallint</span><span class="sxs-lookup"><span data-stu-id="a26cd-142">Smallint</span></span>|<span data-ttu-id="a26cd-143">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-143">NULL</span></span>|  
|<span data-ttu-id="a26cd-144">CHAR_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="a26cd-144">CHAR_OCTET_LENGTH</span></span>|<span data-ttu-id="a26cd-145">Integer</span><span class="sxs-lookup"><span data-stu-id="a26cd-145">Integer</span></span>|<span data-ttu-id="a26cd-146">NULL</span><span class="sxs-lookup"><span data-stu-id="a26cd-146">NULL</span></span>|  
|<span data-ttu-id="a26cd-147">ORDINAL_POSITION</span><span class="sxs-lookup"><span data-stu-id="a26cd-147">ORDINAL_POSITION</span></span>|<span data-ttu-id="a26cd-148">Integer (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-148">Integer not NULL</span></span>|<span data-ttu-id="a26cd-149">パラメーターの序数位置。</span><span class="sxs-lookup"><span data-stu-id="a26cd-149">The ordinal position of the parameter.</span></span>|  
|<span data-ttu-id="a26cd-150">IS_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="a26cd-150">IS_NULLABLE</span></span>|<span data-ttu-id="a26cd-151">Varchar</span><span class="sxs-lookup"><span data-stu-id="a26cd-151">Varchar</span></span>|<span data-ttu-id="a26cd-152">"YES"</span><span class="sxs-lookup"><span data-stu-id="a26cd-152">"YES"</span></span>|  
|<span data-ttu-id="a26cd-153">SS_TYPE_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="a26cd-153">SS_TYPE_CATALOG_NAME</span></span>|<span data-ttu-id="a26cd-154">WVarchar(128) (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-154">WVarchar(128) not NULL</span></span>|<span data-ttu-id="a26cd-155">テーブル値パラメーターのテーブル型の型定義が格納されているカタログ。</span><span class="sxs-lookup"><span data-stu-id="a26cd-155">The catalog that contains the type definition for the table type of the table-valued parameter.</span></span>|  
|<span data-ttu-id="a26cd-156">SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="a26cd-156">SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="a26cd-157">WVarchar(128) (NULL 以外)</span><span class="sxs-lookup"><span data-stu-id="a26cd-157">WVarchar(128) not NULL</span></span>|<span data-ttu-id="a26cd-158">テーブル値パラメーターのテーブル型の型定義が格納されているスキーマ。</span><span class="sxs-lookup"><span data-stu-id="a26cd-158">The schema that contains the type definition for the table type of the table-valued parameter.</span></span>|  
  
 <span data-ttu-id="a26cd-159">WVarchar 列は、ODBC 仕様では Varchar として定義されていますが、実際には、最近のすべての [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC ドライバーでは、WVarchar として返されます。</span><span class="sxs-lookup"><span data-stu-id="a26cd-159">The WVarchar columns are defined as Varchar in the ODBC specification, but are actually returned as WVarchar in all recent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC drivers.</span></span> <span data-ttu-id="a26cd-160">この変更は、ODBC 3.5 仕様に Unicode のサポートが追加されたときに行われましたが、明示されていませんでした。</span><span class="sxs-lookup"><span data-stu-id="a26cd-160">This change was made when Unicide support was added to the ODBC 3.5 specification, but not called out explicitly.</span></span>  
  
 <span data-ttu-id="a26cd-161">アプリケーションでは、テーブル値パラメーターの追加のメタデータを取得するために、SQLColumns および SQLPrimaryKeys カタログ関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-161">To obtain additional metadata for table-valued parameters, an application uses the catalog functions SQLColumns and SQLPrimaryKeys.</span></span> <span data-ttu-id="a26cd-162">これらの関数がテーブル値パラメーターのために呼び出される前に、アプリケーションでは、ステートメント属性 SQL_SOPT_SS_NAME_SCOPE を SQL_SS_NAME_SCOPE_TABLE_TYPE に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a26cd-162">Before these functions are called for table-valued parameters, the application must set the statement attribute SQL_SOPT_SS_NAME_SCOPE to SQL_SS_NAME_SCOPE_TABLE_TYPE.</span></span> <span data-ttu-id="a26cd-163">この値は、アプリケーションが実際のテーブルではなくテーブル型のメタデータを必要としていることを示します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-163">This value indicates that the application requires metadata for a table type rather than an actual table.</span></span> <span data-ttu-id="a26cd-164">その後、アプリケーションはテーブル値パラメーターの TYPE_NAME を*TableName*パラメーターとして渡します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-164">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span> <span data-ttu-id="a26cd-165">SS_TYPE_CATALOG_NAME と SS_TYPE_SCHEMA_NAME は、 *CatalogName*パラメーターと*SchemaName*パラメーターでそれぞれ使用され、テーブル値パラメーターのカタログとスキーマを識別します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-165">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="a26cd-166">テーブル値パラメーターのメタデータの取得が完了すると、アプリケーションによって、SQL_SOPT_SS_NAME_SCOPE は既定値 SQL_SS_NAME_SCOPE_TABLE に設定し直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="a26cd-166">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="a26cd-167">SQL_SOPT_SS_NAME_SCOPE が SQL_SS_NAME_SCOPE_TABLE に設定されると、リンク サーバーへのクエリは失敗します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-167">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="a26cd-168">サーバーコンポーネントを含むカタログを使用した SQLColumns または Sqlprimarykey の呼び出しは失敗します。</span><span class="sxs-lookup"><span data-stu-id="a26cd-168">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a26cd-169">参照</span><span class="sxs-lookup"><span data-stu-id="a26cd-169">See Also</span></span>  
 [<span data-ttu-id="a26cd-170">テーブル値パラメーター &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="a26cd-170">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
