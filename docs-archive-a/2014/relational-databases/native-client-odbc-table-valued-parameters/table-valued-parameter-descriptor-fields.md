---
title: テーブル値パラメーターの記述子フィールド |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714318"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="0e751-102">テーブル値パラメーターの記述子フィールド</span><span class="sxs-lookup"><span data-stu-id="0e751-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="0e751-103">テーブル値パラメーターのサポートには、ODBC アプリケーション パラメーター記述子 (APD) および実装パラメーター記述子 (IPD) の新しい [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 固有のフィールドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="0e751-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="0e751-104">解説</span><span class="sxs-lookup"><span data-stu-id="0e751-104">Remarks</span></span>  
  
|<span data-ttu-id="0e751-105">名前</span><span class="sxs-lookup"><span data-stu-id="0e751-105">Name</span></span>|<span data-ttu-id="0e751-106">場所</span><span class="sxs-lookup"><span data-stu-id="0e751-106">Location</span></span>|<span data-ttu-id="0e751-107">Type</span><span class="sxs-lookup"><span data-stu-id="0e751-107">Type</span></span>|<span data-ttu-id="0e751-108">説明</span><span class="sxs-lookup"><span data-stu-id="0e751-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="0e751-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="0e751-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="0e751-110">IPD</span><span class="sxs-lookup"><span data-stu-id="0e751-110">IPD</span></span>|<span data-ttu-id="0e751-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="0e751-111">SQLTCHAR\*</span></span>|<span data-ttu-id="0e751-112">テーブル値パラメーターのサーバーの型名です。</span><span class="sxs-lookup"><span data-stu-id="0e751-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="0e751-113">SQLBindParameter の呼び出しでテーブル値パラメーターの型名を指定する場合は、ANSI アプリケーションとしてビルドされたアプリケーションであっても、常に Unicode 値として指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0e751-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="0e751-114">パラメーター *StrLen_or_IndPtr*に使用される値は、SQL_NTS か、名前の文字列の長さに SIZEOF (WCHAR) を掛けたものである必要があります。</span><span class="sxs-lookup"><span data-stu-id="0e751-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="0e751-115">SQLSetDescField を使用してテーブル値パラメーターの型名を指定する場合は、アプリケーションのビルド方法に準拠したリテラルを使用して指定できます。</span><span class="sxs-lookup"><span data-stu-id="0e751-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="0e751-116">ODBC ドライバー マネージャーで、必要な Unicode 変換を実行します。</span><span class="sxs-lookup"><span data-stu-id="0e751-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="0e751-117">SQL_CA_SS_TYPE_CATALOG_NAME (読み取り専用)</span><span class="sxs-lookup"><span data-stu-id="0e751-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="0e751-118">IPD</span><span class="sxs-lookup"><span data-stu-id="0e751-118">IPD</span></span>|<span data-ttu-id="0e751-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="0e751-119">SQLTCHAR\*</span></span>|<span data-ttu-id="0e751-120">型が定義されているカタログです。</span><span class="sxs-lookup"><span data-stu-id="0e751-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="0e751-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="0e751-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="0e751-122">IPD</span><span class="sxs-lookup"><span data-stu-id="0e751-122">IPD</span></span>|<span data-ttu-id="0e751-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="0e751-123">SQLTCHAR\*</span></span>|<span data-ttu-id="0e751-124">型が定義されているスキーマです。</span><span class="sxs-lookup"><span data-stu-id="0e751-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="0e751-125">アプリケーションでは、テーブル値パラメーターの SQL_CA_SS_TYPE_CATALOG_NAME を設定できません。</span><span class="sxs-lookup"><span data-stu-id="0e751-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="0e751-126">これを設定すると、SQL_ERROR が返され、"記述子フィールドの識別子が正しくありません" というメッセージで SQLSTATE = HY091 の診断レコードが記録されます。</span><span class="sxs-lookup"><span data-stu-id="0e751-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="0e751-127">次のステートメント属性および記述子のヘッダー フィールドは、テーブル値パラメーターにフォーカスが設定されている場合に適用されます。</span><span class="sxs-lookup"><span data-stu-id="0e751-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="0e751-128">名前</span><span class="sxs-lookup"><span data-stu-id="0e751-128">Name</span></span>|<span data-ttu-id="0e751-129">場所</span><span class="sxs-lookup"><span data-stu-id="0e751-129">Location</span></span>|<span data-ttu-id="0e751-130">Type</span><span class="sxs-lookup"><span data-stu-id="0e751-130">Type</span></span>|<span data-ttu-id="0e751-131">説明</span><span class="sxs-lookup"><span data-stu-id="0e751-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="0e751-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="0e751-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="0e751-133">(APD の SQL_DESC_ARRAY_SIZE に相当)</span><span class="sxs-lookup"><span data-stu-id="0e751-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="0e751-134">APD</span><span class="sxs-lookup"><span data-stu-id="0e751-134">APD</span></span>|<span data-ttu-id="0e751-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="0e751-135">SQLUINTEGER</span></span>|<span data-ttu-id="0e751-136">テーブル値パラメーターのバッファー配列のサイズです。</span><span class="sxs-lookup"><span data-stu-id="0e751-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="0e751-137">これは、バッファーが保持できる最大行数、または行内のバッファーのサイズです。テーブル値パラメーターの値自体には、バッファーで保持できるよりも多い (または少ない) 行が含まれる場合があります。</span><span class="sxs-lookup"><span data-stu-id="0e751-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="0e751-138">既定値は 1 です。</span><span class="sxs-lookup"><span data-stu-id="0e751-138">Default is 1.</span></span> <span data-ttu-id="0e751-139">**注:** SQL_SOPT_SS_PARAM_FOCUS が既定値の0に設定されている場合、SQL_ATTR_PARAMSET_SIZE はステートメントを参照し、パラメーターセットの数を指定します。</span><span class="sxs-lookup"><span data-stu-id="0e751-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="0e751-140">SQL_SOPT_SS_PARAM_FOCUS がテーブル値パラメーターの序数に設定されている場合は、テーブル値パラメーターを参照し、テーブル値パラメーターのパラメーター セットごとの行数を指定します。</span><span class="sxs-lookup"><span data-stu-id="0e751-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="0e751-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="0e751-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="0e751-142">APD</span><span class="sxs-lookup"><span data-stu-id="0e751-142">APD</span></span>|<span data-ttu-id="0e751-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="0e751-143">SQLINTEGER</span></span>|<span data-ttu-id="0e751-144">既定値は SQL_PARAM_BIND_BY_COLUMN です。</span><span class="sxs-lookup"><span data-stu-id="0e751-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="0e751-145">行方向のバインドを選択するには、このフィールドに、構造体の長さ、または一連のテーブル値パラメーターの行のバインドされるバッファーのインスタンスの長さが設定されます。</span><span class="sxs-lookup"><span data-stu-id="0e751-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="0e751-146">この長さには、バインドされたすべての列の領域と、構造体またはバッファーの埋め込みを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="0e751-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="0e751-147">これにより、バインドされた列のアドレスが指定の長さでインクリメントされると、結果は、次の行の同じ列の先頭を指すようになります。</span><span class="sxs-lookup"><span data-stu-id="0e751-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="0e751-148">ANSI C の `sizeof` 演算子を使用すると、この動作が保証されます。</span><span class="sxs-lookup"><span data-stu-id="0e751-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="0e751-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="0e751-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="0e751-150">APD</span><span class="sxs-lookup"><span data-stu-id="0e751-150">APD</span></span>|<span data-ttu-id="0e751-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="0e751-151">SQLINTEGER\*</span></span>|<span data-ttu-id="0e751-152">既定値は NULL ポインターです。</span><span class="sxs-lookup"><span data-stu-id="0e751-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="0e751-153">このフィールドが NULL 以外の場合、ドライバーはポインターを逆参照し、逆参照された値を記述子レコードの遅延された各フィールド (SQL_DESC_DATA_PTR、SQL_DESC_INDICATOR_PTR、および SQL_DESC_OCTET_LENGTH_PTR) に追加して、新しいポインター値を使用してデータ値にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="0e751-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="0e751-154">これらのフィールドは、テーブル値パラメーターでのみ有効です。それ以外のデータ型の場合は無視されます。</span><span class="sxs-lookup"><span data-stu-id="0e751-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="0e751-155">ストアド プロシージャを呼び出す場合、SQL_CA_SS_TYPE_NAME は省略可能です。</span><span class="sxs-lookup"><span data-stu-id="0e751-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="0e751-156">サーバー側でテーブル値パラメーターの型を特定できるようなプロシージャの呼び出しでない場合は、SQL ステートメントで SQL_CA_SS_TYPE_NAME を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0e751-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="0e751-157">型名が必要で、テーブル値パラメーターのテーブル型がストアド プロシージャとは異なるスキーマで定義されている場合、SQL_CA_SS_TYPE_SCHEMA_NAME を実装パラメーター記述子 (IPD) で指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0e751-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="0e751-158">指定しないと、サーバーでテーブル値パラメーターの型を特定できません。</span><span class="sxs-lookup"><span data-stu-id="0e751-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="0e751-159">この場合、SQLExecute または SQLExecDirect を呼び出すとエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="0e751-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="0e751-160">エラーは SQLSTATE= 07006 で、メッセージは "データ型の属性に関する制限に違反しました" になります。</span><span class="sxs-lookup"><span data-stu-id="0e751-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="0e751-161">テーブル値パラメーターの列では、行方向のバインドまたは列方向のバインドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="0e751-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="0e751-162">既定では、列方向のバインドが使用されます。</span><span class="sxs-lookup"><span data-stu-id="0e751-162">The default is column-wise binding.</span></span> <span data-ttu-id="0e751-163">行方向のバインドは、SQL_ATTR_PARAM_BIND_TYPE および SQL_ATTR_ PARAM_BIND_OFFSET_PTR を設定することで指定できます。</span><span class="sxs-lookup"><span data-stu-id="0e751-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="0e751-164">これは、列およびパラメーターの行方向のバインドと似ています。</span><span class="sxs-lookup"><span data-stu-id="0e751-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="0e751-165">SQL_CA_SS_TYPE_CATALOG_NAME および SQL_CA_SS_TYPE_SCHEMA_NAME を使用すると、CLR ユーザー定義型パラメーターに関連付けられたカタログとスキーマも取得できます。</span><span class="sxs-lookup"><span data-stu-id="0e751-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="0e751-166">これらは、CLR ユーザー定義型の既存の型固有のカタログ スキーマの属性の代わりに使用します。</span><span class="sxs-lookup"><span data-stu-id="0e751-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0e751-167">参照</span><span class="sxs-lookup"><span data-stu-id="0e751-167">See Also</span></span>  
 [<span data-ttu-id="0e751-168">テーブル値パラメーター &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="0e751-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
