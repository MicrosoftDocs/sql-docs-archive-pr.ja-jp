---
title: プログラムによるレプリケーションの監視 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87741838"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="6adcb-102">プログラムによるレプリケーションの監視</span><span class="sxs-lookup"><span data-stu-id="6adcb-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="6adcb-103">レプリケーション モニターは、レプリケーション トポロジを監視するためのグラフィカル ツールです。</span><span class="sxs-lookup"><span data-stu-id="6adcb-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="6adcb-104">[!INCLUDE[tsql](../../../includes/tsql-md.md)] レプリケーション ストアド プロシージャまたはレプリケーション管理オブジェクト (RMO) を使用すると、同じ監視データにプログラムからアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="6adcb-105">このオブジェクトにより、次のタスクをプログラムできます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="6adcb-106">パブリッシャー、パブリケーション、およびサブスクリプションの状態を監視する。</span><span class="sxs-lookup"><span data-stu-id="6adcb-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="6adcb-107">1 つ以上のサブスクライバーにおけるマージ エージェント セッションを監視する。</span><span class="sxs-lookup"><span data-stu-id="6adcb-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="6adcb-108">1 つ以上のサブスクライバーで適用を待機しているトランザクション コマンドを監視する。</span><span class="sxs-lookup"><span data-stu-id="6adcb-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="6adcb-109">パブリケーションにユーザーの介入が必要となるしきい値の基準を定義する。</span><span class="sxs-lookup"><span data-stu-id="6adcb-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="6adcb-110">トレーサー トークンのステータスを監視する。</span><span class="sxs-lookup"><span data-stu-id="6adcb-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="6adcb-111">**このトピックの内容:**</span><span class="sxs-lookup"><span data-stu-id="6adcb-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="6adcb-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6adcb-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="6adcb-113">レプリケーション管理オブジェクト (RMO)</span><span class="sxs-lookup"><span data-stu-id="6adcb-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="6adcb-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6adcb-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="6adcb-115">ディストリビューターからパブリッシャー、パブリケーション、サブスクリプションを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="6adcb-116">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="6adcb-117">これにより、このディストリビューターを利用している全パブリッシャーの監視情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="6adcb-118">結果セットを1つのパブリッシャーに限定するには、を指定し **@publisher** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="6adcb-119">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="6adcb-120">これにより、このディストリビューターを利用している全パブリケーションの監視情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="6adcb-121">結果セットを1つのパブリッシャー、パブリケーション、またはパブリッシュされたデータベースに制限するには、 **@publisher** それぞれ、、またはを指定し **@publication** **@publisher_db** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="6adcb-122">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="6adcb-123">これにより、このディストリビューターを利用しているすべてのサブスクリプションの監視情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="6adcb-124">結果セットを1つのパブリッシャー、パブリケーション、またはパブリッシュ済みデータベースに属するサブスクリプションに限定するには、 **@publisher** それぞれ、、またはを指定し **@publication** **@publisher_db** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="6adcb-125">サブスクライバーで適用を待機しているトランザクション コマンドを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="6adcb-126">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="6adcb-127">これにより、このディストリビューターを利用しているすべてのサブスクリプションの、待機中の全コマンドに関する監視情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="6adcb-128">結果セットを、1つのパブリッシャー、サブスクライバー、パブリケーション、またはパブリッシュされたデータベースに属するサブスクリプションの保留中のコマンドに限定するには、 **@publisher** それぞれ、、 **@subscriber** **@publication** 、またはを指定し **@publisher_db** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="6adcb-129">アップロードまたはダウンロードされるのを待機しているマージ変更を監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="6adcb-130">パブリッシャーのパブリケーション データベースで、 [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="6adcb-131">返される結果セットには、サブスクライバーへのレプリケートを待機している変更に関する情報が示されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="6adcb-132">結果セットを1つのパブリケーションまたはアーティクルに属する変更に限定するに **@publication** は、それぞれまたはを指定し **@article** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="6adcb-133">サブスクライバーのサブスクリプション データベースで、 [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="6adcb-134">返される結果セットには、パブリッシャーへのレプリケートを待機している変更に関する情報が示されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="6adcb-135">結果セットを1つのパブリケーションまたはアーティクルに属する変更に限定するに **@publication** は、それぞれまたはを指定し **@article** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="6adcb-136">マージ エージェント セッションを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="6adcb-137">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="6adcb-138">これにより、このディストリビューターを利用する全サブスクリプションのすべてのマージ エージェント セッションに関する監視情報 ( **Session_id**を含む) が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="6adcb-139">また、 **MSmerge_sessions** システム テーブルにクエリを実行することでも、 [Session_id](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) を取得できます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="6adcb-140">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="6adcb-141">手順 1. で取得した **Session_id** の値を **@session_id**を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="6adcb-142">これにより、セッションに関する詳細な監視情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="6adcb-143">目的の各セッションについて、手順 2. を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="6adcb-144">サブスクライバーからのプル サブスクリプションのマージ エージェント セッションを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="6adcb-145">サブスクライバーのサブスクリプション データベースで、 [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="6adcb-146">特定のサブスクリプションについて、、 **@publisher** **@publication** 、およびにパブリケーションデータベースの名前を指定し **@publisher_db** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="6adcb-147">これにより、このサブスクリプションの過去 5 回のマージ エージェント セッションに関する監視情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="6adcb-148">結果セットで、目的のセッションの **Session_id** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="6adcb-149">サブスクライバーのサブスクリプション データベースで、 [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="6adcb-150">手順 1. で取得した **Session_id** の値を **@session_id**を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="6adcb-151">これにより、セッションに関する詳細な監視情報が表示されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="6adcb-152">目的の各セッションについて、手順 2. を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="6adcb-153">パブリケーションのしきい値を表示して変更するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="6adcb-154">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="6adcb-155">これにより、このディストリビューターを利用している全パブリケーションの監視しきい値が返されます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="6adcb-156">結果セットを、単一のパブリッシャーまたはパブリッシュされたデータベースまたは1つのパブリケーションに属するパブリケーションに対する監視しきい値を制限するには、 **@publisher** それぞれ、、またはを指定し **@publisher_db** **@publication** ます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="6adcb-157">変更する必要があるしきい値に対応する **Metric_id** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="6adcb-158">詳細については、「 [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6adcb-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="6adcb-159">ディストリビューターのディストリビューション データベースで、 [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="6adcb-160">必要に応じて、次の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="6adcb-161">手順 1. で得た **Metric_id** の値を **@metric_id**を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="6adcb-162">モニタしきい値メトリックの新しい値を指定 **@value** します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="6adcb-163">このしきい値に到達したときに警告をログに記録するには、 **@shouldalert** に **@shouldalert** を指定します。警告が不要な場合には、 **0** を指定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="6adcb-164">このしきい値に到達したときに警告をログに記録するには、 **@shouldalert** に **@mode** を指定し、無効にするには **2** を指定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="6adcb-165">レプリケーション管理オブジェクト (RMO)</span><span class="sxs-lookup"><span data-stu-id="6adcb-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="6adcb-166">サブスクライバーでマージ パブリケーションのサブスクリプションを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="6adcb-167"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、サブスクライバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6adcb-168"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> クラスのインスタンスを作成し、サブスクリプションの <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> の各プロパティを設定します。次に、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに対し、手順 1. で作成した <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="6adcb-169">次のいずれかのメソッドを呼び出して、このサブスクリプションのマージ エージェント セッションの情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="6adcb-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - 過去に発生したマージ エージェント セッションの情報を保持する <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> オブジェクトの配列を返します (最大 5 セッション)。</span><span class="sxs-lookup"><span data-stu-id="6adcb-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="6adcb-171">監視対象のすべてのセッションについて、 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="6adcb-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="6adcb-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - 過去に発生したマージ エージェント セッションの情報を保持する <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> パラメーターに指定された期間内に発生したマージ エージェント セッションの情報を保持する *T:Microsoft.SqlServer.Replication.MergeSessionSummary* オブジェクトの配列を返します (最大 5 セッション)。</span><span class="sxs-lookup"><span data-stu-id="6adcb-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="6adcb-173">監視対象のすべてのセッションについて、 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="6adcb-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="6adcb-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - 前回のマージ エージェント セッションの情報を保持する <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="6adcb-175">このセッションの <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="6adcb-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="6adcb-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - 過去のマージ エージェント セッション (最大 5 セッション) の情報を、1 行あたり 1 セッションの形式で保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="6adcb-177">監視対象のすべてのセッションについて、 **Session_id** 列の値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="6adcb-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="6adcb-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - 前回のマージ エージェント セッションの情報を保持する <xref:System.Data.DataRow> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="6adcb-179">このセッションの **Session_id** 列の値を確認してください。</span><span class="sxs-lookup"><span data-stu-id="6adcb-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="6adcb-180">(省略可) <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> を呼び出して、 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> として渡された *T:Microsoft.SqlServer.Replication.MergeSessionSummary* オブジェクトのデータを更新します。または、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> を呼び出して、 <xref:System.Data.DataRow> として渡された *T:System.Data.DataRow*を実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="6adcb-181">手順 3. で取得したセッション ID を使用して次のいずれかのメソッドを呼び出し、特定のセッションの詳細情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="6adcb-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>-指定され <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> た*sessionID*のオブジェクトの配列を返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="6adcb-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>- <xref:System.Data.DataSet> 指定された*sessionID*の情報を含むオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="6adcb-184">ディストリビューターですべてのパブリケーションについてレプリケーション プロパティを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="6adcb-185"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、ディストリビューターへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6adcb-186"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="6adcb-187"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに、手順 1. で作成した <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="6adcb-188"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="6adcb-189">次の 1 つまたは複数のメソッドを実行して、このディストリビューターを使用している、すべてのパブリッシャーのレプリケーション情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - このディストリビューターのすべてのディストリビューション エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - ディストリビューターに保存されているエラー情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - ディストリビューターのすべてのログ リーダー エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - ディストリビューターのすべてのマージ エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - ディストリビューターのその他すべてのレプリケーション エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - このディストリビューターのすべてのパブリッシャーに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - このディストリビューターを使用しているパブリッシャーを返す <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - ディストリビューターのすべてのキュー リーダー エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - 指定されたキュー リーダー エージェントおよびセッションの情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="6adcb-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - 指定されたキュー リーダー エージェントのセッション情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="6adcb-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - ディストリビューターのすべてのスナップショット エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="6adcb-201">ディストリビューターで特定のパブリッシャーのパブリケーション プロパティを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="6adcb-202"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、ディストリビューターへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6adcb-203">次のいずれかの方法で <xref:Microsoft.SqlServer.Replication.PublisherMonitor> オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="6adcb-204"><xref:Microsoft.SqlServer.Replication.PublisherMonitor> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="6adcb-205">パブリッシャーの <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. で作成した <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="6adcb-206"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6adcb-207">このメソッドから `false` が返された場合、パブリッシャー名が正しく定義されていないか、パブリケーションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="6adcb-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="6adcb-208"><xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> から取得します。このコレクションには、既存の <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> オブジェクトの <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> プロパティを使用してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="6adcb-209">次の 1 つまたは複数のメソッドを実行して、このパブリッシャーに属している、すべてのパブリケーションのレプリケーション情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="6adcb-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - 指定されたディストリビューション エージェントおよびセッションの情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="6adcb-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - 指定されたディストリビューション エージェントのセッション情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="6adcb-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - 指定されたエラーのエラー レコード情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="6adcb-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - 指定されたログ リーダー エージェントおよびセッションの情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="6adcb-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - 指定されたログ リーダー エージェントのセッション情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="6adcb-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - 指定されたマージ エージェントおよびセッションの情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="6adcb-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - 指定されたマージ エージェントおよびセッションの追加情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="6adcb-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - 指定されたマージ エージェントのセッション情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="6adcb-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - 指定されたマージ エージェントの追加のセッション情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="6adcb-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - このディストリビューターのすべてのパブリケーションに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - このディストリビューターのすべてのパブリケーションに関する追加情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="6adcb-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - 指定されたスナップショット エージェントおよびセッションの情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="6adcb-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - 指定されたスナップショット エージェントのセッション情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="6adcb-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - このディストリビューターのパブリケーションに対するすべてのサブスクリプションに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="6adcb-224">ディストリビューターで特定のパブリッシャーのプロパティを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="6adcb-225"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、ディストリビューターへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6adcb-226">次のいずれかの方法で <xref:Microsoft.SqlServer.Replication.PublicationMonitor> オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="6adcb-227"><xref:Microsoft.SqlServer.Replication.PublicationMonitor> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="6adcb-228">パブリケーションの <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. で作成した <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="6adcb-229"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6adcb-230">このメソッドから `false` が返された場合、パブリケーションのプロパティが正しく定義されていないか、パブリケーションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="6adcb-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="6adcb-231"><xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> から取得します。このコレクションには、既存の <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> オブジェクトの <xref:Microsoft.SqlServer.Replication.PublisherMonitor> プロパティを使用してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="6adcb-232">次の 1 つまたは複数のメソッドを実行して、このパブリケーションに関する情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - 指定されたエラーのエラー レコードを保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="6adcb-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - このパブリケーションのログ リーダー エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - このパブリケーションに設定されている監視警告のしきい値情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - このパブリケーションで使用されるキュー リーダー エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - このパブリケーションのスナップショット エージェントに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - このパブリケーションのサブスクリプションに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - このパブリケーションのサブスクリプションに関する追加情報を保持する <xref:System.Data.DataSet> オブジェクトを、指定された <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>に基づいて返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="6adcb-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - 指定されたトレーサー トークンの待機時間情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="6adcb-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - このパブリケーションに挿入されたすべてのトレーサー トークンに関する情報を保持する <xref:System.Data.DataSet> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="6adcb-242">サブスクライバーで適用待ち状態になっているトランザクション コマンドを監視するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="6adcb-243"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、ディストリビューターへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6adcb-244">次のいずれかの方法で <xref:Microsoft.SqlServer.Replication.PublicationMonitor> オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="6adcb-245"><xref:Microsoft.SqlServer.Replication.PublicationMonitor> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="6adcb-246">パブリケーションの <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. で作成した <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="6adcb-247"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6adcb-248">このメソッドから `false` が返された場合、パブリケーションのプロパティが正しく定義されていないか、パブリケーションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="6adcb-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="6adcb-249"><xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> から取得します。このコレクションには、既存の <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> オブジェクトの <xref:Microsoft.SqlServer.Replication.PublisherMonitor> プロパティを使用してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="6adcb-250"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> メソッドを実行して <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="6adcb-251">この <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> オブジェクトのプロパティを使用して、保留状態の推定コマンド数と、コマンドを配信を完了するまでの時間を調べます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="6adcb-252">パブリケーションに対して監視警告のしきい値を設定するには</span><span class="sxs-lookup"><span data-stu-id="6adcb-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="6adcb-253"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、ディストリビューターへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6adcb-254">次のいずれかの方法で <xref:Microsoft.SqlServer.Replication.PublicationMonitor> オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="6adcb-255"><xref:Microsoft.SqlServer.Replication.PublicationMonitor> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="6adcb-256">パブリケーションの <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. で作成した <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="6adcb-257"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6adcb-258">このメソッドから `false` が返された場合、パブリケーションのプロパティが正しく定義されていないか、パブリケーションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="6adcb-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="6adcb-259"><xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> から取得します。このコレクションには、既存の <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> オブジェクトの <xref:Microsoft.SqlServer.Replication.PublisherMonitor> プロパティを使用してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6adcb-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="6adcb-260"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> メソッドを実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="6adcb-261">返された <xref:System.Collections.ArrayList> オブジェクトの <xref:Microsoft.SqlServer.Replication.MonitorThreshold> で、現在のしきい値設定を確認します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="6adcb-262"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> メソッドを実行します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="6adcb-263">次のパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="6adcb-264">*metricID* - 監視しきい値の基準を表す <xref:System.Int32> 値です。次の表に示す値を使用します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="6adcb-265">値</span><span class="sxs-lookup"><span data-stu-id="6adcb-265">Value</span></span>|<span data-ttu-id="6adcb-266">説明</span><span class="sxs-lookup"><span data-stu-id="6adcb-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="6adcb-267">1</span><span class="sxs-lookup"><span data-stu-id="6adcb-267">1</span></span>|<span data-ttu-id="6adcb-268">`expiration` - トランザクション パブリケーションへのサブスクリプションに期限が迫っていないかを監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="6adcb-269">2</span><span class="sxs-lookup"><span data-stu-id="6adcb-269">2</span></span>|<span data-ttu-id="6adcb-270">`latency` - トランザクション パブリケーションへのサブスクリプションのパフォーマンスを監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="6adcb-271">4</span><span class="sxs-lookup"><span data-stu-id="6adcb-271">4</span></span>|<span data-ttu-id="6adcb-272">`mergeexpiration` - マージ パブリケーションへのサブスクリプションに期限が迫っていないかを監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="6adcb-273">5</span><span class="sxs-lookup"><span data-stu-id="6adcb-273">5</span></span>|<span data-ttu-id="6adcb-274">`mergeslowrunduration` - 低速回線 (ダイヤルアップ) 接続でのマージの同期時間を監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="6adcb-275">6</span><span class="sxs-lookup"><span data-stu-id="6adcb-275">6</span></span>|<span data-ttu-id="6adcb-276">`mergefastrunduration` - 高帯域 (LAN) 接続でのマージ同期の期間を監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="6adcb-277">7</span><span class="sxs-lookup"><span data-stu-id="6adcb-277">7</span></span>|<span data-ttu-id="6adcb-278">`mergefastrunspeed` : 高帯域幅 (LAN) 接続経由でのマージ同期の同期速度を監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="6adcb-279">8</span><span class="sxs-lookup"><span data-stu-id="6adcb-279">8</span></span>|<span data-ttu-id="6adcb-280">`mergeslowrunspeed` - 低速回線 (ダイヤルアップ) 接続でのマージの同期速度を監視します。</span><span class="sxs-lookup"><span data-stu-id="6adcb-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="6adcb-281">*enable* - <xref:System.Boolean> 値です。</span><span class="sxs-lookup"><span data-stu-id="6adcb-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="6adcb-282">*thresholdValue* - しきい値を設定する整数値です。</span><span class="sxs-lookup"><span data-stu-id="6adcb-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="6adcb-283">*shouldAlert* - このしきい値に対して警告を生成するかどうかを示す整数値です。</span><span class="sxs-lookup"><span data-stu-id="6adcb-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  
