---
title: パブリッシングおよびディストリビューションの構成 | Microsoft Docs
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], distribution
- distribution configuration [SQL Server replication]
- publishing [SQL Server replication], configuring
ms.assetid: 3cfc8966-833e-42fa-80cb-09175d1feed7
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: afd1544b5412c6ce2d83a9a1e9a50ddf662b3056
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87631845"
---
# <a name="configure-publishing-and-distribution"></a><span data-ttu-id="c6489-102">パブリッシングおよびディストリビューションの構成</span><span class="sxs-lookup"><span data-stu-id="c6489-102">Configure Publishing and Distribution</span></span>
  <span data-ttu-id="c6489-103">このトピックでは、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] で [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]、 [!INCLUDE[tsql](../../includes/tsql-md.md)]、またはレプリケーション管理オブジェクト (RMO) を使用して、パブリッシングとディストリビューションを構成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="c6489-103">This topic describes how to configure publishing and distribution in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="c6489-104">はじめに</span><span class="sxs-lookup"><span data-stu-id="c6489-104">Before You Begin</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="c6489-105">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="c6489-105">Security</span></span>  
 <span data-ttu-id="c6489-106">詳細については、「[レプリケーションの配置のセキュリティ保護](security/view-and-modify-replication-security-settings.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6489-106">For more information, see [Secure Replication Deployment](security/view-and-modify-replication-security-settings.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="c6489-107">SQL Server Management Studio の使用</span><span class="sxs-lookup"><span data-stu-id="c6489-107">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="c6489-108">パブリケーションの新規作成ウィザードまたはディストリビューションの構成ウィザードを使用して、ディストリビューションを構成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-108">Configure distribution using the New Publication Wizard or the Configure Distribution Wizard.</span></span> <span data-ttu-id="c6489-109">ディストリビューターを構成したら、 **[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスでプロパティを表示および変更します。</span><span class="sxs-lookup"><span data-stu-id="c6489-109">After the Distributor is configured, view and modify properties in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="c6489-110">**db_owner** 固定データベース ロールのメンバーがパブリケーションを作成できるようにディストリビューターを構成する場合、またはパブリッシャーではないリモート ディストリビューターを構成する必要がある場合は、ディストリビューションの構成ウィザードを使用します。</span><span class="sxs-lookup"><span data-stu-id="c6489-110">Use the Configure Distribution Wizard if you want to configure a Distributor so that members of the **db_owner** fixed database roles can create publications, or because you want to configure a remote Distributor that is not a Publisher.</span></span>  
  
#### <a name="to-configure-distribution"></a><span data-ttu-id="c6489-111">ディストリビューションを構成するには</span><span class="sxs-lookup"><span data-stu-id="c6489-111">To configure distribution</span></span>  
  
1.  <span data-ttu-id="c6489-112">[!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] で、ディストリビューターとなるサーバーに接続し (多くの場合、パブリッシャーとディストリビューターは同じサーバーです)、サーバー ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="c6489-112">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], connect to the server that will be the Distributor (in many cases, the Publisher and Distributor are the same server), and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="c6489-113">**[レプリケーション]** フォルダーを右クリックし、 **[ディストリビューションの構成]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c6489-113">Right-click the **Replication** folder, and then click **Configure Distribution**.</span></span>  
  
3.  <span data-ttu-id="c6489-114">ディストリビューションの構成ウィザードに従って、次の操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-114">Follow the Configure Distribution Wizard to:</span></span>  
  
    -   <span data-ttu-id="c6489-115">ディストリビューターを選択します。</span><span class="sxs-lookup"><span data-stu-id="c6489-115">Select a Distributor.</span></span> <span data-ttu-id="c6489-116">ローカルディストリビューターを使用するには、[' \*\* \<ServerName> ' を独自のディストリビューターとして動作させる] を選択します。SQL Server によって、ディストリビューションデータベースとログが作成され\*\*ます。</span><span class="sxs-lookup"><span data-stu-id="c6489-116">To use a local Distributor, select **'\<ServerName>' will act as its own Distributor; SQL Server will create a distribution database and log**.</span></span> <span data-ttu-id="c6489-117">リモート ディストリビューターを使用するには、 **[以下のサーバーをディストリビューターとして使用する]** を選択し、サーバーを選択します。</span><span class="sxs-lookup"><span data-stu-id="c6489-117">To use a remote Distributor, select **Use the following server as the Distributor**, and then select a server.</span></span> <span data-ttu-id="c6489-118">このサーバーは既にディストリビューターとして構成されている必要があり、パブリッシャーではこのディストリビューターを使用できるようになっている必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6489-118">The server must already be configured as a Distributor, and the Publisher must be enabled to use the Distributor.</span></span> <span data-ttu-id="c6489-119">詳細については、「[ディストリビューターでのリモート パブリッシャーの有効化 &#40;SQL Server Management Studio&#41;](enable-a-remote-publisher-at-a-distributor-sql-server-management-studio.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6489-119">For more information, see [Enable a Remote Publisher at a Distributor &#40;SQL Server Management Studio&#41;](enable-a-remote-publisher-at-a-distributor-sql-server-management-studio.md).</span></span>  
  
         <span data-ttu-id="c6489-120">リモート ディストリビューターを選択した場合、パブリッシャーからディストリビューターへの接続に対して、 **[管理パスワード]** ページでパスワードを入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6489-120">If you select a remote Distributor, you must enter a password on the **Administrative Password** page for connections made from the Publisher to the Distributor.</span></span> <span data-ttu-id="c6489-121">このパスワードは、リモート ディストリビューターでパブリッシャーを有効にしたときに指定したパスワードと一致する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6489-121">This password must match the password specified when the Publisher was enabled at the remote Distributor.</span></span>  
  
    -   <span data-ttu-id="c6489-122">ローカル ディストリビューターに対してルート スナップショット フォルダーを指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-122">Specify a root snapshot folder (for a local Distributor).</span></span> <span data-ttu-id="c6489-123">スナップショット フォルダーは、共有として指定したディレクトリです。このフォルダーの読み取りと書き込みをするエージェントには、このフォルダーへのアクセスを可能にする十分な権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="c6489-123">The snapshot folder is simply a directory that you have designated as a share; agents that read from and write to this folder must have sufficient permissions to access it.</span></span> <span data-ttu-id="c6489-124">このディストリビューターを使用する各パブリッシャーによって、ルート フォルダーの下にフォルダーが作成され、各パブリケーションでは、パブリッシャー フォルダーの下にスナップショット ファイルを格納するフォルダーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="c6489-124">Each Publisher that uses this Distributor creates a folder under the root folder, and each publication creates folders under the Publisher folder in which to store snapshot files.</span></span> <span data-ttu-id="c6489-125">フォルダーの適切なセキュリティ保護の詳細については、「[スナップショット フォルダーのセキュリティ保護](security/secure-the-snapshot-folder.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6489-125">For more information on securing the folder appropriately, see [Secure the Snapshot Folder](security/secure-the-snapshot-folder.md).</span></span>  
  
    -   <span data-ttu-id="c6489-126">ローカル ディストリビューターに対してディストリビューション データベースを指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-126">Specify the distribution database (for a local Distributor).</span></span> <span data-ttu-id="c6489-127">ディストリビューション データベースには、すべての種類のレプリケーションのメタデータと履歴データ、およびトランザクション レプリケーションに対するトランザクションが格納されます。</span><span class="sxs-lookup"><span data-stu-id="c6489-127">The distribution database stores metadata and history data for all types of replication and transactions for transactional replication.</span></span>  
  
    -   <span data-ttu-id="c6489-128">必要に応じて、その他のパブリッシャーでディストリビューターを使用できるようにします。</span><span class="sxs-lookup"><span data-stu-id="c6489-128">Optionally enable other Publishers to use the Distributor.</span></span> <span data-ttu-id="c6489-129">その他のパブリッシャーがディストリビューターを使用できるようになっている場合は、これらのパブリッシャーからディストリビューターへの接続に対して、 **[ディストリビューター パスワード]** ページでパスワードを入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6489-129">If other Publishers are enabled to use the Distributor, you must enter a password on the **Distributor Password** page for connections made from these Publishers to the Distributor.</span></span>  
  
    -   <span data-ttu-id="c6489-130">必要に応じて、構成の設定のスクリプトを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-130">Optionally script configuration settings.</span></span> <span data-ttu-id="c6489-131">詳細については、「[レプリケーションのスクリプト作成](scripting-replication.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6489-131">For more information, see [Scripting Replication](scripting-replication.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="c6489-132">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="c6489-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="c6489-133">レプリケーションのパブリッシングおよびディストリビューションは、レプリケーションのストアド プロシージャを使用してプログラムから構成できます。</span><span class="sxs-lookup"><span data-stu-id="c6489-133">Replication publishing and distribution can be configured programmatically using replication stored procedures.</span></span>  
  
#### <a name="to-configure-publishing-using-a-local-distributor"></a><span data-ttu-id="c6489-134">ローカル ディストリビューターを使用してパブリッシングを構成するには</span><span class="sxs-lookup"><span data-stu-id="c6489-134">To configure publishing using a local distributor</span></span>  
  
1.  <span data-ttu-id="c6489-135">[sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) を実行して、サーバーが既にディストリビューターとして構成されているかどうかを調べます。</span><span class="sxs-lookup"><span data-stu-id="c6489-135">Execute [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) to determine if the server is already configured as a Distributor.</span></span>  
  
    -   <span data-ttu-id="c6489-136">結果セットの **installed** の値が **0** の場合は、ディストリビューターの master データベースで [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-136">If the value of **installed** in the result set is **0**, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) at the Distributor on the master database.</span></span>  
  
    -   <span data-ttu-id="c6489-137">結果セットの **distribution db installed** の値が **0** の場合は、ディストリビューターの master データベースで [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-137">If the value of **distribution db installed** in the result set is **0**, execute [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="c6489-138">\*\* \@ データベース\*\*のディストリビューションデータベースの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-138">Specify the name of the distribution database for **\@database**.</span></span> <span data-ttu-id="c6489-139">必要に応じて、 \*\* \@ max_distretention**のトランザクションの最大保有期間と** \@ history_retention\*\*の履歴の保有期間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="c6489-139">Optionally, you can specify the maximum transactional retention period for **\@max_distretention** and the history retention period for **\@history_retention**.</span></span> <span data-ttu-id="c6489-140">新しいデータベースを作成する場合は、必要なデータベース プロパティのパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-140">If a new database is being created, specify the desired database property parameters.</span></span>  
  
2.  <span data-ttu-id="c6489-141">パブリッシャーでもあるディストリビューターで、 \*\* \@ working_directory\*\*の既定のスナップショットフォルダーとして使用される UNC 共有を指定して[sp_adddistpublisher &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-141">At the Distributor, which is also the Publisher, execute [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specifying the UNC share that will be used as default snapshot folder for **\@working_directory**.</span></span>  
  
3.  <span data-ttu-id="c6489-142">パブリッシャーで、[sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-142">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span> <span data-ttu-id="c6489-143">\*\* \@ Dbname**用にパブリッシュされるデータベース、 \*\* \@ optname**のレプリケーションの種類、 `true` \*\* \@ value\*\*に値を指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-143">Specify the database being published for **\@dbname**, the type of replication for **\@optname**, and a value of `true` for **\@value**.</span></span>  
  
#### <a name="to-configure-publishing-using-a-remote-distributor"></a><span data-ttu-id="c6489-144">リモート ディストリビューターを使用してパブリッシングを構成するには</span><span class="sxs-lookup"><span data-stu-id="c6489-144">To configure publishing using a remote distributor</span></span>  
  
1.  <span data-ttu-id="c6489-145">[sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) を実行して、サーバーが既にディストリビューターとして構成されているかどうかを調べます。</span><span class="sxs-lookup"><span data-stu-id="c6489-145">Execute [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) to determine if the server is already configured as a Distributor.</span></span>  
  
    -   <span data-ttu-id="c6489-146">結果セットの **installed** の値が **0** の場合は、ディストリビューターの master データベースで [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-146">If the value of **installed** in the result set is **0**, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="c6489-147">\*\* \@ パスワード\*\*に強力なパスワードを指定してください。</span><span class="sxs-lookup"><span data-stu-id="c6489-147">Specify a strong password for **\@password**.</span></span> <span data-ttu-id="c6489-148">この **distributor_admin** アカウントのパスワードは、パブリッシャーがディストリビューターに接続する際に使用されます。</span><span class="sxs-lookup"><span data-stu-id="c6489-148">This password for the **distributor_admin** account will be used by the Publisher when connecting to the Distributor.</span></span>  
  
    -   <span data-ttu-id="c6489-149">結果セットの **distribution db installed** の値が **0** の場合は、ディストリビューターの master データベースで [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-149">If the value of **distribution db installed** in the result set is **0**, execute [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="c6489-150">\*\* \@ データベース\*\*のディストリビューションデータベースの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-150">Specify the name of the distribution database for **\@database**.</span></span> <span data-ttu-id="c6489-151">必要に応じて、 \*\* \@ max_distretention**のトランザクションの最大保有期間と** \@ history_retention\*\*の履歴の保有期間を指定できます。</span><span class="sxs-lookup"><span data-stu-id="c6489-151">Optionally, you can specify the maximum transactional retention period for **\@max_distretention** and the history retention period for **\@history_retention**.</span></span> <span data-ttu-id="c6489-152">新しいデータベースを作成する場合は、必要なデータベース プロパティのパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-152">If a new database is being created, specify the desired database property parameters.</span></span>  
  
2.  <span data-ttu-id="c6489-153">ディストリビューターで、 \*\* \@ working_directory\*\*の既定のスナップショットフォルダーとして使用される UNC 共有を指定して、 [sp_adddistpublisher &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-153">At the Distributor, execute [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specifying the UNC share that will be used as default snapshot folder for **\@working_directory**.</span></span> <span data-ttu-id="c6489-154">ディストリビューターが [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] パブリッシャーに接続するときに認証を使用する場合は、 \*\* \@ security_mode**に値**0**を指定し、 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] \*\* \@ ログイン**と\*\* \@ パスワード\*\*のログイン情報も指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c6489-154">If the Distributor will use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **\@login** and **\@password**.</span></span>  
  
3.  <span data-ttu-id="c6489-155">パブリッシャーの master データベースで [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-155">At the Publisher on the master database, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql).</span></span> <span data-ttu-id="c6489-156">\*\* \@ パスワード\*\*については、手順 1. で使用した強力なパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-156">Specify the strong password used in step 1 for **\@password**.</span></span> <span data-ttu-id="c6489-157">このパスワードは、パブリッシャーがディストリビューターに接続する際に使用されます。</span><span class="sxs-lookup"><span data-stu-id="c6489-157">This password will be used by the Publisher when connecting to the Distributor.</span></span>  
  
4.  <span data-ttu-id="c6489-158">パブリッシャーで、[sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="c6489-158">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span> <span data-ttu-id="c6489-159">\*\* \@ Dbname**用にパブリッシュするデータベース、 \*\* \@ optname**のレプリケーションの種類、 \*\* \@ 値\*\*に true を指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-159">Specify the database being published for **\@dbname**, the type of replication for **\@optname**, and a value of true for **\@value**.</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="c6489-160">例 (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="c6489-160">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="c6489-161">次の例に、パブリッシングおよびディストリビューションをプログラムから構成する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="c6489-161">The following example demonstrates how to configure publishing and distribution programmatically.</span></span> <span data-ttu-id="c6489-162">この例では、パブリッシャーおよびローカル ディストリビューターとして構成するサーバーの名前をスクリプト変数を使って指定しています。</span><span class="sxs-lookup"><span data-stu-id="c6489-162">In this example, the name of the server that is being configured as a publisher and a local distributor is supplied using scripting variables.</span></span> <span data-ttu-id="c6489-163">レプリケーションのパブリッシングおよびディストリビューションは、レプリケーションのストアド プロシージャを使用してプログラムから構成できます。</span><span class="sxs-lookup"><span data-stu-id="c6489-163">Replication publishing and distribution can be configured programmatically using replication stored procedures.</span></span>  
  
 [!code-sql[HowTo#AddDistPub](../../snippets/tsql/SQL15/replication/howto/tsql/adddistpub.sql#adddistpub)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="c6489-164">レプリケーション管理オブジェクト (RMO) の使用</span><span class="sxs-lookup"><span data-stu-id="c6489-164">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-configure-publishing-and-distribution-on-a-single-server"></a><span data-ttu-id="c6489-165">パブリッシングおよびディストリビューションを単一サーバーで構成するには</span><span class="sxs-lookup"><span data-stu-id="c6489-165">To configure publishing and distribution on a single server</span></span>  
  
1.  <span data-ttu-id="c6489-166"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、サーバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-166">Create a connection to the server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c6489-167"><xref:Microsoft.SqlServer.Replication.ReplicationServer> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-167">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="c6489-168">手順 1. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を渡します。</span><span class="sxs-lookup"><span data-stu-id="c6489-168">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="c6489-169"><xref:Microsoft.SqlServer.Replication.DistributionDatabase> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-169">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> class.</span></span>  
  
4.  <span data-ttu-id="c6489-170"><xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> プロパティにデータベース名を設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-170">Set the <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> property to the database name and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
5.  <span data-ttu-id="c6489-171"><xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> メソッドを呼び出してディストリビューターをインストールします。</span><span class="sxs-lookup"><span data-stu-id="c6489-171">Install the Distributor by calling the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="c6489-172">手順 3 の <xref:Microsoft.SqlServer.Replication.DistributionDatabase> オブジェクトを渡します。</span><span class="sxs-lookup"><span data-stu-id="c6489-172">Pass the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> object from step 3.</span></span>  
  
6.  <span data-ttu-id="c6489-173"><xref:Microsoft.SqlServer.Replication.DistributionPublisher> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-173">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionPublisher> class.</span></span>  
  
7.  <span data-ttu-id="c6489-174">次の <xref:Microsoft.SqlServer.Replication.DistributionPublisher>のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-174">Set the following properties of <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span></span>  
  
    -   <span data-ttu-id="c6489-175"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - パブリッシャーの名前。</span><span class="sxs-lookup"><span data-stu-id="c6489-175"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - name of the Publisher.</span></span>  
  
    -   <span data-ttu-id="c6489-176"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - 手順 1. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="c6489-176"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
    -   <span data-ttu-id="c6489-177"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - 手順 5. で作成したデータベースの名前。</span><span class="sxs-lookup"><span data-stu-id="c6489-177"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - the name of the database created in step 5.</span></span>  
  
    -   <span data-ttu-id="c6489-178"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - スナップショット ファイルのアクセスに使用する共有。</span><span class="sxs-lookup"><span data-stu-id="c6489-178"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - the share used to access snapshot files.</span></span>  
  
    -   <span data-ttu-id="c6489-179"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - パブリッシャーに接続するときに使用されるセキュリティ モード。</span><span class="sxs-lookup"><span data-stu-id="c6489-179"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - the security mode used when connecting to the Publisher.</span></span> <span data-ttu-id="c6489-180"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> が推奨されます。</span><span class="sxs-lookup"><span data-stu-id="c6489-180"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> is recommended.</span></span>  
  
8.  <span data-ttu-id="c6489-181"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="c6489-181">Call the <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> method.</span></span>  
  
#### <a name="to-configure-publishing-and-distribution-using-a-remote-distributor"></a><span data-ttu-id="c6489-182">リモート ディストリビューターを使用してパブリッシングおよびディストリビューションを構成するには</span><span class="sxs-lookup"><span data-stu-id="c6489-182">To configure publishing and distribution using a remote Distributor</span></span>  
  
1.  <span data-ttu-id="c6489-183"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、リモート ディストリビューター サーバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-183">Create a connection to the remote Distributor server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c6489-184"><xref:Microsoft.SqlServer.Replication.ReplicationServer> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-184">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="c6489-185">手順 1. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を渡します。</span><span class="sxs-lookup"><span data-stu-id="c6489-185">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="c6489-186"><xref:Microsoft.SqlServer.Replication.DistributionDatabase> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> class.</span></span>  
  
4.  <span data-ttu-id="c6489-187"><xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> プロパティにデータベース名を設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を設定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-187">Set the <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> property to the database name, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
5.  <span data-ttu-id="c6489-188"><xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> メソッドを呼び出してディストリビューターをインストールします。</span><span class="sxs-lookup"><span data-stu-id="c6489-188">Install the Distributor by calling the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="c6489-189">安全なパスワード (パブリッシャーがリモート ディストリビューターへの接続時に使用) および手順 3. の <xref:Microsoft.SqlServer.Replication.DistributionDatabase> オブジェクトを指定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-189">Specify a secure password (used by the Publisher when connecting to the remote Distributor) and the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> object from step 3.</span></span> <span data-ttu-id="c6489-190">詳細については、「[ディストリビューターのセキュリティ保護](security/secure-the-distributor.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c6489-190">For more information, see [Secure the Distributor](security/secure-the-distributor.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c6489-191">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="c6489-191">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="c6489-192">資格情報を保存する必要がある場合は、 [Windows .NET&#xA0;Framework に用意されている](https://go.microsoft.com/fwlink/?LinkId=34733) 暗号化サービス [!INCLUDE[msCoName](../../includes/msconame-md.md)] を使用します。</span><span class="sxs-lookup"><span data-stu-id="c6489-192">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
6.  <span data-ttu-id="c6489-193"><xref:Microsoft.SqlServer.Replication.DistributionPublisher> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionPublisher> class.</span></span>  
  
7.  <span data-ttu-id="c6489-194">次の <xref:Microsoft.SqlServer.Replication.DistributionPublisher>のプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="c6489-194">Set the following properties of <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span></span>  
  
    -   <span data-ttu-id="c6489-195"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - ローカル パブリッシャー サーバーの名前。</span><span class="sxs-lookup"><span data-stu-id="c6489-195"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - name of the local Publisher server.</span></span>  
  
    -   <span data-ttu-id="c6489-196"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - 手順 1. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="c6489-196"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
    -   <span data-ttu-id="c6489-197"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - 手順 5. で作成したデータベースの名前。</span><span class="sxs-lookup"><span data-stu-id="c6489-197"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - the name of the database created in step 5.</span></span>  
  
    -   <span data-ttu-id="c6489-198"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - スナップショット ファイルのアクセスに使用する共有。</span><span class="sxs-lookup"><span data-stu-id="c6489-198"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - the share used to access snapshot files.</span></span>  
  
    -   <span data-ttu-id="c6489-199"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - パブリッシャーに接続するときに使用されるセキュリティ モード。</span><span class="sxs-lookup"><span data-stu-id="c6489-199"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - the security mode used when connecting to the Publisher.</span></span> <span data-ttu-id="c6489-200"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> が推奨されます。</span><span class="sxs-lookup"><span data-stu-id="c6489-200"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> is recommended.</span></span>  
  
8.  <span data-ttu-id="c6489-201"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="c6489-201">Call the <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> method.</span></span>  
  
9. <span data-ttu-id="c6489-202"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、ローカル パブリッシャー サーバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-202">Create a connection to the local Publisher server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
10. <span data-ttu-id="c6489-203"><xref:Microsoft.SqlServer.Replication.ReplicationServer> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c6489-203">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="c6489-204">手順 9. の <xref:Microsoft.SqlServer.Management.Common.ServerConnection> を渡します。</span><span class="sxs-lookup"><span data-stu-id="c6489-204">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 9.</span></span>  
  
11. <span data-ttu-id="c6489-205"><xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="c6489-205">Call the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="c6489-206">リモート ディストリビューターの名前、および手順 5. で指定したリモート ディストリビューターのパスワードを渡します。</span><span class="sxs-lookup"><span data-stu-id="c6489-206">Pass the name of the remote Distributor and the password for the remote Distributor specified in step 5.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c6489-207">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="c6489-207">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="c6489-208">資格情報を保存する必要がある場合は、Windows .NET Framework に用意されている [暗号化サービス](https://go.microsoft.com/fwlink/?LinkId=34733) を使用します。</span><span class="sxs-lookup"><span data-stu-id="c6489-208">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the Windows .NET Framework.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="c6489-209">例 (RMO)</span><span class="sxs-lookup"><span data-stu-id="c6489-209">Example (RMO)</span></span>  
 <span data-ttu-id="c6489-210">レプリケーション管理オブジェクト (RMO) を使用することで、プログラムによってレプリケーション パブリッシングおよびディストリビューションを構成できます。</span><span class="sxs-lookup"><span data-stu-id="c6489-210">You can programmatically configure replication publishing and distribution by using Replication Management Objects (RMO).</span></span>  
  
 [!code-csharp[HowTo#rmo_AddDistPub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_adddistpub)]  
  
 [!code-vb[HowTo#rmo_vb_AddDistPub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_adddistpub)]  
  
## <a name="see-also"></a><span data-ttu-id="c6489-211">参照</span><span class="sxs-lookup"><span data-stu-id="c6489-211">See Also</span></span>  
 <span data-ttu-id="c6489-212">[View and Modify Distributor and Publisher Properties (ディストリビューターとパブリッシャーのプロパティの表示および変更)](view-and-modify-distributor-and-publisher-properties.md) </span><span class="sxs-lookup"><span data-stu-id="c6489-212">[View and Modify Distributor and Publisher Properties](view-and-modify-distributor-and-publisher-properties.md) </span></span>  
 <span data-ttu-id="c6489-213">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="c6489-213">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 <span data-ttu-id="c6489-214">[[ディストリビューションの構成]](configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="c6489-214">[Configure Distribution](configure-distribution.md) </span></span>  
 <span data-ttu-id="c6489-215">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="c6489-215">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 [<span data-ttu-id="c6489-216">AlwaysOn 可用性グループ &#40;SQL Server のレプリケーションを構成する&#41;</span><span class="sxs-lookup"><span data-stu-id="c6489-216">Configure Replication for AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](../../database-engine/availability-groups/windows/always-on-availability-groups-sql-server.md) 
  
  
