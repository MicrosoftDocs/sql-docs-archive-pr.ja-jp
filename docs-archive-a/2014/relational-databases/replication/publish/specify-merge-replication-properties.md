---
title: マージレプリケーションのプロパティの指定 |Microsoft Docs
ms.custom: ''
ms.date: 11/29/2018
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication [SQL Server replication], about merge replication
- merge replication [SQL Server replication]
ms.assetid: ff87c368-4c00-4e48-809d-ea752839551e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3b2e66b7ed26420093166445a478bfec7f1dd21d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87719851"
---
# <a name="specify-merge-replication-properties"></a><span data-ttu-id="21068-102">マージレプリケーションのプロパティの指定</span><span class="sxs-lookup"><span data-stu-id="21068-102">Specify Merge Replication Properties</span></span>
<span data-ttu-id="21068-103">このトピックでは、マージ レプリケーションのさまざまなプロパティを指定する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="21068-103">This topic explains how to specify various properties for your merge replication.</span></span> 


## <a name="download-only"></a><span data-ttu-id="21068-104">ダウンロードのみ</span><span class="sxs-lookup"><span data-stu-id="21068-104">Download-only</span></span>
  <span data-ttu-id="21068-105">ここでは、で [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] またはを使用して、マージテーブルアーティクルをダウンロード専用に指定する方法について説明し [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] [!INCLUDE[tsql](../../../includes/tsql-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="21068-105">This section describes how to specify that a merge table article is download-only in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="21068-106">ダウンロード専用のアーティクルは、サブスクライバーで更新されないデータを含むアプリケーション用に設計されています。</span><span class="sxs-lookup"><span data-stu-id="21068-106">Download-only articles are designed for applications with data that is not updated at Subscribers.</span></span> <span data-ttu-id="21068-107">詳細については、「[ダウンロード専用アーティクルを使用したマージ レプリケーションのパフォーマンス最適化](../merge/optimize-merge-replication-performance-with-download-only-articles.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-107">For more information, see [Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span></span>  
 
  
###  <a name="limitations-and-restrictions"></a><span data-ttu-id="21068-108">制限事項と制約事項</span><span class="sxs-lookup"><span data-stu-id="21068-108">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="21068-109">サブスクリプションが初期化された後でアーティクルをダウンロードのみに指定する場合は、そのアーティクルを受信したすべてのクライアント サブスクリプションを再初期化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-109">If you specify that an article is download-only after subscriptions have been initialized, all client subscriptions that received the article must be reinitialized.</span></span> <span data-ttu-id="21068-110">サーバー サブスクリプションは再初期化する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="21068-110">Server subscriptions do not have to be reinitialized.</span></span> <span data-ttu-id="21068-111">プロパティ変更の影響の詳細については、「[パブリケーションおよびアーティクルのプロパティの変更](change-publication-and-article-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-111">For more information on the effects of property changes, see [Change Publication and Article Properties](change-publication-and-article-properties.md).</span></span>  
  
### <a name="using-sql-server-management-studio"></a><span data-ttu-id="21068-112">SQL Server Management Studio を使用する</span><span class="sxs-lookup"><span data-stu-id="21068-112">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="21068-113">パブリケーションの新規作成ウィザードの [**アーティクル**] ページ、または [**アーティクルのプロパティ- \<Article> \*\* ] ダイアログボックスの [**プロパティ\*\*] タブで、アーティクルがダウンロード専用になるように指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-113">Specify that an article is download-only on the **Articles** page of the New Publication Wizard or the **Properties** tab of the **Article Properties - \<Article>** dialog box.</span></span> <span data-ttu-id="21068-114">このダイアログ ボックスは、パブリケーションの新規作成ウィザードおよび **[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスで使用できます。</span><span class="sxs-lookup"><span data-stu-id="21068-114">This dialog box is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="21068-115">ウィザードの使用およびダイアログ ボックスへのアクセスの詳細については、「[パブリケーションの作成](../publish/create-a-publication.md)」および「[View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md)」 (パブリケーション プロパティの表示および変更) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-115">For more information about using the wizard and accessing the dialog box, see [Create a Publication](../publish/create-a-publication.md) and [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-that-an-article-is-download-only-on-the-articles-page"></a><span data-ttu-id="21068-116">[アーティクル] ページでアーティクルをダウンロードのみに指定するには</span><span class="sxs-lookup"><span data-stu-id="21068-116">To specify that an article is download-only on the Articles page</span></span>  
  
-   <span data-ttu-id="21068-117">パブリケーションの新規作成ウィザードの **[アーティクル]** ページでテーブルを選択し、 **[反転表示されたテーブルはダウンロードのみである]** チェック ボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="21068-117">On the **Articles** page of the New Publication Wizard select a table, and then select the checkbox **Highlighted table is download-only**.</span></span> 
  
#### <a name="to-specify-that-an-article-is-download-only-on-the-properties-tab-of-the-article-properties---article-dialog-box"></a><span data-ttu-id="21068-118">アーティクルをダウンロード専用に指定するには、[アーティクルのプロパティ- \<Article> ] ダイアログボックスの [プロパティ] タブを選択します。</span><span class="sxs-lookup"><span data-stu-id="21068-118">To specify that an article is download-only on the Properties tab of the Article Properties - \<Article> dialog box</span></span>  
  
1.  <span data-ttu-id="21068-119">パブリケーションの新規作成ウィザードの **[アーティクル]** ページ、または **[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスでテーブルを選択し、 **[アーティクルのプロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21068-119">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>    
2.  <span data-ttu-id="21068-120">**[反転表示されたテーブル アーティクルのプロパティを設定]** または **[すべてのテーブル アーティクルのプロパティを設定]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21068-120">Click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>    
3.  <span data-ttu-id="21068-121">**[アーティクルのプロパティ - \<Article>]** ダイアログ ボックスの **[プロパティ]** タブの **[対象オブジェクト]** セクションで、 **[同期の方向]** に対して以下のいずれかの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-121">In the **Destination Object** section of the **Properties** tab of the **Article Properties - \<Article>** dialog box, specify one of the following values for **Synchronization direction**:</span></span>    
    -   <span data-ttu-id="21068-122">**[サブスクライバーへのダウンロードのみを実行し、サブスクライバーの変更を禁止する]**</span><span class="sxs-lookup"><span data-stu-id="21068-122">**Download to Subscriber, prohibit Subscriber changes**</span></span>    
    -   <span data-ttu-id="21068-123">**[サブスクライバーへのダウンロードのみを実行し、サブスクライバーの変更を許可する]**</span><span class="sxs-lookup"><span data-stu-id="21068-123">**Download to Subscriber, allow Subscriber changes**</span></span>  
  
4.  <span data-ttu-id="21068-124">**[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスが表示されている場合は、 **[OK]** をクリックして保存し、ダイアログ ボックスを閉じます。</span><span class="sxs-lookup"><span data-stu-id="21068-124">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>    

###  <a name="using-transact-sql"></a><span data-ttu-id="21068-125">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="21068-125">Using Transact-SQL</span></span>  
  
#### <a name="to-specify-that-a-new-merge-table-article-is-download-only"></a><span data-ttu-id="21068-126">新しいマージ テーブル アーティクルをダウンロード専用に指定するには</span><span class="sxs-lookup"><span data-stu-id="21068-126">To specify that a new merge table article is download-only</span></span>    
1.  <span data-ttu-id="21068-127">パラメーター \*\* \@ subscriber_upload_options**に**1**または**2\*\*の値を指定して[sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-127">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), specifying a value of **1** or **2** for the parameter **\@subscriber_upload_options**.</span></span> <span data-ttu-id="21068-128">各数値は次の動作に対応します。</span><span class="sxs-lookup"><span data-stu-id="21068-128">The numbers correspond to the following behavior:</span></span>  
  
    -   <span data-ttu-id="21068-129">**0** - 制限なし (既定)。</span><span class="sxs-lookup"><span data-stu-id="21068-129">**0** - No restrictions (default).</span></span> <span data-ttu-id="21068-130">サブスクライバー側で行われた変更は、パブリッシャーにアップロードされます。</span><span class="sxs-lookup"><span data-stu-id="21068-130">Changes made at the Subscriber are uploaded to the Publisher.</span></span>    
    -   <span data-ttu-id="21068-131">**1** - サブスクライバーでの変更は許可されますが、パブリッシャーにはアップロードされません。</span><span class="sxs-lookup"><span data-stu-id="21068-131">**1** - Changes are allowed at the Subscriber, but they are not uploaded to the Publisher.</span></span>    
    -   <span data-ttu-id="21068-132">**2** - サブスクライバーでの変更は許可されません。</span><span class="sxs-lookup"><span data-stu-id="21068-132">**2** - Changes are not allowed at the Subscriber.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="21068-133">アーティクルのソーステーブルが別のパブリケーションで既にパブリッシュされている場合、 \*\* \@ subscriber_upload_options\*\*の値は両方のアーティクルで同じである必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-133">If the source table for an article is already published in another publication, the value of **\@subscriber_upload_options** must be the same for both articles.</span></span>  
  
#### <a name="to-modify-an-existing-merge-table-article-to-be-download-only"></a><span data-ttu-id="21068-134">既存のマージ テーブル アーティクルをダウンロード専用に変更するには</span><span class="sxs-lookup"><span data-stu-id="21068-134">To modify an existing merge table article to be download-only</span></span>  
  
1.  <span data-ttu-id="21068-135">アーティクルがダウンロード専用であるかどうかを確認するには、 [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-135">To determine if an article is download-only, execute [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span></span> <span data-ttu-id="21068-136">結果セットのアーティクルの **upload_options** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="21068-136">Note the value of **upload_options** for the article in the result set.</span></span>    
2.  <span data-ttu-id="21068-137">手順 1. で返された値が**0**の場合は、 [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)を実行します。 \*\* \@ プロパティ**には**subscriber_upload_options**の値を、 \*\* \@ force_invalidate_snapshot**と\*\* \@ force_reinit_subscription**には**1\*\* 、値には\*\* \@ \*\* **1**または**2**を指定します。この値は次の動作に対応します。</span><span class="sxs-lookup"><span data-stu-id="21068-137">If the value returned in step 1 is **0**, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying a value of **subscriber_upload_options** for **\@property**, a value of **1** for **\@force_invalidate_snapshot** and **\@force_reinit_subscription**, and a value of **1** or **2** for **\@value**, which corresponds to the following behavior:</span></span>  
  
    -   <span data-ttu-id="21068-138">**1** - サブスクライバーでの変更は許可されますが、パブリッシャーにはアップロードされません。</span><span class="sxs-lookup"><span data-stu-id="21068-138">**1** - Changes are allowed at the Subscriber, but they are not uploaded to the Publisher.</span></span>    
    -   <span data-ttu-id="21068-139">**2** - サブスクライバーでの変更は許可されません。</span><span class="sxs-lookup"><span data-stu-id="21068-139">**2** - Changes are not allowed at the Subscriber.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="21068-140">アーティクルのソース テーブルが別のパブリケーションで既にパブリッシュされている場合、ダウンロード専用の動作は、両方のアーティクルで同じであることが必要です。</span><span class="sxs-lookup"><span data-stu-id="21068-140">If the source table for an article is already published in another publication, the download-only behavior must be the same for both articles.</span></span>  
 
## <a name=""></a><span data-ttu-id="21068-141"><a name="interactive-conflict-resolution">インタラクティブな競合解決</a></span><span class="sxs-lookup"><span data-stu-id="21068-141"><a name="interactive-conflict-resolution">Interactive conflict resolution</a></span></span>
[!INCLUDE[msCoName](../../../includes/msconame-md.md)]<span data-ttu-id="21068-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]レプリケーションにはインタラクティブ競合回避モジュールが用意されています。これにより、で [!INCLUDE[msCoName](../../../includes/msconame-md.md)] の要求時同期中に手動で競合を解決できます。Windows 同期マネージャー。</span><span class="sxs-lookup"><span data-stu-id="21068-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication provides an Interactive Resolver, which allows you to resolve conflicts manually during on-demand synchronization in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Synchronization Manager.</span></span> <span data-ttu-id="21068-143">インタラクティブな競合解決を有効にすると、インタラクティブ競合回避モジュールを使用して、同期実行時に競合がインタラクティブに解決されます。</span><span class="sxs-lookup"><span data-stu-id="21068-143">After interactive resolution is enabled, resolve conflicts interactively during synchronization, using the Interactive Resolver.</span></span> <span data-ttu-id="21068-144">インタラクティブ競合回避モジュールは、 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 同期マネージャーで利用できます。</span><span class="sxs-lookup"><span data-stu-id="21068-144">The Interactive Resolver is available through the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Synchronization Manager.</span></span> <span data-ttu-id="21068-145">詳細については、「[Windows 同期マネージャーを使用したサブスクリプションの同期 &#40;Windows 同期マネージャー&#41;](../synchronize-a-subscription-using-windows-synchronization-manager.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="21068-145">For more information, see [Synchronize a Subscription Using Windows Synchronization Manager &#40;Windows Synchronization Manager&#41;](../synchronize-a-subscription-using-windows-synchronization-manager.md).</span></span>  
  
    
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="21068-146">推奨事項</span><span class="sxs-lookup"><span data-stu-id="21068-146">Recommendations</span></span>  
  
-   <span data-ttu-id="21068-147">同期が Windows 同期マネージャーの外部で (スケジュールされた同期、または SQL Server Management Studio かレプリケーション モニターでの要求時同期として) 実行される場合、アーティクルに指定された既定の競合回避を使用して、ユーザーの介入なしに自動的に競合が解決されます。</span><span class="sxs-lookup"><span data-stu-id="21068-147">If a synchronization is performed outside of Windows Synchronization Manager (as a scheduled synchronization or an on demand synchronization in SQL Server Management Studio or Replication Monitor), conflicts are resolved automatically without user intervention, using the default conflict resolution specified for the article.</span></span> <span data-ttu-id="21068-148">詳細については、「 [Interactive Conflict Resolution](../merge/advanced-merge-replication-conflict-interactive-resolution.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-148">For more information, see [Interactive Conflict Resolution](../merge/advanced-merge-replication-conflict-interactive-resolution.md).</span></span>  
  
###  <a name="using-sql-server-management-studio"></a><span data-ttu-id="21068-149">SQL Server Management Studio を使用する</span><span class="sxs-lookup"><span data-stu-id="21068-149">Using SQL Server Management Studio</span></span>  
  
#### <a name="enable-interactive-conflict-resolution-for-an-article"></a><span data-ttu-id="21068-150">アーティクルに対するインタラクティブな競合解決の有効化</span><span class="sxs-lookup"><span data-stu-id="21068-150">Enable interactive conflict resolution for an article</span></span>  
  
1.  <span data-ttu-id="21068-151">パブリケーションの新規作成ウィザードの **[アーティクル]** ページまたは **[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスで、テーブルを選択します。</span><span class="sxs-lookup"><span data-stu-id="21068-151">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table.</span></span> <span data-ttu-id="21068-152">ウィザードの使用およびダイアログ ボックスへのアクセスの詳細については、「[パブリケーションの作成](create-a-publication.md)」および「[View and Modify Publication Properties](view-and-modify-publication-properties.md)」 (パブリケーション プロパティの表示および変更) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-152">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>    
2.  <span data-ttu-id="21068-153">**[アーティクルのプロパティ]** をクリックし、次に **[反転表示されたテーブル アーティクルのプロパティを設定]** または **[すべてのテーブル アーティクルのプロパティを設定]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21068-153">Click **Article Properties**, and then click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>    
3.  <span data-ttu-id="21068-154">**[アーティクルのプロパティ - \<Article>]** または **[アーティクルのプロパティ - \<ArticleType>]** ページで、 **[競合回避モジュール]** タブをクリックします。</span><span class="sxs-lookup"><span data-stu-id="21068-154">On the **Article Properties - \<Article>** or **Article Properties - \<ArticleType>** page, click the **Resolver** tab.</span></span>    
4.  <span data-ttu-id="21068-155">**[要求時同期中にサブスクライバーが対話的に競合を解決することを許可する]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="21068-155">Select **Allow Subscriber to resolve conflicts interactively during on-demand synchronization**.</span></span>    
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]    
6.  <span data-ttu-id="21068-156">**[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスが表示されている場合は、 **[OK]** をクリックして保存し、ダイアログ ボックスを閉じます。</span><span class="sxs-lookup"><span data-stu-id="21068-156">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-specify-that-a-subscription-should-use-interactive-conflict-resolution"></a><span data-ttu-id="21068-157">サブスクリプションでインタラクティブな競合解決を使用するように指定するには</span><span class="sxs-lookup"><span data-stu-id="21068-157">To specify that a subscription should use interactive conflict resolution</span></span>  
  
1.  <span data-ttu-id="21068-158">**[サブスクリプションのプロパティ - \<Subscriber>: \<SubscriptionDatabase>]** ダイアログ ボックスで、 **[競合を対話的に解決]** オプションに対して **[True]** の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-158">In the **Subscription Properties - \<Subscriber>: \<SubscriptionDatabase>** dialog box, specify a value of **True** for the **Resolve conflicts interactively** option.</span></span> <span data-ttu-id="21068-159">このダイアログ ボックスへのアクセスの詳細については、「 [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) 」および「 [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-159">For more information about accessing this dialog box, see [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) and [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md).</span></span> 
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
### <a name="using-transact-sql"></a><span data-ttu-id="21068-160">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="21068-160">Using Transact-SQL</span></span>  
 <span data-ttu-id="21068-161">マージ パブリケーションに対するプル サブスクリプションが作成されるときに、サブスクライバーがこのグラフィカル インターフェイスを使用してアーティクルの競合を回避するように、プログラムで指定できます。</span><span class="sxs-lookup"><span data-stu-id="21068-161">You can programmatically specify that a Subscriber will use this graphical interface to resolve article conflicts when a pull subscription to a merge publication is created.</span></span> <span data-ttu-id="21068-162">このオプションをサポートするアーティクル内の競合のみが、インタラクティブ競合回避モジュールに表示されます。</span><span class="sxs-lookup"><span data-stu-id="21068-162">Only conflicts in articles that support this option will be displayed in the Interactive Resolver.</span></span>  
  
#### <a name="create-a-merge-pull-subscription-that-uses-the-interactive-resolver"></a><span data-ttu-id="21068-163">インタラクティブ競合回避モジュールを使用するマージ プル サブスクリプションの作成</span><span class="sxs-lookup"><span data-stu-id="21068-163">Create a merge pull subscription that uses the Interactive Resolver</span></span>  
  
1.  <span data-ttu-id="21068-164">パブリッシャー側のパブリケーションデータベースに対して[sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql)を実行し、 \*\* \@ パブリケーション\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-164">At the Publisher on the publication database, execute [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="21068-165">インタラクティブ競合回避モジュールが使用される結果セット内の各アーティクルに対する **allow_interactive_resolver** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="21068-165">Note the value of **allow_interactive_resolver** for each article in the result set for which the Interactive Resolver will be used.</span></span>    
    -   <span data-ttu-id="21068-166">この値が **1**の場合、インタラクティブ競合回避モジュールが使用されます。</span><span class="sxs-lookup"><span data-stu-id="21068-166">If this value is **1**, the Interactive Resolver will be used.</span></span>    
    -   <span data-ttu-id="21068-167">この値が **0**の場合は、最初に、各アーティクルに対してインタラクティブ競合回避モジュールを有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-167">If this value is **0**, you must first enable the Interactive Resolver for each article.</span></span> <span data-ttu-id="21068-168">これを行うには[、sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)を実行して、 \*\* \@ パブリケーション**、 \*\* \@ アーティクル**、 \*\* \@ プロパティ**の**allow_interactive_resolver**の値、および値に**true**を指定** \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="21068-168">To do this, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **\@publication**, **\@article**, a value of **allow_interactive_resolver** for **\@property**, and a value of **true** for **\@value**.</span></span>    
2.  <span data-ttu-id="21068-169">サブスクライバー側のサブスクリプション データベースに対して、 [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-169">At the Subscriber on the subscription database, execute [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="21068-170">詳細については、「 [プル サブスクリプションの作成](../create-a-pull-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="21068-170">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>    
3.  <span data-ttu-id="21068-171">サブスクライバー側のサブスクリプション データベースに対し、次のパラメーターを指定して [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-171">At the Subscriber on the subscription database, execute [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="21068-172">\*\* \@ パブリッシャー**、 \*\* \@ publisher_db** (パブリッシュされたデータベース)、および\*\* \@ パブリケーション\*\*。</span><span class="sxs-lookup"><span data-stu-id="21068-172">**\@publisher**, **\@publisher_db** (the published database), and **\@publication**.</span></span>    
    -   <span data-ttu-id="21068-173">\*\* \@ Enabled_for_syncmgr**の場合は**true\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-173">A value of **true** for **\@enabled_for_syncmgr**.</span></span>    
    -   <span data-ttu-id="21068-174">\*\* \@ Use_interactive_resolver**の場合は**true\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-174">A value of **true** for **\@use_interactive_resolver**.</span></span>    
    -   <span data-ttu-id="21068-175">マージ エージェントが必要とするセキュリティ アカウント情報。</span><span class="sxs-lookup"><span data-stu-id="21068-175">The security account information required by the Merge Agent.</span></span> <span data-ttu-id="21068-176">詳細については、「 [プル サブスクリプションの作成](../create-a-pull-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="21068-176">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>    
4.  <span data-ttu-id="21068-177">パブリッシャー側のパブリケーション データベースに対し、 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-177">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span>  
  
#### <a name="define-an-article-that-supports-the-interactive-resolver"></a><span data-ttu-id="21068-178">インタラクティブ競合回避モジュールをサポートするアーティクルの定義</span><span class="sxs-lookup"><span data-stu-id="21068-178">Define an article that supports the Interactive Resolver</span></span>  
  
<span data-ttu-id="21068-179">パブリッシャー側のパブリケーション データベースに対して、 [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-179">At the Publisher on the publication database, execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="21068-180">\*\* \@ パブリケーション**のアーティクルが属しているパブリケーションの名前、 \*\* \@ アーティクルのアーティクルの名前、** \*\* \@ source_object**にパブリッシュするデータベースオブジェクト、 \*\* \@ allow_interactive_resolver**の値に**true**を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-180">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, and a value of **true** for **\@allow_interactive_resolver**.</span></span> <span data-ttu-id="21068-181">詳しくは、「 [アーティクルを定義](define-an-article.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="21068-181">For more information, see [Define an Article](define-an-article.md).</span></span>  

## <a name="specify-the-conflict-tracking-and-resolution-level"></a><span data-ttu-id="21068-182">競合の追跡と解決のレベルを指定します</span><span class="sxs-lookup"><span data-stu-id="21068-182">Specify the Conflict Tracking and Resolution Level</span></span> 
<span data-ttu-id="21068-183">マージ パブリケーションへのサブスクリプションを同期する際、パブリッシャーとサブスクライバーの同じデータに加えられた変更によって、競合が発生していないかどうかがレプリケーション時に確認されます。</span><span class="sxs-lookup"><span data-stu-id="21068-183">When a subscription to a merge publication is synchronized, replication checks for conflicts caused by changes to the same data made at both the Publisher and the Subscriber.</span></span> <span data-ttu-id="21068-184">競合を行レベルで検出するか (行に加えられたすべての変更が競合と見なされます)、列レベルで検出するか (同じ行と列に対する変更のみが競合と見なされます) を指定できます。</span><span class="sxs-lookup"><span data-stu-id="21068-184">You can specify whether conflicts are detected at the row-level, where any change to the row is considered a conflict, or column-level, where only changes to the same row and column are considered a conflict.</span></span> <span data-ttu-id="21068-185">アーティクルの競合解決は行レベルで実行されます。</span><span class="sxs-lookup"><span data-stu-id="21068-185">Conflict resolution for articles is performed at the row-level.</span></span> <span data-ttu-id="21068-186">論理レコードが使用される場合の競合の検出と解決の詳細については、「 [Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-186">For more information about conflict detection and resolution when logical records are used, see [Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>  
  

  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="21068-187">制限事項と制約事項</span><span class="sxs-lookup"><span data-stu-id="21068-187">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="21068-188">サブスクリプションを初期化した後で追跡レベルを変更した場合は、サブスクリプションを再初期化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-188">If you modify the tracking level after subscriptions have been initialized, those subscriptions must be reinitialized.</span></span> <span data-ttu-id="21068-189">プロパティ変更の影響の詳細については、「[パブリケーションおよびアーティクルのプロパティの変更](../publish/change-publication-and-article-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-189">For more information about the effects of property changes, see [Change Publication and Article Properties](../publish/change-publication-and-article-properties.md).</span></span>    
-   <span data-ttu-id="21068-190">行レベルおよび列レベルの追跡では、行レベルでの競合回避は常に実行されます。優先されなかった行が優先された行で上書きされます。</span><span class="sxs-lookup"><span data-stu-id="21068-190">With row- and column-level tracking, conflict resolution is always performed at the row-level: the winning row overwrites the losing row.</span></span> <span data-ttu-id="21068-191">マージ レプリケーションでは、論理レコード レベルでの競合の追跡と回避も指定できますが、このオプションは [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]にはありません。</span><span class="sxs-lookup"><span data-stu-id="21068-191">Merge replication also allows you to specify that conflicts be tracked and resolved at the logical record level, but these options are not available from [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="21068-192">レプリケーション ストアド プロシージャからこのオプションを設定する方法については、「 [マージ テーブル アーティクル間に論理レコード リレーションシップを定義する](../publish/define-a-logical-record-relationship-between-merge-table-articles.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-192">For information about setting these options from replication stored procedures, see [Define a Logical Record Relationship Between Merge Table Articles](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span></span>  
  
###  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="21068-193">SQL Server Management Studio の使用</span><span class="sxs-lookup"><span data-stu-id="21068-193">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="21068-194">**[アーティクルのプロパティ]** ダイアログ ボックスの **[プロパティ]** タブで、マージ アーティクルに対する行レベルまたは列レベルの追跡を指定します。このダイアログ ボックスは、パブリケーションの新規作成ウィザードおよび **[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスで使用できます。</span><span class="sxs-lookup"><span data-stu-id="21068-194">Specify row- or column-level tracking for merge articles on the **Properties** tab of the **Article Properties** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="21068-195">ウィザードの使用およびダイアログ ボックスへのアクセスの詳細については、「[パブリケーションの作成](create-a-publication.md)」および「[View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md)」 (パブリケーション プロパティの表示および変更) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-195">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="specify-row--or-column-level-tracking"></a><span data-ttu-id="21068-196">行レベルまたは列レベルの追跡の指定</span><span class="sxs-lookup"><span data-stu-id="21068-196">Specify row- or column-level tracking</span></span>  
  
1.  <span data-ttu-id="21068-197">パブリケーションの新規作成ウィザードの **[アーティクル]** ページまたは **[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスで、テーブルを選択します。</span><span class="sxs-lookup"><span data-stu-id="21068-197">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table.</span></span>    
2.  <span data-ttu-id="21068-198">**[アーティクルのプロパティ]** をクリックし、次に **[反転表示されたテーブル アーティクルのプロパティを設定]** または **[すべてのテーブル アーティクルのプロパティを設定]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="21068-198">Click **Article Properties**, and then click **Set Properties of Highlighted Table Article** or **Set Properties of All Table Articles**.</span></span>   
3.  <span data-ttu-id="21068-199">**[アーティクルのプロパティ - \<Article>]** ダイアログ ボックスの **[プロパティ]** タブで、 **[追跡レベル]** プロパティの値として **[行レベルの追跡]** または **[列レベルの追跡]** のいずれかを選択します。</span><span class="sxs-lookup"><span data-stu-id="21068-199">On the **Properties** tab of the **Article Properties \<Article>** dialog box, select one of the following values for the **Tracking level** property: **Row-level tracking** or **Column-level tracking**.</span></span>    
4.  <span data-ttu-id="21068-200">**[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスが表示されている場合は、 **[OK]** をクリックして保存し、ダイアログ ボックスを閉じます。</span><span class="sxs-lookup"><span data-stu-id="21068-200">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
###  <a name="using-transact-sql"></a><span data-ttu-id="21068-201">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="21068-201">Using Transact-SQL</span></span>  
  
#### <a name="specify-conflict-tracking-options-for-a-new-merge-article"></a><span data-ttu-id="21068-202">新しいマージアーティクルの競合追跡オプションを指定します</span><span class="sxs-lookup"><span data-stu-id="21068-202">Specify conflict tracking options for a new merge article</span></span>  
  
1.  <span data-ttu-id="21068-203">パブリッシャー側のパブリケーションデータベースに対して[sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql)を実行し、 \*\* \@ column_tracking\*\*に対して次のいずれかの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-203">At the Publisher on the publication database, execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) and specify one of the following values for **\@column_tracking**:</span></span>  
  
    -   <span data-ttu-id="21068-204">**true** - アーティクルに対して列レベルの追跡を使用します。</span><span class="sxs-lookup"><span data-stu-id="21068-204">**true** - Use column-level tracking for the article.</span></span>    
    -   <span data-ttu-id="21068-205">**false** - 既定の行レベルの追跡を使用します。</span><span class="sxs-lookup"><span data-stu-id="21068-205">**false** - Use row-level tracking, which is the default.</span></span>  
  
#### <a name="change-conflict-tracking-options-for-a-merge-article"></a><span data-ttu-id="21068-206">マージ アーティクルの競合追跡オプションの変更</span><span class="sxs-lookup"><span data-stu-id="21068-206">Change conflict tracking options for a merge article</span></span>  
  
1.  <span data-ttu-id="21068-207">マージ アーティクルの競合追跡オプションを定義するには、 [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-207">To determine the conflict tracking options for a merge article, execute [sp_helpmergearticle](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span></span> <span data-ttu-id="21068-208">アーティクルの結果セットの **column_tracking** オプションの値を調べます。</span><span class="sxs-lookup"><span data-stu-id="21068-208">Note the value of the **column_tracking** option in the result set for the article.</span></span> <span data-ttu-id="21068-209">値 **1** は、列レベルの追跡が使用されていることを示します。値 **0** は、行レベルの追跡が使用されていることを示します。</span><span class="sxs-lookup"><span data-stu-id="21068-209">A value of **1** means that column-level tracking is being used, and a value of **0** means that row-level tracking is being used.</span></span>    
2.  <span data-ttu-id="21068-210">パブリッシャー側のパブリケーション データベースに対して、 [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-210">At the Publisher on the publication database, execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="21068-211">[ \*\* \@ プロパティ**] には**column_tracking**の値を指定し、[ \*\* \@ 値**] には次のいずれかの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-211">Specify a value of **column_tracking** for **\@property** and one of the following values for **\@value**:</span></span>
    -   <span data-ttu-id="21068-212">**true** - アーティクルに対して列レベルの追跡を使用します。</span><span class="sxs-lookup"><span data-stu-id="21068-212">**true** - Use column-level tracking for the article.</span></span>
    -   <span data-ttu-id="21068-213">**false** - 既定の行レベルの追跡を使用します。</span><span class="sxs-lookup"><span data-stu-id="21068-213">**false** - Use row-level tracking, which is the default.</span></span>  
  
     <span data-ttu-id="21068-214">\*\* \@ Force_invalidate_snapshot**と** \@ force_reinit_subscription**の両方に**1\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-214">Specify a value of **1** for both **\@force_invalidate_snapshot** and **\@force_reinit_subscription**.</span></span>  

## <a name="tracking-deletes"></a><span data-ttu-id="21068-215">削除の追跡</span><span class="sxs-lookup"><span data-stu-id="21068-215">Tracking deletes</span></span>

> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
 <span data-ttu-id="21068-216">既定では、マージ レプリケーションではパブリッシャーとサブスクライバーの DELETE コマンドが同期されます。</span><span class="sxs-lookup"><span data-stu-id="21068-216">By default, merge replication synchronizes DELETE commands between the Publisher and Subscriber.</span></span> <span data-ttu-id="21068-217">マージ レプリケーションを使用すると、行がパブリケーションから削除されても、サブスクリプション データベースでその行を保持できます。その逆の操作も可能です。</span><span class="sxs-lookup"><span data-stu-id="21068-217">Merge replication enables you to retain rows in the subscription database even when they have been deleted from the publication, and vice versa.</span></span> <span data-ttu-id="21068-218">新しいアーティクルを作成するときに DELETE コマンドを無視するようにプログラムで指定したり、レプリケーション ストアド プロシージャを使用してこの機能を後で有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="21068-218">You can programmatically specify that DELETE commands be ignored when creating a new article or you can enable this functionality at a later time using replication stored procedures.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="21068-219">この機能を有効にすると、データが収束しなくなります。つまり、サブスクライバーに存在するデータにパブリッシャーのデータが正確に反映されなくなります。</span><span class="sxs-lookup"><span data-stu-id="21068-219">Enabling this functionality will result in non-convergence, which means that data present at the Subscriber will not accurately reflect data at the Publisher.</span></span> <span data-ttu-id="21068-220">削除された行を手動で削除するためのメカニズムを独自に実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-220">You must implement your own mechanism for manually removing deleted rows.</span></span>  
  
### <a name="specify-that-deletes-be-ignored-for-a-new-merge-article"></a><span data-ttu-id="21068-221">新しいマージ アーティクルで削除を無視する指定</span><span class="sxs-lookup"><span data-stu-id="21068-221">Specify that deletes be ignored for a new merge article</span></span>  
  
1.  <span data-ttu-id="21068-222">パブリッシャー側のパブリケーション データベースに対して、[sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-222">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="21068-223">Delete_tracking には、の値を指定し `false` ます。 \*\* \@ \*\*</span><span class="sxs-lookup"><span data-stu-id="21068-223">Specify a value of `false` for **\@delete_tracking**.</span></span> <span data-ttu-id="21068-224">詳しくは、「 [アーティクルを定義](../publish/define-an-article.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="21068-224">For more information, see [Define an Article](../publish/define-an-article.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="21068-225">アーティクルのソース テーブルが別のパブリケーションで既にパブリッシュされている場合、両方のアーティクルで **delete_tracking** の値を同じにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-225">If the source table for an article is already published in another publication, the value of **delete_tracking** must be the same for both articles.</span></span>  
  
### <a name="specify-that-deletes-be-ignored-for-an-existing-merge-article"></a><span data-ttu-id="21068-226">既存のマージ アーティクルで削除を無視する指定</span><span class="sxs-lookup"><span data-stu-id="21068-226">Specify that deletes be ignored for an existing merge article</span></span>  
  
1.  <span data-ttu-id="21068-227">アーティクルでエラー補正が有効になっているかどうかを確認するために、[sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) を実行して、結果セット内の **delete_tracking** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="21068-227">To determine if error compensation is enabled for an article, execute [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) and note the value of **delete_tracking** in the result set.</span></span> <span data-ttu-id="21068-228">値が **0**の場合、削除は既に無視されています。</span><span class="sxs-lookup"><span data-stu-id="21068-228">If this value is **0**, deletes are already being ignored.</span></span>    
2.  <span data-ttu-id="21068-229">手順 1. で得た値が **1** だった場合、パブリッシャー側のパブリケーション データベースに対して [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-229">If the value from step 1 is **1**, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="21068-230">[ \*\* \@ プロパティ**] には**delete_tracking**の値を、[値] には値を指定し `false` ます** \@ \*\*。</span><span class="sxs-lookup"><span data-stu-id="21068-230">Specify a value of **delete_tracking** for **\@property**, and a value of `false` for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="21068-231">アーティクルのソース テーブルが別のパブリケーションで既にパブリッシュされている場合、両方のアーティクルで **delete_tracking** の値を同じにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-231">If the source table for an article is already published in another publication, the value of **delete_tracking** must be the same for both articles.</span></span>  
  
## <a name="processing-order"></a><span data-ttu-id="21068-232">処理順序</span><span class="sxs-lookup"><span data-stu-id="21068-232">Processing Order</span></span>
  <span data-ttu-id="21068-233">マージ レプリケーションでは、同期処理中にアーティクルをマージ エージェントで処理する順序を指定できます。</span><span class="sxs-lookup"><span data-stu-id="21068-233">Merge replication enables you to specify the order in which articles are processed by the Merge Agent during the synchronization process.</span></span> <span data-ttu-id="21068-234">この順序は、レプリケーションのストアド プロシージャを使用して、アーティクル作成時に各アーティクルに対してプログラムから割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="21068-234">You can assign an order to each article programmatically when creating an article using replication stored procedures.</span></span> <span data-ttu-id="21068-235">アーティクルは、最も小さい値から最も大きい値の順序で処理されます。</span><span class="sxs-lookup"><span data-stu-id="21068-235">Articles are processed in order from lowest to highest value.</span></span> <span data-ttu-id="21068-236">2 つのアーティクルの値が同じ場合、それらは同時に処理されます。</span><span class="sxs-lookup"><span data-stu-id="21068-236">If two articles have the same value, they are processed concurrently.</span></span> <span data-ttu-id="21068-237">詳細については、「[Specify Merge Replication properties](../publish/specify-merge-replication-properties.md)」 (マージ レプリケーションのプロパティの指定) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21068-237">For more information, see [Specify Merge Replication properties](../publish/specify-merge-replication-properties.md).</span></span>  

  <span data-ttu-id="21068-238">以降では [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 、マージパブリケーションのアーティクルの既定の処理順序を上書きすることができます。</span><span class="sxs-lookup"><span data-stu-id="21068-238">Beginning with [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], it is possible to override the default order of article processing for merge publications.</span></span> <span data-ttu-id="21068-239">これは、たとえば、トリガーを使用して参照整合性を定義し、これらのトリガーを特定の順序で起動する必要がある場合に便利です。</span><span class="sxs-lookup"><span data-stu-id="21068-239">This is useful, for example, if you define referential integrity through triggers and those triggers must fire in a certain order.</span></span> 

### <a name="how-processing-order-is-determined"></a><span data-ttu-id="21068-240">処理順序を決定する方法</span><span class="sxs-lookup"><span data-stu-id="21068-240">How Processing Order is Determined</span></span>  
 <span data-ttu-id="21068-241">マージ同期の際、既定ではアーティクルがオブジェクト間の依存関係で必要な順序で処理されます。依存関係には、ベース テーブルに対して定義されている宣言参照整合性 (DRI) 制約も含まれます。</span><span class="sxs-lookup"><span data-stu-id="21068-241">During merge synchronization, articles are, by default, processed in the order required by the dependencies between objects, including the declarative referential integrity (DRI) constraints defined on the base tables.</span></span> <span data-ttu-id="21068-242">同期処理では、テーブルに対する変更が列挙された後で、これらの変更が適用されます。</span><span class="sxs-lookup"><span data-stu-id="21068-242">Processing involves enumerating the changes to a table and then applying those changes.</span></span> <span data-ttu-id="21068-243">DRI が定義されておらず、テーブル アーティクル間に結合フィルターか論理レコードが存在する場合、フィルターや論理レコードで必要な順序でアーティクルが処理されます。</span><span class="sxs-lookup"><span data-stu-id="21068-243">If no DRI is present but join filters or logical records exist between table articles, the articles are processed in the order required by the filters and logical records.</span></span> <span data-ttu-id="21068-244">DRI、結合フィルター、論理レコード、またはその他の依存関係で他のアーティクルと関係付けられていないアーティクルは、システム テーブル [sysmergearticles &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/sysmergearticles-transact-sql) 内のアーティクル ニックネームに従って処理されます。</span><span class="sxs-lookup"><span data-stu-id="21068-244">Articles not related to any other article through DRI, join filters, logical records, or other dependencies are processed according to the article nickname in the [sysmergearticles &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/sysmergearticles-transact-sql) system table.</span></span>  
  
 <span data-ttu-id="21068-245">パブリケーションに **SalesOrderHeader** テーブルと **SalesOrderDetail** テーブルが含まれており、 **SalesOrderHeader** テーブルには主キー列 **SalesOrderID** があり、 **SalesOrderDetail** テーブルには対応する外部キー列 **SalesOrderID** があるとします。</span><span class="sxs-lookup"><span data-stu-id="21068-245">Consider a publication that includes the tables **SalesOrderHeader** and **SalesOrderDetail** with a primary key column **SalesOrderID** in the **SalesOrderHeader** table and a corresponding foreign key column **SalesOrderID** in the **SalesOrderDetail** table.</span></span> <span data-ttu-id="21068-246">同期の際、マージ レプリケーションでは、新しい行を **SalesOrderHeader** に挿入してから関連する行を **SalesOrderDetail**に挿入することで、外部キーの違反を防ぎます。</span><span class="sxs-lookup"><span data-stu-id="21068-246">During synchronization, merge replication prevents foreign key violations by inserting any new rows in **SalesOrderHeader** before inserting associated rows in **SalesOrderDetail**.</span></span> <span data-ttu-id="21068-247">同様に、 **SalesOrderDetail** から行を削除した後で、関連する行を **SalesOrderHeader**から削除します。</span><span class="sxs-lookup"><span data-stu-id="21068-247">Similarly, rows are deleted from **SalesOrderDetail** before the associated row is deleted from **SalesOrderHeader**.</span></span>  
  
 <span data-ttu-id="21068-248">ただし、アプリケーションによっては、DRI ではなくデータベース トリガーやアプリケーション レベルで参照整合性が設定されます。</span><span class="sxs-lookup"><span data-stu-id="21068-248">However, in some applications referential integrity is enforced through database triggers, or at the application level, rather than through DRI.</span></span> <span data-ttu-id="21068-249">上記のようなパブリケーションでは、DRI ではなく **SalesOrderDetail** テーブルの挿入トリガーによって、挿入を許可する前に、 **SalesOrderHeader** テーブルに関連する行があることを確認できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="21068-249">Given the publication described above, instead of DRI, the **SalesOrderDetail** table could have an insert trigger that ensures the associated row in the **SalesOrderHeader** table exists before allowing an insert.</span></span> <span data-ttu-id="21068-250">**SalesOrderHeader** の削除トリガーでは、削除を許可する前に、 **SalesOrderDetail** に関連する行がないことを確認できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="21068-250">**SalesOrderHeader** could have a delete trigger that ensures there are no associated rows in **SalesOrderDetail** before allowing a delete.</span></span> <span data-ttu-id="21068-251">マージ レプリケーションでは、アーティクルの処理順序を決定する際にトリガーは考慮されません。トリガーが起動されないとその結果がどのようになるかがわからないためです。</span><span class="sxs-lookup"><span data-stu-id="21068-251">Merge replication does not take into account triggers when determining processing order of articles because it cannot determine what the result of the trigger will be until it has fired.</span></span> <span data-ttu-id="21068-252">同様に、アプリケーション レベルで定義された制約も考慮されません。</span><span class="sxs-lookup"><span data-stu-id="21068-252">Similarly, replication cannot take into account constraints defined at the application level.</span></span>  
  
 <span data-ttu-id="21068-253">トリガーやアプリケーション レベルで参照整合性を保つ場合は、アーティクルの処理順序を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21068-253">When referential integrity is maintained through triggers or at the application level, you should specify the order in which the articles should be processed.</span></span> <span data-ttu-id="21068-254">トリガーの例では、アーティクルの順序が挿入の順序で決まるため、 **SalesOrderHeader** テーブルを **SalesOrderDetail**の前に処理するように指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-254">In the example with triggers, you would specify that the **SalesOrderHeader** table should be processed before **SalesOrderDetail**, because article ordering is based on insert order.</span></span> <span data-ttu-id="21068-255">マージ レプリケーションでは、削除の場合、自動的に順序が逆になります。</span><span class="sxs-lookup"><span data-stu-id="21068-255">Merge replication will automatically reverse the order for deletes.</span></span> <span data-ttu-id="21068-256">アーティクルの順序がなくてもマージ レプリケーションは失敗しません。これは、制約違反が発生してもマージ エージェントで処理が継続され、他のアーティクルの処理を終えた後で操作が再試行されるためです。</span><span class="sxs-lookup"><span data-stu-id="21068-256">Merge replication will not fail without article ordering, because the Merge Agent continues to process articles if a constraint violation occurs; it then retries any operations that failed after other articles have been processed.</span></span> <span data-ttu-id="21068-257">アーティクルの順序を指定すると、再試行とそれに付随する追加の処理が不要になります。</span><span class="sxs-lookup"><span data-stu-id="21068-257">Specifying article order simply avoids retries and the additional processing associated with them.</span></span> <span data-ttu-id="21068-258">誤った順序 (詳細レコードがヘッダー レコードの前に処理されるような順序など) を指定すると、マージ レプリケーションは成功するまで処理を再試行します。</span><span class="sxs-lookup"><span data-stu-id="21068-258">If you specify an incorrect order (for example, one that results in detail records being processed before header records), merge replication will retry processing until it succeeds.</span></span>  

### <a name="new-article"></a><span data-ttu-id="21068-259">新しい記事</span><span class="sxs-lookup"><span data-stu-id="21068-259">New Article</span></span>
  
1.  <span data-ttu-id="21068-260">パブリッシャー側のパブリケーション データベースに対して、[sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-260">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="21068-261">\*\* \@ Processing_order\*\*のアーティクルの処理順序を表す整数値を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-261">Specify an integer value that represents the processing order for the article for **\@processing_order**.</span></span> <span data-ttu-id="21068-262">詳しくは、「 [アーティクルを定義](define-an-article.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="21068-262">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="21068-263">処理順序を指定してアーティクルを作成する場合は、アーティクルの順序を表す値の間に、ある程度の間隔を設けるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="21068-263">When creating ordered articles, you should leave gaps between the article order values.</span></span> <span data-ttu-id="21068-264">こうすることで、後で、新しい値を設定するときに作業が楽になります。</span><span class="sxs-lookup"><span data-stu-id="21068-264">This makes it easier to set new values in the future.</span></span> <span data-ttu-id="21068-265">たとえば、3つの記事で固定処理順序を指定する必要がある場合は、それぞれ1、2、3ではなく、 \*\* \@ processing_order\*\*の値を10、20、および30に設定します。</span><span class="sxs-lookup"><span data-stu-id="21068-265">For example, if you have three articles for which you need to specify a fixed processing order, set the value of **\@processing_order** to 10, 20, and 30 rather than 1, 2, and 3, respectively.</span></span>  
  
### <a name="existing-article"></a><span data-ttu-id="21068-266">既存のアーティクル</span><span class="sxs-lookup"><span data-stu-id="21068-266">Existing article</span></span>
  
1.  <span data-ttu-id="21068-267">アーティクルの処理順序を指定するには、[sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) を実行し、結果セットの **processing_order** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="21068-267">To determine processing order of an article, execute [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql) and note the value of **processing_order** in the result set.</span></span>  
  
2.  <span data-ttu-id="21068-268">パブリッシャー側のパブリケーション データベースに対して、[sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="21068-268">At the Publisher on the publication database, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="21068-269">[ \*\* \@ プロパティ**] に値**processing_order**を指定し、[ \*\* \@ 値**] の処理順序を表す整数値を指定します。</span><span class="sxs-lookup"><span data-stu-id="21068-269">Specify a value of **processing_order** for **\@property** and an integer value that represents the processing order for **\@value**.</span></span>  



## <a name="see-also"></a><span data-ttu-id="21068-270">参照</span><span class="sxs-lookup"><span data-stu-id="21068-270">See Also</span></span>  
 [<span data-ttu-id="21068-271">条件付き削除の追跡によるマージ レプリケーション パフォーマンスの最適化</span><span class="sxs-lookup"><span data-stu-id="21068-271">Optimize Merge Replication Performance with Conditional Delete Tracking</span></span>](../merge/optimize-merge-replication-performance-with-conditional-delete-tracking.md)  
 <span data-ttu-id="21068-272">[論理レコードの競合の検出と解決](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md) </span><span class="sxs-lookup"><span data-stu-id="21068-272">[Detecting and Resolving Conflicts in Logical Records](../merge/advanced-merge-replication-conflict-resolving-in-logical-record.md) </span></span>  
 <span data-ttu-id="21068-273">[Define a Logical Record Relationship Between Merge Table Articles](define-a-logical-record-relationship-between-merge-table-articles.md) </span><span class="sxs-lookup"><span data-stu-id="21068-273">[Define a Logical Record Relationship Between Merge Table Articles](define-a-logical-record-relationship-between-merge-table-articles.md) </span></span>  
 <span data-ttu-id="21068-274">[マージレプリケーションの競合の検出と解決](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="21068-274">[Detect and Resolve Merge Replication Conflicts](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 <span data-ttu-id="21068-275">[ダウンロード専用アーティクルを使用したマージ レプリケーションのパフォーマンス最適化](../merge/optimize-merge-replication-performance-with-download-only-articles.md) </span><span class="sxs-lookup"><span data-stu-id="21068-275">[Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md) </span></span>  
 <span data-ttu-id="21068-276">[Define an Article](define-an-article.md) </span><span class="sxs-lookup"><span data-stu-id="21068-276">[Define an Article](define-an-article.md) </span></span>  
 [<span data-ttu-id="21068-277">アーティクルのプロパティの表示と変更</span><span class="sxs-lookup"><span data-stu-id="21068-277">View and Modify Article Properties</span></span>](view-and-modify-article-properties.md)  