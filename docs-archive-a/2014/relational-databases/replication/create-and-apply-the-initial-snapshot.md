---
title: 初期スナップショットの作成および適用 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], creating
- snapshot replication [SQL Server], initial snapshots
ms.assetid: 742727a1-5189-44ec-b3ae-6fd7aa1f5347
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b7ac008fe139adf55376bb50fbf60dddcd6b9ae5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87632399"
---
# <a name="create-and-apply-the-initial-snapshot"></a><span data-ttu-id="41511-102">初期スナップショットの作成および適用</span><span class="sxs-lookup"><span data-stu-id="41511-102">Create and Apply the Initial Snapshot</span></span>
  <span data-ttu-id="41511-103">このトピックでは、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] で [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]、 [!INCLUDE[tsql](../../includes/tsql-md.md)]、またはレプリケーション管理オブジェクト (RMO) を使用して、初期スナップショットを作成および適用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="41511-103">This topic describes how to create and apply the initial snapshot in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="41511-104">パラメーター化されたフィルターを使用するマージ パブリケーションでは、2 つの部分から成るスナップショットが必要です。</span><span class="sxs-lookup"><span data-stu-id="41511-104">Merge publications that use parameterized filters require a two-part snapshot.</span></span> <span data-ttu-id="41511-105">詳しくは、「 [パラメーター化されたフィルターを使用したパブリケーションのスナップショットの作成](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="41511-105">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
 <span data-ttu-id="41511-106">**このトピックの内容**</span><span class="sxs-lookup"><span data-stu-id="41511-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="41511-107">**初期スナップショットを作成および適用するために使用するもの:**</span><span class="sxs-lookup"><span data-stu-id="41511-107">**To create and apply the initial snapshot, using:**</span></span>  
  
     [<span data-ttu-id="41511-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="41511-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="41511-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="41511-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="41511-110">レプリケーション管理オブジェクト (RMO)</span><span class="sxs-lookup"><span data-stu-id="41511-110">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="41511-111">SQL Server Management Studio の使用</span><span class="sxs-lookup"><span data-stu-id="41511-111">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="41511-112">既定では、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントが実行されている場合、パブリケーションの新規作成ウィザードでパブリケーションが作成された直後に、スナップショット エージェントによってスナップショットが生成されます。</span><span class="sxs-lookup"><span data-stu-id="41511-112">By default, if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is running, a snapshot is generated by the Snapshot Agent immediately after a publication is created with the New Publication Wizard.</span></span> <span data-ttu-id="41511-113">既定では、スナップショットはディストリビューション エージェント (スナップショット レプリケーションおよびトランザクション レプリケーションの場合) またはマージ エージェント (マージ サブスクリプションの場合) によって、すべてのサブスクリプションに対して適用されます。</span><span class="sxs-lookup"><span data-stu-id="41511-113">By default, it is then applied by the Distribution Agent (for snapshot and transactional replication) or Merge Agent (for merge subscriptions) for all subscriptions.</span></span> <span data-ttu-id="41511-114">スナップショットは、 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] およびレプリケーション モニターを使用して生成することもできます。</span><span class="sxs-lookup"><span data-stu-id="41511-114">A snapshot can also be generated using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and Replication Monitor.</span></span> <span data-ttu-id="41511-115">レプリケーション モニターの起動の詳細については、「[Start the Replication Monitor](monitor/start-the-replication-monitor.md)」 (レプリケーション モニターの開始) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41511-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span>  
  
#### <a name="to-create-a-snapshot-in-management-studio"></a><span data-ttu-id="41511-116">Management Studio でスナップショットを作成するには</span><span class="sxs-lookup"><span data-stu-id="41511-116">To create a snapshot in Management Studio</span></span>  
  
1.  <span data-ttu-id="41511-117">[!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]でパブリッシャーに接続し、サーバー ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="41511-117">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="41511-118">**[レプリケーション]** フォルダーを展開し、 **[ローカル パブリケーション]** フォルダーを展開します。</span><span class="sxs-lookup"><span data-stu-id="41511-118">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="41511-119">スナップショットを作成するパブリケーションを右クリックして、 **[スナップショット エージェントの状態の表示]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="41511-119">Right-click the publication for which you want to create a snapshot, and then click **View Snapshot Agent Status**.</span></span>  
  
4.  <span data-ttu-id="41511-120">**[スナップショット エージェントの状態の表示 - \<Publication>]** ダイアログ ボックスで **[開始]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="41511-120">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="41511-121">スナップショット エージェントによるスナップショットの生成が完了すると、"[100%] 17 個のアーティクルのスナップショットが生成されました。" などのメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="41511-121">When the Snapshot Agent finishes generating the snapshot, a message will be displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
#### <a name="to-create-a-snapshot-in-replication-monitor"></a><span data-ttu-id="41511-122">レプリケーション モニターでスナップショットを作成するには</span><span class="sxs-lookup"><span data-stu-id="41511-122">To create a snapshot in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="41511-123">レプリケーション モニターの左ペインでパブリッシャー グループを展開し、パブリッシャーを展開します。</span><span class="sxs-lookup"><span data-stu-id="41511-123">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="41511-124">スナップショットを生成するパブリケーションを右クリックして、 **[スナップショットの生成]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="41511-124">Right-click the publication for which you want to generate a snapshot, and then click **Generate Snapshot**.</span></span>  
  
3.  <span data-ttu-id="41511-125">スナップショット エージェントの状態を表示するには、 **[エージェント]** タブをクリックします。詳細情報については、グリッドでスナップショット エージェントを右クリックし、 **[詳細表示]** をクリックしてください。</span><span class="sxs-lookup"><span data-stu-id="41511-125">To view the status of the Snapshot Agent, click the **Agents** tab. For more detailed information, right-click the Snapshot Agent in the grid, and then click **View Details**.</span></span>  
  
#### <a name="to-apply-a-snapshot"></a><span data-ttu-id="41511-126">スナップショットを適用するには</span><span class="sxs-lookup"><span data-stu-id="41511-126">To apply a snapshot</span></span>  
  
1.  <span data-ttu-id="41511-127">生成したスナップショットは、ディストリビューション エージェントまたはマージ エージェントによるサブスクリプションの同期によって適用されます。</span><span class="sxs-lookup"><span data-stu-id="41511-127">After the snapshot is generated, it is applied by synchronizing the subscription with the Distribution Agent or the Merge Agent:</span></span>  
  
    -   <span data-ttu-id="41511-128">エージェントを連続して実行するように設定している場合 (トランザクション レプリケーションの既定の動作)、スナップショットは生成後に自動的に適用されます。</span><span class="sxs-lookup"><span data-stu-id="41511-128">If the agent is set to run continuously (the default for transactional replication), the snapshot is automatically applied after it is generated.</span></span>  
  
    -   <span data-ttu-id="41511-129">スケジュールに基づいてエージェントを実行するように設定している場合、スナップショットは、スケジュールによる次回のエージェント実行時に適用されます。</span><span class="sxs-lookup"><span data-stu-id="41511-129">If the agent is set to run on a schedule, the snapshot is applied the next time the agent is scheduled to run.</span></span>  
  
    -   <span data-ttu-id="41511-130">要求時にエージェントを実行するように設定している場合、スナップショットは、次回のエージェント実行時に適用されます。</span><span class="sxs-lookup"><span data-stu-id="41511-130">If the agent is set to run on demand, it is applied the next time you run the agent.</span></span>  
  
     <span data-ttu-id="41511-131">サブスクリプションの同期の詳細については、「 [Synchronize a Push Subscription](synchronize-a-push-subscription.md) 」および「 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md)ダイアログ ボックスを使用します。</span><span class="sxs-lookup"><span data-stu-id="41511-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="41511-132">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="41511-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="41511-133">初期スナップショットは、スナップショット エージェント ジョブを作成、実行するか、スナップショット エージェントの実行可能ファイルをバッチ ファイルから実行することによってプログラムから作成できます。</span><span class="sxs-lookup"><span data-stu-id="41511-133">Initial snapshots can be programmatically created either by creating and running a Snapshot Agent job or by running the Snapshot Agent executable file from a batch file.</span></span> <span data-ttu-id="41511-134">生成された初期スナップショットは、サブスクリプションの初回同期時にサブスクライバーに転送されて適用されます。</span><span class="sxs-lookup"><span data-stu-id="41511-134">After an initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="41511-135">スナップショット エージェントをコマンド プロンプトまたはバッチ ファイルから実行する場合、既存のスナップショットが無効になるたびにエージェントを再実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="41511-135">If you run the Snapshot Agent from a command prompt or a batch file, you will need to rerun the agent whenever the existing snapshot becomes invalid.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="41511-136">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="41511-136">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="41511-137">スクリプト ファイルに資格情報を格納する必要がある場合は、不正アクセスを防ぐために、ファイルを保護します。</span><span class="sxs-lookup"><span data-stu-id="41511-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-and-run-a-snapshot-agent-job-to-generate-the-initial-snapshot"></a><span data-ttu-id="41511-138">スナップショット エージェント ジョブを作成、実行して初期スナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="41511-138">To create and run a Snapshot Agent job to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="41511-139">スナップショット パブリケーション、トランザクション パブリケーション、またはマージ パブリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-139">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="41511-140">詳しくは、「 [パブリケーションを作成](publish/create-a-publication.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="41511-140">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="41511-141">[sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="41511-141">Execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="41511-142">**@publication**と次のパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-142">Specify **@publication** and the following parameters:</span></span>  
  
    -   <span data-ttu-id="41511-143">**ディストリビューターで実行するスナップショット エージェントが使用するための Windows 認証の資格情報を @job_login に指定します。**</span><span class="sxs-lookup"><span data-stu-id="41511-143">**The @job_login, which specifies** the Windows Authentication credentials under which the Snapshot Agent runs at the Distributor.</span></span>  
  
    -   <span data-ttu-id="41511-144">**Windows 資格情報に対応するパスワードを @job_password** に指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-144">**The @job_password**, which is the password for the supplied Windows credentials.</span></span>  
  
    -   <span data-ttu-id="41511-145">(省略可) エージェントからパブリッシャーへの接続に SQL Server 認証を使用する場合は、 **@publisher_security_mode** の値に **@publisher_security_mode** を指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-145">(Optional) A value of **0** for **@publisher_security_mode** if the agent will use SQL Server Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="41511-146">この場合は、およびに対して SQL Server 認証ログイン情報も指定する必要があり **@publisher_login** **@publisher_password** ます。</span><span class="sxs-lookup"><span data-stu-id="41511-146">In this case, you must also specify the SQL Server Authentication login information for **@publisher_login** and **@publisher_password**.</span></span>  
  
    -   <span data-ttu-id="41511-147">(省略可) スナップショット エージェント ジョブの同期スケジュールを指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-147">(Optional) A synchronization schedule for the Snapshot Agent job.</span></span> <span data-ttu-id="41511-148">詳細については、「 [Specify Synchronization Schedules](specify-synchronization-schedules.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41511-148">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="41511-149">リモート ディストリビューターを使用するパブリッシャーを構成する場合は、 *job_login* および *job_password*を含むすべてのパラメーターに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="41511-149">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="41511-150">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="41511-150">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="41511-151">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41511-151">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
3.  <span data-ttu-id="41511-152">パブリケーションにアーティクルを追加します。</span><span class="sxs-lookup"><span data-stu-id="41511-152">Add articles to the publication.</span></span> <span data-ttu-id="41511-153">詳しくは、「 [アーティクルを定義](publish/define-an-article.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="41511-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
4.  <span data-ttu-id="41511-154">パブリケーション データベースのパブリッシャーで [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql) を実行し、手順 1 の **@publication** の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-154">At the Publisher on the publication database, execute [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql), specifying the value of **@publication** from step 1.</span></span>  
  
#### <a name="to-run-the-snapshot-agent-to-generate-the-initial-snapshot"></a><span data-ttu-id="41511-155">スナップショット エージェントを実行して初期スナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="41511-155">To run the Snapshot Agent to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="41511-156">スナップショット パブリケーション、トランザクション パブリケーション、またはマージ パブリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-156">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="41511-157">詳しくは、「 [パブリケーションを作成](publish/create-a-publication.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="41511-157">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="41511-158">パブリケーションにアーティクルを追加します。</span><span class="sxs-lookup"><span data-stu-id="41511-158">Add articles to the publication.</span></span> <span data-ttu-id="41511-159">詳しくは、「 [アーティクルを定義](publish/define-an-article.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="41511-159">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
3.  <span data-ttu-id="41511-160">コマンド プロンプトまたはバッチ ファイルから、次のコマンド ライン引数を指定して [snapshot.exe](agents/replication-snapshot-agent.md) を実行し、 **レプリケーション マージ エージェント**を起動します。</span><span class="sxs-lookup"><span data-stu-id="41511-160">From the command prompt or in a batch file, start the [Replication Snapshot Agent](agents/replication-snapshot-agent.md) by running **snapshot.exe**, specifying the following command-line arguments:</span></span>  
  
    -   <span data-ttu-id="41511-161">**-Publication**</span><span class="sxs-lookup"><span data-stu-id="41511-161">**-Publication**</span></span>  
  
    -   <span data-ttu-id="41511-162">**-Publisher**</span><span class="sxs-lookup"><span data-stu-id="41511-162">**-Publisher**</span></span>  
  
    -   <span data-ttu-id="41511-163">**-Distributor**</span><span class="sxs-lookup"><span data-stu-id="41511-163">**-Distributor**</span></span>  
  
    -   <span data-ttu-id="41511-164">**-PublisherDB**</span><span class="sxs-lookup"><span data-stu-id="41511-164">**-PublisherDB**</span></span>  
  
    -   <span data-ttu-id="41511-165">**-ReplicationType**</span><span class="sxs-lookup"><span data-stu-id="41511-165">**-ReplicationType**</span></span>  
  
     <span data-ttu-id="41511-166">SQL Server 認証を使用する場合は、次の引数も指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="41511-166">If you are using SQL Server Authentication, you must also specify the following arguments:</span></span>  
  
    -   <span data-ttu-id="41511-167">**-DistributorLogin**</span><span class="sxs-lookup"><span data-stu-id="41511-167">**-DistributorLogin**</span></span>  
  
    -   <span data-ttu-id="41511-168">**-DistributorPassword**</span><span class="sxs-lookup"><span data-stu-id="41511-168">**-DistributorPassword**</span></span>  
  
    -   <span data-ttu-id="41511-169">**-DistributorSecurityMode** =  **\@publisher_security_mode**</span><span class="sxs-lookup"><span data-stu-id="41511-169">**-DistributorSecurityMode** = **0**</span></span>  
  
    -   <span data-ttu-id="41511-170">**-PublisherLogin**</span><span class="sxs-lookup"><span data-stu-id="41511-170">**-PublisherLogin**</span></span>  
  
    -   <span data-ttu-id="41511-171">**-PublisherPassword**</span><span class="sxs-lookup"><span data-stu-id="41511-171">**-PublisherPassword**</span></span>  
  
    -   <span data-ttu-id="41511-172">**-PublisherSecurityMode** =  **\@publisher_security_mode**</span><span class="sxs-lookup"><span data-stu-id="41511-172">**-PublisherSecurityMode** = **0**</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="41511-173">例 (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="41511-173">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="41511-174">次の例では、トランザクション パブリケーションを作成し、 **sqlcmd** スクリプト変数を使用して、新しいパブリケーション用にスナップショット エージェント ジョブを追加します。</span><span class="sxs-lookup"><span data-stu-id="41511-174">This example shows how to create a transactional publication and add a Snapshot Agent job for the new publication (using **sqlcmd** scripting variables).</span></span> <span data-ttu-id="41511-175">ジョブを開始するコードも含まれています。</span><span class="sxs-lookup"><span data-stu-id="41511-175">The example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_trangenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpubinitialsnapshot.sql#sp_trangenerate_snapshot)]  
  
 <span data-ttu-id="41511-176">次の例では、マージ パブリケーションを作成し、 **sqlcmd** 変数を使用して、そのパブリケーション用のスナップショット エージェント ジョブを追加します。</span><span class="sxs-lookup"><span data-stu-id="41511-176">This example creates a merge publication and adds a Snapshot Agent job (using **sqlcmd** variables) for the publication.</span></span> <span data-ttu-id="41511-177">ジョブを開始するコードも含まれています。</span><span class="sxs-lookup"><span data-stu-id="41511-177">This example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_mergegenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepubinitialsnapshot.sql#sp_mergegenerate_snapshot)]  
  
 <span data-ttu-id="41511-178">次のコマンド ライン引数は、スナップショット エージェントを起動して、マージ パブリケーション用のスナップショットを生成します。</span><span class="sxs-lookup"><span data-stu-id="41511-178">The following command-line arguments start the Snapshot Agent to generate the snapshot for a merge publication.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="41511-179">読みやすくするために、改行が追加されています。</span><span class="sxs-lookup"><span data-stu-id="41511-179">Line breaks were added to improve readability.</span></span> <span data-ttu-id="41511-180">バッチ ファイルの場合、コマンドは 1 行で入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="41511-180">In a batch file, commands must be made in a single line.</span></span>  
  
 [!code-sql[HowTo#startmergesnapshot_10](../../snippets/tsql/SQL15/replication/howto/tsql/createmergesnapshot_10.bat)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="41511-181">レプリケーション管理オブジェクト (RMO) の使用</span><span class="sxs-lookup"><span data-stu-id="41511-181">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="41511-182">スナップショット エージェントは、パブリッシャーが作成された後でスナップショットを生成します。</span><span class="sxs-lookup"><span data-stu-id="41511-182">The Snapshot Agent generates snapshots after a publication is created.</span></span> <span data-ttu-id="41511-183">レプリケーション管理オブジェクト (RMO) およびレプリケーション エージェント機能への直接的なマネージド コード アクセスを使用して、これらのスナップショットをプログラムで生成できます。</span><span class="sxs-lookup"><span data-stu-id="41511-183">You can generate these snapshots programmatically by using Replication Management Objects (RMO) and direct managed code access to replication agent functionalities.</span></span> <span data-ttu-id="41511-184">使用するオブジェクトは、レプリケーションの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="41511-184">The objects you use depend on the type of replication.</span></span> <span data-ttu-id="41511-185">スナップショット エージェントを同期的に開始する場合は <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> オブジェクトを使用し、非同期的に開始する場合はエージェント ジョブを使用します。</span><span class="sxs-lookup"><span data-stu-id="41511-185">The Snapshot Agent can be started synchronously using the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> object or asynchronously using the agent job.</span></span> <span data-ttu-id="41511-186">初期スナップショットの生成後、サブスクリプションを最初に同期するときに、初期スナップショットをサブスクライバーに転送して適用することができます。</span><span class="sxs-lookup"><span data-stu-id="41511-186">After the initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="41511-187">既存のスナップショットに最新の有効なデータが含まれていない場合は、エージェントを再実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="41511-187">You will need to rerun the agent whenever the existing snapshot no longer contains valid, up-to-date data.</span></span> <span data-ttu-id="41511-188">詳細については、「[Maintain Publications](publish/maintain-publications.md)」(パブリケーションの管理) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="41511-188">For more information, see [Maintain Publications](publish/maintain-publications.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="41511-189">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="41511-189">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="41511-190">資格情報を保存する必要がある場合は、 [Windows .NET&#xA0;Framework に用意されている](https://go.microsoft.com/fwlink/?LinkId=34733) 暗号化サービス [!INCLUDE[msCoName](../../includes/msconame-md.md)] を使用します。</span><span class="sxs-lookup"><span data-stu-id="41511-190">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="41511-191">スナップショット エージェント ジョブを非同期的に開始して、スナップショット パブリケーションまたはトランザクション パブリケーションの初期スナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="41511-191">To generate the initial snapshot for a snapshot or transactional publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="41511-192"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、パブリッシャーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-192">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="41511-193"><xref:Microsoft.SqlServer.Replication.TransPublication> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span> <span data-ttu-id="41511-194">パブリケーションの <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> プロパティおよび <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. で作成した接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="41511-194">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="41511-195"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトの残りのプロパティを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="41511-195">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="41511-196">このメソッドが `false` を返す場合、手順 2. でパブリケーション プロパティを不適切に設定したか、パブリケーションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="41511-196">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="41511-197"><xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> の値が `false` の場合は、<xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> を呼び出して、このパブリケーション用のスナップショット エージェント ジョブを作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-197">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="41511-198"><xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> メソッドを呼び出して、このパブリケーションのスナップショットを生成するエージェント ジョブを開始します。</span><span class="sxs-lookup"><span data-stu-id="41511-198">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="41511-199">(省略可) <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> の値が `true` である場合は、スナップショットをサブスクライバーに使用できます。</span><span class="sxs-lookup"><span data-stu-id="41511-199">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="41511-200">スナップショット エージェント ジョブを同期的に実行して、スナップショット パブリケーションまたはトランザクション パブリケーションの初期スナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="41511-200">To generate the initial snapshot for a snapshot or transactional publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="41511-201"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> クラスのインスタンスを作成し、次の必須プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="41511-201">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="41511-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - パブリッシャーの名前</span><span class="sxs-lookup"><span data-stu-id="41511-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="41511-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - パブリケーション データベースの名前</span><span class="sxs-lookup"><span data-stu-id="41511-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="41511-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - パブリケーションの名前</span><span class="sxs-lookup"><span data-stu-id="41511-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="41511-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - ディストリビューターの名前</span><span class="sxs-lookup"><span data-stu-id="41511-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="41511-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - パブリッシャーへの接続時に Windows 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> を指定します。パブリッシャーへの接続時に <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> を指定し、 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> および [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に値を指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="41511-207">推奨されるのは、Windows 認証です。</span><span class="sxs-lookup"><span data-stu-id="41511-207">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="41511-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - ディストリビューターへの接続時に Windows 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> を指定します。ディストリビューターへの接続時に <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> を指定し、 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> および [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に値を指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="41511-209">推奨されるのは、Windows 認証です。</span><span class="sxs-lookup"><span data-stu-id="41511-209">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="41511-210"><xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> に <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> または <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>を設定します。</span><span class="sxs-lookup"><span data-stu-id="41511-210">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="41511-211"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="41511-211">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="41511-212">スナップショット エージェント ジョブを非同期的に開始して、マージ パブリケーションの初期スナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="41511-212">To generate the initial snapshot for a merge publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="41511-213"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、パブリッシャーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="41511-214"><xref:Microsoft.SqlServer.Replication.MergePublication> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="41511-215">パブリケーションの <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> プロパティおよび <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに手順 1. で作成した接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="41511-215">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="41511-216"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトの残りのプロパティを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="41511-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="41511-217">このメソッドが `false` を返す場合、手順 2. でパブリケーション プロパティを不適切に設定したか、パブリケーションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="41511-217">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="41511-218"><xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> の値が `false` の場合は、<xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> を呼び出して、このパブリケーション用のスナップショット エージェント ジョブを作成します。</span><span class="sxs-lookup"><span data-stu-id="41511-218">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="41511-219"><xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> メソッドを呼び出して、このパブリケーションのスナップショットを生成するエージェント ジョブを開始します。</span><span class="sxs-lookup"><span data-stu-id="41511-219">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="41511-220">(省略可) <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> の値が `true` である場合は、スナップショットをサブスクライバーに使用できます。</span><span class="sxs-lookup"><span data-stu-id="41511-220">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="41511-221">スナップショット エージェントを同期的に実行して、マージ パブリケーションの初期スナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="41511-221">To generate the initial snapshot for a merge publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="41511-222"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> クラスのインスタンスを作成し、次の必須プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="41511-222">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="41511-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - パブリッシャーの名前</span><span class="sxs-lookup"><span data-stu-id="41511-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="41511-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - パブリケーション データベースの名前</span><span class="sxs-lookup"><span data-stu-id="41511-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="41511-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - パブリケーションの名前</span><span class="sxs-lookup"><span data-stu-id="41511-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="41511-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - ディストリビューターの名前</span><span class="sxs-lookup"><span data-stu-id="41511-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="41511-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - パブリッシャーへの接続時に Windows 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> を指定します。パブリッシャーへの接続時に <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> を指定し、 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> および [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に値を指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="41511-228">推奨されるのは、Windows 認証です。</span><span class="sxs-lookup"><span data-stu-id="41511-228">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="41511-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - ディストリビューターへの接続時に Windows 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> を指定します。ディストリビューターへの接続時に <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 認証を使用する場合は <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> を指定し、 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> および [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に値を指定します。</span><span class="sxs-lookup"><span data-stu-id="41511-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="41511-230">推奨されるのは、Windows 認証です。</span><span class="sxs-lookup"><span data-stu-id="41511-230">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="41511-231"><xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> に <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>を設定します。</span><span class="sxs-lookup"><span data-stu-id="41511-231">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="41511-232"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="41511-232">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="41511-233">例 (RMO)</span><span class="sxs-lookup"><span data-stu-id="41511-233">Examples (RMO)</span></span>  
 <span data-ttu-id="41511-234">次の例では、スナップショット エージェントを同期的に実行して、トランザクション パブリケーションの初期スナップショットを生成します。</span><span class="sxs-lookup"><span data-stu-id="41511-234">This example synchronously runs the Snapshot Agent to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot)]  
  
 <span data-ttu-id="41511-235">次の例では、エージェント ジョブを非同期的に開始して、トランザクション パブリケーションの初期スナップショットを生成します。</span><span class="sxs-lookup"><span data-stu-id="41511-235">This example asynchronously starts the agent job to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot_WithJob](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot_withjob)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot_WithJob](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot_withjob)]  
  
## <a name="see-also"></a><span data-ttu-id="41511-236">参照</span><span class="sxs-lookup"><span data-stu-id="41511-236">See Also</span></span>  
 <span data-ttu-id="41511-237">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="41511-237">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="41511-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="41511-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="41511-239">[ssSDSFull](create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="41511-239">[Create a Push Subscription](create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="41511-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span><span class="sxs-lookup"><span data-stu-id="41511-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span></span>  
 <span data-ttu-id="41511-241">[スナップショットを作成して適用する](create-and-apply-the-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="41511-241">[Create and Apply the Snapshot](create-and-apply-the-snapshot.md) </span></span>  
 <span data-ttu-id="41511-242">[Initialize a Subscription with a Snapshot (スナップショットを使用したサブスクリプションの初期化)](initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="41511-242">[Initialize a Subscription with a Snapshot](initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="41511-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="41511-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="41511-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="41511-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="41511-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="41511-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="41511-246">sqlcmd でのスクリプト変数の使用</span><span class="sxs-lookup"><span data-stu-id="41511-246">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  
