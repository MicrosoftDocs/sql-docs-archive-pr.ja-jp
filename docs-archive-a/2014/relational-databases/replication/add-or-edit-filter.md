---
title: フィルターの追加または編集 | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql12.rep.newpubwizard.addeditfilter.f1
ms.assetid: bdd7c71d-1c59-4044-bfe8-c85f908345bb
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 54dcb1ea0b7bf10f51659a14b9d0cc5eb7991769
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87632421"
---
# <a name="add-or-edit-filter"></a><span data-ttu-id="c51c7-102">フィルターの追加または編集</span><span class="sxs-lookup"><span data-stu-id="c51c7-102">Add or Edit Filter</span></span>
  <span data-ttu-id="c51c7-103">**[フィルターの追加]** ダイアログ ボックスと **[フィルターの編集]** ダイアログ ボックスを使用すると、静的行フィルターおよびパラメーター化された行フィルターを追加したり編集したりできます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-103">The **Add Filter** and **Edit Filter** dialog boxes allow you to add and edit static row filters and parameterized row filters.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c51c7-104">既存のパブリケーション内のフィルターを編集するには、パブリケーション用の新しいスナップショットが必要です。</span><span class="sxs-lookup"><span data-stu-id="c51c7-104">Editing a filter in an existing publication requires a new snapshot for the publication.</span></span> <span data-ttu-id="c51c7-105">パブリケーションにサブスクリプションがある場合は、サブスクリプションを再度初期化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-105">If a publication has subscriptions, the subscriptions must be reinitialized.</span></span> <span data-ttu-id="c51c7-106">プロパティ変更の詳細については、「[パブリケーションおよびアーティクルのプロパティの変更](publish/change-publication-and-article-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c51c7-106">For more information about property changes, see [Change Publication and Article Properties](publish/change-publication-and-article-properties.md).</span></span>  
  
 <span data-ttu-id="c51c7-107">すべての種類のパブリケーションに静的フィルターを含めることができ、マージ パブリケーションにはパラメーター化されたフィルターも含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-107">All publication types can include static filters; merge publications can also include parameterized filters.</span></span> <span data-ttu-id="c51c7-108">静的フィルターは、パブリケーションが作成されたときに評価されます。パブリケーションに対するすべてのサブスクライバーは、同じデータを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-108">A static filter is evaluated when the publication is created: all Subscribers to the publication receive the same data.</span></span> <span data-ttu-id="c51c7-109">パラメーター化されたフィルターは、レプリケーションの同期中に評価されます。サブスクライバーごとのログインまたはコンピューター名に基づいて、異なるサブスクライバーが異なるデータのパーティションを受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-109">A parameterized filter is evaluated during replication synchronization: different Subscribers can receive different partitions of data based on the login or computer name of each Subscriber.</span></span> <span data-ttu-id="c51c7-110">ダイアログ ボックスの **[サンプル ステートメント]** リンクをクリックして、フィルターの種類ごとのサンプルを参照します。</span><span class="sxs-lookup"><span data-stu-id="c51c7-110">Click the **Example statements** link in the dialog box to see examples of each type of filter.</span></span> <span data-ttu-id="c51c7-111">フィルター オプションの詳細については、「[パブリッシュされたデータのフィルター選択](publish/filter-published-data.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c51c7-111">For more information about filtering options, see [Filter Published Data](publish/filter-published-data.md).</span></span>  
  
 <span data-ttu-id="c51c7-112">行フィルターを使用すれば、テーブルからパブリッシュの対象となる行のサブセットを指定できます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-112">Using row filters, you can specify a subset of rows to be published from a table.</span></span> <span data-ttu-id="c51c7-113">行フィルターを使用して、ユーザーにとって必要のない行 (機密性の高い情報など) を削除したり、さまざまなサブスクライバーに送られるさまざまなデータのパーティションを作成したりできます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-113">Row filters can be used to eliminate rows that users do not need to see (such as rows that contain sensitive or confidential information), or to create different partitions of data that are sent to different Subscribers.</span></span> <span data-ttu-id="c51c7-114">さまざまなデータのパーティションをさまざまなサブスクライバーにパブリッシュすると、複数のサブスクライバーが同じデータを更新することによって発生する可能性のある競合を回避するためにも役立ちます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-114">Publishing different partitions of data to different Subscribers can also help avoid conflicts that would otherwise be caused by multiple Subscribers updating the same data.</span></span>  
  
## <a name="options"></a><span data-ttu-id="c51c7-115">オプション</span><span class="sxs-lookup"><span data-stu-id="c51c7-115">Options</span></span>  
 <span data-ttu-id="c51c7-116">このダイアログ ボックスには、トランザクション パブリケーションとスナップショット アプリケーション用の 2 段階のプロセスと、マージ パブリケーション用の 3 段階のプロセスがあります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-116">This dialog box involves a two-step process for transactional and snapshot publications and a three-step process for merge publications.</span></span> <span data-ttu-id="c51c7-117">すべての種類のパブリケーションで、フィルター対象のテーブルと、フィルターに含む 1 つまたは複数の列を選択する必要があります。フィルターは、標準の WHERE 句として定義されます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-117">All publication types require you to select a table to be filtered and one or more columns to be included in the filter; the filter is defined as a standard WHERE clause.</span></span>  
  
1.  <span data-ttu-id="c51c7-118">**[フィルターを適用するテーブルを選択します。]**</span><span class="sxs-lookup"><span data-stu-id="c51c7-118">**Select the table to filter**</span></span>  
  
     <span data-ttu-id="c51c7-119">既存のフィルターを編集している場合は、テーブルの選択は変更できません。</span><span class="sxs-lookup"><span data-stu-id="c51c7-119">If you are editing an existing filter, the table selection cannot be changed.</span></span> <span data-ttu-id="c51c7-120">新しいフィルターを追加している場合は、ドロップダウン リスト ボックスから、テーブルを選択します。</span><span class="sxs-lookup"><span data-stu-id="c51c7-120">If you are adding a new filter, select a table from the drop-down list box.</span></span> <span data-ttu-id="c51c7-121">テーブルは、 **[アーティクル]** ページでテーブルが選択されていて、まだ行フィルターを持たない場合にのみ、リスト ボックスに表示されます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-121">Tables appear in the list box only if they were selected on the **Articles** page and do not already have a row filter.</span></span> <span data-ttu-id="c51c7-122">テーブルに行フィルターがあり、新しいフィルターを定義する場合は、次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="c51c7-122">If a table has a row filter and you want to define a new one:</span></span>  
  
    1.  <span data-ttu-id="c51c7-123">**[フィルターの追加]** ダイアログ ボックスで **[キャンセル]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c51c7-123">Click **Cancel** on the **Add Filter** dialog box.</span></span>  
  
    2.  <span data-ttu-id="c51c7-124">**[テーブル行のフィルター選択]** ページのフィルター ペインでテーブルを選択し、 **[編集]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="c51c7-124">Select the table in the filter pane on the **Filter Table Rows** page and click **Edit**.</span></span>  
  
    3.  <span data-ttu-id="c51c7-125">**[フィルターの編集]** ダイアログ ボックスの既存のフィルターを編集します。</span><span class="sxs-lookup"><span data-stu-id="c51c7-125">Edit an existing filter in the **Edit Filter** dialog box.</span></span>  
  
2.  <span data-ttu-id="c51c7-126">**[フィルター ステートメントを完成させ、サブスクライバーが受け取るテーブル行を指定します。]**</span><span class="sxs-lookup"><span data-stu-id="c51c7-126">**Complete the filter statement to identify which table rows Subscribers will receive**</span></span>  
  
     <span data-ttu-id="c51c7-127">新しいフィルター ステートメントを定義するか、既存のステートメントを編集します。</span><span class="sxs-lookup"><span data-stu-id="c51c7-127">Define a new filter statement or edit an existing one.</span></span> <span data-ttu-id="c51c7-128">**[列]** リスト ボックスには、 **[フィルターを適用するテーブルを選択します。]** で選択したテーブルからパブリッシュするすべての列が一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-128">The **Columns** list box lists all the columns that you are publishing from the table you selected in **Select the table to filter**.</span></span> <span data-ttu-id="c51c7-129">**[フィルター ステートメント]** テキスト領域には、次の形式の既定のテキストが表示されます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-129">The **Filter statement** text area includes the default text, which is in the form of:</span></span>  
  
     `SELECT <published_columns> FROM [schema].[tablename] WHERE`  
  
     <span data-ttu-id="c51c7-130">このテキストは変更できません。標準の [!INCLUDE[tsql](../../includes/tsql-md.md)] 構文を使用して、WHERE キーワードの後にフィルター句を入力します。</span><span class="sxs-lookup"><span data-stu-id="c51c7-130">This text cannot be changed; type the filter clause after the WHERE keyword using standard [!INCLUDE[tsql](../../includes/tsql-md.md)] syntax.</span></span> <span data-ttu-id="c51c7-131">パブリッシャーが Oracle パブリッシャーの場合は、WHERE 句は Oracle クエリ構文に準拠する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-131">If the Publisher is an Oracle Publisher, the WHERE clause must be compliant with Oracle query syntax.</span></span> <span data-ttu-id="c51c7-132">可能であれば、複雑なフィルターの使用は避けます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-132">Avoid using complex filters when possible.</span></span> <span data-ttu-id="c51c7-133">静的フィルターとパラメーター化されたフィルターは、両方ともパブリケーションの処理時間を増加させます。したがって、フィルター ステートメントは可能な限り簡潔にしてください。</span><span class="sxs-lookup"><span data-stu-id="c51c7-133">Both static and parameterized filters increase processing time for publications; therefore you should keep filter statements as simple as possible.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c51c7-134">パフォーマンスの理由により、マージ パブリケーションの場合は、パラメーター化された行フィルター句の列名に、 `LEFT([MyColumn]) = SUSER_SNAME()`などの関数を適用しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="c51c7-134">For performance reasons, we recommended that you not apply functions to column names in parameterized row filter clauses for merge publications, such as `LEFT([MyColumn]) = SUSER_SNAME()`.</span></span> <span data-ttu-id="c51c7-135">フィルター句で HOST_NAME を使用していて、HOST_NAME 値をオーバーライドする場合は、CONVERT を使用するデータ型の変換が必要になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-135">If you use HOST_NAME in a filter clause and override the HOST_NAME value, it might be necessary to convert data types using CONVERT.</span></span> <span data-ttu-id="c51c7-136">このようなケースの推奨事項の詳細については、「[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md)」の「HOST_NAME() 値のオーバーライド」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c51c7-136">For more information about best practices for this case, see the section "Overriding the HOST_NAME() Value" in the topic [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
3.  <span data-ttu-id="c51c7-137">**[このテーブルからデータを取得するサブスクリプションの数を指定します。]**</span><span class="sxs-lookup"><span data-stu-id="c51c7-137">**Specify how many subscriptions will receive data from this table**</span></span>  
  
     [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="c51c7-138">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以降のバージョンのみで、マージ レプリケーションのみです。</span><span class="sxs-lookup"><span data-stu-id="c51c7-138">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and later versions only; merge replication only.</span></span> <span data-ttu-id="c51c7-139">マージ レプリケーションを使用して、お使いのデータとアプリケーションに最適なパーティションの種類を指定できます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-139">Merge replication allows you to specify the type of partitions that are best suited to your data and application.</span></span> <span data-ttu-id="c51c7-140">**[このテーブルの 1 行を 1 つのサブスクリプションのみに移動する]** を選択すると、マージ レプリケーションでは、重複しないパーティションのオプションが設定されます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-140">If you select **A row from this table will go to only one subscription**, merge replication sets the nonoverlapping partitions option.</span></span> <span data-ttu-id="c51c7-141">重複しないパーティションを事前計算済みパーティションと共に使用することで、パフォーマンスが向上します。事前計算済みパーティションに関連するアップロードの負担が、重複しないパーティションによって最小限に抑えられるためです。</span><span class="sxs-lookup"><span data-stu-id="c51c7-141">Nonoverlapping partitions work in conjunction with precomputed partitions to improve performance, with nonoverlapping partitions minimizing the upload cost associated with precomputed partitions.</span></span> <span data-ttu-id="c51c7-142">重複しないパーティションのパフォーマンス上の利点は、使用するパラメーター化されたフィルターと結合フィルターが複雑になるほど明確になります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-142">The performance benefit of nonoverlapping partitions is more noticeable when the parameterized filters and join filters used are more complex.</span></span> <span data-ttu-id="c51c7-143">このオプションを選択する場合は、データのパーティション分割によって、1 つの行が複数のサブスクライバーにレプリケートされないことを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c51c7-143">If you select this option, you must ensure that the data is partitioned in such a way that a row cannot be replicated to more than one Subscriber.</span></span> <span data-ttu-id="c51c7-144">詳細については、「 [パラメーター化された行フィルター](merge/parameterized-filters-parameterized-row-filters.md)」トピックの「[パーティションのオプション] の設定」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c51c7-144">For more information, see the section "Setting 'partition options'" in the topic [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="c51c7-145">フィルターを追加または編集した後に、 **[OK]** をクリックして変更を保存し、ダイアログ ボックスを閉じます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-145">After you have added or edited a filter, click **OK** to save changes and close the dialog box.</span></span> <span data-ttu-id="c51c7-146">指定したフィルターは、SELECT 句のテーブルに対して解析され、実行されます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-146">The filter you specified is parsed and run against the table in the SELECT clause.</span></span> <span data-ttu-id="c51c7-147">フィルター ステートメントに構文エラーが含まれるか、他の問題がある場合は、通知されるため、フィルター ステートメントを編集することができます。</span><span class="sxs-lookup"><span data-stu-id="c51c7-147">If the filter statement contains syntax errors or other problems, you are notified and are able to edit the filter statement.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c51c7-148">参照</span><span class="sxs-lookup"><span data-stu-id="c51c7-148">See Also</span></span>  
 <span data-ttu-id="c51c7-149">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="c51c7-149">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="c51c7-150">[パブリケーション プロパティの表示および変更](publish/view-and-modify-publication-properties.md) </span><span class="sxs-lookup"><span data-stu-id="c51c7-150">[View and Modify Publication Properties](publish/view-and-modify-publication-properties.md) </span></span>  
 <span data-ttu-id="c51c7-151">[パブリッシュされたデータのフィルター処理](publish/filter-published-data.md) </span><span class="sxs-lookup"><span data-stu-id="c51c7-151">[Filter Published Data](publish/filter-published-data.md) </span></span>  
 <span data-ttu-id="c51c7-152">[Join Filters](merge/join-filters.md) </span><span class="sxs-lookup"><span data-stu-id="c51c7-152">[Join Filters](merge/join-filters.md) </span></span>  
 <span data-ttu-id="c51c7-153">[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="c51c7-153">[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="c51c7-154">データとデータベース オブジェクトのパブリッシュ</span><span class="sxs-lookup"><span data-stu-id="c51c7-154">Publish Data and Database Objects</span></span>](publish/publish-data-and-database-objects.md)  
  
  
