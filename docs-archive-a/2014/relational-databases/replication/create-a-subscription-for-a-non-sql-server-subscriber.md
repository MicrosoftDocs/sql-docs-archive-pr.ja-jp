---
title: SQL Server 以外のサブスクライバーのサブスクリプションの作成 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- subscriptions [SQL Server replication], non-SQL Server Subscribers
- Subscribers [SQL Server replication], non-SQL Server Subscribers
- non-SQL Server Subscribers, subscriptions
ms.assetid: 5020ee68-b988-4d57-8066-67d183e61237
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 31a7d1e52c53cb858039f1fd0ed403f255ad5ca2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714198"
---
# <a name="create-a-subscription-for-a-non-sql-server-subscriber"></a><span data-ttu-id="893d0-102">SQL Server 以外のサブスクライバーのサブスクリプションの作成</span><span class="sxs-lookup"><span data-stu-id="893d0-102">Create a Subscription for a Non-SQL Server Subscriber</span></span>
  <span data-ttu-id="893d0-103">このトピックでは、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] で [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] または [!INCLUDE[tsql](../../includes/tsql-md.md)]を使用して、SQL Server 以外のサブスクライバーのサブスクリプションを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="893d0-103">This topic describes how to create a subscription for a non-SQL Server Subscriber in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="893d0-104">トランザクション レプリケーションとスナップショット レプリケーションでは、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーに対するデータのパブリッシュがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="893d0-104">Transactional and snapshot replication support publishing data to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span> <span data-ttu-id="893d0-105">サポートされるサブスクライバー プラットフォームの詳細については、「 [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md)を使用して、SQL Server 以外のサブスクライバーのサブスクリプションを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="893d0-105">For information about supported Subscriber platforms, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span></span>  
  
 <span data-ttu-id="893d0-106">**このトピックの内容**</span><span class="sxs-lookup"><span data-stu-id="893d0-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="893d0-107">**SQL Server 以外のサブスクライバーのサブスクリプションを作成するために使用するもの:**</span><span class="sxs-lookup"><span data-stu-id="893d0-107">**To create a subscription for a non-SQL Server Subscriber, using:**</span></span>  
  
     [<span data-ttu-id="893d0-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="893d0-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="893d0-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="893d0-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="893d0-110">SQL Server Management Studio の使用</span><span class="sxs-lookup"><span data-stu-id="893d0-110">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="893d0-111">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーのサブスクリプションを作成するには、以下の操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="893d0-111">To create a subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber:</span></span>  
  
1.  <span data-ttu-id="893d0-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ディストリビューターに、適切なクライアント ソフトウェアおよび OLE DB プロバイダーをインストールし、これらを構成します。</span><span class="sxs-lookup"><span data-stu-id="893d0-112">Install and configure the appropriate client software and OLE DB provider(s) on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Distributor.</span></span> <span data-ttu-id="893d0-113">詳細については、「 [Oracle Subscribers](non-sql/oracle-subscribers.md) 」および「 [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-113">For more information, see [Oracle Subscribers](non-sql/oracle-subscribers.md) and [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
2.  <span data-ttu-id="893d0-114">パブリケーションの新規作成ウィザードを使用して、パブリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="893d0-114">Create a publication using the New Publication Wizard.</span></span> <span data-ttu-id="893d0-115">Oracle データベースからパブリケーションを作成する方法については、「[Publisher で文書を作成するには](publish/create-a-publication.md)」および「[Create a Publication from an Oracle Database](publish/create-a-publication-from-an-oracle-database.md)」(Oracle データベースからパブリケーションを作成する) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-115">For more information about creating publications, see [Create a Publication](publish/create-a-publication.md) and [Create a Publication from an Oracle Database](publish/create-a-publication-from-an-oracle-database.md).</span></span> <span data-ttu-id="893d0-116">パブリケーションの新規作成ウィザードで、以下のオプションを指定します。</span><span class="sxs-lookup"><span data-stu-id="893d0-116">Specify the following options in the New Publication Wizard:</span></span>  
  
    -   <span data-ttu-id="893d0-117">**[パブリケーションの種類]** ページで、 **[スナップショット パブリケーション]** または **[トランザクション パブリケーション]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="893d0-117">On the **Publication Type** page, select **Snapshot publication** or **Transactional publication**.</span></span>  
  
    -   <span data-ttu-id="893d0-118">**[スナップショット エージェント]** ページで、 **[スナップショットをすぐに作成する]** チェック ボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="893d0-118">On the **Snapshot Agent** page, clear **Create a snapshot immediately**.</span></span>  
  
         <span data-ttu-id="893d0-119">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーに対してパブリケーションが有効になったら、スナップショットを作成し、スナップショット エージェントが[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーに適したスナップショットおよび初期化スクリプトを生成することを確認します。</span><span class="sxs-lookup"><span data-stu-id="893d0-119">You create the snapshot after the publication is enabled for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers to ensure that the Snapshot Agent generates a snapshot and initialization scripts that are suitable for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  
  
3.  <span data-ttu-id="893d0-120">**[パブリケーションのプロパティ - \<PublicationName>]** ダイアログ ボックスを使用して、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーのパブリケーションを有効にします。</span><span class="sxs-lookup"><span data-stu-id="893d0-120">Enable the publication for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers using the **Publication Properties - \<PublicationName>** dialog box.</span></span> <span data-ttu-id="893d0-121">この手順の詳細については、「 [Publication Properties, Subscription Options](publication-properties-subscription-options.md) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-121">See [Publication Properties, Subscription Options](publication-properties-subscription-options.md) for more information about this step.</span></span>  
  
4.  <span data-ttu-id="893d0-122">サブスクリプションの新規作成ウィザードを使用して、サブスクリプションを作成します。</span><span class="sxs-lookup"><span data-stu-id="893d0-122">Create a subscription using the New Subscription Wizard.</span></span> <span data-ttu-id="893d0-123">この手順の詳細については、このトピック内で説明します。</span><span class="sxs-lookup"><span data-stu-id="893d0-123">This topic provides more information about this step.</span></span>  
  
5.  <span data-ttu-id="893d0-124">(省略可能) サブスクライバー側のテーブルを保持するには、 **pre_creation_cmd** アーティクル プロパティを変更します。</span><span class="sxs-lookup"><span data-stu-id="893d0-124">(Optional) Change the **pre_creation_cmd** article property to retain tables at the Subscriber.</span></span> <span data-ttu-id="893d0-125">この手順の詳細については、このトピック内で説明します。</span><span class="sxs-lookup"><span data-stu-id="893d0-125">This topic provides more information about this step.</span></span>  
  
6.  <span data-ttu-id="893d0-126">パブリケーションのスナップショットを生成します。</span><span class="sxs-lookup"><span data-stu-id="893d0-126">Generate a snapshot for the publication.</span></span> <span data-ttu-id="893d0-127">この手順の詳細については、このトピック内で説明します。</span><span class="sxs-lookup"><span data-stu-id="893d0-127">This topic provides more information about this step.</span></span>  
  
7.  <span data-ttu-id="893d0-128">サブスクリプションを同期します。</span><span class="sxs-lookup"><span data-stu-id="893d0-128">Synchronize the subscription.</span></span> <span data-ttu-id="893d0-129">詳細については、「 [プッシュ サブスクリプションの同期](synchronize-a-push-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="893d0-129">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-enable-a-publication-for-non-sql-server-subscribers"></a><span data-ttu-id="893d0-130">SQL Server 以外のサブスクライバーのパブリケーションを有効にするには</span><span class="sxs-lookup"><span data-stu-id="893d0-130">To enable a publication for non-SQL Server Subscribers</span></span>  
  
1.  <span data-ttu-id="893d0-131">[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]でパブリッシャーに接続し、サーバー ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="893d0-131">Connect to the Publisher in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="893d0-132">**[レプリケーション]** フォルダーを展開し、 **[ローカル パブリケーション]** フォルダーを展開します。</span><span class="sxs-lookup"><span data-stu-id="893d0-132">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="893d0-133">パブリケーションを右クリックし、 **[プロパティ]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="893d0-133">Right-click the publication, and then click **Properties**.</span></span>  
  
4.  <span data-ttu-id="893d0-134">**[サブスクリプション オプション]** ページで、 **[SQL Server 以外のサブスクライバーを許可]** オプションに対して **[True]** の値を選択します。</span><span class="sxs-lookup"><span data-stu-id="893d0-134">On the **Subscription Options** page, select a value of **True** for the option **Allow non-SQL Server Subscribers**.</span></span> <span data-ttu-id="893d0-135">このオプションを選択した場合、パブリケーションと[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーとの互換性を確保するために、プロパティの数が変更されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-135">Selecting this option changes a number of properties so that the publication is compatible with non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="893d0-136">**[True]** を選択すると、 **pre_creation_cmd** アーティクル プロパティの値が 'drop' に設定されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-136">Selecting **True** sets the value of the **pre_creation_cmd** article property to 'drop'.</span></span> <span data-ttu-id="893d0-137">この設定では、アーティクルのテーブル名と一致するテーブルがサブスクライバーにある場合、レプリケーションによってそのテーブルが削除されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-137">This setting specifies that replication should drop a table at the Subscriber if it matches the name of the table in the article.</span></span> <span data-ttu-id="893d0-138">サブスクライバーにある既存のテーブルを保持するには、アーティクルごとに [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) ストアド プロシージャを使用し、次のように **pre_creation_cmd**の値に 'none' を指定します。 `sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`</span><span class="sxs-lookup"><span data-stu-id="893d0-138">If you have existing tables at the Subscriber that you want to keep, use the [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) stored procedure for each article; specify a value 'none' for **pre_creation_cmd**: `sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span></span>  
  
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)] <span data-ttu-id="893d0-139">パブリケーションの新しいスナップショットを作成するように要求されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-139">You will be prompted to create a new snapshot for the publication.</span></span> <span data-ttu-id="893d0-140">この時点で作成しない場合は、次に示す作成手順を後で使用してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-140">If you do not want to create one at this time, use the steps described in the next "how to" procedure at a later time.</span></span>  
  
#### <a name="to-create-a-subscription-for-a-non-sql-server-subscriber"></a><span data-ttu-id="893d0-141">SQL Server 以外のサブスクライバーのサブスクリプションを作成するには</span><span class="sxs-lookup"><span data-stu-id="893d0-141">To create a subscription for a non-SQL Server Subscriber</span></span>  
  
1.  <span data-ttu-id="893d0-142">**[レプリケーション]** フォルダーを展開し、 **[ローカル パブリケーション]** フォルダーを展開します。</span><span class="sxs-lookup"><span data-stu-id="893d0-142">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
2.  <span data-ttu-id="893d0-143">適切なパブリケーションを右クリックして、 **[新しいサブスクリプション]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="893d0-143">Right-click the appropriate publication, and then click **New Subscriptions**.</span></span>  
  
3.  <span data-ttu-id="893d0-144">**[ディストリビューション エージェントの場所]** ページで、 **[ディストリビューター &lt;Distributor&gt; ですべてのエージェントを実行する]** が選択されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="893d0-144">On the **Distribution Agent Location** page, ensure **Run all agents at the Distributor** is selected.</span></span> <span data-ttu-id="893d0-145">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーは、サブスクライバーでのエージェントの実行をサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="893d0-145">Non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers do not support running agents at the Subscriber.</span></span>  
  
4.  <span data-ttu-id="893d0-146">**[サブスクライバー]** ページで、 **[サブスクライバーの追加]** をクリックし、次に **[SQL Server 以外のサブスクライバーの追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="893d0-146">On the **Subscribers** page, click **Add Subscriber** and then click **Add Non-SQL Server Subscriber**.</span></span>  
  
5.  <span data-ttu-id="893d0-147">**[SQL Server 以外のサブスクライバーの追加]** ダイアログ ボックスで、サブスクライバーの種類を選択します。</span><span class="sxs-lookup"><span data-stu-id="893d0-147">In the **Add Non-SQL Server Subscriber** dialog box, select the type of Subscriber.</span></span>  
  
6.  <span data-ttu-id="893d0-148">**[データ ソース名]** に値を入力します。</span><span class="sxs-lookup"><span data-stu-id="893d0-148">Enter a value in **Data source name**:</span></span>  
  
    -   <span data-ttu-id="893d0-149">Oracle の場合、これは構成した Transparent Network Substrate (TNS) 名です。</span><span class="sxs-lookup"><span data-stu-id="893d0-149">For Oracle, this is the transparent network substrate (TNS) name you configured.</span></span>  
  
    -   <span data-ttu-id="893d0-150">IBM の場合は、任意の名前にすることができます。</span><span class="sxs-lookup"><span data-stu-id="893d0-150">For IBM, this can be any name.</span></span> <span data-ttu-id="893d0-151">通常は、サブスクライバーのネットワーク アドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="893d0-151">It is typical to specify the network address of the Subscriber.</span></span>  
  
     <span data-ttu-id="893d0-152">この手順で入力したデータ ソース名と手順 9. で指定した資格情報は、このウィザードでは検証されません。</span><span class="sxs-lookup"><span data-stu-id="893d0-152">The data source name entered in this step and the credentials specified in step 9 are not validated by this wizard.</span></span> <span data-ttu-id="893d0-153">これらは、サブスクリプションに対してディストリビューション エージェントが実行されるまで、レプリケーションで使用されません。</span><span class="sxs-lookup"><span data-stu-id="893d0-153">They are not used by replication until the Distribution Agent runs for the subscription.</span></span> <span data-ttu-id="893d0-154">クライアント ツール (Oracle の場合には **sqlplus** など) を使用してサブスクライバーに接続することにより、すべての値がテストされていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="893d0-154">Ensure that all values have been tested by connecting to the Subscriber using a client tool (such as **sqlplus** for Oracle).</span></span> <span data-ttu-id="893d0-155">詳細については、「 [Oracle Subscribers](non-sql/oracle-subscribers.md) 」および「 [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-155">For more information, see [Oracle Subscribers](non-sql/oracle-subscribers.md) and [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
7.  [!INCLUDE[clickOK](../../includes/clickok-md.md)] <span data-ttu-id="893d0-156">これで、ウィザードの **[サブスクライバー]** ページで、サブスクライバーが **[サブスクライバー]** 列に表示され、読み取り専用の **[(既定の転送先)]** が **[サブスクリプション データベース]** 列に表示されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-156">On the **Subscribers** page of the wizard, the Subscriber is now displayed in the **Subscriber** column with a read-only **(default destination)** in the **Subscription Database** column:</span></span>  
  
    -   <span data-ttu-id="893d0-157">Oracle の場合、1 つのサーバーに 1 つのデータベースしか作成できないため、データベースを指定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="893d0-157">For Oracle, a server has at most one database, so it is not necessary to specify the database.</span></span>  
  
    -   <span data-ttu-id="893d0-158">IBM DB2 の場合、データベースは DB2 接続文字列の **Initial Catalog** プロパティで指定されます。DB2 接続文字列は、後述する **[追加の接続オプション]** フィールドに入力できます。</span><span class="sxs-lookup"><span data-stu-id="893d0-158">For IBM DB2, the database is specified in the **Initial Catalog** property of the DB2 connection string, which can be entered in the **Additional connection options** field described later in this process.</span></span>  
  
8.  <span data-ttu-id="893d0-159">[**セキュリティのディストリビューションエージェント**] ページで、サブスクライバーの横にあるプロパティボタン ([**...**]) をクリックして、[**ディストリビューションエージェントセキュリティ**] ダイアログボックスにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="893d0-159">On the **Distribution Agent Security** page, click the properties button (**...**) next to the Subscriber to access the **Distribution Agent Security** dialog box.</span></span>  
  
9. <span data-ttu-id="893d0-160">**[ディストリビューション エージェント セキュリティ]** ダイアログ ボックスで、以下の操作を行います。</span><span class="sxs-lookup"><span data-stu-id="893d0-160">In the **Distribution Agent Security** dialog box:</span></span>  
  
    -   <span data-ttu-id="893d0-161">**[プロセス アカウント]** 、 **[パスワード]** 、および **[パスワードの確認入力]** フィールドで、ディストリビューション エージェントの実行、およびディストリビューターへのローカル接続に使用される [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows アカウントおよびパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="893d0-161">In the **Process account**, **Password**, and **Confirm password** fields, enter the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account and password under which the Distribution Agent should run and make local connections to the Distributor.</span></span>  
  
         <span data-ttu-id="893d0-162">アカウントには、ディストリビューション データベースの固定データベース ロール **db_owner** のメンバーであること、パブリケーション アクセス リスト (PAL) のメンバーであること、スナップショット共有での読み取り権限、および OLE DB プロバイダーのインストール ディレクトリでの読み取り権限など、最小限の権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="893d0-162">The account requires these minimum permissions: member of the **db_owner** fixed database role in the distribution database; member of the publication access list (PAL); read permissions on the snapshot share; and read permission on the install directory of the OLE DB provider.</span></span> <span data-ttu-id="893d0-163">PAL の詳細については、「[Secure the Publisher (パブリッシャーのセキュリティ保護)](security/secure-the-publisher.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-163">For more information about the PAL, see [Secure the Publisher](security/secure-the-publisher.md).</span></span>  
  
    -   <span data-ttu-id="893d0-164">**[サブスクライバーに接続]** の、 **[ログイン]** 、 **[パスワード]** 、および **[パスワードの確認入力]** フィールドで、サブスクライバーへの接続に使用するログインとパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="893d0-164">Under **Connect to the Subscriber**, in the **Login**, **Password**, and **Confirm password** fields, enter the login and password that should be used to connect to the Subscriber.</span></span> <span data-ttu-id="893d0-165">このログインは、あらかじめ構成され、サブスクリプション データベースでオブジェクトを作成できる十分な権限を持っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="893d0-165">This login should already be configured and should have sufficient permissions to create objects in the subscription database.</span></span>  
  
    -   <span data-ttu-id="893d0-166">**[追加の接続オプション]** フィールドで、接続文字列の形式でサブスクライバーの接続オプションを指定します (Oracle では追加オプションは必要ありません)。</span><span class="sxs-lookup"><span data-stu-id="893d0-166">In the **Additional connection options** field, specify any connection options for the Subscriber in the form of a connection string (Oracle does not require additional options).</span></span> <span data-ttu-id="893d0-167">各オプションはセミコロンで区切る必要があります。</span><span class="sxs-lookup"><span data-stu-id="893d0-167">Each option should be separated by a semi-colon.</span></span> <span data-ttu-id="893d0-168">以下に、DB2 接続文字列の例を示します (読みやすいように改行しています)。</span><span class="sxs-lookup"><span data-stu-id="893d0-168">The following is an example of a DB2 connection string (line breaks are for readability):</span></span>  
  
        ```  
        Provider=DB2OLEDB;Initial Catalog=MY_SUBSCRIBER_DB;Network Transport Library=TCP;Host CCSID=1252;  
        PC Code Page=1252;Network Address=MY_SUBSCRIBER;Network Port=50000;Package Collection=MY_PKGCOL;  
        Default Schema=MY_SCHEMA;Process Binary as Character=False;Units of Work=RUW;DBMS Platform=DB2/NT;  
        Persist Security Info=False;Connection Pooling=True;  
        ```  
  
         <span data-ttu-id="893d0-169">文字列内のオプションの多くは、接続する DB2 サーバーに固有のものですが、 **Process Binary as Character** オプションは常に **False**に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="893d0-169">Most of the options in the string are specific to the DB2 server you are configuring, but the **Process Binary as Character** option should always be set to **False**.</span></span> <span data-ttu-id="893d0-170">サブスクリプション データベースを識別するため、 **Initial Catalog** オプションに値が必要です。</span><span class="sxs-lookup"><span data-stu-id="893d0-170">A value is required for the **Initial Catalog** option to identify the subscription database.</span></span>  
  
10. <span data-ttu-id="893d0-171">**[同期スケジュール]** ページで、 **[エージェント スケジュール]** メニューからディストリビューション エージェントのスケジュールを選択します (スケジュールは通常、 **[連続実行する]** です)。</span><span class="sxs-lookup"><span data-stu-id="893d0-171">On the **Synchronization Schedule** page, select a schedule for the Distribution Agent from the **Agent Schedule** menu (the schedule is typically **Run continuously**).</span></span>  
  
11. <span data-ttu-id="893d0-172">**[サブスクリプションの初期化]** ページで、サブスクリプションを初期化するかどうか、および初期化する場合はいつ行うのかを指定します。</span><span class="sxs-lookup"><span data-stu-id="893d0-172">On the **Initialize Subscriptions** page, specify whether the subscription should be initialized and, if so, when it should be initialized:</span></span>  
  
    -   <span data-ttu-id="893d0-173">すべてのオブジェクトを作成し、サブスクリプション データベースに必要なすべてのデータを追加した場合にのみ、 **[初期化]** チェック ボックスをオフにします。</span><span class="sxs-lookup"><span data-stu-id="893d0-173">Clear **Initialize** only if you have created all objects and added all required data in the subscription database.</span></span>  
  
    -   <span data-ttu-id="893d0-174">このウィザードが完了した後に、ディストリビューション エージェントからサブスクライバーへスナップショット ファイルを転送するには、 **[次の場合に初期化]** 列のドロップダウン リスト ボックスから **[今すぐ]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="893d0-174">Select **Immediately** from the drop-down list in the **Initialize When** column to have the Distribution Agent transfer snapshot files to the Subscriber after this wizard is completed.</span></span> <span data-ttu-id="893d0-175">エージェントの次回の実行時にファイルが転送されるようにするには、 **[初回同期時]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="893d0-175">Select **At first synchronization** to have the agent transfer the files the next time it is scheduled to run.</span></span>  
  
12. <span data-ttu-id="893d0-176">**[ウィザードのアクション]** ページで、必要に応じてサブスクリプションのスクリプトを作成します。</span><span class="sxs-lookup"><span data-stu-id="893d0-176">On the **Wizard Actions** page, optionally script the subscription.</span></span> <span data-ttu-id="893d0-177">詳細については、「[レプリケーションのスクリプト作成](scripting-replication.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-177">For more information, see [Scripting Replication](scripting-replication.md).</span></span>  
  
#### <a name="to-retain-tables-at-the-subscriber"></a><span data-ttu-id="893d0-178">サブスクライバー側のテーブルを保持するには</span><span class="sxs-lookup"><span data-stu-id="893d0-178">To retain tables at the Subscriber</span></span>  
  
-   <span data-ttu-id="893d0-179">既定では、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーに対してパブリケーションを有効にすると、 **pre_creation_cmd** アーティクル プロパティが 'drop' に設定されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-179">By default, enabling a publication for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers sets the value of the **pre_creation_cmd** article property to 'drop'.</span></span> <span data-ttu-id="893d0-180">この設定では、アーティクルのテーブル名と一致するテーブルがサブスクライバーにある場合、レプリケーションによってそのテーブルが削除されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-180">This setting specifies that replication should drop a table at the Subscriber if it matches the name of the table in the article.</span></span> <span data-ttu-id="893d0-181">サブスクライバーにある既存のテーブルを保持するには、アーティクルごとに [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) ストアド プロシージャを使用し、次のように **pre_creation_cmd**の値に 'none' を指定します。</span><span class="sxs-lookup"><span data-stu-id="893d0-181">If you have existing tables at the Subscriber that you want to keep, use the [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) stored procedure for each article; specify a value 'none' for **pre_creation_cmd**.</span></span> <span data-ttu-id="893d0-182">`sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span><span class="sxs-lookup"><span data-stu-id="893d0-182">`sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span></span>  
  
#### <a name="to-generate-a-snapshot-for-the-publication"></a><span data-ttu-id="893d0-183">パブリケーションのスナップショットを生成するには</span><span class="sxs-lookup"><span data-stu-id="893d0-183">To generate a snapshot for the publication</span></span>  
  
1.  <span data-ttu-id="893d0-184">**[レプリケーション]** フォルダーを展開し、 **[ローカル パブリケーション]** フォルダーを展開します。</span><span class="sxs-lookup"><span data-stu-id="893d0-184">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
2.  <span data-ttu-id="893d0-185">パブリケーションを右クリックし、 **[スナップショット エージェントの状態の表示]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="893d0-185">Right-click the publication, and then click **View Snapshot Agent Status**.</span></span>  
  
3.  <span data-ttu-id="893d0-186">**[スナップショット エージェントの状態の表示 - \<Publication>]** ダイアログ ボックスで **[開始]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="893d0-186">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="893d0-187">スナップショット エージェントによるスナップショットの生成が完了すると、"[100%] 17 個のアーティクルのスナップショットが生成されました。" などのメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-187">When the Snapshot Agent finishes generating the snapshot, a message is displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="893d0-188">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="893d0-188">Using Transact-SQL</span></span>  
 <span data-ttu-id="893d0-189">レプリケーション ストアド プロシージャを使用して、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーに対するプッシュ サブスクリプションをプログラムから作成できます。</span><span class="sxs-lookup"><span data-stu-id="893d0-189">You can create push subscriptions to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers programmatically using replication stored procedures.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="893d0-190">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="893d0-190">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="893d0-191">スクリプト ファイルに資格情報を格納する必要がある場合は、不正アクセスを防ぐために、ファイルを保護します。</span><span class="sxs-lookup"><span data-stu-id="893d0-191">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-for-a-transactional-or-snapshot-publication-to-a-non-sql-server-subscriber"></a><span data-ttu-id="893d0-192">SQL Server 以外のサブスクライバーに対する、トランザクション パブリケーションまたはスナップショット パブリケーションのプッシュ サブスクリプションを作成するには</span><span class="sxs-lookup"><span data-stu-id="893d0-192">To create a push subscription for a transactional or snapshot publication to a non-SQL Server Subscriber</span></span>  
  
1.  <span data-ttu-id="893d0-193">パブリッシャーとディストリビューターの両方に、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーの最新の OLE DB プロバイダーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="893d0-193">Install the most recent OLE DB provider for the non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber at both the Publisher and Distributor.</span></span> <span data-ttu-id="893d0-194">OLE DB プロバイダーのレプリケーションの要件については、「 [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md)」、 [Oracle Subscribers](non-sql/oracle-subscribers.md)」、「 [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-194">For the replication requirements for an OLE DB provider, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md), [Oracle Subscribers](non-sql/oracle-subscribers.md), [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
2.  <span data-ttu-id="893d0-195">パブリッシャー側のパブリケーション データベースに対して、[sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql) を実行して、パブリケーションが [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバ―をサポートしていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="893d0-195">At the Publisher on the publication database, verify that the publication supports non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers by executing [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="893d0-196">`enabled_for_het_sub` の値が 1 の場合、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 以外のサブスクライバーがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="893d0-196">If the value of `enabled_for_het_sub` is 1, non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers are supported.</span></span>  
  
    -   <span data-ttu-id="893d0-197">の値が0の場合は `enabled_for_het_sub` 、 [Sp_changepublication &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql)を実行します。には、にを指定 `enabled_for_het_sub` **@property** `true` **@value** します。</span><span class="sxs-lookup"><span data-stu-id="893d0-197">If the value of `enabled_for_het_sub` is 0, execute [sp_changepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `enabled_for_het_sub` for **@property** and `true` for **@value**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="893d0-198">`enabled_for_het_sub` を `true` に変更する前に、そのパブリケーションに対する既存のサブスクリプションをすべて削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="893d0-198">Before changing `enabled_for_het_sub` to `true`, you must drop any existing subscriptions to the publication.</span></span> <span data-ttu-id="893d0-199">パブリケーションで更新サブスクリプションもサポートされる場合、`enabled_for_het_sub` を `true` に設定することはできません。</span><span class="sxs-lookup"><span data-stu-id="893d0-199">You cannot set `enabled_for_het_sub` to `true` when the publication also supports updating subscriptions.</span></span> <span data-ttu-id="893d0-200">`enabled_for_het_sub` を変更すると、他のパブリケーション プロパティにも影響します。</span><span class="sxs-lookup"><span data-stu-id="893d0-200">Changing `enabled_for_het_sub` will affect other publication properties.</span></span> <span data-ttu-id="893d0-201">詳細については、「 [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-201">For more information, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span></span>  
  
3.  <span data-ttu-id="893d0-202">パブリッシャー側のパブリケーション データベースに対して、[sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="893d0-202">At the Publisher on the publication database, execute [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="893d0-203">に、、、の値を指定し、に push を、に値3を指定し **@publication** **@subscriber** **(default destination)** **@destination_db** **push** **@subscription_type** **@subscriber_type** ます (OLE DB プロバイダーを指定します)。</span><span class="sxs-lookup"><span data-stu-id="893d0-203">Specify **@publication**, **@subscriber**, a value of **(default destination)** for **@destination_db**, a value of **push** for **@subscription_type**, and a value of 3 for **@subscriber_type** (specifies an OLE DB provider).</span></span>  
  
4.  <span data-ttu-id="893d0-204">パブリッシャー側のパブリケーション データベースに対して、[sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="893d0-204">At the Publisher on the publication database, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="893d0-205">次の指定を行います。</span><span class="sxs-lookup"><span data-stu-id="893d0-205">Specify the following:</span></span>  
  
    -   <span data-ttu-id="893d0-206">**@subscriber**パラメーターと **@publication** パラメーター。</span><span class="sxs-lookup"><span data-stu-id="893d0-206">The **@subscriber**and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="893d0-207">の値 **(既定の転送先)** **@subscriber_db**</span><span class="sxs-lookup"><span data-stu-id="893d0-207">A value of **(default destination)** for **@subscriber_db**,</span></span>  
  
    -   <span data-ttu-id="893d0-208">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **@subscriber_provider** 、、 **@subscriber_datasrc** **@subscriber_location** 、 **@subscriber_provider_string** 、および **@subscriber_catalog** のデータソース以外のプロパティ。</span><span class="sxs-lookup"><span data-stu-id="893d0-208">The properties of the non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source for **@subscriber_provider**, **@subscriber_datasrc**, **@subscriber_location**, **@subscriber_provider_string**, and **@subscriber_catalog**.</span></span>  
  
    -   <span data-ttu-id="893d0-209">[!INCLUDE[msCoName](../../includes/msconame-md.md)]およびに対してディストリビューターでディストリビューションエージェントを実行するときに使用する Windows 資格情報 **@job_login** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="893d0-209">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="893d0-210">Windows 統合認証を使用して確立される接続は、常におよびで指定された Windows 資格情報を使用し **@job_login** **@job_password** ます。</span><span class="sxs-lookup"><span data-stu-id="893d0-210">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="893d0-211">ディストリビューション エージェントは、常に Windows 統合認証を使用してディストリビューターにローカル接続します。</span><span class="sxs-lookup"><span data-stu-id="893d0-211">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="893d0-212">既定では、エージェントは Windows 統合認証を使用してサブスクライバーに接続します。</span><span class="sxs-lookup"><span data-stu-id="893d0-212">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="893d0-213">に**0**を指定し、 **@subscriber_security_mode** およびに OLE DB プロバイダーのログイン情報を指定し **@subscriber_login** **@subscriber_password** ます。</span><span class="sxs-lookup"><span data-stu-id="893d0-213">A value of **0** for **@subscriber_security_mode** and the OLE DB provider login information for **@subscriber_login** and **@subscriber_password**.</span></span>  
  
    -   <span data-ttu-id="893d0-214">このサブスクリプションでのディストリビューション エージェント ジョブのスケジュール。</span><span class="sxs-lookup"><span data-stu-id="893d0-214">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="893d0-215">詳細については、「 [Specify Synchronization Schedules](specify-synchronization-schedules.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-215">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="893d0-216">リモート ディストリビューターを使用するパブリッシャー側でプッシュ サブスクリプションを作成する場合は、 *job_login* および *job_password*を含むすべてのパラメーターに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="893d0-216">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="893d0-217">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="893d0-217">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="893d0-218">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="893d0-218">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="893d0-219">参照</span><span class="sxs-lookup"><span data-stu-id="893d0-219">See Also</span></span>  
 <span data-ttu-id="893d0-220">[IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="893d0-220">[IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md) </span></span>  
 <span data-ttu-id="893d0-221">[Oracle Subscribers](non-sql/oracle-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="893d0-221">[Oracle Subscribers](non-sql/oracle-subscribers.md) </span></span>  
 <span data-ttu-id="893d0-222">[その他の SQL Server 以外のサブスクライバー](non-sql/other-non-sql-server-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="893d0-222">[Other Non-SQL Server Subscribers](non-sql/other-non-sql-server-subscribers.md) </span></span>  
 <span data-ttu-id="893d0-223">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="893d0-223">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="893d0-224">レプリケーション セキュリティの推奨事項</span><span class="sxs-lookup"><span data-stu-id="893d0-224">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
