---
title: レプリケーション スクリプトのアップグレード (レプリケーション Transact-SQL プログラミング) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634423"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="ebaca-102">レプリケーション スクリプトのアップグレード (レプリケーション Transact-SQL プログラミング)</span><span class="sxs-lookup"><span data-stu-id="ebaca-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="ebaca-103">スクリプト ファイルを使用して、レプリケーション トポロジをプログラムで構成できます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-103">script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="ebaca-104">詳細については、「[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md)」 (レプリケーション システム ストアド プロシージャの概念) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ebaca-105">`sysadmin` ロールのメンバーが実行するスクリプトについては、アップグレードは必須ではありませんが、このトピックの説明に従って既存のスクリプトを変更することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="ebaca-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="ebaca-106">「 [Replication Agent Security Model](../security/replication-agent-security-model.md)」の「エージェントに必要な権限」に記載されている各レプリケーション エージェントの最小権限を持つアカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="ebaca-107">このようにセキュリティが強化されたことで、レプリケーション エージェント ジョブの実行に使用される [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows アカウントを明示的に指定できるため、権限をより詳細に設定できます。既存のスクリプトに含まれる次のストアド プロシージャは、このセキュリティ強化の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="ebaca-108">**sp_addpublication_snapshot**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="ebaca-109">次に、Windows 資格情報をとして指定し **@job_login** **@job_password** [sp_addpublication_snapshot &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)を実行して、ディストリビューターでスナップショットエージェントを実行するジョブを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ebaca-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="ebaca-110">**sp_addpushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ebaca-111">[sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) を実行して、ジョブを明示的に追加し、ディストリビューション エージェント ジョブをディストリビューターで実行するときに Windows 資格情報 (**@job_login** および **@job_password**) を指定することが必要になりました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="ebaca-112">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] よりも前のバージョンの [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]では、プッシュ サブスクリプションが作成されるときにこの操作が自動的に実行されました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="ebaca-113">**sp_addmergepushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ebaca-114">[sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) を実行して、ジョブを明示的に追加し、マージ エージェント ジョブをディストリビューターで実行するときに Windows 資格情報 (**@job_login** および **@job_password**) を指定することが必要になりました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="ebaca-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] よりも前のバージョンの [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]では、プッシュ サブスクリプションが作成されるときにこの操作が自動的に実行されました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="ebaca-116">**sp_addpullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ebaca-117">次に、Windows 資格情報をとして指定し **@job_login** **@job_password** [sp_addpullsubscription_agent &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)を実行して、サブスクライバーでディストリビューションエージェントを実行するジョブを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ebaca-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="ebaca-118">**sp_addmergepullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="ebaca-119">次に、Windows 資格情報をとして指定し **@job_login** **@job_password** [sp_addmergepullsubscription_agent &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)を実行して、サブスクライバーでマージエージェントを実行するジョブを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ebaca-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="ebaca-120">**sp_addlogreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="ebaca-121">[sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) を実行して、ジョブを手動で追加し、ログ リーダー エージェントをディストリビューターで実行するときに使用する Windows 資格情報を入力することが必要になりました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="ebaca-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] よりも前のバージョンの [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]では、トランザクション パブリケーションが作成されるときにこの操作が自動的に実行されました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="ebaca-123">**sp_addqreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="ebaca-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="ebaca-124">[sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) を実行して、ジョブを手動で追加し、キュー リーダー エージェントをディストリビューターで実行するときに使用する Windows 資格情報を入力することが必要になりました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="ebaca-125">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] よりも前のバージョンの [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]では、キュー更新をサポートするトランザクション パブリケーションが作成されるときにこの操作が自動的に実行されました。</span><span class="sxs-lookup"><span data-stu-id="ebaca-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="ebaca-126">で導入されたセキュリティモデルでは、 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] レプリケーションエージェントは、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] およびで指定された資格情報を使用して、Windows 認証を使用してのローカルインスタンスに常に接続し **@job_name** **@job_password** ます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-127">レプリケーション エージェント ジョブを実行する際に使用する Windows アカウントの要件の詳細については、「 [Replication Agent Security Model](../security/replication-agent-security-model.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ebaca-128">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="ebaca-129">スクリプト ファイルに資格情報を格納した場合は、ファイル自体が暗号化されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="ebaca-130">スナップショット パブリケーションまたはトランザクション パブリケーションを構成するスクリプトをアップグレードするには</span><span class="sxs-lookup"><span data-stu-id="ebaca-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="ebaca-131">既存のスクリプトで、[sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) の前に、パブリッシャー側のパブリケーション データベースに [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="ebaca-132">とのログリーダーエージェントを実行するときに使用する Windows 資格情報を指定し **@job_name** **@job_password** ます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-133">エージェントがパブリッシャーに接続する際に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 認証を使用する場合、さらに **@publisher_security_mode** @allow_subscriber_initiated_snapshot **@publisher_security_mode** に指定し、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] と **@publisher_login** と **@publisher_password**」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="ebaca-134">これにより、パブリケーション データベース用のログ リーダー エージェント ジョブが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ebaca-135">この手順はトランザクション パブリケーションにのみ適用されます。スナップショット パブリケーションの場合は不要です。</span><span class="sxs-lookup"><span data-stu-id="ebaca-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="ebaca-136">(省略可能) [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) の前に、ディストリビューター側のディストリビューション データベースに [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="ebaca-137">とのキューリーダーエージェントを実行するときに使用する Windows 資格情報を指定し **@job_name** **@job_password** ます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-138">これにより、ディストリビューター用のキュー リーダー エージェント ジョブが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ebaca-139">この手順は、キュー更新サブスクライバーをサポートするトランザクション パブリケーションでのみ必要です。</span><span class="sxs-lookup"><span data-stu-id="ebaca-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="ebaca-140">(省略可) [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) の実行を更新して、新しいレプリケーション機能を実装するパラメーターに既定以外の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="ebaca-141">パブリッシャー側のパブリケーション データベースに対して、[sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) の後に、[sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="ebaca-142">**@publication**とにスナップショットエージェントを実行するときに使用する Windows 資格情報を指定し **@job_name** **@job_password** ます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-143">エージェントがパブリッシャーに接続する際に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 認証を使用する場合、さらに **@publisher_security_mode** @allow_subscriber_initiated_snapshot **@publisher_security_mode** に指定し、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] と **@publisher_login** と **@publisher_password**」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="ebaca-144">これにより、パブリケーション用のスナップショット エージェント ジョブが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="ebaca-145">(省略可) [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) の実行を更新して、新しいレプリケーション機能を実装するパラメーターに既定以外の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="ebaca-146">スナップショット パブリケーションまたはトランザクション パブリケーションにサブスクリプションを追加するスクリプトをアップグレードするには</span><span class="sxs-lookup"><span data-stu-id="ebaca-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="ebaca-147">サブスクリプションを作成するストアド プロシージャを実行した後、ディストリビューション エージェント ジョブを作成するストアド プロシージャを実行して、サブスクリプションを同期するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="ebaca-148">使用するストアド プロシージャは、サブスクリプションの種類に応じて変わります。</span><span class="sxs-lookup"><span data-stu-id="ebaca-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="ebaca-149">プル サブスクリプションの場合、[sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) の実行を更新して、サブスクライバーでディストリビューション エージェントを実行するときの Windows 資格情報を **@job_name** と **@job_password** に指定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-150">この操作は、 [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)の実行後に行われます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="ebaca-151">詳細については、「 [プル サブスクリプションの作成](../create-a-pull-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="ebaca-152">プッシュ サブスクリプションの場合、パブリッシャーで、[sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="ebaca-153">**@subscriber**、、 **@subscriber_db** **@publication** 、ディストリビューションエージェントをディストリビューターで実行するときに使用する Windows 資格情報 **@job_name** と、 **@job_password** このエージェントジョブのスケジュールを指定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="ebaca-154">詳細については、「 [Specify Synchronization Schedules](../specify-synchronization-schedules.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="ebaca-155">この操作は、 [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)の実行後に行われます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="ebaca-156">詳細については、「 [プッシュ サブスクリプションの作成](../create-a-push-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="ebaca-157">マージ パブリケーションを構成するスクリプトをアップグレードするには</span><span class="sxs-lookup"><span data-stu-id="ebaca-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="ebaca-158">(省略可) 既存のスクリプトで、[sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) の実行を更新して、新しいレプリケーション機能を実装するパラメーターに既定以外の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="ebaca-159">パブリッシャー側のパブリケーション データベースに対して、[sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) の後に、[sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="ebaca-160">**@publication**とにスナップショットエージェントを実行するときに使用する Windows 資格情報を指定し **@job_name** **@job_password** ます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-161">エージェントがパブリッシャーに接続する際に [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 認証を使用する場合、さらに **@publisher_security_mode** @allow_subscriber_initiated_snapshot **@publisher_security_mode** に指定し、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] と **@publisher_login** と **@publisher_password**」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="ebaca-162">これにより、パブリケーション用のスナップショット エージェント ジョブが作成されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="ebaca-163">(省略可) [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) の実行を更新して、新しいレプリケーション機能を実装するパラメーターに既定以外の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="ebaca-164">マージ パブリケーションにサブスクリプションを追加するスクリプトをアップグレードするには</span><span class="sxs-lookup"><span data-stu-id="ebaca-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="ebaca-165">サブスクリプションを作成するストアド プロシージャを実行した後、マージ エージェント ジョブを作成するストアド プロシージャを実行して、サブスクリプションを同期するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="ebaca-166">使用するストアド プロシージャは、サブスクリプションの種類に応じて変わります。</span><span class="sxs-lookup"><span data-stu-id="ebaca-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="ebaca-167">プル サブスクリプションの場合、[sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) の実行を更新して、サブスクライバーでマージ エージェントを実行するときの Windows 資格情報を **@job_name** と **@job_password** に指定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="ebaca-168">この操作は、 [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql)の実行後に行われます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="ebaca-169">詳細については、「 [プル サブスクリプションの作成](../create-a-pull-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="ebaca-170">プッシュ サブスクリプションの場合、パブリッシャーで、[sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) を実行します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="ebaca-171">、、を指定し、 **@subscriber** **@subscriber_db** **@publication** ディストリビューターでのマージエージェントの実行に使用する Windows 資格情報をおよびに指定し、 **@job_name** **@job_password** このエージェントジョブのスケジュールを指定します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="ebaca-172">詳細については、「 [Specify Synchronization Schedules](../specify-synchronization-schedules.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="ebaca-173">この操作は、 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)の実行後に行われます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="ebaca-174">詳細については、「 [プッシュ サブスクリプションの作成](../create-a-push-subscription.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ebaca-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="ebaca-175">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-175">Example</span></span>  
 <span data-ttu-id="ebaca-176">次に、Product テーブルに関するトランザクション パブリケーションを作成する [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] スクリプトの例を示します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="ebaca-177">このパブリケーションでは、フェールオーバーとしてキュー更新を使用する即時更新がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="ebaca-178">読みやすくするために、既定のパラメーターは削除されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-179">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-179">Example</span></span>  
 <span data-ttu-id="ebaca-180">次に、トランザクション パブリケーションを作成する古いスクリプトをアップグレードする例を示します。これは [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンで正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ebaca-181">このパブリケーションでは、フェールオーバーとしてキュー更新を使用する即時更新がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="ebaca-182">新しいパラメーターの既定値は、明示的に宣言されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebaca-183">Windows 資格情報は、 **sqlcmd** スクリプト変数を使用して実行時に指定されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-184">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-184">Example</span></span>  
 <span data-ttu-id="ebaca-185">次に、Customers テーブルに関するマージ パブリケーションを作成する [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] スクリプトの例を示します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="ebaca-186">読みやすくするために、既定のパラメーターは削除されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-187">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-187">Example</span></span>  
 <span data-ttu-id="ebaca-188">次に、マージ パブリケーションを作成する古いスクリプトの例を示します。アップグレードすることにより、 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンで正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ebaca-189">新しいパラメーターの既定値は、明示的に宣言されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebaca-190">Windows 資格情報は、 **sqlcmd** スクリプト変数を使用して実行時に指定されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-191">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-191">Example</span></span>  
 <span data-ttu-id="ebaca-192">次に、トランザクション パブリケーションへのプッシュ サブスクリプションを作成する [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] スクリプトの例を示します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="ebaca-193">読みやすくするために、既定のパラメーターは削除されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-194">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-194">Example</span></span>  
 <span data-ttu-id="ebaca-195">次に、トランザクション パブリケーションへのプッシュ サブスクリプションを作成する古いスクリプトの例を示します。アップグレードすることにより、 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンで正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ebaca-196">新しいパラメーターの既定値は、明示的に宣言されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebaca-197">Windows 資格情報は、 **sqlcmd** スクリプト変数を使用して実行時に指定されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-198">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-198">Example</span></span>  
 <span data-ttu-id="ebaca-199">次に、マージ パブリケーションへのプッシュ サブスクリプションを作成する [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] スクリプトの例を示します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="ebaca-200">読みやすくするために、既定のパラメーターは削除されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-201">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-201">Example</span></span>  
 <span data-ttu-id="ebaca-202">次に、マージ パブリケーションへのプッシュ サブスクリプションを作成する古いスクリプトの例を示します。アップグレードすることにより、 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンで正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ebaca-203">新しいパラメーターの既定値は、明示的に宣言されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebaca-204">Windows 資格情報は、 **sqlcmd** スクリプト変数を使用して実行時に指定されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-205">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-205">Example</span></span>  
 <span data-ttu-id="ebaca-206">次に、トランザクション パブリケーションへのプル サブスクリプションを作成する [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] スクリプトの例を示します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="ebaca-207">読みやすくするために、既定のパラメーターは削除されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-208">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-208">Example</span></span>  
 <span data-ttu-id="ebaca-209">次に、トランザクション パブリケーションへのプル サブスクリプションを作成する古いスクリプトの例を示します。アップグレードすることにより、 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンで正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ebaca-210">新しいパラメーターの既定値は、明示的に宣言されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebaca-211">Windows 資格情報は、 **sqlcmd** スクリプト変数を使用して実行時に指定されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-212">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-212">Example</span></span>  
 <span data-ttu-id="ebaca-213">次に、マージ パブリケーションへのプル サブスクリプションを作成する [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] スクリプトの例を示します。</span><span class="sxs-lookup"><span data-stu-id="ebaca-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="ebaca-214">読みやすくするために、既定のパラメーターは削除されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="ebaca-215">例</span><span class="sxs-lookup"><span data-stu-id="ebaca-215">Example</span></span>  
 <span data-ttu-id="ebaca-216">次に、マージ パブリケーションへのプル サブスクリプションを作成する古いスクリプトの例を示します。アップグレードすることにより、 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以降のバージョンで正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="ebaca-217">新しいパラメーターの既定値は、明示的に宣言されています。</span><span class="sxs-lookup"><span data-stu-id="ebaca-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebaca-218">Windows 資格情報は、 **sqlcmd** スクリプト変数を使用して実行時に指定されます。</span><span class="sxs-lookup"><span data-stu-id="ebaca-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="ebaca-219">参照</span><span class="sxs-lookup"><span data-stu-id="ebaca-219">See Also</span></span>  
 <span data-ttu-id="ebaca-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="ebaca-221">[ssSDSFull](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="ebaca-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="ebaca-223">[レプリケーションのセキュリティ設定の表示および変更](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="ebaca-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="ebaca-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="ebaca-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="ebaca-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="ebaca-227">レプリケートされたデータベースのアップグレード</span><span class="sxs-lookup"><span data-stu-id="ebaca-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  
