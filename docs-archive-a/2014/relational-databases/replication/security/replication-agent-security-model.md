---
title: レプリケーション エージェントのセキュリティ モデル | Microsoft Docs
ms.custom: ''
ms.date: 10/07/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Snapshot Agent, security
- agents [SQL Server replication], security
- Distribution Agent, security
- logins [SQL Server replication], permissions for agents
- security [SQL Server replication], agent security model
- Log Reader Agent, security
- Queue Reader Agent, security
- Merge Agent, security
- replication [SQL Server], agents and profiles
ms.assetid: 6d09fc8d-843a-4a7a-9812-f093d99d8192
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: da597bf97422f5a0960062b385bc0b67338edfe1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87630897"
---
# <a name="replication-agent-security-model"></a><span data-ttu-id="3c0cc-102">レプリケーション エージェントのセキュリティ モデル</span><span class="sxs-lookup"><span data-stu-id="3c0cc-102">Replication Agent Security Model</span></span>
  <span data-ttu-id="3c0cc-103">レプリケーション エージェントのセキュリティ モデルでは、レプリケーション エージェントの実行や接続に使用されるアカウントをきめ細かく制御できます。異なるアカウントをエージェントごとに指定できます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-103">The replication agent security model allows for fine-grained control over the accounts under which replication agents run and make connections: A different account can be specified for each agent.</span></span> <span data-ttu-id="3c0cc-104">アカウントを指定する方法の詳細については、「[レプリケーションのログインとパスワードの管理](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-104">For more information about how to specify accounts, see [Manage Logins and Passwords in Replication](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3c0cc-105">**sysadmin** 固定サーバー ロールのメンバーがレプリケーションを構成する際には、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] エージェント アカウントの権限を借用するようにレプリケーション エージェントを構成できます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-105">When a member of the **sysadmin** fixed server role configures replication, replication agents can be configured to impersonate the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent account.</span></span> <span data-ttu-id="3c0cc-106">このとき、レプリケーション エージェントのログインとパスワードを指定する必要はありませんが、その方法はお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-106">This is done by not specifying a login and password for a replication agent; however, we do not recommend this approach.</span></span> <span data-ttu-id="3c0cc-107">セキュリティ上、このトピックの「エージェントに必要な権限」に記載されている最小限の権限を持った各エージェントのアカウントを指定することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-107">Instead, as a security best practice, we recommend that you specify an account for each agent that has the minimum permissions that are described in the section "Permissions That Are Required by Agents" later in this topic.</span></span>  
  
 <span data-ttu-id="3c0cc-108">レプリケーション エージェントは、他の実行可能プログラムと同様に、Windows アカウントのコンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-108">Replication agents, like all executables, run under the context of a Windows account.</span></span> <span data-ttu-id="3c0cc-109">このアカウントを使用して、Windows 統合セキュリティ接続が作成されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-109">The agents make Windows Integrated Security connections by using this account.</span></span> <span data-ttu-id="3c0cc-110">エージェントを実行するアカウントは、エージェントの開始方法で決まります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-110">The account under which the agent runs depends on how the agent is started:</span></span>  
  
-   <span data-ttu-id="3c0cc-111">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] エージェント ジョブからエージェントを開始する (既定): [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] エージェント ジョブを使用してレプリケーション エージェントを開始すると、エージェントはレプリケーションを構成するときに指定したアカウントのコンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-111">Starting the agent from a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job, the default: When a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job is used to start a replication agent, the agent runs under the context of an account that you specify when you configure replication.</span></span> <span data-ttu-id="3c0cc-112">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] エージェントおよびレプリケーションの詳細については、このトピックの「SQL Server エージェントのエージェント セキュリティ」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-112">For more information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent and replication, see the section "Agent Security under SQL Server Agent" later in this topic.</span></span> <span data-ttu-id="3c0cc-113">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] エージェントを実行するアカウントに必要な権限の詳細については、「[Configure SQL Server Agent](../../../ssms/agent/configure-sql-server-agent.md)」 (SQL Server エージェントの構成) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-113">For information about the permissions that are required for the account under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent runs, see [Configure SQL Server Agent](../../../ssms/agent/configure-sql-server-agent.md).</span></span>  
  
-   <span data-ttu-id="3c0cc-114">MS-DOS コマンド ラインから直接、またはスクリプトによってエージェントを開始する: エージェントは、コマンド ラインでエージェントを実行しているユーザーのアカウントのコンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-114">Starting the agent from an MS-DOS command line, either directly or through a script: The agent runs under the context of the account of the user that is running the agent at the command line.</span></span>  
  
-   <span data-ttu-id="3c0cc-115">レプリケーション管理オブジェクト (RMO) を使用するアプリケーションまたは ActiveX コントロールからエージェントを開始する: エージェントは、RMO を呼び出しているアプリケーションまたは ActiveX コントロールのコンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-115">Starting the agent from an application that uses Replication Management Objects (RMO) or an ActiveX control: The agent runs under the context of the application that is calling RMO or the ActiveX control.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3c0cc-116">ActiveX コントロールは非推奨とされます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-116">ActiveX controls are deprecated.</span></span>  
  
 <span data-ttu-id="3c0cc-117">Windows 統合セキュリティのコンテキストで接続することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-117">We recommend that connections be made under the context of Windows Integrated Security.</span></span> <span data-ttu-id="3c0cc-118">また、旧バージョンとの互換性のために [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] セキュリティを使用できます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-118">For backward compatibility, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Security can also be used.</span></span> <span data-ttu-id="3c0cc-119">推奨事項の詳細については、「 [Replication Security Best Practices](replication-security-best-practices.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-119">For more information about best practices, see [Replication Security Best Practices](replication-security-best-practices.md).</span></span>  
  
## <a name="permissions-that-are-required-by-agents"></a><span data-ttu-id="3c0cc-120">エージェントに必要な権限</span><span class="sxs-lookup"><span data-stu-id="3c0cc-120">Permissions That Are Required by Agents</span></span>  
 <span data-ttu-id="3c0cc-121">エージェントを実行して接続するアカウントには、さまざまな権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-121">The accounts under which agents run and make connections require a variety of permissions.</span></span> <span data-ttu-id="3c0cc-122">これらの権限を次の表に詳しく示します。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-122">These permissions are described in the following table.</span></span> <span data-ttu-id="3c0cc-123">各エージェントは異なる Windows アカウントで実行することをお勧めします。また、このアカウントには、必要な権限のみ許可してください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-123">We recommend that each agent run under a different Windows account and the account should be granted only the required permissions.</span></span> <span data-ttu-id="3c0cc-124">複数のエージェントに関連するパブリケーション アクセス リスト (PAL) の詳細については、「[Secure the Publisher](secure-the-publisher.md)」 (パブリッシャーのセキュリティ保護) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-124">For information about the publication access list (PAL), which is relevant for a number of agents, see [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3c0cc-125">特定の Windows オペレーティング システム内のユーザー アカウント制御 (UAC) により、スナップショット共有への管理アクセスが妨害される場合があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-125">User Account Control (UAC) in some Windows operating systems can prevent administrative access to the snapshot share.</span></span> <span data-ttu-id="3c0cc-126">このため、スナップショット エージェント、ディストリビューション エージェント、およびマージ エージェントによって使用される Windows アカウントに、スナップショット共有の権限を明示的に与える必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-126">You must therefore explicitly grant snapshot share permissions to the Windows accounts that are used by the Snapshot Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="3c0cc-127">この操作は、Windows アカウントが Administrators グループのメンバーである場合にも必要です。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-127">You must do this even if the Windows accounts are members of the Administrators group.</span></span> <span data-ttu-id="3c0cc-128">詳細については、「[Secure the Snapshot Folder](secure-the-snapshot-folder.md)」(スナップショット フォルダーのセキュリティ保護) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-128">For more information, see [Secure the Snapshot Folder](secure-the-snapshot-folder.md).</span></span>  
  
|<span data-ttu-id="3c0cc-129">エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-129">Agent</span></span>|<span data-ttu-id="3c0cc-130">アクセス許可</span><span class="sxs-lookup"><span data-stu-id="3c0cc-130">Permissions</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3c0cc-131">スナップショット エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-131">Snapshot Agent</span></span>|<span data-ttu-id="3c0cc-132">このエージェントを実行する Windows アカウントは、ディストリビューターに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-132">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="3c0cc-133">このアカウントは、次の条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-133">This account must:</span></span><br /><br /> <span data-ttu-id="3c0cc-134">\- 最低でも、ディストリビューション データベースで **db_owner** 固定データベース ロールのメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-134">-At minimum, be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="3c0cc-135">\- スナップショット共有に対する読み取り、書き込み、変更権限がある。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-135">-Have read, write, and modify permissions on the snapshot share.</span></span><br /><br /> <br /><br /> <span data-ttu-id="3c0cc-136">パブリッシャーへの接続に使用されるアカウントは、最低でもパブリケーション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-136">The account that is used to connect to the Publisher must at minimum be a member of the **db_owner** fixed database role in the publication database.</span></span>|  
|<span data-ttu-id="3c0cc-137">ログ リーダー エージェント (Log Reader Agent)</span><span class="sxs-lookup"><span data-stu-id="3c0cc-137">Log Reader Agent</span></span>|<span data-ttu-id="3c0cc-138">このエージェントを実行する Windows アカウントは、ディストリビューターに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-138">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="3c0cc-139">このアカウントは、最低でもディストリビューション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-139">This account must at minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="3c0cc-140">パブリッシャーへの接続に使用されるアカウントは、最低でもパブリケーション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-140">The account that is used to connect to the Publisher must at minimum be a member of the **db_owner** fixed database role in the publication database.</span></span><br /><br /> <span data-ttu-id="3c0cc-141">`sync_type`*レプリケーションのサポートのみ*を選択する場合、*バックアップで初期化*する場合、または*lsn から初期化*する場合は、実行後にログリーダーエージェントを実行する必要があり `sp_addsubscription` ます。これにより、セットアップスクリプトがディストリビューションデータベースに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-141">When selecting the `sync_type` options *replication support only*, *initialize with backup*, or *initialize from lsn*, the log reader agent must run after executing `sp_addsubscription`, so that the set-up scripts are written to the distribution database.</span></span> <span data-ttu-id="3c0cc-142">ログ リーダー エージェントが、 **sysadmin** 固定サーバー ロールのメンバーであるアカウントで実行されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-142">The log reader agent must be running under an account that is a member of the **sysadmin** fixed server role.</span></span> <span data-ttu-id="3c0cc-143">この `sync_type` オプションが [*自動*] に設定されている場合、特別なログリーダーエージェントの操作は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-143">When the `sync_type` option is set to *Automatic*, no special log reader agent actions are required.</span></span>|  
|<span data-ttu-id="3c0cc-144">プッシュ サブスクリプションのディストリビューション エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-144">Distribution Agent for a push subscription</span></span>|<span data-ttu-id="3c0cc-145">このエージェントを実行する Windows アカウントは、ディストリビューターに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-145">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="3c0cc-146">このアカウントは、次の条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-146">This account must:</span></span><br /><br /> <span data-ttu-id="3c0cc-147">\- 最低でも、ディストリビューション データベースで **db_owner** 固定データベース ロールのメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-147">-At minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="3c0cc-148">\- PAL のメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-148">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="3c0cc-149">\- スナップショット共有に対する読み取り権限を持っている。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-149">-Have read permissions on the snapshot share.</span></span><br /><br /> <span data-ttu-id="3c0cc-150">\- サブスクリプションが SQL Server 以外のサブスクライバー用の場合、サブスクライバーの OLE DB プロバイダーのインストール ディレクトリに対する読み取り権限を持っている。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-150">-Have read permissions on the installation directory of the OLE DB provider for the Subscriber if the subscription is for a non-SQL Server Subscriber.</span></span><br /><br /> <span data-ttu-id="3c0cc-151">\- LOB データをレプリケートする場合、ディストリビューション エージェントにはレプリケーションの **C:\Program Files\Microsoft SQL Server\XX\COMfolder** に対する書き込みアクセス許可が必要です。ここで XX はインスタンス ID を表します。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-151">-When replicating LOB data, the distribution agent must have write permissions on the replication **C:\Program Files\Microsoft SQL Server\XX\COMfolder** where XX represents the instanceID.</span></span><br /><br /> <br /><br /> <span data-ttu-id="3c0cc-152">サブスクライバーへの接続に使用されるアカウントは、最低でもサブスクリプション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。サブスクリプションが SQL Server 以外のサブスクライバー用である場合は、同等の権限を持っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-152">The account that is used to connect to the Subscriber must at minimum be a member of the **db_owner** fixed database role in the subscription database, or have equivalent permissions if the subscription is for a non-SQL Server Subscriber.</span></span><br /><br /> <span data-ttu-id="3c0cc-153">注: ディストリビューションエージェントでを使用する場合は `-subscriptionstreams >= 2` `View Server State` 、デッドロックを検出するためにサブスクライバーに対する権限も許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-153">Note: When using `-subscriptionstreams >= 2` on the distribution agent you must also grant the `View Server State` permission on the subscribers to detect deadlocks.</span></span>|  
|<span data-ttu-id="3c0cc-154">プル サブスクリプションのディストリビューション エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-154">Distribution Agent for a pull subscription</span></span>|<span data-ttu-id="3c0cc-155">このエージェントを実行する Windows アカウントは、サブスクライバーに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-155">The Windows account under which the agent runs is used when it makes connections to the Subscriber.</span></span> <span data-ttu-id="3c0cc-156">このアカウントは、最低でもサブスクリプション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-156">This account must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span> <span data-ttu-id="3c0cc-157">ディストリビューターへの接続に使用されるアカウントは、次の条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-157">The account that is used to connect to the Distributor must:</span></span><br /><br /> <span data-ttu-id="3c0cc-158">\- PAL のメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-158">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="3c0cc-159">\- スナップショット共有に対する読み取り権限を持っている。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-159">-Have read permissions on the snapshot share.</span></span><br /><br /> <span data-ttu-id="3c0cc-160">\- LOB データをレプリケートする場合、ディストリビューション エージェントにはレプリケーションの **C:\Program Files\Microsoft SQL Server\XX\COMfolder** に対する書き込みアクセス許可が必要です。ここで XX はインスタンス ID を表します。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-160">-When replicating LOB data, the distribution agent must have write permissions on the replication **C:\Program Files\Microsoft SQL Server\XX\COMfolder** where XX represents the instanceID.</span></span><br /><br /> <br /><br /> <span data-ttu-id="3c0cc-161">注: ディストリビューションエージェントでを使用する場合は `-subscriptionstreams >= 2` `View Server State` 、デッドロックを検出するためにサブスクライバーに対する権限も許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-161">Note: When using `-subscriptionstreams >= 2` on the distribution agent you must also grant the `View Server State` permission on the subscribers to detect deadlocks.</span></span>|  
|<span data-ttu-id="3c0cc-162">プッシュ サブスクリプションのマージ エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-162">Merge Agent for a push subscription</span></span>|<span data-ttu-id="3c0cc-163">このエージェントを実行する Windows アカウントは、パブリッシャーおよびディストリビューターに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-163">The Windows account under which the agent runs is used when it makes connections to the Publisher and Distributor.</span></span> <span data-ttu-id="3c0cc-164">このアカウントは、次の条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-164">This account must:</span></span><br /><br /> <span data-ttu-id="3c0cc-165">\- 最低でも、ディストリビューション データベースで **db_owner** 固定データベース ロールのメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-165">-At minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="3c0cc-166">\- PAL のメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-166">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="3c0cc-167">- パブリケーション データベースのユーザーに関連付けられたログインである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-167">-Be a login that is associated with a user in the publication database.</span></span><br /><br /> <span data-ttu-id="3c0cc-168">\- スナップショット共有に対する読み取り権限を持っている。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-168">-Have read permissions on the snapshot share.</span></span><br /><br /> <br /><br /> <span data-ttu-id="3c0cc-169">サブスクライバーへの接続に使用されるアカウントは、最低でもサブスクリプション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-169">The account used to connect to the Subscriber must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span>|  
|<span data-ttu-id="3c0cc-170">プル サブスクリプションのマージ エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-170">Merge Agent for a pull subscription</span></span>|<span data-ttu-id="3c0cc-171">このエージェントを実行する Windows アカウントは、サブスクライバーに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-171">The Windows account under which the agent runs is used when it makes connections to the Subscriber.</span></span> <span data-ttu-id="3c0cc-172">このアカウントは、最低でもサブスクリプション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-172">This account must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span> <span data-ttu-id="3c0cc-173">パブリッシャーおよびディストリビューターへの接続に使用されるアカウントは、次の条件を満たしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-173">The account that is used to connect to the Publisher and Distributor must:</span></span><br /><br /> <span data-ttu-id="3c0cc-174">\- PAL のメンバーである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-174">-Be a member of the PAL.</span></span><br /><br /> <span data-ttu-id="3c0cc-175">- パブリケーション データベースのユーザーに関連付けられたログインである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-175">-Be a login associated with a user in the publication database.</span></span><br /><br /> <span data-ttu-id="3c0cc-176">\- ディストリビューション データベース内のユーザーに関連付けられたログインである。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-176">-Be a login associated with a user in the distribution database.</span></span> <span data-ttu-id="3c0cc-177">`Guest` ユーザーでもかまいません。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-177">The user can be the `Guest` user.</span></span><br /><br /> <span data-ttu-id="3c0cc-178">\- スナップショット共有に対する読み取り権限を持っている。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-178">-Have read permissions on the snapshot share.</span></span>|  
|<span data-ttu-id="3c0cc-179">キュー リーダー エージェント (Queue Reader Agent)</span><span class="sxs-lookup"><span data-stu-id="3c0cc-179">Queue Reader Agent</span></span>|<span data-ttu-id="3c0cc-180">このエージェントを実行する Windows アカウントは、ディストリビューターに接続するときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-180">The Windows account under which the agent runs is used when it makes connections to the Distributor.</span></span> <span data-ttu-id="3c0cc-181">このアカウントは、最低でもディストリビューション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-181">This account must at minimum be a member of the **db_owner** fixed database role in the distribution database.</span></span><br /><br /> <span data-ttu-id="3c0cc-182">パブリッシャーへの接続に使用されるアカウントは、最低でもパブリケーション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-182">The account that is used to connect to the Publisher must at minimum be a member of the **db_owner** fixed database role in the publication database.</span></span><br /><br /> <span data-ttu-id="3c0cc-183">サブスクライバーへの接続に使用されるアカウントは、最低でもサブスクリプション データベースの **db_owner** 固定データベース ロールのメンバーである必要があります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-183">The account that is used to connect to the Subscriber must at minimum be a member of the **db_owner** fixed database role in the subscription database.</span></span>|  
  
## <a name="agent-security-under-sql-server-agent"></a><span data-ttu-id="3c0cc-184">SQL Server エージェントのエージェント セキュリティ</span><span class="sxs-lookup"><span data-stu-id="3c0cc-184">Agent Security Under SQL Server Agent</span></span>  
 <span data-ttu-id="3c0cc-185">[!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]、 [!INCLUDE[tsql](../../../includes/tsql-md.md)] プロシージャ、または RMO を使用してレプリケーションを構成すると、既定では各エージェントの [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] エージェント ジョブが作成されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-185">When you configure replication by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)] procedures, or RMO, a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent job is created by default for each agent.</span></span> <span data-ttu-id="3c0cc-186">その後エージェントは、連続実行、スケジュールを基にした実行、要求時実行にかかわらず、ジョブ ステップのコンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-186">Agents then run under the context of a job step, regardless of whether they run continuously, on a schedule, or on demand.</span></span> <span data-ttu-id="3c0cc-187">これらのジョブは、 **の** [ジョブ] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]フォルダーで表示できます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-187">You can view these jobs under the **Jobs** folder in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="3c0cc-188">次の表にジョブ名の一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-188">The following table lists the job names.</span></span>  
  
|<span data-ttu-id="3c0cc-189">エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-189">Agent</span></span>|<span data-ttu-id="3c0cc-190">ジョブ名</span><span class="sxs-lookup"><span data-stu-id="3c0cc-190">Job name</span></span>|  
|-----------|--------------|  
|<span data-ttu-id="3c0cc-191">スナップショット エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-191">Snapshot Agent</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<integer>**|  
|<span data-ttu-id="3c0cc-192">マージ パブリケーション パーティションに対するスナップショット エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-192">Snapshot Agent for a merge publication partition</span></span>|<span data-ttu-id="3c0cc-193">**Dyn_\<Publisher>-\<PublicationDatabase>-\<Publication>-\<GUID>**</span><span class="sxs-lookup"><span data-stu-id="3c0cc-193">**Dyn_\<Publisher>-\<PublicationDatabase>-\<Publication>-\<GUID>**</span></span>|  
|<span data-ttu-id="3c0cc-194">ログ リーダー エージェント (Log Reader Agent)</span><span class="sxs-lookup"><span data-stu-id="3c0cc-194">Log Reader Agent</span></span>|**\<Publisher>-\<PublicationDatabase>-\<integer>**|  
|<span data-ttu-id="3c0cc-195">プル サブスクリプションに対するマージ エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-195">Merge Agent for pull subscriptions</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<SubscriptionDatabase>-\<integer>**|  
|<span data-ttu-id="3c0cc-196">プッシュ サブスクリプションに対するマージ エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-196">Merge Agent for push subscriptions</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>**|  
|<span data-ttu-id="3c0cc-197">プッシュ サブスクリプションに対するディストリビューション エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-197">Distribution Agent for push subscriptions</span></span>|<span data-ttu-id="3c0cc-198">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>** <sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="3c0cc-198">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>** <sup>1</sup></span></span>|  
|<span data-ttu-id="3c0cc-199">プル サブスクリプションに対するディストリビューション エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-199">Distribution Agent for pull subscriptions</span></span>|<span data-ttu-id="3c0cc-200">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<SubscriptionDatabase>-\<GUID>** <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="3c0cc-200">**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<SubscriptionDatabase>-\<GUID>** <sup>2</sup></span></span>|  
|<span data-ttu-id="3c0cc-201">SQL Server 以外のサブスクライバーへのプッシュ サブスクリプションに対するディストリビューション エージェント</span><span class="sxs-lookup"><span data-stu-id="3c0cc-201">Distribution Agent for push subscriptions to non-SQL Server Subscribers</span></span>|**\<Publisher>-\<PublicationDatabase>-\<Publication>-\<Subscriber>-\<integer>**|  
|<span data-ttu-id="3c0cc-202">キュー リーダー エージェント (Queue Reader Agent)</span><span class="sxs-lookup"><span data-stu-id="3c0cc-202">Queue Reader Agent</span></span>|<span data-ttu-id="3c0cc-203">**[\<Distributor>].\<integer>**</span><span class="sxs-lookup"><span data-stu-id="3c0cc-203">**[\<Distributor>].\<integer>**</span></span>|  
  
 <span data-ttu-id="3c0cc-204"><sup>1</sup> Oracle パブリケーションに対するプッシュサブスクリプションの場合、ジョブ名はではなく \* \* に \<Publisher> - \<Publisher**> **\<Publisher>-\<PublicationDatabase>** なります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-204"><sup>1</sup> For push subscriptions to Oracle publications, the job name is \*\*\<Publisher>-\<Publisher**> instead of **\<Publisher>-\<PublicationDatabase>**.</span></span>  
  
 <span data-ttu-id="3c0cc-205"><sup>2</sup> Oracle パブリケーションに対するプルサブスクリプションの場合、ジョブ名はではなく \* \* に \<Publisher> - \<DistributionDatabase**> **\<Publisher>-\<PublicationDatabase>** なります。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-205"><sup>2</sup> For pull subscriptions to Oracle publications, the job name is \*\*\<Publisher>-\<DistributionDatabase**> instead of **\<Publisher>-\<PublicationDatabase>**.</span></span>  
  
 <span data-ttu-id="3c0cc-206">レプリケーションの構成時には、エージェントを実行するアカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-206">When you configure replication, you specify accounts under which agents should run.</span></span> <span data-ttu-id="3c0cc-207">しかし、すべてのジョブ ステップは *プロキシ*のセキュリティ コンテキストで実行されます。そのためレプリケーションでは、指定したエージェント アカウントに対して、以下のマッピングが内部的に実行されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-207">However, all job steps run under the security context of a *proxy*; therefore, replication performs the following mappings internally for the agent accounts that you specify:</span></span>  
  
-   <span data-ttu-id="3c0cc-208">アカウントは、まず [!INCLUDE[tsql](../../../includes/tsql-md.md)] [CREATE CREDENTIAL](/sql/t-sql/statements/create-credential-transact-sql) ステートメントを使用して資格情報にマップされます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-208">The account is first mapped to a credential by using the [!INCLUDE[tsql](../../../includes/tsql-md.md)] [CREATE CREDENTIAL](/sql/t-sql/statements/create-credential-transact-sql) statement.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="3c0cc-209">エージェント プロキシは、資格情報を使用して Windows ユーザー アカウントに関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-209">Agent proxies use credentials to store information about Windows user accounts.</span></span>  
  
-   <span data-ttu-id="3c0cc-210">[sp_add_proxy](/sql/relational-databases/system-stored-procedures/sp-add-proxy-transact-sql) ストアド プロシージャが呼び出され、資格情報を使用してプロキシが作成されます。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-210">The [sp_add_proxy](/sql/relational-databases/system-stored-procedures/sp-add-proxy-transact-sql) stored procedure is called, and the credential is used to create a proxy..</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3c0cc-211">この情報は、適切なセキュリティ コンテキストでエージェントを実行する作業についての理解を深めるために提供されています。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-211">This information is provided to help you understand what is involved in running agents with the appropriate security context.</span></span> <span data-ttu-id="3c0cc-212">作成済みの資格情報またはプロキシは通常、直接操作する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="3c0cc-212">You should not have to interact directly with the credentials or proxies that have been created.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3c0cc-213">参照</span><span class="sxs-lookup"><span data-stu-id="3c0cc-213">See Also</span></span>  
 <span data-ttu-id="3c0cc-214">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="3c0cc-214">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="3c0cc-215">[SQL Server レプリケーションのセキュリティ](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="3c0cc-215">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="3c0cc-216">スナップショット フォルダーのセキュリティ保護</span><span class="sxs-lookup"><span data-stu-id="3c0cc-216">Secure the Snapshot Folder</span></span>](secure-the-snapshot-folder.md)  
  
  
