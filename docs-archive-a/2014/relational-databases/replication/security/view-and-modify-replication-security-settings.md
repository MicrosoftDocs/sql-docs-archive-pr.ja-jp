---
title: レプリケーションのセキュリティ設定の表示および変更 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- modifying replication security settings
- replication [SQL Server], security
- security [SQL Server replication], viewing settings
- viewing replication security settings
- security [SQL Server replication], modifying settings
ms.assetid: 67d79532-1482-4de1-ac9f-4a23d162c85e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8da4a6e8093c6f04e06b68448660e4096e9e5c22
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645512"
---
# <a name="view-and-modify-replication-security-settings"></a><span data-ttu-id="df2d8-102">レプリケーションのセキュリティ設定の表示および変更</span><span class="sxs-lookup"><span data-stu-id="df2d8-102">View and Modify Replication Security Settings</span></span>
  <span data-ttu-id="df2d8-103">このトピックでは、 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] で [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]、 [!INCLUDE[tsql](../../../includes/tsql-md.md)]、またはレプリケーション管理オブジェクト (RMO) を使用して、レプリケーションのセキュリティ設定を表示および変更する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-103">This topic describes how to view and modify replication security settings in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="df2d8-104">たとえば、ログ リーダー エージェントからパブリッシャーへの接続を SQL Server 認証から Windows 統合認証に変更したい場合や、Windows アカウントのパスワードを変更したときにエージェント ジョブの実行に使用する資格情報を変更したい場合があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-104">For example, you might want to change the connection of the Log Reader Agent to the Publisher from SQL Server Authentication to Windows Integrated Authentication, or you might need to change the credentials used to run an agent job when the Windows account password has changed.</span></span> <span data-ttu-id="df2d8-105">各エージェントで必要な権限の詳細については、「 [レプリケーション エージェント セキュリティ モデル](replication-agent-security-model.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-105">For information about the permissions required by each agent, see [Replication Agent Security Model](replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="df2d8-106">**このトピックの内容**</span><span class="sxs-lookup"><span data-stu-id="df2d8-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="df2d8-107">**作業を開始する準備:**</span><span class="sxs-lookup"><span data-stu-id="df2d8-107">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="df2d8-108">制限事項と制約事項</span><span class="sxs-lookup"><span data-stu-id="df2d8-108">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="df2d8-109">Security</span><span class="sxs-lookup"><span data-stu-id="df2d8-109">Security</span></span>](#Security)  
  
-   <span data-ttu-id="df2d8-110">**レプリケーションのセキュリティ設定を表示および変更するために使用するもの:**</span><span class="sxs-lookup"><span data-stu-id="df2d8-110">**To view and modify replication security settings, using:**</span></span>  
  
     [<span data-ttu-id="df2d8-111">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="df2d8-111">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="df2d8-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="df2d8-112">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="df2d8-113">レプリケーション管理オブジェクト (RMO)</span><span class="sxs-lookup"><span data-stu-id="df2d8-113">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
-   <span data-ttu-id="df2d8-114">**補足情報:** [レプリケーションのセキュリティ設定を変更した後](#FollowUp)</span><span class="sxs-lookup"><span data-stu-id="df2d8-114">**Follow Up:**  [After you modify replication security settings](#FollowUp)</span></span>  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="df2d8-115">はじめに</span><span class="sxs-lookup"><span data-stu-id="df2d8-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="df2d8-116">制限事項と制約事項</span><span class="sxs-lookup"><span data-stu-id="df2d8-116">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="df2d8-117">使用するストアド プロシージャは、エージェントの種類およびサーバー接続の種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-117">The stored procedures that you use will depend on the type of agent and the type of server connection.</span></span>  
  
-   <span data-ttu-id="df2d8-118">使用する RMO のクラスとプロパティは、エージェントの種類およびサーバー接続の種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-118">The RMO classes and properties you use depend on the type of agent and the type of server connection.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="df2d8-119">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="df2d8-119">Security</span></span>  
 <span data-ttu-id="df2d8-120">セキュリティ上の理由から、レプリケーション ストアド プロシージャによって返される結果セットでは、パスワードの実際の値はマスクされます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-120">For security reasons, the actual values of passwords are masked in result sets returned by replication stored procedures.</span></span>  
  
####  <a name="permissions"></a><a name="Permissions"></a> <span data-ttu-id="df2d8-121">Permissions</span><span class="sxs-lookup"><span data-stu-id="df2d8-121">Permissions</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="df2d8-122">SQL Server Management Studio の使用</span><span class="sxs-lookup"><span data-stu-id="df2d8-122">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="df2d8-123">次のダイアログ ボックスでセキュリティ設定を表示および変更します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-123">View and modify security settings in the following dialog boxes:</span></span>  
  
1.  <span data-ttu-id="df2d8-124">**[レプリケーション パスワードの更新]** ダイアログ ボックス。このダイアログ ボックスは、 **の** [レプリケーション] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]フォルダーから利用できます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-124">The **Update Replication Passwords** dialog box, which is available from the **Replication** folder of [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="df2d8-125">レプリケーション トポロジのサーバーで [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] アカウントまたは Windows アカウントのパスワードを変更する場合は、そのアカウントを使用する各エージェントのパスワードを更新するよりも、このダイアログ ボックスを使用してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-125">If you change the password for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] account or Windows account on a server in a replication topology, use this dialog box rather than updating the password for each agent that uses the account.</span></span> <span data-ttu-id="df2d8-126">複数のサーバー上のエージェントが同じアカウントを使用している場合は、それぞれのサーバーに接続してパスワードを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-126">If agents on more than one server use the same account, you must connect to each server and change the password.</span></span> <span data-ttu-id="df2d8-127">パスワードは、レプリケーションで使用されるすべての場所で更新されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-127">The password is updated in all of the places that replication uses the password.</span></span> <span data-ttu-id="df2d8-128">パスワードは、リンク サーバーなど、その他の場所では更新されません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-128">The password is not updated in other places, such as linked servers.</span></span>  
  
2.  <span data-ttu-id="df2d8-129">**[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスの **[エージェント セキュリティ]** ページ。</span><span class="sxs-lookup"><span data-stu-id="df2d8-129">The **Agent Security** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="df2d8-130">このダイアログ ボックスへのアクセス方法の詳細については、「[パブリケーション プロパティの表示および変更](../publish/view-and-modify-publication-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-130">For more information about accessing this dialog box, see [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
3.  <span data-ttu-id="df2d8-131">**[サブスクリプションのプロパティ - \<Subscription>]** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="df2d8-131">The **Subscription Properties - \<Subscription>** dialog box.</span></span> <span data-ttu-id="df2d8-132">このダイアログ ボックスへのアクセスの詳細については、「 [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) 」および「 [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-132">For more information about accessing this dialog box, see [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) and [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md).</span></span>  
  
4.  <span data-ttu-id="df2d8-133">**[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスと **[ディストリビューション データベースのプロパティ - \<Database>]** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="df2d8-133">The **Distributor Properties - \<Distributor>** and **Distribution Database Properties - \<Database>** dialog boxes.</span></span> <span data-ttu-id="df2d8-134">これらのダイアログ ボックスへのアクセスの詳細については、「 [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-134">For more information about accessing these dialog boxes, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
5.  <span data-ttu-id="df2d8-135">**[パブリッシャーのプロパティ - \<Publisher>]** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="df2d8-135">The **Publisher Properties - \<Publisher>** dialog box.</span></span> <span data-ttu-id="df2d8-136">このダイアログ ボックスへのアクセスの詳細については、「 [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-136">For more information about accessing this dialog box, [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
#### <a name="to-change-the-password-for-an-account-used-by-one-or-more-agents"></a><span data-ttu-id="df2d8-137">1 つ以上のエージェントによって使用されるアカウントのパスワードを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-137">To change the password for an account used by one or more agents</span></span>  
  
1.  <span data-ttu-id="df2d8-138">アカウントが SQL Server アカウントの場合、このダイアログ ボックスによって SQL Server アカウントのパスワードも変更されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-138">If the account is a SQL Server account, this dialog box will also change the password for the SQL Server account.</span></span> <span data-ttu-id="df2d8-139">アカウントが Windows アカウントの場合は、最初に Windows でパスワードを変更します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-139">If the account is a Windows account, change the password in Windows first.</span></span> <span data-ttu-id="df2d8-140">詳細については、Windows のマニュアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-140">For more information, see the Windows documentation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-141">レプリケーション パスワードを変更したら、そのパスワードを使用する各エージェントを停止して再起動し、エージェントに対して変更を反映させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-141">After changing a replication password, you must stop and restart each agent that uses the password before the change takes effect for that agent.</span></span>  
  
2.  <span data-ttu-id="df2d8-142">[!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]でサーバーに接続して、サーバー ノードを展開します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-142">Connect to the server in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
3.  <span data-ttu-id="df2d8-143">**[レプリケーション]** フォルダーを右クリックし、 **[レプリケーション パスワードの更新]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-143">Right-click the **Replication** folder, and then click **Update Replication Passwords**.</span></span>  
  
4.  <span data-ttu-id="df2d8-144">**[レプリケーション パスワードの更新]** ダイアログ ボックスで、アカウントと新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-144">In the **Update Replication Passwords** dialog box, specify the account and the new password.</span></span>  
  
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent"></a><span data-ttu-id="df2d8-145">スナップショット エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-145">To change security settings for the Snapshot Agent</span></span>  
  
1.  <span data-ttu-id="df2d8-146">**[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスの **[エージェント セキュリティ]** ページで、 **[スナップショット エージェント]** テキスト ボックスの横にある **[セキュリティ設定]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-146">On the **Agent Security** page of the **Publication Properties - \<Publication>** dialog box, click the **Security Settings** button next to the **Snapshot Agent** text box.</span></span>  
  
2.  <span data-ttu-id="df2d8-147">**[スナップショット エージェントのセキュリティ]** ダイアログ ボックスで、エージェントを実行するアカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-147">In the **Snapshot Agent Security** dialog box, specify the account under which the agent should run:</span></span>  
  
    -   <span data-ttu-id="df2d8-148">**[プロセス アカウント]** テキスト ボックスに新しい Windows アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-148">Enter a new Windows account in the **Agent account** text box.</span></span>  
  
    -   <span data-ttu-id="df2d8-149">**[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに、新しい複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-149">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
3.  <span data-ttu-id="df2d8-150">エージェントがディストリビューターからパブリッシャーに接続するときのコンテキストを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-150">Specify the context under which the agent should connect from the Distributor to the Publisher.</span></span> <span data-ttu-id="df2d8-151">**[次の SQL Server ログインを使用する]** を選択する場合は、ログインも指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-151">If you select **Using the following SQL Server login**, you must also specify the login:</span></span>  
  
    -   <span data-ttu-id="df2d8-152">**[ログイン]** テキスト ボックスにログインを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-152">Enter a login in the **Login** text box</span></span>  
  
    -   <span data-ttu-id="df2d8-153">**[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに、新しい複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-153">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-154">パブリッシャーが Oracle パブリッシャーの場合は、接続のコンテキストを **[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスで指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-154">If the Publisher is an Oracle Publisher, the connection context is specified in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="df2d8-155">コンテキストを変更する手順については、以下を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-155">See below for the procedure to change the context.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-log-reader-agent"></a><span data-ttu-id="df2d8-156">ログ リーダー エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-156">To change security settings for the Log Reader Agent</span></span>  
  
1.  <span data-ttu-id="df2d8-157">**[パブリケーションのプロパティ - \<Publication>]** ダイアログ ボックスの **[エージェント セキュリティ]** ページで、 **[ログ リーダー エージェント]** テキスト ボックスの横にある **[セキュリティ設定]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-157">On the **Agent Security** page of the **Publication Properties - \<Publication>** dialog box, click the **Security Settings** button next to the **Log Reader Agent** text box.</span></span>  
  
2.  <span data-ttu-id="df2d8-158">**[ログ リーダー エージェントのセキュリティ]** ダイアログ ボックスで、エージェントを実行するアカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-158">In the **Log Reader Agent Security** dialog box, specify the account under which the agent should run:</span></span>  
  
    -   <span data-ttu-id="df2d8-159">**[プロセス アカウント]** テキスト ボックスに新しい Windows アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-159">Enter a new Windows account in the **Agent account** text box</span></span>  
  
    -   <span data-ttu-id="df2d8-160">**[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに、新しい複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-160">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
3.  <span data-ttu-id="df2d8-161">エージェントがディストリビューターからパブリッシャーに接続するときのコンテキストを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-161">Specify the context under which the agent should connect from the Distributor to the Publisher.</span></span> <span data-ttu-id="df2d8-162">**[次の SQL Server ログインを使用する]** を選択する場合は、ログインも指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-162">If you select **Using the following SQL Server login**, you must also specify the login:</span></span>  
  
    -   <span data-ttu-id="df2d8-163">**[ログイン]** テキスト ボックスにログインを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-163">Enter a login in the **Login** text box</span></span>  
  
    -   <span data-ttu-id="df2d8-164">**[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに、新しい複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-164">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-165">パブリッシャーが Oracle パブリッシャーの場合は、接続のコンテキストを **[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスで指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-165">If the Publisher is an Oracle Publisher, the connection context is specified in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="df2d8-166">次の手順を使用して、コンテキストを変更します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-166">Change the context using the next procedure.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-167">ログ リーダー エージェントは、パブリッシュされているデータベースごとに 1 つ存在します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-167">There is one Log Reader Agent for each published database.</span></span> <span data-ttu-id="df2d8-168">1 つのパブリケーションでエージェントのセキュリティ設定を変更すると、パブリケーション データベースのすべてのパブリケーションの設定に影響が及びます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-168">Changing the security settings for the agent on one publication affects the settings for all publications in the publication database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-snapshot-agent-and-log-reader-agent-for-an-oracle-publication-make-connections-to-the-publisher"></a><span data-ttu-id="df2d8-169">Oracle パブリケーションのスナップショット エージェントおよびログ リーダー エージェントがパブリッシャーに接続するときのコンテキストを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-169">To change the context under which the Snapshot Agent and Log Reader Agent for an Oracle publication make connections to the Publisher</span></span>  
  
1.  <span data-ttu-id="df2d8-170">**[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスの **[パブリッシャー]** ページで、パブリッシャーの横にあるプロパティ ボタン ( **...** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-170">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties button (**...**) next to a Publisher.</span></span>  
  
2.  <span data-ttu-id="df2d8-171">**[パブリッシャーへのエージェント接続]** セクションで、構成したレプリケーション管理ユーザー スキーマによって使用されるログインとパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-171">In the **Agent Connection to the Publisher** section, specify the login and password used by the replication administrative user schema you configured.</span></span> <span data-ttu-id="df2d8-172">詳細については、「[Oracle パブリッシャーの構成](../non-sql/configure-an-oracle-publisher.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-172">For more information, see [Configure an Oracle Publisher](../non-sql/configure-an-oracle-publisher.md).</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription"></a><span data-ttu-id="df2d8-173">プッシュ サブスクリプションに対するディストリビューション エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-173">To change security settings for the Distribution Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-174">パブリッシャーの **[サブスクリプションのプロパティ - \<Subscription>]** ダイアログ ボックスでは、次の変更を加えることができます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-174">In the **Subscription Properties - \<Subscription>** dialog box at the Publisher, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="df2d8-175">ディストリビューション エージェントを実行してディストリビューターへ接続するアカウントを変更するには、 **[エージェント プロセス アカウント]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-175">To change the account under which the Distribution Agent runs and makes connections to the Distributor, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-176">**[ディストリビューション エージェント セキュリティ]** ダイアログ ボックスで、アカウントとパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-176">Specify an account and password in the **Distribution Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="df2d8-177">ディストリビューション エージェントがサブスクライバーに接続するときのコンテキストを変更するには、 **[サブスクライバー接続]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-177">To change the context under which the Distribution Agent connects to the Subscriber, click the **Subscriber Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-178">**[接続情報の入力]** ダイアログ ボックスでコンテキストを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-178">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
         <span data-ttu-id="df2d8-179">キュー更新サブスクリプションを使用する場合、ここで指定したコンテキストは、サブスクライバーに接続するためにキュー リーダー エージェントでも使用されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-179">If you use queued updating subscriptions, the Queue Reader Agent also uses the context specified here for connections to the Subscriber.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription"></a><span data-ttu-id="df2d8-180">プル サブスクリプションに対するディストリビューション エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-180">To change security settings for the Distribution Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-181">サブスクライバーの **[サブスクリプションのプロパティ - \<Subscription>]** ダイアログ ボックスでは、次の変更を加えることができます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-181">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="df2d8-182">ディストリビューション エージェントを実行してサブスクライバーへ接続するアカウントを変更するには、 **[エージェント プロセス アカウント]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-182">To change the account under which the Distribution Agent runs and makes connections to the Subscriber, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-183">**[ディストリビューション エージェント セキュリティ]** ダイアログ ボックスで、アカウントとパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-183">Specify an account and password in the **Distribution Agent Security** dialog box.</span></span>  
  
         <span data-ttu-id="df2d8-184">キュー更新サブスクリプションを使用する場合、ここで指定したコンテキストは、サブスクライバーに接続するためにキュー リーダー エージェントでも使用されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-184">If you use queued updating subscriptions, the Queue Reader Agent also uses the context specified here for connections to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="df2d8-185">ディストリビューション エージェントがディストリビューターに接続するときのコンテキストを変更するには、 **[ディストリビューター接続]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-185">To change the context under which the Distribution Agent connects to the Distributor, click the **Distributor Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-186">**[接続情報の入力]** ダイアログ ボックスでコンテキストを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-186">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription"></a><span data-ttu-id="df2d8-187">プッシュ サブスクリプションに対するマージ エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-187">To change security settings for the Merge Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-188">パブリッシャーの **[サブスクリプションのプロパティ - \<Subscription>]** ダイアログ ボックスでは、次の変更を加えることができます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-188">In the **Subscription Properties - \<Subscription>** dialog box at the Publisher, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="df2d8-189">マージ エージェントを実行してパブリッシャーおよびディストリビューターへ接続するアカウントを変更するには、 **[エージェント プロセス アカウント]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-189">To change the account under which the Merge Agent runs and makes connections to the Publisher and Distributor, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-190">**[マージ エージェント セキュリティ]** ダイアログ ボックスで、アカウントとパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-190">Specify an account and password in the **Merge Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="df2d8-191">マージ エージェントがサブスクライバーに接続するときのコンテキストを変更するには、 **[サブスクライバー接続]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-191">To change the context under which the Merge Agent connects to the Subscriber, click the **Subscriber Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-192">**[接続情報の入力]** ダイアログ ボックスでコンテキストを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-192">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription"></a><span data-ttu-id="df2d8-193">プル サブスクリプションに対するマージ エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-193">To change security settings for the Merge Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-194">サブスクライバーの **[サブスクリプションのプロパティ - \<Subscription>]** ダイアログ ボックスでは、次の変更を加えることができます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-194">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="df2d8-195">マージ エージェントを実行してサブスクライバーへ接続するアカウントを変更するには、 **[エージェント プロセス アカウント]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-195">To change the account under which the Merge Agent runs and makes connections to the Subscriber, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-196">**[マージ エージェント セキュリティ]** ダイアログ ボックスで、アカウントとパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-196">Specify an account and password in the **Merge Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="df2d8-197">マージ エージェントがパブリッシャーおよびディストリビューターに接続するときのコンテキストを変更するには、 **[パブリッシャー接続]** 行をクリックしてから、その行のプロパティ ボタン ( **[...]** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-197">To change the context under which the Merge Agent connects to the Publisher and Distributor, click the **Publisher Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="df2d8-198">**[接続情報の入力]** ダイアログ ボックスでコンテキストを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-198">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-the-account-under-which-the-queue-reader-agent-runs"></a><span data-ttu-id="df2d8-199">キュー リーダー エージェントを実行するアカウントを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-199">To change the account under which the Queue Reader Agent runs</span></span>  
  
1.  <span data-ttu-id="df2d8-200">**[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスの **[全般]** ページで、ディストリビューション データベースの横にあるプロパティ ボタン ( **...** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-200">On the **General** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties (**...**) button next to the distribution database.</span></span>  
  
2.  <span data-ttu-id="df2d8-201">**[ディストリビューション データベースのプロパティ - \<Database>]** ダイアログ ボックスで、 **[エージェント プロセス アカウント]** テキスト ボックスの横にある **[セキュリティ設定]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-201">In the **Distribution Database Properties - \<Database>** dialog box, click the **Security Settings** button next to the **Agent process account** text box.</span></span>  
  
3.  <span data-ttu-id="df2d8-202">**[キュー リーダー エージェントのセキュリティ]** ダイアログ ボックスで、エージェントを実行してディストリビューターへ接続するアカウントを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-202">In the **Queue Reader Agent Security** dialog box, specify the account under which the agent runs and makes connections to the Distributor:</span></span>  
  
    -   <span data-ttu-id="df2d8-203">**[プロセス アカウント]** テキスト ボックスに新しい Windows アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-203">Enter a new Windows account in the **Process account** text box</span></span>  
  
    -   <span data-ttu-id="df2d8-204">**[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに、新しい複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-204">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-205">ディストリビューション データベースには、それぞれ 1 つのキュー リーダー エージェントがあります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-205">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="df2d8-206">エージェントのセキュリティ設定を変更すると、このディストリビューション データベースを使用するすべてのパブリッシャーのすべてのパブリケーションの設定に影響が及びます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-206">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-queue-reader-agent-makes-connections-to-the-publisher"></a><span data-ttu-id="df2d8-207">キュー リーダー エージェントがパブリッシャーに接続するときのコンテキストを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-207">To change the context under which the Queue Reader Agent makes connections to the Publisher</span></span>  
  
1.  <span data-ttu-id="df2d8-208">**[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスの **[パブリッシャー]** ページで、パブリッシャーの横にあるプロパティ ボタン ( **...** ) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-208">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties button (**...**) next to the Publisher.</span></span>  
  
2.  <span data-ttu-id="df2d8-209">**[パブリッシャーへのエージェント接続]** セクションで、 **[エージェント接続モード]** オプションの **[エージェント プロセス アカウントを借用する]** または **[SQL Server 認証]** の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-209">In the **Agent Connection to the Publisher** section, specify a value of **Impersonate the agent process account** or **SQL Server Authentication** for the **Agent Connection Mode** option.</span></span> <span data-ttu-id="df2d8-210">**[SQL Server 認証]** を指定する場合は、 **[ログイン]** および **[パスワード]** の値も入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-210">If you specify **SQL Server Authentication**, also enter values for **Login** and **Password**.</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-211">ディストリビューション データベースには、それぞれ 1 つのキュー リーダー エージェントがあります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-211">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="df2d8-212">エージェントのセキュリティ設定を変更すると、このディストリビューション データベースを使用するすべてのパブリッシャーのすべてのパブリケーションの設定に影響が及びます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-212">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-queue-reader-agent-makes-connections-to-the-subscriber"></a><span data-ttu-id="df2d8-213">キュー リーダー エージェントがサブスクライバーに接続するときのコンテキストを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-213">To change the context under which the Queue Reader Agent makes connections to the Subscriber</span></span>  
  
-   <span data-ttu-id="df2d8-214">キュー リーダー エージェントは、ディストリビューション エージェントと同じ接続コンテキストをサブスクリプションに使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-214">The Queue Reader Agent uses the same connection context as the Distribution Agent for the subscription.</span></span> <span data-ttu-id="df2d8-215">詳細については、ディストリビューション エージェントに関する上記の手順を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-215">For more information, see the procedures above for the Distribution Agent.</span></span>  
  
#### <a name="to-change-security-settings-for-an-immediate-updating-pull-subscription"></a><span data-ttu-id="df2d8-216">即時更新プル サブスクリプションのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-216">To change security settings for an immediate updating pull subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-217">サブスクライバーの [**サブスクリプションの \<Subscription> プロパティ-** ] ダイアログボックスで、[**パブリッシャー接続**] 行をクリックし、行のプロパティボタン ([**...**]) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-217">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, click the **Publisher Connection** row, and then click the properties (**...**) button in the row.</span></span>  
  
2.  <span data-ttu-id="df2d8-218">**[接続情報の入力]** ダイアログ ボックスで、次のオプションのいずれかを選択します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-218">In the **Enter Connection Information** dialog box, select one of the following options:</span></span>  
  
    -   <span data-ttu-id="df2d8-219">**[リンク サーバーまたはリモート サーバーからのログインを使用します]** 。</span><span class="sxs-lookup"><span data-stu-id="df2d8-219">**Use a login from a linked or remote server**.</span></span> <span data-ttu-id="df2d8-220">[sp_addserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql)、[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)、[!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]、または他の方法を使用してサブスクライバ―とパブリッシャーの間にリモート サーバーまたはリンクされたサーバーを定義した場合は、このオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-220">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], or another method.</span></span>  
  
    -   <span data-ttu-id="df2d8-221">**[次のログインとパスワードによる SQL Server 認証を使用する]** 。</span><span class="sxs-lookup"><span data-stu-id="df2d8-221">**Use SQL Server Authentication with the following login and password**.</span></span> <span data-ttu-id="df2d8-222">サブスクライバーとパブリッシャーの間でリモート サーバーまたはリンク サーバーを定義していない場合は、このオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-222">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="df2d8-223">レプリケーションによってリンク サーバーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-223">Replication will create a linked server for you.</span></span> <span data-ttu-id="df2d8-224">指定するアカウントは、パブリッシャーに既に存在している必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-224">The account you specify must already exist at the Publisher.</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
> [!NOTE]  
>  <span data-ttu-id="df2d8-225">この手順により、サブスクライバーで変更が行われたときに、レプリケーション トリガーがサブスクライバーからパブリッシャーに接続するために使用する方法が変更されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-225">This procedure changes the method that replication triggers use to connect from the Subscriber to the Publisher when changes are made at the Subscriber.</span></span> <span data-ttu-id="df2d8-226">ディストリビューション エージェントに関連付けられている設定を即時更新サブスクリプション用に変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-226">You can also change settings associated with the Distribution Agent for an immediate updating subscription.</span></span> <span data-ttu-id="df2d8-227">詳細については、このトピックで既に説明した手順を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-227">For more information, see the procedures earlier in this topic.</span></span>  
>   
>  <span data-ttu-id="df2d8-228">この手順は、プル サブスクリプションにのみ当てはまります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-228">This procedure applies only to pull subscriptions.</span></span> <span data-ttu-id="df2d8-229">プッシュ サブスクリプションには、ストアド プロシージャ [sp_link_publication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) を使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-229">For push subscriptions, use the stored procedure [sp_link_publication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span>  
  
#### <a name="to-change-the-password-for-the-administrative-connection-from-the-publisher-to-the-distributor"></a><span data-ttu-id="df2d8-230">パブリッシャーからディストリビューターへの管理接続に使用されているパスワードを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-230">To change the password for the administrative connection from the Publisher to the Distributor</span></span>  
  
1.  <span data-ttu-id="df2d8-231">**[ディストリビューターのプロパティ - \<Distributor>]** ダイアログ ボックスの **[パブリッシャー]** ページで、 **[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-231">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, enter a strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
3.  <span data-ttu-id="df2d8-232">**[パブリッシャーのプロパティ - \<Publisher>]** ダイアログ ボックスの **[全般]** ページで、 **[パスワード]** テキスト ボックスと **[パスワードの確認入力]** テキスト ボックスに複雑なパスワードを入力します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-232">On the **General** page of the **Publisher Properties - \<Publisher>** dialog box, enter a strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="df2d8-233">Transact-SQL の使用</span><span class="sxs-lookup"><span data-stu-id="df2d8-233">Using Transact-SQL</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="df2d8-234">可能な限り、次のすべての手順で、実行時にセキュリティ資格情報を入力するように求めるメッセージをユーザーに表示します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-234">In all of the following procedures, when possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="df2d8-235">スクリプト ファイルに資格情報を格納する場合は、不正アクセスを防ぐために、そのファイルをセキュリティで保護する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-235">If you store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-change-all-instances-of-a-stored-password-at-a-replication-server"></a><span data-ttu-id="df2d8-236">レプリケーション サーバーに格納されたパスワードのインスタンスをすべて変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-236">To change all instances of a stored password at a replication server</span></span>  
  
1.  <span data-ttu-id="df2d8-237">レプリケーション トポロジ内のサーバーの master データベースで、 [sp_changereplicationserverpasswords](/sql/relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-237">At a server in a replication topology on the master database, execute [sp_changereplicationserverpasswords](/sql/relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql).</span></span> <span data-ttu-id="df2d8-238">[!INCLUDE[msCoName](../../../includes/msconame-md.md)]ログインのパスワードを変更する Windows アカウントまたは [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ログインと\*\* \@ \*\* 、アカウントまたはログイン\*\* \@ パスワード\*\*の新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-238">Specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows account or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login whose password is being changed for **\@login** and new password for the account or login for **\@password**.</span></span> <span data-ttu-id="df2d8-239">これにより、トポロジ内の他のサーバーに接続すると、サーバーのすべてのエージェントで使用されるパスワードの各インスタンスが変更されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-239">This changes every instance of the password used by all agents on the server when connecting to other servers in the topology.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-240">トポロジ内の特定のサーバー (ディストリビューターやサブスクライバーなど) への接続のログインとパスワードのみを変更するには、 \*\* \@ サーバー\*\*の名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-240">To only change the login and password for a connection to a particular server in the topology (such as the Distributor or Subscriber), specify this server's name for **\@server**.</span></span>  
  
2.  <span data-ttu-id="df2d8-241">パスワードの更新が必要なレプリケーション トポロジ内の各サーバーで手順 1. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-241">Repeat step 1 at every server in the replication topology where the password must be updated.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-242">レプリケーション パスワードを変更したら、そのパスワードを使用する各エージェントを停止して再起動し、エージェントに対して変更を反映させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-242">After changing a replication password, you must stop and restart each agent that uses the password before the change takes effect for that agent.</span></span>  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent"></a><span data-ttu-id="df2d8-243">スナップショット エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-243">To change security settings for the Snapshot Agent</span></span>  
  
1.  <span data-ttu-id="df2d8-244">パブリッシャーで、 \*\* \@ パブリケーション\*\*を指定して[sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-244">At the Publisher, execute [sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="df2d8-245">これにより、スナップショット エージェントの現在のセキュリティ設定が返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-245">This returns the current security settings for the Snapshot Agent.</span></span>  
  
2.  <span data-ttu-id="df2d8-246">パブリッシャーで[sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql)を実行し、 \*\* \@ パブリケーション\*\*を指定して、次のセキュリティ設定の1つまたは複数を変更します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-246">At the Publisher, execute [sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql), specifying **\@publication** and one or more of the following security settings to change:</span></span>  
  
    -   <span data-ttu-id="df2d8-247">エージェントを実行する Windows アカウント、またはこのアカウントのパスワードだけを変更するには、 \*\* \@ job_login**と** \@ job_password\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-247">To change the Windows account under which the agent runs or just password for this account, specify **\@job_login** and **\@job_password**.</span></span>  
  
    -   <span data-ttu-id="df2d8-248">パブリッシャーに接続するときに使用するセキュリティモードを変更するには、 \*\* \@ publisher_security_mode**に値**1**または**0\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-248">To change the security mode used when connecting to the Publisher, specify a value of **1** or **0** for **\@publisher_security_mode**.</span></span>  
  
    -   <span data-ttu-id="df2d8-249">パブリッシャーへの接続時に使用されるセキュリティモードを**1**から**0**に変更する場合 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 、またはこの接続に使用するログインを変更する場合は、 \*\* \@ publisher_login**と** \@ publisher_password\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-249">When changing the security mode used when connecting to the Publisher from **1** to **0** or when changing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login used for this connection, specify **\@publisher_login** and **\@publisher_password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="df2d8-250">リモート ディストリビューターを使用するパブリッシャーを構成する場合は、 *job_login* および *job_password*を含むすべてのパラメーターに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-250">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="df2d8-251">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-251">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="df2d8-252">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-252">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-log-reader-agent"></a><span data-ttu-id="df2d8-253">ログ リーダー エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-253">To change security settings for the Log Reader Agent</span></span>  
  
1.  <span data-ttu-id="df2d8-254">パブリッシャーで[sp_helplogreader_agent](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql)を実行し、 \*\* \@ パブリッシャー\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-254">At the Publisher, execute [sp_helplogreader_agent](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql), specifying **\@publisher**.</span></span> <span data-ttu-id="df2d8-255">これにより、ログ リーダー エージェントの現在のセキュリティ設定が返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-255">This returns the current security settings for the Log Reader Agent.</span></span>  
  
2.  <span data-ttu-id="df2d8-256">パブリッシャーで[sp_changelogreader_agent](/sql/relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql)を実行し、 \*\* \@ パブリケーション\*\*を指定して、次のセキュリティ設定の1つまたは複数を変更します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-256">At the Publisher, execute [sp_changelogreader_agent](/sql/relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql), specifying **\@publication** and one or more of the following security settings to change:</span></span>  
  
    -   <span data-ttu-id="df2d8-257">エージェントを実行する Windows アカウント、またはこのアカウントのパスワードだけを変更するには、 \*\* \@ job_login**と** \@ job_password\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-257">To change the Windows account under which the agent runs or just password for this account, specify **\@job_login** and **\@job_password**.</span></span>  
  
    -   <span data-ttu-id="df2d8-258">パブリッシャーに接続するときに使用するセキュリティモードを変更するには、 \*\* \@ publisher_security_mode**に値**1**または**0\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-258">To change the security mode used when connecting to the Publisher, specify a value of **1** or **0** for **\@publisher_security_mode**.</span></span>  
  
    -   <span data-ttu-id="df2d8-259">パブリッシャーへの接続時に使用されるセキュリティモードを**1**から**0**に変更する場合 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 、またはこの接続に使用するログインを変更する場合は、 \*\* \@ publisher_login**と** \@ publisher_password\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-259">When changing the security mode used when connecting to the Publisher from **1** to **0** or when changing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login used for this connection, specify **\@publisher_login** and **\@publisher_password**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-260">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-260">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="df2d8-261">リモート ディストリビューターを使用するパブリッシャーを構成する場合は、 *job_login* および *job_password*を含むすべてのパラメーターに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-261">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="df2d8-262">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-262">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="df2d8-263">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-263">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription"></a><span data-ttu-id="df2d8-264">プッシュ サブスクリプションに対するディストリビューション エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-264">To change security settings for the Distribution Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-265">パブリッシャー側のパブリケーションデータベースに対して[sp_helpsubscription](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql)を実行し、 \*\* \@ パブリケーション**と** \@ サブスクライバー\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-265">At the Publisher on the publication database, execute [sp_helpsubscription](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql), specifying **\@publication** and **\@subscriber**.</span></span> <span data-ttu-id="df2d8-266">これにより、ディストリビューターで実行されるディストリビューション エージェントのセキュリティ設定を含むサブスクリプションのプロパティが返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-266">This returns subscription properties, including security settings for the Distribution Agent running at the Distributor.</span></span>  
  
2.  <span data-ttu-id="df2d8-267">パブリッシャー側のパブリケーションデータベースで、 [sp_changesubscription](/sql/relational-databases/system-stored-procedures/sp-changesubscription-transact-sql)を実行します。 \*\* \@ パブリケーション**、 \*\* \@ サブスクライバー**、 \*\* \@ subscriber_db**、 \*\* \@ アーティクル**の場合は**all** 、 \*\* \@ プロパティ**の場合はセキュリティプロパティの名前、 \*\* \@ value**にはプロパティの新しい値を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-267">At the Publisher on the publication database, execute [sp_changesubscription](/sql/relational-databases/system-stored-procedures/sp-changesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, **\@subscriber_db**, a value of **all** for **\@article**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="df2d8-268">次のセキュリティ プロパティから変更するものに対してそれぞれ手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-268">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="df2d8-269">エージェントを実行する Windows アカウント、またはこのアカウントのパスワードだけを変更するには、[ \*\* \@ プロパティ**] に値**distrib_job_password**を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-269">To change the Windows account under which the agent runs or just the password for this account, specify a value of **distrib_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="df2d8-270">アカウント自体を変更する場合は、[ \*\* \@ プロパティ**] に値**distrib_job_login**を指定し、[ \*\* \@ 値**] に新しい Windows アカウントを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-270">When changing the account itself, repeat step 2 specifying a value of **distrib_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-271">サブスクライバーへの接続時に使用されるセキュリティモードを変更するには、[ \*\* \@ プロパティ**] に値**subscriber_security_mode**を指定し、値に**1\*\* (Windows 統合認証) または**0** (SQL Server 認証) を指定\*\* \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="df2d8-271">To change the security mode used when connecting to the Subscriber, specify a value of **subscriber_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-272">サブスクライバーのセキュリティモードを SQL Server 認証に変更する場合、または SQL Server 認証のログイン情報を変更する場合は、[ \*\* \@ プロパティ**] に [ **subscriber_password** ] を、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-272">When changing the Subscriber security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **subscriber_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="df2d8-273">\*\* \@ プロパティ**に値**subscriber_login**を指定し、 \*\* \@ 値**に新しいログインを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-273">Repeat step 2, specifying a value of **subscriber_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-274">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-274">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="df2d8-275">リモート ディストリビューターを使用するパブリッシャーを構成する場合は、 **distrib_job_login** および **distrib_job_password**を含むすべてのプロパティに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-275">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including **distrib_job_login** and **distrib_job_password**, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="df2d8-276">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-276">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="df2d8-277">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-277">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription"></a><span data-ttu-id="df2d8-278">プル サブスクリプションに対するディストリビューション エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-278">To change security settings for the Distribution Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-279">サブスクライバーで、 \*\* \@ パブリケーション\*\*を指定して[sp_helppullsubscription](/sql/relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-279">At the Subscriber, execute [sp_helppullsubscription](/sql/relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="df2d8-280">これにより、サブスクライバーで実行されるディストリビューション エージェントのセキュリティ設定を含むサブスクリプションのプロパティが返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-280">This returns subscription properties, including security settings for the Distribution Agent running at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="df2d8-281">サブスクライバー側のサブスクリプションデータベースで[sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql)を実行します。 \*\* \@ パブリッシャー**、 \*\* \@ publisher_db**、 \*\* \@ パブリケーション**、 \*\* \@ プロパティ**のセキュリティプロパティの名前、および\*\* \@ value\*\*のプロパティの新しい値を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-281">At the Subscriber on the subscription database, execute [sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql), specifying **\@publisher**, **\@publisher_db**, **\@publication**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="df2d8-282">次のセキュリティ プロパティから変更するものに対してそれぞれ手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-282">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="df2d8-283">エージェントを実行する Windows アカウント、またはこのアカウントのパスワードだけを変更するには、[ \*\* \@ プロパティ**] に値**distrib_job_password**を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-283">To change the Windows account under which the agent runs or just the password for this account, specify a value of **distrib_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="df2d8-284">アカウント自体を変更する場合は、[ \*\* \@ プロパティ**] に値**distrib_job_login**を指定し、[ \*\* \@ 値**] に新しい Windows アカウントを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-284">When changing the account itself, repeat step 2 specifying a value of **distrib_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-285">ディストリビューターへの接続時に使用されるセキュリティモードを変更するには、[ \*\* \@ プロパティ**] に値**distributor_security_mode**を指定し、値に**1\*\* (Windows 統合認証) または**0** (SQL Server 認証) を指定\*\* \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="df2d8-285">To change the security mode used when connecting to the Distributor, specify a value of **distributor_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-286">ディストリビューターのセキュリティモードを SQL Server 認証に変更する場合、または SQL Server 認証のログイン情報を変更する場合は、[ \*\* \@ プロパティ**] に**distributor_password**の値を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-286">When changing the Distributor security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **distributor_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="df2d8-287">\*\* \@ プロパティ**に値**distributor_login**を指定し、 \*\* \@ 値**に新しいログインを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-287">Repeat step 2, specifying a value of **distributor_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-288">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-288">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription"></a><span data-ttu-id="df2d8-289">プッシュ サブスクリプションに対するマージ エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-289">To change security settings for the Merge Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-290">パブリッシャー側のパブリケーションデータベースに対して[sp_helpmergesubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql)を実行し、 \*\* \@ パブリケーション**、 \*\* \@ サブスクライバー**、および\*\* \@ subscriber_db\*\*を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-290">At the Publisher on the publication database, execute [sp_helpmergesubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, and **\@subscriber_db**.</span></span> <span data-ttu-id="df2d8-291">これにより、ディストリビューターで実行されるマージ エージェントのセキュリティ設定を含むサブスクリプションのプロパティが返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-291">This returns subscription properties, including security settings for the Merge Agent running at the Distributor.</span></span>  
  
2.  <span data-ttu-id="df2d8-292">パブリッシャー側のパブリケーションデータベースに対して[sp_changemergesubscription](/sql/relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql)を実行します。 \*\* \@ パブリケーション**、 \*\* \@ サブスクライバー**、 \*\* \@ subscriber_db**、 \*\* \@ プロパティ**のセキュリティプロパティの名前、および\*\* \@ value\*\*のプロパティの新しい値を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-292">At the Publisher on the publication database, execute [sp_changemergesubscription](/sql/relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, **\@subscriber_db**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="df2d8-293">次のセキュリティ プロパティから変更するものに対してそれぞれ手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-293">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="df2d8-294">エージェントを実行する Windows アカウント、またはこのアカウントのパスワードだけを変更するには、[ \*\* \@ プロパティ**] に値**merge_job_password**を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-294">To change the Windows account under which the agent runs, or just the password for this account, specify a value of **merge_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="df2d8-295">アカウント自体を変更する場合は、[ \*\* \@ プロパティ**] に値**merge_job_login**を指定し、[ \*\* \@ 値**] に新しい Windows アカウントを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-295">When changing the account itself, repeat step 2 specifying a value of **merge_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-296">サブスクライバーへの接続時に使用されるセキュリティモードを変更するには、[ \*\* \@ プロパティ**] に値**subscriber_security_mode**を指定し、値に**1\*\* (Windows 統合認証) または**0** (SQL Server 認証) を指定\*\* \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="df2d8-296">To change the security mode used when connecting to the Subscriber, specify a value of **subscriber_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-297">サブスクライバーのセキュリティモードを SQL Server 認証に変更する場合、または SQL Server 認証のログイン情報を変更する場合は、[ \*\* \@ プロパティ**] に [ **subscriber_password** ] を、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-297">When changing the Subscriber security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **subscriber_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="df2d8-298">\*\* \@ プロパティ**に値**subscriber_login**を指定し、 \*\* \@ 値**に新しいログインを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-298">Repeat step 2, specifying a value of **subscriber_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-299">パブリッシャーへの接続時に使用されるセキュリティモードを変更するには、[ \*\* \@ プロパティ**] に値**publisher_security_mode**を指定し、値に**1\*\* (Windows 統合認証) または**0** (SQL Server 認証) を指定\*\* \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="df2d8-299">To change the security mode used when connecting to the Publisher, specify a value of **publisher_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-300">パブリッシャーのセキュリティモードを SQL Server 認証に変更する場合、または SQL Server 認証のログイン情報を変更する場合は、[ \*\* \@ プロパティ**] に [ **publisher_password** ] を、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-300">When changing the Publisher security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **publisher_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="df2d8-301">\*\* \@ プロパティ**に値**publisher_login**を指定し、 \*\* \@ 値**に新しいログインを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-301">Repeat step 2, specifying a value of **publisher_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-302">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-302">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="df2d8-303">リモート ディストリビューターを使用してパブリッシャーを構成する場合、 **merge_job_login** および **merge_job_password**を含むすべてのプロパティに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-303">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including **merge_job_login** and **merge_job_password**, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="df2d8-304">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-304">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="df2d8-305">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-305">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription"></a><span data-ttu-id="df2d8-306">プル サブスクリプションに対するマージ エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-306">To change security settings for the Merge Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="df2d8-307">サブスクライバーで、 \*\* \@ パブリケーション\*\*を指定して[sp_helpmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-307">At the Subscriber, execute [sp_helpmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="df2d8-308">これにより、サブスクライバーで実行されるマージ エージェントのセキュリティ設定を含むサブスクリプションのプロパティが返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-308">This returns subscription properties, including security settings for the Merge Agent running at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="df2d8-309">サブスクライバー側のサブスクリプションデータベースで[sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql)を実行します。 \*\* \@ パブリッシャー**、 \*\* \@ publisher_db**、 \*\* \@ パブリケーション**、 \*\* \@ プロパティ**のセキュリティプロパティの名前、および\*\* \@ value\*\*のプロパティの新しい値を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-309">At the Subscriber on the subscription database, execute [sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql), specifying **\@publisher**, **\@publisher_db**, **\@publication**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="df2d8-310">次のセキュリティ プロパティから変更するものに対してそれぞれ手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-310">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="df2d8-311">エージェントを実行する Windows アカウント、またはこのアカウントのパスワードだけを変更するには、[ \*\* \@ プロパティ**] に値**merge_job_password**を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-311">To change the Windows account under which the agent runs or just the password for this account, specify a value of **merge_job_password** for **\@property** and new password for **\@value**.</span></span> <span data-ttu-id="df2d8-312">アカウント自体を変更する場合は、[ \*\* \@ プロパティ**] に値**merge_job_login**を指定し、[ \*\* \@ 値**] に新しい Windows アカウントを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-312">When changing the account itself, repeat Step 2 specifying a value of **merge_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-313">ディストリビューターへの接続時に使用されるセキュリティモードを変更するには、[ \*\* \@ プロパティ**] に値**distributor_security_mode**を指定し、値に**1\*\* (Windows 統合認証) または**0** (SQL Server 認証) を指定\*\* \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="df2d8-313">To change the security mode used when connecting to the Distributor, specify a value of **distributor_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-314">ディストリビューターのセキュリティモードを SQL Server 認証に変更する場合、または SQL Server 認証のログイン情報を変更する場合は、[ \*\* \@ プロパティ**] に**distributor_password**の値を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-314">When changing the Distributor security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **distributor_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="df2d8-315">\*\* \@ プロパティ**に値**distributor_login**を指定し、 \*\* \@ 値**に新しいログインを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-315">Repeat step 2, specifying a value of **distributor_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-316">パブリッシャーへの接続時に使用されるセキュリティモードを変更するには、[ \*\* \@ プロパティ**] に値**publisher_security_mode**を指定し、値に**1\*\* (Windows 統合認証) または**0** (SQL Server 認証) を指定\*\* \@ します。\*\*</span><span class="sxs-lookup"><span data-stu-id="df2d8-316">To change the security mode used when connecting to the Publisher, specify a value of **publisher_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="df2d8-317">パブリッシャーのセキュリティモードを SQL Server 認証に変更する場合、または SQL Server 認証のログイン情報を変更する場合は、[ \*\* \@ プロパティ**] に**publisher_password**の値を指定し、[ \*\* \@ 値**] に新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-317">When changing the Publisher security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **publisher_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="df2d8-318">\*\* \@ プロパティ**に値**publisher_login**を指定し、 \*\* \@ 値**に新しいログインを指定して、手順 2. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-318">Repeat step 2, specifying a value of **publisher_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-319">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-319">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent-to-generate-a-filtered-snapshot-for-a-subscriber"></a><span data-ttu-id="df2d8-320">サブスクライバーのフィルター選択されたスナップショットを生成する、スナップショット エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-320">To change security settings for the Snapshot Agent to generate a filtered snapshot for a Subscriber</span></span>  
  
1.  <span data-ttu-id="df2d8-321">パブリッシャーで、 \*\* \@ パブリケーション\*\*を指定して[sp_helpdynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-321">At the Publisher, execute [sp_helpdynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="df2d8-322">結果セットで、変更するサブスクライバーのパーティションの **job_name** の値を確認します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-322">In the result set, note the value of **job_name** for the Subscriber's partition to change.</span></span>  
  
2.  <span data-ttu-id="df2d8-323">パブリッシャーで、 [sp_changedynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql)を実行します。 \*\* \@ パブリケーション**を指定し、手順 1. で取得した** \@ dynamic_snapshot_jobname**の値を指定します。また、エージェントを実行する Windows アカウントの** \@ job_password**またはログインとパスワードの新しいパスワードを** \@ job_login**および** \@ job_password\*\*に対して実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-323">At the Publisher, execute [sp_changedynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql), specifying **\@publication**, the value obtained from step 1 for **\@dynamic_snapshot_jobname**, and a new password for **\@job_password** or login and password for the Windows account under which the agent runs for **\@job_login** and **\@job_password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="df2d8-324">リモート ディストリビューターを使用するパブリッシャーを構成する場合は、 *job_login* および *job_password*を含むすべてのパラメーターに指定された値がディストリビューターにプレーン テキストとして送信されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-324">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="df2d8-325">このストアド プロシージャを実行する前に、パブリッシャーとリモート ディストリビューターの間の接続を暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-325">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="df2d8-326">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-326">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-queue-reader-agent"></a><span data-ttu-id="df2d8-327">キュー リーダー エージェントのセキュリティ設定を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-327">To change security settings for the Queue Reader Agent</span></span>  
  
1.  <span data-ttu-id="df2d8-328">ディストリビューターで、 [sp_helpqreader_agent](/sql/relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-328">At the Distributor, execute [sp_helpqreader_agent](/sql/relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql).</span></span> <span data-ttu-id="df2d8-329">これにより、キュー リーダー エージェントの実行時に使用される現在の Windows アカウントが返されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-329">This returns the current Windows account under which the Queue Reader Agent runs.</span></span>  
  
    -   <span data-ttu-id="df2d8-330">ディストリビューターで[sp_changeqreader_agent](/sql/relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql)を実行し、 \*\* \@ Job_login**と** \@ job_passwsord\*\*の Windows アカウント設定を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-330">At the Distributor, execute [sp_changeqreader_agent](/sql/relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql), specifying the Windows account settings for **\@job_login** and **\@job_passwsord**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="df2d8-331">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-331">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span> <span data-ttu-id="df2d8-332">ディストリビューション データベースには、それぞれ 1 つのキュー リーダー エージェントがあります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-332">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="df2d8-333">エージェントのセキュリティ設定を変更すると、このディストリビューション データベースを使用するすべてのパブリッシャーのすべてのパブリケーションの設定に影響が及びます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-333">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
2.  <span data-ttu-id="df2d8-334">キュー リーダー エージェントは、サブスクリプションのディストリビューション エージェントと同じ接続コンテキストを使用して、サブスクライバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-334">The Queue Reader Agent makes connections to the Subscriber using the same connection context as the Distribution Agent for the subscription.</span></span>  
  
#### <a name="to-change-security-mode-used-by-an-immediate-updating-subscriber-when-connecting-to-the-publisher"></a><span data-ttu-id="df2d8-335">パブリッシャーへの接続時に即時更新サブスクライバーで使用するセキュリティ モードを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-335">To change security mode used by an immediate updating Subscriber when connecting to the Publisher</span></span>  
  
1.  <span data-ttu-id="df2d8-336">サブスクライバー側のサブスクリプション データベースに対して、 [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql)を実行します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-336">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="df2d8-337">\*\* \@ パブリッシャー**、 \*\* \@ パブリケーション**、 \*\* \@ publisher_db**にパブリケーションデータベースの名前、 \*\* \@ security_mode**に次のいずれかの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-337">Specify **\@publisher**, **\@publication**, the name of the publication database for **\@publisher_db**, and one of the following values for **\@security_mode**:</span></span>  
  
    -   <span data-ttu-id="df2d8-338">**0** - パブリッシャーで更新を作成する場合に SQL Server  認証を使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-338">**0** to use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="df2d8-339">このオプションでは、 \*\* \@ ログイン**と** \@ パスワード\*\*に対して、パブリッシャーで有効なログインを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-339">This option requires you to specify a valid login at the Publisher for **\@login** and **\@password**.</span></span>  
  
    -   <span data-ttu-id="df2d8-340">**1** - パブリッシャーへの接続時にサブスクライバーで変更するユーザーのセキュリティ コンテキストを使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-340">**1** to use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="df2d8-341">このセキュリティ モードに関連する制限の詳細については、 [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-341">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>  
  
    -   <span data-ttu-id="df2d8-342">**2** - [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) を使って作成された既存のユーザー定義リンク サーバー ログインを使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-342">**2** to use an existing, user-defined linked server login created using [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
#### <a name="to-change-the-password-for-a-remote-distributor"></a><span data-ttu-id="df2d8-343">リモート ディストリビューターのパスワードを変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-343">To change the password for a remote Distributor</span></span>  
  
1.  <span data-ttu-id="df2d8-344">ディストリビューター側のディストリビューションデータベースに対して[sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql)を実行し、このログインに\*\* \@ パスワード\*\*の新しいパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-344">At the Distributor on the distribution database, execute [sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql), specifying the new password for this login for **\@password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="df2d8-345">**distributor_admin** のパスワードを直接変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="df2d8-345">Do not change the password for **distributor_admin** directly.</span></span>  
  
2.  <span data-ttu-id="df2d8-346">このリモートディストリビューターを使用するすべてのパブリッシャーで[sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql)を実行し、 \*\* \@ パスワード\*\*に手順 1. のパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-346">At every Publisher that uses this remote Distributor, execute [sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql), specifying the password from step 1 for **\@password**.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="df2d8-347">レプリケーション管理オブジェクト (RMO) の使用</span><span class="sxs-lookup"><span data-stu-id="df2d8-347">Using Replication Management Objects (RMO)</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="df2d8-348">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-348">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="df2d8-349">資格情報を保存する必要がある場合は、 [Windows .NET&#xA0;Framework に用意されている](https://go.microsoft.com/fwlink/?LinkId=34733) 暗号化サービス [!INCLUDE[msCoName](../../../includes/msconame-md.md)] を使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-349">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-change-all-instances-of-a-password-stored-on-a-replication-server"></a><span data-ttu-id="df2d8-350">レプリケーション サーバーに格納されているパスワードのインスタンスをすべて変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-350">To change all instances of a password stored on a replication server</span></span>  
  
1.  <span data-ttu-id="df2d8-351"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、レプリケーション サーバーに対する接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-351">Create a connection to the replication server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="df2d8-352">手順 1. で作成した接続を使用して、 <xref:Microsoft.SqlServer.Replication.ReplicationServer> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-352">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class by using the connection from step 1.</span></span>  
  
3.  <span data-ttu-id="df2d8-353"><xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-353">Call the <xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> method.</span></span> <span data-ttu-id="df2d8-354">次のパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-354">Specify the following parameters:</span></span>  
  
    -   <span data-ttu-id="df2d8-355">*security_mode* - <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> 値。パスワードのすべてのインスタンスを変更するために使用する認証の種類を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-355">*security_mode* - a <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> value that specifies the type of authentication for which all instances of the password are being changed.</span></span>  
  
    -   <span data-ttu-id="df2d8-356">*login* - パスワードのすべてのインスタンスを変更するために使用するログイン。</span><span class="sxs-lookup"><span data-stu-id="df2d8-356">*login* - the login for which all instances of the password are being changed.</span></span>  
  
    -   <span data-ttu-id="df2d8-357">*password* - 新しいパスワード値。</span><span class="sxs-lookup"><span data-stu-id="df2d8-357">*password* - the new password value.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="df2d8-358">可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-358">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="df2d8-359">資格情報を保存する必要がある場合は、Windows .NET Framework に用意されている [暗号化サービス](https://go.microsoft.com/fwlink/?LinkId=34733) を使用します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-359">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the Windows .NET Framework.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="df2d8-360">固定サーバー ロール `sysadmin` のメンバー以外、このメソッドを呼び出すことはできません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-360">Only a member of the `sysadmin` fixed server role can call this method.</span></span>  
  
4.  <span data-ttu-id="df2d8-361">パスワードを更新する必要のある、レプリケーション トポロジ内のすべてのサーバーについて、手順 1. から手順 3. を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-361">Repeat steps 1-3 at every server in the replication topology where the password must be updated.</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="df2d8-362">ディストリビューション エージェントのセキュリティ設定をプッシュ サブスクリプション用からトランザクション パブリケーション用に変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-362">To change security settings for the Distribution Agent for a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="df2d8-363"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、パブリッシャーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-363">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="df2d8-364"><xref:Microsoft.SqlServer.Replication.TransSubscription> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-364">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
3.  <span data-ttu-id="df2d8-365">サブスクリプションの <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに対し、手順 1. で作成した接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-365">Set the <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, and <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="df2d8-366"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-366">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="df2d8-367">このメソッドから `false` が返された場合、手順 3. で指定したサブスクリプションのプロパティが正しく定義されていないか、サブスクリプションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-367">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="df2d8-368"><xref:Microsoft.SqlServer.Replication.TransSubscription>のインスタンスに対し、次のいずれかまたは複数のセキュリティ プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-368">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.TransSubscription>:</span></span>  
  
    -   <span data-ttu-id="df2d8-369">エージェントの実行に使用する Windows アカウントの資格情報を変更するには、 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> の <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> フィールドおよび <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>フィールドを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-369">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="df2d8-370">エージェントがサブスクライバーとの接続に使用する認証の種類に Windows 統合認証を指定するには、<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティの <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> フィールドを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-370">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="df2d8-371">エージェントがサブスクライバーに接続するときに使用する認証の種類として SQL Server 認証を指定するには、 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティのフィールドを <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> に設定し、 `false` およびフィールドにサブスクライバーのログイン資格情報を指定し <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-371">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `false`, and specify the Subscriber login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="df2d8-372">ディストリビューターに対するエージェント接続は、常に、 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>によって指定された Windows 資格情報を使用して確立されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-372">The agent connection to the Distributor is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="df2d8-373">このアカウントは、Windows 認証を使ってリモート接続を確立する際にも使用されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-373">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="df2d8-374">(省略可) <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `true` を指定した場合、<xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> メソッドを呼び出してサーバーに変更をコミットします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-374">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="df2d8-375"><xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `false` (既定値) を指定した場合、変更は直ちにサーバーに送られます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-375">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="df2d8-376">ディストリビューション エージェントのセキュリティ設定をプル サブスクリプション用からトランザクション パブリケーション用に変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-376">To change security settings for the Distribution Agent for a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="df2d8-377"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、サブスクライバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-377">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="df2d8-378"><xref:Microsoft.SqlServer.Replication.TransPullSubscription> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-378">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class.</span></span>  
  
3.  <span data-ttu-id="df2d8-379">サブスクリプションの <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに対し、手順 1. で作成した接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-379">Set the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="df2d8-380"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-380">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="df2d8-381">このメソッドから `false` が返された場合、手順 3. で指定したサブスクリプションのプロパティが正しく定義されていないか、サブスクリプションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-381">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="df2d8-382"><xref:Microsoft.SqlServer.Replication.TransPullSubscription>のインスタンスに対し、次のいずれかまたは複数のセキュリティ プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-382">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.TransPullSubscription>:</span></span>  
  
    -   <span data-ttu-id="df2d8-383">エージェントの実行に使用する Windows アカウントの資格情報を変更するには、 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> の <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> フィールドおよび <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>フィールドを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-383">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="df2d8-384">エージェントがディストリビューターとの接続に使用する認証の種類に Windows 統合認証を指定するには、<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティの <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> フィールドを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-384">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="df2d8-385">エージェントがディストリビューターに接続するときに使用する認証の種類として SQL Server 認証を指定するには、 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティのフィールド <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> をに設定 `false` し、フィールドとフィールドに対してディストリビューターのログイン資格情報を指定し <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-385">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `false`, and specify the Distributor login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="df2d8-386">サブスクライバーに対するエージェント接続は、常に、 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>によって指定された Windows 資格情報を使用して確立されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-386">The agent connection to the Subscriber is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="df2d8-387">このアカウントは、Windows 認証を使ってリモート接続を確立する際にも使用されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-387">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="df2d8-388">(省略可) <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `true` を指定した場合、<xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> メソッドを呼び出してサーバーに変更をコミットします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-388">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="df2d8-389"><xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `false` (既定値) を指定した場合、変更は直ちにサーバーに送られます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-389">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="df2d8-390">マージ エージェントのセキュリティ設定をプル サブスクリプション用からマージ パブリケーション用に変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-390">To change security settings for the Merge Agent for a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="df2d8-391"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、サブスクライバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-391">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="df2d8-392"><xref:Microsoft.SqlServer.Replication.MergePullSubscription> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-392">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class.</span></span>  
  
3.  <span data-ttu-id="df2d8-393">サブスクリプションの <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに対し、手順 1. で作成した接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-393">Set the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="df2d8-394"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-394">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="df2d8-395">このメソッドから `false` が返された場合、手順 3. で指定したサブスクリプションのプロパティが正しく定義されていないか、サブスクリプションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-395">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="df2d8-396"><xref:Microsoft.SqlServer.Replication.MergePullSubscription>のインスタンスに対し、次のいずれかまたは複数のセキュリティ プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-396">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.MergePullSubscription>:</span></span>  
  
    -   <span data-ttu-id="df2d8-397">エージェントの実行に使用する Windows アカウントの資格情報を変更するには、 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> の <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> フィールドおよび <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>フィールドを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-397">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="df2d8-398">エージェントがディストリビューターとの接続に使用する認証の種類に Windows 統合認証を指定するには、<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティの <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> フィールドを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-398">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="df2d8-399">エージェントがディストリビューターに接続するときに使用する認証の種類として SQL Server 認証を指定するには、 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティのフィールド <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> をに設定 `false` し、フィールドとフィールドに対してディストリビューターのログイン資格情報を指定し <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-399">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `false`, and specify the Distributor login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
    -   <span data-ttu-id="df2d8-400">エージェントがパブリッシャーとの接続に使用する認証の種類に Windows 統合認証を指定するには、<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティの <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> フィールドを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-400">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="df2d8-401">エージェントがパブリッシャーに接続するときに使用する認証の種類として SQL Server 認証を指定するには、 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティのフィールド <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> をに設定 `false` し、フィールドとフィールドに対して、パブリッシャーのログイン資格情報を指定し <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-401">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> property to `false`, and specify the Publisher login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="df2d8-402">サブスクライバーに対するエージェント接続は、常に、 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>によって指定された Windows 資格情報を使用して確立されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-402">The agent connection to the Subscriber is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="df2d8-403">このアカウントは、Windows 認証を使ってリモート接続を確立する際にも使用されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-403">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="df2d8-404">(省略可) <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `true` を指定した場合、<xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> メソッドを呼び出してサーバーに変更をコミットします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-404">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="df2d8-405"><xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `false` (既定値) を指定した場合、変更は直ちにサーバーに送られます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-405">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="df2d8-406">マージ エージェントのセキュリティ設定をプッシュ サブスクリプション用からマージ パブリケーション用に変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-406">To change security settings for the Merge Agent for a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="df2d8-407"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、パブリッシャーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-407">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="df2d8-408"><xref:Microsoft.SqlServer.Replication.MergeSubscription> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-408">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
3.  <span data-ttu-id="df2d8-409">サブスクリプションの <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> の各プロパティを設定し、 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> プロパティに対し、手順 1. で作成した接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-409">Set the <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, and <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="df2d8-410"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-410">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="df2d8-411">このメソッドから `false` が返された場合、手順 3. で指定したサブスクリプションのプロパティが正しく定義されていないか、サブスクリプションが存在していません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-411">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="df2d8-412"><xref:Microsoft.SqlServer.Replication.MergeSubscription>のインスタンスに対し、次のいずれかまたは複数のセキュリティ プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-412">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.MergeSubscription>:</span></span>  
  
    -   <span data-ttu-id="df2d8-413">エージェントの実行に使用する Windows アカウントの資格情報を変更するには、 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> の <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> フィールドおよび <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>フィールドを設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-413">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="df2d8-414">エージェントがサブスクライバーとの接続に使用する認証の種類に Windows 統合認証を指定するには、<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティの <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> フィールドを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-414">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="df2d8-415">エージェントがサブスクライバーに接続するときに使用する認証の種類として SQL Server 認証を指定するには、 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティのフィールドを <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> に設定し、 `false` およびフィールドにサブスクライバーのログイン資格情報を指定し <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-415">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `false`, and specify the Subscriber login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
    -   <span data-ttu-id="df2d8-416">エージェントがパブリッシャーとの接続に使用する認証の種類に Windows 統合認証を指定するには、<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティの <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> フィールドを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-416">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="df2d8-417">エージェントがパブリッシャーに接続するときに使用する認証の種類として SQL Server 認証を指定するには、 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> プロパティのフィールド <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> をに設定 `false` し、フィールドとフィールドに対して、パブリッシャーのログイン資格情報を指定し <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> ます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-417">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> property to `false`, and specify the Publisher login credentials for the <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="df2d8-418">ディストリビューターに対するエージェント接続は、常に、 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>によって指定された Windows 資格情報を使用して確立されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-418">The agent connection to the Distributor is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="df2d8-419">このアカウントは、Windows 認証を使ってリモート接続を確立する際にも使用されます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-419">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="df2d8-420">(省略可) <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `true` を指定した場合、<xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> メソッドを呼び出してサーバーに変更をコミットします。</span><span class="sxs-lookup"><span data-stu-id="df2d8-420">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="df2d8-421"><xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> に `false` (既定値) を指定した場合、変更は直ちにサーバーに送られます。</span><span class="sxs-lookup"><span data-stu-id="df2d8-421">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-the-login-information-used-by-an-immediate-updating-subscriber-when-it-connects-to-the-transactional-publisher"></a><span data-ttu-id="df2d8-422">即時更新サブスクライバーがトランザクション パブリッシャーへの接続時に使用するログイン情報を変更するには</span><span class="sxs-lookup"><span data-stu-id="df2d8-422">To change the login information used by an immediate updating Subscriber when it connects to the transactional publisher</span></span>  
  
1.  <span data-ttu-id="df2d8-423"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> クラスを使用して、サブスクライバーへの接続を作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-423">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="df2d8-424">サブスクリプション データベースの <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> クラスのインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-424">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the subscription database.</span></span> <span data-ttu-id="df2d8-425"><xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> を指定し、 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> に手順 1. の <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-425">Specify <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> and the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="df2d8-426"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> メソッドを呼び出して、オブジェクトのプロパティを取得します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-426">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="df2d8-427">このメソッドから `false` が返された場合、手順 2. で指定したデータベースのプロパティが正しく定義されていないか、サブスクリプション データベースが存在していません。</span><span class="sxs-lookup"><span data-stu-id="df2d8-427">If this method returns `false`, either the database properties in step 2 were defined incorrectly or the subscription database does not exist.</span></span>  
  
4.  <span data-ttu-id="df2d8-428"><xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> メソッドに次のパラメーターを指定して呼び出します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-428">Call the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> method, passing the following parameters:</span></span>  
  
    -   <span data-ttu-id="df2d8-429">*Publisher* - パブリッシャーの名前。</span><span class="sxs-lookup"><span data-stu-id="df2d8-429">*Publisher* - the name of the Publisher.</span></span>  
  
    -   <span data-ttu-id="df2d8-430">*PublisherDB* - パブリケーション データベースの名前。</span><span class="sxs-lookup"><span data-stu-id="df2d8-430">*PublisherDB* - the name of the publication database.</span></span>  
  
    -   <span data-ttu-id="df2d8-431">*Publication* - 即時更新サブスクライバーでサブスクライブしているパブリケーションの名前。</span><span class="sxs-lookup"><span data-stu-id="df2d8-431">*Publication* - the name of the publication to which the immediate updating Subscriber is subscribed.</span></span>  
  
    -   <span data-ttu-id="df2d8-432">*Distributor* - ディストリビューターの名前。</span><span class="sxs-lookup"><span data-stu-id="df2d8-432">*Distributor* - the name of the Distributor.</span></span>  
  
    -   <span data-ttu-id="df2d8-433">*PublisherSecurity* - A <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> オブジェクト。即時更新サブスクライバーがパブリッシャーに接続するときのセキュリティ モードと、その接続に必要なログイン資格情報を指定します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-433">*PublisherSecurity* - A <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> object that specifies the type of security mode used by the immediate updating Subscriber when connecting to the Publisher and login credentials for the connection.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="df2d8-434">例 (RMO)</span><span class="sxs-lookup"><span data-stu-id="df2d8-434">Example (RMO)</span></span>  
 <span data-ttu-id="df2d8-435">次の例では、指定されたログイン値をチェックし、該当する Windows ログイン、または、サーバー上のレプリケーションによって格納された SQL Server ログインを対象にすべてのパスワードを変更します。</span><span class="sxs-lookup"><span data-stu-id="df2d8-435">This example checks the supplied login value and changes all passwords for the supplied Windows login or SQL Server login stored by replication on the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeServerPasswords](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changeserverpasswords)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeServerPasswords](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changeserverpasswords)]  
  
##  <a name="follow-up-after-you-modify-replication-security-settings"></a><a name="FollowUp"></a><span data-ttu-id="df2d8-436">補足情報: レプリケーションのセキュリティ設定を変更した後</span><span class="sxs-lookup"><span data-stu-id="df2d8-436">Follow Up: After you modify replication security settings</span></span>  
 <span data-ttu-id="df2d8-437">エージェントのログインまたはパスワードを変更した後、変更を有効にするには、エージェントを停止して再起動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="df2d8-437">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="df2d8-438">参照</span><span class="sxs-lookup"><span data-stu-id="df2d8-438">See Also</span></span>  
 <span data-ttu-id="df2d8-439">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="df2d8-439">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="df2d8-440">[レプリケーション スクリプトのアップグレード &#40;レプリケーション Transact-SQL プログラミング&#41;](../administration/upgrade-replication-scripts-replication-transact-sql-programming.md) </span><span class="sxs-lookup"><span data-stu-id="df2d8-440">[Upgrade Replication Scripts &#40;Replication Transact-SQL Programming&#41;](../administration/upgrade-replication-scripts-replication-transact-sql-programming.md) </span></span>  
 <span data-ttu-id="df2d8-441">[レプリケーションのログインとパスワードの管理](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication) </span><span class="sxs-lookup"><span data-stu-id="df2d8-441">[Manage Logins and Passwords in Replication](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication) </span></span>  
 <span data-ttu-id="df2d8-442">[レプリケーション エージェントのセキュリティ モデル](replication-agent-security-model.md) </span><span class="sxs-lookup"><span data-stu-id="df2d8-442">[Replication Agent Security Model](replication-agent-security-model.md) </span></span>  
 <span data-ttu-id="df2d8-443">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="df2d8-443">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="df2d8-444">[SQL Server レプリケーションのセキュリティ](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="df2d8-444">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="df2d8-445">Replication System Stored Procedures Concepts</span><span class="sxs-lookup"><span data-stu-id="df2d8-445">Replication System Stored Procedures Concepts</span></span>](../concepts/replication-system-stored-procedures-concepts.md)  
  
  
