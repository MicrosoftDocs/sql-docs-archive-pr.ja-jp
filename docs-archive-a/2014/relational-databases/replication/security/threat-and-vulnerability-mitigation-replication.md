---
title: 脅威と脆弱性の対策 (レプリケーション) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- attacks [SQL Server replication]
- threats [SQL Server replication security]
- security [SQL Server replication], threats
- security threats [SQL Server replication]
ms.assetid: 314fe497-56d8-4192-98e9-21b87cf8db04
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c1a9c2c646f26d0cb61ae3d41ccdbd72551094d4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721243"
---
# <a name="threat-and-vulnerability-mitigation-replication"></a><span data-ttu-id="f1b84-102">脅威と脆弱性の対策 (レプリケーション)</span><span class="sxs-lookup"><span data-stu-id="f1b84-102">Threat and Vulnerability Mitigation (Replication)</span></span>
  <span data-ttu-id="f1b84-103">このトピックでは、レプリケーション トポロジに対する脅威を軽減する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="f1b84-103">This topic describes techniques to reduce threats to a replication topology.</span></span>  
  
## <a name="encryption"></a><span data-ttu-id="f1b84-104">暗号化</span><span class="sxs-lookup"><span data-stu-id="f1b84-104">Encryption</span></span>  
 <span data-ttu-id="f1b84-105">暗号化とは、想定されている相手以外はデータを解読できないように、特殊なキーがないと解読できない形式にデータを変換するプロセスです。</span><span class="sxs-lookup"><span data-stu-id="f1b84-105">Encryption is the process of converting data into a form that cannot be read without a special key, so that only the intended recipient can read the data.</span></span> <span data-ttu-id="f1b84-106">レプリケーションでは、テーブルに格納されるデータやネットワーク接続で送信されるデータの暗号化は行われません。</span><span class="sxs-lookup"><span data-stu-id="f1b84-106">Replication does not encrypt data stored in tables or sent over network connections.</span></span> <span data-ttu-id="f1b84-107">これは、トランスポート レベルで暗号化を行うさまざまな技術があるからです。たとえば、仮想プライベート ネットワーク (VPN)、SSL (Secure Sockets Layer)、IPSEC (IP Security) などの業界標準技術があります。</span><span class="sxs-lookup"><span data-stu-id="f1b84-107">This is by design, because encryption is available at the transport level with a number of technologies, including the following industry standard technologies: Virtual Private Networks (VPN), Secure Sockets Layer (SSL), and IP Security (IPSEC).</span></span> <span data-ttu-id="f1b84-108">レプリケーション トポロジのコンピューター間の接続は、これらの方法を使用して暗号化することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="f1b84-108">We recommend using one of these encryption methods for the connections between computers in a replication topology.</span></span> <span data-ttu-id="f1b84-109">詳細については、「[データベース エンジンへの暗号化接続の有効化 &#40;SQL Server 構成マネージャー&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-109">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span> <span data-ttu-id="f1b84-110">VPN と SSL を使用したインターネット経由のデータのレプリケーションについては、「 [Securing Replication Over the Internet](securing-replication-over-the-internet.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-110">For information about using VPN and SSL for replicating data over the Internet, see [Securing Replication Over the Internet](securing-replication-over-the-internet.md).</span></span>  
  
 <span data-ttu-id="f1b84-111">SSL を使用してレプリケーション トポロジのコンピューター間の接続をセキュリティで保護する場合、各レプリケーション エージェントの **-EncryptionLevel** パラメーターに値 **1** または **2** を指定します (値 **2** が推奨値です)。</span><span class="sxs-lookup"><span data-stu-id="f1b84-111">If you use SSL to secure the connections between computers in a replication topology, specify a value of **1** or **2** for the **-EncryptionLevel** parameter of each replication agent (a value of **2** is recommended).</span></span> <span data-ttu-id="f1b84-112">値 **1** は、暗号化を使用していますが、SSL サーバー証明書が信頼されている発行者によって署名されていることをエージェントが検証していないことを示します。値 **2** は、証明書が検証されていることを示します。</span><span class="sxs-lookup"><span data-stu-id="f1b84-112">A value of **1** specifies that encryption is used, but the agent does not verify that the SSL server certificate is signed by a trusted issuer; a value of **2** specifies that the certificate is verified.</span></span> <span data-ttu-id="f1b84-113">エージェント パラメーターは、エージェント プロファイルおよびコマンド ラインで指定できます。</span><span class="sxs-lookup"><span data-stu-id="f1b84-113">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="f1b84-114">詳細については、次を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-114">For more information, see:</span></span>  
  
-   [<span data-ttu-id="f1b84-115">レプリケーション エージェント プロファイルの操作</span><span class="sxs-lookup"><span data-stu-id="f1b84-115">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
-   [<span data-ttu-id="f1b84-116">レプリケーション エージェント コマンド プロンプト パラメーターを表示および変更する &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="f1b84-116">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
-   [<span data-ttu-id="f1b84-117">Replication Agent Executables Concepts</span><span class="sxs-lookup"><span data-stu-id="f1b84-117">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
 <span data-ttu-id="f1b84-118">以下では、データベースのマスター キーに関連するレプリケーションの動作について説明します。マスター キーはデータの暗号化に使用されます。</span><span class="sxs-lookup"><span data-stu-id="f1b84-118">Replication has the following behavior with respect to database Master Keys, which are used to encrypt data:</span></span>  
  
-   <span data-ttu-id="f1b84-119">レプリケーションに関係するデータベース (パブリケーション データベース、サブスクリプション データベース、またはディストリビューション データベース) にマスター キーがある場合、そのデータベースのエージェント パスワードの暗号化および暗号化解除には、 [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] データベースの対称キーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="f1b84-119">If a Master Key is present in a database involved in replication (a publication database, subscription database, or distribution database), replication encrypts and decrypts agent passwords in that database using a [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] database symmetric key.</span></span> <span data-ttu-id="f1b84-120">マスター キーを使用する場合は、レプリケーションに関係する各データベースでマスター キーを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f1b84-120">If Master Keys are used, a Master Key should be created in each database involved in replication.</span></span> <span data-ttu-id="f1b84-121">マスター キーの作成の詳細については、「[CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-121">For more information about creating Master Keys, see [CREATE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="f1b84-122">レプリケーションでは、マスター キーはレプリケートされません。</span><span class="sxs-lookup"><span data-stu-id="f1b84-122">Replication does not replicate Master Keys.</span></span> <span data-ttu-id="f1b84-123">サブスクライバーでマスター キーが必要な場合は、BACKUP MASTER KEY を使用してパブリケーション データベースからエクスポートし、RESTORE MASTER KEY を使用してサブスクリプション データベースにインポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f1b84-123">If you require the Master Key at the Subscriber, you must export it from the publication database using BACKUP MASTER KEY and then import it into the subscription database using RESTORE MASTER KEY.</span></span> <span data-ttu-id="f1b84-124">詳細については、「[BACKUP MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-master-key-transact-sql)」と「[RESTORE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-master-key-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-124">For more information, see [BACKUP MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-master-key-transact-sql) and [RESTORE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="f1b84-125">アタッチ可能なサブスクリプションデータベースに対してマスターキーが定義されている場合は、 **@db_master_key_password** [Sp_attachsubscription &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-attachsubscription-transact-sql)のパラメーターを使用して、マスターキーのパスワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="f1b84-125">If a Master Key is defined for an attachable subscription database, specify the Master Key password using the **@db_master_key_password** parameter of [sp_attachsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-attachsubscription-transact-sql).</span></span> <span data-ttu-id="f1b84-126">これにより、サブスクライバーでそのデータベースをアタッチできます。</span><span class="sxs-lookup"><span data-stu-id="f1b84-126">This allows the database to be attached at the Subscriber.</span></span>  
  
 <span data-ttu-id="f1b84-127">暗号化とマスター キーの詳細については、「 [Encryption Hierarchy](../../security/encryption/encryption-hierarchy.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-127">For more information about encryption and Master Keys, see [Encryption Hierarchy](../../security/encryption/encryption-hierarchy.md).</span></span>  
  
 <span data-ttu-id="f1b84-128">レプリケーションでは、暗号化された列データをパブリッシュできます。</span><span class="sxs-lookup"><span data-stu-id="f1b84-128">Replication enables you to publish encrypted column data.</span></span> <span data-ttu-id="f1b84-129">このデータの暗号化を解除してサブスクライバーで使用するには、パブリッシャーでのデータの暗号化に使用されたキーがサブスクライバーにも存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f1b84-129">To decrypt and use this data at the Subscriber, the key that was used to encrypt the data at the Publisher must also be present on the Subscriber.</span></span> <span data-ttu-id="f1b84-130">レプリケーションでは、暗号化キーを送信する安全なメカニズムは提供されません。</span><span class="sxs-lookup"><span data-stu-id="f1b84-130">Replication does not provide a secure mechanism to transport encryption keys.</span></span> <span data-ttu-id="f1b84-131">このため、暗号化キーはサブスクライバーで手動で再作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f1b84-131">You must manually re-create the encryption key at the Subscriber.</span></span> <span data-ttu-id="f1b84-132">詳細については、「[Replicate Data in Encrypted Columns &#40;SQL Server Management Studio&#41;](replicate-data-in-encrypted-columns-sql-server-management-studio.md)」 (暗号化された列のデータをレプリケートする &#40;SQL Server Management Studio&#41;) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f1b84-132">For more information, see [Replicate Data in Encrypted Columns &#40;SQL Server Management Studio&#41;](replicate-data-in-encrypted-columns-sql-server-management-studio.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1b84-133">参照</span><span class="sxs-lookup"><span data-stu-id="f1b84-133">See Also</span></span>  
 <span data-ttu-id="f1b84-134">[Id および Access Control &#40;レプリケーション&#41;](identity-and-access-control-replication.md) </span><span class="sxs-lookup"><span data-stu-id="f1b84-134">[Identity and Access Control &#40;Replication&#41;](identity-and-access-control-replication.md) </span></span>  
 [<span data-ttu-id="f1b84-135">セキュリティで保護されたレプリケーションのデプロイ</span><span class="sxs-lookup"><span data-stu-id="f1b84-135">Secure Replication Deployment</span></span>](view-and-modify-replication-security-settings.md)  
  
  
