---
title: トランザクション レプリケーションの更新可能なサブスクリプション | Microsoft Docs
ms.custom: ''
ms.date: 03/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- transactional replication, updatable subscriptions
- updatable subscriptions, about updatable subscriptions
- queued updating subscriptions [SQL Server replication]
- immediate updating subscriptions
- subscriptions [SQL Server replication], updatable
- updatable subscriptions
ms.assetid: 8eec95cb-3a11-436e-bcee-bdcd05aa5c5a
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e0b739ffe34a14519ff5290c406805ff7715edce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645498"
---
# <a name="updatable-subscriptions-for-transactional-replication"></a><span data-ttu-id="d0efc-102">Updatable Subscriptions for Transactional Replication</span><span class="sxs-lookup"><span data-stu-id="d0efc-102">Updatable Subscriptions for Transactional Replication</span></span>

<span data-ttu-id="d0efc-103">**適用対象:** SQL Server 2008 (以降)</span><span class="sxs-lookup"><span data-stu-id="d0efc-103">**Applies to:** SQL Server 2008 (and later)</span></span>

    
> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
<span data-ttu-id="d0efc-104">SQL Server 2014 では、トランザクションレプリケーションでは、更新可能なサブスクリプションとピアツーピアレプリケーションによるサブスクライバーでの更新がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-104">In SQL Server 2014, transactional replication supports updates at Subscribers through updatable subscriptions and peer-to-peer replication.</span></span> <span data-ttu-id="d0efc-105">2 種類の更新可能なサブスクリプションを以下に示します。</span><span class="sxs-lookup"><span data-stu-id="d0efc-105">The following are the two types of updatable subscriptions:</span></span>  
  
-   <span data-ttu-id="d0efc-106">即時更新。</span><span class="sxs-lookup"><span data-stu-id="d0efc-106">Immediate updating.</span></span> <span data-ttu-id="d0efc-107">サブスクライバーのデータを更新するために、パブリッシャーとサブスクライバーを接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-107">The Publisher and Subscriber must be connected to update data at the Subscriber.</span></span>  
  
-   <span data-ttu-id="d0efc-108">キュー更新。サブスクライバーのデータを更新するために、パブリッシャーとサブスクライバーを接続する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-108">Queued updating The Publisher and Subscriber do not have to be connected to update data at the Subscriber.</span></span> <span data-ttu-id="d0efc-109">サブスクライバーまたはパブリッシャーがオフラインでも更新できます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-109">Updates can be made while the Subscriber or Publisher is offline.</span></span>  
  
 <span data-ttu-id="d0efc-110">サブスクライバーでデータが更新されると、更新はまずパブリッシャーに反映され、次に他のサブスクライバーに反映されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-110">When data is updated at a Subscriber, it is first propagated to the Publisher and then propagated to other Subscribers.</span></span> <span data-ttu-id="d0efc-111">即時更新を使用した場合、変更は 2 フェーズ コミット プロトコルを使用して即時に反映されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-111">If immediate updating is used, the changes are propagated immediately using the two-phase commit protocol.</span></span> <span data-ttu-id="d0efc-112">キュー更新を使用した場合、変更はキューに格納されます。キューに登録されたトランザクションは、ネットワーク接続が可能であればいつでも、パブリッシャーで非同期に適用されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-112">If queued updating is used, the changes are stored in a queue; the queued transactions are then applied asynchronously at the Publisher whenever network connectivity is available.</span></span> <span data-ttu-id="d0efc-113">更新は非同期的にパブリッシャーに反映されるので、同じデータがそのパブリッシャーまたは別のサブスクライバーによって更新済みになると、更新の適用時に競合が生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-113">Because the updates are propagated asynchronously to the Publisher, the same data may have been updated by the Publisher or by another Subscriber and conflicts can occur when applying the updates.</span></span> <span data-ttu-id="d0efc-114">競合の解決方法はパブリケーションの作成時に設定され、この方法に従って競合が検出されて解決されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-114">Conflicts are detected and resolved according to a conflict resolution policy that is set when creating the publication.</span></span>  
  
 <span data-ttu-id="d0efc-115">パブリケーションの新規作成ウィザードで更新可能なサブスクリプションによるトランザクション パブリケーションを作成する場合は、即時更新およびキュー更新の両方が有効になります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-115">If you create a transactional publication with updatable subscriptions in the New Publication Wizard, both immediate updating and queued updating are enabled.</span></span> <span data-ttu-id="d0efc-116">ストアド プロシージャによるパブリケーションを作成する場合は、どちらか一方または両方のオプションを有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-116">If you create a publication with stored procedures, you can enable one or both options.</span></span> <span data-ttu-id="d0efc-117">パブリケーションに対してサブスクリプションを作成する場合は、使用する更新モードを指定します。</span><span class="sxs-lookup"><span data-stu-id="d0efc-117">When you create a subscription to the publication, you specify which update mode to use.</span></span> <span data-ttu-id="d0efc-118">必要に応じて、更新モードを切り替えることができます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-118">You can then switch between update modes if necessary.</span></span> <span data-ttu-id="d0efc-119">詳細については、以下の「更新モードの切り替え」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-119">For more information, see the following section "Switching between Update Modes".</span></span>  
  
 <span data-ttu-id="d0efc-120">トランザクション パブリケーションの更新可能なサブスクリプションを有効にするには、「[トランザクション パブリケーションの更新可能なサブスクリプションの有効化](../publish/enable-updating-subscriptions-for-transactional-publications.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-120">To enable updatable subscriptions for transactional publications, [Enable Updating Subscriptions for Transactional Publications](../publish/enable-updating-subscriptions-for-transactional-publications.md)</span></span>  
  
 <span data-ttu-id="d0efc-121">トランザクション パブリケーションの更新可能なサブスクリプションを作成するには、「 [Create an Updatable Subscription to a Transactional Publication](../publish/create-an-updatable-subscription-to-a-transactional-publication.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-121">To create updatable subscriptions for transactional publications, see [Create an Updatable Subscription to a Transactional Publication](../publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span></span>  
  
## <a name="switching-between-update-modes"></a><span data-ttu-id="d0efc-122">更新モードの切り替え</span><span class="sxs-lookup"><span data-stu-id="d0efc-122">Switching Between Update Modes</span></span>  
 <span data-ttu-id="d0efc-123">更新可能なサブスクリプションを使用する場合に、サブスクリプションに 1 つの更新モードを指定し、アプリケーションで別の更新モードが必要な場合はそちらに切り替えるように指定できます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-123">When using updatable subscriptions you can specify that a subscription should use one update mode and then switch to the other if the application requires it.</span></span> <span data-ttu-id="d0efc-124">たとえば、サブスクリプションで即時更新を使用するが、システム障害でネットワークに接続できなくなった場合には、キュー更新に切り替えるように指定することができます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-124">For example, you can specify that a subscription should use immediate updating, but switch to queued updating if a system failure results in the loss of network connectivity.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d0efc-125">レプリケーションでは、自動的に更新モードの切り替えを行いません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-125">Replication does not switch automatically between update modes.</span></span> <span data-ttu-id="d0efc-126">SQL Server Management Studio で更新モードを設定するか、アプリケーションから [sp_setreplfailovermode &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setreplfailovermode-transact-sql) を呼び出してモードを切り替える必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-126">You must set the update mode through SQL Server Management Studio or your application must call [sp_setreplfailovermode &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-setreplfailovermode-transact-sql) to switch between modes.</span></span>  
  
 <span data-ttu-id="d0efc-127">即時更新からキュー更新へ切り替えた場合、サブスクライバーとパブリッシャーが接続され、キュー リーダー エージェントがキューにあるすべての保留メッセージをパブリッシャーに適用するまで、即時更新に戻すことはできません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-127">If you switch from immediate updating to queued updating, you cannot switch back to immediate updating until the Subscriber and Publisher are connected and the Queue Reader Agent has applied all pending messages in the queue to the Publisher.</span></span>  
  
 <span data-ttu-id="d0efc-128">**更新モードを切り替えるには**</span><span class="sxs-lookup"><span data-stu-id="d0efc-128">**To switch between update modes**</span></span>  
  
 <span data-ttu-id="d0efc-129">更新モードを切り替えるには、両方の更新モードに対してパブリケーションとサブスクリプションを有効にしてから、必要に応じてこれらを切り替える必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-129">To switch between updating modes, you must enable the publication and subscription for both update modes, and then switch between them if necessary.</span></span> <span data-ttu-id="d0efc-130">詳細については、「</span><span class="sxs-lookup"><span data-stu-id="d0efc-130">For more information, see</span></span>  
<span data-ttu-id="d0efc-131">[更新可能なトランザクションサブスクリプションの更新モードを切り替え](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md)ます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-131">[Switch Between Update Modes for an Updatable Transactional Subscription](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span></span>  
  
### <a name="considerations-for-using-updatable-subscriptions"></a><span data-ttu-id="d0efc-132">更新可能なサブスクリプションの使用に関する注意点</span><span class="sxs-lookup"><span data-stu-id="d0efc-132">Considerations for Using Updatable Subscriptions</span></span>  
  
-   <span data-ttu-id="d0efc-133">更新サブスクリプションまたはキュー更新サブスクリプションに対してパブリケーションを有効にすると、このオプションをパブリケーションに対して無効にできません (サブスクリプションで使用する必要がない場合でも同様)。</span><span class="sxs-lookup"><span data-stu-id="d0efc-133">After a publication is enabled for updating subscriptions or queued updating subscriptions, the option cannot be disabled for the publication (although subscriptions do not need to use it).</span></span> <span data-ttu-id="d0efc-134">このオプションを無効にするには、パブリケーションを削除し、新しいパブリケーションを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-134">To disable the option, the publication must be deleted and a new one created.</span></span>  
  
-   <span data-ttu-id="d0efc-135">データの再パブリッシュはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-135">Republishing data is not supported.</span></span>  
  
-   <span data-ttu-id="d0efc-136">レプリケーションでは、追跡のため、パブリッシュされたテーブルに **msrepl_tran_version** 列を追加します。</span><span class="sxs-lookup"><span data-stu-id="d0efc-136">Replication adds the **msrepl_tran_version** column to published tables for tracking purposes.</span></span> <span data-ttu-id="d0efc-137">追加したこの列により、すべての `INSERT` ステートメントには、列リストを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-137">Because of this additional column, all `INSERT` statements should include a column list.</span></span>  
  
-   <span data-ttu-id="d0efc-138">更新サブスクリプションをサポートするパブリケーションのテーブルでスキーマ変更を行うには、パブリッシャーおよびサブスクライバーでのテーブルの利用をすべて停止し、スキーマ変更を行う前に、保留中のデータの変更をすべてのノードに反映させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-138">To make schema changes on a table in a publication that supports updating subscriptions, all activity on the table must be stopped at the Publisher and Subscribers, and pending data changes must be propagated to all nodes before making any schema changes.</span></span> <span data-ttu-id="d0efc-139">これにより、未完了のトランザクションが保留中のスキーマ変更と競合しません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-139">This ensures that outstanding transactions do not conflict with the pending schema change.</span></span> <span data-ttu-id="d0efc-140">スキーマ変更がすべてのノードに反映されたら、パブリッシュされたテーブルの操作を再開できます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-140">After the schema changes have propagated to all nodes, activity can resume on the published tables.</span></span> <span data-ttu-id="d0efc-141">詳細については、「[レプリケーション トポロジの停止 &#40;レプリケーション Transact-SQL プログラミング&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-141">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="d0efc-142">更新モードを切り替える場合、サブスクリプションが初期化された後で、少なくとも 1 回はキュー リーダー エージェントを実行する必要があります (既定では、キュー リーダー エージェントは連続的に実行されます)。</span><span class="sxs-lookup"><span data-stu-id="d0efc-142">If you plan to switch between update modes, the Queue Reader Agent must run at least once after the subscription has been initialized (by default, the Queue Reader Agent runs continuously).</span></span>  
  
-   <span data-ttu-id="d0efc-143">サブスクライバー データベースが行方向にパーティション分割され、そのパーティションにパブリッシャーではなくサブスクライバーの行が入る場合は、サブスクライバーはそれ以前に存在した行を更新することはできません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-143">If the Subscriber database is partitioned horizontally and there are rows in the partition that exist at the Subscriber, but not at the Publisher, the Subscriber cannot update the preexisting rows.</span></span> <span data-ttu-id="d0efc-144">これらの行を更新しようとすると、エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-144">Attempting to update these rows returns an error.</span></span> <span data-ttu-id="d0efc-145">行はテーブルから削除され、パブリッシャーで追加されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-145">The rows should be deleted from the table and then added at the Publisher.</span></span>  
  
### <a name="updates-at-the-subscriber"></a><span data-ttu-id="d0efc-146">サブスクライバーでの更新</span><span class="sxs-lookup"><span data-stu-id="d0efc-146">Updates at the Subscriber</span></span>  
  
-   <span data-ttu-id="d0efc-147">サブスクライバーでの更新は、サブスクリプションの有効期限が切れていたり、アクティブでない場合でも、パブリッシャーに反映されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-147">Updates at the Subscriber are propagated to the Publisher even if a subscription is expired or is inactive.</span></span> <span data-ttu-id="d0efc-148">そのようなサブスクリプションは、削除または再初期化してください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-148">Ensure that any such subscriptions are either dropped or reinitialized.</span></span>  
  
-   <span data-ttu-id="d0efc-149">`TIMESTAMP` または `IDENTITY` が使用され、これらの列が基本データ型としてレプリケートされる場合、列の値はサブスクライバーでは更新されません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-149">If `TIMESTAMP` or `IDENTITY` columns are used, and they are replicated as their base data types, values in these columns should not be updated at the Subscriber.</span></span>  
  
-   <span data-ttu-id="d0efc-150">`text`、`ntext` または `image` 値は、レプリケーションの変更の追跡トリガー内で挿入または削除されたテーブルから読み取ることができないため、サブスクライバーはこれらを更新または挿入できません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-150">Subscribers cannot update or insert `text`, `ntext` or `image` values because it is not possible to read from the inserted or deleted tables inside the replication change-tracking triggers.</span></span> <span data-ttu-id="d0efc-151">同様に、`WRITETEXT` や `UPDATETEXT` を使用すると、サブスクライバーは `text` 値や `image` 値を更新したり挿入したりすることができません。これらのデータはパブリッシャーによって上書きされるからです。</span><span class="sxs-lookup"><span data-stu-id="d0efc-151">Similarly, Subscribers cannot update or insert `text` or `image` values using `WRITETEXT` or `UPDATETEXT` because the data is overwritten by the Publisher.</span></span> <span data-ttu-id="d0efc-152">ただし、`text` 列と `image` 列を別々のテーブルに分けて、トランザクション内で 2 つのテーブルを変更することはできます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-152">Instead, you could partition the `text` and `image` columns into a separate table and modify the two tables within a transaction.</span></span>  
  
     <span data-ttu-id="d0efc-153">サブスクライバーで大きなオブジェクト更新するには、`text`、`ntext`、`image` のデータ型の代わりに、`varchar(max)`、`nvarchar(max)`、`varbinary(max)` のデータ型をそれぞれに使用します。</span><span class="sxs-lookup"><span data-stu-id="d0efc-153">To update large objects at a Subscriber, use the data types `varchar(max)`, `nvarchar(max)`, `varbinary(max)` instead of `text`, `ntext`, and `image` data types, respectively.</span></span>  
  
-   <span data-ttu-id="d0efc-154">一意なキー (主キーを含む) に対する更新によって重複が生じる場合 (たとえば、 `UPDATE <column> SET <column> =<column>+1` などの形式による更新)、その更新を行うことはできません。その更新は一意性違反のため拒否されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-154">Updates to unique keys (including primary keys) that generate duplicates (for example, an update of the form `UPDATE <column> SET <column> =<column>+1` are not allowed and will be rejected because of a uniqueness violation.</span></span> <span data-ttu-id="d0efc-155">これは、サブスクライバーで行われた SET 更新が、レプリケーションによって、影響される各行に対する個々の `UPDATE` ステートメントとして反映されるからです。</span><span class="sxs-lookup"><span data-stu-id="d0efc-155">This is because set updates made at the Subscriber are propagated by replication as individual `UPDATE` statements for each row affected.</span></span>  
  
-   <span data-ttu-id="d0efc-156">サブスクライバー データベースが行方向にパーティション分割されていて、行を含むパーティションがサブスクライバーにはあっても、パブリッシャーにはない場合、この既存の行をサブスクライバーは更新できません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-156">If the Subscriber database is partitioned horizontally and there are rows in the partition that exist at the Subscriber but not at the Publisher, the Subscriber cannot update the pre-existing rows.</span></span> <span data-ttu-id="d0efc-157">これらの行を更新しようとすると、エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-157">Attempting to update these rows returns an error.</span></span> <span data-ttu-id="d0efc-158">この行は、テーブルから削除し、再び挿入する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-158">The rows should be deleted from the table and inserted again.</span></span>  
  
### <a name="user-defined-triggers"></a><span data-ttu-id="d0efc-159">ユーザー定義トリガー</span><span class="sxs-lookup"><span data-stu-id="d0efc-159">User-defined Triggers</span></span>  
  
-   <span data-ttu-id="d0efc-160">サブスクライバーでアプリケーションがトリガーを必要とする場合、パブリッシャーおよびサブスクライバーで `NOT FOR REPLICATION` オプションを使用してトリガーを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-160">If the application requires triggers at the Subscriber, the triggers should be defined with the `NOT FOR REPLICATION` option at the Publisher and Subscriber.</span></span> <span data-ttu-id="d0efc-161">これにより、トリガーは元のデータの変更に対してのみ起動され、その変更がレプリケートされるときには起動されません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-161">This ensures that triggers fire only for the original data change, but not when that change is replicated.</span></span>  
  
     <span data-ttu-id="d0efc-162">ユーザー定義トリガーは、レプリケーション トリガーがテーブルを更新するときには起動されません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-162">Ensure that the user-defined trigger does not fire when the replication trigger updates the table.</span></span> <span data-ttu-id="d0efc-163">これは、ユーザー定義トリガーの本文で、プロシージャ `sp_check_for_sync_trigger` を呼び出すことにより実現されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-163">This is accomplished by calling the procedure `sp_check_for_sync_trigger` in the body of the user-defined trigger.</span></span> <span data-ttu-id="d0efc-164">詳細については、「[sp_check_for_sync_trigger &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-check-for-sync-trigger-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-164">For more information, see [sp_check_for_sync_trigger &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-check-for-sync-trigger-transact-sql).</span></span>  
  
### <a name="immediate-updating"></a><span data-ttu-id="d0efc-165">即時更新</span><span class="sxs-lookup"><span data-stu-id="d0efc-165">Immediate Updating</span></span>  
  
-   <span data-ttu-id="d0efc-166">即時更新サブスクリプションでは、サブスクライバーでの変更は、パブリッシャーに反映され、Microsoft 分散トランザクション コーディネーター (MS DTC) を使用して適用されます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-166">For immediate updating subscriptions, changes at the Subscriber are propagated to the Publisher and applied using Microsoft Distributed Transaction Coordinator (MS DTC).</span></span> <span data-ttu-id="d0efc-167">パブリッシャーおよびサブスクライバーに MS DTC がインストールおよび構成されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-167">Ensure that MS DTC is installed and configured at the Publisher and Subscriber.</span></span> <span data-ttu-id="d0efc-168">詳細については、Windows のマニュアルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-168">For more information, see the Windows documentation.</span></span>  
  
-   <span data-ttu-id="d0efc-169">即時更新サブスクリプションで使用されるトリガーでは、変更をレプリケートするためにパブリッシャーへ接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-169">The triggers used by immediate updating subscriptions require a connection to the Publisher to replicate changes.</span></span>  
  
-   <span data-ttu-id="d0efc-170">パブリケーションで、即時更新サブスクリプションおよびパブリケーション内のアーティクルに対する列フィルターが許容する場合は、既定値を持たず NULL にできない列をフィルター選択により除外することはできません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-170">If the publication allows immediate updating subscriptions and an article in the publication has a column filter, you cannot filter out non-nullable columns without defaults.</span></span>  
  
### <a name="queued-updating"></a><span data-ttu-id="d0efc-171">キュー更新</span><span class="sxs-lookup"><span data-stu-id="d0efc-171">Queued Updating</span></span>  
  
-   <span data-ttu-id="d0efc-172">キュー更新サブスクリプションを受け入れるトランザクション パブリケーションの一部として、マージ パブリケーションのテーブルをパブリッシュすることはできません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-172">Tables included in a merge publication cannot also be published as part of a transactional publication that allows queued updating subscriptions.</span></span>  
  
-   <span data-ttu-id="d0efc-173">主キーはすべてのキューでレコードを見つけるために使用されるので、キュー更新では主キーの列を更新しないでください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-173">Updates made to primary key columns are not recommended when using queued updating because the primary key is used as a record locator for all queries.</span></span> <span data-ttu-id="d0efc-174">競合の解決方法がサブスクライバー優先であるとき、主キーの更新には注意が必要です。</span><span class="sxs-lookup"><span data-stu-id="d0efc-174">When the conflict resolution policy is set to Subscriber Wins, updates to primary keys should be made with caution.</span></span> <span data-ttu-id="d0efc-175">主キーの更新をパブリッシャーとサブスクライバーの両方で行うと、その結果は 2 つの行がそれぞれ異なる主キーを持つことになります。</span><span class="sxs-lookup"><span data-stu-id="d0efc-175">If updates to the primary key are made at both the Publisher and at the Subscriber, the result will be two rows with different primary keys.</span></span>  
  
-   <span data-ttu-id="d0efc-176">データ型 `SQL_VARIANT` の列については、サブスクライバーでデータが挿入または更新されると、データをサブスクライバーからキューにコピーするときに、キュー リーダー エージェントによって次のようにマップされます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-176">For columns of data type `SQL_VARIANT`: when data is inserted or updated at the Subscriber, it is mapped in the following way by the Queue Reader Agent when it is copied from the Subscriber to the queue:</span></span>  
  
    -   <span data-ttu-id="d0efc-177">`BIGINT`、`DECIMAL`、`NUMERIC`、`MONEY`、および `SMALLMONEY` は、`NUMERIC` にマップされます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-177">`BIGINT`, `DECIMAL`, `NUMERIC`, `MONEY`, and `SMALLMONEY` are mapped to `NUMERIC`.</span></span>  
  
    -   <span data-ttu-id="d0efc-178">`BINARY` および `VARBINARY` は、`VARBINARY` データにマップされます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-178">`BINARY` and `VARBINARY` are mapped to `VARBINARY` data.</span></span>  
  
### <a name="conflict-detection-and-resolution"></a><span data-ttu-id="d0efc-179">競合の検出と解決</span><span class="sxs-lookup"><span data-stu-id="d0efc-179">Conflict Detection and Resolution</span></span>  
  
-   <span data-ttu-id="d0efc-180">サブスクライバー優先の競合ポリシーの場合、主キー列への更新に対して、競合解決方法はサポートされません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-180">For the Subscriber Wins conflict policy: conflict resolution is not supported for updates to primary key columns.</span></span>  
  
-   <span data-ttu-id="d0efc-181">外部キーの制約違反による競合は、レプリケーションでは解決されません。</span><span class="sxs-lookup"><span data-stu-id="d0efc-181">Conflicts due to foreign key constraint failures are not resolved by replication:</span></span>  
  
    -   <span data-ttu-id="d0efc-182">競合が予想されず、データが正常にパーティション分割されている (サブスクライバーは同じ行を更新しない) 場合は、パブリッシャーおよびサブスクライバーで外部キーの制約を使用できます。</span><span class="sxs-lookup"><span data-stu-id="d0efc-182">If conflicts are not expected and data is well partitioned (Subscribers do not update the same rows), you can use foreign key constraints on the Publisher and Subscribers.</span></span>  
  
    -   <span data-ttu-id="d0efc-183">競合が予想され、"サブスクライバー優先" の競合解決方法を使用する場合は、パブリッシャーまたはサブスクライバーで外部キーの制約は使用しないでください。"パブリッシャー優先" の競合解決方法を使用する場合は、サブスクライバーで外部キーの制約は使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="d0efc-183">If conflicts are expected: you should not use foreign key constraints at the Publisher or Subscriber if you use "Subscriber wins" conflict resolution; you should not use foreign key constraints at the Subscriber if you use "Publisher wins" conflict resolution.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d0efc-184">参照</span><span class="sxs-lookup"><span data-stu-id="d0efc-184">See Also</span></span>  
 <span data-ttu-id="d0efc-185">[Peer-to-Peer Transactional Replication](peer-to-peer-transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="d0efc-185">[Peer-to-Peer Transactional Replication](peer-to-peer-transactional-replication.md) </span></span>  
 <span data-ttu-id="d0efc-186">[トランザクションレプリケーション](transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="d0efc-186">[Transactional Replication](transactional-replication.md) </span></span>  
 <span data-ttu-id="d0efc-187">[データとデータベース オブジェクトのパブリッシュ](../publish/publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="d0efc-187">[Publish Data and Database Objects](../publish/publish-data-and-database-objects.md) </span></span>  
 [<span data-ttu-id="d0efc-188">パブリケーションのサブスクライブ</span><span class="sxs-lookup"><span data-stu-id="d0efc-188">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
  
  
