---
title: Microsoft COM ベースの競合回避モジュール | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: a6637e4b-4e6b-40aa-bee6-39d98cc507c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b446c3300b2c8a440a092084f01c55105c9be95e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87718015"
---
# <a name="microsoft-com-based-resolvers"></a><span data-ttu-id="8d92f-102">Microsoft COM-Based Resolvers</span><span class="sxs-lookup"><span data-stu-id="8d92f-102">Microsoft COM-Based Resolvers</span></span>
  <span data-ttu-id="8d92f-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] のすべての COM ベースの競合回避モジュールでは、更新の競合が処理され、指定した場所で挿入および削除の競合が処理されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-103">All of the COM-based resolvers supplied with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] handle update conflicts, and where indicated, they also handle insert and delete conflicts.</span></span> <span data-ttu-id="8d92f-104">すべての競合回避モジュールで列追跡処理が可能です。また、ほとんどのモジュールで行追跡処理を行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-104">They all handle column tracking; most also handle row tracking.</span></span> <span data-ttu-id="8d92f-105">この競合回避モジュール、および他の COM ベースの競合回避モジュールで処理可能な競合の種類が宣言され、それ以外の競合に対してはマージ  エージェントで既定の競合回避モジュールが使用されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-105">These and all other COM-based resolvers declare the types of conflict they can handle, and the Merge Agent uses the default resolver for all other conflict types.</span></span>  
  
 <span data-ttu-id="8d92f-106">競合回避モジュールは [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]のインストール処理中にインストールされます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-106">The resolvers are installed during the installation process for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8d92f-107">コンピューターに登録されているすべての競合回避モジュールを表示するには、 **sp_enumcustomresolvers** ストアド プロシージャを実行してください。</span><span class="sxs-lookup"><span data-stu-id="8d92f-107">Execute the **sp_enumcustomresolvers** stored procedure to view all the conflict resolvers registered on a computer.</span></span> <span data-ttu-id="8d92f-108">個別の結果セット内にある各競合回避モジュールの説明とグローバル一意識別子 (GUID) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-108">Executing the procedure displays the description and globally unique identifier (GUID) for each resolver in a separate result set.</span></span>  
  
 <span data-ttu-id="8d92f-109">競合回避モジュールを指定するには、「 [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8d92f-109">To specify a resolver, see [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md).</span></span>  
  
 <span data-ttu-id="8d92f-110">次の表は、特定の競合回避モジュールの属性を示しています。</span><span class="sxs-lookup"><span data-stu-id="8d92f-110">The following table describes the attributes of the specific resolvers.</span></span>  
  
|<span data-ttu-id="8d92f-111">Name</span><span class="sxs-lookup"><span data-stu-id="8d92f-111">Name</span></span>|<span data-ttu-id="8d92f-112">必要な入力</span><span class="sxs-lookup"><span data-stu-id="8d92f-112">Required input</span></span>|<span data-ttu-id="8d92f-113">説明</span><span class="sxs-lookup"><span data-stu-id="8d92f-113">Description</span></span>|<span data-ttu-id="8d92f-114">説明</span><span class="sxs-lookup"><span data-stu-id="8d92f-114">Comments</span></span>|  
|----------|--------------------|-----------------|--------------|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 追加競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver</span></span>|<span data-ttu-id="8d92f-116">合計する列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-116">Name of the column to be summed.</span></span> <span data-ttu-id="8d92f-117">**int**、 **smallint**、 **numeric**などの算術データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-117">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="8d92f-118">優先される競合データは優先度値によって決まります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-118">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="8d92f-119">指定された列の値は、変換元の列の値と変換先の列の値を合計した値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-119">Specified column values are set to the sum of the source and the destination column values.</span></span> <span data-ttu-id="8d92f-120">1 つを NULL に設定した場合、他の列の値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-120">If one is set to NULL, they are set to the value of the other column.</span></span>|<span data-ttu-id="8d92f-121">更新の競合を対象とし、列追跡のみを行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-121">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 平均競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Averaging Conflict Resolver</span></span>|<span data-ttu-id="8d92f-123">平均をとる列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-123">Name of the column to be averaged.</span></span> <span data-ttu-id="8d92f-124">**int**、 **smallint**、 **numeric**などの算術データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-124">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="8d92f-125">優先される競合データは優先度値によって決まります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-125">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="8d92f-126">結果の列の値は、変換元の列の値と変換先の列の値の平均値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-126">The resulting column values are set to the average of the source and the destination column values.</span></span> <span data-ttu-id="8d92f-127">1 つを NULL に設定した場合、他の列の値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-127">If one is set to NULL, they are set to the value of the other column.</span></span>|<span data-ttu-id="8d92f-128">更新の競合を対象とし、列追跡のみを行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-128">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (古いデータ優先) 競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (Earlier Wins) Conflict Resolver</span></span>|<span data-ttu-id="8d92f-130">競合で優先されるデータを指定するのに使用する列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-130">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="8d92f-131">**datetime** 型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-131">It must have a **datetime** data type.</span></span>|<span data-ttu-id="8d92f-132">**datetime** 値で日付の古い列のデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-132">Column with the earlier **datetime** value determines the conflict winner.</span></span> <span data-ttu-id="8d92f-133">1 つを NULL に設定した場合、それ以外を格納する行が競合で優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-133">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="8d92f-134">更新の競合を対象とし、行および列追跡を行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-134">Supports update conflicts, row, and column tracking.</span></span> <span data-ttu-id="8d92f-135">列の値は直接比較され、タイム ゾーンが異なる場合、調整は実行されません。</span><span class="sxs-lookup"><span data-stu-id="8d92f-135">The column values are compared directly and an adjustment is not made for different time zones.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (新しいデータ優先) 競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (Later Wins) Conflict Resolver</span></span>|<span data-ttu-id="8d92f-137">競合で優先されるデータを指定するのに使用する列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-137">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="8d92f-138">**datetime** 型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-138">It must have **datetime** data type.</span></span>|<span data-ttu-id="8d92f-139">**datetime** 値で日付の新しい列のデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-139">Column with the later **datetime** value determines the conflict winner.</span></span> <span data-ttu-id="8d92f-140">1 つを NULL に設定した場合、それ以外を格納する行が競合で優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-140">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="8d92f-141">更新の競合を対象とし、行および列追跡を行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-141">Supports update conflicts, row, and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 最大競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Maximum Conflict Resolver</span></span>|<span data-ttu-id="8d92f-143">競合で優先されるデータを指定するのに使用する列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-143">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="8d92f-144">**int**、 **smallint**、 **numeric**などの算術データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-144">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="8d92f-145">数値の大きい列のデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-145">Column with the larger numeric value determines the conflict winner.</span></span> <span data-ttu-id="8d92f-146">1 つを NULL に設定した場合、それ以外を格納する行が競合で優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-146">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="8d92f-147">行および列追跡を行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-147">Supports row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 最小競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Minimum Conflict Resolver</span></span>|<span data-ttu-id="8d92f-149">競合で優先されるデータを指定するのに使用する列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-149">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="8d92f-150">**int**、 **smallint**、 **numeric**などの算術データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-150">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="8d92f-151">数値の小さい列のデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-151">Column with the smaller numeric value determines the conflict winner.</span></span> <span data-ttu-id="8d92f-152">1 つを NULL に設定した場合、それ以外を格納する行が競合で優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-152">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="8d92f-153">更新の競合を対象とし、行および列追跡を行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-153">Supports update conflicts, row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] マージ テキスト競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Merge Text Conflict Resolver</span></span>|<span data-ttu-id="8d92f-155">`@resolver_info = '[col1][===]'`などのテキスト列と区切り記号の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-155">Name of the text column and delimiter, for example, `@resolver_info = '[col1][===]'`.</span></span>|<span data-ttu-id="8d92f-156">優先される競合データは優先度値によって決まります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-156">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="8d92f-157">競合しているテキスト列は、マージされた値に設定されます。この値は、一般的なプレフィックスの後にパブリッシャーからの一意の部分、区切り記号、最後にサブスクライバーからの一意の部分の順で構成されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-157">The text columns in conflict are set to the merged value, consisting of the common prefix followed by the unique part from the Publisher, then by the delimiter, and finally by the unique part from the Subscriber.</span></span>|<span data-ttu-id="8d92f-158">更新の競合を対象とし、列追跡のみを行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-158">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] サブスクライバー常時優先競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscriber Always Wins Conflict Resolver</span></span>|<span data-ttu-id="8d92f-160">入力なし。</span><span class="sxs-lookup"><span data-stu-id="8d92f-160">No inputs.</span></span>|<span data-ttu-id="8d92f-161">変換元か変換先かにかかわらず、サブスクライバーのデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-161">Subscriber, regardless of whether it is the source or destination, is the winner.</span></span>|<span data-ttu-id="8d92f-162">全種類の競合を対象とします。</span><span class="sxs-lookup"><span data-stu-id="8d92f-162">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 優先列競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Priority Column Resolver</span></span>|<span data-ttu-id="8d92f-164">競合で優先されるデータを指定するのに使用する列の名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-164">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="8d92f-165">**int**、 **smallint**、 **numeric**などの算術データ型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="8d92f-165">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="8d92f-166">数値の大きい列のデータが優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-166">Column with the larger numeric value determines the conflict winner.</span></span> <span data-ttu-id="8d92f-167">1 つを NULL に設定した場合、それ以外を格納する行が競合で優先されます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-167">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="8d92f-168">更新の競合を対象とし、行および列追跡を行います。</span><span class="sxs-lookup"><span data-stu-id="8d92f-168">Supports update conflicts, row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-169">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] アップロード専用競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-169">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Upload Only Conflict Resolver</span></span>|<span data-ttu-id="8d92f-170">入力なし。</span><span class="sxs-lookup"><span data-stu-id="8d92f-170">No inputs.</span></span>|<span data-ttu-id="8d92f-171">パブリッシャーにアップロードされた変更が許容されます。変更はサブスクライバーにはダウンロードされません。</span><span class="sxs-lookup"><span data-stu-id="8d92f-171">Changes uploaded to the Publisher are accepted; changes are not downloaded to the Subscriber.</span></span>|<span data-ttu-id="8d92f-172">全種類の競合を対象とします。</span><span class="sxs-lookup"><span data-stu-id="8d92f-172">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ダウンロード専用競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Download Only Conflict Resolver</span></span>|<span data-ttu-id="8d92f-174">入力なし。</span><span class="sxs-lookup"><span data-stu-id="8d92f-174">No inputs.</span></span>|<span data-ttu-id="8d92f-175">パブリッシャーにアップロードされた変更は拒否されます。変更はサブスクライバーにダウンロードされます。</span><span class="sxs-lookup"><span data-stu-id="8d92f-175">Changes uploaded to the Publisher are rejected; changes are downloaded to the Subscriber.</span></span>|<span data-ttu-id="8d92f-176">全種類の競合を対象とします。</span><span class="sxs-lookup"><span data-stu-id="8d92f-176">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="8d92f-177">SQLServer ストアド プロシージャ競合回避モジュール</span><span class="sxs-lookup"><span data-stu-id="8d92f-177">SQLServer Stored Procedure Resolver</span></span>|<span data-ttu-id="8d92f-178">競合を処理するために競合回避モジュールが呼び出すストアド プロシージャの名前。</span><span class="sxs-lookup"><span data-stu-id="8d92f-178">Name of the stored procedure the resolver should call to handle the conflict.</span></span>|<span data-ttu-id="8d92f-179">競合の回避は、指定したストアド プロシージャのロジックに依存します。</span><span class="sxs-lookup"><span data-stu-id="8d92f-179">Conflict resolution depends on the logic in the stored procedure you specify.</span></span>|<span data-ttu-id="8d92f-180">更新の競合を対象とします。</span><span class="sxs-lookup"><span data-stu-id="8d92f-180">Supports update conflicts.</span></span> <span data-ttu-id="8d92f-181">詳細については、「[Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md)」 (マージ アーティクルのカスタム競合回避モジュールの実装) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8d92f-181">For more information, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md)</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="8d92f-182">参照</span><span class="sxs-lookup"><span data-stu-id="8d92f-182">See Also</span></span>  
 <span data-ttu-id="8d92f-183">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="8d92f-183">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="8d92f-184">sp_enumcustomresolvers (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8d92f-184">sp_enumcustomresolvers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql)  
  
  
