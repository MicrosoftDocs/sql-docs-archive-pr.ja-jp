---
title: ODBC カーソルライブラリ |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87634525"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="70ea1-102">ODBC カーソル ライブラリ</span><span class="sxs-lookup"><span data-stu-id="70ea1-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="70ea1-103">一部の ODBC ドライバーでは、既定のカーソル設定のみがサポートされています。これらのドライバーは、 **SQLSetPos**などの位置指定カーソル操作もサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="70ea1-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="70ea1-104">ODBC カーソル ライブラリは、通常はブロック カーソルや静的カーソルがサポートされないドライバーに対して、これらのカーソルを実装するときに使用される MDAC (Microsoft Data Access Components) のコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="70ea1-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="70ea1-105">カーソルライブラリでは、位置指定の UPDATE および DELETE ステートメントと、作成するカーソルの**SQLSetPos**も実装されています。</span><span class="sxs-lookup"><span data-stu-id="70ea1-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="70ea1-106">ODBC カーソル ライブラリは、ODBC ドライバー マネージャーと ODBC ドライバーの中間層として実装されます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="70ea1-107">ODBC ドライバー マネージャーは、ODBC カーソル ライブラリが読み込まれると、すべてのカーソル関連コマンドをドライバーではなく、読み込んだカーソル ライブラリにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="70ea1-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="70ea1-108">カーソル ライブラリでは、基になるドライバーから結果セット全体をフェッチし、その結果セットをクライアントにキャッシュすることにより、カーソルを実装します。</span><span class="sxs-lookup"><span data-stu-id="70ea1-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="70ea1-109">ODBC カーソル ライブラリを使用しているときは、アプリケーションではカーソル ライブラリのカーソル機能だけをサポートし、基になるドライバーの追加のカーソル機能はサポートしません。</span><span class="sxs-lookup"><span data-stu-id="70ea1-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="70ea1-110">Odbc カーソル [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ライブラリよりも多くのカーソル機能がサポートされているため、Native CLIENT odbc ドライバーで odbc カーソルライブラリを使用する必要はほとんどありません。</span><span class="sxs-lookup"><span data-stu-id="70ea1-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="70ea1-111">ODBC カーソルライブラリを Native Client ODBC ドライバーと共に使用する唯一の理由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] は、ドライバーがサーバーカーソルを介してカーソルサポートを実装しており、サーバーカーソルですべての SQL ステートメントがサポートされていないためです。</span><span class="sxs-lookup"><span data-stu-id="70ea1-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="70ea1-112">ストアド プロシージャ、バッチ、または COMPUTE、COMPUTE BY、FOR BROWSE、INTO などを含む SQL ステートメントで静的カーソルを使用する必要がある場合は、ODBC カーソル ライブラリの使用を検討してください。</span><span class="sxs-lookup"><span data-stu-id="70ea1-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="70ea1-113">ただし、カーソル ライブラリを使用する場合、結果セット全体がクライアントにキャッシュされるので、大量のメモリが使用され、パフォーマンスが低下することがあるので注意が必要です。</span><span class="sxs-lookup"><span data-stu-id="70ea1-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="70ea1-114">アプリケーションでは、データソースに接続する前に[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)を使用して接続属性を SQL_ATTR_ODBC_CURSORS 設定することによって、接続ごとにカーソルライブラリを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="70ea1-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="70ea1-115">SQL_ATTR_ODBC_CURSORS には、次の 3 つの値のいずれかを設定します。</span><span class="sxs-lookup"><span data-stu-id="70ea1-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="70ea1-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="70ea1-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="70ea1-117">Native Client ODBC ドライバーでこのオプションを設定すると [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] NATIVE client odbc ドライバーのネイティブカーソルサポートが odbc カーソルライブラリによって上書きされます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="70ea1-118">接続で使用できるのは、カーソル ライブラリでサポートされているカーソルのみで、サーバー カーソルは使用できません。</span><span class="sxs-lookup"><span data-stu-id="70ea1-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="70ea1-119">SQL_CUR_USE_DRIVER </span><span class="sxs-lookup"><span data-stu-id="70ea1-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="70ea1-120">このオプションを設定すると、native Client ODBC ドライバーに対するすべてのカーソルサポートを [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 接続に使用できます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="70ea1-121">この場合、ODBC カーソル ライブラリは使用できません。</span><span class="sxs-lookup"><span data-stu-id="70ea1-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="70ea1-122">すべてのカーソルはサーバー カーソルとして実装されます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="70ea1-123">SQL_CUR_USE_IF_NEEDED </span><span class="sxs-lookup"><span data-stu-id="70ea1-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="70ea1-124">このオプションを設定すると、Native Client ODBC ドライバーで使用した場合と同じ効果が SQL_CUR_USE_DRIVER と同じになり [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="70ea1-125">ODBC ドライバーマネージャーは、接続時に、接続されている ODBC ドライバーが[Sqlfetchscroll](../../native-client-odbc-api/sqlfetchscroll.md)の SQL_FETCH_PRIOR オプションをサポートしているかどうかをテストします。</span><span class="sxs-lookup"><span data-stu-id="70ea1-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="70ea1-126">ドライバーでこのオプションがサポートされていない場合、ODBC ドライバー マネージャーは ODBC カーソル ライブラリを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="70ea1-127">サポートされている場合、ODBC ドライバー マネージャーは ODBC カーソル ライブラリを読み込みません。この場合、アプリケーションではドライバーのネイティブ サポートが使用されます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="70ea1-128">Native Client ODBC ドライバーでは SQL_FETCH_PRIOR がサポートされているので [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 、Odbc ドライバーマネージャーは odbc カーソルライブラリを読み込みません。</span><span class="sxs-lookup"><span data-stu-id="70ea1-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="70ea1-129">カーソル ライブラリにより、アプリケーションはスクロール可能なカーソルや更新可能なカーソルを使用できるだけでなく、1 つの接続に対して複数のアクティブ ステートメントを使用できます。</span><span class="sxs-lookup"><span data-stu-id="70ea1-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="70ea1-130">この機能をサポートする場合は、カーソル ライブラリを読み込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="70ea1-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="70ea1-131">[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)を使用して、カーソルライブラリの使用方法を指定し、 [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md)を使用してカーソルの種類、同時実行、および行セットのサイズを指定します。</span><span class="sxs-lookup"><span data-stu-id="70ea1-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="70ea1-132">参照</span><span class="sxs-lookup"><span data-stu-id="70ea1-132">See Also</span></span>  
 [<span data-ttu-id="70ea1-133">カーソルの実装方法</span><span class="sxs-lookup"><span data-stu-id="70ea1-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
