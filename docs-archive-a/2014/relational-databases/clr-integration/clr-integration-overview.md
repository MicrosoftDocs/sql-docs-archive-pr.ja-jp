---
title: CLR 統合の概要 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- common language runtime [SQL Server], about CLR integration
- extended stored procedures [SQL Server], vs. managed code
- objects [CLR integration]
- Transact-SQL vs. managed code
- managed code [SQL Server], vs. Transact-SQL
- managed code [SQL Server], vs. extended stored procedures
- execution at client vs. execution at server [CLR integration]
ms.assetid: 5aa176da-3652-4afa-a742-4c40c77ce5c3
author: rothja
ms.author: jroth
ms.openlocfilehash: ab7bb50109fa6b0a313da24f0e6164350a6160e3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87720013"
---
# <a name="overview-of-clr-integration"></a><span data-ttu-id="aba63-102">CLR 統合の概要</span><span class="sxs-lookup"><span data-stu-id="aba63-102">Overview of CLR Integration</span></span>
  <span data-ttu-id="aba63-103">共通言語ランタイム (CLR) は、Microsoft .NET Framework の中核であり、すべての .NET Framework コードの実行環境を提供します。</span><span class="sxs-lookup"><span data-stu-id="aba63-103">The common language runtime (CLR) is the heart of the Microsoft .NET Framework and provides the execution environment for all .NET Framework code.</span></span> <span data-ttu-id="aba63-104">CLR の内部で実行されるコードはマネージド コードと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="aba63-104">Code that runs within the CLR is referred to as managed code.</span></span> <span data-ttu-id="aba63-105">CLR は、ジャストインタイム (JIT) コンパイル、メモリの割り当てと管理、タイプ セーフの設定、例外処理、スレッド管理、セキュリティなど、プログラムの実行に必要なさまざまな機能やサービスを備えています。</span><span class="sxs-lookup"><span data-stu-id="aba63-105">The CLR provides various functions and services required for program execution, including just-in-time (JIT) compilation, allocating and managing memory, enforcing type safety, exception handling, thread management, and security.</span></span>  <span data-ttu-id="aba63-106">詳細については、.NET Framework SDK を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aba63-106">See the .NET Framework SDK for more information.</span></span>  
  
 <span data-ttu-id="aba63-107">Microsoft SQL Server にホストされる CLR (CLR 統合と呼ばれる) を利用することで、ストアド プロシージャ、トリガー、ユーザー定義関数、ユーザー定義型、およびユーザー定義集計をマネージド コードで作成できます。</span><span class="sxs-lookup"><span data-stu-id="aba63-107">With the CLR hosted in Microsoft SQL Server (called CLR integration), you can author stored procedures, triggers, user-defined functions, user-defined types, and user-defined aggregates in managed code.</span></span> <span data-ttu-id="aba63-108">マネージド コードは実行前にネイティブ コードにコンパイルされるため、状況によっては、パフォーマンスが大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="aba63-108">Because managed code compiles to native code prior to execution, you can achieve significant performance increases in some scenarios.</span></span>  
  
 <span data-ttu-id="aba63-109">マネージド コードでは、アセンブリが特定の操作を実行できないように、CAS (コード アクセス セキュリティ) が使用されます。</span><span class="sxs-lookup"><span data-stu-id="aba63-109">Managed code uses Code Access Security (CAS) to prevent assemblies from performing certain operations.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="aba63-110">では、CAS を使用して、マネージド コードをセキュリティで保護し、オペレーティング システムやデータベース サーバーが危険にさらされる状況を回避しています。</span><span class="sxs-lookup"><span data-stu-id="aba63-110">uses CAS to help secure the managed code and prevent compromise of the operating system or database server.</span></span>  
  
## <a name="advantages-of-clr-integration"></a><span data-ttu-id="aba63-111">CLR 統合機能の利点</span><span class="sxs-lookup"><span data-stu-id="aba63-111">Advantages of CLR Integration</span></span>  
 [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="aba63-112">は、データに直接アクセスしたり、データベースを直接操作することを主眼に設計されています。</span><span class="sxs-lookup"><span data-stu-id="aba63-112">is specifically designed for direct data access and manipulation in the database.</span></span> <span data-ttu-id="aba63-113">[!INCLUDE[tsql](../../../includes/tsql-md.md)] はデータへのアクセスやデータの管理に優れていますが、いわゆる本格的なプログラミング言語ではありません。</span><span class="sxs-lookup"><span data-stu-id="aba63-113">While [!INCLUDE[tsql](../../../includes/tsql-md.md)] excels at data access and management, it is not a full-fledged programming language.</span></span> <span data-ttu-id="aba63-114">たとえば、[!INCLUDE[tsql](../../../includes/tsql-md.md)] では、配列、コレクション、for-each ループ、ビット シフト、およびクラスはサポートされません。</span><span class="sxs-lookup"><span data-stu-id="aba63-114">For example, [!INCLUDE[tsql](../../../includes/tsql-md.md)] does not support arrays, collections, for-each loops, bit shifting, or classes.</span></span> <span data-ttu-id="aba63-115">このような構成要素の一部は [!INCLUDE[tsql](../../../includes/tsql-md.md)] を使用して類似したものを作成することもできますが、マネージド コードにはこれらの構成要素に対するサポートが組み込まれています。</span><span class="sxs-lookup"><span data-stu-id="aba63-115">While some of these constructs can be simulated in [!INCLUDE[tsql](../../../includes/tsql-md.md)], managed code has integrated support for these constructs.</span></span> <span data-ttu-id="aba63-116">シナリオによっては、この特性が、特定のデータベースの機能をマネージド コードに実装するかどうかの決め手となることがあります。</span><span class="sxs-lookup"><span data-stu-id="aba63-116">Depending on the scenario, these features can provide a compelling reason to implement certain database functionality in managed code.</span></span>  
  
 <span data-ttu-id="aba63-117">Microsoft Visual Basic .NET および Microsoft Visual C# は、カプセル化、継承、多態性など、オブジェクト指向の機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="aba63-117">Microsoft Visual Basic .NET and Microsoft Visual C# offer object-oriented capabilities such as encapsulation, inheritance, and polymorphism.</span></span> <span data-ttu-id="aba63-118">関連のあるコードは、簡単にクラスや名前空間に編成することができます。</span><span class="sxs-lookup"><span data-stu-id="aba63-118">Related code can now be easily organized into classes and namespaces.</span></span> <span data-ttu-id="aba63-119">大量のサーバー コードを使用している場合も、この機能により、コードの編成と管理を簡略化できます。</span><span class="sxs-lookup"><span data-stu-id="aba63-119">When you are working with large amounts of server code, this allows you to more easily organize and maintain your code.</span></span>  
  
 <span data-ttu-id="aba63-120">計算や複雑な実行ロジックには、[!INCLUDE[tsql](../../../includes/tsql-md.md)] よりもマネージド コードが適しています。また、マネージド コードでは、文字列処理や正規表現など、多数の複雑なタスクが幅広くサポートされています。</span><span class="sxs-lookup"><span data-stu-id="aba63-120">Managed code is better suited than [!INCLUDE[tsql](../../../includes/tsql-md.md)] for calculations and complicated execution logic, and features extensive support for many complex tasks, including string handling and regular expressions.</span></span> <span data-ttu-id="aba63-121">.NET Framework ライブラリの機能を使用すると、数千もの事前にビルドされたクラスやルーチンにアクセスすることができます。</span><span class="sxs-lookup"><span data-stu-id="aba63-121">With the functionality found in the .NET Framework Library, you have access to thousands of pre-built classes and routines.</span></span> <span data-ttu-id="aba63-122">このようなクラスやルーチンには、任意のストアド プロシージャ、トリガー、またはユーザー定義関数から簡単にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="aba63-122">These can be easily accessed from any stored procedure, trigger or user defined function.</span></span> <span data-ttu-id="aba63-123">BCL (基本クラス ライブラリ) には、文字列操作、高度な算術演算、ファイル アクセス、暗号化などの機能を提供するクラスがあります。</span><span class="sxs-lookup"><span data-stu-id="aba63-123">The Base Class Library (BCL) includes classes that provide functionality for string manipulation, advanced math operations, file access, cryptography, and more.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="aba63-124">これらのクラスの多くは、SQL Server の CLR コード内から使用できますが、サーバー側での使用が適していないクラス (ウィンドウ関連のクラスなど) にはアクセスできません。</span><span class="sxs-lookup"><span data-stu-id="aba63-124">While many of these classes are available for use from within CLR code in SQL Server, those that are not appropriate for server-side use (for example, windowing classes), are not available.</span></span> <span data-ttu-id="aba63-125">詳細については、「[サポートされている .NET Framework ライブラリ](database-objects/supported-net-framework-libraries.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aba63-125">For more information, see [Supported .NET Framework Libraries](database-objects/supported-net-framework-libraries.md).</span></span>  
  
 <span data-ttu-id="aba63-126">マネージド コードの利点の 1 つはタイプ セーフであることです。つまり、コードから各データ型へのアクセスは、正しく定義された許容される方法に限られます。</span><span class="sxs-lookup"><span data-stu-id="aba63-126">One of the benefits of managed code is type safety, or the assurance that code accesses types only in well-defined, permissible ways.</span></span> <span data-ttu-id="aba63-127">CLR は、マネージド コードが実行される前に、そのコードが安全であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="aba63-127">Before managed code is executed, the CLR verifies that the code is safe.</span></span> <span data-ttu-id="aba63-128">たとえば、事前に書き込まれていないメモリからの読み取りが行われないように、コードがチェックされます。</span><span class="sxs-lookup"><span data-stu-id="aba63-128">For example, the code is checked to ensure that no memory is read that has not previously been written.</span></span> <span data-ttu-id="aba63-129">また、CLR は、コードからアンマネージ メモリの操作が行われないようにする際にも役立ちます。</span><span class="sxs-lookup"><span data-stu-id="aba63-129">The CLR can also help ensure that code does not manipulate unmanaged memory.</span></span>  
  
 <span data-ttu-id="aba63-130">CLR 統合を使用すると、パフォーマンスが向上する可能性が高くなります。</span><span class="sxs-lookup"><span data-stu-id="aba63-130">CLR integration offers the potential for improved performance.</span></span> <span data-ttu-id="aba63-131">詳細については、「 [CLR 統合のパフォーマンス](clr-integration-architecture-performance.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aba63-131">For information, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="choosing-between-transact-sql-and-managed-code"></a><span data-ttu-id="aba63-132">Transact-SQL とマネージド コードの選択</span><span class="sxs-lookup"><span data-stu-id="aba63-132">Choosing Between Transact-SQL and Managed Code</span></span>  
 <span data-ttu-id="aba63-133">ストアド プロシージャ、トリガー、およびユーザー定義関数を記述する際には、従来の [!INCLUDE[tsql](../../../includes/tsql-md.md)] を使用するか、Visual Basic .NET や Visual C# などの .NET Framework 言語を使用するかを判断する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aba63-133">When writing stored procedures, triggers, and user-defined functions, one decision you must make is whether to use traditional [!INCLUDE[tsql](../../../includes/tsql-md.md)], or a .NET Framework language such as Visual Basic .NET or Visual C#.</span></span> <span data-ttu-id="aba63-134">データ アクセスに使用する手続き型のロジックが、コード中にない場合や非常に少ない場合は、[!INCLUDE[tsql](../../../includes/tsql-md.md)] を使用します。</span><span class="sxs-lookup"><span data-stu-id="aba63-134">Use [!INCLUDE[tsql](../../../includes/tsql-md.md)] when the code will mostly perform data access with little or no procedural logic.</span></span> <span data-ttu-id="aba63-135">複雑なロジックで CPU を集中的に使用する関数やプロシージャ、または .NET Framework の BCL を使用する場合は、マネージド コードを使用します。</span><span class="sxs-lookup"><span data-stu-id="aba63-135">Use managed code for CPU-intensive functions and procedures that feature complex logic, or when you want to make use of the BCL of the .NET Framework.</span></span>  
  
### <a name="choosing-between-execution-in-the-server-and-execution-in-the-client"></a><span data-ttu-id="aba63-136">サーバー側での実行とクライアント側での実行の選択</span><span class="sxs-lookup"><span data-stu-id="aba63-136">Choosing Between Execution in the Server and Execution in the Client</span></span>  
 <span data-ttu-id="aba63-137">[!INCLUDE[tsql](../../../includes/tsql-md.md)] とマネージド コードのどちらを使用するかを判断する際には、コードをサーバー コンピューターで実行するか、またはクライアント コンピューターで実行するかを判断する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aba63-137">Another factor in your decision about whether to use [!INCLUDE[tsql](../../../includes/tsql-md.md)] or managed code is where you would like your code to reside, the server computer or the client computer.</span></span> <span data-ttu-id="aba63-138">[!INCLUDE[tsql](../../../includes/tsql-md.md)] とマネージド コードは、どちらもサーバー側で実行することができます。</span><span class="sxs-lookup"><span data-stu-id="aba63-138">Both [!INCLUDE[tsql](../../../includes/tsql-md.md)] and managed code can be run on the server.</span></span> <span data-ttu-id="aba63-139">サーバー側でコードを実行すると、コードとデータが近くにあるため、サーバーの処理能力を活用できます。</span><span class="sxs-lookup"><span data-stu-id="aba63-139">This places code and data close together, and allows you to take advantage of the processing power of the server.</span></span> <span data-ttu-id="aba63-140">逆に、データベース サーバーでプロセッサを集中的に使用するタスクを実行することが好ましくない場合もあります。</span><span class="sxs-lookup"><span data-stu-id="aba63-140">On the other hand, you may wish to avoid placing processor intensive tasks on your database server.</span></span> <span data-ttu-id="aba63-141">現在、多くのクライアント コンピューターは高性能なので、できるだけ多くのコードをクライアント側で実行して、この処理能力を活用することもできます。</span><span class="sxs-lookup"><span data-stu-id="aba63-141">Most client computers today are very powerful, and you may wish to take advantage of this processing power by placing as much code as possible on the client.</span></span> <span data-ttu-id="aba63-142">[!INCLUDE[tsql](../../../includes/tsql-md.md)] はクライアント側で実行することはできませんが、マネージド コードはクライアント側で実行することができます。</span><span class="sxs-lookup"><span data-stu-id="aba63-142">Managed code can run on a client computer, while [!INCLUDE[tsql](../../../includes/tsql-md.md)] cannot.</span></span>  
  
## <a name="choosing-between-extended-stored-procedures-and-managed-code"></a><span data-ttu-id="aba63-143">拡張ストアド プロシージャとマネージド コードの選択</span><span class="sxs-lookup"><span data-stu-id="aba63-143">Choosing Between Extended Stored Procedures and Managed Code</span></span>  
 <span data-ttu-id="aba63-144">[!INCLUDE[tsql](../../../includes/tsql-md.md)] ストアド プロシージャでは実行不可能な機能を実行するために、拡張ストアド プロシージャを構築できます。</span><span class="sxs-lookup"><span data-stu-id="aba63-144">Extended stored procedures can be built to perform functionality not possible with [!INCLUDE[tsql](../../../includes/tsql-md.md)] stored procedures.</span></span> <span data-ttu-id="aba63-145">ただし、拡張ストアド プロシージャでは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] プロセスの整合性を侵害する可能性があります。一方、マネージド コードは、タイプ セーフなので、SQL Server プロセスの整合性を侵害することはありません。</span><span class="sxs-lookup"><span data-stu-id="aba63-145">Extended stored procedures can, however, compromise the integrity of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] process, while managed code that is verified to be type-safe cannot.</span></span> <span data-ttu-id="aba63-146">さらに、CLR のマネージド コードと [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] の間では、メモリ管理、スレッドやファイバーのスケジュール設定、同期サービスが、より密接に統合されます。</span><span class="sxs-lookup"><span data-stu-id="aba63-146">Further, memory management, scheduling of threads and fibers, and synchronization services are more deeply integrated between the managed code of the CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="aba63-147">CLR 統合を使用すると、拡張ストアド プロシージャを使用するよりも安全に、[!INCLUDE[tsql](../../../includes/tsql-md.md)] では記述できないタスクを実行するのに必要なストアド プロシージャを記述することができます。</span><span class="sxs-lookup"><span data-stu-id="aba63-147">With CLR integration, you have a more secure way than extended stored procedures to write the stored procedures you need to perform tasks not possible in [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="aba63-148">CLR 統合と拡張ストアドプロシージャの詳細については、「 [Clr 統合のパフォーマンス](clr-integration-architecture-performance.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="aba63-148">For more information about CLR integration and extended stored procedures, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aba63-149">参照</span><span class="sxs-lookup"><span data-stu-id="aba63-149">See Also</span></span>  
 <span data-ttu-id="aba63-150">[.NET Framework のインストール](https://technet.microsoft.com/library/ms166014\(v=SQL.105\).aspx) </span><span class="sxs-lookup"><span data-stu-id="aba63-150">[Installing the .NET Framework](https://technet.microsoft.com/library/ms166014\(v=SQL.105\).aspx) </span></span>  
 <span data-ttu-id="aba63-151">[CLR 統合のアーキテクチャ](../../database-engine/dev-guide/architecture-of-clr-integration.md) </span><span class="sxs-lookup"><span data-stu-id="aba63-151">[Architecture of CLR Integration](../../database-engine/dev-guide/architecture-of-clr-integration.md) </span></span>  
 <span data-ttu-id="aba63-152">[CLR データベースオブジェクトからのデータアクセス](data-access/data-access-from-clr-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="aba63-152">[Data Access from CLR Database Objects](data-access/data-access-from-clr-database-objects.md) </span></span>  
 [<span data-ttu-id="aba63-153">CLR 統合の概要</span><span class="sxs-lookup"><span data-stu-id="aba63-153">Getting Started with CLR Integration</span></span>](database-objects/getting-started-with-clr-integration.md)  
  
  
