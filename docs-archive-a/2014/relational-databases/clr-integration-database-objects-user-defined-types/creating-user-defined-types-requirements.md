---
title: ユーザー定義型の要件 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- UDTs [CLR integration], requirements
- serialization
- Native serialization format [CLR integration]
- attributes [CLR integration]
- XML serialization [CLR integration]
- user-defined types [CLR integration], requirements
- user-defined serialization [CLR integration]
- user-defined types [CLR integration], Native serialization
- UDTs [CLR integration], Native serialization
ms.assetid: bedc3372-50eb-40f2-bcf2-d6db6a63b7e6
author: rothja
ms.author: jroth
ms.openlocfilehash: d4e692a4523829713cd95daf62374f84a74b6584
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633174"
---
# <a name="user-defined-type-requirements"></a><span data-ttu-id="e1612-102">ユーザー定義型の要件</span><span class="sxs-lookup"><span data-stu-id="e1612-102">User-Defined Type Requirements</span></span>
  <span data-ttu-id="e1612-103">にインストールするユーザー定義型 (UDT) を作成する際には、いくつかの重要な設計上の決定を行う必要があり [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="e1612-103">You must make several important design decisions when creating a user-defined type (UDT) to be installed in [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e1612-104">ほとんどの場合は、UDT を構造体として作成することをお勧めしますが、クラスとして作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="e1612-104">For most UDTs, creating the UDT as a structure is recommended, although creating it as a class is also an option.</span></span> <span data-ttu-id="e1612-105">UDT の定義は、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に登録する UDT を作成するための仕様に準拠している必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-105">The UDT definition must conform to the specifications for creating UDTs in order for it to be registered with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="requirements-for-implementing-udts"></a><span data-ttu-id="e1612-106">UDT の実装要件</span><span class="sxs-lookup"><span data-stu-id="e1612-106">Requirements for Implementing UDTs</span></span>  
 <span data-ttu-id="e1612-107">UDT を [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] で実行するには、UDT の定義に次の要件を実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-107">To run in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your UDT must implement the following requirements in the UDT definition:</span></span>  
  
 <span data-ttu-id="e1612-108">UDT には、`Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-108">The UDT must specify the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span></span> <span data-ttu-id="e1612-109">`System.SerializableAttribute` の使用は任意ですが、使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e1612-109">The use of the `System.SerializableAttribute` is optional, but recommended.</span></span>  
  
-   <span data-ttu-id="e1612-110">UDT のクラスまたは構造体には、public `System.Data.SqlTypes.INullable` ([!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic では `static`) `Shared` メソッドを作成して `Null` インターフェイスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-110">The UDT must implement the `System.Data.SqlTypes.INullable` interface in the class or structure by creating a public `static` (`Shared` in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic) `Null` method.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e1612-111">では、既定で NULL 値に対応します。</span><span class="sxs-lookup"><span data-stu-id="e1612-111">is null-aware by default.</span></span> <span data-ttu-id="e1612-112">この作業は、UDT で実行されるコードが NULL 値を認識するために必要です。</span><span class="sxs-lookup"><span data-stu-id="e1612-112">This is necessary for code executing in the UDT to be able to recognize a null value.</span></span>  
  
-   <span data-ttu-id="e1612-113">UDT には、オブジェクトの文字列表現からの変換をサポートする public `static` (または `Shared`) `Parse` メソッドと、オブジェクトを文字列表現に変換するための public `ToString` メソッドを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-113">The UDT must contain a public `static` (or `Shared`) `Parse` method that supports parsing from, and a public `ToString` method for converting to a string representation of the object.</span></span>  
  
-   <span data-ttu-id="e1612-114">ユーザー定義シリアル化形式を指定した UDT には、`System.Data.IBinarySerialize` インターフェイスを実装して `Read` メソッドと `Write` メソッドを提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-114">A UDT with a user-defined serialization format must implement the `System.Data.IBinarySerialize` interface and provide a `Read` and a `Write` method.</span></span>  
  
-   <span data-ttu-id="e1612-115">標準のシリアル化をオーバーライドする必要がある場合は、UDT に `System.Xml.Serialization.IXmlSerializable` を実装するか、すべてのパブリック フィールドとパブリック プロパティを、XML シリアル化可能な型または `XmlIgnore` で修飾された型にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-115">The UDT must implement `System.Xml.Serialization.IXmlSerializable`, or all public fields and properties must be of types that are XML serializable or decorated with the `XmlIgnore` attribute if overriding standard serialization is required.</span></span>  
  
-   <span data-ttu-id="e1612-116">UDT オブジェクトのシリアル化は 1 つだけ存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-116">There must be only one serialization of a UDT object.</span></span> <span data-ttu-id="e1612-117">シリアル化ルーチンまたはシリアル化解除ルーチンでは、特定のオブジェクトの表現が複数認識されると検証が失敗します。</span><span class="sxs-lookup"><span data-stu-id="e1612-117">Validation fails if the serialize or deserialize routines recognize more than one representation of a particular object.</span></span>  
  
-   <span data-ttu-id="e1612-118">データをバイト順で比較するには、`SqlUserDefinedTypeAttribute.IsByteOrdered` を `true` にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-118">`SqlUserDefinedTypeAttribute.IsByteOrdered` must be `true` to compare data in byte order.</span></span> <span data-ttu-id="e1612-119">IComparable インターフェイスが実装されておらず、`SqlUserDefinedTypeAttribute.IsByteOrdered` が `false` の場合、バイト順での比較は失敗します。</span><span class="sxs-lookup"><span data-stu-id="e1612-119">If the IComparable interface is not implemented and `SqlUserDefinedTypeAttribute.IsByteOrdered` is `false`, byte order comparisons will fail.</span></span>  
  
-   <span data-ttu-id="e1612-120">クラスで定義する UDT には、引数を受け取らないバプリック コンストラクターを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-120">A UDT defined in a class must have a public constructor that takes no arguments.</span></span> <span data-ttu-id="e1612-121">必要に応じて、オーバーロードのクラス コンストラクターを追加作成できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-121">You can optionally create additional overloaded class constructors.</span></span>  
  
-   <span data-ttu-id="e1612-122">UDT では、データ要素をパブリック フィールドまたはプロパティ プロシージャとして公開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-122">The UDT must expose data elements as public fields or property procedures.</span></span>  
  
-   <span data-ttu-id="e1612-123">パブリック名は、128文字より長くすることはできません [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。また、[データベース識別子](../databases/database-identifiers.md)で定義されている識別子の名前付け規則に従っている必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-123">Public names cannot be longer than 128 characters, and must conform to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] naming rules for identifiers as defined in [Database Identifiers](../databases/database-identifiers.md).</span></span>  
  
-   <span data-ttu-id="e1612-124">`sql_variant` 列には UDT のインスタンスを含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="e1612-124">`sql_variant` columns cannot contain instances of a UDT.</span></span>  
  
-   <span data-ttu-id="e1612-125">[!INCLUDE[tsql](../../includes/tsql-md.md)] の型システムでは UDT 間の継承階層に対応していないので、継承されたメンバーに [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] からアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="e1612-125">Inherited members are not accessible from [!INCLUDE[tsql](../../includes/tsql-md.md)] because the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] type system is not aware of the inheritance hierarchy among UDTs.</span></span> <span data-ttu-id="e1612-126">ただし、型のマネージド コード実装では、継承を使用してクラスを構造化したり、そのクラスのメソッドを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="e1612-126">However, you can use inheritance when you structure your classes and you can call such methods in the managed code implementation of the type.</span></span>  
  
-   <span data-ttu-id="e1612-127">クラス コンストラクター以外のメンバーはオーバーロードできません。</span><span class="sxs-lookup"><span data-stu-id="e1612-127">Members cannot be overloaded, except for the class constructor.</span></span> <span data-ttu-id="e1612-128">オーバーロード メソッドを作成した場合、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] にアセンブリを登録したり、型を作成するときにはエラーは発生しません。</span><span class="sxs-lookup"><span data-stu-id="e1612-128">If you do create an overloaded method, no error is raised when you register the assembly or create the type in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e1612-129">オーバーロード メソッドが検出されるのは、型の作成時ではなく実行時です。</span><span class="sxs-lookup"><span data-stu-id="e1612-129">Detection of the overloaded method occurs at run time, not when the type is created.</span></span> <span data-ttu-id="e1612-130">オーバーロード メソッドは、呼び出されない限りクラス内に存在することができます。</span><span class="sxs-lookup"><span data-stu-id="e1612-130">Overloaded methods can exist in the class as long as they are never invoked.</span></span> <span data-ttu-id="e1612-131">エラーは、オーバーロード メソッドを呼び出した時点で発生します。</span><span class="sxs-lookup"><span data-stu-id="e1612-131">Once you invoke the overloaded method, an error is raised.</span></span>  
  
-   <span data-ttu-id="e1612-132">すべての `static` (または `Shared`) メンバーは定数または読み取り専用として宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-132">Any `static` (or `Shared`) members must be declared as constants or as read-only.</span></span> <span data-ttu-id="e1612-133">静的メンバーを変更可能にすることはできません。</span><span class="sxs-lookup"><span data-stu-id="e1612-133">Static members cannot be mutable.</span></span>  
  
-   <span data-ttu-id="e1612-134">`SqlUserDefinedTypeAttribute.MaxByteSize` フィールドが -1 に設定されている場合、シリアル化される UDT のサイズの上限は、ラージ オブジェクト (LOB) のサイズの上限 (現在 2 GB) と同じになります。</span><span class="sxs-lookup"><span data-stu-id="e1612-134">If the `SqlUserDefinedTypeAttribute.MaxByteSize` field is set to -1, the serialized UDT can be as large as the large object (LOB) size limit (currently 2 GB).</span></span> <span data-ttu-id="e1612-135">`MaxByteSized` フィールドに値が指定されている場合は、その値が UDT のサイズの上限になります。</span><span class="sxs-lookup"><span data-stu-id="e1612-135">The size of the UDT cannot exceed the value specified in the `MaxByteSized` field.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e1612-136">UDT は比較を実行するためにサーバーで使用されることはありませんが、単一のメソッド `System.IComparable` を公開する `CompareTo` インターフェイスを必要に応じて実装できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-136">Although it is not used by the server for performing comparisons, you can optionally implement the `System.IComparable` interface, which exposes a single method, `CompareTo`.</span></span> <span data-ttu-id="e1612-137">このインターフェイスは、クライアント側で UDT 値を正確に比較したり並べ替える場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="e1612-137">This is used on the client side in situations in which it is desirable to accurately compare or order UDT values.</span></span>  
  
## <a name="native-serialization"></a><span data-ttu-id="e1612-138">ネイティブ シリアル化</span><span class="sxs-lookup"><span data-stu-id="e1612-138">Native Serialization</span></span>  
 <span data-ttu-id="e1612-139">UDT に適したシリアル化属性は、作成する UDT の種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="e1612-139">Choosing the right serialization attributes for your UDT depends on the type of UDT you are trying to create.</span></span> <span data-ttu-id="e1612-140">`Native` シリアル化形式では、非常に単純な構造を使用して、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] が効率的なネイティブ形式で UDT をディスクに保存できるようにします。</span><span class="sxs-lookup"><span data-stu-id="e1612-140">The `Native` serialization format utilizes a very simple structure that enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to store an efficient native representation of the UDT on disk.</span></span> <span data-ttu-id="e1612-141">作成する UDT が単純で、次の型のフィールドのみを含む場合は、`Native` 形式を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e1612-141">The `Native` format is recommended if the UDT is simple and only contains fields of the following types:</span></span>  
  
 <span data-ttu-id="e1612-142">**bool**、 **byte**、 **sbyte**、 **short**、 **ushort**、 **int**、 **uint**、 **long**、 **ulong**、 **float**、 **double**、 **sqlbyte**、 **SqlInt16**、 **SqlInt32**、 **SqlInt64**、 **sqlbyte**、 **sqlbyte**、 **sqlbyte**、 **sqlbyte**、 **sqlbyte**</span><span class="sxs-lookup"><span data-stu-id="e1612-142">**bool**, **byte**, **sbyte**, **short**, **ushort**, **int**, **uint**, **long**, **ulong**, **float**, **double**, **SqlByte**, **SqlInt16**, **SqlInt32**, **SqlInt64**, **SqlDateTime**, **SqlSingle**, **SqlDouble**, **SqlMoney**, **SqlBoolean**</span></span>  
  
 <span data-ttu-id="e1612-143">上記の型のフィールドで構成される値型は、Visual C# のなどの形式に適してい `Native` `structs` ます。または、 `Structures` Visual Basic で認識されている場合はです。</span><span class="sxs-lookup"><span data-stu-id="e1612-143">Value types that are composed of fields of the above types are good candidates for `Native` format, such as `structs` in Visual C#, (or `Structures` as they are known in Visual Basic).</span></span> <span data-ttu-id="e1612-144">たとえば、シリアル化形式に `Native` を指定した UDT には、`Native` 形式を指定した別の UDT のフィールドを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="e1612-144">For example, a UDT specified with the `Native` serialization format may contain a field of another UDT that was also specified with the `Native` format.</span></span> <span data-ttu-id="e1612-145">作成する UDT の定義が複雑で、上記の一覧にないデータ型が含まれている場合は、`UserDefined` シリアル化形式を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-145">If the UDT definition is more complex and contains data types not on the above list, you must specify the `UserDefined` serialization format instead.</span></span>  
  
 <span data-ttu-id="e1612-146">`Native` 形式の要件を次に示します。</span><span class="sxs-lookup"><span data-stu-id="e1612-146">The `Native` format has the following requirements:</span></span>  
  
-   <span data-ttu-id="e1612-147">型に `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.MaxByteSize` の値を指定しないでください。</span><span class="sxs-lookup"><span data-stu-id="e1612-147">The type must not specify a value for `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.MaxByteSize`.</span></span>  
  
-   <span data-ttu-id="e1612-148">すべてのフィールドがシリアル化可能である必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-148">All fields must be serializable.</span></span>  
  
-   <span data-ttu-id="e1612-149">UDT を構造体ではなくクラスで定義する場合は、`System.Runtime.InteropServices.StructLayoutAttribute` を `StructLayout.LayoutKindSequential` に指定しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="e1612-149">The `System.Runtime.InteropServices.StructLayoutAttribute` must be specified as `StructLayout.LayoutKindSequential` if the UDT is defined in a class and not a structure.</span></span> <span data-ttu-id="e1612-150">この属性は、データ フィールドの物理レイアウトを制御し、メンバーを出現順にレイアウトするために使用します。</span><span class="sxs-lookup"><span data-stu-id="e1612-150">This attribute controls the physical layout of the data fields and is used to force the members to be laid out in the order in which they appear.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e1612-151">では、この属性を使用して複数の値を持つ UDT のフィールド順序を決定します。</span><span class="sxs-lookup"><span data-stu-id="e1612-151">uses this attribute to determine the field order for UDTs with multiple values.</span></span>  
  
 <span data-ttu-id="e1612-152">シリアル化で定義された UDT の例につい `Native` ては、「[ユーザー定義型のコーディング](creating-user-defined-types-coding.md)における udt」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e1612-152">For an example of a UDT defined with `Native` serialization, see the Point UDT in [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
## <a name="userdefined-serialization"></a><span data-ttu-id="e1612-153">ユーザー定義シリアル化</span><span class="sxs-lookup"><span data-stu-id="e1612-153">UserDefined Serialization</span></span>  
 <span data-ttu-id="e1612-154">`UserDefined` に `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` 形式を指定すると、開発者はバイナリ形式のフル コントロールを得ることができます。</span><span class="sxs-lookup"><span data-stu-id="e1612-154">The `UserDefined` format setting for the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` attribute gives the developer full control over the binary format.</span></span> <span data-ttu-id="e1612-155">`Format` 属性プロパティに `UserDefined` を指定するときは、コード内で次の設定を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-155">When specifying the `Format` attribute property as `UserDefined`, you must do the following in your code:</span></span>  
  
-   <span data-ttu-id="e1612-156">必要に応じて `IsByteOrdered` 属性プロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="e1612-156">Specify the optional `IsByteOrdered` attribute property.</span></span> <span data-ttu-id="e1612-157">既定値は `false` です。</span><span class="sxs-lookup"><span data-stu-id="e1612-157">The default value is `false`.</span></span>  
  
-   <span data-ttu-id="e1612-158">`MaxByteSize` の `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` プロパティを指定します。</span><span class="sxs-lookup"><span data-stu-id="e1612-158">Specify the `MaxByteSize` property of the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span></span>  
  
-   <span data-ttu-id="e1612-159">`Read` インターフェイスを実装することによって、UDT に `Write` メソッドと `System.Data.Sql.IBinarySerialize` メソッドを実装するコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="e1612-159">Write code to implement `Read` and `Write` methods for the UDT by implementing the `System.Data.Sql.IBinarySerialize` interface.</span></span>  
  
 <span data-ttu-id="e1612-160">シリアル化で定義された UDT の例につい `UserDefined` ては、「[ユーザー定義型のコーディング](creating-user-defined-types-coding.md)における通貨 udt」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e1612-160">For an example of a UDT defined with `UserDefined` serialization, see the Currency UDT in [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e1612-161">UDT フィールドをインデックス化するには、ネイティブ シリアル化を使用するか、UDT フィールドを保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-161">UDT fields must use native serialization or be persisted in order to be indexed.</span></span>  
  
## <a name="serialization-attributes"></a><span data-ttu-id="e1612-162">シリアル化属性</span><span class="sxs-lookup"><span data-stu-id="e1612-162">Serialization Attributes</span></span>  
 <span data-ttu-id="e1612-163">UDT のストレージ表現を構築し、クライアントに UDT を値として転送するためにシリアル化を使用する方法は、属性で決まります。</span><span class="sxs-lookup"><span data-stu-id="e1612-163">Attributes determine how serialization is used to construct the storage representation of UDTs and to transmit UDTs by value to the client.</span></span> <span data-ttu-id="e1612-164">UDT を作成する場合、`Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-164">You are required to specify the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` when creating the UDT.</span></span> <span data-ttu-id="e1612-165">`Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` 属性では、そのクラスが UDT であることを示し、UDT のストレージを指定します。</span><span class="sxs-lookup"><span data-stu-id="e1612-165">The `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` attribute indicates that the class is a UDT and specifies the storage for the UDT.</span></span> <span data-ttu-id="e1612-166">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では必要ありませんが、必要に応じて `Serializable` 属性を指定できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-166">You can optionally specify the `Serializable` attribute, although [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] does not require this.</span></span>  
  
 <span data-ttu-id="e1612-167">`Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` には、次のプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="e1612-167">The `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` has the following properties.</span></span>  
  
 `Format`  
 <span data-ttu-id="e1612-168">シリアル化形式を指定します。UDT のデータ型に応じて `Native` または `UserDefined` を指定できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-168">Specifies the serialization format, which can be `Native` or `UserDefined`, depending on the data types of the UDT.</span></span>  
  
 `IsByteOrdered`  
 <span data-ttu-id="e1612-169">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] で実行される UDT のバイナリの比較方法を決定する `Boolean` 値。</span><span class="sxs-lookup"><span data-stu-id="e1612-169">A `Boolean` value that determines how [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] performs binary comparisons on the UDT.</span></span>  
  
 `IsFixedLength`  
 <span data-ttu-id="e1612-170">この UDT のすべてのインスタンスの長さが同じであるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="e1612-170">Indicates whether all instances of this UDT are the same length.</span></span>  
  
 `MaxByteSize`  
 <span data-ttu-id="e1612-171">インスタンスのバイト単位の最大サイズ。</span><span class="sxs-lookup"><span data-stu-id="e1612-171">The maximum size of the instance, in bytes.</span></span> <span data-ttu-id="e1612-172">`MaxByteSize` は、`UserDefined` シリアル化形式では指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-172">You must specify `MaxByteSize` with the `UserDefined` serialization format.</span></span> <span data-ttu-id="e1612-173">UDT にユーザー定義のシリアル化を指定した場合、`MaxByteSize` は、ユーザーが定義した形式でシリアル化された UDT の合計サイズを表します。</span><span class="sxs-lookup"><span data-stu-id="e1612-173">For a UDT with user-defined serialization specified, `MaxByteSize` refers to the total size of the UDT in its serialized form as defined by the user.</span></span> <span data-ttu-id="e1612-174">`MaxByteSize` には、1 ～ 8000 の値を指定するか、UDT が 8000 バイトより大きいことを示す -1 (合計サイズが LOB の最大サイズを超えることはできません) に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-174">The value of `MaxByteSize` must be in the range of 1 to 8000, or set to -1 to indicate that the UDT is greater than 8000 bytes (the total size cannot exceed the maximum LOB size).</span></span> <span data-ttu-id="e1612-175">たとえば、10 文字 (`System.Char`) の文字列プロパティを持つ UDT について考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="e1612-175">Consider a UDT with a property of a string of 10 characters (`System.Char`).</span></span> <span data-ttu-id="e1612-176">BinaryWriter を使用して UDT をシリアル化すると、シリアル化された文字列の合計サイズは 22 バイトになります。このサイズは、2 バイト (Unicode UTF-16 の文字 1 文字) に最大文字数を掛け、さらにバイナリ ストリームのシリアル化から生じるオーバーヘッドの制御バイト 2 バイトを加えたものです。</span><span class="sxs-lookup"><span data-stu-id="e1612-176">When the UDT is serialized by using a BinaryWriter, the total size of the serialized string is 22 bytes: 2 bytes per Unicode UTF-16 character, multiplied by the maximum number of characters, plus 2 control bytes of overhead incurred from serializing a binary stream.</span></span> <span data-ttu-id="e1612-177">したがって、`MaxByteSize` の値を確認する場合、シリアル化された UDT の合計サイズは、バイナリ形式にシリアル化されたデータのサイズに、シリアル化によるオーバーヘッドを加えた値と考える必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-177">Therefore, when determining the value of `MaxByteSize`, the total size of the serialized UDT must be considered: the size of the data serialized in binary form plus the overhead incurred by serialization.</span></span>  
  
 `ValidationMethodName`  
 <span data-ttu-id="e1612-178">UDT のインスタンスの検証に使用するメソッドの名前。</span><span class="sxs-lookup"><span data-stu-id="e1612-178">The name of the method used to validate instances of the UDT.</span></span>  
  
### <a name="setting-isbyteordered"></a><span data-ttu-id="e1612-179">IsByteOrdered の設定</span><span class="sxs-lookup"><span data-stu-id="e1612-179">Setting IsByteOrdered</span></span>  
 <span data-ttu-id="e1612-180">`Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.IsByteOrdered` プロパティを `true` に設定すると、シリアル化されるバイナリ データを使用して、情報の意味的な順序を保証できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-180">When the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.IsByteOrdered` property is set to `true`, you are in effect guaranteeing that the serialized binary data can be used for semantic ordering of the information.</span></span> <span data-ttu-id="e1612-181">したがって、バイト順の UDT オブジェクトの各インスタンスは、シリアル化された表現を 1 つだけ持つことができます。</span><span class="sxs-lookup"><span data-stu-id="e1612-181">Thus, each instance of a byte-ordered UDT object can only have one serialized representation.</span></span> <span data-ttu-id="e1612-182">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] でシリアル化されたバイト列の比較操作を行うときは、その比較結果がマネージド コードで同じ比較操作を実行した場合と同じになる必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-182">When a comparison operation is performed in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on the serialized bytes, its results should be the same as if the same comparison operation had taken place in managed code.</span></span> <span data-ttu-id="e1612-183">`IsByteOrdered` を `true` に設定すると、次の機能もサポートされます。</span><span class="sxs-lookup"><span data-stu-id="e1612-183">The following features are also supported when `IsByteOrdered` is set to `true`:</span></span>  
  
-   <span data-ttu-id="e1612-184">この型の列にインデックスを作成する機能。</span><span class="sxs-lookup"><span data-stu-id="e1612-184">The ability to create indexes on columns of this type.</span></span>  
  
-   <span data-ttu-id="e1612-185">この型の列に CHECK 制約と UNIQUE 制約だけでなく主キーと外部キーを作成する機能。</span><span class="sxs-lookup"><span data-stu-id="e1612-185">The ability to create primary and foreign keys as well as CHECK and UNIQUE constraints on columns of this type.</span></span>  
  
-   <span data-ttu-id="e1612-186">[!INCLUDE[tsql](../../includes/tsql-md.md)] の ORDER BY 句、GROUP BY 句、および PARTITION BY 句を使用する機能。</span><span class="sxs-lookup"><span data-stu-id="e1612-186">The ability to use [!INCLUDE[tsql](../../includes/tsql-md.md)] ORDER BY, GROUP BY, and PARTITION BY clauses.</span></span> <span data-ttu-id="e1612-187">これらの句を使用した場合、順序の決定には型のバイナリ表現が使用されます。</span><span class="sxs-lookup"><span data-stu-id="e1612-187">In these cases, the binary representation of the type is used to determine the order.</span></span>  
  
-   <span data-ttu-id="e1612-188">[!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントで比較演算子を使用する機能。</span><span class="sxs-lookup"><span data-stu-id="e1612-188">The ability to use comparison operators in [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   <span data-ttu-id="e1612-189">この型の計算列を保存する機能。</span><span class="sxs-lookup"><span data-stu-id="e1612-189">The ability to persist computed columns of this type.</span></span>  
  
 <span data-ttu-id="e1612-190">`Native` を `UserDefined` に設定すると、`IsByteOrdered` と `true` のどちらのシリアル化形式でも次の比較演算子がサポートされることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="e1612-190">Note that both the `Native` and `UserDefined` serialization formats support the following comparison operators when `IsByteOrdered` is set to `true`:</span></span>  
  
-   <span data-ttu-id="e1612-191">等しい (=)</span><span class="sxs-lookup"><span data-stu-id="e1612-191">Equal to (=)</span></span>  
  
-   <span data-ttu-id="e1612-192">等しくない (!=)</span><span class="sxs-lookup"><span data-stu-id="e1612-192">Not equal to (!=)</span></span>  
  
-   <span data-ttu-id="e1612-193">より大きい (>)</span><span class="sxs-lookup"><span data-stu-id="e1612-193">Greater than (>)</span></span>  
  
-   <span data-ttu-id="e1612-194">より小さい (\<)</span><span class="sxs-lookup"><span data-stu-id="e1612-194">Less than (\<)</span></span>  
  
-   <span data-ttu-id="e1612-195">以上 (>=)</span><span class="sxs-lookup"><span data-stu-id="e1612-195">Greater than or equal to (>=)</span></span>  
  
-   <span data-ttu-id="e1612-196">以下 (<=)</span><span class="sxs-lookup"><span data-stu-id="e1612-196">Less than or equal to (<=)</span></span>  
  
### <a name="implementing-nullability"></a><span data-ttu-id="e1612-197">NULL 値の許容属性の実装</span><span class="sxs-lookup"><span data-stu-id="e1612-197">Implementing Nullability</span></span>  
 <span data-ttu-id="e1612-198">アセンブリの属性を正しく指定することに加えて、クラスで NULL 値の許容属性をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-198">In addition to specifying the attributes for your assemblies correctly, your class must also support nullability.</span></span> <span data-ttu-id="e1612-199">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] に読み込まれる UDT では NULL 値が許容されますが、その UDT に NULL 値を認識させるには、クラスに `INullable` インターフェイスを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-199">UDTs loaded into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are null-aware, but in order for the UDT to recognize a null value, the class must implement the `INullable` interface.</span></span> <span data-ttu-id="e1612-200">UDT に null 値の許容属性を実装する方法の詳細と例については、「[ユーザー定義型のコーディング](creating-user-defined-types-coding.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e1612-200">For more information and an example of how to implement nullability in a UDT, see [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
### <a name="string-conversions"></a><span data-ttu-id="e1612-201">文字列の変換</span><span class="sxs-lookup"><span data-stu-id="e1612-201">String Conversions</span></span>  
 <span data-ttu-id="e1612-202">UDT と文字列の間の変換をサポートするには、クラスに `Parse` メソッドと `ToString` メソッドを用意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-202">To support string conversion to and from the UDT, you must provide a `Parse` method and a `ToString` method in your class.</span></span> <span data-ttu-id="e1612-203">`Parse` メソッドでは、文字列を UDT に変換できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-203">The `Parse` method allows a string to be converted into a UDT.</span></span> <span data-ttu-id="e1612-204">このメソッドは `static` (Visual Basic では `Shared`) メソッドとして宣言され、`System.Data.SqlTypes.SqlString` 型のパラメーターを受け取る必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-204">It must be declared as `static` (or `Shared` in Visual Basic), and take a parameter of type `System.Data.SqlTypes.SqlString`.</span></span> <span data-ttu-id="e1612-205">メソッドとメソッドを実装する方法の詳細と例については `Parse` `ToString` 、「[ユーザー定義型のコーディング](creating-user-defined-types-coding.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e1612-205">For more information and an example of how to implement the `Parse` and `ToString` methods, see [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
## <a name="xml-serialization"></a><span data-ttu-id="e1612-206">XML シリアル化</span><span class="sxs-lookup"><span data-stu-id="e1612-206">XML Serialization</span></span>  
 <span data-ttu-id="e1612-207">UDT では、XML シリアル化のコントラクトに従って `xml` データ型との間の変換をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e1612-207">UDTs must support conversion to and from the `xml` data type by conforming to the contract for XML serialization.</span></span> <span data-ttu-id="e1612-208">`System.Xml.Serialization` 名前空間には、オブジェクトを XML 形式のドキュメントまたはストリームにシリアル化するために使用されるクラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="e1612-208">The `System.Xml.Serialization` namespace contains classes that are used to serialize objects into XML format documents or streams.</span></span> <span data-ttu-id="e1612-209">`xml` インターフェイスを使用すると、`IXmlSerializable` シリアル化を実装できます。このインターフェイスにより、XML シリアル化と XML シリアル化解除用のカスタム形式が提供されます。</span><span class="sxs-lookup"><span data-stu-id="e1612-209">You can choose to implement `xml` serialization by using the `IXmlSerializable` interface, which provides custom formatting for XML serialization and deserialization.</span></span>  
  
 <span data-ttu-id="e1612-210">UDT から `xml` 型への明示的な変換に加えて、XML シリアル化により次の操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-210">In addition to performing explicit conversions from UDT to `xml`, XML serialization enables you to:</span></span>  
  
-   <span data-ttu-id="e1612-211">`Xquery` データ型への変換後に、UDT インスタンスの値に `xml` を使用できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-211">Use `Xquery` over values of UDT instances after conversion to the `xml` data type.</span></span>  
  
-   <span data-ttu-id="e1612-212">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のネイティブ XML Web サービスにより、パラメーター化クエリと Web メソッドに UDT を使用できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-212">Use UDTs in parameterized queries and Web methods with Native XML Web Services in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="e1612-213">UDT を使用して、XML データの一括読み込みを受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="e1612-213">Use UDTs to receive a bulk load of XML data.</span></span>  
  
-   <span data-ttu-id="e1612-214">UDT 列を含むテーブルが格納されたデータセットをシリアル化できます。</span><span class="sxs-lookup"><span data-stu-id="e1612-214">Serialize DataSets that contain tables with UDT columns.</span></span>  
  
 <span data-ttu-id="e1612-215">UDT は、FOR XML クエリではシリアル化されません。</span><span class="sxs-lookup"><span data-stu-id="e1612-215">UDTs are not serialized in FOR XML queries.</span></span> <span data-ttu-id="e1612-216">UDT の XML シリアル化を表示する FOR XML クエリを実行するには、SELECT ステートメントで、各 UDT 列を明示的に `xml` データ型に変換します。</span><span class="sxs-lookup"><span data-stu-id="e1612-216">To execute a FOR XML query that displays the XML serialization of UDTs, explicitly convert each UDT column to the `xml` data type in the SELECT statement.</span></span> <span data-ttu-id="e1612-217">また、これらの列を明示的に `varbinary` 型、`varchar` 型、または `nvarchar` 型に変換することもできます。</span><span class="sxs-lookup"><span data-stu-id="e1612-217">You can also explicitly convert the columns to `varbinary`, `varchar`, or `nvarchar`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e1612-218">参照</span><span class="sxs-lookup"><span data-stu-id="e1612-218">See Also</span></span>  
 [<span data-ttu-id="e1612-219">ユーザー定義型の作成</span><span class="sxs-lookup"><span data-stu-id="e1612-219">Creating a User-Defined Type</span></span>](creating-user-defined-types.md)  
  
  
