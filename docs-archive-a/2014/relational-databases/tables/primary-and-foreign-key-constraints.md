---
title: 主キー制約と外部キー制約 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- foreign keys [SQL Server], cascading referential integrity
- FOREIGN KEY constraints
- foreign keys [SQL Server]
- foreign keys [SQL Server], about foreign key constraints
ms.assetid: 31fbcc9f-2dc5-4bf9-aa50-ed70ec7b5bcd
author: stevestein
ms.author: sstein
ms.openlocfilehash: b6e7b88de880348fabb00cb46d3028716441bc2b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87643724"
---
# <a name="primary-and-foreign-key-constraints"></a><span data-ttu-id="7a707-102">主キー制約と外部キー制約</span><span class="sxs-lookup"><span data-stu-id="7a707-102">Primary and Foreign Key Constraints</span></span>
  <span data-ttu-id="7a707-103">主キーと外部キーは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブル内のデータに整合性を適用するために使用できる 2 種類の制約です。</span><span class="sxs-lookup"><span data-stu-id="7a707-103">Primary keys and foreign keys are two types of constraints that can be used to enforce data integrity in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="7a707-104">これらは重要なデータベース オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="7a707-104">These are important database objects.</span></span>

 <span data-ttu-id="7a707-105">このトピックの内容は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="7a707-105">This topic contains the following sections.</span></span>

 [<span data-ttu-id="7a707-106">主キー制約</span><span class="sxs-lookup"><span data-stu-id="7a707-106">Primary Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#PKeys)

 [<span data-ttu-id="7a707-107">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="7a707-107">Foreign Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#FKeys)

 [<span data-ttu-id="7a707-108">関連タスク</span><span class="sxs-lookup"><span data-stu-id="7a707-108">Related Tasks</span></span>](../tables/primary-and-foreign-key-constraints.md#Tasks)

##  <a name="primary-key-constraints"></a><a name="PKeys"></a> <span data-ttu-id="7a707-109">主キー制約</span><span class="sxs-lookup"><span data-stu-id="7a707-109">Primary Key Constraints</span></span>
 <span data-ttu-id="7a707-110">テーブルには通常、テーブルの各行を一意に識別する値が格納された単一の列または複数の列の組み合わせがあります。</span><span class="sxs-lookup"><span data-stu-id="7a707-110">A table typically has a column or combination of columns that contain values that uniquely identify each row in the table.</span></span> <span data-ttu-id="7a707-111">この列、または列の組み合わせを、テーブルの主キー (PK) と呼び、テーブルのエンティティが整合性を持つようにします。</span><span class="sxs-lookup"><span data-stu-id="7a707-111">This column, or columns, is called the primary key (PK) of the table and enforces the entity integrity of the table.</span></span> <span data-ttu-id="7a707-112">主キー制約は一意なデータを保証するものであるため、通常は ID 列に対して定義されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-112">Because primary key constraints guarantee unique data, they are frequently defined on an identity column.</span></span>

 <span data-ttu-id="7a707-113">主キー制約をテーブルに対して指定すると、重複のないインデックスを [!INCLUDE[ssDE](../../includes/ssde-md.md)] が主キー列に対して自動的に作成し、データが一意になるようにします。</span><span class="sxs-lookup"><span data-stu-id="7a707-113">When you specify a primary key constraint for a table, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] enforces data uniqueness by automatically creating a unique index for the primary key columns.</span></span> <span data-ttu-id="7a707-114">また、クエリの中で主キーが使用された場合は、このインデックスによってデータに高速にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="7a707-114">This index also permits fast access to data when the primary key is used in queries.</span></span> <span data-ttu-id="7a707-115">複数の列に一意キー制約が定義されている場合は、1 つの列内で値が重複してもかまいませんが、一意キー制約が定義された列に格納される値の組み合わせは一意である必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-115">If a primary key constraint is defined on more than one column, values may be duplicated within one column, but each combination of values from all the columns in the primary key constraint definition must be unique.</span></span>

 <span data-ttu-id="7a707-116">次の図に示すように、このテーブルの複合主キー制約は、 **Purchasing.ProductVendor** テーブルの **ProductID** 列と **VendorID** 列により作成されています。</span><span class="sxs-lookup"><span data-stu-id="7a707-116">As shown in the following illustration, the **ProductID** and **VendorID** columns in the **Purchasing.ProductVendor** table form a composite primary key constraint for this table.</span></span> <span data-ttu-id="7a707-117">そのため、**ProductID** と **VendorID** の組み合わせは、**ProductVendor** テーブル内のすべての行で一意になります。</span><span class="sxs-lookup"><span data-stu-id="7a707-117">This makes sure that every row in the **ProductVendor** table has a unique combination of **ProductID** and **VendorID**.</span></span> <span data-ttu-id="7a707-118">これによって重複行の挿入が防止されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-118">This prevents the insertion of duplicate rows.</span></span>

 <span data-ttu-id="7a707-119">![複合 PRIMARY KEY 制約](../../database-engine/media/fund04.gif "複合 PRIMARY KEY 制約")</span><span class="sxs-lookup"><span data-stu-id="7a707-119">![Composite PRIMARY KEY constraint](../../database-engine/media/fund04.gif "Composite PRIMARY KEY constraint")</span></span>

-   <span data-ttu-id="7a707-120">テーブルに含めることができる主キー制約は 1 つだけです。</span><span class="sxs-lookup"><span data-stu-id="7a707-120">A table can contain only one primary key constraint.</span></span>

-   <span data-ttu-id="7a707-121">主キーは 16 列を超えることはできず、また、主キーの長さの合計が 900 バイトを超えることはできません。</span><span class="sxs-lookup"><span data-stu-id="7a707-121">A primary key cannot exceed 16 columns and a total key length of 900 bytes.</span></span>

-   <span data-ttu-id="7a707-122">主キー制約によって生成されたインデックスが含まれていても、テーブル上のインデックスの数を、非クラスター化インデックス 999 個、クラスター化インデックス 1 個より多くすることはできません。</span><span class="sxs-lookup"><span data-stu-id="7a707-122">The index generated by a primary key constraint cannot cause the number of indexes on the table to exceed 999 nonclustered indexes and 1 clustered index.</span></span>

-   <span data-ttu-id="7a707-123">主キー制約に対して clustered も nonclustered も指定されていない場合、テーブルにクラスター化インデックスが指定されていなければ、clustered が使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-123">If clustered or nonclustered is not specified for a primary key constraint, clustered is used if there no clustered index on the table.</span></span>

-   <span data-ttu-id="7a707-124">主キー制約中で定義する列はすべて、not null として定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-124">All columns defined within a primary key constraint must be defined as not null.</span></span> <span data-ttu-id="7a707-125">NULL 値を許容するかどうかを指定しない場合、主キー制約の影響を受けるすべての列は not null に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-125">If nullability is not specified, all columns participating in a primary key constraint have their nullability set to not null.</span></span>

-   <span data-ttu-id="7a707-126">CLR ユーザー定義型の列に対して主キーを定義する場合は、型の実装でバイナリ順がサポートされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-126">If a primary key is defined on a CLR user-defined type column, the implementation of the type must support binary ordering.</span></span>

##  <a name="foreign-key-constraints"></a><a name="FKeys"></a> <span data-ttu-id="7a707-127">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="7a707-127">Foreign Key Constraints</span></span>
 <span data-ttu-id="7a707-128">外部キー (FK) は、2 つのテーブルのデータ間にリンクを確立および設定することによって外部キー テーブルに格納できるデータを制御するための単一の列または複数の列の組み合わせです。</span><span class="sxs-lookup"><span data-stu-id="7a707-128">A foreign key (FK) is a column or combination of columns that is used to establish and enforce a link between the data in two tables to control the data that can be stored in the foreign key table.</span></span> <span data-ttu-id="7a707-129">外部キー参照では、1 つのテーブルの主キー値が格納されている列が別のテーブルの 1 つ以上の列によって参照されたときに、2 つのテーブル間にリンクが作成されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-129">In a foreign key reference, a link is created between two tables when the column or columns that hold the primary key value for one table are referenced by the column or columns in another table.</span></span> <span data-ttu-id="7a707-130">この列は、2 番目のテーブルの外部キーになります。</span><span class="sxs-lookup"><span data-stu-id="7a707-130">This column becomes a foreign key in the second table.</span></span>

 <span data-ttu-id="7a707-131">たとえば、 **Sales.SalesOrderHeader** テーブルには、 **Sales.SalesPerson** テーブルへの外部キー リンクが存在します。これは、販売注文と販売員の間に論理リレーションシップが存在するからです。</span><span class="sxs-lookup"><span data-stu-id="7a707-131">For example, the **Sales.SalesOrderHeader** table has a foreign key link to the **Sales.SalesPerson** table because there is a logical relationship between sales orders and salespeople.</span></span> <span data-ttu-id="7a707-132">**SalesOrderHeader** テーブルの **SalesPersonID** 列は、 **SalesPerson** テーブルの主キー列と一致します。</span><span class="sxs-lookup"><span data-stu-id="7a707-132">The **SalesPersonID** column in the **SalesOrderHeader** table matches the primary key column of the **SalesPerson** table.</span></span> <span data-ttu-id="7a707-133">また、 **SalesOrderHeader** テーブルの **SalesPersonID** 列は、 **SalesPerson** テーブルに対する外部キーです。</span><span class="sxs-lookup"><span data-stu-id="7a707-133">The **SalesPersonID** column in the **SalesOrderHeader** table is the foreign key to the **SalesPerson** table.</span></span> <span data-ttu-id="7a707-134">この外部キー リレーションシップを作成することによって、 **SalesPerson** テーブル内に存在しない **SalesPersonID** の値を **SalesOrderHeader** テーブルに挿入することはできなくなります。</span><span class="sxs-lookup"><span data-stu-id="7a707-134">By creating this foreign key relationship, a value for **SalesPersonID** cannot be inserted into the **SalesOrderHeader** table if it does not already exist in the **SalesPerson** table.</span></span>

### <a name="indexes-on-foreign-key-constraints"></a><span data-ttu-id="7a707-135">外部キー制約のインデックス</span><span class="sxs-lookup"><span data-stu-id="7a707-135">Indexes on Foreign Key Constraints</span></span>
 <span data-ttu-id="7a707-136">主キー制約とは異なり、外部キー制約を作成しても対応するインデックスは自動的には作成されません。</span><span class="sxs-lookup"><span data-stu-id="7a707-136">Unlike primary key constraints, creating a foreign key constraint does not automatically create a corresponding index.</span></span> <span data-ttu-id="7a707-137">ただし、外部キーに手動でインデックスを作成することには、通常、次のような利点があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-137">However, manually creating an index on a foreign key is often useful for the following reasons:</span></span>

-   <span data-ttu-id="7a707-138">クエリ内で、一方のテーブルの外部キー制約が定義された列を、他方のテーブルの主キー列または一意なキー列と照合することによって関連テーブルのデータが結合されるとき、多くの場合、外部キー列が結合基準に使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-138">Foreign key columns are frequently used in join criteria when the data from related tables is combined in queries by matching the column or columns in the foreign key constraint of one table with the primary or unique key column or columns in the other table.</span></span> <span data-ttu-id="7a707-139">インデックスを使用すると、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] により、外部キー テーブルの関連データがすばやく検索されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-139">An index enables the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to quickly find related data in the foreign key table.</span></span> <span data-ttu-id="7a707-140">ただし、必ずしもこのインデックスを作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="7a707-140">However, creating this index is not required.</span></span> <span data-ttu-id="7a707-141">2 つのテーブル間に主キー制約または外部キー制約が定義されていなくても、関連する 2 つのテーブルのデータを結合できます。ただし、2 つのテーブル間に外部キー リレーションシップが存在するということは、それら 2 つのテーブルが、結合基準としてキーを使用するクエリ内で結合されるように最適化されていることを示します。</span><span class="sxs-lookup"><span data-stu-id="7a707-141">Data from two related tables can be combined even if no primary key or foreign key constraints are defined between the tables, but a foreign key relationship between two tables indicates that the two tables have been optimized to be combined in a query that uses the keys as its criteria.</span></span>

-   <span data-ttu-id="7a707-142">主キー制約に加えた変更が、関連テーブルの外部キー制約によってチェックされます。</span><span class="sxs-lookup"><span data-stu-id="7a707-142">Changes to primary key constraints are checked with foreign key constraints in related tables.</span></span>

### <a name="referential-integrity"></a><span data-ttu-id="7a707-143">参照整合性</span><span class="sxs-lookup"><span data-stu-id="7a707-143">Referential Integrity</span></span>
 <span data-ttu-id="7a707-144">外部キー制約の主な目的は、外部キー テーブルに格納できるデータを制御することですが、主キー テーブルのデータに対する変更も制御されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-144">Although the main purpose of a foreign key constraint is to control the data that can be stored in the foreign key table, it also controls changes to data in the primary key table.</span></span> <span data-ttu-id="7a707-145">たとえば、ある販売員の行が **Sales.SalesPerson** テーブルから削除され、その販売員の ID が **Sales.SalesOrderHeader** テーブルの販売注文に使用された場合、2 つのテーブル間の参照整合性は破棄されます。削除された販売員の販売注文は、 **SalesPerson** テーブルのデータへのリンクを持たない状態となり、 **SalesOrderHeader** テーブル内で孤立します。</span><span class="sxs-lookup"><span data-stu-id="7a707-145">For example, if the row for a salesperson is deleted from the **Sales.SalesPerson** table, and the salesperson's ID is used for sales orders in the **Sales.SalesOrderHeader** table, the relational integrity between the two tables is broken; the deleted salesperson's sales orders are orphaned in the **SalesOrderHeader** table without a link to the data in the **SalesPerson** table.</span></span>

 <span data-ttu-id="7a707-146">外部キー制約を定義すると、このような状況が発生するのを防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="7a707-146">A foreign key constraint prevents this situation.</span></span> <span data-ttu-id="7a707-147">この制約により、外部キー テーブルのデータへのリンクが無効になるような変更を主キー テーブルのデータに加えることができなくなるため、参照整合性が保証されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-147">The constraint enforces referential integrity by guaranteeing that changes cannot be made to data in the primary key table if those changes invalidate the link to data in the foreign key table.</span></span> <span data-ttu-id="7a707-148">主キー テーブルの行を削除しようとするか、または主キー値を変更しようとした場合、削除または変更する主キー値が別のテーブルの外部キー制約の値と一致していると、その操作は失敗します。</span><span class="sxs-lookup"><span data-stu-id="7a707-148">If an attempt is made to delete the row in a primary key table or to change a primary key value, the action will fail when the deleted or changed primary key value corresponds to a value in the foreign key constraint of another table.</span></span> <span data-ttu-id="7a707-149">外部キー制約が定義された行を正常に変更または削除するには、まず、外部キー テーブルの外部キー データを削除または変更し、外部キーから他の主キー データへのリンクを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-149">To successfully change or delete a row in a foreign key constraint, you must first either delete the foreign key data in the foreign key table or change the foreign key data in the foreign key table, which links the foreign key to different primary key data.</span></span>

#### <a name="cascading-referential-integrity"></a><span data-ttu-id="7a707-150">連鎖参照整合性</span><span class="sxs-lookup"><span data-stu-id="7a707-150">Cascading Referential Integrity</span></span>
 <span data-ttu-id="7a707-151">連鎖参照整合性制約を使用することで、既存の外部キーが参照しているキーをユーザーが削除または更新するときの [!INCLUDE[ssDE](../../includes/ssde-md.md)] の動作を定義できます。</span><span class="sxs-lookup"><span data-stu-id="7a707-151">By using cascading referential integrity constraints, you can define the actions that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] takes when a user tries to delete or update a key to which existing foreign keys point.</span></span> <span data-ttu-id="7a707-152">以下の連鎖動作を定義できます。</span><span class="sxs-lookup"><span data-stu-id="7a707-152">The following cascading actions can be defined.</span></span>

 <span data-ttu-id="7a707-153">NO ACTION を実行する [!INCLUDE[ssDE](../../includes/ssde-md.md)] と、エラーが発生し、親テーブルの行に対する delete または update 操作がロールバックされます。</span><span class="sxs-lookup"><span data-stu-id="7a707-153">NO ACTION The [!INCLUDE[ssDE](../../includes/ssde-md.md)] raises an error and the delete or update action on the row in the parent table is rolled back.</span></span>

 <span data-ttu-id="7a707-154">親テーブルで行が更新または削除されると、参照元のテーブルでは、対応する行の連鎖が更新または削除されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-154">CASCADE Corresponding rows are updated or deleted in the referencing table when that row is updated or deleted in the parent table.</span></span> <span data-ttu-id="7a707-155">CASCADE は、`timestamp` 型の列が外部キーまたは参照先キーの一部である場合は指定できません。</span><span class="sxs-lookup"><span data-stu-id="7a707-155">CASCADE cannot be specified if a `timestamp` column is part of either the foreign key or the referenced key.</span></span> <span data-ttu-id="7a707-156">INSTEAD OF DELETE トリガーが設定されているテーブルには、ON DELETE CASCADE を指定できません。</span><span class="sxs-lookup"><span data-stu-id="7a707-156">ON DELETE CASCADE cannot be specified for a table that has an INSTEAD OF DELETE trigger.</span></span> <span data-ttu-id="7a707-157">INSTEAD OF UPDATE トリガーが設定されているテーブルには、ON UPDATE CASCADE を指定できません。</span><span class="sxs-lookup"><span data-stu-id="7a707-157">ON UPDATE CASCADE cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="7a707-158">親テーブルの対応する行が更新または削除されたときに、外部キーを構成するすべての値が NULL に設定されている場合は、NULL に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-158">SET NULL All the values that make up the foreign key are set to NULL when the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="7a707-159">この制約を実行するには、外部キー列が NULL 値を使用できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-159">For this constraint to execute, the foreign key columns must be nullable.</span></span> <span data-ttu-id="7a707-160">INSTEAD OF UPDATE トリガーが設定されているテーブルには指定できません。</span><span class="sxs-lookup"><span data-stu-id="7a707-160">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="7a707-161">親テーブルの対応する行が更新または削除された場合に、外部キーを構成するすべての値が既定値に設定されるように設定します。</span><span class="sxs-lookup"><span data-stu-id="7a707-161">SET DEFAULT All the values that make up the foreign key are set to their default values if the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="7a707-162">この制約を実行するには、すべての外部キー列に既定値が定義されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-162">For this constraint to execute, all foreign key columns must have default definitions.</span></span> <span data-ttu-id="7a707-163">列が NULL 値を許容し、明示的な既定値が設定されていない場合は、列の既定値として NULL が暗黙的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-163">If a column is nullable, and there is no explicit default value set, NULL becomes the implicit default value of the column.</span></span> <span data-ttu-id="7a707-164">INSTEAD OF UPDATE トリガーが設定されているテーブルには指定できません。</span><span class="sxs-lookup"><span data-stu-id="7a707-164">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="7a707-165">CASCADE、SET NULL、SET DEFAULT および NO ACTION は、互いに参照関係にあるテーブルに対して組み合わせて使用することができます。</span><span class="sxs-lookup"><span data-stu-id="7a707-165">CASCADE, SET NULL, SET DEFAULT and NO ACTION can be combined on tables that have referential relationships with each other.</span></span> <span data-ttu-id="7a707-166">[!INCLUDE[ssDE](../../includes/ssde-md.md)] が NO ACTION を検出すると、関連する CASCADE、SET NULL および SET DEFAULT 操作が停止されロールバックされます。</span><span class="sxs-lookup"><span data-stu-id="7a707-166">If the [!INCLUDE[ssDE](../../includes/ssde-md.md)] encounters NO ACTION, it stops and rolls back related CASCADE, SET NULL and SET DEFAULT actions.</span></span> <span data-ttu-id="7a707-167">DELETE ステートメントの実行によって、CASCADE、SET NULL、SET DEFAULT および NO ACTION 操作の組み合わせが適用される場合、 [!INCLUDE[ssDE](../../includes/ssde-md.md)] が NO ACTION があるかどうかを調べる前にすべての CASCADE、SET NULL および SET DEFAULT 操作が適用されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-167">When a DELETE statement causes a combination of CASCADE, SET NULL, SET DEFAULT and NO ACTION actions, all the CASCADE, SET NULL and SET DEFAULT actions are applied before the [!INCLUDE[ssDE](../../includes/ssde-md.md)] checks for any NO ACTION.</span></span>

### <a name="triggers-and-cascading-referential-actions"></a><span data-ttu-id="7a707-168">トリガーと連鎖参照動作</span><span class="sxs-lookup"><span data-stu-id="7a707-168">Triggers and Cascading Referential Actions</span></span>
 <span data-ttu-id="7a707-169">連鎖参照動作によって、AFTER UPDATE トリガーまたは AFTER DELETE トリガーは次のように起動します。</span><span class="sxs-lookup"><span data-stu-id="7a707-169">Cascading referential actions fire the AFTER UPDATE or AFTER DELETE triggers in the following manner:</span></span>

-   <span data-ttu-id="7a707-170">元の DELETE または UPDATE によって直接発生するすべての連鎖参照動作が、まず実行されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-170">All the cascading referential actions directly caused by the original DELETE or UPDATE are performed first.</span></span>

-   <span data-ttu-id="7a707-171">連鎖動作を受けたテーブルに AFTER トリガーが定義されている場合、すべての連鎖動作が実行された後でトリガーが起動します。</span><span class="sxs-lookup"><span data-stu-id="7a707-171">If there are any AFTER triggers defined on the affected tables, these triggers fire after all cascading actions are performed.</span></span> <span data-ttu-id="7a707-172">AFTER トリガーの起動順序は連鎖動作の逆です。</span><span class="sxs-lookup"><span data-stu-id="7a707-172">These triggers fire in opposite order of the cascading action.</span></span> <span data-ttu-id="7a707-173">1 つのテーブル内のトリガーの起動順序は、最初または最後に起動することが決まっているトリガーがある場合を除きランダムです。</span><span class="sxs-lookup"><span data-stu-id="7a707-173">If there are multiple triggers on a single table, they fire in random order, unless there is a dedicated first or last trigger for the table.</span></span> <span data-ttu-id="7a707-174">その起動順序は [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql)での指定に従います。</span><span class="sxs-lookup"><span data-stu-id="7a707-174">This order is as specified by using [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span></span>

-   <span data-ttu-id="7a707-175">UPDATE 操作または DELETE 操作を直接受けたテーブルから複数の連鎖チェーンが始まる場合、それぞれのチェーンでトリガーが起動する順序は特定できません。</span><span class="sxs-lookup"><span data-stu-id="7a707-175">If multiple cascading chains originate from the table that was the direct target of an UPDATE or DELETE action, the order in which these chains fire their respective triggers is unspecified.</span></span> <span data-ttu-id="7a707-176">ただし、必ず 1 本のチェーンのトリガーがすべて起動した後で別のチェーンのトリガーが起動を開始します。</span><span class="sxs-lookup"><span data-stu-id="7a707-176">However, one chain always fires all its triggers before another chain starts firing.</span></span>

-   <span data-ttu-id="7a707-177">UPDATE 操作または DELETE 操作を直接受けるテーブルの AFTER トリガーは、どの行も影響を受けないとしても起動します。</span><span class="sxs-lookup"><span data-stu-id="7a707-177">An AFTER trigger on the table that is the direct target of an UPDATE or DELETE action fires regardless of whether any rows are affected.</span></span> <span data-ttu-id="7a707-178">その際、他のテーブルには連鎖が波及しません。</span><span class="sxs-lookup"><span data-stu-id="7a707-178">There are no other tables affected by cascading in this case.</span></span>

-   <span data-ttu-id="7a707-179">あるトリガーで他のテーブルに対し UPDATE 操作または DELETE 操作が行われた場合、操作の後に 2 次的な連鎖チェーンが開始される場合があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-179">If any one of the previous triggers perform UPDATE or DELETE operations on other tables, these actions can start secondary cascading chains.</span></span> <span data-ttu-id="7a707-180">この 2 次的なチェーンは、最初に発生したチェーンのすべてのトリガーが起動した後でそれぞれの UPDATE 操作または DELETE 操作ごとに処理されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-180">These secondary chains are processed for each UPDATE or DELETE operation at a time after all triggers on all primary chains fire.</span></span> <span data-ttu-id="7a707-181">その後の UPDATE 操作または DELETE 操作についても、この処理が再帰的に繰り返されます。</span><span class="sxs-lookup"><span data-stu-id="7a707-181">This process may be recursively repeated for subsequent UPDATE or DELETE operations.</span></span>

-   <span data-ttu-id="7a707-182">CREATE、ALTER、DELETE、またはその他の DDL (データ定義言語) 操作をトリガー内で実行すると、DDL トリガーが起動する場合があります。</span><span class="sxs-lookup"><span data-stu-id="7a707-182">Performing CREATE, ALTER, DELETE, or other data definition language (DDL) operations inside the triggers may cause DDL triggers to fire.</span></span> <span data-ttu-id="7a707-183">その結果、新たな連鎖チェーンを開始したりトリガーを起動したりする DELETE 操作または UPDATE 操作が実行されることもあります。</span><span class="sxs-lookup"><span data-stu-id="7a707-183">This may subsequently perform DELETE or UPDATE operations that start additional cascading chains and triggers.</span></span>

-   <span data-ttu-id="7a707-184">特定の連鎖参照動作のチェーン内でエラーが発生した場合、エラーが表示され、そのチェーンの AFTER トリガーは起動されずに、チェーンを開始した DELETE 操作または UPDATE 操作がロールバックされます。</span><span class="sxs-lookup"><span data-stu-id="7a707-184">If an error is generated inside any particular cascading referential action chain, an error is raised, no AFTER triggers are fired in that chain, and the DELETE or UPDATE operation that created the chain is rolled back.</span></span>

-   <span data-ttu-id="7a707-185">INSTEAD OF トリガーを含んだテーブルに、連鎖動作を指定する REFERENCES 句を同時に指定することはできません。</span><span class="sxs-lookup"><span data-stu-id="7a707-185">A table that has an INSTEAD OF trigger cannot also have a REFERENCES clause that specifies a cascading action.</span></span> <span data-ttu-id="7a707-186">ただし、連鎖動作の対象になるテーブルの AFTER トリガーは、別のテーブルやビューに対して INSERT、UPDATE、または DELETE ステートメントを実行し、そのオブジェクトに定義されている INSTEAD OF トリガーを起動できます。</span><span class="sxs-lookup"><span data-stu-id="7a707-186">However, an AFTER trigger on a table targeted by a cascading action can execute an INSERT, UPDATE, or DELETE statement on another table or view that fires an INSTEAD OF trigger defined on that object.</span></span>

##  <a name="related-tasks"></a><a name="Tasks"></a> <span data-ttu-id="7a707-187">関連タスク</span><span class="sxs-lookup"><span data-stu-id="7a707-187">Related Tasks</span></span>
 <span data-ttu-id="7a707-188">次の表は、主キー制約および外部キー制約に関連した一般的なタスクの一覧です。</span><span class="sxs-lookup"><span data-stu-id="7a707-188">The following table lists the common tasks associated with primary key and foreign key constraints.</span></span>

|<span data-ttu-id="7a707-189">タスク</span><span class="sxs-lookup"><span data-stu-id="7a707-189">Task</span></span>|<span data-ttu-id="7a707-190">トピック</span><span class="sxs-lookup"><span data-stu-id="7a707-190">Topic</span></span>|
|----------|-----------|
|<span data-ttu-id="7a707-191">主キーを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-191">Describes how to create a primary key.</span></span>|[<span data-ttu-id="7a707-192">主キーの作成</span><span class="sxs-lookup"><span data-stu-id="7a707-192">Create Primary Keys</span></span>](../tables/create-primary-keys.md)|
|<span data-ttu-id="7a707-193">主キーを削除する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-193">Describes how to delete a primary key.</span></span>|[<span data-ttu-id="7a707-194">主キーの削除</span><span class="sxs-lookup"><span data-stu-id="7a707-194">Delete Primary Keys</span></span>](../tables/delete-primary-keys.md)|
|<span data-ttu-id="7a707-195">主キーを変更する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-195">Describes how to modify a primary key.</span></span>|[<span data-ttu-id="7a707-196">主キーの変更</span><span class="sxs-lookup"><span data-stu-id="7a707-196">Modify Primary Keys</span></span>](../tables/modify-primary-keys.md)|
|<span data-ttu-id="7a707-197">外部キー リレーションシップを作成する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-197">Describes how to create foreign key relationships</span></span>|[<span data-ttu-id="7a707-198">外部キーのリレーションシップの作成</span><span class="sxs-lookup"><span data-stu-id="7a707-198">Create Foreign Key Relationships</span></span>](../tables/create-foreign-key-relationships.md)|
|<span data-ttu-id="7a707-199">外部キー リレーションシップを変更する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-199">Describes how to modify foreign key relationships.</span></span>|[<span data-ttu-id="7a707-200">外部キー リレーションシップの変更</span><span class="sxs-lookup"><span data-stu-id="7a707-200">Modify Foreign Key Relationships</span></span>](../tables/modify-foreign-key-relationships.md)|
|<span data-ttu-id="7a707-201">外部キー リレーションシップを削除する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-201">Describes how to delete foreign key relationships.</span></span>|[<span data-ttu-id="7a707-202">外部キーのリレーションシップの削除</span><span class="sxs-lookup"><span data-stu-id="7a707-202">Delete Foreign Key Relationships</span></span>](../tables/delete-foreign-key-relationships.md)|
|<span data-ttu-id="7a707-203">外部キーのプロパティを表示する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-203">Describes how to view foreign key properties.</span></span>|[<span data-ttu-id="7a707-204">外部キーのプロパティの表示</span><span class="sxs-lookup"><span data-stu-id="7a707-204">View Foreign Key Properties</span></span>](../tables/view-foreign-key-properties.md)|
|<span data-ttu-id="7a707-205">レプリケーションに対して外部キー制約を無効にする方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-205">Describes how to disable foreign key constraints for replication.</span></span>|[<span data-ttu-id="7a707-206">レプリケーションに対して外部キー制約を無効にする方法</span><span class="sxs-lookup"><span data-stu-id="7a707-206">Disable Foreign Key Constraints for Replication</span></span>](../tables/disable-foreign-key-constraints-for-replication.md)|
|<span data-ttu-id="7a707-207">INSERT または UPDATE ステートメント時に外部キー制約を無効にする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a707-207">Describes how to disable foreign key constraints during an INSERT or UPDATE statement.</span></span>|[<span data-ttu-id="7a707-208">INSERT ステートメントまたは UPDATE ステートメントに対して外部キー制約を無効にする方法</span><span class="sxs-lookup"><span data-stu-id="7a707-208">Disable Foreign Key Constraints with INSERT and UPDATE Statements</span></span>](../tables/disable-foreign-key-constraints-with-insert-and-update-statements.md)|


