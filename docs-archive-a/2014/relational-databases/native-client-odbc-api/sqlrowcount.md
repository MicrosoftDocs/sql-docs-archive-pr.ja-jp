---
title: SQLRowCount |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLRowCount function
ms.assetid: 967ed3d4-3d31-4485-ac92-027076ebc829
author: rothja
ms.author: jroth
ms.openlocfilehash: 410023d960bad6dde1060a509cc1bf46f67d77cc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645020"
---
# <a name="sqlrowcount"></a><span data-ttu-id="31b0b-102">SQLRowCount</span><span class="sxs-lookup"><span data-stu-id="31b0b-102">SQLRowCount</span></span>
  <span data-ttu-id="31b0b-103">パラメーター値の配列がステートメントの実行にバインドされると、 `SQLRowCount` ステートメントの実行時にパラメーター値のいずれかの行でエラー状態が発生した場合に SQL_ERROR が返されます。</span><span class="sxs-lookup"><span data-stu-id="31b0b-103">When arrays of parameter values are bound for statement execution, `SQLRowCount` returns SQL_ERROR if any row of parameter values generates an error condition in statement execution.</span></span> <span data-ttu-id="31b0b-104">関数の*Rowcountptr*引数によって値が返されることはありません。</span><span class="sxs-lookup"><span data-stu-id="31b0b-104">No value is returned through the *RowCountPtr* argument of the function.</span></span>  
  
 <span data-ttu-id="31b0b-105">アプリケーションは、SQL_ATTR_PARAMS_PROCESSED_PTR ステートメント属性を使用して、エラーが発生するまでに処理されたパラメーター数をキャプチャできます。</span><span class="sxs-lookup"><span data-stu-id="31b0b-105">The application can take advantage of the SQL_ATTR_PARAMS_PROCESSED_PTR statement attribute to capture the number of parameters processed prior to the error occurring.</span></span>  
  
 <span data-ttu-id="31b0b-106">また、SQL_ATTR_PARAM_STATUS_PTR ステートメント属性を使用してバインドされた状態値の配列を使用して、問題のあるパラメーター行の配列オフセットをキャプチャできます。</span><span class="sxs-lookup"><span data-stu-id="31b0b-106">Further, the application can use an array of status values, bound by using the SQL_ATTR_PARAM_STATUS_PTR statement attribute, to capture the array offsets of offending parameter rows.</span></span> <span data-ttu-id="31b0b-107">アプリケーションは、状態配列をすべて確認し、実際に処理された行数を判断できます。</span><span class="sxs-lookup"><span data-stu-id="31b0b-107">The application can traverse the status array to determine the actual number of rows processed.</span></span>  
  
 <span data-ttu-id="31b0b-108">[!INCLUDE[tsql](../../includes/tsql-md.md)]Output 句を使用して INSERT、UPDATE、DELETE、または MERGE ステートメントを実行すると、SQLRowCount は、output 句によって生成された結果セット内のすべての行が使用されるまで、影響を受ける行の数を返しません。</span><span class="sxs-lookup"><span data-stu-id="31b0b-108">When a [!INCLUDE[tsql](../../includes/tsql-md.md)] INSERT, UPDATE, DELETE, or MERGE statement with an OUTPUT clause is executed, SQLRowCount will not return the count of rows affected until all the rows in the result set generated by the OUTPUT clause have been consumed.</span></span> <span data-ttu-id="31b0b-109">これらの行を使用するには、SQLFetch または SQLFetchScroll を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="31b0b-109">To sconsume these rows, you call SQLFetch or SQLFetchScroll.</span></span> <span data-ttu-id="31b0b-110">SQLResultCols は、すべての結果行が使用されるまで-1 を返します。</span><span class="sxs-lookup"><span data-stu-id="31b0b-110">SQLResultCols will return -1 until all result rows have been consumed.</span></span> <span data-ttu-id="31b0b-111">SQLFetch または SQLFetchScroll が SQL_NO_DATA を返すと、アプリケーションは SQLRowCount を呼び出して、次の結果に移動するために SQLMoreResults を呼び出す前に、影響を受けた行の数を確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="31b0b-111">After SQLFetch or SQLFetchScroll returns SQL_NO_DATA, the application must call SQLRowCount to determine the number of rows affected before calling SQLMoreResults to move to the next result.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="31b0b-112">参照</span><span class="sxs-lookup"><span data-stu-id="31b0b-112">See Also</span></span>  
 <span data-ttu-id="31b0b-113">[SQLRowCount 関数](https://go.microsoft.com/fwlink/?LinkId=59367) </span><span class="sxs-lookup"><span data-stu-id="31b0b-113">[SQLRowCount Function](https://go.microsoft.com/fwlink/?LinkId=59367) </span></span>  
 [<span data-ttu-id="31b0b-114">ODBC API 実装の詳細</span><span class="sxs-lookup"><span data-stu-id="31b0b-114">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
