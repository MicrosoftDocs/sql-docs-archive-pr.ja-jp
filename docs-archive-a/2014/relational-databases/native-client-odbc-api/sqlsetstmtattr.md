---
title: SQLSetStmtAttr |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87640925"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="0b73e-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="0b73e-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="0b73e-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC ドライバーは、混合 (キーセット/動的) カーソル モデルをサポートしません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="0b73e-104">SQL_ATTR_KEYSET_SIZE を使用してキーセットのサイズを設定する場合、0 以外の値を設定すると失敗します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="0b73e-105">このアプリケーションでは、 **sqlfetch**または[sqlfetchscroll](sqlfetchscroll.md)関数呼び出しで返される行の数を宣言するために、すべてのステートメントに SQL_ATTR_ROW_ARRAY_SIZE を設定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="0b73e-106">ドライバーは、サーバー カーソルを指定するステートメントで SQL_ATTR_ROW_ARRAY_SIZE を使用して、カーソルからのフェッチ要求を満たすためにサーバーが生成する行ブロックのサイズを判断します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="0b73e-107">トランザクションの分離レベルが、コミット済みのトランザクションの反復可能読み取りを保証できるレベルの場合、行のメンバーシップや順序が、動的カーソルのブロック サイズに収まる範囲内で固定されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="0b73e-108">カーソルは、この値で示されるブロック外では完全に動的になります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="0b73e-109">サーバー カーソルのブロック サイズは完全に動的で、フェッチ処理のどの時点でも変更可能です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="0b73e-110">SQLSetStmtAttr とテーブル値パラメーター</span><span class="sxs-lookup"><span data-stu-id="0b73e-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="0b73e-111">SQLSetStmtAttr を使用すると、テーブル値パラメーターの列の記述子フィールドにアクセスする前に、アプリケーションパラメーター記述子 (APD) で SQL_SOPT_SS_PARAM_FOCUS を設定できます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="0b73e-112">SQL_SOPT_SS_PARAM_FOCUS をテーブル値パラメーターではないパラメーターの序数に設定しようとした場合、SQLSetStmtAttr は SQL_ERROR を返し、"属性値が無効です" というメッセージで SQLSTATE = HY024 の診断レコードが作成されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="0b73e-113">SQL_SOPT_SS_PARAM_FOCUS は、SQL_ERROR が返されたときに変更されません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="0b73e-114">SQL_SOPT_SS_PARAM_FOCUS に 0 を設定すると、パラメーターの記述子レコードへのアクセスが復元されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="0b73e-115">SQLSetStmtAttr を使用して SQL_SOPT_SS_NAME_SCOPE を設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="0b73e-116">詳細については、このトピックの後半の「SQL_SOPT_SS_NAME_SCOPE」のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="0b73e-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="0b73e-117">詳細については、「準備された[ステートメントのテーブル値パラメーターのメタデータ](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0b73e-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="0b73e-118">テーブル値パラメーターの詳細については、「[テーブル値パラメーター &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0b73e-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="0b73e-119">SQLSetStmtAttr によるスパース列のサポート</span><span class="sxs-lookup"><span data-stu-id="0b73e-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="0b73e-120">SQLSetStmtAttr を使用して SQL_SOPT_SS_NAME_SCOPE を設定できます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="0b73e-121">詳細については、このトピックの「SQL_SOPT_SS_NAME_SCOPE」を参照してください。スパース列の詳細については、「[スパース列のサポート &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0b73e-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="0b73e-122">ステートメント属性</span><span class="sxs-lookup"><span data-stu-id="0b73e-122">Statement Attributes</span></span>  
 <span data-ttu-id="0b73e-123">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC ドライバーは、次のドライバー固有のステートメント属性もサポートします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="0b73e-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="0b73e-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="0b73e-125">カーソルでのドライバー固有のパフォーマンス オプションを使用するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="0b73e-126">これらのオプションが設定されている場合、 [SQLGetData](sqlgetdata.md)は許可されません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="0b73e-127">既定の設定は SQL_CO_OFF です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="0b73e-128">*Valueptr*値の型は SQLLEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="0b73e-129">*Valueptr*値</span><span class="sxs-lookup"><span data-stu-id="0b73e-129">*ValuePtr* value</span></span>|<span data-ttu-id="0b73e-130">説明</span><span class="sxs-lookup"><span data-stu-id="0b73e-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="0b73e-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="0b73e-131">SQL_CO_OFF</span></span>|<span data-ttu-id="0b73e-132">既定モード。</span><span class="sxs-lookup"><span data-stu-id="0b73e-132">Default.</span></span> <span data-ttu-id="0b73e-133">高速順方向専用、読み取り専用のカーソル、および autofetch を無効にして、前方参照専用の読み取り専用カーソルに対して**SQLGetData**を有効にします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="0b73e-134">SQL_SOPT_SS_CURSOR_OPTIONS を SQL_CO_OFF に設定すると、カーソルの種類は変更されません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="0b73e-135">つまり、高速順方向専用カーソルは高速順方向専用カーソルのままです。</span><span class="sxs-lookup"><span data-stu-id="0b73e-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="0b73e-136">カーソルの種類を変更するには、アプリケーションで/SQL_ATTR_CURSOR_TYPE を使用して別の種類のカーソルを設定する必要があり `SQLSetStmtAttr` ます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="0b73e-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="0b73e-137">SQL_CO_FFO</span></span>|<span data-ttu-id="0b73e-138">高速順方向専用の読み取り専用カーソルを有効にし、順方向専用、読み取り専用のカーソルでの**SQLGetData**を無効にします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="0b73e-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="0b73e-139">SQL_CO_AF</span></span>|<span data-ttu-id="0b73e-140">すべてのカーソルの種類で autofetch オプションを有効にします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="0b73e-141">このオプションがステートメントハンドルに対して設定されている場合、 **Sqlexecute**または**SQLExecDirect**は暗黙的な**sqlfetchscroll** (SQL_FIRST) を生成します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="0b73e-142">カーソルが開かれ、最初の行バッチが 1 回のラウンドトリップでサーバーに返されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="0b73e-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="0b73e-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="0b73e-144">autofetch オプションを設定して高速順方向専用カーソルを有効にします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="0b73e-145">これは、SQL_CO_AF と SQL_CO_FFO の両方を指定した場合と同じです。</span><span class="sxs-lookup"><span data-stu-id="0b73e-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="0b73e-146">これらのオプションを設定すると、サーバーは最後の行がフェッチされたことを検出した時点で、カーソルを自動的に閉じます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="0b73e-147">アプリケーションは依然として[SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) または[sqlcloを](sqlclosecursor.md)呼び出す必要がありますが、ドライバーは、サーバーに終了通知を送信する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="0b73e-148">Select リストに**text**、 **ntext**、または**image**列が含まれている場合、高速順方向専用カーソルは動的カーソルに変換され、 **SQLGetData**は許可されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="0b73e-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="0b73e-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="0b73e-150">SQL_SOPT_SS_DEFER_PREPARE 属性は、ステートメントを直ちに準備するか、 **Sqlexecute**、 [SQLDescribeCol](sqldescribecol.md) 、または[SQLDescribeParam](sqldescribeparam.md)が実行されるまで遅延させるかを決定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="0b73e-151">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 以前のバージョンでは、このプロパティは無視されます (準備は遅延されません)。</span><span class="sxs-lookup"><span data-stu-id="0b73e-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="0b73e-152">*Valueptr*値の型は SQLLEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="0b73e-153">*Valueptr*値</span><span class="sxs-lookup"><span data-stu-id="0b73e-153">*ValuePtr* value</span></span>|<span data-ttu-id="0b73e-154">説明</span><span class="sxs-lookup"><span data-stu-id="0b73e-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="0b73e-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="0b73e-155">SQL_DP_ON</span></span>|<span data-ttu-id="0b73e-156">既定モード。</span><span class="sxs-lookup"><span data-stu-id="0b73e-156">Default.</span></span> <span data-ttu-id="0b73e-157">[SQLPrepare 関数](https://go.microsoft.com/fwlink/?LinkId=59360)を呼び出した後、 **sqlexecute**が呼び出されるか、メタプロパティ操作 (**SQLDescribeCol**または**SQLDescribeParam**) が実行されるまで、ステートメントの準備は遅延されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="0b73e-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="0b73e-158">SQL_DP_OFF</span></span>|<span data-ttu-id="0b73e-159">**SQLPrepare**が実行されるとすぐに、ステートメントが準備されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="0b73e-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="0b73e-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="0b73e-161">ステートメント レベルのデータ変換を決定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="0b73e-162">この属性を設定すると、日付、時刻、通貨の値を文字列値に変換する際に、ドライバーはクライアントのロケール設定を使用します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="0b73e-163">この場合の変換は、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ネイティブ データ型から文字列への変換のみです。</span><span class="sxs-lookup"><span data-stu-id="0b73e-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="0b73e-164">*Valueptr*値の型は SQLLEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="0b73e-165">*Valueptr*値</span><span class="sxs-lookup"><span data-stu-id="0b73e-165">*ValuePtr* value</span></span>|<span data-ttu-id="0b73e-166">説明</span><span class="sxs-lookup"><span data-stu-id="0b73e-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="0b73e-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="0b73e-167">SQL_RE_OFF</span></span>|<span data-ttu-id="0b73e-168">既定モード。</span><span class="sxs-lookup"><span data-stu-id="0b73e-168">Default.</span></span> <span data-ttu-id="0b73e-169">ドライバーは、日付、時刻、通貨の値を文字列データに変換する際に、クライアントのロケール設定を使用しません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="0b73e-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="0b73e-170">SQL_RE_ON</span></span>|<span data-ttu-id="0b73e-171">ドライバーは、日付、時刻、通貨の値を文字列データに変換する際に、クライアントのロケール設定を使用します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="0b73e-172">地域別の変換の設定は、通貨、数値、日付、および時刻のデータ型に適用されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="0b73e-173">変換の設定は、通貨、数値、日付、または時刻の値を文字列に変換するときの出力変換にのみ適用されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0b73e-174">ステートメント オプション SQL_SOPT_SS_REGIONALIZE が有効な場合、ドライバーは現在のユーザーのロケール レジストリ設定を使用します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="0b73e-175">アプリケーションが**Setthreadlocale**を呼び出すなどして、現在のスレッドのロケールを設定している場合、ドライバーはそのロケールを優先しません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="0b73e-176">データ ソースの地域別の動作を変更すると、アプリケーション エラーが発生することがあります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="0b73e-177">日付文字列を解析し、ODBC の定義に従った形式の日付文字列を受け付けるアプリケーションは、地域別の動作の値を変更することによって、悪影響を受ける可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="0b73e-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="0b73e-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="0b73e-179">SQL_SOPT_SS_TEXTPTR_LOGGING 属性は、**テキスト**または**イメージ**データを含む列に対する操作のログ記録を切り替えます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="0b73e-180">*Valueptr*値の型は SQLLEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="0b73e-181">*Valueptr*値</span><span class="sxs-lookup"><span data-stu-id="0b73e-181">*ValuePtr* value</span></span>|<span data-ttu-id="0b73e-182">説明</span><span class="sxs-lookup"><span data-stu-id="0b73e-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="0b73e-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="0b73e-183">SQL_TL_OFF</span></span>|<span data-ttu-id="0b73e-184">**テキスト**および**イメージ**データに対して実行される操作のログ記録を無効にします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="0b73e-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="0b73e-185">SQL_TL_ON</span></span>|<span data-ttu-id="0b73e-186">既定モード。</span><span class="sxs-lookup"><span data-stu-id="0b73e-186">Default.</span></span> <span data-ttu-id="0b73e-187">**テキスト**および**イメージ**データに対して実行される操作のログ記録を有効にします。</span><span class="sxs-lookup"><span data-stu-id="0b73e-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="0b73e-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="0b73e-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="0b73e-189">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の SELECT FOR BROWSE ステートメントで非表示にされた列を結果セットに公開します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="0b73e-190">既定では、ドライバーはこのような列を公開しません。</span><span class="sxs-lookup"><span data-stu-id="0b73e-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="0b73e-191">*Valueptr*値の型は SQLLEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="0b73e-192">*Valueptr*値</span><span class="sxs-lookup"><span data-stu-id="0b73e-192">*ValuePtr* value</span></span>|<span data-ttu-id="0b73e-193">説明</span><span class="sxs-lookup"><span data-stu-id="0b73e-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="0b73e-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="0b73e-194">SQL_HC_OFF</span></span>|<span data-ttu-id="0b73e-195">既定モード。</span><span class="sxs-lookup"><span data-stu-id="0b73e-195">Default.</span></span> <span data-ttu-id="0b73e-196">FOR BROWSE 列が結果セットで非表示になります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="0b73e-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="0b73e-197">SQL_HC_ON</span></span>|<span data-ttu-id="0b73e-198">FOR BROWSE 列を公開します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="0b73e-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="0b73e-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="0b73e-200">クエリ通知要求のメッセージ テキストを返します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="0b73e-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="0b73e-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="0b73e-202">クエリ通知要求で使用するオプションを指定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="0b73e-203">オプションは、次に示すように、`name=value` 構文を使用した文字列で指定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="0b73e-204">アプリケーションがサービスを作成して、キューから通知を読み取る必要があります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="0b73e-205">クエリ通知オプションの構文を次に示します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="0b73e-206">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="0b73e-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="0b73e-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="0b73e-208">クエリ通知をアクティブのままにしておく秒数を指定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="0b73e-209">既定値は432000秒 (5 日) です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="0b73e-210">*Valueptr*値の型は SQLLEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="0b73e-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="0b73e-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="0b73e-212">SQL_SOPT_SS_PARAM_FOCUS 属性は、後続の SQLBindParameter、SQLGetDescField、SQLSetDescField、SQLGetDescRec、および SQLSetDescRec の呼び出しのフォーカスを指定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="0b73e-213">SQL_SOPT_SS_PARAM_FOCUS の型は SQLULEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="0b73e-214">既定値は 0 で、SQL ステートメントのパラメーター マーカーに対応するパラメーターが、上記の呼び出しで指定されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="0b73e-215">テーブル値パラメーターのパラメーター番号に設定すると、そのテーブル値パラメーターの列が上記の呼び出しで指定されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="0b73e-216">テーブル値パラメーターのパラメーター番号以外の値に設定すると、エラー IM020 ("パラメーターのフォーカスがテーブル値パラメーターを参照していません") が返されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="0b73e-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="0b73e-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="0b73e-218">SQL_SOPT_SS_NAME_SCOPE 属性は、後続のカタログ関数呼び出しの名前スコープを指定します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="0b73e-219">SQLColumns によって返される結果セットは、SQL_SOPT_SS_NAME_SCOPE の設定によって異なります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="0b73e-220">SQL_SOPT_SS_NAME_SCOPE の型は SQLULEN です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="0b73e-221">*Valueptr*値</span><span class="sxs-lookup"><span data-stu-id="0b73e-221">*ValuePtr* value</span></span>|<span data-ttu-id="0b73e-222">説明</span><span class="sxs-lookup"><span data-stu-id="0b73e-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="0b73e-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="0b73e-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="0b73e-224">既定モード。</span><span class="sxs-lookup"><span data-stu-id="0b73e-224">Default.</span></span><br /><br /> <span data-ttu-id="0b73e-225">テーブル値パラメーターを使用する場合は、実際のテーブルのメタデータが返される必要があることを示します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="0b73e-226">スパース列機能を使用する場合、SQLColumns は、スパースのメンバーでない列のみを返し `column_set` ます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="0b73e-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="0b73e-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="0b73e-228">アプリケーションが実際のテーブルではなくテーブル型のメタデータを必要としていること (テーブル型のメタデータが返される必要があること) を示します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="0b73e-229">その後、アプリケーションはテーブル値パラメーターの TYPE_NAME を*TableName*パラメーターとして渡します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="0b73e-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="0b73e-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="0b73e-231">スパース列機能を使用する場合、SQLColumns は、メンバーシップに関係なくすべての列を返し `column_set` ます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="0b73e-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="0b73e-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="0b73e-233">スパース列機能を使用する場合、SQLColumns は、スパースのメンバーである列のみを返し `column_set` ます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="0b73e-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="0b73e-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="0b73e-235">SQL_SS_NAME_SCOPE_TABLE と同等です。</span><span class="sxs-lookup"><span data-stu-id="0b73e-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="0b73e-236">SS_TYPE_CATALOG_NAME と SS_TYPE_SCHEMA_NAME は、 *CatalogName*パラメーターと*SchemaName*パラメーターでそれぞれ使用され、テーブル値パラメーターのカタログとスキーマを識別します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="0b73e-237">テーブル値パラメーターのメタデータの取得が完了すると、アプリケーションによって、SQL_SOPT_SS_NAME_SCOPE は既定値 SQL_SS_NAME_SCOPE_TABLE に設定し直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="0b73e-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="0b73e-238">SQL_SOPT_SS_NAME_SCOPE が SQL_SS_NAME_SCOPE_TABLE に設定されると、リンク サーバーへのクエリは失敗します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="0b73e-239">サーバーコンポーネントを含むカタログを使用した SQLColumns または Sqlprimarykey の呼び出しは失敗します。</span><span class="sxs-lookup"><span data-stu-id="0b73e-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="0b73e-240">SQL_SOPT_SS_NAME_SCOPE を無効な値に設定しようとすると、SQL_ERROR が返され、"属性の値が正しくありません" というメッセージを含む SQLSTATE HY024 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="0b73e-241">SQL_SOPT_SS_NAME_SCOPE に SQL_SS_NAME_SCOPE_TABLE 以外の値が指定されている場合に、SQLTables、Sqltables、SQLPrimaryKeys などのカタログ関数が呼び出されると、SQL_ERROR が返されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="0b73e-242">"関数のシーケンス エラーです (SQL_SOPT_SS_NAME_SCOPE が SQL_SS_NAME_SCOPE_TABLE に設定されていません)" というメッセージを含む SQLSTATE HY010 の診断レコードが生成されます。</span><span class="sxs-lookup"><span data-stu-id="0b73e-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0b73e-243">参照</span><span class="sxs-lookup"><span data-stu-id="0b73e-243">See Also</span></span>  
 <span data-ttu-id="0b73e-244">[SQLGetStmtAttr 関数](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="0b73e-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="0b73e-245">ODBC API 実装の詳細</span><span class="sxs-lookup"><span data-stu-id="0b73e-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
