---
title: SQLDescribeParam |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLDescribeParam function
ms.assetid: 396e74b1-5d08-46dc-b404-2ef2003e4689
author: rothja
ms.author: jroth
ms.openlocfilehash: 05e14ccb0fadb4f1cf05f965c79cf8c05c71f93a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87642756"
---
# <a name="sqldescribeparam"></a><span data-ttu-id="93f24-102">SQLDescribeParam</span><span class="sxs-lookup"><span data-stu-id="93f24-102">SQLDescribeParam</span></span>
  <span data-ttu-id="93f24-103">SQL ステートメントのパラメーターを記述するために、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT odbc ドライバーは、 [!INCLUDE[tsql](../../includes/tsql-md.md)] 準備された odbc ステートメントハンドルで SQLDescribeParam が呼び出されたときに、SELECT ステートメントを構築して実行します。</span><span class="sxs-lookup"><span data-stu-id="93f24-103">To describe the parameters of any SQL statement, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver builds and executes a [!INCLUDE[tsql](../../includes/tsql-md.md)] SELECT statement when SQLDescribeParam is called on a prepared ODBC statement handle.</span></span> <span data-ttu-id="93f24-104">この結果セットのメタデータにより、準備されたステートメント内のパラメーターの特性が決まります。</span><span class="sxs-lookup"><span data-stu-id="93f24-104">The metadata of the result set determines the characteristics of the parameters in the prepared statement.</span></span> <span data-ttu-id="93f24-105">SQLDescribeParam は、SQLExecute または SQLExecDirect が返す可能性のあるエラーコードを返すことができます。</span><span class="sxs-lookup"><span data-stu-id="93f24-105">SQLDescribeParam can return any error code that SQLExecute or SQLExecDirect might return.</span></span>  
  
 <span data-ttu-id="93f24-106">で始まるデータベースエンジンの機能強化により [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 、SQLDescribeParam は、予期される結果についてより正確な説明を取得できます。</span><span class="sxs-lookup"><span data-stu-id="93f24-106">Improvements in the database engine starting with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] allow SQLDescribeParam to obtain more accurate descriptions of the expected results.</span></span> <span data-ttu-id="93f24-107">これらのより正確な結果は、以前のバージョンので SQLDescribeParam によって返された値とは異なる場合があり [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="93f24-107">These more accurate results may differ from the values returned by SQLDescribeParam in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="93f24-108">詳細については、「[メタデータの検出](../native-client/features/metadata-discovery.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="93f24-108">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>  
  
 <span data-ttu-id="93f24-109">また [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 、 *parametersizeptr*は、 [ODBC 仕様](https://go.microsoft.com/fwlink/?LinkId=207044)で定義されている、対応するパラメーターマーカーの列または式のサイズ (文字数) の定義に合わせて値を返すようになりました。</span><span class="sxs-lookup"><span data-stu-id="93f24-109">Also new in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], *ParameterSizePtr* now returns a value that aligns with the definition for the size, in characters, of the column or expression of the corresponding parameter marker as defined in the [ODBC specification](https://go.microsoft.com/fwlink/?LinkId=207044).</span></span> <span data-ttu-id="93f24-110">以前のバージョンの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client では、 *Parametersizeptr*は、型のの対応する値、 `SQL_DESC_OCTET_LENGTH` または型の SQLBindParameter に指定された関係のない列サイズの値になる可能性があります。この値は無視する必要があり `SQL_INTEGER` ます (など)。</span><span class="sxs-lookup"><span data-stu-id="93f24-110">In previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, *ParameterSizePtr* could be the corresponding value of `SQL_DESC_OCTET_LENGTH` for the type, or an irrelevant column size value that was supplied to SQLBindParameter for a type, the value of which should be ignored (`SQL_INTEGER`, for example).</span></span>  
  
 <span data-ttu-id="93f24-111">ドライバーは、次の状況での SQLDescribeParam の呼び出しをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="93f24-111">The driver does not support calling SQLDescribeParam in the following situations:</span></span>  
  
-   <span data-ttu-id="93f24-112">SQLExecDirect の後に、 [!INCLUDE[tsql](../../includes/tsql-md.md)] from 句を含む UPDATE または DELETE ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="93f24-112">After SQLExecDirect for any [!INCLUDE[tsql](../../includes/tsql-md.md)] UPDATE or DELETE statements containing the FROM clause.</span></span>  
  
-   <span data-ttu-id="93f24-113">ODBC ステートメントまたは [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントが HAVING 句にパラメーターを含んでいる場合、または SUM 関数の結果と比較される場合。</span><span class="sxs-lookup"><span data-stu-id="93f24-113">For any ODBC or [!INCLUDE[tsql](../../includes/tsql-md.md)] statement containing a parameter in a HAVING clause, or compared to the result of a SUM function.</span></span>  
  
-   <span data-ttu-id="93f24-114">ODBC ステートメントまたは [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントがパラメーターを含んでいるサブクエリに依存している場合。</span><span class="sxs-lookup"><span data-stu-id="93f24-114">For any ODBC or [!INCLUDE[tsql](../../includes/tsql-md.md)] statement depending on a subquery containing parameters.</span></span>  
  
-   <span data-ttu-id="93f24-115">ODBC SQL ステートメントが、比較の両方の式、LIKE、定量化された述語内にパラメーター マーカーを含んでいる場合。</span><span class="sxs-lookup"><span data-stu-id="93f24-115">For ODBC SQL statements containing parameter markers in both expressions of a comparison, like, or quantified predicate.</span></span>  
  
-   <span data-ttu-id="93f24-116">クエリのいずれかのパラメーターが関数に対するパラメーターである場合。</span><span class="sxs-lookup"><span data-stu-id="93f24-116">For any queries where one of the parameters is a parameter to a function.</span></span>  
  
-   <span data-ttu-id="93f24-117">コマンドにコメント (/\* \* /) がある場合 [!INCLUDE[tsql](../../includes/tsql-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93f24-117">When there are comments (/\* \*/) in the [!INCLUDE[tsql](../../includes/tsql-md.md)] command.</span></span>  
  
 <span data-ttu-id="93f24-118">ステートメントのバッチを処理する場合 [!INCLUDE[tsql](../../includes/tsql-md.md)] 、ドライバーはバッチ内の最初のステートメントの後にあるステートメント内のパラメーターマーカーに対して SQLDescribeParam を呼び出すこともサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="93f24-118">When processing a batch of [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, the driver also does not support calling SQLDescribeParam for parameter markers in statements after the first statement in the batch.</span></span>  
  
 <span data-ttu-id="93f24-119">SQLDescribeParam では、準備されたストアドプロシージャのパラメーターを記述するときに、システムストアドプロシージャ[sp_sproc_columns](/sql/relational-databases/system-stored-procedures/sp-sproc-columns-transact-sql)を使用してパラメーターの特性を取得します。</span><span class="sxs-lookup"><span data-stu-id="93f24-119">When describing the parameters of prepared stored procedures, SQLDescribeParam uses the system stored procedure [sp_sproc_columns](/sql/relational-databases/system-stored-procedures/sp-sproc-columns-transact-sql) to retrieve parameter characteristics.</span></span> <span data-ttu-id="93f24-120">sp_sproc_columns は、現在のユーザーデータベース内のストアドプロシージャのデータをレポートできます。</span><span class="sxs-lookup"><span data-stu-id="93f24-120">sp_sproc_columns can report data for stored procedures within the current user database.</span></span> <span data-ttu-id="93f24-121">完全に修飾されたストアドプロシージャ名を準備すると、データベース間で SQLDescribeParam を実行できるようになります。</span><span class="sxs-lookup"><span data-stu-id="93f24-121">Preparing a fully qualified stored procedure name allows SQLDescribeParam to execute across databases.</span></span> <span data-ttu-id="93f24-122">たとえば、システムストアドプロシージャ[sp_who](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql)を準備し、任意のデータベースで次のように実行できます。</span><span class="sxs-lookup"><span data-stu-id="93f24-122">For example, the system stored procedure [sp_who](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql) can be prepared and executed in any database as:</span></span>  
  
```  
SQLPrepare(hstmt, "{call sp_who(?)}", SQL_NTS);  
```  
  
 <span data-ttu-id="93f24-123">準備が正常に完了した後に SQLDescribeParam を実行すると、データベースに接続しているときに空の行セットが返され `master` ます。</span><span class="sxs-lookup"><span data-stu-id="93f24-123">Executing SQLDescribeParam after successful preparation returns an empty row set when connected to any database but `master`.</span></span> <span data-ttu-id="93f24-124">次のように準備された同じ呼び出しは、現在のユーザーデータベースに関係なく SQLDescribeParam を成功させます。</span><span class="sxs-lookup"><span data-stu-id="93f24-124">The same call, prepared as follows, causes SQLDescribeParam to succeed regardless of the current user database:</span></span>  
  
```  
SQLPrepare(hstmt, "{call master..sp_who(?)}", SQL_NTS);  
```  
  
 <span data-ttu-id="93f24-125">大きな値のデータ型の場合、 *DataTypePtr*で返される値は SQL_VARCHAR、SQL_VARBINARY、または SQL_NVARCHAR です。</span><span class="sxs-lookup"><span data-stu-id="93f24-125">For large value data types, the value returned in *DataTypePtr* is SQL_VARCHAR, SQL_VARBINARY, or SQL_NVARCHAR.</span></span> <span data-ttu-id="93f24-126">大きな値のデータ型パラメーターのサイズが "無制限" であることを示すために、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC ドライバーは*Parametersizeptr*を0に設定します。</span><span class="sxs-lookup"><span data-stu-id="93f24-126">To indicate that the size of the large value data type parameter is "unlimited," the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver sets *ParameterSizePtr* to 0.</span></span> <span data-ttu-id="93f24-127">標準の `varchar` 型パラメーターでは実際のサイズ値が返されます。</span><span class="sxs-lookup"><span data-stu-id="93f24-127">Actual size values are returned for standard `varchar` parameters.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="93f24-128">パラメーターが SQL_VARCHAR、SQL_VARBINARY、SQL_WVARCHAR のいずれかのパラメーターの最大サイズに既にバインドされている場合は、"無制限" ではなく、バインドされたパラメーターのサイズが返されます。</span><span class="sxs-lookup"><span data-stu-id="93f24-128">If the parameter has already been bound with a maximum size for the SQL_VARCHAR, SQL_VARBINARY, or SQL_WVARCHAR parameters, the bound size of the parameter is returned, not "unlimited."</span></span>  
  
 <span data-ttu-id="93f24-129">サイズが "無制限" の入力パラメーターをバインドするには、実行時データを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="93f24-129">To bind an "unlimited" size input parameter, data-at-execution must be used.</span></span> <span data-ttu-id="93f24-130">"無制限" サイズの出力パラメーターをバインドすることはできません ( [SQLGetData](sqlgetdata.md)が結果セットに対して行うように、出力パラメーターからデータをストリーミングする方法はありません)。</span><span class="sxs-lookup"><span data-stu-id="93f24-130">It is not possible to bind an "unlimited" size output parameter (there is no method for streaming data from an output parameter, like [SQLGetData](sqlgetdata.md) does for result sets).</span></span>  
  
 <span data-ttu-id="93f24-131">出力パラメーターの場合は、バッファーをバインドする必要があります。値が大きすぎる場合はバッファーがいっぱいになり、SQL_SUCCESS_WITH_INFO メッセージが "文字列データの右側が切り捨てられました。" という警告と共に返されます。</span><span class="sxs-lookup"><span data-stu-id="93f24-131">For output parameters, a buffer must be bound and if the value is too large, the buffer is filled and a SQL_SUCCESS_WITH_INFO message and is returned along with the "string data; right truncation" warning.</span></span> <span data-ttu-id="93f24-132">その後、切り捨てられたデータが破棄されます。</span><span class="sxs-lookup"><span data-stu-id="93f24-132">The data that was truncated is then discarded.</span></span>  
  
## <a name="sqldescribeparam-and-table-valued-parameters"></a><span data-ttu-id="93f24-133">SQLDescribeParam とテーブル値パラメーター</span><span class="sxs-lookup"><span data-stu-id="93f24-133">SQLDescribeParam and Table-Valued Parameters</span></span>  
 <span data-ttu-id="93f24-134">アプリケーションでは、SQLDescribeParam を使用して、準備されたステートメントのテーブル値パラメーター情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="93f24-134">An application can retrieve table-valued parameter information for a prepared statement with SQLDescribeParam.</span></span> <span data-ttu-id="93f24-135">詳細については、「準備された[ステートメントのテーブル値パラメーターのメタデータ](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="93f24-135">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="93f24-136">一般的なテーブル値パラメーターの詳細については、「[テーブル値パラメーター &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="93f24-136">For more information about table-valued parameters in general, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqldescribeparam-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="93f24-137">SQLDescribeParam による機能強化された日付と時刻のサポート</span><span class="sxs-lookup"><span data-stu-id="93f24-137">SQLDescribeParam Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="93f24-138">日付型または時刻型に対して返される値を次に示します。</span><span class="sxs-lookup"><span data-stu-id="93f24-138">The values returned for date/time types are as follows:</span></span>  
  
||<span data-ttu-id="93f24-139">*DataTypePtr*</span><span class="sxs-lookup"><span data-stu-id="93f24-139">*DataTypePtr*</span></span>|<span data-ttu-id="93f24-140">*ParameterSizePtr*</span><span class="sxs-lookup"><span data-stu-id="93f24-140">*ParameterSizePtr*</span></span>|<span data-ttu-id="93f24-141">*DecimalDigitsPtr*</span><span class="sxs-lookup"><span data-stu-id="93f24-141">*DecimalDigitsPtr*</span></span>|  
|-|-------------------|------------------------|------------------------|  
|<span data-ttu-id="93f24-142">DATETIME</span><span class="sxs-lookup"><span data-stu-id="93f24-142">datetime</span></span>|<span data-ttu-id="93f24-143">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="93f24-143">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="93f24-144">23</span><span class="sxs-lookup"><span data-stu-id="93f24-144">23</span></span>|<span data-ttu-id="93f24-145">3</span><span class="sxs-lookup"><span data-stu-id="93f24-145">3</span></span>|  
|<span data-ttu-id="93f24-146">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="93f24-146">smalldatetime</span></span>|<span data-ttu-id="93f24-147">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="93f24-147">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="93f24-148">16</span><span class="sxs-lookup"><span data-stu-id="93f24-148">16</span></span>|<span data-ttu-id="93f24-149">0</span><span class="sxs-lookup"><span data-stu-id="93f24-149">0</span></span>|  
|<span data-ttu-id="93f24-150">date</span><span class="sxs-lookup"><span data-stu-id="93f24-150">date</span></span>|<span data-ttu-id="93f24-151">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="93f24-151">SQL_TYPE_DATE</span></span>|<span data-ttu-id="93f24-152">10</span><span class="sxs-lookup"><span data-stu-id="93f24-152">10</span></span>|<span data-ttu-id="93f24-153">0</span><span class="sxs-lookup"><span data-stu-id="93f24-153">0</span></span>|  
|<span data-ttu-id="93f24-154">time</span><span class="sxs-lookup"><span data-stu-id="93f24-154">time</span></span>|<span data-ttu-id="93f24-155">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="93f24-155">SQL_SS_TIME2</span></span>|<span data-ttu-id="93f24-156">8、10..16</span><span class="sxs-lookup"><span data-stu-id="93f24-156">8, 10..16</span></span>|<span data-ttu-id="93f24-157">0..7</span><span class="sxs-lookup"><span data-stu-id="93f24-157">0..7</span></span>|  
|<span data-ttu-id="93f24-158">datetime2</span><span class="sxs-lookup"><span data-stu-id="93f24-158">datetime2</span></span>|<span data-ttu-id="93f24-159">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="93f24-159">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="93f24-160">19、21..27</span><span class="sxs-lookup"><span data-stu-id="93f24-160">19, 21..27</span></span>|<span data-ttu-id="93f24-161">0..7</span><span class="sxs-lookup"><span data-stu-id="93f24-161">0..7</span></span>|  
|<span data-ttu-id="93f24-162">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="93f24-162">datetimeoffset</span></span>|<span data-ttu-id="93f24-163">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="93f24-163">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="93f24-164">26、28..34</span><span class="sxs-lookup"><span data-stu-id="93f24-164">26, 28..34</span></span>|<span data-ttu-id="93f24-165">0..7</span><span class="sxs-lookup"><span data-stu-id="93f24-165">0..7</span></span>|  
  
 <span data-ttu-id="93f24-166">詳細については、「[日付と時刻の機能強化 &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="93f24-166">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqldescribeparam-support-for-large-clr-udts"></a><span data-ttu-id="93f24-167">SQLDescribeParam による大きな CLR UDT のサポート</span><span class="sxs-lookup"><span data-stu-id="93f24-167">SQLDescribeParam Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="93f24-168">`SQLDescribeParam` は、大きな CLR ユーザー定義型 (UDT) をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="93f24-168">`SQLDescribeParam` supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="93f24-169">詳細については、「[大容量の CLR ユーザー定義型 &#40;ODBC&#41;](../../relational-databases/native-client/odbc/large-clr-user-defined-types-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="93f24-169">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../../relational-databases/native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="93f24-170">参照</span><span class="sxs-lookup"><span data-stu-id="93f24-170">See Also</span></span>  
 <span data-ttu-id="93f24-171">[SQLDescribeParam 関数](https://go.microsoft.com/fwlink/?LinkId=59339) </span><span class="sxs-lookup"><span data-stu-id="93f24-171">[SQLDescribeParam Function](https://go.microsoft.com/fwlink/?LinkId=59339) </span></span>  
 [<span data-ttu-id="93f24-172">ODBC API 実装の詳細</span><span class="sxs-lookup"><span data-stu-id="93f24-172">ODBC API Implementation Details</span></span>](../../relational-databases/native-client-odbc-api/odbc-api-implementation-details.md)  
  
  
