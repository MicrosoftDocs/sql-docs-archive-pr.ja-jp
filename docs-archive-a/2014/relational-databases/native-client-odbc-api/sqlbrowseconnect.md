---
title: SQLBrowseConnect |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLBrowseConnect function
ms.assetid: 57faf388-c7ca-4696-9845-34e0a10cc5f7
author: rothja
ms.author: jroth
ms.openlocfilehash: ca203e02195d72683744aa8dd31d41a81c260ab4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87742026"
---
# <a name="sqlbrowseconnect"></a><span data-ttu-id="e7d3e-102">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="e7d3e-102">SQLBrowseConnect</span></span>
  <span data-ttu-id="e7d3e-103">**SQLBrowseConnect**は、3つのレベルの接続情報に分類できるキーワードを使用します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-103">**SQLBrowseConnect** uses keywords that can be categorized into three levels of connection information.</span></span> <span data-ttu-id="e7d3e-104">次の表では、キーワードごとに、有効な値の一覧が返されるかどうか、およびそのキーワードが省略可能であるかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-104">For each keyword, the following table indicates whether a list of valid values is returned and whether the keyword is optional.</span></span>  
  
## <a name="level-1"></a><span data-ttu-id="e7d3e-105">[レベル 1]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-105">Level 1</span></span>  
  
|<span data-ttu-id="e7d3e-106">キーワード</span><span class="sxs-lookup"><span data-stu-id="e7d3e-106">Keyword</span></span>|<span data-ttu-id="e7d3e-107">一覧が返されるかどうか</span><span class="sxs-lookup"><span data-stu-id="e7d3e-107">List returned?</span></span>|<span data-ttu-id="e7d3e-108">省略できるかどうか</span><span class="sxs-lookup"><span data-stu-id="e7d3e-108">Optional?</span></span>|<span data-ttu-id="e7d3e-109">[説明]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-109">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="e7d3e-110">DSN (DSN)</span><span class="sxs-lookup"><span data-stu-id="e7d3e-110">DSN</span></span>|<span data-ttu-id="e7d3e-111">該当なし</span><span class="sxs-lookup"><span data-stu-id="e7d3e-111">N/A</span></span>|<span data-ttu-id="e7d3e-112">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-112">No</span></span>|<span data-ttu-id="e7d3e-113">**Sqldatasources**ソースによって返されるデータソースの名前。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-113">Name of the data source returned by **SQLDataSources**.</span></span> <span data-ttu-id="e7d3e-114">DSN キーワードは、DRIVER キーワードと同時に使用できません。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-114">The DSN keyword cannot be used if the DRIVER keyword is used.</span></span>|  
|<span data-ttu-id="e7d3e-115">DRIVER</span><span class="sxs-lookup"><span data-stu-id="e7d3e-115">DRIVER</span></span>|<span data-ttu-id="e7d3e-116">該当なし</span><span class="sxs-lookup"><span data-stu-id="e7d3e-116">N/A</span></span>|<span data-ttu-id="e7d3e-117">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-117">No</span></span>|<span data-ttu-id="e7d3e-118">Microsoft?</span><span class="sxs-lookup"><span data-stu-id="e7d3e-118">Microsoft??</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="e7d3e-119">Native Client ODBC ドライバー名は { [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native client 11} です。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-119">Native Client ODBC driver name is {[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 11}.</span></span> <span data-ttu-id="e7d3e-120">DRIVER キーワードは、DSN キーワードと同時に使用できません。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-120">The DRIVER keyword cannot be used if the DSN keyword is used.</span></span>|  
  
## <a name="level-2"></a><span data-ttu-id="e7d3e-121">[レベル 2]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-121">Level 2</span></span>  
  
|<span data-ttu-id="e7d3e-122">キーワード</span><span class="sxs-lookup"><span data-stu-id="e7d3e-122">Keyword</span></span>|<span data-ttu-id="e7d3e-123">一覧が返されるかどうか</span><span class="sxs-lookup"><span data-stu-id="e7d3e-123">List returned?</span></span>|<span data-ttu-id="e7d3e-124">省略できるかどうか</span><span class="sxs-lookup"><span data-stu-id="e7d3e-124">Optional?</span></span>|<span data-ttu-id="e7d3e-125">[説明]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-125">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="e7d3e-126">SERVER</span><span class="sxs-lookup"><span data-stu-id="e7d3e-126">SERVER</span></span>|<span data-ttu-id="e7d3e-127">はい</span><span class="sxs-lookup"><span data-stu-id="e7d3e-127">Yes</span></span>|<span data-ttu-id="e7d3e-128">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-128">No</span></span>|<span data-ttu-id="e7d3e-129">データ ソースがあるネットワーク上のサーバー名。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-129">Name of the server on the network on which the data source resides.</span></span> <span data-ttu-id="e7d3e-130">サーバー名には「(local)」と入力することもできます。これは、ネットワークに接続されていない [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のローカル コピーも使用できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-130">The term "(local)" can be entered as the server, in which case a local copy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be used, even when this is a non-networked version.</span></span>|  
|<span data-ttu-id="e7d3e-131">UID</span><span class="sxs-lookup"><span data-stu-id="e7d3e-131">UID</span></span>|<span data-ttu-id="e7d3e-132">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-132">No</span></span>|<span data-ttu-id="e7d3e-133">はい</span><span class="sxs-lookup"><span data-stu-id="e7d3e-133">Yes</span></span>|<span data-ttu-id="e7d3e-134">ユーザー ログイン ID。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-134">User login ID.</span></span>|  
|<span data-ttu-id="e7d3e-135">PWD</span><span class="sxs-lookup"><span data-stu-id="e7d3e-135">PWD</span></span>|<span data-ttu-id="e7d3e-136">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-136">No</span></span>|<span data-ttu-id="e7d3e-137">はい (ユーザーによって異なります)</span><span class="sxs-lookup"><span data-stu-id="e7d3e-137">Yes (depends on the user)</span></span>|<span data-ttu-id="e7d3e-138">ユーザーが指定したパスワード。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-138">User-specified password.</span></span>|  
|<span data-ttu-id="e7d3e-139">APP</span><span class="sxs-lookup"><span data-stu-id="e7d3e-139">APP</span></span>|<span data-ttu-id="e7d3e-140">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-140">No</span></span>|<span data-ttu-id="e7d3e-141">はい</span><span class="sxs-lookup"><span data-stu-id="e7d3e-141">Yes</span></span>|<span data-ttu-id="e7d3e-142">**SQLBrowseConnect**を呼び出すアプリケーションの名前。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-142">Name of the application calling **SQLBrowseConnect**.</span></span>|  
|<span data-ttu-id="e7d3e-143">WSID</span><span class="sxs-lookup"><span data-stu-id="e7d3e-143">WSID</span></span>|<span data-ttu-id="e7d3e-144">いいえ</span><span class="sxs-lookup"><span data-stu-id="e7d3e-144">No</span></span>|<span data-ttu-id="e7d3e-145">はい</span><span class="sxs-lookup"><span data-stu-id="e7d3e-145">Yes</span></span>|<span data-ttu-id="e7d3e-146">ワークステーション ID。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-146">Workstation ID.</span></span> <span data-ttu-id="e7d3e-147">通常は、アプリケーションが実行されているコンピューターのネットワーク名です。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-147">Typically, this is the network name of the computer on which the application runs.</span></span>|  
  
## <a name="level-3"></a><span data-ttu-id="e7d3e-148">レベル 3</span><span class="sxs-lookup"><span data-stu-id="e7d3e-148">Level 3</span></span>  
  
|<span data-ttu-id="e7d3e-149">キーワード</span><span class="sxs-lookup"><span data-stu-id="e7d3e-149">Keyword</span></span>|<span data-ttu-id="e7d3e-150">一覧が返されるかどうか</span><span class="sxs-lookup"><span data-stu-id="e7d3e-150">List returned?</span></span>|<span data-ttu-id="e7d3e-151">省略できるかどうか</span><span class="sxs-lookup"><span data-stu-id="e7d3e-151">Optional?</span></span>|<span data-ttu-id="e7d3e-152">[説明]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-152">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="e7d3e-153">DATABASE</span><span class="sxs-lookup"><span data-stu-id="e7d3e-153">DATABASE</span></span>|<span data-ttu-id="e7d3e-154">[はい]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-154">Yes</span></span>|<span data-ttu-id="e7d3e-155">[はい]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-155">Yes</span></span>|<span data-ttu-id="e7d3e-156">データベースの名前 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-156">Name of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span>|  
|<span data-ttu-id="e7d3e-157">LANGUAGE</span><span class="sxs-lookup"><span data-stu-id="e7d3e-157">LANGUAGE</span></span>|<span data-ttu-id="e7d3e-158">はい</span><span class="sxs-lookup"><span data-stu-id="e7d3e-158">Yes</span></span>|<span data-ttu-id="e7d3e-159">はい</span><span class="sxs-lookup"><span data-stu-id="e7d3e-159">Yes</span></span>|<span data-ttu-id="e7d3e-160">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] で使用される言語。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-160">National language used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
  
 <span data-ttu-id="e7d3e-161">**SQLBrowseConnect**は、ODBC データソースの定義に格納されているデータベースと言語キーワードの値を無視します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-161">**SQLBrowseConnect** ignores the values of the DATABASE and LANGUAGE keywords stored in the ODBC data source definitions.</span></span> <span data-ttu-id="e7d3e-162">**SQLBrowseConnect**に渡された接続文字列で指定されたデータベースまたは言語が無効である場合、 **SQLBrowseConnect**は SQL_NEED_DATA とレベル3の接続属性を返します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-162">If the database or language specified in the connection string passed to **SQLBrowseConnect** is invalid, **SQLBrowseConnect** returns SQL_NEED_DATA and the level 3 connection attributes.</span></span>  
  
 <span data-ttu-id="e7d3e-163">[SQLSetConnectAttr](sqlsetconnectattr.md)を呼び出すことによって設定される次の属性は、 **SQLBrowseConnect**によって返される結果セットを決定します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-163">The following attributes, which are set by calling [SQLSetConnectAttr](sqlsetconnectattr.md), determine the result set returned by **SQLBrowseConnect**.</span></span>  
  
|<span data-ttu-id="e7d3e-164">属性</span><span class="sxs-lookup"><span data-stu-id="e7d3e-164">Attribute</span></span>|<span data-ttu-id="e7d3e-165">[説明]</span><span class="sxs-lookup"><span data-stu-id="e7d3e-165">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="e7d3e-166">SQL_COPT_SS_BROWSE_CONNECT</span><span class="sxs-lookup"><span data-stu-id="e7d3e-166">SQL_COPT_SS_BROWSE_CONNECT</span></span>|<span data-ttu-id="e7d3e-167">SQL_MORE_INFO_YES に設定されている場合、 **SQLBrowseConnect**はサーバープロパティの拡張文字列を返します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-167">If it is set to SQL_MORE_INFO_YES, **SQLBrowseConnect** returns an extended string of server properties.</span></span><br /><br /> <span data-ttu-id="e7d3e-168">**SQLBrowseConnect**によって返される拡張文字列の例を次に示します: ServerName\InstanceName;Clustered: いいえ、バージョン: 8.00.131</span><span class="sxs-lookup"><span data-stu-id="e7d3e-168">The following is an example of an extended string returned by **SQLBrowseConnect**:ServerName\InstanceName;Clustered:No;Version:8.00.131</span></span><br /><br /> <span data-ttu-id="e7d3e-169">この文字列では、サーバーに関するさまざまな情報がセミコロンで区切られます。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-169">In this string, semi-colons separate various pieces of information about the server.</span></span> <span data-ttu-id="e7d3e-170">コンマは、異なるサーバー インスタンスを区切るために使用します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-170">Use commas to separate different server instances.</span></span>|  
|<span data-ttu-id="e7d3e-171">SQL_COPT_SS_BROWSE_SERVER</span><span class="sxs-lookup"><span data-stu-id="e7d3e-171">SQL_COPT_SS_BROWSE_SERVER</span></span>|<span data-ttu-id="e7d3e-172">サーバー名が指定されている場合、 **SQLBrowseConnect**は指定されたサーバーの情報を返します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-172">If a server name is specified, **SQLBrowseConnect** will return information for the server specified.</span></span> <span data-ttu-id="e7d3e-173">SQL_COPT_SS_BROWSE_SERVER が NULL に設定されている場合、 **SQLBrowseConnect**はドメイン内のすべてのサーバーに関する情報を返します。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-173">If SQL_COPT_SS_BROWSE_SERVER is set to NULL, **SQLBrowseConnect** returns information for all servers in the domain.</span></span><br /><br /> <span data-ttu-id="e7d3e-174">ネットワークの問題により、 **SQLBrowseConnect**は、すべてのサーバーからタイムリーな応答を受信できない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-174">Due to network issues, **SQLBrowseConnect** might not receive a timely response from all servers.</span></span> <span data-ttu-id="e7d3e-175">したがって、要求ごとに返されるサーバーの一覧が異なる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-175">Therefore, the list of servers returned can vary for each request.</span></span>|  
|<span data-ttu-id="e7d3e-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span><span class="sxs-lookup"><span data-stu-id="e7d3e-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span></span>|<span data-ttu-id="e7d3e-177">SQL_COPT_SS_BROWSE_CACHE_DATA 属性が SQL_CACHE_DATA_YES に設定されている場合は、バッファー長の不足が原因で結果を保持できないときにデータをチャンクでフェッチできます。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-177">When the SQL_COPT_SS_BROWSE_CACHE_DATA attribute is set to SQL_CACHE_DATA_YES, you can fetch data in chunks when the buffer length is not large enough to hold the result.</span></span> <span data-ttu-id="e7d3e-178">この長さは、SQLBrowseConnect の BufferLength 引数で指定されます。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-178">This length is specified in the BufferLength argument to SQLBrowseConnect.</span></span><br /><br /> <span data-ttu-id="e7d3e-179">バッファー長を超えるデータがあるときは SQL_NEED_DATA が返されます。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-179">SQL_NEED_DATA is returned when more data is available.</span></span> <span data-ttu-id="e7d3e-180">取得対象のデータがそれ以上ないときは SQL_SUCCESS が返されます。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-180">SQL_SUCCESS is returned when there is no more data to retrieve.</span></span><br /><br /> <span data-ttu-id="e7d3e-181">既定値は SQL_CACHE_DATA_NO です。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-181">The default is SQL_CACHE_DATA_NO.</span></span>|  
  
## <a name="sqlbrowseconnect-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="e7d3e-182">SQLBrowseConnect の HADR サポート</span><span class="sxs-lookup"><span data-stu-id="e7d3e-182">SQLBrowseConnect Support for High Availability, Disaster Recovery</span></span>  
 <span data-ttu-id="e7d3e-183">**SQLBrowseConnect**を使用してクラスターに接続する方法の詳細については、 [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] 「[高可用性、ディザスターリカバリーのサポートの SQL Server Native Client](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-183">For more information on using **SQLBrowseConnect** to connect to an [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] cluster, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
## <a name="sqlbrowseconnect-support-for-service-principal-names-spns"></a><span data-ttu-id="e7d3e-184">SQLBrowseConnect によるサービス プリンシパル名 (SPN) のサポート</span><span class="sxs-lookup"><span data-stu-id="e7d3e-184">SQLBrowseConnect Support for Service Principal Names (SPNs)</span></span>  
 <span data-ttu-id="e7d3e-185">接続が開いている場合、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client では、SQL_COPT_SS_MUTUALLY_AUTHENTICATED および SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD が、接続を開くときに使用された認証方式に設定されます。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-185">When a connection is opened, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client sets SQL_COPT_SS_MUTUALLY_AUTHENTICATED and SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD to the authentication method used to open the connection.</span></span>  
  
 <span data-ttu-id="e7d3e-186">Spn の詳細については、「[クライアント接続 &#40;ODBC&#41;のサービスプリンシパル名 &#40;spn&#41; ](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-186">For more information about SPNs, see [Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span></span>  
  
## <a name="change-history"></a><span data-ttu-id="e7d3e-187">変更履歴</span><span class="sxs-lookup"><span data-stu-id="e7d3e-187">Change History</span></span>  
  
|<span data-ttu-id="e7d3e-188">変更内容</span><span class="sxs-lookup"><span data-stu-id="e7d3e-188">Updated content</span></span>|  
|---------------------|  
|<span data-ttu-id="e7d3e-189">SQL_COPT_SS_BROWSE_CACHE_DATA に関する記述を追加しました。</span><span class="sxs-lookup"><span data-stu-id="e7d3e-189">Documented SQL_COPT_SS_BROWSE_CACHE_DATA.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e7d3e-190">参照</span><span class="sxs-lookup"><span data-stu-id="e7d3e-190">See Also</span></span>  
 <span data-ttu-id="e7d3e-191">[SQLBrowseConnect 関数](https://go.microsoft.com/fwlink/?LinkId=59329) </span><span class="sxs-lookup"><span data-stu-id="e7d3e-191">[SQLBrowseConnect Function](https://go.microsoft.com/fwlink/?LinkId=59329) </span></span>  
 [<span data-ttu-id="e7d3e-192">ODBC API 実装の詳細</span><span class="sxs-lookup"><span data-stu-id="e7d3e-192">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
