---
title: 決定的関数と非決定的関数 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- built-in functions [SQL Server]
- nondeterministic functions
- extended stored procedures [SQL Server], functions that call
- deterministic functions
- user-defined functions [SQL Server], deterministic
ms.assetid: 2f3ce5f5-c81c-4470-8141-8144d4f218dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 9e755532e06d64e273408c7e81936a1c2d370697
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87740781"
---
# <a name="deterministic-and-nondeterministic-functions"></a><span data-ttu-id="6ae8f-102">決定的関数と非決定的関数</span><span class="sxs-lookup"><span data-stu-id="6ae8f-102">Deterministic and Nondeterministic Functions</span></span>
  <span data-ttu-id="6ae8f-103">決定的関数は、一連の特定の入力値で呼び出され、かつデータベースの状態が同じ場合は、必ず同じ結果を返します。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-103">Deterministic functions always return the same result any time they are called with a specific set of input values and given the same state of the database.</span></span> <span data-ttu-id="6ae8f-104">非決定的関数は、アクセスするデータベースの状態が同じ場合でも、一連の特定の入力値で呼び出すたびに、異なる結果を返すことがあります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-104">Nondeterministic functions may return different results each time they are called with a specific set of input values even if the database state that they access remains the same.</span></span> <span data-ttu-id="6ae8f-105">たとえば、AVG 関数は、上記の制限を前提として常に同じ結果を返しますが、現在の datetime 値を返す GETDATE 関数によって返される結果は常に異なります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-105">For example, the function AVG always returns the same result given the qualifications stated above, but the GETDATE function, which returns the current datetime value, always returns a different result.</span></span>  
  
 <span data-ttu-id="6ae8f-106">ユーザー定義関数には、関数を呼び出す計算列のインデックスを使用するか、または関数を参照するインデックス付きビューを使用して、関数の結果にインデックスを作成する [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] の機能を決定する複数のプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-106">There are several properties of user-defined functions that determine the ability of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to index the results of the function, either through indexes on computed columns that call the function, or through indexed views that reference the function.</span></span> <span data-ttu-id="6ae8f-107">関数の決定性は、このようなプロパティの 1 つです。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-107">The determinism of a function is one such property.</span></span> <span data-ttu-id="6ae8f-108">たとえば、ビューがなんらかの非決定的関数を参照している場合、そのビューにはクラスター化インデックスを作成できません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-108">For example, a clustered index cannot be created on a view if the view references any nondeterministic functions.</span></span> <span data-ttu-id="6ae8f-109">関数の決定性など、関数のプロパティの詳細については、「 [ユーザー定義関数](user-defined-functions.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-109">For more information about the properties of functions, including determinism, see [User-Defined Functions](user-defined-functions.md).</span></span>  
  
 <span data-ttu-id="6ae8f-110">このトピックでは、組み込みのシステム関数の決定性について説明し、ユーザー定義関数の決定的なプロパティに拡張ストアド プロシージャへの呼び出しが含まれている場合のこのプロパティへの影響を確認します。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-110">This topic identifies the determinism of built-in system functions and the effect on the deterministic property of user-defined functions when it contains a call to extended stored procedures.</span></span>  
  
## <a name="built-in-function-determinism"></a><span data-ttu-id="6ae8f-111">組み込み関数の決定性</span><span class="sxs-lookup"><span data-stu-id="6ae8f-111">Built-in Function Determinism</span></span>  
 <span data-ttu-id="6ae8f-112">組み込み関数の決定性には、影響を与えることができません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-112">You cannot influence the determinism of any built-in function.</span></span> <span data-ttu-id="6ae8f-113">各組み込み関数が決定的であるか非決定的であるかは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]による関数の実装方法に基づきます。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-113">Each built-in function is deterministic or nondeterministic based on how the function is implemented by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6ae8f-114">たとえば、クエリに ORDER BY 句を指定しても、そのクエリで使用される関数の決定性は変更されません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-114">For example, specifying an ORDER BY clause in a query does not change the determinism of a function that used in that query.</span></span>  
  
 <span data-ttu-id="6ae8f-115">組み込みの文字列関数はすべて決定的です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-115">All of the string built-in functions are deterministic.</span></span> <span data-ttu-id="6ae8f-116">文字列関数の一覧については、「[文字列関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-116">For a list of these functions, see [String Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="6ae8f-117">文字列関数以外のカテゴリに属する次の組み込み関数は、常に決定的関数になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-117">The following built-in functions from categories of built-in functions other than string functions are always deterministic.</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="6ae8f-118">ABS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-118">ABS</span></span>|<span data-ttu-id="6ae8f-119">DATEDIFF</span><span class="sxs-lookup"><span data-stu-id="6ae8f-119">DATEDIFF</span></span>|<span data-ttu-id="6ae8f-120">POWER</span><span class="sxs-lookup"><span data-stu-id="6ae8f-120">POWER</span></span>|  
|<span data-ttu-id="6ae8f-121">ACOS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-121">ACOS</span></span>|<span data-ttu-id="6ae8f-122">DAY</span><span class="sxs-lookup"><span data-stu-id="6ae8f-122">DAY</span></span>|<span data-ttu-id="6ae8f-123">RADIANS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-123">RADIANS</span></span>|  
|<span data-ttu-id="6ae8f-124">ASIN</span><span class="sxs-lookup"><span data-stu-id="6ae8f-124">ASIN</span></span>|<span data-ttu-id="6ae8f-125">DEGREES</span><span class="sxs-lookup"><span data-stu-id="6ae8f-125">DEGREES</span></span>|<span data-ttu-id="6ae8f-126">ROUND</span><span class="sxs-lookup"><span data-stu-id="6ae8f-126">ROUND</span></span>|  
|<span data-ttu-id="6ae8f-127">ATAN</span><span class="sxs-lookup"><span data-stu-id="6ae8f-127">ATAN</span></span>|<span data-ttu-id="6ae8f-128">EXP</span><span class="sxs-lookup"><span data-stu-id="6ae8f-128">EXP</span></span>|<span data-ttu-id="6ae8f-129">SIGN</span><span class="sxs-lookup"><span data-stu-id="6ae8f-129">SIGN</span></span>|  
|<span data-ttu-id="6ae8f-130">ATN2</span><span class="sxs-lookup"><span data-stu-id="6ae8f-130">ATN2</span></span>|<span data-ttu-id="6ae8f-131">FLOOR</span><span class="sxs-lookup"><span data-stu-id="6ae8f-131">FLOOR</span></span>|<span data-ttu-id="6ae8f-132">SIN</span><span class="sxs-lookup"><span data-stu-id="6ae8f-132">SIN</span></span>|  
|<span data-ttu-id="6ae8f-133">CEILING</span><span class="sxs-lookup"><span data-stu-id="6ae8f-133">CEILING</span></span>|<span data-ttu-id="6ae8f-134">ISNULL</span><span class="sxs-lookup"><span data-stu-id="6ae8f-134">ISNULL</span></span>|<span data-ttu-id="6ae8f-135">SQUARE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-135">SQUARE</span></span>|  
|<span data-ttu-id="6ae8f-136">COALESCE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-136">COALESCE</span></span>|<span data-ttu-id="6ae8f-137">ISNUMERIC</span><span class="sxs-lookup"><span data-stu-id="6ae8f-137">ISNUMERIC</span></span>|<span data-ttu-id="6ae8f-138">SQRT</span><span class="sxs-lookup"><span data-stu-id="6ae8f-138">SQRT</span></span>|  
|<span data-ttu-id="6ae8f-139">COS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-139">COS</span></span>|<span data-ttu-id="6ae8f-140">LOG</span><span class="sxs-lookup"><span data-stu-id="6ae8f-140">LOG</span></span>|<span data-ttu-id="6ae8f-141">TAN</span><span class="sxs-lookup"><span data-stu-id="6ae8f-141">TAN</span></span>|  
|<span data-ttu-id="6ae8f-142">COT</span><span class="sxs-lookup"><span data-stu-id="6ae8f-142">COT</span></span>|<span data-ttu-id="6ae8f-143">LOG10</span><span class="sxs-lookup"><span data-stu-id="6ae8f-143">LOG10</span></span>|<span data-ttu-id="6ae8f-144">YEAR</span><span class="sxs-lookup"><span data-stu-id="6ae8f-144">YEAR</span></span>|  
|<span data-ttu-id="6ae8f-145">DATALENGTH</span><span class="sxs-lookup"><span data-stu-id="6ae8f-145">DATALENGTH</span></span>|<span data-ttu-id="6ae8f-146">MONTH</span><span class="sxs-lookup"><span data-stu-id="6ae8f-146">MONTH</span></span>||  
|<span data-ttu-id="6ae8f-147">[DATEADD]</span><span class="sxs-lookup"><span data-stu-id="6ae8f-147">DATEADD</span></span>|<span data-ttu-id="6ae8f-148">NULLIF</span><span class="sxs-lookup"><span data-stu-id="6ae8f-148">NULLIF</span></span>||  
  
 <span data-ttu-id="6ae8f-149">次の関数は必ず決定的関数になるとは限りませんが、決定的な方法で指定されている場合は、インデックス付きビューまたは計算列のインデックスで使用できます。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-149">The following functions are not always deterministic, but can be used in indexed views or indexes on computed columns when they are specified in a deterministic manner.</span></span>  
  
|<span data-ttu-id="6ae8f-150">機能</span><span class="sxs-lookup"><span data-stu-id="6ae8f-150">Function</span></span>|<span data-ttu-id="6ae8f-151">説明</span><span class="sxs-lookup"><span data-stu-id="6ae8f-151">Comments</span></span>|  
|--------------|--------------|  
|<span data-ttu-id="6ae8f-152">すべての集計関数</span><span class="sxs-lookup"><span data-stu-id="6ae8f-152">all aggregate functions</span></span>|<span data-ttu-id="6ae8f-153">OVER 句および ORDER BY 句で指定されていない限り、集計関数はすべて決定的です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-153">All aggregate functions are deterministic unless they are specified with the OVER and ORDER BY clauses.</span></span> <span data-ttu-id="6ae8f-154">集計関数の一覧については、「[集計関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-154">For a list of these functions, see [Aggregate Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql).</span></span>|  
|<span data-ttu-id="6ae8f-155">CAST</span><span class="sxs-lookup"><span data-stu-id="6ae8f-155">CAST</span></span>|<span data-ttu-id="6ae8f-156">`datetime` 型、`smalldatetime` 型、または `sql_variant` 型と併用しない場合は決定的関数になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-156">Deterministic unless used with `datetime`, `smalldatetime`, or `sql_variant`.</span></span>|  
|<span data-ttu-id="6ae8f-157">CONVERT</span><span class="sxs-lookup"><span data-stu-id="6ae8f-157">CONVERT</span></span>|<span data-ttu-id="6ae8f-158">以下の条件に該当しない場合は決定的関数になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-158">Deterministic unless one of these conditions exists:</span></span><br /><br /> <span data-ttu-id="6ae8f-159">変換元の型が `sql_variant` であること。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-159">Source type is `sql_variant`.</span></span><br /><br /> <span data-ttu-id="6ae8f-160">変換先の型が `sql_variant` であり、変換元の型が非決定的であること。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-160">Target type is `sql_variant` and its source type is nondeterministic.</span></span><br /><br /> <span data-ttu-id="6ae8f-161">変換元または変換先の型が `datetime` または `smalldatetime` であり、他の変換元または変換先の型が文字列で、非決定的スタイルが指定されていること。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-161">Source or target type is `datetime` or `smalldatetime`, the other source or target type is a character string, and a nondeterministic style is specified.</span></span> <span data-ttu-id="6ae8f-162">決定的にするには、スタイル パラメーターを定数にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-162">To be deterministic, the style parameter must be a constant.</span></span> <span data-ttu-id="6ae8f-163">また、スタイルが 20 および 21 以外で 100 以下の場合は非決定的です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-163">Additionally, styles less than or equal to 100 are nondeterministic, except for styles 20 and 21.</span></span> <span data-ttu-id="6ae8f-164">スタイルが 101 以上で、106、107、109、113 以外の場合は決定的です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-164">Styles greater than 100 are deterministic, except for styles 106, 107, 109 and 113.</span></span>|  
|<span data-ttu-id="6ae8f-165">CHECKSUM</span><span class="sxs-lookup"><span data-stu-id="6ae8f-165">CHECKSUM</span></span>|<span data-ttu-id="6ae8f-166">CHECKSUM(\*) を除き、決定的関数になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-166">Deterministic, with the exception of CHECKSUM(\*).</span></span>|  
|<span data-ttu-id="6ae8f-167">ISDATE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-167">ISDATE</span></span>|<span data-ttu-id="6ae8f-168">CONVERT 関数と共に使用され、CONVERT スタイル パラメーターが指定されており、スタイルが 0、100、9、または 109 と等しくない場合にのみ決定的関数になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-168">Deterministic only if used with the CONVERT function, the CONVERT style parameter is specified and style is not equal to 0, 100, 9, or 109.</span></span>|  
|<span data-ttu-id="6ae8f-169">RAND</span><span class="sxs-lookup"><span data-stu-id="6ae8f-169">RAND</span></span>|<span data-ttu-id="6ae8f-170">RAND は、 *seed* パラメーターが指定されている場合にのみ決定的です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-170">RAND is deterministic only when a *seed* parameter is specified.</span></span>|  
  
 <span data-ttu-id="6ae8f-171">構成、カーソル、メタデータ、セキュリティ、およびシステム統計関数はすべて、非決定的関数です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-171">All the configuration, cursor, metadata, security, and system statistical functions are nondeterministic.</span></span> <span data-ttu-id="6ae8f-172">これらの関数の一覧については、「[構成関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql)」、「[カーソル関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql)」、「[メタデータ関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql)」、「[セキュリティ関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql)」、「[システム統計関数 &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-172">For a list of these functions, see [Configuration Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql), [Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql), [Metadata Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql), [Security Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql), and [System Statistical Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="6ae8f-173">他のカテゴリに属する次の組み込み関数は、常に非決定的関数になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-173">The following built-in functions from other categories are always nondeterministic.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="6ae8f-174">@@CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-174">@@CONNECTIONS</span></span>|<span data-ttu-id="6ae8f-175">GETDATE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-175">GETDATE</span></span>|  
|<span data-ttu-id="6ae8f-176">@@CPU_BUSY</span><span class="sxs-lookup"><span data-stu-id="6ae8f-176">@@CPU_BUSY</span></span>|<span data-ttu-id="6ae8f-177">GETUTCDATE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-177">GETUTCDATE</span></span>|  
|<span data-ttu-id="6ae8f-178">@@DBTS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-178">@@DBTS</span></span>|<span data-ttu-id="6ae8f-179">GET_TRANSMISSION_STATUS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-179">GET_TRANSMISSION_STATUS</span></span>|  
|<span data-ttu-id="6ae8f-180">@@IDLE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-180">@@IDLE</span></span>|<span data-ttu-id="6ae8f-181">LAG</span><span class="sxs-lookup"><span data-stu-id="6ae8f-181">LAG</span></span>|  
|<span data-ttu-id="6ae8f-182">@@IO_BUSY</span><span class="sxs-lookup"><span data-stu-id="6ae8f-182">@@IO_BUSY</span></span>|<span data-ttu-id="6ae8f-183">LAST_VALUE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-183">LAST_VALUE</span></span>|  
|<span data-ttu-id="6ae8f-184">@@MAX_CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-184">@@MAX_CONNECTIONS</span></span>|<span data-ttu-id="6ae8f-185">LEAD</span><span class="sxs-lookup"><span data-stu-id="6ae8f-185">LEAD</span></span>|  
|<span data-ttu-id="6ae8f-186">@@PACK_RECEIVED</span><span class="sxs-lookup"><span data-stu-id="6ae8f-186">@@PACK_RECEIVED</span></span>|<span data-ttu-id="6ae8f-187">MIN_ACTIVE_ROWVERSION</span><span class="sxs-lookup"><span data-stu-id="6ae8f-187">MIN_ACTIVE_ROWVERSION</span></span>|  
|<span data-ttu-id="6ae8f-188">@@PACK_SENT</span><span class="sxs-lookup"><span data-stu-id="6ae8f-188">@@PACK_SENT</span></span>|<span data-ttu-id="6ae8f-189">NEWID</span><span class="sxs-lookup"><span data-stu-id="6ae8f-189">NEWID</span></span>|  
|<span data-ttu-id="6ae8f-190">@@PACKET_ERRORS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-190">@@PACKET_ERRORS</span></span>|<span data-ttu-id="6ae8f-191">NEWSEQUENTIALID</span><span class="sxs-lookup"><span data-stu-id="6ae8f-191">NEWSEQUENTIALID</span></span>|  
|<span data-ttu-id="6ae8f-192">@@TIMETICKS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-192">@@TIMETICKS</span></span>|<span data-ttu-id="6ae8f-193">NEXT VALUE FOR</span><span class="sxs-lookup"><span data-stu-id="6ae8f-193">NEXT VALUE FOR</span></span>|  
|<span data-ttu-id="6ae8f-194">@@TOTAL_ERRORS</span><span class="sxs-lookup"><span data-stu-id="6ae8f-194">@@TOTAL_ERRORS</span></span>|<span data-ttu-id="6ae8f-195">NTILE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-195">NTILE</span></span>|  
|<span data-ttu-id="6ae8f-196">@@TOTAL_READ</span><span class="sxs-lookup"><span data-stu-id="6ae8f-196">@@TOTAL_READ</span></span>|<span data-ttu-id="6ae8f-197">PARSENAME</span><span class="sxs-lookup"><span data-stu-id="6ae8f-197">PARSENAME</span></span>|  
|<span data-ttu-id="6ae8f-198">@@TOTAL_WRITE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-198">@@TOTAL_WRITE</span></span>|<span data-ttu-id="6ae8f-199">PERCENTILE_CONT</span><span class="sxs-lookup"><span data-stu-id="6ae8f-199">PERCENTILE_CONT</span></span>|  
|<span data-ttu-id="6ae8f-200">CUME_DIST</span><span class="sxs-lookup"><span data-stu-id="6ae8f-200">CUME_DIST</span></span>|<span data-ttu-id="6ae8f-201">PERCENTILE_DISC</span><span class="sxs-lookup"><span data-stu-id="6ae8f-201">PERCENTILE_DISC</span></span>|  
|<span data-ttu-id="6ae8f-202">CURRENT_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="6ae8f-202">CURRENT_TIMESTAMP</span></span>|<span data-ttu-id="6ae8f-203">PERCENT_RANK</span><span class="sxs-lookup"><span data-stu-id="6ae8f-203">PERCENT_RANK</span></span>|  
|<span data-ttu-id="6ae8f-204">DENSE_RANK</span><span class="sxs-lookup"><span data-stu-id="6ae8f-204">DENSE_RANK</span></span>|<span data-ttu-id="6ae8f-205">RAND</span><span class="sxs-lookup"><span data-stu-id="6ae8f-205">RAND</span></span>|  
|<span data-ttu-id="6ae8f-206">FIRST_VALUE</span><span class="sxs-lookup"><span data-stu-id="6ae8f-206">FIRST_VALUE</span></span>|<span data-ttu-id="6ae8f-207">RANK</span><span class="sxs-lookup"><span data-stu-id="6ae8f-207">RANK</span></span>|  
||<span data-ttu-id="6ae8f-208">ROW_NUMBER</span><span class="sxs-lookup"><span data-stu-id="6ae8f-208">ROW_NUMBER</span></span>|  
||<span data-ttu-id="6ae8f-209">TEXTPTR</span><span class="sxs-lookup"><span data-stu-id="6ae8f-209">TEXTPTR</span></span>|  
  
## <a name="calling-extended-stored-procedures-from-functions"></a><span data-ttu-id="6ae8f-210">関数からの拡張ストアド プロシージャ呼び出し</span><span class="sxs-lookup"><span data-stu-id="6ae8f-210">Calling Extended Stored Procedures from Functions</span></span>  
 <span data-ttu-id="6ae8f-211">拡張ストアド プロシージャはデータベースに副作用を及ぼす可能性があるため、拡張ストアド プロシージャを呼び出す関数は非決定的関数です。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-211">Functions that call extended stored procedures are nondeterministic, because the extended stored procedures can cause side effects on the database.</span></span> <span data-ttu-id="6ae8f-212">副作用とはデータベースのグローバル状態の変更を指し、たとえば、テーブルの更新や、ファイルやネットワークなどの外部リソースの更新 (ファイルの変更、電子メール メッセージの送信) などが挙げられます。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-212">Side effects are changes to a global state of the database, such as an update to a table, or to an external resource, such as a file or the network; for example, modifying a file or sending an e-mail message.</span></span> <span data-ttu-id="6ae8f-213">ユーザー定義関数から拡張ストアド プロシージャを実行した場合は、一貫性のある結果セットが返される保証はありません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-213">You should not rely on returning a consistent result set when executing an extended stored procedure from a user-defined function.</span></span> <span data-ttu-id="6ae8f-214">データベースに副作用を与えるユーザー定義関数の使用はお勧めしません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-214">User-defined functions that create side effects on the database are not recommended.</span></span>  
  
 <span data-ttu-id="6ae8f-215">拡張ストアド プロシージャは、関数の中から呼び出されると、クライアントに結果セットを返すことができません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-215">When called from inside a function, the extended stored procedure cannot return result sets to the client.</span></span> <span data-ttu-id="6ae8f-216">クライアントに結果セットを返すすべてのオープン データ サービス API のリターン コードは、FAIL になります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-216">Any Open Data Services API that returns result sets to the client will have a return code of FAIL.</span></span>  
  
 <span data-ttu-id="6ae8f-217">拡張ストアド プロシージャは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]に接続し直すことができますが、</span><span class="sxs-lookup"><span data-stu-id="6ae8f-217">The extended stored procedure can connect back to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6ae8f-218">その拡張ストアド プロシージャを呼び出した元の関数と同じトランザクションに参加することはできません。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-218">However, the procedure cannot join the same transaction as the original function that invoked the extended stored procedure.</span></span>  
  
 <span data-ttu-id="6ae8f-219">拡張ストアド プロシージャは、バッチまたはストアド プロシージャから呼び出された場合と同様に、 [!INCLUDE[msCoName](../../includes/msconame-md.md)] を実行している [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Windows セキュリティ アカウントのコンテキストで実行されます。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-219">Similar to invocations from a batch or stored procedure, the extended stored procedure is executed in the context of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows security account under which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running.</span></span> <span data-ttu-id="6ae8f-220">拡張ストアド プロシージャの所有者は、プロシージャを実行する権限を他のユーザーに許可するときに、このことを考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6ae8f-220">The owner of the extended stored procedure should consider this when granting permissions to other users to execute the procedure.</span></span>  
  
  
