---
title: メモリ最適化テーブルを使用するための要件 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: 47d9a7e8-c597-4b95-a58a-dcf66df8e572
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: ecb9d388fd0e1362bb8844e874cd89162912e93e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739972"
---
# <a name="requirements-for-using-memory-optimized-tables"></a><span data-ttu-id="12eb8-102">メモリ最適化テーブルを使用するための要件</span><span class="sxs-lookup"><span data-stu-id="12eb8-102">Requirements for Using Memory-Optimized Tables</span></span>
  <span data-ttu-id="12eb8-103">[SQL Server 2014 をインストールするためのハードウェアとソフトウェアの要件](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md)に加えて、インメモリ OLTP を使用するための要件を次に示します。</span><span class="sxs-lookup"><span data-stu-id="12eb8-103">In addition to the [Hardware and Software Requirements for Installing SQL Server 2014](../../sql-server/install/hardware-and-software-requirements-for-installing-sql-server.md), the following are requirements to use In-Memory OLTP:</span></span>  
  
-   <span data-ttu-id="12eb8-104">[!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]の 64 ビット Enterprise Edition、Developer Edition、または Evaluation Edition。</span><span class="sxs-lookup"><span data-stu-id="12eb8-104">64-bit Enterprise, Developer, or Evaluation edition of [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="12eb8-105">には、メモリ最適化テーブルおよびインデックスでデータを保持するために十分なメモリが必要です。</span><span class="sxs-lookup"><span data-stu-id="12eb8-105">needs enough memory to hold the data in memory-optimized tables and indexes.</span></span> <span data-ttu-id="12eb8-106">行バージョンも保持するためには、メモリ最適化テーブルおよびインデックスの予想サイズの 2 倍となるメモリ量を用意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-106">To account for row versions, you should provide an amount of memory that is two times the expected size of memory-optimized tables and indexes.</span></span> <span data-ttu-id="12eb8-107">ただし、必要なメモリの実際の容量はワークロードによって異なります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-107">But the actual amount of memory needed will depend on your workload.</span></span> <span data-ttu-id="12eb8-108">メモリの使用量を監視し、必要に応じて調整を加える必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-108">You should monitor your memory usage and make adjustments as needed.</span></span> <span data-ttu-id="12eb8-109">メモリ最適化テーブル データのサイズは、プールの容量のうち、許可されたパーセンテージを超えないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-109">The size of data in memory-optimized tables must not exceed the allowed percentage of the pool.</span></span> <span data-ttu-id="12eb8-110">メモリ最適化テーブルのサイズを調べるには、「 [sys. dm_db_xtp_table_memory_stats &#40;transact-sql&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-xtp-table-memory-stats-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-110">To discover the size of a memory-optimized table, see [sys.dm_db_xtp_table_memory_stats &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-xtp-table-memory-stats-transact-sql).</span></span>  
  
     <span data-ttu-id="12eb8-111">データベースにディスク ベース テーブルがある場合、それらのテーブルのバッファー プールとクエリ処理に十分なメモリを提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-111">If you have disk-based tables in the database, you need to provide enough memory for the buffer pool and query processing on those tables.</span></span>  
  
     <span data-ttu-id="12eb8-112">インメモリ OLTP アプリケーションで必要になるメモリの量を把握しておくことが重要です。</span><span class="sxs-lookup"><span data-stu-id="12eb8-112">It is important to know how much memory your In-Memory OLTP application will require.</span></span> <span data-ttu-id="12eb8-113">詳細については、「 [メモリ最適化テーブルのメモリ必要量の推定](memory-optimized-tables.md) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-113">See [Estimate Memory Requirements for Memory-Optimized Tables](memory-optimized-tables.md) for more information.</span></span>  
  
-   <span data-ttu-id="12eb8-114">持続性メモリ最適化テーブルの 2 倍のサイズの空きディスク領域。</span><span class="sxs-lookup"><span data-stu-id="12eb8-114">Free disk space for that is two times the size of your durable memory-optimized tables.</span></span>  
  
-   <span data-ttu-id="12eb8-115">インメモリ OLTP を使用するための **cmpxchg16b** 命令をサポートするプロセッサ。</span><span class="sxs-lookup"><span data-stu-id="12eb8-115">A processor needs to support the instruction **cmpxchg16b** to use In-Memory OLTP.</span></span> <span data-ttu-id="12eb8-116">最新のすべての 64 ビット プロセッサでは **cmpxchg16b**がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="12eb8-116">All modern 64-bit processors support **cmpxchg16b**.</span></span>  
  
     <span data-ttu-id="12eb8-117">VM ホスト アプリケーションを使用していて、古いプロセッサが原因のエラーが [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] によって表示される場合は、アプリケーションに **cmpxchg16b**を許可する構成オプションがあるかどうかをご確認ください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-117">If you are using a VM host application and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] displays an error caused by an older processor, see if the application has a configuration option to allow **cmpxchg16b**.</span></span> <span data-ttu-id="12eb8-118">該当する構成オプションがない場合は、Hyper-V を使用できます。Hyper-V では、構成オプションを変更することなく **cmpxchg16b** がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="12eb8-118">If not, you could use Hyper-V, which supports **cmpxchg16b** without needing to modify a configuration option.</span></span>  
  
-   <span data-ttu-id="12eb8-119">インメモリ OLTP をインストールするには、 **のインストール時に** [データベース エンジン サービス] [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]を選択します。</span><span class="sxs-lookup"><span data-stu-id="12eb8-119">To install In-Memory OLTP, select **Database Engine Services** when you install [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>  
  
     <span data-ttu-id="12eb8-120">レポートの生成 ([テーブルまたはストアドプロシージャをインメモリ oltp に移植する必要が](determining-if-a-table-or-stored-procedure-should-be-ported-to-in-memory-oltp.md)あるかどうかの判断) と [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] (オブジェクトエクスプローラーを介してインメモリ oltp を管理する場合) をインストールするに [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] は、をインストールするときに [**管理ツール-基本**] または [**管理ツール-詳細**] を選択し [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="12eb8-120">To install report generation ([Determining if a Table or Stored Procedure Should Be Ported to In-Memory OLTP](determining-if-a-table-or-stored-procedure-should-be-ported-to-in-memory-oltp.md)) and [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] (to manage In-Memory OLTP via [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] Object Explorer), select **Management Tools-Basic** or **Management Tools-Advanced** when you install [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span>  
  
## <a name="important-notes-on-using-hek_2"></a><span data-ttu-id="12eb8-121">[!INCLUDE[hek_2](../../../includes/hek-2-md.md)]</span><span class="sxs-lookup"><span data-stu-id="12eb8-121">Important Notes on Using [!INCLUDE[hek_2](../../../includes/hek-2-md.md)]</span></span>  
  
-   <span data-ttu-id="12eb8-122">データベース内の持続性のあるすべてのテーブルのメモリ内サイズの合計は 250 GB を超えないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-122">The total in-memory size of all durable tables in a database should not exceed 250 GB.</span></span> <span data-ttu-id="12eb8-123">詳細については、「[メモリ最適化テーブルの持続性](durability-for-memory-optimized-tables.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-123">For more information, see [Durability for Memory-Optimized Tables](durability-for-memory-optimized-tables.md).</span></span>  
  
-   <span data-ttu-id="12eb8-124">このリリースの [!INCLUDE[hek_2](../../../includes/hek-2-md.md)] は、2 または 4 ソケットおよび 60 未満のコアを備えたシステムで適切に機能するように設定されています。</span><span class="sxs-lookup"><span data-stu-id="12eb8-124">This release of [!INCLUDE[hek_2](../../../includes/hek-2-md.md)] is targeted to perform optimally on systems with 2 or 4 sockets and fewer than 60 cores.</span></span>  
  
-   <span data-ttu-id="12eb8-125">チェックポイント ファイルは手動で削除しないでください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-125">Checkpoint files must not be manually deleted.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="12eb8-126">によって自動的に不要なチェックポイント ファイルのガベージ コレクションを実行します。</span><span class="sxs-lookup"><span data-stu-id="12eb8-126">automatically performs garbage collection on unneeded checkpoint files.</span></span> <span data-ttu-id="12eb8-127">詳細については、「[メモリ最適化テーブルの持続性](durability-for-memory-optimized-tables.md)」のデータファイルとデルタファイルのマージに関する説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-127">For more information, see the discussion on merging data and delta files in [Durability for Memory-Optimized Tables](durability-for-memory-optimized-tables.md).</span></span>  
  
-   <span data-ttu-id="12eb8-128">インメモリ OLTP の最初のリリースであるこのリリース ( [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]) で、メモリ最適化ファイル グループを削除する唯一の方法は、データベースを削除することです。</span><span class="sxs-lookup"><span data-stu-id="12eb8-128">In this first release of In-Memory OLTP (in [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]), the only way to remove a memory-optimized filegroup is to drop the database.</span></span>  
  
-   <span data-ttu-id="12eb8-129">多数の行を一括処理で削除しようとした場合に、削除対象の行範囲に影響する同時実行の挿入または更新ワークロードが存在すると、削除は失敗する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-129">If you attempt to delete a large batch of rows while there is a concurrent insert or update workload affecting the range of rows you are trying to delete, the delete will likely fail.</span></span> <span data-ttu-id="12eb8-130">回避策は、削除を行う前に挿入または更新ワークロードを停止することです。</span><span class="sxs-lookup"><span data-stu-id="12eb8-130">The workaround is to stop the insert or update workload before doing the delete.</span></span> <span data-ttu-id="12eb8-131">また、トランザクションを分割し、同時実行ワークロードによって妨害されにくい小さなトランザクションに構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="12eb8-131">Alternatively, you could configure the transaction into smaller transactions, which would be less likely to be disrupted by a concurrent workload.</span></span> <span data-ttu-id="12eb8-132">メモリ最適化テーブルに対するすべての書き込み操作と同様に、再試行ロジックを使用します (「[Guidelines for Retry Logic for Transactions on Memory-Optimized Tables](../../database-engine/guidelines-for-retry-logic-for-transactions-on-memory-optimized-tables.md)」をご覧ください)。</span><span class="sxs-lookup"><span data-stu-id="12eb8-132">As with all write operations on memory-optimized tables, use retry logic ([Guidelines for Retry Logic for Transactions on Memory-Optimized Tables](../../database-engine/guidelines-for-retry-logic-for-transactions-on-memory-optimized-tables.md)).</span></span>  
  
-   <span data-ttu-id="12eb8-133">メモリ最適化テーブルが含まれるデータベースを 1 つ以上作成する場合は、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスに対してファイルの瞬時初期化を有効にする ( [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のサービス開始アカウントに SE_MANAGE_VOLUME_NAME ユーザー権限を付与する) 必要があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-133">If you create one or more databases with memory-optimized tables, you should enable Instant File Initialization (grant the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service startup account the SE_MANAGE_VOLUME_NAME user right) for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="12eb8-134">ファイルの瞬時初期化を使用しない場合、メモリ最適化ストレージ ファイル (データ ファイルとデルタ ファイル) が作成時に初期化されるため、ワークロードのパフォーマンスが低下する場合があります。</span><span class="sxs-lookup"><span data-stu-id="12eb8-134">Without Instant File Initialization, memory-optimized storage files (data and delta files) will be initialized upon creation, which can have negative impact on the performance of your workload.</span></span> <span data-ttu-id="12eb8-135">ファイルの瞬時初期化に関する詳細については、「 [データベース ファイルの初期化](../databases/database-instant-file-initialization.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-135">For more information about Instant File Initialization, see [Database File Initialization](../databases/database-instant-file-initialization.md).</span></span> <span data-ttu-id="12eb8-136">ファイルの瞬時初期化を有効にする方法については、「 [How and Why to Enable Instant File Initialization (ファイルの瞬時初期化を有効にする方法と理由)](https://blogs.msdn.com/b/sql_pfe_blog/archive/2009/12/23/how-and-why-to-enable-instant-file-initialization.aspx)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="12eb8-136">For information on how to enable Instant File Initialization, see [How and Why to Enable Instant File Initialization](https://blogs.msdn.com/b/sql_pfe_blog/archive/2009/12/23/how-and-why-to-enable-instant-file-initialization.aspx).</span></span>  
  
## <a name="did-this-article-help-you-were-listening"></a><span data-ttu-id="12eb8-137">この記事は役に立ちましたか?</span><span class="sxs-lookup"><span data-stu-id="12eb8-137">Did this Article Help You?</span></span> <span data-ttu-id="12eb8-138">お待ちしています</span><span class="sxs-lookup"><span data-stu-id="12eb8-138">We're Listening</span></span>  
 <span data-ttu-id="12eb8-139">どのような情報をお探しでしたか? お探しの情報は見つかりましたか?</span><span class="sxs-lookup"><span data-stu-id="12eb8-139">What information are you looking for, and did you find it?</span></span> <span data-ttu-id="12eb8-140">コンテンツを改善するためのフィードバックをお待ちしています。</span><span class="sxs-lookup"><span data-stu-id="12eb8-140">We're listening to your feedback to improve the content.</span></span> <span data-ttu-id="12eb8-141">にコメントを送信してください [sqlfeedback@microsoft.com](mailto:sqlfeedback@microsoft.com?subject=Your%20feedback%20about%20the%20Requirements%20for%20Using%20Memory-Optimized%20Tables%20page) 。</span><span class="sxs-lookup"><span data-stu-id="12eb8-141">Please submit your comments to [sqlfeedback@microsoft.com](mailto:sqlfeedback@microsoft.com?subject=Your%20feedback%20about%20the%20Requirements%20for%20Using%20Memory-Optimized%20Tables%20page).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="12eb8-142">参照</span><span class="sxs-lookup"><span data-stu-id="12eb8-142">See Also</span></span>  
 [<span data-ttu-id="12eb8-143">インメモリ OLTP &#40;インメモリ最適化&#41;</span><span class="sxs-lookup"><span data-stu-id="12eb8-143">In-Memory OLTP &#40;In-Memory Optimization&#41;</span></span>](in-memory-oltp-in-memory-optimization.md)  
  
  
