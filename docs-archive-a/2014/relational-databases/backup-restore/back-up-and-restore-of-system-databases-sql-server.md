---
title: システム データベースのバックアップと復元 (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- system databases [SQL Server], backing up and restoring
- restoring system databases [SQL Server]
- backing up [SQL Server], system databases
- database backups [SQL Server], system databases
- servers [SQL Server], backup
ms.assetid: aef0c4fa-ba67-413d-9359-1a67682fdaab
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 51ccf1aeadcf4ab9a662cdd629a812d3ee4b82aa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87645697"
---
# <a name="back-up-and-restore-of-system-databases-sql-server"></a><span data-ttu-id="187bb-102">システム データベースのバックアップと復元 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="187bb-102">Back Up and Restore of System Databases (SQL Server)</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="187bb-103">では、システムレベルのデータベースのセットである*システム データベース*が管理されています。これらのデータベースは、サーバー インスタンスの運用に不可欠です。</span><span class="sxs-lookup"><span data-stu-id="187bb-103">maintains a set of system-level databases, s*ystem databases*, which are essential for the operation of a server instance.</span></span> <span data-ttu-id="187bb-104">いくつかのシステム データベースは、重大な更新が行われるたびにバックアップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-104">Several of the system databases must be backed up after every significant update.</span></span> <span data-ttu-id="187bb-105">常にバックアップする必要があるシステム データベースには、 **msdb**、 **master**、および **model**があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-105">The system databases that you must always back up include **msdb**, **master**, and **model**.</span></span> <span data-ttu-id="187bb-106">サーバー インスタンス上のいずれかのデータベースでレプリケーションが使用されている場合は、 **distribution** システム データベースもバックアップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-106">If any database uses replication on the server instance, there is a **distribution** system database that you must also back up.</span></span> <span data-ttu-id="187bb-107">これらのシステム データベースをバックアップすることで、ハード ディスク障害などのシステム障害時に [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] システムの復元と復旧を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="187bb-107">Backups of these system databases let you restore and recover the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] system in the event of system failure, such as the loss of a hard disk.</span></span>  
  
 <span data-ttu-id="187bb-108">次の表に、すべてのシステム データベースの概要を示します。</span><span class="sxs-lookup"><span data-stu-id="187bb-108">The following table summarizes all of the system databases.</span></span>  
  
|<span data-ttu-id="187bb-109">システム データベース</span><span class="sxs-lookup"><span data-stu-id="187bb-109">System database</span></span>|<span data-ttu-id="187bb-110">説明</span><span class="sxs-lookup"><span data-stu-id="187bb-110">Description</span></span>|<span data-ttu-id="187bb-111">バックアップの必要性</span><span class="sxs-lookup"><span data-stu-id="187bb-111">Are backups required?</span></span>|<span data-ttu-id="187bb-112">復旧モデル</span><span class="sxs-lookup"><span data-stu-id="187bb-112">Recovery model</span></span>|<span data-ttu-id="187bb-113">説明</span><span class="sxs-lookup"><span data-stu-id="187bb-113">Comments</span></span>|  
|---------------------|-----------------|---------------------------|--------------------|--------------|  
|[<span data-ttu-id="187bb-114">master</span><span class="sxs-lookup"><span data-stu-id="187bb-114">master</span></span>](../databases/master-database.md)|<span data-ttu-id="187bb-115">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] システムに関するシステム レベルのすべての情報を記録するデータベース。</span><span class="sxs-lookup"><span data-stu-id="187bb-115">The database that records all of the system level information for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] system.</span></span>|<span data-ttu-id="187bb-116">はい</span><span class="sxs-lookup"><span data-stu-id="187bb-116">Yes</span></span>|<span data-ttu-id="187bb-117">シンプル</span><span class="sxs-lookup"><span data-stu-id="187bb-117">Simple</span></span>|<span data-ttu-id="187bb-118">**master** は、ビジネス ニーズを満たすのに十分なデータ保護を行うために必要な頻度でバックアップします。</span><span class="sxs-lookup"><span data-stu-id="187bb-118">Back up **master** as often as necessary to protect the data sufficiently for your business needs.</span></span> <span data-ttu-id="187bb-119">定期的なバックアップ スケジュールの設定をお勧めします。大量の更新の後で追加のバックアップを行ってこれを補完することもできます。</span><span class="sxs-lookup"><span data-stu-id="187bb-119">We recommend a regular backup schedule, which you can supplement with an additional backup after a substantial update.</span></span>|  
|[<span data-ttu-id="187bb-120">model</span><span class="sxs-lookup"><span data-stu-id="187bb-120">model</span></span>](../databases/model-database.md)|<span data-ttu-id="187bb-121">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]のインスタンス上に作成されるすべてのデータベースのテンプレート。</span><span class="sxs-lookup"><span data-stu-id="187bb-121">The template for all databases that are created on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|<span data-ttu-id="187bb-122">はい</span><span class="sxs-lookup"><span data-stu-id="187bb-122">Yes</span></span>|<span data-ttu-id="187bb-123">ユーザー構成可能<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="187bb-123">User configurable<sup>1</sup></span></span>|<span data-ttu-id="187bb-124">**model** は、データベース オプションをカスタマイズした直後など、ビジネス ニーズに応じて必要な場合のみバックアップします。</span><span class="sxs-lookup"><span data-stu-id="187bb-124">Back up **model** only when necessary for your business needs; for example, immediately after customizing its database options.</span></span><br /><br /> <span data-ttu-id="187bb-125">**ベスト プラクティス:** **model** については、必要なときにデータベースの完全バックアップのみを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="187bb-125">**Best practice:** We recommend that you create only full database backups of **model**, as required.</span></span> <span data-ttu-id="187bb-126">**model** はサイズが小さく、変更頻度が低いため、ログのバックアップは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="187bb-126">Because **model** is small and rarely changes, backing up the log is unnecessary.</span></span>|  
|[<span data-ttu-id="187bb-127">msdb</span><span class="sxs-lookup"><span data-stu-id="187bb-127">msdb</span></span>](../databases/msdb-database.md)|<span data-ttu-id="187bb-128">警告やジョブのスケジュール設定とオペレーターの記録のために [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントによって使用されるデータベース。</span><span class="sxs-lookup"><span data-stu-id="187bb-128">The database used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent for scheduling alerts and jobs, and for recording operators.</span></span> <span data-ttu-id="187bb-129">**msdb** には、バックアップと復元の履歴テーブルなどの履歴テーブルも含まれます。</span><span class="sxs-lookup"><span data-stu-id="187bb-129">**msdb** also contains history tables such as the backup and restore history tables.</span></span>|<span data-ttu-id="187bb-130">はい</span><span class="sxs-lookup"><span data-stu-id="187bb-130">Yes</span></span>|<span data-ttu-id="187bb-131">単純 (既定)</span><span class="sxs-lookup"><span data-stu-id="187bb-131">Simple (default)</span></span>|<span data-ttu-id="187bb-132">**msdb** は更新するたびにバックアップします。</span><span class="sxs-lookup"><span data-stu-id="187bb-132">Back up **msdb** whenever it is updated.</span></span>|  
|<span data-ttu-id="187bb-133">[Resource](../databases/resource-database.md) (RDB)</span><span class="sxs-lookup"><span data-stu-id="187bb-133">[Resource](../databases/resource-database.md) (RDB)</span></span>|<span data-ttu-id="187bb-134">に付属するすべてのシステム オブジェクトのコピーを含んだ読み取り専用のデータベース。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="187bb-134">A read-only database that contains copies of all system objects that ship with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>|<span data-ttu-id="187bb-135">いいえ</span><span class="sxs-lookup"><span data-stu-id="187bb-135">No</span></span>|-|<span data-ttu-id="187bb-136">**Resource** データベースにはコードのみが含まれ、mssqlsystemresource.mdf ファイル内に存在します。</span><span class="sxs-lookup"><span data-stu-id="187bb-136">The **Resource** database resides in the mssqlsystemresource.mdf file, which contains only code.</span></span> <span data-ttu-id="187bb-137">そのため、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では **Resource** データベースをバックアップできません。</span><span class="sxs-lookup"><span data-stu-id="187bb-137">Therefore, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot back up the **Resource** database.</span></span><br /><br /> <span data-ttu-id="187bb-138">注:mssqlsystemresource.mdf ファイルに対してファイル ベースまたはディスク ベースのバックアップを実行するには、このファイルをデータベース ファイルではなくバイナリ (.exe) ファイルとして扱います。</span><span class="sxs-lookup"><span data-stu-id="187bb-138">Note: You can perform a file-based or a disk-based backup on the mssqlsystemresource.mdf file by treating the file as if it were a binary (.exe) file, instead of a database file.</span></span> <span data-ttu-id="187bb-139">ただし、これらのバックアップでは [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] の復元を使用できません。</span><span class="sxs-lookup"><span data-stu-id="187bb-139">But you cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] restore on the backups.</span></span> <span data-ttu-id="187bb-140">mssqlsystemresource.mdf のバックアップ コピーの復元は手動でのみ実行できます。また、現在の **Resource** データベースを古いバージョンや安全でない可能性のあるバージョンで上書きしないように注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-140">Restoring a backup copy of mssqlsystemresource.mdf can only be done manually, and you must be careful not to overwrite the current **Resource** database with an out-of-date or potentially insecure version.</span></span>|  
|[<span data-ttu-id="187bb-141">tempdb</span><span class="sxs-lookup"><span data-stu-id="187bb-141">tempdb</span></span>](../databases/tempdb-database.md)|<span data-ttu-id="187bb-142">一時的な結果セットや生成途中の結果セットを保存するためのワークスペース。</span><span class="sxs-lookup"><span data-stu-id="187bb-142">A workspace for holding temporary or intermediate result sets.</span></span> <span data-ttu-id="187bb-143">このデータベースは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスを起動するたびに作成し直されます。</span><span class="sxs-lookup"><span data-stu-id="187bb-143">This database is re-created every time an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is started.</span></span> <span data-ttu-id="187bb-144">サーバー インスタンスをシャットダウンするとき、 **tempdb** 内のすべてのデータは完全に削除されます。</span><span class="sxs-lookup"><span data-stu-id="187bb-144">When the server instance is shut down, any data in **tempdb** is deleted permanently.</span></span>|<span data-ttu-id="187bb-145">いいえ</span><span class="sxs-lookup"><span data-stu-id="187bb-145">No</span></span>|<span data-ttu-id="187bb-146">シンプル</span><span class="sxs-lookup"><span data-stu-id="187bb-146">Simple</span></span>|<span data-ttu-id="187bb-147">**tempdb** システム データベースはバックアップできません。</span><span class="sxs-lookup"><span data-stu-id="187bb-147">You cannot back up the **tempdb** system database.</span></span>|  
|<span data-ttu-id="187bb-148">[[ディストリビューションの構成]](../replication/configure-distribution.md)</span><span class="sxs-lookup"><span data-stu-id="187bb-148">[Configure Distribution](../replication/configure-distribution.md)</span></span>|<span data-ttu-id="187bb-149">サーバーをレプリケーション ディストリビューターとして構成している場合に限り存在するデータベース。</span><span class="sxs-lookup"><span data-stu-id="187bb-149">A database that exists only if the server is configured as a replication Distributor.</span></span> <span data-ttu-id="187bb-150">あらゆる種類のレプリケーションのメタデータや履歴、およびトランザクション レプリケーションのトランザクションが保存されます。</span><span class="sxs-lookup"><span data-stu-id="187bb-150">This database stores metadata and history data for all types of replication, and transactions for transactional replication.</span></span>|<span data-ttu-id="187bb-151">はい</span><span class="sxs-lookup"><span data-stu-id="187bb-151">Yes</span></span>|<span data-ttu-id="187bb-152">シンプル</span><span class="sxs-lookup"><span data-stu-id="187bb-152">Simple</span></span>|<span data-ttu-id="187bb-153">**distribution** データベースをバックアップするタイミングの詳細については、「 [レプリケートされたデータベースのバックアップと復元](../replication/administration/back-up-and-restore-replicated-databases.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="187bb-153">For information about when to back up the **distribution** database, see [Back Up and Restore Replicated Databases](../replication/administration/back-up-and-restore-replicated-databases.md).</span></span>|  
  
 <span data-ttu-id="187bb-154"><sup>1</sup>モデルの現在の復旧モデルの詳細については、「[データベースの復旧モデルを表示または変更する &#40;SQL Server&#41;](view-or-change-the-recovery-model-of-a-database-sql-server.md)または[&#41;&#40;transact-sql ](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="187bb-154"><sup>1</sup> To learn the current recovery model of the model, see [View or Change the Recovery Model of a Database &#40;SQL Server&#41;](view-or-change-the-recovery-model-of-a-database-sql-server.md) or [sys.databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql).</span></span>  
  
## <a name="limitations-on-restoring-system-databases"></a><span data-ttu-id="187bb-155">システム データベースの復元に関する制限</span><span class="sxs-lookup"><span data-stu-id="187bb-155">Limitations on Restoring System Databases</span></span>  
  
-   <span data-ttu-id="187bb-156">システム データベースは、サーバー インスタンスが現在実行されている [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のバージョンで作成されたバックアップからのみ復元できます。</span><span class="sxs-lookup"><span data-stu-id="187bb-156">System databases can be restored only from backups that are created on the version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that the server instance is currently running.</span></span> <span data-ttu-id="187bb-157">たとえば、SP1 で実行されているサーバーインスタンス上のシステムデータベースを復元するには、次のようにし [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="187bb-157">For example, to restore a system database on a server instance that is running on [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] SP1.</span></span>  
  
-   <span data-ttu-id="187bb-158">データベースを復元するには、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のインスタンスを実行している必要があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-158">To restore any database, the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] must be running.</span></span> <span data-ttu-id="187bb-159">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスを起動するには、 **master** データベースにアクセスでき、かつ少なくとも一部は使用できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-159">Startup of an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] requires that the **master** database is accessible and at least partly usable.</span></span> <span data-ttu-id="187bb-160">**master** が使用できない状態になった場合、このデータベースを次のいずれかの方法で使用できる状態に戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="187bb-160">If **master** becomes unusable, you can return the database to a usable state in either of the following ways:</span></span>  
  
    -   <span data-ttu-id="187bb-161">現在のデータベース バックアップから **master** を復元します。</span><span class="sxs-lookup"><span data-stu-id="187bb-161">Restore **master** from a current database backup.</span></span>  
  
         <span data-ttu-id="187bb-162">サーバー インスタンスを起動できる場合は、データベースの完全バックアップから **master** を復元できます。</span><span class="sxs-lookup"><span data-stu-id="187bb-162">If you can start the server instance, you should be able to restore **master** from a full database backup.</span></span>  
  
    -   <span data-ttu-id="187bb-163">**master** を完全に再構築します。</span><span class="sxs-lookup"><span data-stu-id="187bb-163">Rebuild **master** completely.</span></span>  
  
         <span data-ttu-id="187bb-164">**master** に深刻な破損があり、それが原因で [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]を起動できない場合、 **master**を再構築する必要があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-164">If severe damage to **master** prevents you from starting [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you must rebuild **master**.</span></span> <span data-ttu-id="187bb-165">詳細については、「 [システム データベースの再構築](../databases/system-databases.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="187bb-165">For more information, see [Rebuild System Databases](../databases/system-databases.md).</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="187bb-166">**master** を再構築すると、すべてのシステム データベースが再構築されます。</span><span class="sxs-lookup"><span data-stu-id="187bb-166">Rebuilding **master** rebuilds all of the system databases.</span></span>  
  
-   <span data-ttu-id="187bb-167">状況によっては、モデル データベースを復旧する問題は、システム データベースの再構築、あるいはモデル データベースの mdf ファイルや ldf ファイルの置き換えが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="187bb-167">Under some circumstances, problems recovering the model database may require rebuilding the system databases or replacing the mdf and ldf files for the model database.</span></span> <span data-ttu-id="187bb-168">詳細については、「 [システム データベースの再構築](../databases/system-databases.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="187bb-168">For more information, see [Rebuild System Databases](../databases/system-databases.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="187bb-169">関連タスク</span><span class="sxs-lookup"><span data-stu-id="187bb-169">Related Tasks</span></span>  
  
-   [<span data-ttu-id="187bb-170">データベースの完全バックアップの作成 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="187bb-170">Create a Full Database Backup &#40;SQL Server&#41;</span></span>](create-a-full-database-backup-sql-server.md)  
  
-   [<span data-ttu-id="187bb-171">データベースの全体復元 &#40;単純復旧モデル&#41;</span><span class="sxs-lookup"><span data-stu-id="187bb-171">Complete Database Restores &#40;Simple Recovery Model&#41;</span></span>](complete-database-restores-simple-recovery-model.md)  
  
-   [<span data-ttu-id="187bb-172">master データベースの復元 &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="187bb-172">Restore the master Database &#40;Transact-SQL&#41;</span></span>](restore-the-master-database-transact-sql.md)  
  
-   [<span data-ttu-id="187bb-173">データベースの復旧モデルの表示または変更 &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="187bb-173">View or Change the Recovery Model of a Database &#40;SQL Server&#41;</span></span>](view-or-change-the-recovery-model-of-a-database-sql-server.md)  
  
-   [<span data-ttu-id="187bb-174">システム データベースの移動</span><span class="sxs-lookup"><span data-stu-id="187bb-174">Move System Databases</span></span>](../databases/move-system-databases.md)  
  
## <a name="see-also"></a><span data-ttu-id="187bb-175">参照</span><span class="sxs-lookup"><span data-stu-id="187bb-175">See Also</span></span>  
 <span data-ttu-id="187bb-176">[ディストリビューション データベース](../../relational-databases/replication/distribution-database.md) </span><span class="sxs-lookup"><span data-stu-id="187bb-176">[Distribution Database](../../relational-databases/replication/distribution-database.md) </span></span>  
 <span data-ttu-id="187bb-177">[master データベース](../databases/master-database.md) </span><span class="sxs-lookup"><span data-stu-id="187bb-177">[master Database](../databases/master-database.md) </span></span>  
 <span data-ttu-id="187bb-178">[msdb データベース](../databases/msdb-database.md) </span><span class="sxs-lookup"><span data-stu-id="187bb-178">[msdb Database](../databases/msdb-database.md) </span></span>  
 <span data-ttu-id="187bb-179">[model データベース](../databases/model-database.md) </span><span class="sxs-lookup"><span data-stu-id="187bb-179">[model Database](../databases/model-database.md) </span></span>  
 <span data-ttu-id="187bb-180">[Resource データベース](../databases/resource-database.md) </span><span class="sxs-lookup"><span data-stu-id="187bb-180">[Resource Database](../databases/resource-database.md) </span></span>  
 [<span data-ttu-id="187bb-181">tempdb データベース</span><span class="sxs-lookup"><span data-stu-id="187bb-181">tempdb Database</span></span>](../databases/tempdb-database.md)  
  
  
