---
title: OPENXML (SQLServer) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: conceptual
helpviewer_keywords:
- ColPattern [XML in SQL Server]
- OPENXML statement, about OPENXML statement
- writing XML, OPENXML statement
- OPENXML statement, querying XML
- attribute-centric mapping
- SELECT statement [SQL Server], OPENXML keyword
- column patterns [XML in SQL Server]
- row patterns [XML in SQL Server]
- rowpattern [XML in SQL Server]
- queries [XML in SQL Server], OPENXML statement
- XML [SQL Server], OPENXML statement
- element-centric mapping [SQL Server]
ms.assetid: 060126fc-ed0f-478f-830a-08e418d410dc
author: rothja
ms.author: jroth
ms.openlocfilehash: 1849029e6654fcd629499cceeff9957e5389370f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87743045"
---
# <a name="openxml-sql-server"></a><span data-ttu-id="dc18b-102">OPENXML (SQLServer)</span><span class="sxs-lookup"><span data-stu-id="dc18b-102">OPENXML (SQL Server)</span></span>
  <span data-ttu-id="dc18b-103">[!INCLUDE[tsql](../../includes/tsql-md.md)] キーワードの 1 つである OPENXML を使用すると、インメモリ XML ドキュメントに対してテーブルやビューと同様の行セットが提供されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-103">OPENXML, a [!INCLUDE[tsql](../../includes/tsql-md.md)] keyword, provides a rowset over in-memory XML documents that is similar to a table or a view.</span></span> <span data-ttu-id="dc18b-104">OPENXML を使用することで、リレーショナル行セット同様に XML データにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-104">OPENXML allows access to XML data as though it is a relational rowset.</span></span> <span data-ttu-id="dc18b-105">これを実現するため、XML ドキュメントの内部表現の行セット ビューが用意されています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-105">It does this by providing a rowset view of the internal representation of an XML document.</span></span> <span data-ttu-id="dc18b-106">行セット内のレコードは、データベース テーブルに格納できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-106">The records in the rowset can be stored in database tables.</span></span>

 <span data-ttu-id="dc18b-107">OPENXML を使用できるのは、行セット プロバイダー、ビュー、または OPENROWSET をソースとして指定できる SELECT ステートメントおよび SELECT INTO ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-107">OPENXML can be used in SELECT and SELECT INTO statements wherever rowset providers, a view, or OPENROWSET can appear as the source.</span></span> <span data-ttu-id="dc18b-108">OPENXML の構文の詳細については、「 [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-108">For information about the syntax of OPENXML, see [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql).</span></span>

 <span data-ttu-id="dc18b-109">OPENXML を使用して XML ドキュメントに対するクエリを作成するには、まずを呼び出す必要があり `sp_xml_preparedocument` ます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-109">To write queries against an XML document by using OPENXML, you must first call `sp_xml_preparedocument`.</span></span> <span data-ttu-id="dc18b-110">このプロシージャは XML ドキュメントを解析し、使用準備が整った解析後のドキュメントへのハンドルを返します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-110">This parses the XML document and returns a handle to the parsed document that is ready for consumption.</span></span> <span data-ttu-id="dc18b-111">解析後のドキュメントは、XML ドキュメント内のさまざまなノードを DOM (ドキュメント オブジェクト モデル) ツリーで表現したものです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-111">The parsed document is a document object model (DOM) tree representation of various nodes in the XML document.</span></span> <span data-ttu-id="dc18b-112">このドキュメント ハンドルは OPENXML に渡されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-112">The document handle is passed to OPENXML.</span></span> <span data-ttu-id="dc18b-113">OPENXML では渡されたパラメーターを基にドキュメントの行セット ビューを用意します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-113">OPENXML then provides a rowset view of the document, based on the parameters passed to it.</span></span>

> [!NOTE]
>  <span data-ttu-id="dc18b-114">`sp_xml_preparedocument`では、SQL によって更新されたバージョンの MSXML パーサーである Msxmlsql.dll を使用します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-114">`sp_xml_preparedocument` uses a SQL-updated version of the MSXML parser, Msxmlsql.dll.</span></span> <span data-ttu-id="dc18b-115">このバージョンの MSXML パーサーは、MSXML Version 2.6 との後方互換性を維持したまま [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] もサポートするように設計されました。</span><span class="sxs-lookup"><span data-stu-id="dc18b-115">This version of the MSXML parser was designed to support [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and remain backward compatible with MSXML version 2.6.</span></span>

 <span data-ttu-id="dc18b-116">XML ドキュメントの内部表現は、 **sp_xml_removedocument** システム ストアド プロシージャを呼び出してメモリを解放することによって、メモリから削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-116">The internal representation of an XML document must be removed from memory by calling the **sp_xml_removedocument** system stored procedure to free the memory.</span></span>

 <span data-ttu-id="dc18b-117">次の図は、この処理を示しています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-117">The following illustration shows the process.</span></span>

 <span data-ttu-id="dc18b-118">![OPENXML で XML を解析する](../../database-engine/media/xmlsp.gif "OPENXML で XML を解析する")</span><span class="sxs-lookup"><span data-stu-id="dc18b-118">![Parsing XML with OPENXML](../../database-engine/media/xmlsp.gif "Parsing XML with OPENXML")</span></span>

 <span data-ttu-id="dc18b-119">OPENXML を理解するには、XPath クエリと XML を詳しく理解している必要があります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-119">Note that to understand OPENXML, familiarity with XPath queries and an understanding of XML is required.</span></span> <span data-ttu-id="dc18b-120">SQL Server での XPath のサポートの詳細については、「 [SQLXML 4.0 での XPath クエリの使用](../sqlxml-annotated-xsd-schemas-xpath-queries/using-xpath-queries-in-sqlxml-4-0.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-120">For more information about XPath support in SQL Server, see [Using XPath Queries in SQLXML 4.0](../sqlxml-annotated-xsd-schemas-xpath-queries/using-xpath-queries-in-sqlxml-4-0.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="dc18b-121">OPENXML では、XPath の行と列のパターンを変数としてパラメーター化できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-121">OpenXML allows the row and column XPath patterns to be parameterized as variables.</span></span> <span data-ttu-id="dc18b-122">プログラマがこのようなパラメーター化を外部ユーザーに公開すると (たとえば、外部で呼び出されるストアド プロシージャからパラメーターが指定される場合)、XPath 式を外部から挿入できる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-122">Such parameterization could lead to XPath expression injections, if the programmer exposes the parameterization to outside users (for example, if the parameters are provided via an externally called stored procedure).</span></span> <span data-ttu-id="dc18b-123">このような潜在的なセキュリティの問題を回避するために、XPath パラメーターを外部の呼び出し元に公開しないでください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-123">To avoid such potential security issues, it is recommended that XPath parameters should never be exposed to external callers.</span></span>

## <a name="example"></a><span data-ttu-id="dc18b-124">例</span><span class="sxs-lookup"><span data-stu-id="dc18b-124">Example</span></span>
 <span data-ttu-id="dc18b-125">次の例では、 `OPENXML` ステートメントと `INSERT` ステートメントで `SELECT` を使用します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-125">The following example shows the use of `OPENXML` in an `INSERT` statement and a `SELECT` statement.</span></span> <span data-ttu-id="dc18b-126">サンプルの XML ドキュメントには、 `<Customers>` 要素と `<Orders>` 要素が含まれています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-126">The sample XML document contains `<Customers>` and `<Orders>` elements.</span></span>

 <span data-ttu-id="dc18b-127">最初に、 `sp_xml_preparedocument` ストアド プロシージャで XML ドキュメントを解析します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-127">First, the `sp_xml_preparedocument` stored procedure parses the XML document.</span></span> <span data-ttu-id="dc18b-128">この解析済みのドキュメントでは、XML ドキュメント内のノード (要素、属性、テキスト、コメント) がツリー形式で表示されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-128">The parsed document is a tree representation of the nodes (elements, attributes, text, and comments) in the XML document.</span></span> <span data-ttu-id="dc18b-129">`OPENXML` は次に、この解析済みの XML ドキュメントを参照して、この XML ドキュメントのすべてまたは一部の行セットを表示します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-129">`OPENXML` then refers to this parsed XML document and provides a rowset view of all or parts of this XML document.</span></span> <span data-ttu-id="dc18b-130">`INSERT` ステートメントで `OPENXML` を使用すると、このような行セットのデータをデータベース テーブルに挿入できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-130">An `INSERT` statement using `OPENXML` can insert data from such a rowset into a database table.</span></span> <span data-ttu-id="dc18b-131">複数の `OPENXML` 呼び出しを使用することで、XML ドキュメントの各部の行セット ビューを提供し、各部を処理 (たとえば、別のテーブルに挿入) できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-131">Several `OPENXML` calls can be used to provide a rowset view of various parts of the XML document and process them, for example, by inserting them into different tables.</span></span> <span data-ttu-id="dc18b-132">この処理は、テーブルへの XML の細分化とも呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-132">This process is also referred to as shredding XML into tables.</span></span>

 <span data-ttu-id="dc18b-133">次の例では、2 つの `<Customers>` ステートメントで `Customers` 要素を `<Orders>` テーブルに格納し、 `Orders` 要素を `INSERT` テーブルに格納することで、XML ドキュメントを細分化しています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-133">In the following example, an XML document is shredded in a way that `<Customers>` elements are stored in the `Customers` table and `<Orders>` elements are stored in the `Orders` table by using two `INSERT` statements.</span></span> <span data-ttu-id="dc18b-134">また、この例では、 `SELECT` を使用して XML ドキュメントから `OPENXML` と `CustomerID` を取得する `OrderDate` ステートメントも示しています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-134">The example also shows a `SELECT` statement with `OPENXML` that retrieves `CustomerID` and `OrderDate` from the XML document.</span></span> <span data-ttu-id="dc18b-135">この処理の最後に `sp_xml_removedocument`が呼び出されています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-135">The last step in the process is to call `sp_xml_removedocument`.</span></span> <span data-ttu-id="dc18b-136">これは、解析時に作成された内部 XML ツリー表現を保持するために割り当てられたメモリを解放するための処理です。</span><span class="sxs-lookup"><span data-stu-id="dc18b-136">This is done in order to release the memory allocated to contain the internal XML tree representation that was created during the parse phase.</span></span>

```
-- Create tables for later population using OPENXML.
CREATE TABLE Customers (CustomerID varchar(20) primary key,
                ContactName varchar(20), 
                CompanyName varchar(20));
GO
CREATE TABLE Orders( CustomerID varchar(20), OrderDate datetime);
GO
DECLARE @docHandle int;
DECLARE @xmlDocument nvarchar(max); -- or xml type
SET @xmlDocument = N'<ROOT>
<Customers CustomerID="XYZAA" ContactName="Joe" CompanyName="Company1">
<Orders CustomerID="XYZAA" OrderDate="2000-08-25T00:00:00"/>
<Orders CustomerID="XYZAA" OrderDate="2000-10-03T00:00:00"/>
</Customers>
<Customers CustomerID="XYZBB" ContactName="Steve"
CompanyName="Company2">No Orders yet!
</Customers>
</ROOT>';
EXEC sp_xml_preparedocument @docHandle OUTPUT, @xmlDocument;
-- Use OPENXML to provide rowset consisting of customer data.
INSERT Customers 
SELECT * 
FROM OPENXML(@docHandle, N'/ROOT/Customers') 
  WITH Customers;
-- Use OPENXML to provide rowset consisting of order data.
INSERT Orders 
SELECT * 
FROM OPENXML(@docHandle, N'//Orders') 
  WITH Orders;
-- Using OPENXML in a SELECT statement.
SELECT * FROM OPENXML(@docHandle, N'/ROOT/Customers/Orders') WITH (CustomerID nchar(5) '../@CustomerID', OrderDate datetime);
-- Remove the internal representation of the XML document.
EXEC sp_xml_removedocument @docHandle; 
```

 <span data-ttu-id="dc18b-137">次の図は、sp_xml_preparedocument によって作成された上記の XML ドキュメントを解析した結果の XML ツリーを表しています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-137">The following illustration shows the parsed XML tree of the previous XML document that was created by using sp_xml_preparedocument.</span></span>

 <span data-ttu-id="dc18b-138">![解析された XML ツリー](../../database-engine/media/xmlparsedtree.gif "解析された XML ツリー")</span><span class="sxs-lookup"><span data-stu-id="dc18b-138">![Parsed XML tree](../../database-engine/media/xmlparsedtree.gif "Parsed XML tree")</span></span>

## <a name="openxml-parameters"></a><span data-ttu-id="dc18b-139">OPENXML のパラメーター</span><span class="sxs-lookup"><span data-stu-id="dc18b-139">OPENXML Parameters</span></span>
 <span data-ttu-id="dc18b-140">OPENXML のパラメーターは、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-140">The parameters to OPENXML include the following:</span></span>

-   <span data-ttu-id="dc18b-141">XML ドキュメント ハンドル (*idoc*)</span><span class="sxs-lookup"><span data-stu-id="dc18b-141">An XML document handle (*idoc*)</span></span>

-   <span data-ttu-id="dc18b-142">行にマップされるノードを特定するための XPath 式 (*rowpattern*)</span><span class="sxs-lookup"><span data-stu-id="dc18b-142">An XPath expression to identify the nodes to be mapped to rows (*rowpattern*)</span></span>

-   <span data-ttu-id="dc18b-143">生成される行セットの説明</span><span class="sxs-lookup"><span data-stu-id="dc18b-143">A description of the rowset to be generated</span></span>

-   <span data-ttu-id="dc18b-144">行セット列と XML ノード間のマッピング</span><span class="sxs-lookup"><span data-stu-id="dc18b-144">Mapping between the rowset columns and the XML nodes</span></span>

### <a name="xml-document-handle-idoc"></a><span data-ttu-id="dc18b-145">XML ドキュメント ハンドル (idoc)</span><span class="sxs-lookup"><span data-stu-id="dc18b-145">XML Document Handle (idoc)</span></span>
 <span data-ttu-id="dc18b-146">ドキュメントハンドルは、ストアドプロシージャによって返され `sp_xml_preparedocument` ます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-146">The document handle is returned by the `sp_xml_preparedocument` stored procedure.</span></span>

### <a name="xpath-expression-to-identify-the-nodes-to-be-processed-rowpattern"></a><span data-ttu-id="dc18b-147">処理するノードを特定するための XPath 式 (rowpattern)</span><span class="sxs-lookup"><span data-stu-id="dc18b-147">XPath Expression to Identify the Nodes to Be Processed (rowpattern)</span></span>
 <span data-ttu-id="dc18b-148">*rowpattern* として指定する XPath 式で、XML ドキュメントに含まれる一連のノードを特定します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-148">The XPath expression specified as *rowpattern* identifies a set of nodes in the XML document.</span></span> <span data-ttu-id="dc18b-149">*rowpattern* によって特定される各ノードが、OPENXML で生成される行セット内の 1 行に相当します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-149">Each node that is identified by *rowpattern* corresponds to a single row in the rowset that is generated by OPENXML.</span></span>

 <span data-ttu-id="dc18b-150">XPath 式で特定するノードは、XML ドキュメント内のどの XML ノードでもかまいません。</span><span class="sxs-lookup"><span data-stu-id="dc18b-150">The nodes identified by the XPath expression can be any XML node in the XML document.</span></span> <span data-ttu-id="dc18b-151">XML ドキュメント内の一連の要素を *rowpattern* で特定すると、特定した要素ノードごとに 1 行の行セットが形成されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-151">If *rowpattern* identifies a set of elements in the XML document, there is one row in the rowset for each element node identified.</span></span> <span data-ttu-id="dc18b-152">たとえば、 *rowpattern* の結果が属性になる場合は、 *rowpattern*によって選択された属性ノードごとに行が作成されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-152">For example, if *rowpattern* ends in an attribute, a row is created for each attribute node selected by *rowpattern*.</span></span>

### <a name="description-of-the-rowset-to-be-generated"></a><span data-ttu-id="dc18b-153">生成される行セットの説明</span><span class="sxs-lookup"><span data-stu-id="dc18b-153">Description of the Rowset to Be Generated</span></span>
 <span data-ttu-id="dc18b-154">OPENXML では行セット スキーマを使用して、結果の行セットを生成します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-154">A rowset schema is used by OPENXML to generate the resulting rowset.</span></span> <span data-ttu-id="dc18b-155">行セット スキーマを指定するときは、次の方法を使用できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-155">You can use the following options when specifying a rowset schema.</span></span>

#### <a name="using-the-edge-table-format"></a><span data-ttu-id="dc18b-156">エッジ テーブル形式の使用</span><span class="sxs-lookup"><span data-stu-id="dc18b-156">Using the Edge Table Format</span></span>
 <span data-ttu-id="dc18b-157">行セット スキーマを指定するにはエッジ テーブル形式を使用してください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-157">You should use the edge table format to specify a rowset schema.</span></span> <span data-ttu-id="dc18b-158">WITH 句は指定しないでください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-158">Do not use the WITH clause.</span></span>

 <span data-ttu-id="dc18b-159">これによって、OPENXML からエッジ テーブル形式の行セットが返されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-159">When you do this, OPENXML returns a rowset in the edge table format.</span></span> <span data-ttu-id="dc18b-160">この行セットは、解析した XML ドキュメント ツリーのすべてのエッジが行セットの各行にマップされるので、エッジ テーブルと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-160">This is referred to as an edge table, because every edge in the parsed XML document tree maps to a row in the rowset.</span></span>

 <span data-ttu-id="dc18b-161">エッジ テーブルは XML ドキュメントの詳細構造を 1 つのテーブル内に表現します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-161">Edge tables represent within a single table the fine-grained XML document structure.</span></span> <span data-ttu-id="dc18b-162">表現される構造には、要素名、属性名、ドキュメント階層、名前空間、処理命令などがあります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-162">This structure includes the element and attribute names, the document hierarchy, the namespaces, and the processing instructions.</span></span> <span data-ttu-id="dc18b-163">エッジ テーブル形式を使用すると、メタプロパティでは公開されない追加情報を取得できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-163">The edge table format allows you to obtain additional information that is not exposed through the metaproperties.</span></span> <span data-ttu-id="dc18b-164">メタプロパティの詳細については、「 [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-164">For more information about metaproperties, see [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span></span>

 <span data-ttu-id="dc18b-165">エッジ テーブルに含まれる追加情報によって、要素と属性のデータ型、ノードの種類、XML ドキュメント構造に関する情報の保存およびクエリを実行できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-165">The additional information provided by an edge table allows you to store and query the data type of an element and attribute, and the node type, and also store and query information about the XML document structure.</span></span> <span data-ttu-id="dc18b-166">また、独自の XML ドキュメント管理システムを構築することもできます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-166">With this additional information, it may also be possible to build your own XML document management system.</span></span>

 <span data-ttu-id="dc18b-167">エッジ テーブルを使用することで、XML ドキュメントを BLOB (バイナリ ラージ オブジェクト) 入力として受け取り、エッジ テーブルを生成し、ドキュメントを詳細なレベルまで展開および分析するストアド プロシージャを作成できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-167">By using an edge table, you can write stored procedures that take XML documents as binary large object (BLOB) input, produce the edge table, and then extract and analyze the document on a more detailed level.</span></span> <span data-ttu-id="dc18b-168">詳細なレベルでは、ドキュメント階層、要素名、属性名、名前空間、および処理命令を検出できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-168">This detailed level could include finding the document hierarchy, the element and attribute names, the namespaces, and the processing instructions.</span></span>

 <span data-ttu-id="dc18b-169">また、他のリレーショナル形式へのマッピングが論理的でなく、ntext 型のフィールドでは構造情報が十分得られない場合に、エッジ テーブルを XML ドキュメントの格納形式としても使用できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-169">The edge table also can serve as a storage format for XML documents when mapping to other relational formats is not logical and an ntext field is not providing enough structural information.</span></span>

 <span data-ttu-id="dc18b-170">XML パーサーを使用して XML ドキュメントを検査できる場合は、エッジ テーブルを使用しても同じ情報を入手できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-170">In situations where you can use an XML parser to examine an XML document, you can use an edge table instead to obtain the same information.</span></span>

 <span data-ttu-id="dc18b-171">次の表で、エッジ テーブルの構造について説明します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-171">The following table describes the structure of the edge table.</span></span>

|<span data-ttu-id="dc18b-172">列名</span><span class="sxs-lookup"><span data-stu-id="dc18b-172">Column name</span></span>|<span data-ttu-id="dc18b-173">データ型</span><span class="sxs-lookup"><span data-stu-id="dc18b-173">Data type</span></span>|<span data-ttu-id="dc18b-174">説明</span><span class="sxs-lookup"><span data-stu-id="dc18b-174">Description</span></span>|
|-----------------|---------------|-----------------|
|<span data-ttu-id="dc18b-175">**id**</span><span class="sxs-lookup"><span data-stu-id="dc18b-175">**id**</span></span>|<span data-ttu-id="dc18b-176">**bigint**</span><span class="sxs-lookup"><span data-stu-id="dc18b-176">**bigint**</span></span>|<span data-ttu-id="dc18b-177">ドキュメント ノードの一意の ID。</span><span class="sxs-lookup"><span data-stu-id="dc18b-177">Is the unique ID of the document node.</span></span><br /><br /> <span data-ttu-id="dc18b-178">ルート要素の ID 値は 0 です。</span><span class="sxs-lookup"><span data-stu-id="dc18b-178">The root element has an ID value of 0.</span></span> <span data-ttu-id="dc18b-179">負の ID 値は予約済みです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-179">The negative ID values are reserved.</span></span>|
|<span data-ttu-id="dc18b-180">**parentid**</span><span class="sxs-lookup"><span data-stu-id="dc18b-180">**parentid**</span></span>|<span data-ttu-id="dc18b-181">**bigint**</span><span class="sxs-lookup"><span data-stu-id="dc18b-181">**bigint**</span></span>|<span data-ttu-id="dc18b-182">ノードの親の識別子。</span><span class="sxs-lookup"><span data-stu-id="dc18b-182">Identifies the parent of the node.</span></span> <span data-ttu-id="dc18b-183">この ID で識別される親が親要素だとは限りません。</span><span class="sxs-lookup"><span data-stu-id="dc18b-183">The parent identified by this ID is not necessarily the parent element.</span></span> <span data-ttu-id="dc18b-184">識別された親が親要素であるかどうかは、この ID で識別されるノードを親とするノードの NodeType によって決まります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-184">However, this depends on the NodeType of the node whose parent is identified by this ID.</span></span> <span data-ttu-id="dc18b-185">たとえば、ノードがテキスト ノードの場合、その親は属性ノードである可能性があります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-185">For example, if the node is a text node, its parent may be an attribute node.</span></span><br /><br /> <span data-ttu-id="dc18b-186">ノードが XML ドキュメントの最上位にある場合、その **ParentID** は NULL になります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-186">If the node is at the top level in the XML document, its **ParentID** is NULL.</span></span>|
|<span data-ttu-id="dc18b-187">**node type**</span><span class="sxs-lookup"><span data-stu-id="dc18b-187">**node type**</span></span>|<span data-ttu-id="dc18b-188">**int**</span><span class="sxs-lookup"><span data-stu-id="dc18b-188">**int**</span></span>|<span data-ttu-id="dc18b-189">XML DOM (オブジェクト モデル) でノードの種類に付けられている番号に応じた、ノードの種類を識別するための整数です。</span><span class="sxs-lookup"><span data-stu-id="dc18b-189">Identifies the node type and is an integer that corresponds to the XML object model (DOM) node type numbering.</span></span><br /><br /> <span data-ttu-id="dc18b-190">この列に示される、ノードの種類を示す値を次に示します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-190">Following are the values that can appear in this column to indicate the node type:</span></span><br /><br /> <span data-ttu-id="dc18b-191">**1** = 要素ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-191">**1** = Element node</span></span><br /><br /> <span data-ttu-id="dc18b-192">**2** = 属性ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-192">**2** = Attribute node</span></span><br /><br /> <span data-ttu-id="dc18b-193">**3** = テキスト ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-193">**3** = Text node</span></span><br /><br /> <span data-ttu-id="dc18b-194">**4** = CDATA セクション ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-194">**4** = CDATA section node</span></span><br /><br /> <span data-ttu-id="dc18b-195">**5** = エンティティ参照ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-195">**5** = Entity reference node</span></span><br /><br /> <span data-ttu-id="dc18b-196">**6** = エンティティ ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-196">**6** = Entity node</span></span><br /><br /> <span data-ttu-id="dc18b-197">**7** = 処理命令ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-197">**7** = Processing instruction node</span></span><br /><br /> <span data-ttu-id="dc18b-198">**8** = コメント ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-198">**8** = Comment node</span></span><br /><br /> <span data-ttu-id="dc18b-199">**9** = ドキュメント ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-199">**9** = Document node</span></span><br /><br /> <span data-ttu-id="dc18b-200">**10** = ドキュメント型ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-200">**10** = Document Type node</span></span><br /><br /> <span data-ttu-id="dc18b-201">**11** = ドキュメント フラグメント ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-201">**11** = Document Fragment node</span></span><br /><br /> <span data-ttu-id="dc18b-202">**12** = 注釈ノード</span><span class="sxs-lookup"><span data-stu-id="dc18b-202">**12** = Notation node</span></span><br /><br /> <span data-ttu-id="dc18b-203">詳細については、Microsoft XML (MSXML) SDK の「nodeType Property」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-203">For more information, see the "nodeType Property" topic in the Microsoft XML (MSXML) SDK.</span></span>|
|<span data-ttu-id="dc18b-204">**localname**</span><span class="sxs-lookup"><span data-stu-id="dc18b-204">**localname**</span></span>|<span data-ttu-id="dc18b-205">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="dc18b-205">**nvarchar(max)**</span></span>|<span data-ttu-id="dc18b-206">要素または属性のローカル名。</span><span class="sxs-lookup"><span data-stu-id="dc18b-206">Gives the local name of the element or attribute.</span></span> <span data-ttu-id="dc18b-207">DOM オブジェクトに名前がない場合は NULL になります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-207">Is NULL if the DOM object does not have a name.</span></span>|
|<span data-ttu-id="dc18b-208">**prefix**</span><span class="sxs-lookup"><span data-stu-id="dc18b-208">**prefix**</span></span>|<span data-ttu-id="dc18b-209">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="dc18b-209">**nvarchar(max)**</span></span>|<span data-ttu-id="dc18b-210">ノード名の名前空間のプレフィックス。</span><span class="sxs-lookup"><span data-stu-id="dc18b-210">Is the namespace prefix of the node name.</span></span>|
|<span data-ttu-id="dc18b-211">**namespaceuri**</span><span class="sxs-lookup"><span data-stu-id="dc18b-211">**namespaceuri**</span></span>|<span data-ttu-id="dc18b-212">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="dc18b-212">**nvarchar(max)**</span></span>|<span data-ttu-id="dc18b-213">ノードの名前空間 URI。</span><span class="sxs-lookup"><span data-stu-id="dc18b-213">Is the namespace URI of the node.</span></span> <span data-ttu-id="dc18b-214">値が NULL の場合、名前空間はありません。</span><span class="sxs-lookup"><span data-stu-id="dc18b-214">If the value is NULL, no namespace is present.</span></span>|
|<span data-ttu-id="dc18b-215">**datatype**</span><span class="sxs-lookup"><span data-stu-id="dc18b-215">**datatype**</span></span>|<span data-ttu-id="dc18b-216">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="dc18b-216">**nvarchar(max)**</span></span>|<span data-ttu-id="dc18b-217">要素行または属性行の実際のデータ型です。それ以外は NULL になります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-217">Is the actual data type of the element or attribute row and is otherwise NULL.</span></span> <span data-ttu-id="dc18b-218">データ型は、インライン DTD またはインライン スキーマから推定されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-218">The data type is inferred from the inline DTD or from the inline schema.</span></span>|
|<span data-ttu-id="dc18b-219">**prev**</span><span class="sxs-lookup"><span data-stu-id="dc18b-219">**prev**</span></span>|<span data-ttu-id="dc18b-220">**bigint**</span><span class="sxs-lookup"><span data-stu-id="dc18b-220">**bigint**</span></span>|<span data-ttu-id="dc18b-221">前の兄弟要素の XML ID。</span><span class="sxs-lookup"><span data-stu-id="dc18b-221">Is the XML ID of the previous sibling element.</span></span> <span data-ttu-id="dc18b-222">前に直接の兄弟がない場合は NULL になります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-222">Is NULL if there is no direct previous sibling.</span></span>|
|<span data-ttu-id="dc18b-223">**text**</span><span class="sxs-lookup"><span data-stu-id="dc18b-223">**text**</span></span>|<span data-ttu-id="dc18b-224">**ntext**</span><span class="sxs-lookup"><span data-stu-id="dc18b-224">**ntext**</span></span>|<span data-ttu-id="dc18b-225">テキスト形式で表した属性の値または要素のコンテンツです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-225">Contains the attribute value or the element content in text form.</span></span> <span data-ttu-id="dc18b-226">エッジ テーブルのエントリに値が必要ない場合は NULL になります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-226">Or is NULL, if the edge table entry does not need a value.</span></span>|

#### <a name="using-the-with-clause-to-specify-an-existing-table"></a><span data-ttu-id="dc18b-227">WITH 句を使用した既存のテーブルの指定</span><span class="sxs-lookup"><span data-stu-id="dc18b-227">Using the WITH Clause to Specify an Existing Table</span></span>
 <span data-ttu-id="dc18b-228">WITH 句を使用して、既存のテーブルの名前を指定できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-228">You can use the WITH clause to specify the name of an existing table.</span></span> <span data-ttu-id="dc18b-229">これを行うには、OPENXML で使用して行セットを生成できるスキーマを持つ既存のテーブルの名前を指定するだけです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-229">To do this, just specify an existing table name whose schema can be used by OPENXML to generate the rowset.</span></span>

#### <a name="using-the-with-clause-to-specify-a-schema"></a><span data-ttu-id="dc18b-230">WITH 句を使用したスキーマの指定</span><span class="sxs-lookup"><span data-stu-id="dc18b-230">Using the WITH Clause to Specify a Schema</span></span>
 <span data-ttu-id="dc18b-231">WITH 句を使用して、スキーマ全体を指定できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-231">You can use the WITH Clause to specify a complete schema.</span></span> <span data-ttu-id="dc18b-232">行セットのスキーマを指定するときは、列名と、そのデータ型および XML ドキュメントへのマッピングを指定します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-232">In specifying the rowset schema, you specify the column names, their data types, and their mapping to the XML document.</span></span>

 <span data-ttu-id="dc18b-233">SchemaDeclaration 内で ColPattern パラメーターを使用することによって、列パターンを指定できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-233">You can specify the column pattern by using the ColPattern parameter in the SchemaDeclaration.</span></span> <span data-ttu-id="dc18b-234">指定された列パターンを使用するのは、rowpattern によって識別される XML ノードに行セットの列をマップする場合、およびマッピングの種類を決定する場合です。</span><span class="sxs-lookup"><span data-stu-id="dc18b-234">The specified column pattern is used to map a rowset column to the XML node that is identified by rowpattern and is also used to determine the type of mapping.</span></span>

 <span data-ttu-id="dc18b-235">列に ColPattern が指定されていない場合、行セットの列は、 *flags* パラメーターで指定したマッピングに基づいて、同じ名前の XML ノードにマップされます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-235">If ColPattern is not specified for a column, the rowset column maps to the XML node with the same name, based on the mapping specified by the *flags* parameter.</span></span> <span data-ttu-id="dc18b-236">一方、ColPattern が WITH 句のスキーマ指定の一部として指定されている場合は、 *flags* パラメーターで指定したマッピングが上書きされます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-236">However, if ColPattern is specified as part of the schema specification in the WITH clause, it overwrites the mapping that is specified in the *flags* parameter.</span></span>

### <a name="mapping-between-the-rowset-columns-and-the-xml-nodes"></a><span data-ttu-id="dc18b-237">行セット列と XML ノード間のマッピング</span><span class="sxs-lookup"><span data-stu-id="dc18b-237">Mapping Between the Rowset Columns and the XML Nodes</span></span>
 <span data-ttu-id="dc18b-238">OPENXML ステートメントでは、必要に応じて、 *rowpattern*で特定される XML ノードと行セットの列の間のマッピングの種類 (属性中心、要素中心など) を指定できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-238">In the OPENXML statement, you can optionally specify the type of mapping, such as attribute-centric or element-centric, between the rowset columns and the XML nodes that are identified by the *rowpattern*.</span></span> <span data-ttu-id="dc18b-239">この情報は、XML ノードと行セットの列の間で変換を行うときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-239">This information is used in the transformation between the XML nodes and the rowset columns.</span></span>

 <span data-ttu-id="dc18b-240">マッピングの指定方法は 2 種類で、それらを同時に指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-240">You can specify the mapping in two ways, and you can also specify both:</span></span>

-   <span data-ttu-id="dc18b-241">*flags* パラメーターを使用する方法</span><span class="sxs-lookup"><span data-stu-id="dc18b-241">By using the *flags* parameter</span></span>

     <span data-ttu-id="dc18b-242">*flags* パラメーターで指定されるマッピングは、XML ノードが行セット内の対応する同名の列にマップされるという名前の対応が前提になっています。</span><span class="sxs-lookup"><span data-stu-id="dc18b-242">The mapping that is specified by the *flags* parameter assumes name correspondence in which the XML nodes map to the corresponding rowset columns with same name.</span></span>

-   <span data-ttu-id="dc18b-243">*ColPattern* パラメーターを使用する方法</span><span class="sxs-lookup"><span data-stu-id="dc18b-243">By using the *ColPattern* parameter</span></span>

     <span data-ttu-id="dc18b-244">*ColPattern*は XPath 式であり、WITH 句で *SchemaDeclaration* の一部として指定されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-244">*ColPattern*, an XPath expression, is specified as part of *SchemaDeclaration* in the WITH clause.</span></span> <span data-ttu-id="dc18b-245">*ColPattern* で指定されるマッピングは、 *flags* パラメーターで指定されるマッピングを上書きします。</span><span class="sxs-lookup"><span data-stu-id="dc18b-245">The mapping specified in *ColPattern* overwrites the mapping specified by the *flags* parameter.</span></span>

     <span data-ttu-id="dc18b-246">*ColPattern* でマッピングの種類 (属性中心、要素中心など) を指定できます。ここでの指定は、 *flags*による既定のマッピングを上書きしたり、拡張したりするものです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-246">*ColPattern* can be used to specify the type of mapping, such as attribute-centric or element-centric, that overwrites or enhances the default mapping indicated by the *flags*.</span></span>

     <span data-ttu-id="dc18b-247">*ColPattern* は次の場合に指定します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-247">*ColPattern* is specified under the following circumstances:</span></span>

    -   <span data-ttu-id="dc18b-248">行セット内の列名が、マップされる要素名または属性名と異なっている場合。</span><span class="sxs-lookup"><span data-stu-id="dc18b-248">The column name in the rowset is different from the element or attribute name to which it is mapped.</span></span> <span data-ttu-id="dc18b-249">このとき *ColPattern* は、行セットの列をマップする XML の要素名または属性名を特定するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-249">In this case, *ColPattern* is used to identify the XML element and attribute name to which the rowset column maps.</span></span>

    -   <span data-ttu-id="dc18b-250">メタプロパティ属性を列にマップする場合。</span><span class="sxs-lookup"><span data-stu-id="dc18b-250">You want to map a metaproperty attribute to the column.</span></span> <span data-ttu-id="dc18b-251">このとき *ColPattern* は、行セットの列をマップするメタプロパティを特定するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-251">In this case, *ColPattern* is used to identify the metaproperty to which the rowset column maps.</span></span> <span data-ttu-id="dc18b-252">メタプロパティの使用方法の詳細については、「 [OPENXML 内でのメタプロパティの指定](../xml/specify-metaproperties-in-openxml.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dc18b-252">For more information about how to use metaproperties, see [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span></span>

 <span data-ttu-id="dc18b-253">*flags* パラメーターと *ColPattern* パラメーターはどちらも省略できます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-253">Both the *flags* and *ColPattern* parameters are optional.</span></span> <span data-ttu-id="dc18b-254">マッピングの指定がない場合、属性中心のマッピングが想定されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-254">If no mapping is specified, attribute-centric mapping is assumed.</span></span> <span data-ttu-id="dc18b-255">属性中心のマッピングが、 *flags* パラメーターの既定値です。</span><span class="sxs-lookup"><span data-stu-id="dc18b-255">Attribute-centric mapping is the default value of the *flags* parameter.</span></span>

#### <a name="attribute-centric-mapping"></a><span data-ttu-id="dc18b-256">属性中心のマッピング</span><span class="sxs-lookup"><span data-stu-id="dc18b-256">Attribute-centric Mapping</span></span>
 <span data-ttu-id="dc18b-257">OPENXML の *flags* パラメーターを 1 (XML_ATTRIBUTES) に設定すると、 **属性中心** のマッピングが指定されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-257">Setting the *flags* parameter in OPENXML to 1 (XML_ATTRIBUTES) specifies **attribute-centric** mapping.</span></span> <span data-ttu-id="dc18b-258">*flags* に XML_ATTRIBUTES が含まれていると、公開される行セットで使用される行は、各 XML 要素が 1 行として表現されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-258">If *flags* contains XML_ ATTRIBUTES, the exposed rowset provides or consumes rows where each XML element is represented as a row.</span></span> <span data-ttu-id="dc18b-259">XML 属性は名前の対応を基に、SchemaDeclaration で定義した属性、または WITH 句の Tablename で指定した属性にマップされます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-259">The XML attributes are mapped to the attributes that are defined in the SchemaDeclaration or that are provided by the Tablename of the WITH clause, based on name correspondence.</span></span> <span data-ttu-id="dc18b-260">名前の対応とは、特定の名前の XML 属性が、行セット内の同名の列に格納されることを意味します。</span><span class="sxs-lookup"><span data-stu-id="dc18b-260">Name correspondence means that the XML attributes of a particular name are stored in a column in the rowset with the same name.</span></span>

 <span data-ttu-id="dc18b-261">列名がマップ先の属性名と異なっている場合は、 *ColPattern* を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dc18b-261">If the column name is different from the attribute name that it maps to, *ColPattern* must be specified.</span></span>

 <span data-ttu-id="dc18b-262">XML 属性に名前空間の修飾子がある場合は、行セット内の列名にも修飾子が必要です。</span><span class="sxs-lookup"><span data-stu-id="dc18b-262">If the XML attribute has a namespace qualifier, the column name in the rowset must also have the qualifier.</span></span>

#### <a name="element-centric-mapping"></a><span data-ttu-id="dc18b-263">要素中心のマッピング</span><span class="sxs-lookup"><span data-stu-id="dc18b-263">Element-centric Mapping</span></span>
 <span data-ttu-id="dc18b-264">OPENXML の *flags* パラメーターを 2 (XML_ELEMENTS) に設定すると、 **要素中心** のマッピングが指定されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-264">Setting the *flags* parameter in OPENXML to 2 (XML_ELEMENTS) specifies **element-centric** mapping.</span></span> <span data-ttu-id="dc18b-265">要素中心のマッピングは、次の相違点を除けば **属性中心** のマッピングと同じです。</span><span class="sxs-lookup"><span data-stu-id="dc18b-265">It is similar to **attribute-centric** mapping, except for the following differences:</span></span>

-   <span data-ttu-id="dc18b-266">列レベルのパターンが指定されていなければ、マッピングで通例行われる名前の対応 (同名の XML 要素への列のマッピング) によって、非複合サブ要素が選択されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-266">The name correspondence of the mapping example, a column mapping to an XML element with the same name chooses the noncomplex subelements, unless a column-level pattern is specified.</span></span> <span data-ttu-id="dc18b-267">取得のとき、サブ要素がさらにサブ要素を含んでいて複合型になっている場合、列は NULL に設定され、</span><span class="sxs-lookup"><span data-stu-id="dc18b-267">In the retrieval process, if the subelement is complex because it contains additional subelements, the column is set to NULL.</span></span> <span data-ttu-id="dc18b-268">含まれているサブ要素の属性値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-268">Attribute values of the subelements are then ignored.</span></span>

-   <span data-ttu-id="dc18b-269">同名のサブ要素が複数ある場合、最初のノードが返されます。</span><span class="sxs-lookup"><span data-stu-id="dc18b-269">For multiple subelements that have the same name, the first node is returned.</span></span>

## <a name="see-also"></a><span data-ttu-id="dc18b-270">参照</span><span class="sxs-lookup"><span data-stu-id="dc18b-270">See Also</span></span>
 <span data-ttu-id="dc18b-271">transact-sql&#41;[sp_xml_removedocument &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-removedocument-transact-sql) [OPENXML &#40;](/sql/t-sql/functions/openxml-transact-sql) transact-sql&#41;[xml データ &#40;](../xml/xml-data-sql-server.md) SQL Server&#41;[sp_xml_preparedocument &#40;transact-sql](/sql/relational-databases/system-stored-procedures/sp-xml-preparedocument-transact-sql)</span><span class="sxs-lookup"><span data-stu-id="dc18b-271">[sp_xml_preparedocument &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-preparedocument-transact-sql) [sp_xml_removedocument &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-removedocument-transact-sql) [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql) [XML Data &#40;SQL Server&#41;](../xml/xml-data-sql-server.md)</span></span>


