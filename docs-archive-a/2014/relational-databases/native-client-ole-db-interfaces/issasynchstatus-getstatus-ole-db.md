---
title: ISSAsynchStatus::GetStatus (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- ISSAsynchStatus::GetStatus (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- GetStatus method
ms.assetid: 354b6ee4-b5a1-48f6-9403-da3bdc911067
author: rothja
ms.author: jroth
ms.openlocfilehash: 14c20ae5d9a5cd31139db74aeedabb2d017f6ce6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87633128"
---
# <a name="issasynchstatusgetstatus-ole-db"></a><span data-ttu-id="b6138-102">ISSAsynchStatus::GetStatus (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b6138-102">ISSAsynchStatus::GetStatus (OLE DB)</span></span>
  <span data-ttu-id="b6138-103">非同期に実行されている操作の状態を返します。</span><span class="sxs-lookup"><span data-stu-id="b6138-103">Returns the status of an asynchronously executing operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="b6138-104">構文</span><span class="sxs-lookup"><span data-stu-id="b6138-104">Syntax</span></span>  
  
```  
  
HRESULT GetStatus(  
  HCHAPTER hChapter,  
  DBASYNCHOP eOperation,  
  DBCOUNTITEM *pulProgress,  
  DBCOUNTITEM *pulProgressMax,  
  DBASYNCHPHASE *peAsynchPhase,  
  LPOLESTR *ppwszStatusText);  
```  
  
## <a name="arguments"></a><span data-ttu-id="b6138-105">引数</span><span class="sxs-lookup"><span data-stu-id="b6138-105">Arguments</span></span>  
 <span data-ttu-id="b6138-106">*hChapter*[in]</span><span class="sxs-lookup"><span data-stu-id="b6138-106">*hChapter*[in]</span></span>  
 <span data-ttu-id="b6138-107">チャプター ハンドル。</span><span class="sxs-lookup"><span data-stu-id="b6138-107">The chapter handle.</span></span> <span data-ttu-id="b6138-108">ポーリングされているオブジェクトが行セット オブジェクトではないか、操作がチャプターに適用されない場合は、この引数を DB_NULL_HCHAPTER に設定する必要があります。プロバイダーでは、この設定が無視されます。</span><span class="sxs-lookup"><span data-stu-id="b6138-108">If the object being polled is not a rowset object or the operation does not apply to a chapter, this should be set to DB_NULL_HCHAPTER, which is ignored by the provider.</span></span>  
  
 <span data-ttu-id="b6138-109">*eOperation*[in]</span><span class="sxs-lookup"><span data-stu-id="b6138-109">*eOperation*[in]</span></span>  
 <span data-ttu-id="b6138-110">非同期状態が要求されている操作。</span><span class="sxs-lookup"><span data-stu-id="b6138-110">The operation for which the asynchronous status is being requested.</span></span> <span data-ttu-id="b6138-111">この引数には、</span><span class="sxs-lookup"><span data-stu-id="b6138-111">This should be the following value:</span></span>  
  
 <span data-ttu-id="b6138-112">DBASYNCHOP_OPEN - コンシューマーは、行セットを開くか行セットにデータを設定する非同期操作に関する情報、またはデータ ソース オブジェクトを初期化する非同期操作に関する情報を要求します。</span><span class="sxs-lookup"><span data-stu-id="b6138-112">DBASYNCHOP_OPEN-The consumer requests information about the asynchronous opening or population of a rowset or about the asynchronous initialization of a data source object.</span></span> <span data-ttu-id="b6138-113">プロバイダーが URL の直接バインドをサポートする OLE DB 2.5 に準拠したプロバイダーの場合、コンシューマーは、データ ソース、行セット、行、またはストリーム オブジェクトの初期化やデータ設定の非同期操作に関する情報を要求します。</span><span class="sxs-lookup"><span data-stu-id="b6138-113">If the provider is an OLE DB 2.5-compliant provider that supports direct URL binding, the consumer requests information about the asynchronous initialization or population of a data source, rowset, row, or stream object.</span></span>  
  
 <span data-ttu-id="b6138-114">*pulProgress*[out]</span><span class="sxs-lookup"><span data-stu-id="b6138-114">*pulProgress*[out]</span></span>  
 <span data-ttu-id="b6138-115">*pulProgressMax* パラメーターで示される予想最大値と比較した、現在の非同期操作の進行状況を返すメモリへのポインター。</span><span class="sxs-lookup"><span data-stu-id="b6138-115">A pointer to memory in which to return the current progress of the asynchronous operation relative to the expected maximum indicated in the *pulProgressMax* parameter.</span></span> <span data-ttu-id="b6138-116">*pulProgress* の詳細については、*peAsynchPhase* の説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6138-116">For more information about the meaning of *pulProgress*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="b6138-117">*pulProgress* に NULL ポインターを指定すると、進行状況は返されません。</span><span class="sxs-lookup"><span data-stu-id="b6138-117">If *pulProgress* is a null pointer, no progress is returned.</span></span>  
  
 <span data-ttu-id="b6138-118">*pulProgressMax*[out]</span><span class="sxs-lookup"><span data-stu-id="b6138-118">*pulProgressMax*[out]</span></span>  
 <span data-ttu-id="b6138-119">*pulProgress* パラメーターの予想最大値を返すメモリへのポインター。</span><span class="sxs-lookup"><span data-stu-id="b6138-119">A pointer to memory in which to return the expected maximum value of the *pulProgress* parameter.</span></span> <span data-ttu-id="b6138-120">この値は、このメソッドを呼び出すたびに変化することがあります。</span><span class="sxs-lookup"><span data-stu-id="b6138-120">This value may change across calls to this method.</span></span> <span data-ttu-id="b6138-121">*pulProgressMax* の詳細については、*peAsynchPhase* の説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b6138-121">For more information about the meaning of *pulProgressMax*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="b6138-122">*pulProgressMax* に NULL ポインターを指定すると、予想最大値は返されません。</span><span class="sxs-lookup"><span data-stu-id="b6138-122">If *pulProgressMax* is a null pointer, no expected maximum value is returned.</span></span>  
  
 <span data-ttu-id="b6138-123">*peAsynchPhase*[out]</span><span class="sxs-lookup"><span data-stu-id="b6138-123">*peAsynchPhase*[out]</span></span>  
 <span data-ttu-id="b6138-124">非同期操作の進行状況に関する詳細情報を返すメモリへのポインター。</span><span class="sxs-lookup"><span data-stu-id="b6138-124">A pointer to memory in which to return additional information regarding the progress of the asynchronous operation.</span></span> <span data-ttu-id="b6138-125">有効な値は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b6138-125">Valid values include:</span></span>  
  
 <span data-ttu-id="b6138-126">DBASYNCHPHASE_INITIALIZATION - オブジェクトは初期化フェーズにあります。</span><span class="sxs-lookup"><span data-stu-id="b6138-126">DBASYNCHPHASE_INITIALIZATION-The object is in an initialization phase.</span></span> <span data-ttu-id="b6138-127">引数 *pulProgress* と *pulProgressMax* は、完了の推定比率を示します。</span><span class="sxs-lookup"><span data-stu-id="b6138-127">The arguments *pulProgress* and *pulProgressMax* indicate an estimated ratio of completion.</span></span> <span data-ttu-id="b6138-128">オブジェクトはまだ完全に具体化されていません。</span><span class="sxs-lookup"><span data-stu-id="b6138-128">The object is not yet fully materialized.</span></span> <span data-ttu-id="b6138-129">そのため、他のインターフェイスの呼び出しを試みると失敗したり、このオブジェクトのすべてのインターフェイスを使用できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="b6138-129">Attempting to call any other interfaces may fail, and the full set of interfaces may not be available on the object.</span></span> <span data-ttu-id="b6138-130">行を更新、削除、または挿入するコマンドに対して **ICommand::Execute** を呼び出すことにより非同期操作が実行された場合、および *cParamSets* が 1 より大きい場合、*pulProgress* と *pulProgressMax* は、パラメーターの 1 つのセットの進行状況か、パラメーター セットの配列全体の進行状況を示します。</span><span class="sxs-lookup"><span data-stu-id="b6138-130">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows and if *cParamSets* is greater than 1, *pulProgress* and *pulProgressMax* may indicate the progress for a single set of parameters or for the full array of parameter sets.</span></span>  
  
 <span data-ttu-id="b6138-131">DBASYNCHPHASE_POPULATION - オブジェクトは作成フェーズにあります。</span><span class="sxs-lookup"><span data-stu-id="b6138-131">DBASYNCHPHASE_POPULATION-The object is in a population phase.</span></span> <span data-ttu-id="b6138-132">行セットは完全に初期化されていて、オブジェクトのすべてのインターフェイスを使用できますが、まだ行セットに追加されていない行が存在する場合があります。</span><span class="sxs-lookup"><span data-stu-id="b6138-132">Although the rowset is fully initialized and the full range of interfaces is available on the object, there may be additional rows not yet populated into the rowset.</span></span> <span data-ttu-id="b6138-133">*pulProgress* と *pulProgressMax* は、設定した行数に基づくこともできますが、通常は、行セットの設定に必要な時間または作業に基づきます。</span><span class="sxs-lookup"><span data-stu-id="b6138-133">While *pulProgress* and *pulProgressMax* can be based on the number of rows populated, they are generally based on the time or effort required to populate the rowset.</span></span> <span data-ttu-id="b6138-134">そのため、呼び出し元では最終的な行数ではなく、処理にかかる時間の大まかな推定値としてこの情報を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6138-134">A caller should therefore use this information as a rough estimate of how long the process might take, not the eventual row count.</span></span> <span data-ttu-id="b6138-135">このフェーズが返されるのは、行セットの設定中のみです。データ ソース オブジェクトの初期化中や、行を更新、削除、または挿入するコマンドの実行により返されることはありません。</span><span class="sxs-lookup"><span data-stu-id="b6138-135">This phase is returned only during population of a rowset; it is never returned in the initialization of a data source object or by the execution of a command that updates, deletes, or inserts rows.</span></span>  
  
 <span data-ttu-id="b6138-136">DBASYNCHPHASE_COMPLETE - オブジェクトのすべての非同期処理が完了しました。</span><span class="sxs-lookup"><span data-stu-id="b6138-136">DBASYNCHPHASE_COMPLETE-All asynchronous processing of the object has completed.</span></span> <span data-ttu-id="b6138-137">**ISSAsynchStatus:: GetStatus**は、操作の結果を示す HRESULT を返します。</span><span class="sxs-lookup"><span data-stu-id="b6138-137">**ISSAsynchStatus::GetStatus** returns an HRESULT indicating the outcome of the operation.</span></span> <span data-ttu-id="b6138-138">通常、この HRESULT は、同期をとって操作を呼び出した場合に返される HRESULT です。</span><span class="sxs-lookup"><span data-stu-id="b6138-138">Typically, this will be the HRESULT that would have been returned had the operation been called synchronously.</span></span> <span data-ttu-id="b6138-139">行を更新、削除、または挿入するコマンドに対して **ICommand::Execute** を呼び出すことにより非同期操作が実行された場合、*pulProgress* と *pulProgressMax* は、そのコマンドで処理された行の合計数と等しくなります。</span><span class="sxs-lookup"><span data-stu-id="b6138-139">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* and *pulProgressMax* are equal to the total number of rows affected by the command.</span></span> <span data-ttu-id="b6138-140">*cParamSets* が 1 より大きい場合、この値は、コマンドの実行で指定したすべてのパラメーター セットによって処理された行の合計数になります。</span><span class="sxs-lookup"><span data-stu-id="b6138-140">If *cParamSets* is greater than 1, this is the total number of rows affected by all of the sets of parameters specified in the execution.</span></span> <span data-ttu-id="b6138-141">*peAsynchPhase* に NULL ポインターを指定すると、状態コードは返されません。</span><span class="sxs-lookup"><span data-stu-id="b6138-141">If *peAsynchPhase* is a null pointer, no status code is returned.</span></span>  
  
 <span data-ttu-id="b6138-142">DBASYNCHPHASE_CANCELED - オブジェクトの非同期処理が中止されました。</span><span class="sxs-lookup"><span data-stu-id="b6138-142">DBASYNCHPHASE_CANCELED-Asynchronous processing of the object was aborted.</span></span> <span data-ttu-id="b6138-143">**ISSAsynchStatus:: GetStatus は**DB_E_CANCELED を返します。</span><span class="sxs-lookup"><span data-stu-id="b6138-143">**ISSAsynchStatus::GetStatus** returns DB_E_CANCELED.</span></span> <span data-ttu-id="b6138-144">行を更新、削除、または挿入するコマンドに対して **ICommand::Execute** を呼び出すことにより非同期操作が実行された場合、*pulProgress* は、そのコマンドに指定したすべてのパラメーター セットによってキャンセル前に処理された行の合計数と等しくなります。</span><span class="sxs-lookup"><span data-stu-id="b6138-144">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* is equal to the total number of rows, for all parameter sets, affected by the command prior to cancellation.</span></span>  
  
 <span data-ttu-id="b6138-145">*ppwszStatusText*[in/out]</span><span class="sxs-lookup"><span data-stu-id="b6138-145">*ppwszStatusText*[in/out]</span></span>  
 <span data-ttu-id="b6138-146">操作に関する詳細情報を保持するメモリへのポインター。</span><span class="sxs-lookup"><span data-stu-id="b6138-146">A pointer to memory containing additional information about the operation.</span></span> <span data-ttu-id="b6138-147">プロバイダーは、この値を使用して操作の異なる要素 (アクセス中のさまざまなリソースなど) を区別できます。</span><span class="sxs-lookup"><span data-stu-id="b6138-147">A provider may use this value to distinguish between different elements of an operation-for example, different resources being accessed.</span></span> <span data-ttu-id="b6138-148">この文字列は、データ ソース オブジェクトの DBPROP_INIT_LCID プロパティに従ってローカライズされます。</span><span class="sxs-lookup"><span data-stu-id="b6138-148">This string is localized according to the DBPROP_INIT_LCID property on the data source object.</span></span>  
  
 <span data-ttu-id="b6138-149">*ppwszStatusText* の入力値が NULL 以外の場合、プロバイダーは *ppwszStatusText* で識別される特定の要素に関連する状態を返します。</span><span class="sxs-lookup"><span data-stu-id="b6138-149">If *ppwszStatusText* is non-null on input, the provider returns status associated with the particular element identified by *ppwszStatusText*.</span></span> <span data-ttu-id="b6138-150">*ppwszStatusText* が *eOperation* の要素を示していない場合、*pulProgress* と *pulProgressMax* に同じ値を設定して S_OK を返します。</span><span class="sxs-lookup"><span data-stu-id="b6138-150">If *ppwszStatusText* does not indicate an element of *eOperation*, the provider returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="b6138-151">プロバイダーでテキスト識別子に基づいて要素を区別しない場合、*ppwszStatusText* に NULL を設定し、操作全体に関する情報を返します。要素を区別する場合、*ppwszStatusText* の入力値が NULL 以外であると、プロバイダーでは *ppwszStatusText* が処理されなくなります。</span><span class="sxs-lookup"><span data-stu-id="b6138-151">If the provider does not distinguish between elements based on a textual identifier, it sets *ppwszStatusText* to NULL and returns information about the operation as a whole; otherwise, if *ppwszStatusText* is non-null on input, the provider leaves *ppwszStatusText* untouched.</span></span>  
  
 <span data-ttu-id="b6138-152">入力時に*ppwszStatusText*が null の場合、プロバイダーは*ppwszStatusText*を、操作に関する詳細情報を示す値に設定します。このような情報が使用できない場合、または**ISSAsynchStatus:: GetStatus**がエラーを返す場合は null に設定します。</span><span class="sxs-lookup"><span data-stu-id="b6138-152">If *ppwszStatusText* is null on input, the provider sets *ppwszStatusText* to a value indicating more information about the operation, or to NULL if no such information is available or if **ISSAsynchStatus::GetStatus** returns an error.</span></span> <span data-ttu-id="b6138-153">*ppwszStatusText* の入力値が NULL の場合、状態文字列用のメモリを割り当て、そのメモリのアドレスを返します。</span><span class="sxs-lookup"><span data-stu-id="b6138-153">When *ppwszStatusText* is null on input, the provider allocates memory for the status string and returns the address to this memory.</span></span> <span data-ttu-id="b6138-154">コンシューマーでは、この文字列が不要になった時点で、**IMalloc::Free** を使用してこのメモリを解放します。</span><span class="sxs-lookup"><span data-stu-id="b6138-154">The consumer releases this memory with **IMalloc::Free** when it no longer needs the string.</span></span>  
  
 <span data-ttu-id="b6138-155">*ppwszStatusText* の入力値が NULL の場合、状態文字列は返されず、操作の要素に関する情報か、操作の概要情報が返されます。</span><span class="sxs-lookup"><span data-stu-id="b6138-155">If *ppwszStatusText* is NULL on input, no status string is returned and the provider returns information about any element of the operation or about the operation in general.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="b6138-156">リターン コードの値</span><span class="sxs-lookup"><span data-stu-id="b6138-156">Return Code Values</span></span>  
 <span data-ttu-id="b6138-157">S_OK</span><span class="sxs-lookup"><span data-stu-id="b6138-157">S_OK</span></span>  
 <span data-ttu-id="b6138-158">メソッドから正常に値が返されました。</span><span class="sxs-lookup"><span data-stu-id="b6138-158">The method returned successfully.</span></span>  
  
-   <span data-ttu-id="b6138-159">*peAsynchPhase* が DBASYNCHPHASE_INITIALIZATION の場合、オブジェクトはまだ完全に初期化されていません。そのため、他のインターフェイスの呼び出しを試みると失敗したり、このオブジェクトのすべてのインターフェイスを使用できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="b6138-159">If *peAsynchPhase* is equal to DBASYNCHPHASE_INITIALIZATION, the object is not yet fully initialized; attempting to call any other interfaces might fail, and the full set of interfaces might not be available on the object.</span></span>  
  
-   <span data-ttu-id="b6138-160">*peAsynchPhase* が DBASYNCHPHASE_POPULATION の場合、行セットは完全に初期化されていて、オブジェクトのすべてのインターフェイスを使用できますが、まだ行セットに追加されていない行が存在する場合があります。</span><span class="sxs-lookup"><span data-stu-id="b6138-160">If *peAsynchPhase* is equal to DBASYNCHPHASE_POPULATION, the rowset is fully initialized and the full range of interfaces is available on the object; however, there might be additional rows not yet populated into the rowset.</span></span>  
  
-   <span data-ttu-id="b6138-161">*peAsynchPhase* が DBASYNCHPHASE_COMPLETE の場合、オブジェクトのすべての非同期操作は完了しています。</span><span class="sxs-lookup"><span data-stu-id="b6138-161">If *peAsynchPhase* is equal to DBASYNCHPHASE_COMPLETE, all asynchronous processing of the object has completed.</span></span> <span data-ttu-id="b6138-162">オブジェクトは、完全に初期化され、データが設定されています。</span><span class="sxs-lookup"><span data-stu-id="b6138-162">The object is fully initialized and populated.</span></span>  
  
 <span data-ttu-id="b6138-163">DB_E_CANCELED</span><span class="sxs-lookup"><span data-stu-id="b6138-163">DB_E_CANCELED</span></span>  
 <span data-ttu-id="b6138-164">行セットの設定中に非同期操作が取り消されたことを示します。</span><span class="sxs-lookup"><span data-stu-id="b6138-164">Asynchronous processing was canceled during rowset population.</span></span> <span data-ttu-id="b6138-165">この場合、データ設定操作は停止されますが、既に設定した行セットの行は有効なままです。</span><span class="sxs-lookup"><span data-stu-id="b6138-165">Population stops, but the rowset remains valid for the rows already populated.</span></span>  
  
 <span data-ttu-id="b6138-166">また、データ ソース オブジェクトの初期化中に非同期処理が取り消されたことを示している場合もあります。</span><span class="sxs-lookup"><span data-stu-id="b6138-166">Asynchronous processing was canceled during data source object initialization.</span></span> <span data-ttu-id="b6138-167">この場合、データ ソース オブジェクトは初期化されていない状態です。</span><span class="sxs-lookup"><span data-stu-id="b6138-167">The data source object is in an uninitialized state.</span></span>  
  
 <span data-ttu-id="b6138-168">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="b6138-168">E_INVALIDARG</span></span>  
 <span data-ttu-id="b6138-169">*hChapter* パラメーターが正しくありません。</span><span class="sxs-lookup"><span data-stu-id="b6138-169">The *hChapter* parameter is incorrect.</span></span>  
  
 <span data-ttu-id="b6138-170">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="b6138-170">E_UNEXPECTED</span></span>  
 <span data-ttu-id="b6138-171">データソースオブジェクトに対して**ISSAsynchStatus:: GetStatus**が呼び出されましたが、 **IDBInitialize:: Initialize**はデータソースオブジェクトで呼び出されていません。</span><span class="sxs-lookup"><span data-stu-id="b6138-171">**ISSAsynchStatus::GetStatus** was called on a data source object, and **IDBInitialize::Initialize** has not been called on the data source object.</span></span>  
  
 <span data-ttu-id="b6138-172">**ISSAsynchStatus:: GetStatus**が行セットで呼び出されました。 **Itransaction:: Commit**または**itransaction:: Abort**が呼び出されましたが、オブジェクトはゾンビ状態です。</span><span class="sxs-lookup"><span data-stu-id="b6138-172">**ISSAsynchStatus::GetStatus** was called on a rowset, **ITransaction::Commit** or **ITransaction::Abort** was called, and the object is in a zombie state.</span></span>  
  
 <span data-ttu-id="b6138-173">初期化フェーズで非同期に取り消された行セットで**ISSAsynchStatus:: GetStatus**が呼び出されました。</span><span class="sxs-lookup"><span data-stu-id="b6138-173">**ISSAsynchStatus::GetStatus** was called on a rowset that was asynchronously canceled in its initialization phase.</span></span> <span data-ttu-id="b6138-174">行セットはゾンビ状態になります。</span><span class="sxs-lookup"><span data-stu-id="b6138-174">The rowset is in a zombie state.</span></span>  
  
 <span data-ttu-id="b6138-175">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="b6138-175">E_FAIL</span></span>  
 <span data-ttu-id="b6138-176">プロバイダー固有のエラーが発生しました。</span><span class="sxs-lookup"><span data-stu-id="b6138-176">A provider-specific error occurred.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="b6138-177">解説</span><span class="sxs-lookup"><span data-stu-id="b6138-177">Remarks</span></span>  
 <span data-ttu-id="b6138-178">**ISSAsynchStatus::GetStatus** メソッドの動作は、**IDBAsynchStatus::GetStatus** メソッドとまったく同じです。ただし、データ ソース オブジェクトの初期化が中止された場合は、DB_E_CANCELED ではなく E_UNEXPECTED が返されます ([ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) の場合は DB_E_CANCELED が返されます)。</span><span class="sxs-lookup"><span data-stu-id="b6138-178">The **ISSAsynchStatus::GetStatus** method behaves exactly as the **IDBAsynchStatus::GetStatus** method except that if initialization of a data source object is aborted, E_UNEXPECTED is returned rather than DB_E_CANCELED (although [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) will return DB_E_CANCELED).</span></span> <span data-ttu-id="b6138-179">これは、初期化の中止後、追加の初期化操作が試行される場合に備えて、データ ソース オブジェクトの状態が通常のゾンビ状態のままにならないためです。</span><span class="sxs-lookup"><span data-stu-id="b6138-179">This is because the data source object is not left in the usual zombie state following an abort, in order that further initialization operations may be attempted.</span></span>  
  
 <span data-ttu-id="b6138-180">行セットを初期化またはデータ設定する非同期操作では、このメソッドをサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b6138-180">If the rowset is initialized or populated asynchronously, it must support this method.</span></span>  
  
 <span data-ttu-id="b6138-181">**ISSAsynchStatus::GetStatus** では、上記の戻り値に加えて、非同期操作を開始するメソッドから返されることになる、操作の成功または失敗を示す HRESULT を返すことができます。</span><span class="sxs-lookup"><span data-stu-id="b6138-181">In addition to the return values listed, **ISSAsynchStatus::GetStatus** can return any HRESULT that would have been returned by the method that initiated the asynchronous operation, indicating the success or failure of the operation.</span></span>  
  
 <span data-ttu-id="b6138-182">一部の非同期操作では、"完了" または "未完了" 以外の状態を返すことができません。</span><span class="sxs-lookup"><span data-stu-id="b6138-182">Some asynchronous operations might not be able to return any states other than "finished" and "not finished".</span></span> <span data-ttu-id="b6138-183">これらの操作では、*pulProgressMax* の値を 1 に設定する必要があります。これにより、推定値の粒度がすべて完了したか、まったく処理されていないかの状態になるので、0/1 または 1/1 が返されます。</span><span class="sxs-lookup"><span data-stu-id="b6138-183">They should set *pulProgressMax* to a value of 1, indicating the all-or-nothing granularity of their estimate, so their answers would be either 0/1 or 1/1.</span></span>  
  
 <span data-ttu-id="b6138-184">プロバイダーでは、タスクの完了の度合いに応じて推定値が向上する場合、これを *pulProgressMax* に反映して、連続した呼び出しでこの値が変化したり、場合のよっては前回よりも少ない比率を返すこともあります。</span><span class="sxs-lookup"><span data-stu-id="b6138-184">A provider may change *pulProgressMax* in successive calls and even return a smaller ratio than previously, if this reflects an improving estimate of the degree of completion of the task.</span></span>  
  
 <span data-ttu-id="b6138-185">プロバイダーは、より正確な値を保証することが義務付けられているわけではありませんが、可能な場合は妥当な推定完了率を返すように設定されています。</span><span class="sxs-lookup"><span data-stu-id="b6138-185">The provider is not obliged to guarantee any further accuracy but is encouraged to do so in cases where reasonable estimates of completion are possible.</span></span> <span data-ttu-id="b6138-186">この関数の主な目的は、ユーザーへの進行状況のフィードバックを提供することなので、このような動作によりユーザー インターフェイスの品質が向上します。</span><span class="sxs-lookup"><span data-stu-id="b6138-186">Such efforts will improve user-interface quality because the main use of this function is likely to be to give progress feedback to the user.</span></span> <span data-ttu-id="b6138-187">非表示で行われる、実行時間が長いタスクに対するフィードバックの品質を向上することで、ユーザーの満足度も向上します。</span><span class="sxs-lookup"><span data-stu-id="b6138-187">User satisfaction increases with the quality of feedback on an invisible, long-running task.</span></span>  
  
 <span data-ttu-id="b6138-188">初期化されたデータ ソース オブジェクトまたはデータが設定された行セットに対して **ISSAsynchStatus::GetStatus** を呼び出すか、*eOperation* に DBASYNCHOP_OPEN 以外の値を渡すと、*pulProgress* と *pulProgressMax* に同じ値が設定され、S_OK が返されます。</span><span class="sxs-lookup"><span data-stu-id="b6138-188">Calling **ISSAsynchStatus::GetStatus** on an initialized data source object or a populated rowset, or passing a value for *eOperation* other than DBASYNCHOP_OPEN, returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="b6138-189">行を更新、削除、または挿入するコマンドの実行によって作成されたオブジェクトに対して**ISSAsynchStatus:: GetStatus**が呼び出された場合 *、両方と*も、すべてのコマンドの影響を受ける行の総数*を示します*。</span><span class="sxs-lookup"><span data-stu-id="b6138-189">If **ISSAsynchStatus::GetStatus** is called on an object created from the execution of a command that updates, deletes, or inserts rows, both *pulProgress* and *pulProgressMax* indicate the total number of rows affected by the command.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b6138-190">参照</span><span class="sxs-lookup"><span data-stu-id="b6138-190">See Also</span></span>  
 <span data-ttu-id="b6138-191">[非同期操作の実行](../native-client/features/performing-asynchronous-operations.md) </span><span class="sxs-lookup"><span data-stu-id="b6138-191">[Performing Asynchronous Operations](../native-client/features/performing-asynchronous-operations.md) </span></span>  
 [<span data-ttu-id="b6138-192">ISSAsynchStatus &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="b6138-192">ISSAsynchStatus &#40;OLE DB&#41;</span></span>](issasynchstatus-ole-db.md)  
  
  
