---
title: IBCPSession::BCPControl (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPControl (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPControl method
ms.assetid: d58f3fe1-45e3-4e46-8e9c-000971829d99
author: rothja
ms.author: jroth
ms.openlocfilehash: a3de4d0a942d29f18752374b4020fbfd19aa15ec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/04/2020
ms.locfileid: "87739817"
---
# <a name="ibcpsessionbcpcontrol-ole-db"></a><span data-ttu-id="252f7-102">IBCPSession::BCPControl (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="252f7-102">IBCPSession::BCPControl (OLE DB)</span></span>
  <span data-ttu-id="252f7-103">一括コピー操作のオプションを設定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-103">Sets the options for a bulk-copy operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="252f7-104">構文</span><span class="sxs-lookup"><span data-stu-id="252f7-104">Syntax</span></span>  
  
```  
  
HRESULT BCPControl(   
inteOption,  
void *iValue);  
```  
  
## <a name="remarks"></a><span data-ttu-id="252f7-105">解説</span><span class="sxs-lookup"><span data-stu-id="252f7-105">Remarks</span></span>  
 <span data-ttu-id="252f7-106">**BCPControl** メソッドでは、一括コピー操作のさまざまな制御パラメーターを設定します。たとえば、一括コピーが取り消されるまでに発生してもかまわないエラーの数、データ ファイルから最初にコピーする行番号や最後にコピーする行番号、バッチ サイズなどを設定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-106">The **BCPControl** method sets various control parameters for bulk-copy operations including the number of errors allowed before canceling a bulk copy, the numbers of the first and last rows to copy from a data file, and the batch size.</span></span>  
  
 <span data-ttu-id="252f7-107">また、このメソッドを使用して、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] からデータを一括コピーするときに使用される SELECT ステートメントを指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="252f7-107">This method is also used to specify the SELECT statement to use when bulk copying data out from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="252f7-108">`eOption`引数を BCP_OPTION_HINTS および引数に設定して、 `iValue` SELECT ステートメントを含むワイド文字列へのポインターを持つことができます。</span><span class="sxs-lookup"><span data-stu-id="252f7-108">You can set the `eOption` argument to BCP_OPTION_HINTS and `iValue` argument to have a pointer to a wide character string containing the SELECT statement.</span></span>  
  
 <span data-ttu-id="252f7-109">*eOption* に指定できる値:</span><span class="sxs-lookup"><span data-stu-id="252f7-109">Possible values for *eOption* are:</span></span>  
  
|<span data-ttu-id="252f7-110">オプション</span><span class="sxs-lookup"><span data-stu-id="252f7-110">Option</span></span>|<span data-ttu-id="252f7-111">説明</span><span class="sxs-lookup"><span data-stu-id="252f7-111">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="252f7-112">BCP_OPTION_ABORT</span><span class="sxs-lookup"><span data-stu-id="252f7-112">BCP_OPTION_ABORT</span></span>|<span data-ttu-id="252f7-113">既に実行中の一括コピー操作を停止します。</span><span class="sxs-lookup"><span data-stu-id="252f7-113">Stops a bulk-copy operation that is already in progress.</span></span> <span data-ttu-id="252f7-114">別のスレッドから *eOption* 引数に BCP_OPTION_ABORT を指定して **BCPControl** メソッドを呼び出し、実行中の一括コピー操作を停止できます。</span><span class="sxs-lookup"><span data-stu-id="252f7-114">You can call the **BCPControl** method with an *eOption* argument of BCP_OPTION_ABORT from another thread to stop a running bulk-copy operation.</span></span> <span data-ttu-id="252f7-115">*iValue* 引数は無視されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-115">The *iValue* argument is ignored.</span></span>|  
|<span data-ttu-id="252f7-116">BCP_OPTION_BATCH</span><span class="sxs-lookup"><span data-stu-id="252f7-116">BCP_OPTION_BATCH</span></span>|<span data-ttu-id="252f7-117">バッチごとの行数を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-117">The number of rows per batch.</span></span> <span data-ttu-id="252f7-118">既定値は 0 です。これは、データを抽出するときはテーブル内のすべての行が抽出されることを示し、データを [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] にコピーするときはユーザー データ ファイル内のすべての行がコピーされることを示します。</span><span class="sxs-lookup"><span data-stu-id="252f7-118">The default is 0, which indicates all rows in a table when data is being extracted, or all rows in the user data file when data is being copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="252f7-119">BCP_OPTION_BATCH に 1 未満の値を指定すると、既定値にリセットされます。</span><span class="sxs-lookup"><span data-stu-id="252f7-119">A value less than 1 resets BCP_OPTION_BATCH to the default.</span></span>|  
|<span data-ttu-id="252f7-120">BCP_OPTION_DELAYREADFMT</span><span class="sxs-lookup"><span data-stu-id="252f7-120">BCP_OPTION_DELAYREADFMT</span></span>|<span data-ttu-id="252f7-121">ブール値を設定します。true に設定した場合、[IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) により実行時に読み取りが行われます。</span><span class="sxs-lookup"><span data-stu-id="252f7-121">A Boolean, if set to true, will cause [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) to read at execution.</span></span> <span data-ttu-id="252f7-122">false (既定値) の場合、IBCPSession::BCPReadFmt により直ちにフォーマット ファイルの読み取りが行われます。</span><span class="sxs-lookup"><span data-stu-id="252f7-122">If false (the default), IBCPSession::BCPReadFmt will immediately read the format file.</span></span> <span data-ttu-id="252f7-123">が true の場合、 `BCP_OPTION_DELAYREADFMT` IBCPSession:: BCPColumns または IBCPSession:: BCPColFmt を呼び出すと、シーケンスエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="252f7-123">A sequence error will occur if `BCP_OPTION_DELAYREADFMT` is true and you call IBCPSession::BCPColumns or IBCPSession::BCPColFmt.</span></span><br /><br /> <span data-ttu-id="252f7-124">`IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` および IBCPSession::BCPWriteFmt を呼び出した後に `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` を呼び出した場合にもシーケンス エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="252f7-124">A sequence error will also occur if you call `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` after calling `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` and IBCPSession::BCPWriteFmt.</span></span><br /><br /> <span data-ttu-id="252f7-125">詳細については、「[メタデータの検出](../native-client/features/metadata-discovery.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="252f7-125">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>|  
|<span data-ttu-id="252f7-126">BCP_OPTION_FILECP</span><span class="sxs-lookup"><span data-stu-id="252f7-126">BCP_OPTION_FILECP</span></span>|<span data-ttu-id="252f7-127">*iValue* 引数には、データ ファイルのコード ページ番号が含まれます。</span><span class="sxs-lookup"><span data-stu-id="252f7-127">The *iValue* argument contains the number of the code page for the data file.</span></span> <span data-ttu-id="252f7-128">1252 や 850 などのコード ページ番号を指定するか、次のいずれかの値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="252f7-128">You can specify the number of the code page, such as 1252 or 850, or one of the following values:</span></span><br /><br /> <span data-ttu-id="252f7-129">-BCP_FILECP_ACP: ファイル内のデータは Microsoft Windows にありますか?</span><span class="sxs-lookup"><span data-stu-id="252f7-129">-   BCP_FILECP_ACP: data in the file is in the Microsoft Windows??</span></span> <span data-ttu-id="252f7-130">クライアントのコードページ。</span><span class="sxs-lookup"><span data-stu-id="252f7-130">code page of the client.</span></span><br /><span data-ttu-id="252f7-131">-BCP_FILECP_OEMCP: ファイル内のデータは、クライアントの OEM コードページ (既定) に含まれています。</span><span class="sxs-lookup"><span data-stu-id="252f7-131">-   BCP_FILECP_OEMCP: data in the file is in the OEM code page of the client (default).</span></span><br /><span data-ttu-id="252f7-132">-BCP_FILECP_RAW: ファイル内のデータは、のコードページにあり [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="252f7-132">-   BCP_FILECP_RAW: data in the file is in the code page of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="252f7-133">BCP_OPTION_FILEFMT</span><span class="sxs-lookup"><span data-stu-id="252f7-133">BCP_OPTION_FILEFMT</span></span>|<span data-ttu-id="252f7-134">データ ファイル形式のバージョン番号を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-134">The version number of the data file format.</span></span> <span data-ttu-id="252f7-135">80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)])、90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)])、100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] または [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)])、110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)])、または 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]) を指定できます。</span><span class="sxs-lookup"><span data-stu-id="252f7-135">This can be 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]), or 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="252f7-136">120 が既定値です。</span><span class="sxs-lookup"><span data-stu-id="252f7-136">120 is the default.</span></span> <span data-ttu-id="252f7-137">このオプションは、以前のバージョンのサーバーでサポートされていた形式でデータをエクスポートおよびインポートする際に便利です。</span><span class="sxs-lookup"><span data-stu-id="252f7-137">This is useful for exporting and importing data in formats that were supported by earlier version of the server.</span></span>  <span data-ttu-id="252f7-138">たとえば、[!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] サーバーのテキスト列から取得したデータを、[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以降のサーバーの **varchar(max)** 列にインポートするには、80 を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="252f7-138">For example, to import data obtained from a text column in a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server into a **varchar(max)** column in a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later server, you should specify 80.</span></span> <span data-ttu-id="252f7-139">同様に、データを **varchar(max)** 列からエクスポートするときに 80 を指定すると、データは、テキスト列が [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] 形式で保存されるのと同じように保存されるので、[!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] サーバーのテキスト列にインポートできます。</span><span class="sxs-lookup"><span data-stu-id="252f7-139">Similarly, if you specify 80 while exporting data from a **varchar(max)** column, it will be saved just like text columns are saved in the [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] format, and can be imported into a text column of a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server.</span></span>|  
|<span data-ttu-id="252f7-140">BCP_OPTION_FIRST</span><span class="sxs-lookup"><span data-stu-id="252f7-140">BCP_OPTION_FIRST</span></span>|<span data-ttu-id="252f7-141">ファイルまたはテーブルにコピーするデータの先頭行を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-141">The first row of data of the file or table to copy.</span></span> <span data-ttu-id="252f7-142">既定値は 1 です。1 未満の値を指定すると、このオプションは既定値にリセットされます。</span><span class="sxs-lookup"><span data-stu-id="252f7-142">The default is 1; a value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="252f7-143">BCP_OPTION_FIRSTEX</span><span class="sxs-lookup"><span data-stu-id="252f7-143">BCP_OPTION_FIRSTEX</span></span>|<span data-ttu-id="252f7-144">BCP out 操作の場合は、データ ファイルにコピーするための、データベース テーブルの最初の行を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-144">For BCP out operations, specifies the first row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="252f7-145">BCP in 操作の場合は、データベース テーブルにコピーするための、データ ファイルの最初の行を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-145">For BCP in operations, specifies the first row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="252f7-146">*iValue* パラメーターには、その値を含む 64 ビット符号付き整数のアドレスを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="252f7-146">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="252f7-147">BCPFIRSTEX に渡すことができる最大値は 2^63-1 です。</span><span class="sxs-lookup"><span data-stu-id="252f7-147">The maximum value that can be passed to BCPFIRSTEX 2^63-1.</span></span>|  
|<span data-ttu-id="252f7-148">BCP_OPTION_FMTXML</span><span class="sxs-lookup"><span data-stu-id="252f7-148">BCP_OPTION_FMTXML</span></span>|<span data-ttu-id="252f7-149">XML 形式でフォーマット ファイルが生成されることを指定する場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="252f7-149">Used to specify that the format file generated should be in an XML format.</span></span> <span data-ttu-id="252f7-150">既定では、このオプションは無効で、フォーマット ファイルはテキスト ファイルとして保存されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-150">It is off by default and by default the format files are saved as text files.</span></span> <span data-ttu-id="252f7-151">XML フォーマット ファイルにより柔軟性が向上しますが、いくつか制約も追加されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-151">The XML format file provides greater flexibility but with some added constraints.</span></span> <span data-ttu-id="252f7-152">たとえば、以前のフォーマット ファイルでは、1 つのフィールドにプレフィックスとターミネータを同時に指定できましたが、XML フォーマット ファイルでは指定できません。</span><span class="sxs-lookup"><span data-stu-id="252f7-152">For example, you can not specify the prefix and terminator for a field simultaneously which is possible in older format files.</span></span> <span data-ttu-id="252f7-153">**注:** XML フォーマットファイルは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ツールが Native Client と共にインストールされている場合にのみサポートされ [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。</span><span class="sxs-lookup"><span data-stu-id="252f7-153">**Note:**  XML format files are only supported when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tools are installed along with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>|  
|<span data-ttu-id="252f7-154">BCP_OPTION_HINTS</span><span class="sxs-lookup"><span data-stu-id="252f7-154">BCP_OPTION_HINTS</span></span>|<span data-ttu-id="252f7-155">*iValue* 引数には、ワイド文字列ポインターが含まれます。</span><span class="sxs-lookup"><span data-stu-id="252f7-155">The *iValue* argument contains a wide character string pointer.</span></span> <span data-ttu-id="252f7-156">ポインターが指す文字列には、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 一括コピー処理ヒント、または結果セットを返す [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントを指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-156">The string addressed specifies either [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-copy processing hints or a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that returns a result set.</span></span> <span data-ttu-id="252f7-157">複数の結果セットを返す [!INCLUDE[tsql](../../includes/tsql-md.md)] ステートメントを指定すると、1 つ目の結果セット以外はすべて無視されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-157">If a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement is specified that returns more than one result set, all result sets after the first are ignored.</span></span>|  
|<span data-ttu-id="252f7-158">BCP_OPTION_KEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="252f7-158">BCP_OPTION_KEEPIDENTITY</span></span>|<span data-ttu-id="252f7-159">*iValue* 引数が TRUE に設定されている場合、このオプションは、一括コピー メソッドで、ID 制約が定義された [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 列用に指定したデータ値が挿入されることを示します。</span><span class="sxs-lookup"><span data-stu-id="252f7-159">When the *iValue* argument is set to TRUE, this option specifies that the bulk copy methods insert data values supplied for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] columns defined with an identity constraint.</span></span> <span data-ttu-id="252f7-160">入力ファイルには ID 列の値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="252f7-160">The input file must supply values for the identity columns.</span></span> <span data-ttu-id="252f7-161">このオプションを設定しないと、挿入される行に対して新しい ID 値が生成されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-161">If this is not set, new identity values are generated for the inserted rows.</span></span> <span data-ttu-id="252f7-162">ファイル内に存在する ID 列用のデータはすべて無視されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-162">Any data present in the file for the identity columns is ignored.</span></span>|  
|<span data-ttu-id="252f7-163">BCP_OPTION_KEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="252f7-163">BCP_OPTION_KEEPNULLS</span></span>|<span data-ttu-id="252f7-164">ファイル内の空のデータ値を [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブルで NULL 値に変換するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-164">Specifies whether empty data values in the file will be converted to NULL values in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="252f7-165">*iValue* 引数を TRUE に設定すると、空の値は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブルで NULL に変換されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-165">When the *iValue* argument is set to TRUE, empty values will be converted to NULL in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="252f7-166">既定では、空の値は [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] テーブル内の列の既定値 (存在する場合) に変換されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-166">The default is for empty values to be converted to a default value for the column in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table if a default exists.</span></span>|  
|<span data-ttu-id="252f7-167">BCP_OPTION_LAST</span><span class="sxs-lookup"><span data-stu-id="252f7-167">BCP_OPTION_LAST</span></span>|<span data-ttu-id="252f7-168">コピーする最終行を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-168">The last row to copy.</span></span> <span data-ttu-id="252f7-169">既定では、すべての行をコピーします。</span><span class="sxs-lookup"><span data-stu-id="252f7-169">The default is to copy all rows.</span></span> <span data-ttu-id="252f7-170">1 未満の値を指定すると、このオプションは既定値にリセットされます。</span><span class="sxs-lookup"><span data-stu-id="252f7-170">A value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="252f7-171">BCP_OPTION_LASTEX</span><span class="sxs-lookup"><span data-stu-id="252f7-171">BCP_OPTION_LASTEX</span></span>|<span data-ttu-id="252f7-172">BCP out 操作の場合は、データ ファイルにコピーするための、データベース テーブルの最後の行を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-172">For BCP out operations, specifies the last row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="252f7-173">BCP in 操作の場合は、データベース テーブルにコピーするための、データ ファイルの最後の行を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-173">For BCP in operations, specifies the last row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="252f7-174">*iValue* パラメーターには、その値を含む 64 ビット符号付き整数のアドレスを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="252f7-174">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="252f7-175">BCPLASTEX に渡すことができる最大値は 2^63-1 です。</span><span class="sxs-lookup"><span data-stu-id="252f7-175">The maximum value that can be passed to BCPLASTEX is 2^63-1.</span></span>|  
|<span data-ttu-id="252f7-176">BCP_OPTION_MAXERRS</span><span class="sxs-lookup"><span data-stu-id="252f7-176">BCP_OPTION_MAXERRS</span></span>|<span data-ttu-id="252f7-177">一括コピー操作が失敗するまでに発生してもかまわないエラーの数を指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-177">The number of errors allowed before the bulk copy operation fails.</span></span> <span data-ttu-id="252f7-178">既定値は 10 です。</span><span class="sxs-lookup"><span data-stu-id="252f7-178">The default is 10.</span></span> <span data-ttu-id="252f7-179">1 未満の値を指定すると、このオプションは既定値にリセットされます。</span><span class="sxs-lookup"><span data-stu-id="252f7-179">A value less than 1 resets this option to its default.</span></span> <span data-ttu-id="252f7-180">一括コピーでは、最大 65,535 個のエラーが許容されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-180">Bulk copy imposes a maximum of 65,535 errors.</span></span> <span data-ttu-id="252f7-181">このオプションに 65,535 を超える値を設定しようとすると、65,535 が設定されます。</span><span class="sxs-lookup"><span data-stu-id="252f7-181">An attempt to set this option to a value larger than 65,535 results in the option being set to 65,535.</span></span>|  
|<span data-ttu-id="252f7-182">BCP_OPTION_ROWCOUNT</span><span class="sxs-lookup"><span data-stu-id="252f7-182">BCP_OPTION_ROWCOUNT</span></span>|<span data-ttu-id="252f7-183">現在 (または最後) の BCP 操作で処理された行数を返します。</span><span class="sxs-lookup"><span data-stu-id="252f7-183">Returns the number of rows affected by the current (or last) BCP operation.</span></span>|  
|<span data-ttu-id="252f7-184">BCP_OPTION_TEXTFILE</span><span class="sxs-lookup"><span data-stu-id="252f7-184">BCP_OPTION_TEXTFILE</span></span>|<span data-ttu-id="252f7-185">データ ファイルは、バイナリ ファイルではなく、テキスト ファイルです。</span><span class="sxs-lookup"><span data-stu-id="252f7-185">The data file is not a binary file, but is a text file.</span></span> <span data-ttu-id="252f7-186">BCP では、データ ファイルの先頭 2 バイトに含まれる Unicode バイト マーカーをチェックして、テキスト ファイルが Unicode 形式かどうかを検出します。</span><span class="sxs-lookup"><span data-stu-id="252f7-186">BCP does the detection whether the text file is Unicode or not by checking the Unicode byte marker in the first 2 bytes of the data file.</span></span>|  
|<span data-ttu-id="252f7-187">BCP_OPTION_UNICODEFILE</span><span class="sxs-lookup"><span data-stu-id="252f7-187">BCP_OPTION_UNICODEFILE</span></span>|<span data-ttu-id="252f7-188">このオプションに TRUE を設定して、入力ファイルが Unicode ファイル形式であることを指定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-188">When set to TRUE, this option specifies that the input file is a Unicode file format.</span></span>|  
  
## <a name="arguments"></a><span data-ttu-id="252f7-189">引数</span><span class="sxs-lookup"><span data-stu-id="252f7-189">Arguments</span></span>  
 <span data-ttu-id="252f7-190">*eOption*[in]</span><span class="sxs-lookup"><span data-stu-id="252f7-190">*eOption*[in]</span></span>  
 <span data-ttu-id="252f7-191">上記の「解説」で示したいずれかのオプションに設定します。</span><span class="sxs-lookup"><span data-stu-id="252f7-191">Set to one of the options listed in the remarks section above.</span></span>  
  
 <span data-ttu-id="252f7-192">*iValue*[in]</span><span class="sxs-lookup"><span data-stu-id="252f7-192">*iValue*[in]</span></span>  
 <span data-ttu-id="252f7-193">指定された *eOption* に対する値です。</span><span class="sxs-lookup"><span data-stu-id="252f7-193">The value for the specified *eOption*.</span></span> <span data-ttu-id="252f7-194">*iValue* 引数は、将来 64 ビット値に拡張できるように、void ポインターにキャストされる整数値です。</span><span class="sxs-lookup"><span data-stu-id="252f7-194">The *iValue* argument is an integer value cast to a void pointer to allow for future expansion to 64 bit values.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="252f7-195">リターン コードの値</span><span class="sxs-lookup"><span data-stu-id="252f7-195">Return Code Values</span></span>  
 <span data-ttu-id="252f7-196">S_OK</span><span class="sxs-lookup"><span data-stu-id="252f7-196">S_OK</span></span>  
 <span data-ttu-id="252f7-197">メソッドが成功しました。</span><span class="sxs-lookup"><span data-stu-id="252f7-197">The method succeeded.</span></span>  
  
 <span data-ttu-id="252f7-198">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="252f7-198">E_FAIL</span></span>  
 <span data-ttu-id="252f7-199">プロバイダー固有のエラーが発生しました。詳細を確認するには、[ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) インターフェイスを使用してください。</span><span class="sxs-lookup"><span data-stu-id="252f7-199">A provider-specific error occurred; for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="252f7-200">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="252f7-200">E_UNEXPECTED</span></span>  
 <span data-ttu-id="252f7-201">メソッドの呼び出しが予期されませんでした。</span><span class="sxs-lookup"><span data-stu-id="252f7-201">The call to the method was unexpected.</span></span> <span data-ttu-id="252f7-202">たとえば、この関数が呼び出される前に、[IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) メソッドが呼び出されなかった場合などです。</span><span class="sxs-lookup"><span data-stu-id="252f7-202">For example, the [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) method was not called before calling this function.</span></span>  
  
 <span data-ttu-id="252f7-203">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="252f7-203">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="252f7-204">メモリ不足エラーです。</span><span class="sxs-lookup"><span data-stu-id="252f7-204">Out-of-memory error.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="252f7-205">参照</span><span class="sxs-lookup"><span data-stu-id="252f7-205">See Also</span></span>  
 <span data-ttu-id="252f7-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="252f7-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="252f7-207">一括コピー操作の実行</span><span class="sxs-lookup"><span data-stu-id="252f7-207">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
